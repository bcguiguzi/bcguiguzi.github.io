<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>App接入Android指纹识别 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="App接入Android指纹识别" />
<meta property="og:description" content="Biometric Authentication 是一种使用面部或指纹识别进行用户认证的方式，这是保护敏感信息的方法之一。它对于需要用户每次打开应用都要进行认证的金融和医疗健康应用非常重要。
1. 声明依赖项 您可以在此处检查最新的版本发布情况。
dependencies { implementation(&#34;androidx.biometric:biometric:1.1.0&#34;) ... } 2. 选择认证类型 • BIOMETRIC_STRONG — Class 3 生物认证，了解更多详细信息请点击[这里] (https://developer.android.com/training/sign-in/biometric-auth#strong-vs-weak)。
• BIOMETRIC_WEAK — Class 2 生物认证，了解更多详细信息请点击[这里] (https://developer.android.com/training/sign-in/biometric-auth#strong-vs-weak)。
• DEVICE_CREDENTIAL — 用户需输入屏幕锁定的 PIN/图案/密码
对于 STRONG 和 WEAK 之间的区别，我不会详细展开，因为这将是一个过长的话题。您还可以同时选择多种类型：BIOMETRIC_STRONG 或 DEVICE_CREDENTIAL。
3. 检查认证是否可用 双重检查导入项，确保您正在使用 androidx.biometric.*。
在下面的示例中，我将使用 BIOMETRIC_STRONG。某些设备可能没有生物认证功能。以下是四种可能性：
val biometricManager = BiometricManager.from(this) when (biometricManager.canAuthenticate(BIOMETRIC_STRONG)) { BiometricManager.BIOMETRIC_SUCCESS -&gt; { // 使用生物特征进行认证 } BiometricManager.BIOMETRIC_ERROR_NO_HARDWARE -&gt; { // 缺少生物特征硬件 } BiometricManager.BIOMETRIC_ERROR_HW_UNAVAILABLE -&gt; { // 当前无法使用生物特征 } BiometricManager." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/7f44ed1ab05b36974541efaad2589858/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-18T17:04:59+08:00" />
<meta property="article:modified_time" content="2024-03-18T17:04:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">App接入Android指纹识别</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p class="img-center"><img alt="图片" height="503" src="https://images2.imgbox.com/e4/97/4rRrR28D_o.png" width="716"></p> 
<h2></h2> 
<p>Biometric Authentication 是一种使用面部或指纹识别进行用户认证的方式，这是保护敏感信息的方法之一。它对于需要用户每次打开应用都要进行认证的金融和医疗健康应用非常重要。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="480" src="https://images2.imgbox.com/5d/f3/0ctebSA9_o.gif" width="216"></p> 
<h3>1. 声明依赖项</h3> 
<p>您可以在此处检查最新的版本发布情况。</p> 
<pre><code>dependencies {
    implementation("androidx.biometric:biometric:1.1.0")
    ...
}</code></pre> 
<h3>2. 选择认证类型</h3> 
<ul><li> <p>• <code>BIOMETRIC_STRONG</code> — Class 3 生物认证，了解更多详细信息请点击[这里] (https://developer.android.com/training/sign-in/biometric-auth#strong-vs-weak)。</p> </li><li> <p>• <code>BIOMETRIC_WEAK</code> — Class 2 生物认证，了解更多详细信息请点击[这里] (https://developer.android.com/training/sign-in/biometric-auth#strong-vs-weak)。</p> </li><li> <p>• <code>DEVICE_CREDENTIAL</code> — 用户需输入屏幕锁定的 PIN/图案/密码</p> </li></ul> 
<p>对于 STRONG 和 WEAK 之间的区别，我不会详细展开，因为这将是一个过长的话题。您还可以同时选择多种类型：<code>BIOMETRIC_STRONG</code> 或 <code>DEVICE_CREDENTIAL</code>。</p> 
<h3>3. 检查认证是否可用</h3> 
<p>双重检查导入项，确保您正在使用 androidx.biometric.*。</p> 
<p>在下面的示例中，我将使用 <code>BIOMETRIC_STRONG</code>。某些设备可能没有生物认证功能。以下是四种可能性：</p> 
<pre><code>val biometricManager = BiometricManager.from(this)
when (biometricManager.canAuthenticate(BIOMETRIC_STRONG)) {
    BiometricManager.BIOMETRIC_SUCCESS -&gt; {
        // 使用生物特征进行认证
    }

    BiometricManager.BIOMETRIC_ERROR_NO_HARDWARE -&gt; {
        // 缺少生物特征硬件
    }

    BiometricManager.BIOMETRIC_ERROR_HW_UNAVAILABLE -&gt; {
        // 当前无法使用生物特征
    }

    BiometricManager.BIOMETRIC_ERROR_NONE_ENROLLED -&gt; {
        // 用户未注册您的应用所支持的生物特征认证，请提示用户进行注册
        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.R) {
            val enrollIntent =
                Intent(Settings.ACTION_BIOMETRIC_ENROLL).apply {
                    putExtra(
                        Settings.EXTRA_BIOMETRIC_AUTHENTICATORS_ALLOWED,
                        BIOMETRIC_STRONG or DEVICE_CREDENTIAL
                    )
                }
            startActivityForResult(enrollIntent, REQUEST_CODE)
        }
    }
}</code></pre> 
<h3>4. 创建提示框</h3> 
<p>如果我们收到 <code>BIOMETRIC_SUCCESS</code>，我们可以使用生物认证对话框提示用户进行认证。我们需要两个东西：</p> 
<ul><li> <p>• 名为 PromptInfo 的对话框</p> </li></ul> 
<pre><code>private fun createPromptInfo(): BiometricPrompt.PromptInfo =
    BiometricPrompt.PromptInfo.Builder()
        .setTitle("使用生物特征进行认证")
        .setAllowedAuthenticators(BIOMETRIC_STRONG)
        .setConfirmationRequired(false)
        .setNegativeButtonText("使用密码登录")
        .build()</code></pre> 
<ul><li> <p>• 带有回调的提示框</p> </li></ul> 
<pre><code>private fun createBiometricPrompt(): BiometricPrompt {
    val callback = object : BiometricPrompt.AuthenticationCallback() {
        override fun onAuthenticationError(errorCode: Int, errString: CharSequence) {
            super.onAuthenticationError(errorCode, errString)
            if (errorCode == BiometricPrompt.ERROR_NEGATIVE_BUTTON) {
                // 如果您在提示对话框中添加了取消按钮
            }
        }

        override fun onAuthenticationFailed() {
            super.onAuthenticationFailed()
            // 认证失败，原因未知
        }

        override fun onAuthenticationSucceeded(result: BiometricPrompt.AuthenticationResult) {
            super.onAuthenticationSucceeded(result)
            // 认证成功！
        }
    }

    val executor = ContextCompat.getMainExecutor(this)
    return BiometricPrompt(this, executor, callback)
}</code></pre> 
<h3>5. 显示提示框</h3> 
<p>现在我们已经准备好了，可以显示提示框了：</p> 
<pre><code>BiometricManager.BIOMETRIC_SUCCESS -&gt; {
    val prompt = createBiometricPrompt()
    prompt.authenticate(createPromptInfo())
}</code></pre> 
<p>如果用户成功进行认证，回调中的 <code>onAuthenticationSucceeded </code>将被调用。</p> 
<h3>附加功能：在模拟器上调试生物特征</h3> 
<p>如果您想在模拟器上调试生物特征，您需要添加一个锁屏和指纹。当您尝试使用生物特征解锁时，系统会提示您添加锁屏和指纹。您可以按照下面的图像中的步骤在模拟器上测试指纹功能：</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="473" src="https://images2.imgbox.com/00/b3/laSKMZhg_o.png" width="720"></p> 
<p>How to debug Fingerprints on Emulator</p> 
<p>通过以上步骤，您可以使用 Android 生物认证管理来保护敏感信息，并使用户能够方便而安全地进行认证。这对于金融和医疗健康应用来说尤为重要。希望本博客能帮助您深入了解 Android 生物认证管理的技术实现。</p> 
<h3>参考</h3> 
<ul><li> <p>• [Android Developers - Biometric Authentication] (https://developer.android.com/training/sign-in/biometric-auth)</p> </li><li> <p>• [Android Developers - BiometricPrompt] (https://developer.android.com/reference/androidx/biometric/BiometricPrompt)</p> </li><li> <p>• [BiometricAuthenticationExample] (https://github.com/AndroBrain/BiometricAuthenticationExample)</p> </li></ul> 
<p></p> 
<p>转自：<a href="https://mp.weixin.qq.com/s/gechz-019_FEXqDTYFFWvw" rel="nofollow" title="您的App接入Android指纹识别了吗？">您的App接入Android指纹识别了吗？</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/302d33794cfbe3bfddd872357363e00b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">从 XML 到 Compose 快速迁移指南</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/254a8ef6b107c4283a028ff87f083cd7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Odoo17免费开源ERP开发技巧：如何在表单视图中调用JS类</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>