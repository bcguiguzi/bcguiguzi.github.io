<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>RecyclerView使用static和不使用static的Viewholder内存消耗相差无几 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="RecyclerView使用static和不使用static的Viewholder内存消耗相差无几" />
<meta property="og:description" content="RecyclerView的onViewRecycled可以看到被回收的VIewHolder
RecyclerView实现接口RecyclerListener的onViewRecycled方法。
@Override public void onViewRecycled(ViewHolder holder) { } 可以看到，每一个被回收的ViewHolder都能在这里得到，那我们可以通过查看ViewHolder的内存地址来判断RecyclerView的回收。 首先使用不带static的Viewholder
class ViewHolder extends RecyclerView.ViewHolder 然后在ViewHolder里面写200个数据来看ViewHolder的回收。 在onViewRecycled方法中写一个Log.i(&#34;view&#34;,&#34;testtest=&#34;&#43;holder);打印holder的内存地址。
这是第一个打印的地址：
testtest=ViewHolder{4a816788 position=0 id=-1, oldPos=-1, pLpos:-1 no parent}
可以看到内存地址为4a816788；
如果内存地址相同则为同一个对象
内存地址：
testtest=ViewHolder{4a816788 position=0 id=-1, oldPos=-1, pLpos:-1 no parent}
testtest=ViewHolder{4a829d58 position=1 id=-1, oldPos=-1, pLpos:-1 no parent}
testtest=ViewHolder{4a82c2fc position=2 id=-1, oldPos=-1, pLpos:-1 no parent}
testtest=ViewHolder{4a82e2b0 position=3 id=-1, oldPos=-1, pLpos:-1 no parent}
testtest=ViewHolder{4a81945c position=4 id=-1, oldPos=-1, pLpos:-1 no parent}
testtest=ViewHolder{4a82f5ac position=5 id=-1, oldPos=-1, pLpos:-1 no parent}" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/9aa6f72695344f13e36edd3248faef08/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-09-19T21:43:04+08:00" />
<meta property="article:modified_time" content="2016-09-19T21:43:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">RecyclerView使用static和不使用static的Viewholder内存消耗相差无几</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>RecyclerView的onViewRecycled可以看到被回收的VIewHolder</p> 
<p>RecyclerView实现接口RecyclerListener的onViewRecycled方法。</p> 
<p></p> 
<pre style="background-color:#2b2b2b; color:#a9b7c6; font-family:'宋体'; font-size:15.0pt"><span style="color:#bbb529">@Override
</span><span style="color:#cc7832">public void </span><span style="color:#ffc66d">onViewRecycled</span>(ViewHolder holder) {
  <span style="color:#cc7832">
</span>}</pre> 
<span style="font-size:14px">可以看到，每一个被回收的ViewHolder都能在这里得到，那我们可以通过查看ViewHolder的内存地址来判断RecyclerView的回收。</span> 
<p></p> 
<p><span style="font-size:14px">首先使用不带static的Viewholder</span></p> 
<p></p> 
<pre style="background-color:#2b2b2b; color:#a9b7c6; font-family:'宋体'; font-size:15.0pt"><span style="color:#cc7832">class </span>ViewHolder <span style="color:#cc7832">extends </span>RecyclerView.ViewHolder</pre> 
<span style="font-size:18px">然后在ViewHolder里面写200个数据来看ViewHolder的回收。</span> 
<p></p> 
<p><span style="font-size:18px">在onViewRecycled方法中写一个Log.i("view","testtest="+holder);打印holder的内存地址。</span></p> 
<p><span style="font-size:18px">这是第一个打印的地址：</span></p> 
<p><span style="font-size:18px; color:#3366ff">testtest=ViewHolder{4a816788 position=0 id=-1, oldPos=-1, pLpos:-1 no parent}</span><br> </p> 
<p><span style="font-size:18px">可以看到内存地址为</span><span style="color:rgb(51,102,255); font-size:18px">4a816788；</span></p> 
<p><span style="font-size:18px">如果内存地址相同则为同一个对象</span></p> 
<p><span style="font-size:18px">内存地址：</span></p> 
<p><span style="font-size:18px">testtest=ViewHolder{<!-- --><span style="color:#009900">4a816788</span> position=0 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a829d58 position=1 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a82c2fc position=2 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a82e2b0 position=3 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a81945c position=4 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a82f5ac position=5 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a831984 position=6 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a80d30c position=7 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a816178 position=8 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a82d3a8 position=9 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a82ff70 position=10 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a81b954 position=11 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a81fa38 position=12 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a820768 position=13 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a811514 position=14 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a82e00c position=15 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a8169dc position=16 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a81f170 position=17 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a80fb84 position=18 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a8145b0 position=19 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a814a6c position=20 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{<!-- --><span style="color:#33cc00">4a816788</span> position=21 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a829d58 position=22 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a82c2fc position=23 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a82e2b0 position=24 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a81945c position=25 id=-1, oldPos=-1, pLpos:-1 no parent}<br> testtest=ViewHolder{4a82f5ac position=26 id=-1, oldPos=-1, pLpos:-1 no parent}<br> </span></p> 
<p><br> </p> 
<p><span style="font-size:14px">可以看到总共创建了21个对象，然后重复利用这21个对象。经过测试static的ViewHolder使用内存情况和不使用static完全一样。所以用new的方式创建static的ViewHolder和不带static的ViewHolder内存相差无几。还不如使用不带static的ViewHolder来的方便。</span></p> 
<p><span style="font-size:14px">我下载了很多使用static的ViewHolder的RecyclerView的Demo，这其实相当于脱裤子放屁，多此一举。</span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/927f42ed31600fcf77500f5f73132349/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">二叉树中的度</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/71e6874fdb784b9bf08b142c9cfee0d8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">用户空间的虚拟地址如何转换得到实际的物理地址</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>