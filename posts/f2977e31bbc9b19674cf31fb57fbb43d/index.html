<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>docker入门（启用容器） - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="docker入门（启用容器）" />
<meta property="og:description" content="1、运行第一个容器命令 sudo docker run -i -t ubuntu /bin/bash
运行这个命令后，会根据ubuntu的镜像，创建一个ubuntu的容器
-i 表示容器的STDIN是开启的，-t表示为容器提供一个交互式的shell
ubuntu 表示根据哪个镜像去创建容器
如果本地没有ubuntu镜像，那Docker会在DockerHub的公共镜像库为你找到你所需要的镜像
2、使用容器 我们可以把这个新创建的ubuntu容器当中一个新的操作系统使用，执行一下命令
还可以为这个容器安装软件，比如安装一个vim编辑器
可以提供exit命令退出这个容器
3、查看现有的容器 使用
docker ps -a
圈出来的就是刚刚我们运行的容器
docker ps -a代表查看所有容器
docker ps 查看正在运行的容器
docker ps -l 查看最后一次运行的容器
容器相当于是一个进程，可以在前台运行，也可以在后台运行，在前台运行的时候
我们看图片的第一列：
CONTAINER_ID 代表容器的唯一ID
IMAGE 代表这个容器是由哪个镜像构建的
COMMAND 代码运行容器的时候，为容器指定执行的命令，这个后面再讲，你可以先理解为这个根据容器所属的镜像不同，执行的命令也不同；
STATUS 代码容器的状态，比如运行，介绍状态
PORTS 表示容器开放的虚拟端口号
NAME 容器的名称，可以在启动的时候为容器命名，如果没有为容器命令，Docker会为容器自动生成名字
4、容器命名 刚刚说到了我们可以为容器命名，那怎么操作呢？
很简单，只需要
sudo docker run --name deng_container -i -t ubuntu /bin/bash
使用–name 参数，在后面加上你想为容器取的名字
取名注意事项：
1、名字的字符是有限制的，只能使用a-z,A-Z,0-9，下划线，圆点、横线
用正则表达式就是这样的[a-zA-Z0-9_.-]
2、在一些操作容器docker命令中，我们可以使用容器的名字代替容器的id,因为很明显容器的ID比容器的名字更好记，所以，容器的名字和容器的ID一样，不能重复；
5、重启已经停止的容器 使用
sudo docker start [容器的id或者名字]" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/f2977e31bbc9b19674cf31fb57fbb43d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-21T23:54:54+08:00" />
<meta property="article:modified_time" content="2022-03-21T23:54:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">docker入门（启用容器）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1_1"></a>1、运行第一个容器命令</h2> 
<p>sudo docker run -i -t ubuntu /bin/bash<br> <img src="https://images2.imgbox.com/c5/3b/OCNVVP3B_o.png" alt="1642948610315"></p> 
<p>运行这个命令后，会根据ubuntu的镜像，创建一个ubuntu的容器</p> 
<p>-i 表示容器的STDIN是开启的，-t表示为容器提供一个交互式的shell</p> 
<p>ubuntu 表示根据哪个镜像去创建容器</p> 
<blockquote> 
 <p>如果本地没有ubuntu镜像，那Docker会在DockerHub的公共镜像库为你找到你所需要的镜像</p> 
</blockquote> 
<h2><a id="2_14"></a>2、使用容器</h2> 
<p>我们可以把这个新创建的ubuntu容器当中一个新的操作系统使用，执行一下命令</p> 
<p><img src="https://images2.imgbox.com/d4/17/qza8jSXe_o.png" alt="在这里插入图片描述"></p> 
<p>还可以为这个容器安装软件，比如安装一个vim编辑器</p> 
<p><img src="https://images2.imgbox.com/56/4e/1GA9j0PQ_o.png" alt="在这里插入图片描述"></p> 
<p>可以提供exit命令退出这个容器</p> 
<p><img src="https://images2.imgbox.com/bb/7b/4ZHRGKG4_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3_30"></a>3、查看现有的容器</h2> 
<p>使用</p> 
<blockquote> 
 <p>docker ps -a<br> <img src="https://images2.imgbox.com/93/3b/n8GyGd1u_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>圈出来的就是刚刚我们运行的容器</p> 
<p>docker ps -a代表查看所有容器</p> 
<p>docker ps 查看正在运行的容器</p> 
<p>docker ps -l 查看最后一次运行的容器<br> 容器相当于是一个进程，可以在前台运行，也可以在后台运行，在前台运行的时候</p> 
<p>我们看图片的第一列：</p> 
<p>CONTAINER_ID 代表容器的唯一ID</p> 
<p>IMAGE 代表这个容器是由哪个镜像构建的</p> 
<p>COMMAND 代码运行容器的时候，为容器指定执行的命令，这个后面再讲，你可以先理解为这个根据容器所属的镜像不同，执行的命令也不同；</p> 
<p>STATUS 代码容器的状态，比如运行，介绍状态</p> 
<p>PORTS 表示容器开放的虚拟端口号</p> 
<p>NAME 容器的名称，可以在启动的时候为容器命名，如果没有为容器命令，Docker会为容器自动生成名字</p> 
<h2><a id="4_60"></a>4、容器命名</h2> 
<p>刚刚说到了我们可以为容器命名，那怎么操作呢？</p> 
<p>很简单，只需要</p> 
<blockquote> 
 <p>sudo docker run --name deng_container -i -t ubuntu /bin/bash<br> 使用–name 参数，在后面加上你想为容器取的名字</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/14/9e/je1MdZlM_o.png" alt="在这里插入图片描述"></p> 
<p>取名注意事项：</p> 
<p>1、名字的字符是有限制的，只能使用a-z,A-Z,0-9，下划线，圆点、横线</p> 
<p>用正则表达式就是这样的[a-zA-Z0-9_.-]</p> 
<p>2、在一些操作容器docker命令中，我们可以使用容器的名字代替容器的id,因为很明显容器的ID比容器的名字更好记，所以，容器的名字和容器的ID一样，不能重复；</p> 
<p><img src="https://images2.imgbox.com/4c/14/pxFS1AYz_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="5_82"></a>5、重启已经停止的容器</h2> 
<p>使用</p> 
<blockquote> 
 <p>sudo docker start [容器的id或者名字]<br> 去启动已经关闭的容器</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/cd/5b/nLf6sCVB_o.png" alt="在这里插入图片描述"></p> 
<p>是不是很简单</p> 
<p>这里要注意的是，重启启动容器的时候，没有使用-i -t 参数，所以容器是在后台运行的，所以容器启动后，我们还行进入容器的shell界面怎么办</p> 
<p>只需要一条命令</p> 
<blockquote> 
 <p>sudo docker attach deng_container<br> <img src="https://images2.imgbox.com/8b/53/OWS01izX_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<h2><a id="6_101"></a>6、创建守护式容器</h2> 
<p>我们除了创建交互式的容器以外，我们还可以创建守护式的容器，也就是后台运行的容器</p> 
<blockquote> 
 <p>docker run --name daemon_dave -d ubuntu /bin/sh -c “while true;do echo hello world;sleep 1; done”<br> <img src="https://images2.imgbox.com/38/80/7k7kRU4f_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>我们可以在运行容器的时候，使用-d参数，去创建守护式的容器，由图可以看出，创建这样的容器，终端就不会进入容器的交互界面，而是之返回一个容器的id</p> 
<p>-c命令，配置这个容器在后台活动的时候需要做些什么</p> 
<h2><a id="7_112"></a>7、容器内部在做什么</h2> 
<p>刚刚我们创建了一个守护式的容器，并且配置它在后台打印hello world，我们怎么知道它是否正在执行呢？</p> 
<p>我们可以使用docker logs命令</p> 
<p>docker logs [容器id或者名字]<br> <img src="https://images2.imgbox.com/04/78/NFLJpYTr_o.png" alt="在这里插入图片描述"></p> 
<p>看，容器控制台的输出，全部打印出来了</p> 
<p>docker logs还能配置一些参数，比如</p> 
<blockquote> 
 <p>docker logs --tail 10 daemon_dave<br> 获取最后x行</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/78/27/SztwimZJ_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>docker logs --tail 0 -f daemon_dave 获取某个容器最新的日志而不必读整个文件</p> 
</blockquote> 
<p>还能使用-t参数新增时间戳</p> 
<p><img src="https://images2.imgbox.com/37/59/SY8FKQ6l_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="8_138"></a>8、查看容器内的进程</h2> 
<p>我们有时候需要提供查看容器内运行的进程的方式去了解容器的情况</p> 
<p>使用：</p> 
<blockquote> 
 <p>docker top daemon_dave<br> <img src="https://images2.imgbox.com/aa/42/NcUry3n6_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<h2><a id="9_147"></a>9、在容器内部运行进程</h2> 
<p>我们可以提供docker exec 命令去为一个后台正在运行的容器，执行一个命令，比如在一个后台执行的容器中，创建一个新的文件</p> 
<blockquote> 
 <p>docker exec -d daemon_dave touch /etc/new_config_file</p> 
</blockquote> 
<h2><a id="10_151"></a>10、停止守护式容器</h2> 
<p>在前台shell运行的容器我们可以使用exit去退出，那后台运行的容器呢？很简单，使用下面的命令</p> 
<blockquote> 
 <p>sudo docker stop daemon_dave</p> 
</blockquote> 
<h2><a id="11_155"></a>11、自动重启容器</h2> 
<p>容器在运行过程中，可能会因为不可预知的错误导致容器退出，我们可以提供在启动的时候，设置参数，让容器在非自然退出的时候字段重启</p> 
<p>命令如下：</p> 
<blockquote> 
 <p>sudo docker run --restart=always --name daemon_dave -d ubuntu /bin/sh<br> -c “while true;do echo hello world;sleep 1; done”<br> –restart参数，表示的就是为容器设置重启的参数：这里restart被设置为了always,代表容器退出后总是会重启，无论退出代码是什么</p> 
</blockquote> 
<p>我们还可以设置restart= on-failure,这样容器就只有在错误退出的时候才会重启</p> 
<p>命令：</p> 
<blockquote> 
 <p>–restart=onfailure:5<br> :5退出代码为非0的时候，docker会尝试重启容器，并且最多五次</p> 
</blockquote> 
<h2><a id="12_171"></a>12、深入容器</h2> 
<p>除了使用docker ps命令来了解容器的信息，我们还可以使用</p> 
<blockquote> 
 <p>docker inspect [容器名字或id]<br> 获取更多容器信息：</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/0e/dc/14oCnPCN_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="13_180"></a>13、删除容器</h2> 
<p>如果你不需要哪个容器，你可以使用</p> 
<blockquote> 
 <p>docker rm [容器名字或id]<br> 删除容器</p> 
</blockquote> 
<p>docker没有提供删除所有容器的命令，不过我们可以使用一些小技巧来删除所有容器</p> 
<p>docker rm <code>docker ps -a -q</code></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/99bd735b4e083dd9ac1db6a4450259c7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使用Docker-compose安装NextCloud，并部署Collabora作为office服务</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e7c543ff3fc6a65123fee6bb145402b0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Presto日期函数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>