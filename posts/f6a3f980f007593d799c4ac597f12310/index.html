<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MATLAB中对tif格式栅格影像读取-保存 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MATLAB中对tif格式栅格影像读取-保存" />
<meta property="og:description" content="MATLAB中对tif格式栅格影像读取-保存，点滴学习，贵在记录。
MATLAB中对tif格式栅格影像读取-保存 在做水质反演的过程中，用到了MATLAB，但对这个工具一无所知。研究的总体思路是先建立整体构架，然后查阅每一步的具体实现的语法，结合MATLAB help，逐渐实现每一步。
geotiffwrite 基础语法
geotiffwrite(filename,A,R)
geotiffwrite(filename,X,cmap,R)
geotiffwrite(…,Name,Value)
输入参数变量释义：
filename：输入文件的名称和位置，文件扩展名必须是 “.tif” 或者 “.TIF”，变量类型为字符向量。
A：要导出的影像数据，为MNP的矩阵。坐标系为地理坐标，且默认为WGS-84，指定坐标可通过’GeoKeyDirectoryTag’和’CoordRefSysCode’实现。数据类型
数据类型 double | single | uint8 | uint16 | uint32 | uint64 | int8 | int16 | int32 | int64 | logical
R：空间参考信息。
空间引用信息，指定为地理栅格引用对象、引用矩阵或引用向量。
如果您正在处理投影坐标系中的图像坐标，而R是一个地图栅格引用对象或引用矩阵，则相应地指定“GeoKeyDirectoryTag”或“CoordRefSysCode”。
X：待补充
cmap：RGB图像，为M*3的矩阵
示例
% 影像的读取 basename = &#39;boston_ovr&#39;; imagefile = [basename &#39;.jpg&#39;]; RGB = imread(imagefile); worldfile = getworldfilename(imagefile); R = worldfileread(worldfile, &#39;geographic&#39;, size(RGB)); %读取空间参考信息 %导出影像 filename = [basename &#39;.tif&#39;]; geotiffwrite(filename, RGB, R) % 显示影像 figure usamap(RGB, R) geoshow(filename) 示例2 读取tif处理后保存tif" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/f6a3f980f007593d799c4ac597f12310/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-15T15:00:40+08:00" />
<meta property="article:modified_time" content="2019-07-15T15:00:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MATLAB中对tif格式栅格影像读取-保存</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>MATLAB中对tif格式栅格影像读取-保存，点滴学习，贵在记录。</p> 
<h2><a id="MATLABtif_2"></a>MATLAB中对tif格式栅格影像读取-保存</h2> 
<p>在做水质反演的过程中，用到了MATLAB，但对这个工具一无所知。研究的总体思路是先建立整体构架，然后查阅每一步的具体实现的语法，结合MATLAB help，逐渐实现每一步。</p> 
<h3><a id="geotiffwrite_5"></a>geotiffwrite</h3> 
<p>基础语法<br> geotiffwrite(filename,A,R)<br> geotiffwrite(filename,X,cmap,R)<br> geotiffwrite(…,Name,Value)</p> 
<p>输入参数变量释义：<br> filename：输入文件的名称和位置，文件扩展名必须是 “.tif” 或者 “.TIF”，变量类型为字符向量。</p> 
<p>A：要导出的影像数据，为M<em>N</em>P的矩阵。坐标系为地理坐标，且默认为WGS-84，指定坐标可通过’GeoKeyDirectoryTag’和’CoordRefSysCode’实现。数据类型<br> 数据类型 double | single | uint8 | uint16 | uint32 | uint64 | int8 | int16 | int32 | int64 | logical</p> 
<p>R：空间参考信息。<br> 空间引用信息，指定为地理栅格引用对象、引用矩阵或引用向量。<br> 如果您正在处理投影坐标系中的图像坐标，而R是一个地图栅格引用对象或引用矩阵，则相应地指定“GeoKeyDirectoryTag”或“CoordRefSysCode”。</p> 
<p>X：待补充</p> 
<p>cmap：RGB图像，为M*3的矩阵</p> 
<p>示例</p> 
<pre><code class="prism language-tomorrow-night-eighties">% 影像的读取
basename = 'boston_ovr';
imagefile = [basename '.jpg'];
RGB = imread(imagefile);
worldfile = getworldfilename(imagefile);
R = worldfileread(worldfile, 'geographic', size(RGB)); %读取空间参考信息
%导出影像
filename = [basename '.tif'];
geotiffwrite(filename, RGB, R)
% 显示影像
figure
usamap(RGB, R)
geoshow(filename)
</code></pre> 
<p>示例2 读取tif处理后保存tif</p> 
<pre><code>% 读取tif及空间坐标信息
[A, R] = geotiffread('F:\boston.tif');
info = geotiffinfo('F:\boston.tif');
% 保存tif并使用原始数据空间坐标信息
subimage = A;
subR = R;
filename = 'boston_subimage.tif';
geotiffwrite(filename, subImage, subR,  ...
       'GeoKeyDirectoryTag', info.GeoTIFFTags.GeoKeyDirectoryTag);
figure
mapshow(filename);

</code></pre> 
<p>其他参数较多，可以从原始影像中读取，也可以自定义。<br> ‘CoordRefSysCode’ ：坐标系，默认EPSG:4326（即WGS84坐标系）<br> 使用方法：<code>'CoordRefSysCode',4326</code><br> <em>小知识，EPSG：4326是web map中用来表示地图坐标的代码，每个坐标都有一个对应的EPSG代码，常用的WGS84代码为EPSG:4326，伪墨卡托投影代码为EPSG:3857</em></p> 
<p>‘TiffTags’：结构体，内容有以下</p> 
<table><thead><tr><th>Compression</th><th>压缩类型，默认‘PackBits’，其他的包括‘LZWZ’，‘Deflate’，‘none’</th></tr></thead><tbody><tr><td>PhotometricInterpretation</td><td>一般不需要设置。官方介绍如下：字段名称可以缩短为光度控制。该值是根据输入图像特征设置的，使用以下算法：如果A是[M-by-N-by-3]，并且是类类型uint8或uint16，则该值为“RGB”。对于所有其他大小和数据类型，该值为“miniBlack”。如果提供了X，CMAP语法，则值为“palete”。如果该值设置为“RGB”，而A不是[M-by-N-by-3]，则会发出错误。允许的值为“miniBlack”、“RGB”、“Palette”、“Separated”。</td></tr><tr><td>Software</td><td>可忽略，，，，文件的软件制造商。该值设置为“MATLAB，Mapping Toolbox，The MathWorks，Inc.”的值。要删除该值，请将标记设置为空字符串或字符向量（’’）。</td></tr><tr><td>RowsPerStrip</td><td>一个标量正整数值，指定输出文件中每个条带所需的行数。如果A的大小小于[160 x 160]，geotiffwrite将RowsPerStrip设置为1。如果指定RowsPerStrip和TileWidth，无论是否使用tillelength，geotiffwrite都会发出错误。</td></tr><tr><td>TileWidth</td><td>标量正整数值和16的倍数，指定分片的宽度。如果A的大小大于[160 x 160]，则设置平铺宽度。如果是，则该值将创建最多[10×10]个平铺。如果同时指定RowsPerStrip和TileWidth，geotiffwrite将发出错误。</td></tr><tr><td>TileLength</td><td>同上，长度</td></tr></tbody></table> 
<p>使用方法：<code>tifftags = sturct('Compression','LZW')</code></p> 
<h3><a id="_76"></a>重点！！！</h3> 
<p>之前跑数据时，发现超过4GB的数据无法写入保存，这是因为geotiff有两种格式，一种是classictiff，另外一种是针对大数据的bigtiff。解决此办法就是加入字段<code>geotiffwrite(name,out,R,....,'TiffType','bigtiff','Tifftags',tifftags)</code><br> 老版本的没有这个，如果报错，请注意版本问题。目前用的19a没有问题</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/67a028f757b314dc5138d5a3b679c7f7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android 7.1.1中SystemProperties 设置属性无限问题分析</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/07bca4a6c6b329e5abfe6fb3d7f3b0ac/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Flutter基础（八）手势相关Widget：GestureDetector和Dismissible</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>