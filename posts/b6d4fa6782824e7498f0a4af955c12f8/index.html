<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>LitePal数据库插件 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="LitePal数据库插件" />
<meta property="og:description" content="1.编辑你的build.gradle文件并添加下面的依赖库：
dependencies { compile &#39;org.litepal.android:core:1.6.1&#39; } 2.配置litepal.xml 在项目的assets文件夹中创建一个文件，并将其命名为litepal.xml，创建步骤为app–src–main–new–directory，命名为assets，在assets文件夹下创建litepal.xml（assets–new–File）。然后将以下代码复制到其中。
&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt; &lt;litepal&gt; &lt;!-- Define the database name of your application. By default each database name should be end with .db. If you didn&#39;t name your database end with .db, LitePal would plus the suffix automatically for you. For example: &lt;dbname value=&#34;demo&#34; /&gt; --&gt; &lt;dbname value=&#34;demo&#34; /&gt; &lt;!-- Define the version of your database. Each time you want to upgrade your database, the version tag would helps." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/b6d4fa6782824e7498f0a4af955c12f8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-04-02T18:09:16+08:00" />
<meta property="article:modified_time" content="2018-04-02T18:09:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">LitePal数据库插件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>1.编辑你的build.gradle文件并添加下面的依赖库：</p> 
<pre class="prettyprint"><code class=" hljs matlab">dependencies <span class="hljs-cell">{
    compile <span class="hljs-string">'org.litepal.android:core:1.6.1'</span>
}</span></code></pre> 
<p>2.配置litepal.xml <br> 在项目的assets文件夹中创建一个文件，并将其命名为litepal.xml，创建步骤为app–src–main–new–directory，命名为assets，在assets文件夹下创建litepal.xml（assets–new–File）。然后将以下代码复制到其中。</p> 
<pre class="prettyprint"><code class=" hljs applescript">&lt;?xml <span class="hljs-property">version</span>=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;
&lt;litepal&gt;
    &lt;!<span class="hljs-comment">--</span>
        Define <span class="hljs-keyword">the</span> database <span class="hljs-property">name</span> <span class="hljs-keyword">of</span> your <span class="hljs-type">application</span>. 
        By default each database <span class="hljs-property">name</span> should be <span class="hljs-keyword">end</span> <span class="hljs-keyword">with</span> .db. 
        If you didn't <span class="hljs-property">name</span> your database <span class="hljs-keyword">end</span> <span class="hljs-keyword">with</span> .db, 
        LitePal would plus <span class="hljs-keyword">the</span> suffix automatically <span class="hljs-keyword">for</span> you.
        For example:    
        &lt;dbname value=<span class="hljs-string">"demo"</span> /&gt;
    <span class="hljs-comment">--&gt;</span>
    &lt;dbname value=<span class="hljs-string">"demo"</span> /&gt;

    &lt;!<span class="hljs-comment">--</span>
        Define <span class="hljs-keyword">the</span> <span class="hljs-property">version</span> <span class="hljs-keyword">of</span> your database. Each <span class="hljs-property">time</span> you want 
        <span class="hljs-keyword">to</span> upgrade your database, <span class="hljs-keyword">the</span> <span class="hljs-property">version</span> tag would helps.
        Modify <span class="hljs-keyword">the</span> models you defined <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> mapping tag, <span class="hljs-keyword">and</span> just 
        make <span class="hljs-keyword">the</span> <span class="hljs-property">version</span> value plus one, <span class="hljs-keyword">the</span> upgrade <span class="hljs-keyword">of</span> database
        will be processed automatically <span class="hljs-keyword">without</span> concern.
            For example:    
        &lt;<span class="hljs-property">version</span> value=<span class="hljs-string">"1"</span> /&gt;
    <span class="hljs-comment">--&gt;</span>
    &lt;<span class="hljs-property">version</span> value=<span class="hljs-string">"1"</span> /&gt;

    &lt;!<span class="hljs-comment">--</span>
        Define your models <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> <span class="hljs-type">list</span> <span class="hljs-keyword">with</span> mapping tag, LitePal will
        create tables <span class="hljs-keyword">for</span> each mapping <span class="hljs-type">class</span>. The supported fields
        defined <span class="hljs-keyword">in</span> models will be mapped <span class="hljs-keyword">into</span> columns.
        For example:    
        &lt;<span class="hljs-type">list</span>&gt;
            &lt;mapping <span class="hljs-type">class</span>=<span class="hljs-string">"com.test.model.Reader"</span> /&gt;
            &lt;mapping <span class="hljs-type">class</span>=<span class="hljs-string">"com.test.model.Magazine"</span> /&gt;
        &lt;/<span class="hljs-type">list</span>&gt;
    <span class="hljs-comment">--&gt;</span>
    &lt;<span class="hljs-type">list</span>&gt;
    &lt;/<span class="hljs-type">list</span>&gt;

    &lt;!<span class="hljs-comment">--</span>
        Define <span class="hljs-keyword">where</span> <span class="hljs-keyword">the</span> .db <span class="hljs-type">file</span> should be. <span class="hljs-string">"internal"</span> means <span class="hljs-keyword">the</span> .db <span class="hljs-type">file</span>
        will be stored <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> database folder <span class="hljs-keyword">of</span> internal storage which no
        one can access. <span class="hljs-string">"external"</span> means <span class="hljs-keyword">the</span> .db <span class="hljs-type">file</span> will be stored <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span>
        <span class="hljs-command">path to</span> <span class="hljs-keyword">the</span> directory <span class="hljs-function_start"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword">the</span> primary external storage device <span class="hljs-keyword">where</span>
        <span class="hljs-keyword">the</span> <span class="hljs-type">application</span> can place persistent files <span class="hljs-keyword">it</span> owns which everyone
        can access. <span class="hljs-string">"internal"</span> will act <span class="hljs-keyword">as</span> default.
        For example:
        &lt;storage value=<span class="hljs-string">"external"</span> /&gt;
    <span class="hljs-comment">--&gt;</span>

&lt;/litepal&gt;</code></pre> 
<p>3.配置LitePalApplication <br> 你不想一直传递Context参数。为了简化API，只需在AndroidManifest.xml中配置LitePalApplication，如下所示：</p> 
<pre class="prettyprint"><code class=" hljs r">&lt;manifest&gt;
    &lt;application
        android:name=<span class="hljs-string">"org.litepal.LitePalApplication"</span>
        <span class="hljs-keyword">...</span>
    &gt;
        <span class="hljs-keyword">...</span>
    &lt;/application&gt;
&lt;/manifest&gt;</code></pre> 
<p>当然，你可能有自己的应用程序，并且已经在这里配置好了,只需在您自己的应用程序中调用LitePal.initialize（context）：</p> 
<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyOwnApplication</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Application</span> {<!-- --></span>

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span>() {
        <span class="hljs-keyword">super</span>.onCreate();
        LitePal.initialize(<span class="hljs-keyword">this</span>);
    }
    ...
}</code></pre> 
<p>到这里就完成了设置，开始使用 <br> 1.创建表格 <br> 首先定义模型。例如，你有两个模型，专辑和歌曲。模型可以定义如下：</p> 
<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Album</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DataSupport</span> {<!-- --></span>

    <span class="hljs-annotation">@Column</span>(unique = <span class="hljs-keyword">true</span>, defaultValue = <span class="hljs-string">"unknown"</span>)
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> price;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">byte</span>[] cover;

    <span class="hljs-keyword">private</span> List&lt;Song&gt; songs = <span class="hljs-keyword">new</span> ArrayList&lt;Song&gt;();

    <span class="hljs-comment">// generated getters and setters.</span>
    ...
}</code></pre> 
<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Song</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DataSupport</span> {<!-- --></span>

    <span class="hljs-annotation">@Column</span>(nullable = <span class="hljs-keyword">false</span>)
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> duration;

    <span class="hljs-annotation">@Column</span>(ignore = <span class="hljs-keyword">true</span>)
    <span class="hljs-keyword">private</span> String uselessField;

    <span class="hljs-keyword">private</span> Album album;

    <span class="hljs-comment">// generated getters and setters.</span>
    ...
}</code></pre> 
<p>然后将这些模型添加到litepal.xml中的映射列表中：</p> 
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">list</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">mapping</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.litepal.litepalsample.model.Album"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">mapping</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.litepal.litepalsample.model.Song"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">list</span>&gt;</span></code></pre> 
<p>好！这些表格将在您下次操作数据库时生成。例如，使用以下代码获取SQLiteDatabase：</p> 
<pre class="prettyprint"><code class=" hljs fix"><span class="hljs-attribute">SQLiteDatabase db </span>=<span class="hljs-string"> LitePal.getDatabase();</span></code></pre> 
<p>LitePal中的升级表非常简单。无论如何只要修改你的模型：</p> 
<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Album</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DataSupport</span> {<!-- --></span>

    <span class="hljs-annotation">@Column</span>(unique = <span class="hljs-keyword">true</span>, defaultValue = <span class="hljs-string">"unknown"</span>)
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-annotation">@Column</span>(ignore = <span class="hljs-keyword">true</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> price;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">byte</span>[] cover;

    <span class="hljs-keyword">private</span> Date releaseDate;

    <span class="hljs-keyword">private</span> List&lt;Song&gt; songs = <span class="hljs-keyword">new</span> ArrayList&lt;Song&gt;();

    <span class="hljs-comment">// generated getters and setters.</span>
    ...
}</code></pre> 
<p>然后在litepal.xml中增加版本号：</p> 
<pre class="prettyprint"><code class=" hljs livecodeserver">&lt;<span class="hljs-built_in">version</span> <span class="hljs-built_in">value</span>=<span class="hljs-string">"2"</span> &gt;&lt;/<span class="hljs-built_in">version</span>&gt;</code></pre> 
<p>下面可以进行增删改查 <br> 增：</p> 
<pre class="prettyprint"><code class=" hljs avrasm">String name = albumEdit<span class="hljs-preprocessor">.getText</span>()<span class="hljs-preprocessor">.toString</span>()<span class="hljs-comment">;</span>
float price = <span class="hljs-number">109.8</span>f<span class="hljs-comment">;</span>
Album album = new Album()<span class="hljs-comment">;</span>
album<span class="hljs-preprocessor">.setName</span>(name)<span class="hljs-comment">;</span>
album<span class="hljs-preprocessor">.setPrice</span>(price)<span class="hljs-comment">;</span>
album<span class="hljs-preprocessor">.save</span>()<span class="hljs-comment">;</span></code></pre> 
<p>删：</p> 
<pre class="prettyprint"><code class=" hljs avrasm">Album album1 = DataSupport<span class="hljs-preprocessor">.find</span>(Album<span class="hljs-preprocessor">.class</span>,<span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
album1<span class="hljs-preprocessor">.setName</span>(<span class="hljs-string">"White"</span>)<span class="hljs-comment">;</span>
album1<span class="hljs-preprocessor">.save</span>()<span class="hljs-comment">;</span></code></pre> 
<p>改：</p> 
<pre class="prettyprint"><code class=" hljs d"><span class="hljs-keyword">int</span> row = DataSupport.deleteAll(Album.<span class="hljs-keyword">class</span>,<span class="hljs-string">"id&lt;?"</span>,<span class="hljs-string">"3"</span>);</code></pre> 
<p>查：</p> 
<pre class="prettyprint"><code class=" hljs avrasm">List&lt;Album&gt; albumList = DataSupport<span class="hljs-preprocessor">.where</span>(<span class="hljs-string">"name like ?"</span>,<span class="hljs-string">"a%"</span>)<span class="hljs-preprocessor">.order</span>(<span class="hljs-string">"name"</span>)<span class="hljs-preprocessor">.find</span>(Album<span class="hljs-preprocessor">.class</span>)<span class="hljs-comment">;</span>
for (Album a:
     albumList) {
    Log<span class="hljs-preprocessor">.e</span>(<span class="hljs-string">"MAIN"</span>,a<span class="hljs-preprocessor">.getName</span>()+<span class="hljs-string">"**********"</span>)<span class="hljs-comment">;</span>
     }</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c19bb2e1291d9dba69a4acd86732530d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">google cloud使用总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/389808d0af9715e9acb3296b124f3397/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android px转dip px转sp法则</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>