<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>线性/非线性规划问题求解 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="线性/非线性规划问题求解" />
<meta property="og:description" content="目录 1、用Excel求解线性规划问题一、使用Excel做线性回归二、验证回归方程的精度 2、拉格朗日求解最优问题——条件极值一、问题二、拉格朗日手工求解三、拉格朗日编程求解 参考链接 1、用Excel求解线性规划问题 一般购买的电脑都已经安装好了Microsoft Office，就不需要进行下载安装这一过程。
一、使用Excel做线性回归 1.添加数据分析的工具
如果选择数据后，在工具栏中有数据分析的选择，设置过程可以忽略。
①选择文件
②选择选项
③首先选择加载项，接着将管理处修改为Excel加载项，最后选择转到
④分析工具库和分析工具库-VBA勾选上，接着选择确定
⑤查看是否添加完成，如下图所示，表示添加成功
2.Excel完成线性回归分析
①打开需要进行分析的数据文件
②选择数据-&gt;数据分析-&gt;回归-&gt;确定
③进行相关设置
输出图表如下
默认生成的图表显示不是很好看，进行一些相关设置，使其显示更具清楚具体
修改后如下图所示
④选中原始数据，点击右键，选择添加趋势线
趋势线的格式设置：选择线性，勾选显示公式（其他更多设置根据需要进行选择）
最终效果图如下
对于其他数据进行线性回归分析操作过程一样。
二、验证回归方程的精度 1.R值
在统计学中R值是拟合优度指数,用来评价模型的拟合好坏等,取值范围是【-1,1】,越接近正负1越好。对应R平方来说越接近1越好。
R值的大小
通过数据分析可以计算出R平方的取值约为0.88，表明该模型的拟合程度还是比较好的。
2.P值
在统计学中P值是指（F检验或者T或者其余检验量）大于所求值时的概率,一般要小于给定α就说明检验显著。P值是检验样置信度的一个指标，一般我们认为p&lt;=0.05时(一般选择这个显著水平)，模型的信号不存在偶然性，模型的结果可靠。
P值的大小
通过数据分析可以看出P值远远小于0.05，表面得到的回归方程是可靠的。
说明： 一般通过R和P值的大小来判断一个模型是否是合适和可靠的。
2、拉格朗日求解最优问题——条件极值 一、问题 二、拉格朗日手工求解 2、偏导解变量
3、带入
三、拉格朗日编程求解 代码实现
# 导入包 from sympy import * # 设置变量 x,y,z,k = symbols(&#39;x,y,z,k&#39;) a,b,c=symbols(&#39;a,b,c&#39;) f = 8*x*y*z g = x**2/a**2&#43;y**2/b**2&#43;z**2/c**2-1 #构造拉格朗日函数 L=f&#43;k*g #求导 dx = diff(L, x) # 对x求偏导 print(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/d7147ab65a57b54f0d9e920e01cfeeed/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-01T19:55:33+08:00" />
<meta property="article:modified_time" content="2021-04-01T19:55:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">线性/非线性规划问题求解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><ul><li><a href="#1Excel_1" rel="nofollow">1、用Excel求解线性规划问题</a></li><li><ul><li><a href="#Excel_4" rel="nofollow">一、使用Excel做线性回归</a></li><li><a href="#_37" rel="nofollow">二、验证回归方程的精度</a></li></ul> 
    </li><li><a href="#2_50" rel="nofollow">2、拉格朗日求解最优问题——条件极值</a></li><li><ul><li><a href="#_51" rel="nofollow">一、问题</a></li><li><a href="#_53" rel="nofollow">二、拉格朗日手工求解</a></li><li><a href="#_60" rel="nofollow">三、拉格朗日编程求解</a></li></ul> 
    </li><li><a href="#_107" rel="nofollow">参考链接</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h4><a id="1Excel_1"></a>1、用Excel求解线性规划问题</h4> 
<blockquote> 
 <p>一般购买的电脑都已经安装好了Microsoft Office，就不需要进行下载安装这一过程。</p> 
</blockquote> 
<h5><a id="Excel_4"></a>一、使用Excel做线性回归</h5> 
<p>1.添加数据分析的工具</p> 
<blockquote> 
 <p>如果选择数据后，在工具栏中有数据分析的选择，设置过程可以忽略。</p> 
</blockquote> 
<p>①选择文件<br> <img src="https://images2.imgbox.com/c2/2f/dBh33vAu_o.png" alt="在这里插入图片描述"><br> ②选择选项<br> <img src="https://images2.imgbox.com/b8/03/mcq6kNlG_o.png" alt="在这里插入图片描述"><br> ③首先选择加载项，接着将管理处修改为Excel加载项，最后选择转到<br> <img src="https://images2.imgbox.com/23/a6/lUVnKEAB_o.png" alt="在这里插入图片描述"><br> ④分析工具库和分析工具库-VBA勾选上，接着选择确定<br> <img src="https://images2.imgbox.com/cb/9b/zFNWZ7Ak_o.png" alt="在这里插入图片描述"><br> ⑤查看是否添加完成，如下图所示，表示添加成功<br> <img src="https://images2.imgbox.com/11/70/txCkR8QF_o.png" alt="在这里插入图片描述"><br> 2.Excel完成线性回归分析<br> ①打开需要进行分析的数据文件<br> ②选择数据-&gt;数据分析-&gt;回归-&gt;确定<br> <img src="https://images2.imgbox.com/f6/e5/9KDWnixn_o.png" alt="在这里插入图片描述"><br> ③进行相关设置<br> <img src="https://images2.imgbox.com/03/ff/6FOIjBEP_o.png" alt="在这里插入图片描述"><br> 输出图表如下<br> <img src="https://images2.imgbox.com/44/de/SCLxj0hP_o.png" alt="在这里插入图片描述"><br> 默认生成的图表显示不是很好看，进行一些相关设置，使其显示更具清楚具体<br> <img src="https://images2.imgbox.com/fa/68/dl6v3Kzz_o.png" alt="在这里插入图片描述"><br> 修改后如下图所示<br> <img src="https://images2.imgbox.com/cb/a8/ggJj2N9k_o.png" alt="在这里插入图片描述"><br> ④选中原始数据，点击右键，选择添加趋势线<br> <img src="https://images2.imgbox.com/fb/e2/ICDLHxUJ_o.png" alt="在这里插入图片描述"><br> 趋势线的格式设置：选择线性，勾选显示公式（其他更多设置根据需要进行选择）<br> <img src="https://images2.imgbox.com/27/3f/kcO811B1_o.png" alt="在这里插入图片描述"><br> 最终效果图如下<br> <img src="https://images2.imgbox.com/7c/04/fXcPLHmf_o.png" alt="在这里插入图片描述"><br> 对于其他数据进行线性回归分析操作过程一样。</p> 
<h5><a id="_37"></a>二、验证回归方程的精度</h5> 
<p>1.R值<br> 在统计学中R值是拟合优度指数,用来评价模型的拟合好坏等,取值范围是【-1,1】,越接近正负1越好。对应R平方来说越接近1越好。<br> R值的大小<br> <img src="https://images2.imgbox.com/92/70/aVmeholy_o.png" alt="在这里插入图片描述"><br> 通过数据分析可以计算出R平方的取值约为0.88，表明该模型的拟合程度还是比较好的。<br> 2.P值<br> 在统计学中P值是指（F检验或者T或者其余检验量）大于所求值时的概率,一般要小于给定α就说明检验显著。P值是检验样置信度的一个指标，一般我们认为p&lt;=0.05时(一般选择这个显著水平)，模型的信号不存在偶然性，模型的结果可靠。<br> P值的大小<br> <img src="https://images2.imgbox.com/79/7f/FTiIJLZf_o.png" alt="在这里插入图片描述"><br> 通过数据分析可以看出P值远远小于0.05，表面得到的回归方程是可靠的。</p> 
<blockquote> 
 <p>说明： 一般通过R和P值的大小来判断一个模型是否是合适和可靠的。</p> 
</blockquote> 
<h4><a id="2_50"></a>2、拉格朗日求解最优问题——条件极值</h4> 
<h5><a id="_51"></a>一、问题</h5> 
<p><img src="https://images2.imgbox.com/ad/08/Lia8sYTj_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_53"></a>二、拉格朗日手工求解</h5> 
<p><img src="https://images2.imgbox.com/c0/07/KjsbdMwc_o.png" alt="在这里插入图片描述"><br> 2、偏导解变量<br> <img src="https://images2.imgbox.com/46/82/lLjLOl9O_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3d/d2/VGUnmIM7_o.png" alt="在这里插入图片描述"><br> 3、带入<br> <img src="https://images2.imgbox.com/40/9e/PI6RP36A_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_60"></a>三、拉格朗日编程求解</h5> 
<p>代码实现</p> 
<pre><code class="prism language-cpp"># 导入包
from sympy import <span class="token operator">*</span>
# 设置变量
x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span>k <span class="token operator">=</span> <span class="token function">symbols</span><span class="token punctuation">(</span><span class="token string">'x,y,z,k'</span><span class="token punctuation">)</span>
a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token function">symbols</span><span class="token punctuation">(</span><span class="token string">'a,b,c'</span><span class="token punctuation">)</span>
f <span class="token operator">=</span> <span class="token number">8</span><span class="token operator">*</span>x<span class="token operator">*</span>y<span class="token operator">*</span>z
g <span class="token operator">=</span> x<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">/</span>a<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span>y<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">/</span>b<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span>z<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">/</span>c<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span>
#构造拉格朗日函数
L<span class="token operator">=</span>f<span class="token operator">+</span>k<span class="token operator">*</span>g
#求导
dx <span class="token operator">=</span> <span class="token function">diff</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> x<span class="token punctuation">)</span>   # 对x求偏导
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"dx="</span><span class="token punctuation">,</span>dx<span class="token punctuation">)</span>
dy <span class="token operator">=</span> <span class="token function">diff</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span>y<span class="token punctuation">)</span>   #对y求偏导
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"dy="</span><span class="token punctuation">,</span>dy<span class="token punctuation">)</span>
dz <span class="token operator">=</span> <span class="token function">diff</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span>z<span class="token punctuation">)</span>   #对z求偏导
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"dz="</span><span class="token punctuation">,</span>dz<span class="token punctuation">)</span>
dk <span class="token operator">=</span> <span class="token function">diff</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span>k<span class="token punctuation">)</span>   #对k求偏导
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"dk="</span><span class="token punctuation">,</span>dk<span class="token punctuation">)</span>
dx<span class="token operator">=</span> <span class="token number">8</span><span class="token operator">*</span>y<span class="token operator">*</span>z <span class="token operator">+</span> <span class="token number">2</span><span class="token operator">*</span>k<span class="token operator">*</span>x<span class="token operator">/</span>a<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span>
dy<span class="token operator">=</span> <span class="token number">8</span><span class="token operator">*</span>x<span class="token operator">*</span>z <span class="token operator">+</span> <span class="token number">2</span><span class="token operator">*</span>k<span class="token operator">*</span>y<span class="token operator">/</span>b<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span>
dz<span class="token operator">=</span> <span class="token number">8</span><span class="token operator">*</span>x<span class="token operator">*</span>y <span class="token operator">+</span> <span class="token number">2</span><span class="token operator">*</span>k<span class="token operator">*</span>z<span class="token operator">/</span>c<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span>
dk<span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">+</span> z<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">/</span>c<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">+</span> y<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">/</span>b<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">+</span> x<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">/</span>a<span class="token operator">*</span><span class="token operator">*</span><span class="token number">2</span>
#求出个变量解
m<span class="token operator">=</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">[</span>dx<span class="token punctuation">,</span>dy<span class="token punctuation">,</span>dz<span class="token punctuation">,</span>dk<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span>   
<span class="token function">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
#变量赋值
x<span class="token operator">=</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span>a<span class="token operator">/</span><span class="token number">3</span>
y<span class="token operator">=</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span>b<span class="token operator">/</span><span class="token number">3</span>
z<span class="token operator">=</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span>c<span class="token operator">/</span><span class="token number">3</span>
k<span class="token operator">=</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span>a<span class="token operator">*</span>b<span class="token operator">*</span>c<span class="token operator">/</span><span class="token number">3</span>
#计算方程的值
f <span class="token operator">=</span> <span class="token number">8</span><span class="token operator">*</span>x<span class="token operator">*</span>y<span class="token operator">*</span>z
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"方程的最大值为："</span><span class="token punctuation">,</span>f<span class="token punctuation">)</span>

</code></pre> 
<p>通过diff函数求解的偏导</p> 
<p>通过solve函数求解变量</p> 
<p>最终求解结果<br> <img src="https://images2.imgbox.com/92/4b/KQcKOX4l_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_107"></a>参考链接</h4> 
<p><a href="https://jingyan.baidu.com/article/2a1383284ffee4464a134fa3.html" rel="nofollow">怎么用excel做线性回归分析</a><br> <a href="https://blog.csdn.net/xianyudewo/article/details/115379483">https://blog.csdn.net/xianyudewo/article/details/115379483</a><br> <a href="https://blog.csdn.net/qq_43279579/article/details/114375204">https://blog.csdn.net/qq_43279579/article/details/114375204</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9dca115faba4b72371596fecf672573c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">LeetCode 74.搜索二维矩阵</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d2afe49e25acae84bdcbfaefad1f7c4c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【问题】java.lang.ClassNotFoundException: org.apache.log4j.Logger异常问题引发的思考</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>