<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQLZOO练习 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQLZOO练习" />
<meta property="og:description" content="SQLZOO练习 前言一、SELECT basics二、SELECT name三、SELECT from WORLD四、SELECT in SELECT五、SUM and COUNT六、The JOIN operation七、More JOIN operation八、Using Null九、Self join 前言 这是来自SQLZOO的练习
地址：https://igs.sqlzoo.net/
一、SELECT basics 1.顯示德國 Germany 的人口
select name, population from world where name=&#39;Germany&#39;; 2.查詢面積為 5,000,000 以上平方公里的國家,對每個國家顯示她的名字和人均國內生產總值(gdp/population)
select name,gdp/population from world where area&gt;5000000; 3.顯示“Ireland 愛爾蘭”,“Iceland 冰島”,“Denmark 丹麥”的國家名稱和人口
select name ,population from world where name in(&#39;Ireland&#39;,&#39;Iceland&#39;,&#39;Denmark&#39;); 4.顯示面積為 200,000 及 250,000 之間的國家名稱和該國面積。
select name,area from world where area between 200000 and 250000; 二、SELECT name 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/674baeb2ca54b6cbe369bcac7a612cc0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-23T12:23:19+08:00" />
<meta property="article:modified_time" content="2021-01-23T12:23:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQLZOO练习</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <font color="#999AAA"> </font> 
<p></p> 
<div class="toc"> 
 <h4>SQLZOO练习</h4> 
 <ul><li><a href="#_9" rel="nofollow">前言</a></li><li><a href="#SELECT_basics_19" rel="nofollow">一、SELECT basics</a></li><li><a href="#SELECT_name_50" rel="nofollow">二、SELECT name</a></li><li><a href="#SELECT_from_WORLD_152" rel="nofollow">三、SELECT from WORLD</a></li><li><a href="#SELECT_in_SELECT_256" rel="nofollow">四、SELECT in SELECT</a></li><li><a href="#SUM_and_COUNT_343" rel="nofollow">五、SUM and COUNT</a></li><li><a href="#The_JOIN_operation_395" rel="nofollow">六、The JOIN operation</a></li><li><a href="#More_JOIN_operation_512" rel="nofollow">七、More JOIN operation</a></li><li><a href="#Using_Null_654" rel="nofollow">八、Using Null</a></li><li><a href="#Self_join_719" rel="nofollow">九、Self join</a></li></ul> 
</div> 
<p></p> 
<hr color="#000000" size='1"'> 
<h2><a id="_9"></a>前言</h2> 
<p><font color="#999AAA"> 　　这是来自SQLZOO的练习<br> 地址：https://igs.sqlzoo.net/</font></p> 
<hr color="#000000" size='1"'> 
<font color="#999AAA"> </font> 
<h2><a id="SELECT_basics_19"></a>一、SELECT basics</h2> 
<p>1.顯示德國 Germany 的人口</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name<span class="token punctuation">,</span> population 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> name<span class="token operator">=</span><span class="token string">'Germany'</span><span class="token punctuation">;</span>
</code></pre> 
<p>2.查詢面積為 5,000,000 以上平方公里的國家,對每個國家顯示她的名字和人均國內生產總值(gdp/population)</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name<span class="token punctuation">,</span>gdp<span class="token operator">/</span>population 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> area<span class="token operator">&gt;</span><span class="token number">5000000</span><span class="token punctuation">;</span>
</code></pre> 
<p>3.顯示“Ireland 愛爾蘭”,“Iceland 冰島”,“Denmark 丹麥”的國家名稱和人口</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name <span class="token punctuation">,</span>population 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> name <span class="token operator">in</span><span class="token punctuation">(</span><span class="token string">'Ireland'</span><span class="token punctuation">,</span><span class="token string">'Iceland'</span><span class="token punctuation">,</span><span class="token string">'Denmark'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>4.顯示面積為 200,000 及 250,000 之間的國家名稱和該國面積。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name<span class="token punctuation">,</span>area 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> area <span class="token operator">between</span> <span class="token number">200000</span> <span class="token operator">and</span> <span class="token number">250000</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="SELECT_name_50"></a>二、SELECT name</h2> 
<p>1.%是萬用字元,可以用代表任何字元。找出以 Y 為開首的國家。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'Y%'</span><span class="token punctuation">;</span>
</code></pre> 
<p>2.找出以 Y 為結尾的國家.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'%Y'</span><span class="token punctuation">;</span>
</code></pre> 
<p>3.“Luxembourg 盧森堡”中有一個x字母,還有一個國家的名字中有x。列出這兩個國家。找出所有國家,其名字包括字母x。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name 
<span class="token keyword">FROM</span> world 
<span class="token keyword">WHERE</span> name <span class="token operator">LIKE</span> <span class="token string">'%x%'</span><span class="token punctuation">;</span>
</code></pre> 
<p>4.找出所有國家,其名字以 land 作結尾。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name 
<span class="token keyword">FROM</span> world 
<span class="token keyword">WHERE</span> name <span class="token operator">LIKE</span> <span class="token string">'%land'</span><span class="token punctuation">;</span>
</code></pre> 
<p>5.找出所有國家,其名字以 C 作開始,ia 作結尾。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name 
<span class="token keyword">FROM</span> world 
<span class="token keyword">WHERE</span> name <span class="token operator">LIKE</span> <span class="token string">'c%ia'</span><span class="token punctuation">;</span>
</code></pre> 
<p>6.找出所有國家,其名字包括字母oo。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name 
<span class="token keyword">FROM</span> world 
<span class="token keyword">WHERE</span> name <span class="token operator">LIKE</span> <span class="token string">'%oo%'</span>
</code></pre> 
<p>7.找出所有國家,其名字包括三個或以上的a。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'%a%a%a%'</span><span class="token punctuation">;</span>
</code></pre> 
<p>8.找出所有國家,其名字以t作第二個字母。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name 
<span class="token keyword">FROM</span> world 
<span class="token keyword">WHERE</span> name <span class="token operator">LIKE</span> <span class="token string">'_t%'</span> 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> name<span class="token punctuation">;</span>
</code></pre> 
<p>9.找出所有國家,其名字都有兩個字母 o,被另外兩個字母相隔着。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> name <span class="token operator">like</span><span class="token string">'%o__o%'</span><span class="token punctuation">;</span>

<span class="token number">10.</span>找出所有國家<span class="token punctuation">,</span>其名字都是 <span class="token number">4</span> 個字母的。
<span class="token punctuation">`</span><span class="token punctuation">`</span><span class="token punctuation">`</span><span class="token keyword">sql</span>
<span class="token keyword">SELECT</span> name 
<span class="token keyword">FROM</span> world 
<span class="token keyword">WHERE</span> name <span class="token operator">LIKE</span> <span class="token string">'____'</span><span class="token punctuation">;</span>
</code></pre> 
<p>11.顯示所有國家名字,其首都和國家名字是相同的。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name 
<span class="token keyword">FROM</span> world 
<span class="token keyword">WHERE</span> name<span class="token operator">=</span>capital<span class="token punctuation">;</span>
</code></pre> 
<p>12.顯示所有國家名字,其首都是國家名字加上”City”</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name 
<span class="token keyword">FROM</span> world 
<span class="token keyword">WHERE</span> capital <span class="token operator">LIKE</span> concat<span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token string">' City'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>13.找出所有首都和其國家名字,而首都要有國家名字中出現。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> capital<span class="token punctuation">,</span>name 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> capital <span class="token operator">like</span> concat<span class="token punctuation">(</span><span class="token string">'%'</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>14.找出所有首都和其國家名字,而首都是國家名字的延伸。你應顯示 Mexico City,因它比其國家名字 Mexico 長。你不應顯示 Luxembourg,因它的首都和國家名相是相同的。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name<span class="token punctuation">,</span>capital 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> capital <span class="token operator">like</span> concat<span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token string">'_'</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>15.“Monaco-Ville"是合併國家名字 “Monaco” 和延伸詞”-Ville".顯示國家名字，及其延伸詞，如首都是國家名字的延伸。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name<span class="token punctuation">,</span><span class="token keyword">replace</span><span class="token punctuation">(</span>capital<span class="token punctuation">,</span>name<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ext 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> capital <span class="token operator">like</span> concat<span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token string">'_'</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="SELECT_from_WORLD_152"></a>三、SELECT from WORLD</h2> 
<p>2.如何使用WHERE來篩選記錄。 顯示具有至少2億人口的國家名稱。 2億是200000000，有八個零。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name 
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> population<span class="token operator">&gt;=</span><span class="token number">200000000</span><span class="token punctuation">;</span>
</code></pre> 
<p>3.找出有至少200百萬(2億)人口的國家名稱，及人均國內生產總值。<br> 求助：如何人均國內生產總值計算</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name<span class="token punctuation">,</span>gdp<span class="token operator">/</span>population 
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> population<span class="token operator">&gt;=</span><span class="token number">200000000</span><span class="token punctuation">;</span>
</code></pre> 
<p>4.顯示’South America’南美洲大陸的國家名字和以百萬為單位人口數。 將人口population 除以一百萬(1000000)得可得到以百萬為單位人口數。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name<span class="token punctuation">,</span>population<span class="token operator">/</span><span class="token number">1000000</span> 
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> continent<span class="token operator">=</span><span class="token string">'South America'</span><span class="token punctuation">;</span>
</code></pre> 
<p>5.顯示法國，德國，意大利(France, Germany, Italy)的國家名稱和人口</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name<span class="token punctuation">,</span>population 
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> name <span class="token operator">in</span><span class="token punctuation">(</span><span class="token string">'France'</span><span class="token punctuation">,</span> <span class="token string">'Germany'</span><span class="token punctuation">,</span> <span class="token string">'Italy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>6.顯示包含單詞“United”為名稱的國家。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name 
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> name <span class="token operator">like</span> <span class="token string">'%United%'</span><span class="token punctuation">;</span>
</code></pre> 
<p>7.成為大國的兩種方式：如果它有3百萬平方公里以上的面積，或擁有250百萬(2.5億)以上人口。<br> 展示大國的名稱，人口和面積</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name<span class="token punctuation">,</span>population<span class="token punctuation">,</span>area 
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> area<span class="token operator">&gt;=</span><span class="token number">3000000</span> <span class="token operator">or</span> population <span class="token operator">&gt;=</span><span class="token number">250000000</span><span class="token punctuation">;</span>
</code></pre> 
<p>8.美國、印度和中國(USA, India, China)是人口又大，同時面積又大的國家。排除這些國家。<br> 顯示以人口或面積為大國的國家，但不能同時兩者。顯示國家名稱，人口和面積。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name<span class="token punctuation">,</span>population<span class="token punctuation">,</span>area 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> <span class="token punctuation">(</span>area <span class="token operator">&gt;</span> <span class="token number">3000000</span> <span class="token operator">and</span> population <span class="token operator">&lt;=</span> <span class="token number">250000000</span><span class="token punctuation">)</span> 
<span class="token operator">or</span> <span class="token punctuation">(</span>area <span class="token operator">&lt;=</span> <span class="token number">3000000</span> <span class="token operator">and</span> population <span class="token operator">&gt;</span> <span class="token number">250000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name<span class="token punctuation">,</span>population<span class="token punctuation">,</span>area 
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> <span class="token operator">not</span><span class="token punctuation">(</span>area<span class="token operator">&gt;=</span><span class="token number">3000000</span> <span class="token operator">and</span> population <span class="token operator">&gt;=</span><span class="token number">250000000</span><span class="token punctuation">)</span> 
<span class="token operator">and</span><span class="token punctuation">(</span>area<span class="token operator">&gt;=</span><span class="token number">3000000</span> <span class="token operator">or</span> population <span class="token operator">&gt;=</span><span class="token number">250000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>9.除以為1000000（6個零）是以百萬計。除以1000000000（9個零）是以十億計。使用 ROUND 函數來顯示的數值到小數點後兩位。<br> 對於南美顯示以百萬計人口，以十億計2位小數GDP。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name<span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span>population<span class="token operator">/</span><span class="token number">1000000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span>gdp<span class="token operator">/</span><span class="token number">1000000000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> continent<span class="token operator">=</span><span class="token string">'South America'</span><span class="token punctuation">;</span>
</code></pre> 
<p>10.顯示國家有至少一個萬億元國內生產總值（萬億，也就是12個零）的人均國內生產總值。四捨五入這個值到最接近1000。<br> 顯示萬億元國家的人均國內生產總值，四捨五入到最近的$ 1000。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span>gdp<span class="token operator">/</span>population<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span> 
<span class="token keyword">from</span> world 
<span class="token keyword">where</span> gdp<span class="token operator">&gt;</span><span class="token number">1000000000000</span><span class="token punctuation">;</span>
</code></pre> 
<p>11.Show the name - but substituteAustralasiaforOceania- for countries beginning with N.</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name<span class="token punctuation">,</span>
<span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> continent<span class="token operator">=</span><span class="token string">'Australasia'</span> <span class="token keyword">THEN</span> <span class="token string">'Oceania'</span>
<span class="token keyword">ELSE</span> continent <span class="token keyword">END</span>
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> name <span class="token operator">LIKE</span> <span class="token string">'N%'</span><span class="token punctuation">;</span>
</code></pre> 
<p>12.Show the name and the continent - but substituteEurasiafor Europe and Asia; substituteAmerica- for each country inNorth AmericaorSouth AmericaorCaribbean. Show countries beginning with A or B</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name <span class="token punctuation">,</span>
<span class="token keyword">case</span> <span class="token keyword">when</span> continent <span class="token operator">in</span><span class="token punctuation">(</span><span class="token string">'Europe'</span><span class="token punctuation">,</span><span class="token string">'Asia'</span><span class="token punctuation">)</span> <span class="token keyword">then</span> <span class="token string">'Eurasia'</span>
<span class="token keyword">when</span> continent <span class="token operator">in</span><span class="token punctuation">(</span><span class="token string">'North America'</span><span class="token punctuation">,</span><span class="token string">'South America'</span><span class="token punctuation">,</span><span class="token string">'Caribbean'</span><span class="token punctuation">)</span> <span class="token keyword">then</span> <span class="token string">'America'</span>
<span class="token keyword">else</span> continent <span class="token keyword">end</span>
<span class="token keyword">from</span> world
<span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'A%'</span> <span class="token operator">or</span> name <span class="token operator">like</span> <span class="token string">'B%'</span><span class="token punctuation">;</span>
</code></pre> 
<p>13.Put the continents right…<br> • Oceania becomes Australasia<br> • Countries in Eurasia and Turkey go to Europe/Asia<br> • Caribbean islands starting with ‘B’ go to North America, other Caribbean islands go to South America<br> Show the name, the original continent and the new continent of all countries.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name<span class="token punctuation">,</span>continent<span class="token punctuation">,</span>
<span class="token keyword">case</span> <span class="token keyword">when</span> continent <span class="token operator">=</span> <span class="token string">'Oceania'</span> <span class="token keyword">then</span> <span class="token string">'Australasia'</span>
<span class="token keyword">when</span> continent <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'Eurasia'</span><span class="token punctuation">,</span><span class="token string">'Turkey'</span><span class="token punctuation">)</span> <span class="token keyword">then</span> <span class="token string">'Europe/Asia'</span>
<span class="token keyword">when</span> continent <span class="token operator">=</span> <span class="token string">'Caribbean'</span><span class="token operator">and</span> name <span class="token operator">like</span> <span class="token string">'B%'</span> <span class="token keyword">then</span> <span class="token string">'North America'</span>
<span class="token keyword">when</span> continent <span class="token operator">=</span> <span class="token string">'Caribbean'</span><span class="token operator">and</span> name <span class="token operator">not</span> <span class="token operator">like</span> <span class="token string">'B%'</span> <span class="token keyword">then</span> <span class="token string">'South America'</span>
<span class="token keyword">else</span> continent <span class="token keyword">end</span>
<span class="token keyword">from</span> world
<span class="token keyword">order</span> <span class="token keyword">by</span> name
</code></pre> 
<h2><a id="SELECT_in_SELECT_256"></a>四、SELECT in SELECT</h2> 
<ol><li>列出每個國家的名字 name，當中人口 population 是高於俄羅斯’Russia’的人口。</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name <span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> population <span class="token operator">&gt;</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> population <span class="token keyword">FROM</span> world <span class="token keyword">WHERE</span> name<span class="token operator">=</span><span class="token string">'Russia'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="2"><li>列出歐州每國家的人均GDP，當中人均GDP要高於英國’United Kingdom’的數值。</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> continent <span class="token operator">=</span> <span class="token string">'Europe'</span>
<span class="token operator">AND</span> gdp<span class="token operator">/</span>population <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> gdp<span class="token operator">/</span>population 
<span class="token keyword">FROM</span> world 
<span class="token keyword">WHERE</span> name <span class="token operator">=</span> <span class="token string">'United Kingdom'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="3"><li>在阿根廷Argentina 及 澳大利亞 Australia所在的洲份中，列出當中的國家名字 name 及洲分 continent 。按國字名字順序排序</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name<span class="token punctuation">,</span> continent
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> continent <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> continent 
<span class="token keyword">FROM</span> world 
<span class="token keyword">WHERE</span> name <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'Argentina'</span><span class="token punctuation">,</span> <span class="token string">'Australia'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> name<span class="token punctuation">;</span>
</code></pre> 
<ol start="4"><li>哪一個國家的人口比加拿大Canada的多，但比波蘭Poland的少?列出國家名字name和人口population 。</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name<span class="token punctuation">,</span> population
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> population <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> population 
<span class="token keyword">FROM</span> world <span class="token keyword">WHERE</span> name <span class="token operator">=</span> <span class="token string">'Canada'</span><span class="token punctuation">)</span>
<span class="token operator">AND</span>  population <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> population 
<span class="token keyword">FROM</span> world <span class="token keyword">WHERE</span> name <span class="token operator">=</span> <span class="token string">'Poland'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="5"><li>Germany德國（人口8000萬），在Europe歐洲國家的人口最多。Austria奧地利（人口850萬）擁有德國總人口的11％。顯示歐洲的國家名稱name和每個國家的人口population。以德國的人口的百分比作人口顯示。</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name<span class="token punctuation">,</span> CONCAT<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span>population<span class="token operator">*</span><span class="token number">100</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> population 
<span class="token keyword">FROM</span> world <span class="token keyword">WHERE</span> name <span class="token operator">=</span> <span class="token string">'Germany'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token string">'%'</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> continent <span class="token operator">=</span> <span class="token string">'Europe'</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="6"><li>哪些國家的GDP比Europe歐洲的全部國家都要高呢? [只需列出 name 。] (有些國家的記錄中，GDP是NULL，沒有填入資料的。)</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> gdp <span class="token operator">&gt;</span> <span class="token keyword">ALL</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> gdp 
<span class="token keyword">FROM</span> world 
<span class="token keyword">where</span> continent <span class="token operator">=</span> <span class="token string">'Europe'</span> <span class="token operator">AND</span> gdp <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="7"><li>在每一個州中找出最大面積的國家，列出洲份 continent, 國家名字 name 及面積 area。 (有些國家的記錄中，AREA是NULL，沒有填入資料的。)</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> continent<span class="token punctuation">,</span> name<span class="token punctuation">,</span> area <span class="token keyword">FROM</span> world x
<span class="token keyword">WHERE</span> area <span class="token operator">&gt;=</span> <span class="token keyword">ALL</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> area <span class="token keyword">FROM</span> world y
 <span class="token keyword">WHERE</span> y<span class="token punctuation">.</span>continent<span class="token operator">=</span>x<span class="token punctuation">.</span>continent
 <span class="token operator">AND</span> area<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="8"><li>列出洲份名稱，和每個洲份中國家名字按子母順序是排首位的國家名。(即每洲只有列一國)</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> continent<span class="token punctuation">,</span> name 
<span class="token keyword">FROM</span> world x
<span class="token keyword">WHERE</span> x<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> name 
<span class="token keyword">FROM</span> world y 
<span class="token keyword">WHERE</span> x<span class="token punctuation">.</span>continent <span class="token operator">=</span> y<span class="token punctuation">.</span>continent 
<span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="9"><li>找出洲份，當中全部國家都有少於或等於 25000000 人口. 在這些洲份中，列出國家名字name，continent 洲份和population人口。</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name<span class="token punctuation">,</span> continent<span class="token punctuation">,</span> population
<span class="token keyword">FROM</span> world <span class="token keyword">as</span> a
<span class="token keyword">WHERE</span> <span class="token number">25000000</span> <span class="token operator">&gt;</span> <span class="token keyword">ALL</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> population 
<span class="token keyword">from</span> world <span class="token keyword">as</span> b 
<span class="token keyword">where</span> a<span class="token punctuation">.</span>continent <span class="token operator">=</span> b<span class="token punctuation">.</span>continent 
<span class="token operator">and</span> population <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="10"><li>有些國家的人口是同洲份的所有其他國的3倍或以上。列出 國家名字name 和 洲份 continent。</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> name<span class="token punctuation">,</span> continent
<span class="token keyword">FROM</span> world <span class="token keyword">AS</span> a
<span class="token keyword">WHERE</span> population<span class="token operator">/</span><span class="token number">3</span> <span class="token operator">&gt;=</span> <span class="token keyword">ALL</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> population 
<span class="token keyword">FROM</span> world <span class="token keyword">AS</span> b 
<span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>continent <span class="token operator">=</span> b<span class="token punctuation">.</span>continent 
<span class="token operator">AND</span> a<span class="token punctuation">.</span>population <span class="token operator">!=</span> b<span class="token punctuation">.</span>population<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="SUM_and_COUNT_343"></a>五、SUM and COUNT</h2> 
<ol><li>展示世界的總人口。</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>population<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> world<span class="token punctuation">;</span>
</code></pre> 
<ol start="2"><li>列出所有的洲份, 每個只有一次。</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span><span class="token punctuation">(</span>continent<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> world<span class="token punctuation">;</span>
</code></pre> 
<ol start="3"><li>找出非洲(Africa)的GDP總和。</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>gdp<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> continent <span class="token operator">=</span> <span class="token string">'Africa'</span><span class="token number">3</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="4"><li>有多少個國家具有至少百萬(1000000)的面積。</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> area <span class="token operator">&gt;</span> <span class="token number">1000000</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="5"><li>(‘France’,‘Germany’,‘Spain’)（“法國”，“德國”，“西班牙”）的總人口是多少？</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>population<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> name <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'France'</span><span class="token punctuation">,</span> <span class="token string">'Germany'</span><span class="token punctuation">,</span> <span class="token string">'Spain'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="6"><li>對於每一個洲份，顯示洲份和國家的數量。</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> continent<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> world
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> continent<span class="token punctuation">;</span>
</code></pre> 
<ol start="7"><li>對於每一個洲份，顯示洲份和至少有1000萬人(10,000,000)口國家的數目。</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> continent<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> world
<span class="token keyword">WHERE</span> population <span class="token operator">&gt;</span> <span class="token number">10000000</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> continent<span class="token punctuation">;</span>
</code></pre> 
<ol start="8"><li>列出有至少100百萬(1億)(100,000,000)人口的洲份。</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> continent
<span class="token keyword">FROM</span> world
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> continent
<span class="token keyword">HAVING</span> <span class="token function">SUM</span><span class="token punctuation">(</span>population<span class="token punctuation">)</span><span class="token operator">&gt;=</span> <span class="token number">100000000</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="The_JOIN_operation_395"></a>六、The JOIN operation</h2> 
<ol><li></ol> 
<p>The first example shows the goal scored by a player with the last name ‘Bender’. The * says to list all the columns in the table - a shorter way of saying matchid, teamid, player, gtime<br> Modify it to show the matchid and player name for all goals scored by Germany. To identify German players, check for: teamid = ‘GER’</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> matchid<span class="token punctuation">,</span> player 
<span class="token keyword">FROM</span> goal 
<span class="token keyword">WHERE</span> teamid <span class="token operator">=</span> <span class="token string">'GER'</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="2"><li></ol> 
<p>From the previous query you can see that Lars Bender’s scored a goal in game 1012. Now we want to know what teams were playing in that match.<br> Notice in the that the column matchid in the goal table corresponds to the id column in the game table. We can look up information about game 1012 by finding that row in the game table.<br> Show id, stadium, team1, team2 for just game 1012</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> stadium<span class="token punctuation">,</span> team1<span class="token punctuation">,</span> team2 
<span class="token keyword">FROM</span> game
<span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1012</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="3"><li></ol> 
<p>You can combine the two steps into a single query with a JOIN.<br> SELECT * FROM game JOIN goal ON (id=matchid)<br> The FROM clause says to merge data from the goal table with that from the game table. The ON says how to figure out which rows in game go with which rows in goal - the matchid from goal must match id from game. (If we wanted to be more clear/specific we could say<br> ON (game.id=goal.matchid)<br> The code below shows the player (from the goal) and stadium name (from the game table) for every goal scored.<br> Modify it to show the player, teamid, stadium and mdate for every German goal.</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> player<span class="token punctuation">,</span>teamid<span class="token punctuation">,</span>stadium<span class="token punctuation">,</span> mdate
<span class="token keyword">FROM</span> game <span class="token keyword">JOIN</span> goal <span class="token keyword">ON</span> <span class="token punctuation">(</span>id<span class="token operator">=</span>matchid<span class="token punctuation">)</span> 
<span class="token keyword">where</span> goal<span class="token punctuation">.</span>teamid <span class="token operator">=</span> <span class="token string">'GER'</span><span class="token punctuation">;</span>
</code></pre> 
<p>4.Use the same JOIN as in the previous question.<br> Show the team1, team2 and player for every goal scored by a player called Mario player LIKE ‘Mario%’</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> team1<span class="token punctuation">,</span>team2<span class="token punctuation">,</span>player 
<span class="token keyword">from</span> game <span class="token keyword">join</span> goal <span class="token keyword">on</span> id <span class="token operator">=</span> matchid 
<span class="token keyword">where</span> player <span class="token operator">like</span> <span class="token string">'Mario%'</span>
</code></pre> 
<p>5.The table eteam gives details of every national team including the coach. You can JOIN goal to eteam using the phrase goal JOIN eteam on teamid=id<br> Show player, teamid, coach, gtime for all goals scored in the first 10 minutes gtime&lt;=10</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> goal<span class="token punctuation">.</span>player<span class="token punctuation">,</span> goal<span class="token punctuation">.</span>teamid<span class="token punctuation">,</span> eteam<span class="token punctuation">.</span>coach<span class="token punctuation">,</span> goal<span class="token punctuation">.</span>gtime 
<span class="token keyword">FROM</span> goal <span class="token keyword">JOIN</span> eteam <span class="token keyword">ON</span> <span class="token punctuation">(</span>teamid <span class="token operator">=</span> id<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> gtime <span class="token operator">&lt;=</span> <span class="token number">10</span>
</code></pre> 
<p>6.To JOIN game with eteam you could use either<br> game JOIN eteam ON (team1=eteam.id) or game JOIN eteam ON (team2=eteam.id)<br> Notice that because id is a column name in both game and eteam you must specify eteam.id instead of just id<br> List the dates of the matches and the name of the team in which ‘Fernando Santos’ was the team1 coach.</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> game<span class="token punctuation">.</span>mdate<span class="token punctuation">,</span> eteam<span class="token punctuation">.</span>teamname 
<span class="token keyword">FROM</span> game <span class="token keyword">JOIN</span> eteam <span class="token keyword">ON</span><span class="token punctuation">(</span>team1<span class="token operator">=</span>eteam<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> coach <span class="token operator">=</span> <span class="token string">'Fernando Santos'</span><span class="token punctuation">;</span>
</code></pre> 
<p>7.List the player for every goal scored in a game where the stadium was 'National Stadium, Warsaw</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> player 
<span class="token keyword">FROM</span> goal <span class="token keyword">JOIN</span> game <span class="token keyword">ON</span><span class="token punctuation">(</span>game<span class="token punctuation">.</span>id <span class="token operator">=</span> goal<span class="token punctuation">.</span>matchid<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> stadium <span class="token operator">=</span> <span class="token string">'National Stadium, Warsaw'</span><span class="token punctuation">;</span>
</code></pre> 
<p>8.The example query shows all goals scored in the Germany-Greece quarterfinal.<br> Instead show the name of all players who scored a goal against Germany.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">DISTINCT</span><span class="token punctuation">(</span>player<span class="token punctuation">)</span> 
<span class="token keyword">from</span> game <span class="token keyword">join</span> goal <span class="token keyword">on</span> id <span class="token operator">=</span> matchid
<span class="token keyword">where</span> teamid<span class="token operator">!=</span><span class="token string">'GER'</span> 
<span class="token operator">and</span> <span class="token punctuation">(</span>game<span class="token punctuation">.</span>team1<span class="token operator">=</span><span class="token string">'GER'</span> <span class="token operator">or</span> game<span class="token punctuation">.</span>team2<span class="token operator">=</span><span class="token string">'GER'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="9"><li></ol> 
<p>Show teamname and the total number of goals scored.</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> teamname<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> eteam <span class="token keyword">JOIN</span> goal <span class="token keyword">ON</span> id<span class="token operator">=</span>teamid
<span class="token keyword">group</span> <span class="token keyword">by</span> teamname
</code></pre> 
<ol start="10"><li></ol> 
<p>Show the stadium and the number of goals scored in each stadium.</p> 
<pre><code class="prism language-sql">
<span class="token keyword">select</span> stadium<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> game 
<span class="token keyword">join</span> goal <span class="token keyword">on</span> id <span class="token operator">=</span> matchid
<span class="token keyword">group</span> <span class="token keyword">by</span> stadium
</code></pre> 
<ol start="11"><li></ol> 
<p>For every match involving ‘POL’, show the matchid, date and the number of goals scored.</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> matchid<span class="token punctuation">,</span>mdate<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>teamid<span class="token punctuation">)</span> 
<span class="token keyword">FROM</span> game <span class="token keyword">JOIN</span> goal <span class="token keyword">ON</span> matchid <span class="token operator">=</span> id 
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span>team1 <span class="token operator">=</span> <span class="token string">'POL'</span> <span class="token operator">OR</span> team2 <span class="token operator">=</span> <span class="token string">'POL'</span><span class="token punctuation">)</span> 
<span class="token keyword">group</span> <span class="token keyword">by</span> matchid<span class="token punctuation">,</span>mdate<span class="token punctuation">;</span>
</code></pre> 
<ol start="12"><li></ol> 
<p>For every match where ‘GER’ scored, show matchid, match date and the number of goals scored by ‘GER’</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> matchid<span class="token punctuation">,</span>mdate<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 
<span class="token keyword">from</span> game <span class="token keyword">join</span> goal <span class="token keyword">on</span> id <span class="token operator">=</span> matchid
<span class="token keyword">where</span> teamid <span class="token operator">=</span> <span class="token string">'GER'</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> matchid<span class="token punctuation">,</span>mdate
</code></pre> 
<ol start="13"><li></ol> 
<p>List every match with the goals scored by each team as shown. This will use “CASE WHEN” which has not been explained in any previous exercises.</p> 
<p>Notice in the query given every goal is listed. If it was a team1 goal then a 1 appears in score1, otherwise there is a 0. You could SUM this column to get a count of the goals scored by team1. Sort your result by mdate, matchid, team1 and team2.</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> game<span class="token punctuation">.</span>mdate<span class="token punctuation">,</span> game<span class="token punctuation">.</span>team1<span class="token punctuation">,</span>
<span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> teamid <span class="token operator">=</span> team1 <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> score1<span class="token punctuation">,</span>team2<span class="token punctuation">,</span>
<span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> teamid <span class="token operator">=</span> team2 <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> score2 
<span class="token keyword">FROM</span> game <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> goal <span class="token keyword">ON</span> <span class="token punctuation">(</span>game<span class="token punctuation">.</span>id <span class="token operator">=</span> matchid<span class="token punctuation">)</span>  
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> mdate<span class="token punctuation">,</span> matchid<span class="token punctuation">,</span> team1<span class="token punctuation">,</span> team2<span class="token punctuation">;</span>
</code></pre> 
<h2><a id="More_JOIN_operation_512"></a>七、More JOIN operation</h2> 
<p>1.列出1962年首影的電影， [顯示 id, title]</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> title
<span class="token keyword">FROM</span> movie
<span class="token keyword">WHERE</span> yr<span class="token operator">=</span><span class="token number">1962</span><span class="token punctuation">;</span>
</code></pre> 
<p>2.電影大國民 ‘Citizen Kane’ 的首影年份</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> yr 
<span class="token keyword">from</span> movie
<span class="token keyword">where</span> title <span class="token operator">=</span> <span class="token string">'Citizen Kane'</span><span class="token punctuation">;</span>
</code></pre> 
<p>3.列出全部Star Trek星空奇遇記系列的電影，包括id, title 和 yr(此系統電影都以Star Trek為電影名稱的開首)。按年份順序排列。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> id<span class="token punctuation">,</span> title<span class="token punctuation">,</span> yr
<span class="token keyword">from</span> movie
<span class="token keyword">where</span> title <span class="token operator">like</span> <span class="token string">'Star Trek%'</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> yr<span class="token punctuation">;</span>
</code></pre> 
<p>4.id是 11768, 11955, 21191 的電影是什麼名稱?</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> title
<span class="token keyword">from</span> movie
<span class="token keyword">where</span> id <span class="token operator">in</span><span class="token punctuation">(</span><span class="token number">11768</span><span class="token punctuation">,</span> <span class="token number">11955</span><span class="token punctuation">,</span> <span class="token number">21191</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>5.女演員’Glenn Close’的編號 id是什麼?</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> id
<span class="token keyword">from</span> actor
<span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'Glenn Close'</span><span class="token punctuation">;</span>
</code></pre> 
<p>6.電影北非諜影’Casablanca’ 的編號 id是什麼?</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> id 
<span class="token keyword">from</span> movie
<span class="token keyword">where</span> title <span class="token operator">=</span> <span class="token string">'Casablanca'</span><span class="token punctuation">;</span>
</code></pre> 
<p>7.列出電影北非諜影 'Casablanca’的演員名單。<br> 什麼是演員名單?<br> 演員名單,即是電影中各演員的真實姓名清單。<br> 使用 movieid=11768, 這是你上一題得到的結果。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name
<span class="token keyword">from</span> actor <span class="token keyword">join</span> casting <span class="token keyword">on</span> id <span class="token operator">=</span> actorid
<span class="token keyword">where</span><span class="token punctuation">(</span>movieid <span class="token operator">=</span> <span class="token number">11768</span><span class="token punctuation">)</span>
</code></pre> 
<p>8.顯示電影異型’Alien’ 的演員清單。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name
<span class="token keyword">from</span> actor <span class="token keyword">join</span> casting <span class="token keyword">on</span> actor<span class="token punctuation">.</span>id<span class="token operator">=</span>casting<span class="token punctuation">.</span>actorid
<span class="token keyword">where</span> movieid <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">select</span> id <span class="token keyword">from</span> movie <span class="token keyword">where</span> title <span class="token operator">=</span> <span class="token string">'Alien'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> 
<p>9.列出演員夏里遜福 ‘Harrison Ford’ 曾演出的電影。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> title
<span class="token keyword">from</span> movie <span class="token keyword">join</span> casting <span class="token keyword">on</span> id <span class="token operator">=</span> movieid
<span class="token keyword">where</span> actorid <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id <span class="token keyword">from</span> actor <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'Harrison Ford'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>10.列出演員夏里遜福 ‘Harrison Ford’ 曾演出的電影，但他不是第1主角。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> title
<span class="token keyword">from</span> movie <span class="token keyword">join</span> casting <span class="token keyword">on</span> id <span class="token operator">=</span> movieid
<span class="token keyword">where</span> actorid <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id <span class="token keyword">from</span> actor <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'Harrison Ford'</span><span class="token punctuation">)</span> <span class="token operator">and</span> ord <span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<p>11.列出1962年首影的電影及它的第1主角。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> title<span class="token punctuation">,</span> name
<span class="token keyword">from</span> movie 
<span class="token keyword">join</span> casting <span class="token keyword">on</span> movie<span class="token punctuation">.</span>id <span class="token operator">=</span> movieid
<span class="token keyword">join</span> actor <span class="token keyword">on</span> actor<span class="token punctuation">.</span>id <span class="token operator">=</span> actorid
<span class="token keyword">where</span> yr <span class="token operator">=</span> <span class="token number">1962</span> <span class="token operator">and</span> ord <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="12"><li></ol> 
<p>尊·特拉華達’John Travolta’最忙是哪一年? 顯示年份和該年的電影數目。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> yr<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span> 
<span class="token keyword">FROM</span> movie 
<span class="token keyword">JOIN</span> casting <span class="token keyword">ON</span> movie<span class="token punctuation">.</span>id<span class="token operator">=</span>movieid
<span class="token keyword">JOIN</span> actor   <span class="token keyword">ON</span> actorid<span class="token operator">=</span>actor<span class="token punctuation">.</span>id
<span class="token keyword">where</span> name<span class="token operator">=</span><span class="token string">'John Travolta'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> yr
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> 
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> yr<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token keyword">AS</span> c 
<span class="token keyword">FROM</span> movie 
<span class="token keyword">JOIN</span> casting <span class="token keyword">ON</span> movie<span class="token punctuation">.</span>id<span class="token operator">=</span>movieid
<span class="token keyword">JOIN</span> actor   <span class="token keyword">ON</span> actorid<span class="token operator">=</span>actor<span class="token punctuation">.</span>id
<span class="token keyword">where</span> name<span class="token operator">=</span><span class="token string">'John Travolta'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> yr<span class="token punctuation">)</span> <span class="token keyword">AS</span> t<span class="token punctuation">)</span>
</code></pre> 
<p>13.列出演員茱莉·安德絲’Julie Andrews’曾參與的電影名稱及其第1主角。<br> 是否列了電影 "Little Miss Marker"兩次?</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> title<span class="token punctuation">,</span>name 
<span class="token keyword">from</span> movie 
<span class="token keyword">JOIN</span> casting <span class="token keyword">ON</span> movie<span class="token punctuation">.</span>id<span class="token operator">=</span>movieid
<span class="token keyword">JOIN</span> actor <span class="token keyword">ON</span> actorid<span class="token operator">=</span>actor<span class="token punctuation">.</span>id
<span class="token keyword">where</span> ord<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> movie<span class="token punctuation">.</span>id <span class="token operator">in</span> 
<span class="token punctuation">(</span><span class="token keyword">select</span> movie<span class="token punctuation">.</span>id <span class="token keyword">from</span> movie <span class="token keyword">join</span> casting <span class="token keyword">on</span> movie<span class="token punctuation">.</span>id<span class="token operator">=</span>movieid
<span class="token keyword">join</span> actor <span class="token keyword">on</span> actorid<span class="token operator">=</span>actor<span class="token punctuation">.</span>id <span class="token keyword">where</span> name<span class="token operator">=</span><span class="token string">'Julie Andrews'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>14.列出按字母順序，列出哪一演員曾作30次第1主角。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name 
<span class="token keyword">from</span> actor
<span class="token keyword">where</span> id <span class="token operator">in</span><span class="token punctuation">(</span><span class="token keyword">select</span> actorid
<span class="token keyword">from</span> casting
<span class="token keyword">where</span> ord <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> actorid
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>movieid<span class="token punctuation">)</span> <span class="token operator">&gt;=</span><span class="token number">30</span><span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> name
</code></pre> 
<p>15.列出1978年首影的電影名稱及角色數目，按此數目由多至少排列。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> title<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>actorid<span class="token punctuation">)</span> 
<span class="token keyword">from</span> movie <span class="token keyword">join</span> casting <span class="token keyword">on</span> id<span class="token operator">=</span>movieid
<span class="token keyword">where</span> yr <span class="token operator">=</span> <span class="token number">1978</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> title
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">count</span><span class="token punctuation">(</span>actorid<span class="token punctuation">)</span> <span class="token keyword">desc</span>
</code></pre> 
<ol start="16"><li></ol> 
<p>列出曾與演員亞特·葛芬柯’Art Garfunkel’合作過的演員姓名。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name 
<span class="token keyword">from</span> actor <span class="token keyword">join</span> casting <span class="token keyword">on</span> actorid<span class="token operator">=</span>id
<span class="token keyword">where</span> name<span class="token operator">!=</span><span class="token string">'Art Garfunkel'</span>
<span class="token operator">and</span> movieid <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> movieid <span class="token keyword">from</span> casting <span class="token keyword">join</span> actor <span class="token keyword">on</span> actorid<span class="token operator">=</span>id
<span class="token keyword">where</span> name <span class="token operator">=</span><span class="token string">'Art Garfunkel'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="Using_Null_654"></a>八、Using Null</h2> 
<p>1.List the teachers who have NULL for their department.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name 
<span class="token keyword">from</span> teacher
<span class="token keyword">where</span> dept <span class="token operator">is</span> <span class="token boolean">null</span>
</code></pre> 
<p>2.Note the INNER JOIN misses the teachers with no department and the departments with no teacher.</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> teacher<span class="token punctuation">.</span>name<span class="token punctuation">,</span> dept<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> teacher <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> dept <span class="token keyword">ON</span> <span class="token punctuation">(</span>teacher<span class="token punctuation">.</span>dept<span class="token operator">=</span>dept<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
</code></pre> 
<p>3.Use a different JOIN so that all teachers are listed.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> teacher<span class="token punctuation">.</span>name<span class="token punctuation">,</span>dept<span class="token punctuation">.</span>name 
<span class="token keyword">from</span> teacher <span class="token keyword">left</span> <span class="token keyword">join</span> dept <span class="token keyword">on</span> <span class="token punctuation">(</span>teacher<span class="token punctuation">.</span>dept<span class="token operator">=</span>dept<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
</code></pre> 
<p>4.Use a different JOIN so that all departments are listed.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> teacher<span class="token punctuation">.</span>name<span class="token punctuation">,</span>dept<span class="token punctuation">.</span>name 
<span class="token keyword">from</span> teacher <span class="token keyword">right</span> <span class="token keyword">join</span> dept <span class="token keyword">on</span> <span class="token punctuation">(</span>teacher<span class="token punctuation">.</span>dept<span class="token operator">=</span>dept<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
</code></pre> 
<p>5.Use COALESCE to print the mobile number. Use the number ‘07986 444 2266’ if there is no number given. Show teacher name and mobile number or ‘07986 444 2266’</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name<span class="token punctuation">,</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>mobile<span class="token punctuation">,</span><span class="token string">'07986 444 2266'</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> teacher
</code></pre> 
<p>6.Use the COALESCE function and a LEFT JOIN to print the teacher name and department name. Use the string ‘None’ where there is no department.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> teacher<span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>dept<span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token string">'None'</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> teacher <span class="token keyword">left</span> <span class="token keyword">join</span> dept <span class="token keyword">on</span> <span class="token punctuation">(</span>teacher<span class="token punctuation">.</span>dept<span class="token operator">=</span>dept<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
</code></pre> 
<p>7.Use COUNT to show the number of teachers and the number of mobile phones.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>mobile<span class="token punctuation">)</span>
<span class="token keyword">from</span> teacher
</code></pre> 
<p>8.Use COUNT and GROUP BY dept.name to show each department and the number of staff. Use a RIGHT JOIN to ensure that the Engineering department is listed.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> dept<span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>teacher<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token keyword">from</span> teacher <span class="token keyword">right</span> <span class="token keyword">join</span> dept <span class="token keyword">on</span> <span class="token punctuation">(</span>teacher<span class="token punctuation">.</span>dept<span class="token operator">=</span>dept<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> dept<span class="token punctuation">.</span>name
</code></pre> 
<p>9.Use CASE to show the name of each teacher followed by ‘Sci’ if the teacher is in dept 1 or 2 and ‘Art’ otherwise.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> teacher<span class="token punctuation">.</span>name
       <span class="token punctuation">,</span><span class="token keyword">case</span> <span class="token keyword">when</span> teacher<span class="token punctuation">.</span>dept <span class="token operator">in</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">then</span> <span class="token string">'Sci'</span>
             <span class="token keyword">else</span> <span class="token string">'Art'</span>
        <span class="token keyword">end</span> 
<span class="token keyword">from</span> teacher
</code></pre> 
<p>10.Use CASE to show the name of each teacher followed by ‘Sci’ if the teacher is in dept 1 or 2, show ‘Art’ if the teacher’s dept is 3 and ‘None’ otherwise.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> teacher<span class="token punctuation">.</span>name
       <span class="token punctuation">,</span><span class="token keyword">case</span> <span class="token keyword">when</span> teacher<span class="token punctuation">.</span>dept <span class="token operator">in</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">then</span> <span class="token string">'Sci'</span>
             <span class="token keyword">when</span> teacher<span class="token punctuation">.</span>dept<span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">then</span> <span class="token string">'Art'</span>
             <span class="token keyword">else</span> <span class="token string">'None'</span>
        <span class="token keyword">end</span> 
<span class="token keyword">from</span> teacher
</code></pre> 
<h2><a id="Self_join_719"></a>九、Self join</h2> 
<p>1.How many stops are in the database.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 
<span class="token keyword">from</span> stops
</code></pre> 
<p>2.Find the id value for the stop ‘Craiglockhart’</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> id
<span class="token keyword">from</span> stops
<span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'Craiglockhart'</span>
</code></pre> 
<p>3.Give the id and the name for the stops on the ‘4’ ‘LRT’ service.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> id<span class="token punctuation">,</span> name
<span class="token keyword">from</span> stops <span class="token keyword">join</span> route <span class="token keyword">on</span> stops<span class="token punctuation">.</span>id <span class="token operator">=</span> route<span class="token punctuation">.</span>stop
<span class="token keyword">where</span> num <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">and</span> company <span class="token operator">=</span> <span class="token string">'LRT'</span>
</code></pre> 
<p>4.The query shown gives the number of routes that visit either London Road (149) or Craiglockhart (53). Run the query and notice the two services that link these stops have a count of 2. Add a HAVING clause to restrict the output to these two routes.</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> company<span class="token punctuation">,</span> num<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> route <span class="token keyword">WHERE</span> stop<span class="token operator">=</span><span class="token number">149</span> <span class="token operator">OR</span> stop<span class="token operator">=</span><span class="token number">53</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> company<span class="token punctuation">,</span> num
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>
</code></pre> 
<p>5.Execute the self join shown and observe that b.stop gives all the places you can get to from Craiglockhart, without changing routes. Change the query so that it shows the services from Craiglockhart to London Road.</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>company<span class="token punctuation">,</span> a<span class="token punctuation">.</span>num<span class="token punctuation">,</span> a<span class="token punctuation">.</span>stop<span class="token punctuation">,</span> b<span class="token punctuation">.</span>stop
<span class="token keyword">FROM</span> route a <span class="token keyword">JOIN</span> route b <span class="token keyword">ON</span>
  <span class="token punctuation">(</span>a<span class="token punctuation">.</span>company<span class="token operator">=</span>b<span class="token punctuation">.</span>company <span class="token operator">AND</span> a<span class="token punctuation">.</span>num<span class="token operator">=</span>b<span class="token punctuation">.</span>num<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>stop<span class="token operator">=</span><span class="token number">53</span> <span class="token operator">and</span> b<span class="token punctuation">.</span>stop<span class="token operator">=</span><span class="token number">149</span>
</code></pre> 
<p>6.The query shown is similar to the previous one, however by joining two copies of the stops table we can refer to stops by name rather than by number. Change the query so that the services between ‘Craiglockhart’ and ‘London Road’ are shown. If you are tired of these places try ‘Fairmilehead’ against ‘Tollcross’</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>company<span class="token punctuation">,</span> a<span class="token punctuation">.</span>num<span class="token punctuation">,</span> stopa<span class="token punctuation">.</span>name<span class="token punctuation">,</span> stopb<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> route a <span class="token keyword">JOIN</span> route b <span class="token keyword">ON</span>
  <span class="token punctuation">(</span>a<span class="token punctuation">.</span>company<span class="token operator">=</span>b<span class="token punctuation">.</span>company <span class="token operator">AND</span> a<span class="token punctuation">.</span>num<span class="token operator">=</span>b<span class="token punctuation">.</span>num<span class="token punctuation">)</span>
  <span class="token keyword">JOIN</span> stops stopa <span class="token keyword">ON</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>stop<span class="token operator">=</span>stopa<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
  <span class="token keyword">JOIN</span> stops stopb <span class="token keyword">ON</span> <span class="token punctuation">(</span>b<span class="token punctuation">.</span>stop<span class="token operator">=</span>stopb<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> stopa<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">'Craiglockhart'</span> <span class="token operator">and</span> stopb<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">'London Road'</span>
</code></pre> 
<p>7.Give a list of all the services which connect stops 115 and 137 (‘Haymarket’ and ‘Leith’)</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> a<span class="token punctuation">.</span>company<span class="token punctuation">,</span> a<span class="token punctuation">.</span>num
<span class="token keyword">from</span> route a <span class="token keyword">join</span> route b <span class="token keyword">on</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>num<span class="token operator">=</span>b<span class="token punctuation">.</span>num <span class="token operator">AND</span> a<span class="token punctuation">.</span>company<span class="token operator">=</span>b<span class="token punctuation">.</span>company<span class="token punctuation">)</span>
<span class="token keyword">where</span> a<span class="token punctuation">.</span>stop<span class="token operator">=</span><span class="token number">115</span> <span class="token operator">and</span> b<span class="token punctuation">.</span>stop<span class="token operator">=</span><span class="token number">137</span>
</code></pre> 
<p>8.Give a list of the services which connect the stops ‘Craiglockhart’ and ‘Tollcross’</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> r1<span class="token punctuation">.</span>company<span class="token punctuation">,</span> r1<span class="token punctuation">.</span>num
<span class="token keyword">from</span> route r1 <span class="token keyword">join</span> route r2 <span class="token keyword">on</span> <span class="token punctuation">(</span>r1<span class="token punctuation">.</span>num<span class="token operator">=</span>r2<span class="token punctuation">.</span>num <span class="token operator">AND</span> r1<span class="token punctuation">.</span>company<span class="token operator">=</span>r2<span class="token punctuation">.</span>company<span class="token punctuation">)</span> 
<span class="token keyword">join</span> stops s1 <span class="token keyword">on</span> r1<span class="token punctuation">.</span>stop<span class="token operator">=</span>s1<span class="token punctuation">.</span>id <span class="token keyword">JOIN</span> stops s2 <span class="token keyword">ON</span> r2<span class="token punctuation">.</span>stop<span class="token operator">=</span>s2<span class="token punctuation">.</span>id
<span class="token keyword">WHERE</span> s1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">'Craiglockhart'</span> <span class="token operator">AND</span> s2<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">'Tollcross'</span>
</code></pre> 
<p>9.Give a distinct list of the stops which may be reached from ‘Craiglockhart’ by taking one bus, including ‘Craiglockhart’ itself, offered by the LRT company. Include the company and bus no. of the relevant services.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> s2<span class="token punctuation">.</span>name<span class="token punctuation">,</span> r2<span class="token punctuation">.</span>company<span class="token punctuation">,</span> r2<span class="token punctuation">.</span>num
<span class="token keyword">from</span> stops s1<span class="token punctuation">,</span> stops s2<span class="token punctuation">,</span> route r1<span class="token punctuation">,</span> route r2
<span class="token keyword">where</span> s1<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">'Craiglockhart'</span>
<span class="token operator">and</span> s1<span class="token punctuation">.</span>id<span class="token operator">=</span>r1<span class="token punctuation">.</span>stop <span class="token operator">and</span> r1<span class="token punctuation">.</span>company<span class="token operator">=</span>r2<span class="token punctuation">.</span>company 
<span class="token operator">and</span> r1<span class="token punctuation">.</span>num<span class="token operator">=</span>r2<span class="token punctuation">.</span>num <span class="token operator">and</span> r2<span class="token punctuation">.</span>stop<span class="token operator">=</span>s2<span class="token punctuation">.</span>id
</code></pre> 
<p>10.Find the routes involving two buses that can go from Craiglockhart to Lochend.<br> Show the bus no. and company for the first bus, the name of the stop for the transfer,<br> and the bus no. and company for the second bus.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> bus1<span class="token punctuation">.</span>num<span class="token punctuation">,</span> bus1<span class="token punctuation">.</span>company<span class="token punctuation">,</span> name<span class="token punctuation">,</span> bus2<span class="token punctuation">.</span>num<span class="token punctuation">,</span> bus2<span class="token punctuation">.</span>company 
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> start1<span class="token punctuation">.</span>num<span class="token punctuation">,</span> start1<span class="token punctuation">.</span>company<span class="token punctuation">,</span> stop1<span class="token punctuation">.</span>stop <span class="token keyword">from</span> route start1 <span class="token keyword">join</span> route stop1 <span class="token keyword">on</span> start1<span class="token punctuation">.</span>num <span class="token operator">=</span> stop1<span class="token punctuation">.</span>num 
<span class="token operator">and</span> start1<span class="token punctuation">.</span>company <span class="token operator">=</span> stop1<span class="token punctuation">.</span>company <span class="token operator">and</span> start1<span class="token punctuation">.</span>stop <span class="token operator">!=</span> stop1<span class="token punctuation">.</span>stop 
<span class="token keyword">where</span> start1<span class="token punctuation">.</span>stop <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id <span class="token keyword">from</span> stops <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'Craiglockhart'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> bus1 <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> start2<span class="token punctuation">.</span>num<span class="token punctuation">,</span> start2<span class="token punctuation">.</span>company<span class="token punctuation">,</span> start2<span class="token punctuation">.</span>stop <span class="token keyword">from</span> route start2 <span class="token keyword">join</span> route stop2 <span class="token keyword">on</span> start2<span class="token punctuation">.</span>num <span class="token operator">=</span> stop2<span class="token punctuation">.</span>num 
<span class="token operator">and</span> start2<span class="token punctuation">.</span>company <span class="token operator">=</span> stop2<span class="token punctuation">.</span>company <span class="token operator">and</span> start2<span class="token punctuation">.</span>stop <span class="token operator">!=</span> stop2<span class="token punctuation">.</span>stop 
<span class="token keyword">where</span> stop2<span class="token punctuation">.</span>stop <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id <span class="token keyword">from</span> stops <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'Sighthill'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> bus2 <span class="token keyword">ON</span> bus1<span class="token punctuation">.</span>stop <span class="token operator">=</span> bus2<span class="token punctuation">.</span>stop <span class="token keyword">join</span> stops <span class="token keyword">ON</span> bus1<span class="token punctuation">.</span>stop <span class="token operator">=</span> stops<span class="token punctuation">.</span>id
</code></pre> 
<p>未完待续，更新中…</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f78fd909ffd052effade191923f8b133/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">2021-01-22 socket位置同步程序 （玩家在场景随意走动并看到其他玩家）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9e613f076646fdab5a6a42e9cebdfce8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Matplotlib学习笔记（二）标注及能见度</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>