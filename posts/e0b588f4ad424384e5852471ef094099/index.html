<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>疫情可视化part2 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="疫情可视化part2" />
<meta property="og:description" content="前言 此系列已完结，共3部分：
part1：https://blog.csdn.net/xi1213/article/details/126824752part2：https://blog.csdn.net/xi1213/article/details/127719364part3：https://blog.csdn.net/xi1213/article/details/128072446 本来说有时间就把这个项目完结了的，结果后面一直有事拖着，直到现在十一月份了才搞完。老样子，先看成果。
浏览链接：http://xisite.top/original/bigScreen/28/index.html#/项目链接(欢迎各位大哥star)：https://gitee.com/xi1213/covid19-visualization 修改与添加 后面可能审美疲劳了，越看越丑，就干脆直接用dataV（这可不是阿里的那个dataV）修饰页面了。这是项目改动后的样子：
主要做了如下改动：
添加首页的3d粒子球体。完成“省内分析”模块。完成当地疫情报告生成与下载。使用dataV修饰页面。 粒子球体 粒子球体也是用three.js完成的，放大仔细看会发现其实是有三层构成的：内层透明球体，中间点状球体，外层病毒球体。
具体实现过程是这样的：
先绘制一个内层透明球体，记得将球体材质的transparent设为true，然后设置不透明度opacity值。 //创建斑点球体 async function createSpotSphere() { let globeBufferGeometry = new THREE.SphereGeometry(earthSize - 1, 50, 50);//球体几何体 let globeInnerMaterial = new THREE.MeshBasicMaterial({ color: new THREE.Color(dvColor[0]),//颜色 // blending: THREE.AdditiveBlending,//纹理融合的叠加方式 // side: THREE.FrontSide,//前面显示 transparent: true,//透明 // depthWrite: false,//深度写入 // depthTest: false,//黑洞效果 opacity: .3,//不透明度 }); let globeInnerMesh = new THREE.Mesh( globeBufferGeometry, globeInnerMaterial ); earthGroup.add(globeInnerMesh); //将网格放入地球组 cre 创建点状球体。这里需要使用一张黑白的世界地图。 let img = new Image(); img." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/e0b588f4ad424384e5852471ef094099/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-31T23:24:50+08:00" />
<meta property="article:modified_time" content="2023-03-31T23:24:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">疫情可视化part2</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>前言</h2> 
<p>此系列已完结，共3部分：</p> 
<ul><li>part1：https://blog.csdn.net/xi1213/article/details/126824752</li><li>part2：https://blog.csdn.net/xi1213/article/details/127719364</li><li>part3：https://blog.csdn.net/xi1213/article/details/128072446</li></ul> 
<p>本来说有时间就把这个项目完结了的，结果后面一直有事拖着，直到现在十一月份了才搞完。老样子，先看成果。</p> 
<ul><li>浏览链接：http://xisite.top/original/bigScreen/28/index.html#/</li><li>项目链接(欢迎各位大哥star)：https://gitee.com/xi1213/covid19-visualization</li></ul> 
<h2><a id="_9"></a>修改与添加</h2> 
<p>后面可能审美疲劳了，越看越丑，就干脆直接用dataV（这可不是阿里的那个dataV）修饰页面了。这是项目改动后的样子：<br> <img src="https://images2.imgbox.com/bc/dd/5POwSpjb_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/20/90/A3wlDjpH_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d3/9e/UqM6jlgX_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e9/e2/K8cEUm0D_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/08/21/O156jWC8_o.png" alt="在这里插入图片描述"></p> 
<p>主要做了如下改动：</p> 
<ol><li>添加首页的3d粒子球体。</li><li>完成“省内分析”模块。</li><li>完成当地疫情报告生成与下载。</li><li>使用dataV修饰页面。</li></ol> 
<h2><a id="_22"></a>粒子球体</h2> 
<p>粒子球体也是用three.js完成的，放大仔细看会发现其实是有三层构成的：内层透明球体，中间点状球体，外层病毒球体。<br> <img src="https://images2.imgbox.com/97/8a/mttuIsX4_o.png" alt="在这里插入图片描述"></p> 
<p>具体实现过程是这样的：</p> 
<ol><li>先绘制一个内层透明球体，记得将球体材质的transparent设为true，然后设置不透明度opacity值。</li></ol> 
<pre><code class="prism language-javascript"><span class="token comment">//创建斑点球体</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">createSpotSphere</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> globeBufferGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span>earthSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//球体几何体</span>
  <span class="token keyword">let</span> globeInnerMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Color</span><span class="token punctuation">(</span>dvColor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//颜色</span>
    <span class="token comment">// blending: THREE.AdditiveBlending,//纹理融合的叠加方式</span>
    <span class="token comment">// side: THREE.FrontSide,//前面显示</span>
    <span class="token literal-property property">transparent</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//透明</span>
    <span class="token comment">// depthWrite: false,//深度写入</span>
    <span class="token comment">// depthTest: false,//黑洞效果</span>
    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">.3</span><span class="token punctuation">,</span><span class="token comment">//不透明度</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> globeInnerMesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>
    globeBufferGeometry<span class="token punctuation">,</span>
    globeInnerMaterial
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  earthGroup<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>globeInnerMesh<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将网格放入地球组</span>
  cre
</code></pre> 
<ol start="2"><li>创建点状球体。这里需要使用一张黑白的世界地图。</li></ol> 
<pre><code class="prism language-javascript"><span class="token keyword">let</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> earthGrayscale<span class="token punctuation">;</span> <span class="token comment">//黑白地图</span>
</code></pre> 
<p>将图片使用onload加载到项目中后，利用canvas绘制一遍该图，再使用getImageData获取到像素点数据canData。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">let</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> img<span class="token punctuation">.</span>width<span class="token punctuation">;</span> <span class="token comment">//使得canvas尺寸与图片尺寸相同</span>
    canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> img<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
    <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> any<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> img<span class="token punctuation">.</span>width<span class="token punctuation">,</span> img<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//canvas绘制图片</span>
    <span class="token keyword">let</span> canData <span class="token operator">=</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> any<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>width<span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取画布像素数据</span>
</code></pre> 
<p>利用canData .data中的rgba信息生成缓冲几何顶点数组globeCloudVerticesArray。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">let</span> globeCloudBufferGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BufferGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置缓冲几何体</span>
    <span class="token keyword">let</span> globeCloudVerticesArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//地球云缓冲几何体顶点</span>
    <span class="token keyword">let</span> o <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">//数组处理时的计数</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>o <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> o <span class="token operator">&lt;</span> canData<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> o <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">let</span> r <span class="token operator">=</span> <span class="token punctuation">(</span>o <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">%</span> canvas<span class="token punctuation">.</span>width<span class="token punctuation">,</span>
        i <span class="token operator">=</span> <span class="token punctuation">(</span>o <span class="token operator">/</span> <span class="token number">4</span> <span class="token operator">-</span> r<span class="token punctuation">)</span> <span class="token operator">/</span> canvas<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>o <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">===</span> canData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">let</span> n <span class="token operator">=</span> r<span class="token punctuation">,</span>
            longitude <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">/</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//经度</span>
            latitude <span class="token operator">=</span> n <span class="token operator">/</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">360</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">180</span><span class="token punctuation">;</span> <span class="token comment">//维度</span>
          <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token function">latLongToVector3</span><span class="token punctuation">(</span>longitude<span class="token punctuation">,</span> latitude<span class="token punctuation">,</span> earthSize<span class="token punctuation">,</span> <span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//经纬度变换</span>
          globeCloudVerticesArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将变换后的顶点放入数组</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>然后再使用three中的BufferAttribute生成属性position与color。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">let</span> l <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> globeCloudVerticesArray<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建顶点数组长度</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>o <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> o <span class="token operator">&lt;</span> globeCloudVerticesArray<span class="token punctuation">.</span>length<span class="token punctuation">;</span> o<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      l<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> o<span class="token punctuation">]</span> <span class="token operator">=</span> globeCloudVerticesArray<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span><span class="token comment">//设置顶点数组数据</span>
      l<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> o <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> globeCloudVerticesArray<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>
      l<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> o <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> globeCloudVerticesArray<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">.</span>z<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> positionVal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BufferAttribute</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置缓冲区属性值</span>
    globeCloudBufferGeometry<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"position"</span><span class="token punctuation">,</span> positionVal<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给缓冲几何体添加位置属性</span>
    <span class="token keyword">let</span> globeCloudMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PointsMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Color</span><span class="token punctuation">(</span>dvColor<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//颜色</span>
      <span class="token literal-property property">fog</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//球面斑点材质</span>
    <span class="token keyword">let</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> globeCloudVerticesArray<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>o <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> o <span class="token operator">&lt;</span> globeCloudVerticesArray<span class="token punctuation">.</span>length<span class="token punctuation">;</span> o<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      c<span class="token punctuation">[</span>o<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Color</span><span class="token punctuation">(</span>dvColor<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//球面斑点颜色</span>
      d<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> o<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">;</span><span class="token comment">//设置地球云数组rgb颜色</span>
      d<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> o <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">.</span>g<span class="token punctuation">;</span>
      d<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> o <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">.</span>b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> color_val <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BufferAttribute</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    globeCloudBufferGeometry<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"color"</span><span class="token punctuation">,</span> color_val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//给缓冲几何体添加颜色属性,修改颜色直接修改globeCloudBufferGeometry的setAttribute</span>
</code></pre> 
<p>最后再使用THREE.Points创建球面的点，将position与color属性添加到点的几何体BufferGeometry中。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">let</span> globeCloud <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Points</span><span class="token punctuation">(</span><span class="token comment">//球面的象素点</span>
      globeCloudBufferGeometry<span class="token punctuation">,</span>
      globeCloudMaterial
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>这是需要用到的坐标转换方法：</p> 
<pre><code class="prism language-javascript"><span class="token comment">//经纬度坐标变换（传入e:纬度、a经度、t球半径、o球额外距离）</span>
<span class="token keyword">function</span> <span class="token function">latLongToVector3</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">e</span><span class="token operator">:</span> any<span class="token punctuation">,</span> <span class="token literal-property property">a</span><span class="token operator">:</span> any<span class="token punctuation">,</span> <span class="token literal-property property">t</span><span class="token operator">:</span> any<span class="token punctuation">,</span> <span class="token literal-property property">o</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">var</span> r <span class="token operator">=</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">,</span>
    i <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">-</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">,</span>
    n <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>t <span class="token operator">+</span> o<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>
    s <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">+</span> o<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">,</span>
    l <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">+</span> o<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> s<span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//计算三维向量</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="3"><li>创建最外层的病毒球体。每一个病毒都是一个THREE.Sprite，材质是THREE.SpriteMaterial，利用Sprite.position.set设置具体坐标位置，最后将Sprite添加到球体组中。病毒的颜色是由当前点确诊值决定的，颜色值在colors数组中取出。</li></ol> 
<pre><code class="prism language-javascript"><span class="token comment">//创建病毒</span>
<span class="token keyword">function</span> <span class="token function">createVirus</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">data</span><span class="token operator">:</span> any<span class="token punctuation">,</span> <span class="token literal-property property">earthSize</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> colors <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Color</span><span class="token punctuation">(</span><span class="token number">0xf9b8b8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Color</span><span class="token punctuation">(</span><span class="token number">0xfe4242</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Color</span><span class="token punctuation">(</span><span class="token number">0xff0000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//病毒颜色列表</span>
  <span class="token keyword">let</span> virSize <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">//病毒大小</span>
  <span class="token keyword">let</span> list <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">e</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">value</span><span class="token operator">:</span> number<span class="token punctuation">;</span> color<span class="token operator">:</span> any<span class="token punctuation">;</span> position<span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    e<span class="token punctuation">.</span>value <span class="token operator">&gt;=</span> <span class="token number">10000000</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>color <span class="token operator">=</span> colors<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//根据病毒数赋予不同颜色</span>
    e<span class="token punctuation">.</span>value <span class="token operator">&gt;=</span> <span class="token number">500000</span> <span class="token operator">&amp;&amp;</span> e<span class="token punctuation">.</span>value <span class="token operator">&lt;</span> <span class="token number">10000000</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>color <span class="token operator">=</span> colors<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    e<span class="token punctuation">.</span>value <span class="token operator">&lt;</span> <span class="token number">500000</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>color <span class="token operator">=</span> colors<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>position<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">let</span> virusMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SpriteMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">color</span><span class="token operator">:</span> e<span class="token punctuation">.</span>color<span class="token punctuation">,</span>
        <span class="token literal-property property">map</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>virusImg<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">side</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>FrontSide<span class="token punctuation">,</span> <span class="token comment">//只显示前面</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//病毒材质</span>
      <span class="token keyword">let</span> Sprite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Sprite</span><span class="token punctuation">(</span>virusMaterial<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//点精灵材质</span>
      Sprite<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>virSize<span class="token punctuation">,</span> virSize<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//点大小</span>
      <span class="token keyword">let</span> lat <span class="token operator">=</span> e<span class="token punctuation">.</span>position<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//纬度</span>
      <span class="token keyword">let</span> lon <span class="token operator">=</span> e<span class="token punctuation">.</span>position<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//经度</span>
      <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token function">latLongToVector3</span><span class="token punctuation">(</span>lat<span class="token punctuation">,</span> lon<span class="token punctuation">,</span> earthSize<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//坐标转换</span>
      Sprite<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>x<span class="token punctuation">,</span> s<span class="token punctuation">.</span>y<span class="token punctuation">,</span> s<span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置点的位置</span>
      Sprite<span class="token punctuation">.</span>dotData <span class="token operator">=</span> e<span class="token punctuation">;</span> <span class="token comment">//将点的数据添加到dotData属性中</span>
      Sprite<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"病毒"</span><span class="token punctuation">;</span>
      earthGroup<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Sprite<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将病毒添加进球体组中</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="_173"></a>省内分析</h2> 
<ol><li>省内数据概况。<br> <img src="https://images2.imgbox.com/b9/ec/XhCDlSr9_o.png" alt="在这里插入图片描述"><br> 该数值在加载时是有增加动画的，是利用vue响应式原理完成的，在上一篇文章中有提到。</li><li>省内各地疫情柱状图。<br> <img src="https://images2.imgbox.com/88/49/N6UHZQmi_o.png" alt="在这里插入图片描述"></li></ol> 
<p>这是具体的echart配置：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">let</span> option <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">text</span><span class="token operator">:</span> provinceBaseData<span class="token punctuation">.</span>value<span class="token punctuation">.</span>province <span class="token operator">+</span> <span class="token string">"各地数据"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token string">"center"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token string">'5%'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">textStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#fff"</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">tooltip</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">trigger</span><span class="token operator">:</span> <span class="token string">'axis'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">axisPointer</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'shadow'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">dataZoom</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'inside'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">yAxisIndex</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token literal-property property">filterMode</span><span class="token operator">:</span> <span class="token string">'empty'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
                <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token string">'70%'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">showDataShadow</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token string">'3%'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token string">"center"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">legend</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'累计数'</span><span class="token punctuation">,</span> <span class="token string">'治愈数'</span><span class="token punctuation">,</span> <span class="token string">'确诊数'</span><span class="token punctuation">,</span> <span class="token string">'较昨日新增'</span><span class="token punctuation">,</span> <span class="token string">'死亡数'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">orient</span><span class="token operator">:</span> <span class="token string">"vertical"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token string">"15%"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token string">"2%"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">textStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#fff"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">grid</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token string">'3%'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token string">'15%'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">bottom</span><span class="token operator">:</span> <span class="token string">'10%'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">containLabel</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">xAxis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'category'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> echartData<span class="token punctuation">.</span>cityName<span class="token punctuation">,</span>
            <span class="token literal-property property">axisLabel</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">interval</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token literal-property property">rotate</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
                <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#fff"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">yAxis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'value'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">axisLabel</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#fff"</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">series</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'累计数'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">emphasis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">focus</span><span class="token operator">:</span> <span class="token string">'series'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#f59158'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> echartData<span class="token punctuation">.</span>conNum
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'治愈数'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">emphasis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">focus</span><span class="token operator">:</span> <span class="token string">'series'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#48c56b'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> echartData<span class="token punctuation">.</span>cureNum
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'确诊数'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">stack</span><span class="token operator">:</span> <span class="token string">'total'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">emphasis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">focus</span><span class="token operator">:</span> <span class="token string">'series'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#ffd889'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> echartData<span class="token punctuation">.</span>econNum
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'较昨日新增'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">stack</span><span class="token operator">:</span> <span class="token string">'total'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">emphasis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">focus</span><span class="token operator">:</span> <span class="token string">'series'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#794ebd'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> echartData<span class="token punctuation">.</span>asymptomNum
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'死亡数'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">stack</span><span class="token operator">:</span> <span class="token string">'total'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">emphasis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">focus</span><span class="token operator">:</span> <span class="token string">'series'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#ff6a6a'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> echartData<span class="token punctuation">.</span>deathNum
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="3"><li>省份历史疫情数据图表。<br> <img src="https://images2.imgbox.com/75/d1/OOutl3cX_o.png" alt="在这里插入图片描述"></li></ol> 
<p>这是该图表配置：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">let</span> option <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">text</span><span class="token operator">:</span> provinceBaseData<span class="token punctuation">.</span>value<span class="token punctuation">.</span>province <span class="token operator">+</span> <span class="token string">"历史数据"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token string">"center"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token string">'5%'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">textStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#fff"</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">tooltip</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">trigger</span><span class="token operator">:</span> <span class="token string">'axis'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">axisPointer</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'cross'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'#6a7985'</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">legend</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'累计数'</span><span class="token punctuation">,</span> <span class="token string">'确诊数'</span><span class="token punctuation">,</span> <span class="token string">'较昨日新增'</span><span class="token punctuation">,</span> <span class="token string">'治愈数'</span><span class="token punctuation">,</span> <span class="token string">'死亡数'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">orient</span><span class="token operator">:</span> <span class="token string">"vertical"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token string">"15%"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token string">"2%"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">textStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#fff"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">grid</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token string">'8%'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">xAxis</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'category'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">boundaryGap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">axisLabel</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#fff"</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> echatrData<span class="token punctuation">.</span>time
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">yAxis</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'value'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">axisLabel</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#fff"</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">dataZoom</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">startValue</span><span class="token operator">:</span> <span class="token string">''</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'inside'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">series</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'累计数'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">stack</span><span class="token operator">:</span> <span class="token string">'Total'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">smooth</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">lineStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">0</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">showSymbol</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">areaStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#f59158"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">emphasis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">focus</span><span class="token operator">:</span> <span class="token string">'series'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#f59158'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> echatrData<span class="token punctuation">.</span>conNum
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'确诊数'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">stack</span><span class="token operator">:</span> <span class="token string">'Total'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">smooth</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">lineStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">0</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">showSymbol</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">areaStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#ffd889"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#ffd889'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">emphasis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">focus</span><span class="token operator">:</span> <span class="token string">'series'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> echatrData<span class="token punctuation">.</span>econNum
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'较昨日新增'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">stack</span><span class="token operator">:</span> <span class="token string">'Total'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">smooth</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">lineStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">0</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">showSymbol</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token string">'top'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">areaStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#794ebd"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#794ebd'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">emphasis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">focus</span><span class="token operator">:</span> <span class="token string">'series'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> echatrData<span class="token punctuation">.</span>asymptomNum
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'治愈数'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">stack</span><span class="token operator">:</span> <span class="token string">'Total'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">smooth</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">lineStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">0</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">showSymbol</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">areaStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#48c56b"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#48c56b'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">emphasis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">focus</span><span class="token operator">:</span> <span class="token string">'series'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> echatrData<span class="token punctuation">.</span>cureNum
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'死亡数'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">stack</span><span class="token operator">:</span> <span class="token string">'Total'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">smooth</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">lineStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">0</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">showSymbol</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">areaStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#ff6a6a"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#ff6a6a'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">emphasis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">focus</span><span class="token operator">:</span> <span class="token string">'series'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> echatrData<span class="token punctuation">.</span>deathNum
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="_483"></a>报告生成与下载</h2> 
<p>报告生成利用的是docxtemplater，这是前端生成word比较方便的一个插件，具体使用方法可以看这里：https://blog.csdn.net/xi1213/article/details/127412672。</p> 
<ul><li>这是生成的word报告示例：<br> <img src="https://images2.imgbox.com/e3/c0/3BRyKBo6_o.jpg" alt="在这里插入图片描述"></li></ul> 
<h2><a id="dataV_488"></a>dataV修饰</h2> 
<ul><li>dataV是一个大屏可视化组件库，这是使用文档：http://datav.jiaminghi.com/guide/。</li><li>dataV是vue2开始的，vue3使用的话会报错，需要做一点修改，具体看这里:https://blog.csdn.net/xi1213/article/details/127697760。</li><li>我只用了dataV中的一些边框与装饰，你在页面中看到的紫色线框和一些动画的装饰就是dataV的，还是蛮漂亮的。</li></ul> 
<h2><a id="_492"></a>结语</h2> 
<ul><li>最后我发现人的审美真的变化太快了。</li><li>项目刚搞完：嗯不错！真漂亮！</li><li>过去一周后：好丑！</li><li>如果还有后续的话，我可能就要考虑添加自定义主题配色了。</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2cf56290fe6b1cdbf8a813b4cafb2498/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">疫情可视化part1</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7c7b977cd36b973f7c18be0c9b6d7dab/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">pip install git&#43;https://github.com/XXX/XXX 命令报错</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>