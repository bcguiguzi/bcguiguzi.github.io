<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Python &amp; Other】一网打尽 Python复制文本&amp;文件到剪切板 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【Python &amp; Other】一网打尽 Python复制文本&amp;文件到剪切板" />
<meta property="og:description" content="前言 在使用uiautomation操作微信发送信息时候，难点在于发送文件。发送文件，靠的是复制到剪切板，然后再从剪切板粘贴发送。
本文吧啦一下在Windows系统中关于Python复制文件到剪切板的操作。
花了挺多时间，但是不管怎么找，始终都找不着Python复制文件到剪切板的方法。
于是另辟蹊径，从Windows系统上下手，然后再利用Python去调用Windows系统的命令，曲线救国，从而达到Python复制我呢见到剪切板的方法。
多动一下自己那个🐷脑袋，问题总是可以解决的🐱‍🏍🐱‍🏍
知识点📖📖 文中用到的命令都可以在 https://docs.microsoft.com/zh-cn/ 找到相应的解释，有疑问请找它，不要来问我！！！
复制文本
cmd窗口：echo text | clipPython模块：pyperclip 复制文件
借助工具 xclip：echo file_path | xclip /copy借助PowerShell命令：Get-Item file_path | Set-Clipboard 实现 复制文本 这里介绍两种方法
Windows系统命令Python模块pyperclip Windows系统命令 在Windows系统中，cmd窗口输入以下命令可以将text文本复制到剪切板
echo text | clip 在Python中，可以使用os模块来执行cmd命令
将text替换成需要复制到剪切板的文本即可 import os os.system(&#39;echo text | clip&#39;) pyperclip 在Python中，有模块是支持复制文本到剪切版的
pip install pyperclip 使用的话，也是很简单
import pyperclip #　复制文本到剪切板 pyperclip.copy(&#39;The text to be copied to the clipboard.&#39;) # 获取剪切板的文本 text = pyperclip.paste() print(text)	# &#39;The text to be copied to the clipboard." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/70225ed35cfbfe12c1654ad477fa0d2b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-16T00:18:44+08:00" />
<meta property="article:modified_time" content="2022-09-16T00:18:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Python &amp; Other】一网打尽 Python复制文本&amp;文件到剪切板</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>前言</h2> 
<blockquote> 
 <p>在使用<code>uiautomation</code>操作微信发送信息时候，<strong>难点</strong>在于发送文件。发送文件，靠的是复制到剪切板，然后再从剪切板粘贴发送。<br> 本文吧啦一下在Windows系统中关于Python复制文件到剪切板的操作。</p> 
</blockquote> 
<p>花了挺多时间，但是不管怎么找，始终都找不着Python复制文件到剪切板的方法。<br> 于是另辟蹊径，从Windows系统上下手，然后再利用Python去调用Windows系统的命令，曲线救国，从而达到Python复制我呢见到剪切板的方法。<br> 多动一下自己那个🐷脑袋，问题总是可以解决的🐱‍🏍🐱‍🏍</p> 
<h2><a id="_11"></a>知识点📖📖</h2> 
<p>文中用到的命令都可以在 <a href="https://docs.microsoft.com/zh-cn/" rel="nofollow"><strong>https://docs.microsoft.com/zh-cn/</strong></a> 找到相应的解释，有疑问请找它，不要来问我！！！</p> 
<p><strong>复制文本</strong></p> 
<ul><li>cmd窗口：<code>echo text | clip</code></li><li>Python模块：<code>pyperclip</code></li></ul> 
<hr> 
<p><strong>复制文件</strong></p> 
<ul><li>借助工具 xclip：<code>echo file_path | xclip /copy</code></li><li>借助PowerShell命令：<code>Get-Item file_path | Set-Clipboard</code></li></ul> 
<hr> 
<h2><a id="_34"></a>实现</h2> 
<h3><a id="_35"></a>复制文本</h3> 
<p>这里介绍两种方法</p> 
<ul><li>Windows系统命令</li><li>Python模块pyperclip</li></ul> 
<h4><a id="Windows_41"></a><code>Windows系统命令</code></h4> 
<p>在Windows系统中，cmd窗口输入以下命令可以将<code>text文本</code>复制到剪切板</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> text <span class="token operator">|</span> clip
</code></pre> 
<p>在Python中，可以使用os模块来执行cmd命令</p> 
<ul><li>将<code>text</code>替换成需要复制到剪切板的文本即可</li></ul> 
<pre><code class="prism language-py"><span class="token keyword">import</span> os
os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'echo text | clip'</span><span class="token punctuation">)</span>
</code></pre> 
<hr> 
<h4><a id="pyperclip_57"></a><code>pyperclip</code></h4> 
<p>在Python中，有模块是支持复制文本到剪切版的</p> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> pyperclip
</code></pre> 
<p>使用的话，也是很简单</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pyperclip

<span class="token comment">#　复制文本到剪切板</span>
pyperclip<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token string">'The text to be copied to the clipboard.'</span><span class="token punctuation">)</span>

<span class="token comment"># 获取剪切板的文本</span>
text <span class="token operator">=</span> pyperclip<span class="token punctuation">.</span>paste<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>	<span class="token comment"># 'The text to be copied to the clipboard.'</span>

</code></pre> 
<hr> 
<h3><a id="_84"></a>复制文件</h3> 
<p><mark>！！！可以很负责任地说，别处找不着这么好且这么多的方法~</mark><br> <mark>！！！可以很负责任地说，别处找不着这么好且这么多的方法~</mark><br> <mark>！！！可以很负责任地说，别处找不着这么好且这么多的方法~</mark></p> 
<p>这里介绍几种方法，</p> 
<ul><li>xclip工具</li><li>PowerShell命令二则</li></ul> 
<h4><a id="xclip_95"></a><code>xclip工具</code></h4> 
<blockquote> 
 <p>这个方法一次只能复制一个文件到剪切板</p> 
</blockquote> 
<p>首先，<a href="https://download.csdn.net/download/weixin_45081575/86540071"><strong>点击这里</strong></a> 下载<code>xclip工具</code>。</p> 
<p>然后，将它添加到系统环境变量（可选操作，可不添加。</p> 
<p><strong>示例如下</strong></p> 
<p><img src="https://images2.imgbox.com/a0/54/GLYt7fGW_o.png" alt=""></p> 
<p>当前文件夹中有一份 <code>demo.txt文件</code>，现在需要将它复制到剪切板<br> 在当前文件夹地址栏输入<code>cmd</code>（其它方式也行<br> 然后输入</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> demo.txt <span class="token operator">|</span> xclip /copy
</code></pre> 
<p><img src="https://images2.imgbox.com/d9/64/fTFRKp3s_o.png" alt=""></p> 
<p>以上，就可以将文件复制到剪切板了~~</p> 
<p>使用Python的os模块去调用如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> os
os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'echo demo.txt | xclip /copy'</span><span class="token punctuation">)</span>
</code></pre> 
<hr> 
<h4><a id="PowerShell_131"></a><code>PowerShell命令二则</code></h4> 
<blockquote> 
 <p>这个方法一次只能复制一个文件到剪切板<br> 这个虽然是PowerShell的命令，但却是使用cmd窗口去执行的。</p> 
</blockquote> 
<h5><a id="_135"></a>第一则</h5> 
<p>代码如下：</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">set</span> <span class="token string">"file=你的文件全路径"</span>

powershell -sta <span class="token string">"<span class="token variable">$sc</span>=New-Object System.Collections.Specialized.StringCollection;<span class="token variable">$sc</span>.Add('%file%');Add-Type -Assembly 'System.Windows.Forms';[System.Windows.Forms.Clipboard]::SetFileDropList(<span class="token variable">$sc</span>);"</span>
</code></pre> 
<p>在cmd窗口中输入以上代码，即可将你指定的文件复制到剪切版了。<br> 将它改写成 <code>.bat可执行</code> 文件，如下</p> 
<p><strong>demo.bat</strong></p> 
<pre><code class="prism language-bash">@ECHO OFF
<span class="token builtin class-name">set</span> <span class="token assign-left variable">file</span><span class="token operator">=</span>%1
powershell -sta <span class="token string">"<span class="token variable">$sc</span>=New-Object System.Collections.Specialized.StringCollection;<span class="token variable">$sc</span>.Add('%file%');Add-Type -Assembly 'System.Windows.Forms';[System.Windows.Forms.Clipboard]::SetFileDropList(<span class="token variable">$sc</span>);"</span>
</code></pre> 
<p>代码释义：<br> 第一行：<code>.bat可执行</code>文件默认写法<br> 第二行：<code>%1</code> 为接收外部的第一个传参，接收文件的路径<br> 第三行：复制文件到剪切板</p> 
<p>然后再使用 Python去调用它</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> os

os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'demo.bat 文件的绝对路径'</span><span class="token punctuation">)</span>
</code></pre> 
<p>以上，即可将文件复制到剪切板了。</p> 
<hr> 
<h5><a id="_172"></a>第二则</h5> 
<blockquote> 
 <p>这个方法一次可复制多个文件到剪切板，建议用这个方法！！！</p> 
</blockquote> 
<p>这里借助的是<strong>PowerShell</strong>，所以需要打开<strong>PowerShell</strong> 去执行。</p> 
<p>如下图：<br> <img src="https://images2.imgbox.com/24/42/4v8fdLjc_o.png" alt=""><br> 执行的命令如下：</p> 
<p>复制单个文件到剪切板</p> 
<pre><code class="prism language-bash">Get-Item demo.txt <span class="token operator">|</span> Set-Clipboard
</code></pre> 
<p>复制多个文件到剪切板（用逗号隔开</p> 
<pre><code class="prism language-bash">Get-Item demo.txt,demo2.txt <span class="token operator">|</span> Set-Clipboard
</code></pre> 
<p>使用Python调用，如下</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> subprocess

args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'powershell'</span><span class="token punctuation">,</span> <span class="token string">'Get-Item 文件路径,文件路径,... | Set-Clipboard'</span><span class="token punctuation">]</span>
subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span>args<span class="token operator">=</span>args<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_204"></a>后话</h2> 
<p>本文介绍到此，<br> see you.🎈🎈</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/45f74640cdc799b2cb40aa096fd43e1a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL之视图、存储过程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/775e6e69091d7b5f2a56deef07526995/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">家政服务管理系统/家政管理系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>