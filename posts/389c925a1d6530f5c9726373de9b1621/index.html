<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Excel求解运输问题——以福斯特公司问题为例 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Excel求解运输问题——以福斯特公司问题为例" />
<meta property="og:description" content="目录
1.1 问题
福斯特问题例
1.2 数学模型
1.3 excel求解
第一步：建立一个工作表
第二步：求解器求解
1.1 问题 运输问题通常出现在计划货物配送机从供给地区到达需求地区之间的服务中，一般供给地区货物数量有限，需求地区货物需求量已知。常见目标是使货物从起点到终点的运输成本最低。
福斯特问题例： 福斯特发电机公司面临一个运输问题，从3个加工厂运输一种产品到4个分销中心。3个加工厂在后3个月的计划期内的生产能力如下表所示：
起点加工厂3个月的生产能力（单位）1克利夫兰50002贝德福德60003约克2500总计：13500 公司通过波士顿、芝加哥、圣路易斯和莱克星顿的4个分销中心来分销这种发电机，每个分销中心的后3个月的需求预测如下：
终点分销中心3个月的需求预测（单位）1波士顿60002芝加哥40003圣路易斯20004莱克星顿1500总计：13500 各加工厂到分销中心的单位运输成本如下图所示：
起点终点波士顿芝加哥圣路易斯莱克星顿克利夫兰3276贝德福德7523约克2545 管理层想知道各个加工厂运输到分销中心的产品运输量应该是多少。我们可以用线性规划模型解决这类运输问题，用双下标决策变量来描述，表示从加工厂1克利夫兰到分销中心1波士顿的运输量，表示从加工厂1克利夫兰到分销中心2芝加哥的运输量，以此类推。一般情况下，m个起点和n个重点的运输问题的决策变量常被表示成以下形式：
-------从起点i到终点j的运输量。i=1，2，3，...,m; j=1,2,3...,n
1.2 数学模型 根据生产能力约束和目标函数建立线性规划模型，如下所示：
注意，最后一条决策变量的取值范围记得加上。
1.3 excel求解 接下来介绍怎么使用excel求解简单的运输问题。
第一步：建立一个工作表 首先输入运输成本、起终点供给量及终点节点的需求量。然后在工作表底端构建这个问题的线性规划问题。所有的线性规划问题都包含四个要素：决策变量、目标函数、左端约束条件和右端值。
在单元格C13中输入公式=SUMPRODUCT(B5:E7,B17:F19)，用来计算解的总运输成本。单元格F17=SUM(B17:E17),F18、F19类推，计算各个起点运往各个分销商的供给总量。单元格B20=SUM(B17:B19)，C20到E20类推，计算的是运入各个分销商的货物量。
第二步：求解器求解 选择数据&gt;规划求解器，设置规划求解参数，如下图所示：
点击求解，结果如下所示：
目标函数最小值为39500，决策变量=3500，，，，，，其他决策变量都为0，即对应的路线上没有运输量。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/389c925a1d6530f5c9726373de9b1621/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-04T13:25:40+08:00" />
<meta property="article:modified_time" content="2023-01-04T13:25:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Excel求解运输问题——以福斯特公司问题为例</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="1.1%20%E9%97%AE%E9%A2%98-toc" style="margin-left:0px;"><a href="#1.1%20%E9%97%AE%E9%A2%98" rel="nofollow">1.1 问题</a></p> 
<p id="%E7%A6%8F%E6%96%AF%E7%89%B9%E9%97%AE%E9%A2%98%E4%BE%8B%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%E7%A6%8F%E6%96%AF%E7%89%B9%E9%97%AE%E9%A2%98%E4%BE%8B%EF%BC%9A" rel="nofollow">福斯特问题例</a></p> 
<p id="1.2%20%E6%95%B0%E5%AD%A6%E6%A8%A1%E5%9E%8B-toc" style="margin-left:0px;"><a href="#1.2%20%E6%95%B0%E5%AD%A6%E6%A8%A1%E5%9E%8B" rel="nofollow">1.2 数学模型</a></p> 
<p id="1.3%C2%A0excel%E6%B1%82%E8%A7%A3-toc" style="margin-left:0px;"><a href="#1.3%C2%A0excel%E6%B1%82%E8%A7%A3" rel="nofollow">1.3 excel求解</a></p> 
<p id="%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E5%BB%BA%E7%AB%8B%E4%B8%80%E4%B8%AA%E5%B7%A5%E4%BD%9C%E8%A1%A8-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E5%BB%BA%E7%AB%8B%E4%B8%80%E4%B8%AA%E5%B7%A5%E4%BD%9C%E8%A1%A8" rel="nofollow">第一步：建立一个工作表</a></p> 
<p id="%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E6%B1%82%E8%A7%A3%E5%99%A8%E6%B1%82%E8%A7%A3-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E6%B1%82%E8%A7%A3%E5%99%A8%E6%B1%82%E8%A7%A3" rel="nofollow">第二步：求解器求解</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="1.1%20%E9%97%AE%E9%A2%98"><strong>1.1 问题</strong></h2> 
<p><strong>运输问题</strong>通常出现在计划货物配送机从供给地区到达需求地区之间的服务中，一般供给地区货物数量有限，需求地区货物需求量已知。常见目标是使货物从起点到终点的运输成本最低。</p> 
<h3 id="%E7%A6%8F%E6%96%AF%E7%89%B9%E9%97%AE%E9%A2%98%E4%BE%8B%EF%BC%9A"><strong>福斯特问题例</strong>：</h3> 
<p>       福斯特发电机公司面临一个运输问题，从3个加工厂运输一种产品到4个分销中心。3个加工厂在后3个月的计划期内的生产能力如下表所示：</p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td style="text-align:center;"><strong>起点</strong></td><td style="text-align:center;"><strong>加工厂</strong></td><td style="text-align:center;"><strong>3个月的生产能力（单位）</strong></td></tr><tr><td style="text-align:center;">1</td><td style="text-align:center;">克利夫兰</td><td style="text-align:center;">5000</td></tr><tr><td style="text-align:center;">2</td><td style="text-align:center;">贝德福德</td><td style="text-align:center;">6000</td></tr><tr><td style="text-align:center;">3</td><td style="text-align:center;">约克</td><td style="text-align:center;">2500</td></tr><tr><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;">总计：13500</td></tr></tbody></table> 
<p>       公司通过波士顿、芝加哥、圣路易斯和莱克星顿的4个分销中心来分销这种发电机，每个分销中心的后3个月的需求预测如下：</p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td style="text-align:center;"><strong>终点</strong></td><td style="text-align:center;"><strong>分销中心</strong></td><td style="text-align:center;"><strong>3个月的需求预测（单位）</strong></td></tr><tr><td style="text-align:center;">1</td><td style="text-align:center;">波士顿</td><td style="text-align:center;">6000</td></tr><tr><td style="text-align:center;">2</td><td style="text-align:center;">芝加哥</td><td style="text-align:center;">4000</td></tr><tr><td style="text-align:center;">3</td><td style="text-align:center;">圣路易斯</td><td style="text-align:center;">2000</td></tr><tr><td style="text-align:center;">4</td><td style="text-align:center;">莱克星顿</td><td style="text-align:center;">1500</td></tr><tr><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;">总计：13500</td></tr></tbody></table> 
<p>      各加工厂到分销中心的单位运输成本如下图所示：</p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td colspan="1" rowspan="2" style="text-align:center;"><strong>起点</strong></td><td colspan="4" rowspan="1" style="text-align:center;"><strong>终点</strong></td></tr><tr><td style="text-align:center;"><strong>波士顿</strong></td><td style="text-align:center;"><strong>芝加哥</strong></td><td style="text-align:center;"><strong>圣路易斯</strong></td><td style="text-align:center;"><strong>莱克星顿</strong></td></tr><tr><td style="text-align:center;">克利夫兰</td><td style="text-align:center;">3</td><td style="text-align:center;">2</td><td style="text-align:center;">7</td><td style="text-align:center;">6</td></tr><tr><td style="text-align:center;">贝德福德</td><td style="text-align:center;">7</td><td style="text-align:center;">5</td><td style="text-align:center;">2</td><td style="text-align:center;">3</td></tr><tr><td style="text-align:center;">约克</td><td style="text-align:center;">2</td><td style="text-align:center;">5</td><td style="text-align:center;">4</td><td style="text-align:center;">5</td></tr></tbody></table> 
<p>      管理层想知道各个加工厂运输到分销中心的产品运输量应该是多少。我们可以用线性规划模型解决这类运输问题，用双下标决策变量来描述，<img alt="x_{11}" class="mathcode" src="https://images2.imgbox.com/66/0d/6ZJ0KVXi_o.png">表示从加工厂1克利夫兰到分销中心1波士顿的运输量，<img alt="x_{12}" class="mathcode" src="https://images2.imgbox.com/48/ee/gY2ZUwOa_o.png">表示从加工厂1克利夫兰到分销中心2芝加哥的运输量，以此类推。一般情况下，m个起点和n个重点的运输问题的决策变量常被表示成以下形式：</p> 
<p>      <img alt="x_{ij}" class="mathcode" src="https://images2.imgbox.com/61/02/3SrKkEto_o.png">-------从起点i到终点j的运输量。i=1，2，3，...,m; j=1,2,3...,n</p> 
<h2 id="1.2%20%E6%95%B0%E5%AD%A6%E6%A8%A1%E5%9E%8B"><strong>1.2 数学模型</strong></h2> 
<p>        根据生产能力约束和目标函数建立线性规划模型，如下所示：</p> 
<p style="text-align:center;"><img alt="Min \left ( 3x_{11}+2x_{12}+7x_{13}+6x_{14}+7x_{21}+5x_{22}+2x_{23}+3x_{24}+2x_{31}+5x_{32}+4x_{33}+5x_{34} \right )" class="mathcode" src="https://images2.imgbox.com/6f/7c/FgzpMvjP_o.png"></p> 
<p style="text-align:center;"> <img alt="x_{11}+x_{12}+x_{13}+x_{14}\leq 5000" class="mathcode" src="https://images2.imgbox.com/08/c3/Dqqjwlde_o.png"></p> 
<p style="text-align:center;"><img alt="x_{21}+x_{22}+x_{23}+x_{24}\leq 6000" class="mathcode" src="https://images2.imgbox.com/25/66/OBjOmq5b_o.png"></p> 
<p style="text-align:center;"> <img alt="x_{31}+x_{32}+x_{33}+x_{34}\leq 2500" class="mathcode" src="https://images2.imgbox.com/09/8c/6Q7sk3ja_o.png"></p> 
<p style="text-align:center;"> <img alt="x_{11}+x_{21}+x_{31}=6000" class="mathcode" src="https://images2.imgbox.com/8a/32/C9c7fYll_o.png"></p> 
<p style="text-align:center;"><img alt="x_{21}+x_{22}+x_{32}=4000" class="mathcode" src="https://images2.imgbox.com/68/32/ydScx67g_o.png"></p> 
<p style="text-align:center;"><img alt="x_{31}+x_{32}+x_{33}=2000" class="mathcode" src="https://images2.imgbox.com/b4/84/GhIzfskl_o.png"></p> 
<p style="text-align:center;"><img alt="x_{41}+x_{42}+x_{43}=1500" class="mathcode" src="https://images2.imgbox.com/02/d1/7aB6slVu_o.png"></p> 
<p style="text-align:center;"><img alt="x_{ij}\geq 0,i=1,2,3;j=1,2,3,4" class="mathcode" src="https://images2.imgbox.com/a2/fa/Np76cmak_o.png"></p> 
<p><strong>注意，最后一条决策变量的取值范围记得加上。</strong></p> 
<h2 id="1.3%C2%A0excel%E6%B1%82%E8%A7%A3"><strong>1.3 excel求解</strong></h2> 
<p>     接下来介绍怎么使用excel求解简单的运输问题。</p> 
<h3 id="%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E5%BB%BA%E7%AB%8B%E4%B8%80%E4%B8%AA%E5%B7%A5%E4%BD%9C%E8%A1%A8"><strong>第一步：建立一个工作表</strong></h3> 
<p>        首先输入运输成本、起终点供给量及终点节点的需求量。然后在工作表底端构建这个问题的线性规划问题。所有的线性规划问题都包含四个要素：决策变量、目标函数、左端约束条件和右端值。</p> 
<p>       在单元格C13中输入公式=SUMPRODUCT(B5:E7,B17:F19)，用来计算解的总运输成本。单元格F17=SUM(B17:E17),F18、F19类推，计算各个起点运往各个分销商的供给总量。单元格B20=SUM(B17:B19)，C20到E20类推，计算的是运入各个分销商的货物量。</p> 
<h3 id="%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E6%B1%82%E8%A7%A3%E5%99%A8%E6%B1%82%E8%A7%A3"><strong>第二步：求解器求解</strong></h3> 
<p>       选择<strong>数据&gt;规划求解器</strong>，设置规划求解参数，如下图所示：</p> 
<p class="img-center"><img alt="" height="1109" src="https://images2.imgbox.com/01/0a/rieBjE3A_o.png" width="1200"></p> 
<p>         点击求解，结果如下所示：</p> 
<p class="img-center"><img alt="" height="853" src="https://images2.imgbox.com/9f/76/wD6jY5Hm_o.png" width="1200"></p> 
<p>         <strong>目标函数最小值为39500，决策变量<img alt="x_{11}" class="mathcode" src="https://images2.imgbox.com/6a/86/71BhK5xA_o.png">=3500，<img alt="x_{12}=1500" class="mathcode" src="https://images2.imgbox.com/8e/1f/DsQzKUDU_o.png">，<img alt="x_{22}=2500" class="mathcode" src="https://images2.imgbox.com/f1/00/Oed7S22z_o.png">，<img alt="x_{23}=2000" class="mathcode" src="https://images2.imgbox.com/96/46/AJbhRDYy_o.png">，<img alt="x_{24}=1500" class="mathcode" src="https://images2.imgbox.com/87/65/Bp77ZkWG_o.png">，<img alt="x_{41}=2500" class="mathcode" src="https://images2.imgbox.com/2c/67/M5XGmFEb_o.png">，其他决策变量都为0，即对应的路线上没有运输量。</strong></p> 
<p></p> 
<p></p> 
<h2></h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3661a3a32719513bde18f61d68bdee36/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Impala vs. Presto简要对比梳理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a25849a083fdd3fe5bff1577695b9212/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">记一次rsyslog配置问题，导致系统无法打印日志</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>