<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>驱动程序开发：FTP服务器和OpenSSH的移植与搭建、以及一些笔记 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="驱动程序开发：FTP服务器和OpenSSH的移植与搭建、以及一些笔记" />
<meta property="og:description" content="目录 一、FTP服务器移植与搭建1、在ubuntu下安装vsftpd2、在window下安装FileZilla3、移植vsftpd到开发板上4、Filezilla 连接测试5、`注意点` 二、开发板 OpenSSH 移植与使用1、移植 zlib 库2、移植 openssl 库3、移植 openssh 库4、openssh 使用测试 三、关于u-boot上的操作及根文件系统下的脚本文件知识点1、bdinfo - 查看开发板的相关信息2、pri – 查看环境变量3、version – 查看uboot版本信息4、setenv name xxx； saveenv – 设置环境变量，并保存5、dhcp 用于从路由器获取 IP 地址6、uboot中的nfs命令格式如下所示：7、uboot中的tftp命令格式如下所示：8、查看当前开发板一共有几个 MMC 设备9、切换当前 MMC 设备10、查看 EMMC 的分区情况11、mmc write 命令烧写数据到SD设备或者EMMC中12、查询指定 MMC 设备分区的文件系统信息13、查询 FAT 格式设备的目录和文件信息14、查看 MMC 设备某个分区的文件系统格式16、fatwrite 命令17、通过tftp方式下载Linux镜像和设备树，然后通过bootz启动Linux系统18、使用命令 fatload 将 zImage 和 imx6ull-14x14-emmc-7-1024x600-c.dtb 从EMMC 的分区 1 中拷贝到 DRAM 中，启动 Linux 系统19、bootm命令20、 环境变量 bootargs21、USB WIFI启动22、开发板Linux启动方式23、关于根文件系统中/etc/init.d/rcS、 /etc/fstab、 /etc/inittab文件的知识点 一、FTP服务器移植与搭建 将 ALPHA 开发板作为一个小型的 FTP 服务器，这样我们就可以通过 FileZilla 软件直接在开发板和 windows 之间通过网络进行文件互传。而在开发板上搭建 FTP 服务器很简单，就是 vsftpd 的移植。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/8796cf8575d5172c4cfb85fbb14b0ab1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-10T16:16:56+08:00" />
<meta property="article:modified_time" content="2023-03-10T16:16:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">驱动程序开发：FTP服务器和OpenSSH的移植与搭建、以及一些笔记</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#FTP_1" rel="nofollow">一、FTP服务器移植与搭建</a></li><li><ul><li><a href="#1ubuntuvsftpd_3" rel="nofollow">1、在ubuntu下安装vsftpd</a></li><li><a href="#2windowFileZilla_5" rel="nofollow">2、在window下安装FileZilla</a></li><li><a href="#3vsftpd_7" rel="nofollow">3、移植vsftpd到开发板上</a></li><li><a href="#4Filezilla__55" rel="nofollow">4、Filezilla 连接测试</a></li><li><a href="#5_65" rel="nofollow">5、`注意点`</a></li></ul> 
  </li><li><a href="#_OpenSSH__70" rel="nofollow">二、开发板 OpenSSH 移植与使用</a></li><li><ul><li><a href="#1_zlib__74" rel="nofollow">1、移植 zlib 库</a></li><li><a href="#2_openssl__88" rel="nofollow">2、移植 openssl 库</a></li><li><a href="#3_openssh__106" rel="nofollow">3、移植 openssh 库</a></li><li><a href="#4openssh__170" rel="nofollow">4、openssh 使用测试</a></li></ul> 
  </li><li><a href="#uboot_190" rel="nofollow">三、关于u-boot上的操作及根文件系统下的脚本文件知识点</a></li><li><ul><li><a href="#1bdinfo___196" rel="nofollow">1、bdinfo - 查看开发板的相关信息</a></li><li><a href="#2pri___198" rel="nofollow">2、pri – 查看环境变量</a></li><li><a href="#3version__uboot_200" rel="nofollow">3、version – 查看uboot版本信息</a></li><li><a href="#4setenv_name_xxx_saveenv___202" rel="nofollow">4、setenv name xxx； saveenv – 设置环境变量，并保存</a></li><li><a href="#5dhcp__IP__205" rel="nofollow">5、dhcp 用于从路由器获取 IP 地址</a></li><li><a href="#6ubootnfs_208" rel="nofollow">6、uboot中的nfs命令格式如下所示：</a></li><li><a href="#7uboottftp_213" rel="nofollow">7、uboot中的tftp命令格式如下所示：</a></li><li><a href="#8_MMC__218" rel="nofollow">8、查看当前开发板一共有几个 MMC 设备</a></li><li><a href="#9_MMC__220" rel="nofollow">9、切换当前 MMC 设备</a></li><li><a href="#10_EMMC__222" rel="nofollow">10、查看 EMMC 的分区情况</a></li><li><a href="#11mmc_write_SDEMMC_224" rel="nofollow">11、mmc write 命令烧写数据到SD设备或者EMMC中</a></li><li><a href="#12_MMC__227" rel="nofollow">12、查询指定 MMC 设备分区的文件系统信息</a></li><li><a href="#13_FAT__229" rel="nofollow">13、查询 FAT 格式设备的目录和文件信息</a></li><li><a href="#14_MMC__231" rel="nofollow">14、查看 MMC 设备某个分区的文件系统格式</a></li><li><a href="#16fatwrite__235" rel="nofollow">16、fatwrite 命令</a></li><li><a href="#17tftpLinuxbootzLinux_237" rel="nofollow">17、通过tftp方式下载Linux镜像和设备树，然后通过bootz启动Linux系统</a></li><li><a href="#18_fatload__zImage__imx6ull14x14emmc71024x600cdtb_EMMC__1__DRAM__Linux__239" rel="nofollow">18、使用命令 fatload 将 zImage 和 imx6ull-14x14-emmc-7-1024x600-c.dtb 从EMMC 的分区 1 中拷贝到 DRAM 中，启动 Linux 系统</a></li><li><a href="#19bootm_241" rel="nofollow">19、bootm命令</a></li><li><a href="#20%09_bootargs_243" rel="nofollow">20、 环境变量 bootargs</a></li><li><a href="#21USB_WIFI_245" rel="nofollow">21、USB WIFI启动</a></li><li><a href="#22Linux_254" rel="nofollow">22、开发板Linux启动方式</a></li><li><a href="#23etcinitdrcS_etcfstab_etcinittab_274" rel="nofollow">23、关于根文件系统中/etc/init.d/rcS、 /etc/fstab、 /etc/inittab文件的知识点</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="FTP_1"></a>一、FTP服务器移植与搭建</h2> 
<p>  将 ALPHA 开发板作为一个小型的 FTP 服务器，这样我们就可以通过 FileZilla 软件直接在开发板和 windows 之间通过网络进行文件互传。而在开发板上搭建 FTP 服务器很简单，就是 vsftpd 的移植。</p> 
<h3><a id="1ubuntuvsftpd_3"></a>1、在ubuntu下安装vsftpd</h3> 
<p><img src="https://images2.imgbox.com/99/56/1N9hey5H_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2windowFileZilla_5"></a>2、在window下安装FileZilla</h3> 
<p>  FileZilla官网下载，下载地址如下：<a href="https://www.filezilla.cn/download" rel="nofollow">点击链接</a>。步骤省略。</p> 
<h3><a id="3vsftpd_7"></a>3、移植vsftpd到开发板上</h3> 
<p>  现在需要在自己制作的根文件系统中安装 vsftpd，所以就需要我们自己移植 vsfpd。首先需要到 vsftpd 官网下载 vsftpd 源码，网址为：<a href="https://security.appspot.com/vsftpd.html" rel="nofollow">点击链接</a>。</p> 
<p><code>移植步骤及注意点：</code><br>   将 vsftpd-3.0.3.tar.gz 发送到 ubuntu 中，然后使用如下命令进行解压：</p> 
<blockquote> 
 <p>tar -vxzf vsftpd-3.0.3.tar.gz //解压缩</p> 
</blockquote> 
<p>  解压缩完成以后会得到一个名为“vsftpd-3.0.3”的文件夹，然后进入此文件夹内。<br>   打开 Makefile，我们需要配置一下，修改 Makefile 中的 CC 变量为我们所使用的交叉编译器：</p> 
<blockquote> 
 <p>CC = arm-linux-gnueabihf-gcc //CC 为交叉编译器</p> 
</blockquote> 
<p>  Makefile 修改完成以后就可以编译：</p> 
<blockquote> 
 <p>make //编译 vsftpd</p> 
</blockquote> 
<p>  等待编译完成，会得到两个文件： vsftpd 和 vsftpd.conf，我们需要这两个文件。将 vsftpd 拷贝到开发板根文件系统下的/usr/sbin 目录下，将 vsftpd.conf 拷贝到开发板根文件系统的/etc 目录下。<br>   拷贝完成以后给予 vsftpd 可执行权限，并且修改 vsfptd.conf 所属用户为 root，命令如下：</p> 
<blockquote> 
 <p>chmod +x /usr/sbin/vsftpd<br> chown root:root /etc/vsftpd.conf</p> 
</blockquote> 
<p>  修改vsftpd配置 ，允许本地用户注册和允许任何FTP写命令，操作如下：<br> <img src="https://images2.imgbox.com/fb/c1/qv1AgYhZ_o.png" alt="在这里插入图片描述"><br>   如果第一次添加用户的话要先将 ubuntu 下的/etc/passwd 和/etc/group 这两个文件复制到开发板根文件系统的对应目录，命令如下：</p> 
<blockquote> 
 <p>sudo cp /etc/passwd /home/djw/linux/nfs/rootfs/etc/ -f<br> sudo cp /etc/group /home/djw/linux/nfs/rootfs/etc/ -f</p> 
</blockquote> 
<p>  然后修改开发板根文件系统中的/etc/passwd 和/etc/group 这两个文件，只保留“root”这一项。 passwd 文件“root”行最后改为“/bin/sh”， 修改后的 passwd 和 group 文件内容如下图所示：<br> <img src="https://images2.imgbox.com/a2/cb/xrxNzYws_o.png" alt="在这里插入图片描述"><br>   vsftpd 默认需要两个用户，这两个用户名分别为：“ftp”和“nobody”。在创建这两个用户之前先检查一下下面几个文件和目录是否存在，如果不存在的话需要先创建下面这些文件和目录：</p> 
<blockquote> 
 <p>/home //目录，不存在的话自行创建<br> /usr/share/empty //目录，不存在的话自行创建<br> /var/log //目录，不存在的话自行创建<br> /var/log/vsftpd.log //文件，不存在的话自行创建</p> 
</blockquote> 
<p>  创建命令如下：</p> 
<blockquote> 
 <p>mkdir /home<br> mkdir /usr/share/empty -p<br> mkdir /var/log -p<br> touch /var/log/vsftpd.log</p> 
</blockquote> 
<p>  准备好以后就可以使用“adduser”命令创建“ftp”和“nobody”这两个用户，命令如下：(密码自定义即可)</p> 
<blockquote> 
 <p>adduser ftp //创建 ftp 用户<br> adduser nobody //创建 nobody 用户</p> 
</blockquote> 
<p>  最后还需要创建一个登录用户， Filezilla 连接 FTP 服务器的时候一般需要输入用户名和密码，当然了， Filezilla 也支持匿名登录。使用用户名加密码登录的话就要创建一个用户，用户名自己定义，这里我创建一个名为“djw”的用户，命令如下：</p> 
<blockquote> 
 <p>adduser djw//创建登录要用户</p> 
</blockquote> 
<p>  最终会在/home 目录下存在三个用户目录，分别对应“ftp”、“nobody”和“djw”，如下图所示<br> <img src="https://images2.imgbox.com/75/98/VXtYFd5B_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4Filezilla__55"></a>4、Filezilla 连接测试</h3> 
<p>  测试之前确保直接开发板网络连接正常，电脑可以 ping 通开发板！<br>   输入如下命令，启动 vsftpd 服务器：</p> 
<blockquote> 
 <p>vsftpd &amp; //启动 vsftpd<br> <code>这里也可以将”vsftpd &amp;“指令添加到/etc/init.d/rsC文件下，让开发板开机自启动。</code></p> 
</blockquote> 
<p>  vsftpd 启动以后就可以使用 filezilla 进行连接测试了，新建站点，站点设置如下图所示：<br> <img src="https://images2.imgbox.com/46/71/7pqulSIP_o.png" alt="在这里插入图片描述"><br>   设置好以后就可以连接了，连接成功以后如下图所示：<code>文件拖拉即可传输文件</code><br> <img src="https://images2.imgbox.com/9d/81/GrdRFQAU_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5_65"></a>5、<code>注意点</code></h3> 
<p>  如果使用FileZilla软件连接开发板时出现了<code>500 OOPS: cannot change directory:/home/*******</code>这样的错误信息，如下图所示：<br> <img src="https://images2.imgbox.com/62/49/cVe4nHGN_o.png" alt="在这里插入图片描述"><br>   其实就是/home/djw这个目录权限不够，那我们可不可以将该目录直接”chmod 777 /home/djw“呢？ 经过验证是不行的。因此我们需要在vsftpd.conf配置文件添加以下内容，如下图所示：<br> <img src="https://images2.imgbox.com/9e/37/zYzFo1uY_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_OpenSSH__70"></a>二、开发板 OpenSSH 移植与使用</h2> 
<p><img src="https://images2.imgbox.com/a7/9a/nY7qnNq2_o.png" alt="在这里插入图片描述"><br>   openssh库依赖于zlib 库 和 openssl 库。</p> 
<h3><a id="1_zlib__74"></a>1、移植 zlib 库</h3> 
<p>  zlib 源码下载地址为：<a href="http://zlib.net/" rel="nofollow">点击链接</a>，拷贝到 ubuntu 中并解压，命令如下：</p> 
<blockquote> 
 <p>tar -vxzf zlib-1.2.11.tar.gz //解压</p> 
</blockquote> 
<p>  解压完成以后得到一个名为“zlib-1.2.11”的 zlib 源码文件。另外新建一个名为“zlib”的文件夹来保存 zlib 的编译结果。进入 zlib 源码目录，然后配置并编译，命令如下：</p> 
<blockquote> 
 <p>cd zlib-1.2.11/ //进去 zlib 源码<br> CC=arm-linux-gnueabihf-gcc LD=arm-linux-gnueabihf-ld AD=arm-linux-gnueabihfas ./configure --prefix=/home/djw/linux/IMX6ULL/tool/zlib //配置<br> make //编译<br> make install</p> 
</blockquote> 
<p>  编译、安装完成以后的 zlib 目录内容如下图所示：<br> <img src="https://images2.imgbox.com/f4/7d/m3okJqIO_o.png" alt="在这里插入图片描述"><br>   将上图中的 lib 目录下的 zlib 库文件拷贝到开发板根文件系统的/lib 目录下，命令为：</p> 
<blockquote> 
 <p>sudo cp lib/* /home/djw/linux/nfs/rootfs/lib/ -rfa</p> 
</blockquote> 
<h3><a id="2_openssl__88"></a>2、移植 openssl 库</h3> 
<p>  openssl 源码下载地址为：<a href="https://github.com/openssl/openssl">点击链接</a><br>   将 openssl 源码压缩包拷贝到 Ubuntu 中前面创建的 tool 目录下，然后使用如下命令将其解压：</p> 
<blockquote> 
 <p>tar -vxzf openssl-1.1.1d.tar.gz</p> 
</blockquote> 
<p>  解压完成以后就会生成一个名为 openssl-1.1.1d 的目录，然后在新建一个名为“openssl”的文件夹，用于存放 openssl 的编译结果。进入到解压出来的 openssl-1.1.1d 目录中，然后执行如下命令进行配置：</p> 
<blockquote> 
 <p>./Configure linux-armv4 shared no-asm --prefix=/home/djw/linux/IMX6ULL/tool/openssl CROSS_COMPILE=arm-linux-gnueabihf-</p> 
</blockquote> 
<p>  上述配置中“ linux-armv4”表示 32 位 ARM 凭条，并没有“ linux-armv7”这个选项。CROSS_COMPILE 用于指定交叉编译器。配置成功以后会生成 Makefile，输入如下命令进行编译：</p> 
<blockquote> 
 <p>make<br> make install</p> 
</blockquote> 
<p>  编译安装完成以后的 openssl 目录内容如下图所示：<br> <img src="https://images2.imgbox.com/c7/68/IaII1fc4_o.png" alt="在这里插入图片描述"><br>   将图 上图中的 lib 目录是我们需要的，将 lib 目录下的 libcrypto 和 libssl 库拷贝到开发板根文件系统中的/usr/lib 目录下，命令如下：</p> 
<blockquote> 
 <p>sudo cp libcrypto.so* /home/djw/linux/nfs/rootfs/lib/ -af<br> sudo cp libssl.so* /home/djw/linux/nfs/rootfs/lib/ -af</p> 
</blockquote> 
<h3><a id="3_openssh__106"></a>3、移植 openssh 库</h3> 
<p>  openssh 源码下载地址为：<a href="https://mirrors.aliyun.com/openssh/?spm=a2c6h.13651104.0.0.f62a53a2ceboVf" rel="nofollow">点击链接</a>,如下图所示：<br> <img src="https://images2.imgbox.com/8e/94/aEBKzfeP_o.png" alt="在这里插入图片描述"><br>   先解压 openssh 源码，命令如下：</p> 
<blockquote> 
 <p>tar -vxzf openssh-8.2.tar.gz</p> 
</blockquote> 
<p>  解压完成以后就会生成一个名为“openssh-8.2”的文件夹，进入此文件夹里面，然后配置并编译 openssh，命令如下：</p> 
<blockquote> 
 <p>cd openssh-8.2/<br> ./configure --host=arm-linux-gnueabihf --with-libs --with-zlib=/home/djw/linux/IMX6ULL/tool/zlib --with-ssl-dir=/home/djw/linux/IMX6ULL/tool/openssl --disable-etcdefault-login CC=arm-linux-gnueabihf-gcc AR=arm-linux-gnueabihf-ar //配置<br> make //编译</p> 
</blockquote> 
<p>  在配置 openssh 的过程中，“–with-zlib”参数用于指定 zlib 库所在的目录，“–with-ssl-dir”参数用于指定 openssl 库所在的目录，编译 openssh 的时候不用“make install”。</p> 
<p>  openssh 交叉编译完成以后在开发板中创建如下所示目录（如果存在的话就不需要创建）：</p> 
<blockquote> 
 <p>/usr/local/bin<br> /usr/local/sbin<br> /usr/local/libexec<br> /usr/local/etc<br> /var/run<br> /var/empty</p> 
</blockquote> 
<p>  创建命令如下：</p> 
<blockquote> 
 <p>mkdir /usr/local/bin -p<br> mkdir /usr/local/sbin -p<br> mkdir /usr/local/libexec/ -p<br> mkdir /usr/local/etc -p<br> mkdir /var/run -p<br> mkdir /var/empty/ -p</p> 
</blockquote> 
<p>  上述目录创建好以后将如下文件拷贝到开发板的/usr/local/bin 目录下：<br> scp、sftp、ssh、ssh-add、ssh-agent、ssh-keygen、ssh-keyscan<br>   将如下文件拷贝到开发板的/usr/local/sbin 目录下：<br> sshd<br>   将如下文件拷贝到开发板的/usr/local/etc 目录下：<br> moduli、ssh_config、sshd_config<br>   将如下文件拷贝到开发板的/usr/local/libexec 目录下：<br> sftp-server、ssh-keysign<br>   创建软连接，进入开发板中的/bin 目录下，输入如下命令创建软连接：</p> 
<blockquote> 
 <p>cd /bin/<br> ln -s /usr/local/bin/scp<br> ln -s /usr/local/bin/sftp<br> ln -s /usr/local/bin/ssh<br> ln -s /usr/local/bin/ssh-add<br> ln -s /usr/local/bin/ssh-agent<br> ln -s /usr/local/bin/ssh-keygen<br> ln -s /usr/local/bin/ssh-keyscan</p> 
</blockquote> 
<p>  再进入开发板的/sbin 目录下，输入如下命令创建软连接：</p> 
<blockquote> 
 <p>cd /sbin/<br> ln -s /usr/local/sbin/sshd</p> 
</blockquote> 
<p>  软连接创建完成以后就可以直接调用上面 ssh 相关命令了。<br>   打开/usr/local/etc/sshd_config 文件，找到“#PermitRootLogin”所在行，将其改为“PermitRootLogin yes”。</p> 
<p>  当所需的文件都存在以后就可以使用 adduser 创建名为“sshd”的用户了，创建 sshd 用户的时候需要设置密码，大家一定要记得这个密码，这里我设置简单一点，为“123456”，创建过程如下图所示：<br> <img src="https://images2.imgbox.com/ab/bc/h4eUl1oH_o.png" alt="在这里插入图片描述"><br>   一切准备好以后我们还需要在开发板中生成秘钥文件，使用我们上面移植 openssh 所编译出来的 ssh-keygen 软件即可。进入到开发板的/usr/local/etc 目录下，输入如下所示命令生成秘钥文件，由于 6ULL 性能比较差，有些秘钥文件生成过程可以会有点耗时，打开几十秒：</p> 
<blockquote> 
 <p>ssh-keygen -t rsa -f ssh_host_rsa_key -N “”<br> ssh-keygen -t dsa -f ssh_host_dsa_key -N “”<br> ssh-keygen -t ecdsa -f ssh_host_ecdsa_key -N “”<br> ssh-keygen -t ed25519 -f ssh_host_ed25519_key -N “”</p> 
</blockquote> 
<p>完成以后就会在/usr/local/etc 目录下产生 8 个以“ssh_host_”开头的秘钥文件，如下图所示：<br> <img src="https://images2.imgbox.com/5a/c4/OTy1ShIW_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4openssh__170"></a>4、openssh 使用测试</h3> 
<p>  openssh 移植已经移植到了开发板中，我们可以通过 sshd 软件在开发板上搭建 openssh 服务器，然后在其他的主机上通过 ssh 来登录开发板。我们可以同样使用 scp 命令来向开发板传输文件。首先要在开发板上启动 ssh 服务， sshd 软件用于启动 ssh 服务，注意要输入全路径！输入如下命令：</p> 
<blockquote> 
 <p>/sbin/sshd //启动 sshd 服务<br> <code>也可以在/etc/init.d/rcS 文件中加入以上命令，实现 ssh 服务开机自启动。</code></p> 
</blockquote> 
<p>  使用XobaXterm软件的SSH工具远程登陆开发板，如下图所示：<br> <img src="https://images2.imgbox.com/e9/6a/PuWsdB0A_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7f/d8/uUaN5IJy_o.png" alt="在这里插入图片描述"><br>   也可以在 ubuntu 下通过 ssh 命令登录开发板，如下图所示：<br> <img src="https://images2.imgbox.com/0f/0c/Glo28tZa_o.png" alt="在这里插入图片描述"><br>   使用scp 命令拷贝文件，例如把ubuntu中的文件发送给开发板中，如下图所示：<br> <img src="https://images2.imgbox.com/38/1a/C76rJtqr_o.png" alt="在这里插入图片描述"><br>   上图出现无效连接，这是因为/dev/null文件拒绝访问了，我们先看看开发板根文件系统下的/dev/null文件的信息，如下图所示：<br> <img src="https://images2.imgbox.com/31/d0/djDSTAwI_o.png" alt="在这里插入图片描述"><br>   由上图可知，/dev/null文件只有文件所以者和用户组拥有读和写的权限，其他用户是没有权限的，因此导致ubuntu这边是没有权限操作的，所以我们需要给/dev/null文件增加其他用户的读写权限，因为每次系统重新启动，该文件权限会恢复默认的，所以我们需要在系统启动后给它赋予其他用户的读写权限，操作是：在/etc/init.d/rcS脚本文件中添加<code>"chmod 666 /dev/null"</code>即可。<br>   那么再次重新传输文件，如下图所示：<br> <img src="https://images2.imgbox.com/fc/c1/JO8DVKBw_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/03/23/gcvOW0Au_o.png" alt="在这里插入图片描述"><br>   已经文件传输成功了。</p> 
<h2><a id="uboot_190"></a>三、关于u-boot上的操作及根文件系统下的脚本文件知识点</h2> 
<p>简介：<br> Linux 系统要启动就必须需要一个 bootloader 程序，也就说芯片上电以后先运行一段bootloader 程序。这段bootloader程序会先初始化DDR等外设，然后将Linux内核从flash(NAND，NOR FLASH， SD， MMC 等)拷贝到 DDR 中，最后启动 Linux 内核。当然了，bootloader 的实际工作要复杂的多，但是它最主要的工作就是启动 Linux 内核， bootloader 和 Linux 内核的关系就跟 PC 上的 BIOS 和 Windows 的关系一样， bootloader 就相当于 BIOS。<br> Linux开发板中，EMMC是有3个分区的，第0个分区存放uboot；第1个分区存放Linux镜像文件和设备树文件；第2个分区存放根文件系统。</p> 
<p>命令使用：</p> 
<h3><a id="1bdinfo___196"></a>1、bdinfo - 查看开发板的相关信息</h3> 
<p><img src="https://images2.imgbox.com/7d/1d/HamBzqRm_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2pri___198"></a>2、pri – 查看环境变量</h3> 
<p><img src="https://images2.imgbox.com/4f/14/e8D4wpvc_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3version__uboot_200"></a>3、version – 查看uboot版本信息</h3> 
<p><img src="https://images2.imgbox.com/96/c0/hC7F8HmH_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4setenv_name_xxx_saveenv___202"></a>4、setenv name xxx； saveenv – 设置环境变量，并保存</h3> 
<p>  例如设置uboot倒计时设置为5秒，如下图所示：<br> <img src="https://images2.imgbox.com/77/e9/yRNCcGJF_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5dhcp__IP__205"></a>5、dhcp 用于从路由器获取 IP 地址</h3> 
<p>  前提得开发板连接到路由器上的，如果开发板是和电脑直连的，那么 dhcp 命令就会失效。直接输入 dhcp 命令即可通过路由器获取到 IP 地址，如下图所示：<br> <img src="https://images2.imgbox.com/87/3e/HD777iyI_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="6ubootnfs_208"></a>6、uboot中的nfs命令格式如下所示：</h3> 
<blockquote> 
 <p>nfs [loadAddress] [[hostIPaddr:]bootfilename]</p> 
</blockquote> 
<p>  使用 nfs 命令来将 zImage 下载到开发板 DRAM 的 0X80800000 地址处，命令如下：<br> <img src="https://images2.imgbox.com/d5/37/TwCZ8VRn_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="7uboottftp_213"></a>7、uboot中的tftp命令格式如下所示：</h3> 
<blockquote> 
 <p>tftpboot [loadAddress] [[hostIPaddr:]bootfilename]</p> 
</blockquote> 
<p>  将 Ubuntu中的tftpboot 文件夹里面的 zImage 文件下载到开发板 DRAM 的 0X80800000 地址处，命令如下：<br> <img src="https://images2.imgbox.com/76/45/RfxyrBeK_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="8_MMC__218"></a>8、查看当前开发板一共有几个 MMC 设备</h3> 
<p><img src="https://images2.imgbox.com/25/40/UHFtVbxW_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="9_MMC__220"></a>9、切换当前 MMC 设备</h3> 
<p><img src="https://images2.imgbox.com/2b/c4/zSakjEcR_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="10_EMMC__222"></a>10、查看 EMMC 的分区情况</h3> 
<p><img src="https://images2.imgbox.com/61/68/FuQ2Ns7y_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="11mmc_write_SDEMMC_224"></a>11、mmc write 命令烧写数据到SD设备或者EMMC中</h3> 
<p><img src="https://images2.imgbox.com/35/3f/BGox0fs9_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d8/b4/6KDVvetS_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="12_MMC__227"></a>12、查询指定 MMC 设备分区的文件系统信息</h3> 
<p><img src="https://images2.imgbox.com/d3/e5/B3PwPuyj_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="13_FAT__229"></a>13、查询 FAT 格式设备的目录和文件信息</h3> 
<p><img src="https://images2.imgbox.com/fa/72/HLuy9la3_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="14_MMC__231"></a>14、查看 MMC 设备某个分区的文件系统格式</h3> 
<p><img src="https://images2.imgbox.com/2f/75/u0mdlJlS_o.png" alt="在这里插入图片描述"><br> 15、 用于将指定的文件读取到 DRAM 中<br> <img src="https://images2.imgbox.com/7f/eb/NlcVxK3X_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="16fatwrite__235"></a>16、fatwrite 命令</h3> 
<p><img src="https://images2.imgbox.com/99/b0/bc0Uqm9k_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="17tftpLinuxbootzLinux_237"></a>17、通过tftp方式下载Linux镜像和设备树，然后通过bootz启动Linux系统</h3> 
<p><img src="https://images2.imgbox.com/5b/38/NcXvJtXO_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="18_fatload__zImage__imx6ull14x14emmc71024x600cdtb_EMMC__1__DRAM__Linux__239"></a>18、使用命令 fatload 将 zImage 和 imx6ull-14x14-emmc-7-1024x600-c.dtb 从EMMC 的分区 1 中拷贝到 DRAM 中，启动 Linux 系统</h3> 
<p><img src="https://images2.imgbox.com/35/b6/Vs0nuzcz_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="19bootm_241"></a>19、bootm命令</h3> 
<p><img src="https://images2.imgbox.com/7b/a8/3cbcxKgJ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="20%09_bootargs_243"></a>20、 环境变量 bootargs</h3> 
<p><img src="https://images2.imgbox.com/fd/62/sD39Knmy_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="21USB_WIFI_245"></a>21、USB WIFI启动</h3> 
<p>modprobe 8188eu.ko //加载 RTL8188 驱动模块<br> ifconfig wlan0 up //打开 wlan0 网卡<br> iwlist wlan0 scan //搜索当前环境下的所有 WIFI 热点<br> //使用 wpa_supplicant 工具让 RTL8188 USB WIFI 连接到热点上。<br> wpa_supplicant -D wext -c /etc/wpa_supplicant.conf -i wlan0 &amp; <br> udhcpc -i wlan0 //从路由器获取 IP 地址<br> ping -I 192.168.43.26 www.baidu.com //ping百度</p> 
<h3><a id="22Linux_254"></a>22、开发板Linux启动方式</h3> 
<blockquote> 
 <p>uboot 启动Linux内核和设备树，根文件系统的加载在emmc内部/dev/nfs 设置：<br> setenv ipaddr 192.168.1.119 //开发板IP地址<br> setenv ethaddr b8:ae:1d:01:00:00 //开发板的 MAC 地址<br> setenv gatewayip 192.168.1.1 //开发板网关<br> setenv netmask 255.255.255.0 //子网掩码<br> setenv serverip 192.168.1.111 //服务器IP地址，例如ubuntu的<br> setenv dnsip 114.114.114.114 //设置DNS域名<br> setenv bootdelay 5 //设置boot启动延时5秒<br> 使用nfs远程挂载根文件系统到开发板上：<br> setenv bootargs ‘console=tty1 console=ttymxc0,115200 rw root=/dev/nfs nfsroot=192.168.1.111:/home/djw/linux/nfs/rootfs ip=192.168.1.119:192.168.1.111:192.168.1.1:255.255.255.0::eth0:off’<br> 使用tftp下载linux内核、设备树到开发板DRAM中，再启动<br> setenv bootcmd ‘tftp 80800000 zImage;tftp 83000000 imx6ull-alientek-emmc.dtb;bootz 80800000 - 83000000;’<br> saveenv //保存环境变量</p> 
</blockquote> 
<blockquote> 
 <p>在emmc启动的，根文件系统的加载在emmc内部/dev/mmcblk1p2<br> setenv bootcmd ‘mmc dev 1; fatload mmc 1:1 80800000 zImage; fatload mmc 1:1 83000000 imx6ull-14x14-evk.dtb;bootz 80800000 - 83000000;’<br> 根文件系统在EMMC启动<br> setenv bootargs ‘console=tty1 console=ttymxc0,115200 root=/dev/mmcblk1p2 rootwait rw ip=192.168.1.119:192.168.1.111:192.168.1.1:255.255.255.0::eth0:off’</p> 
</blockquote> 
<h3><a id="23etcinitdrcS_etcfstab_etcinittab_274"></a>23、关于根文件系统中/etc/init.d/rcS、 /etc/fstab、 /etc/inittab文件的知识点</h3> 
<p><img src="https://images2.imgbox.com/3c/ab/FsNZF9Vq_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/09/08/kRnv4B35_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/78/eb/TE5qMoyN_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/030555ffd57a1d06c92f5b6f7c7c6b49/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【无标题】LAS点云数据转DEM</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/18f48eb55fc5b75a35800bdf08b0f538/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于Spring事件监听器是发布者线程调用（同步）还是线程池调用（异步）的探究</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>