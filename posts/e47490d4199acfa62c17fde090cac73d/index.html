<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MCMC - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MCMC" />
<meta property="og:description" content="背景 给定一个的概率分布 p(x) , 我们希望产生服从该分布的样本。前面介绍过一些随机采样算法（如拒绝采样、重要性采样）可以产生服从特定分布的样本，但是这些采样算法存在一些缺陷（如难以选取合适的建议分布，只适合一元随机变量等）。下面将介绍一种更有效的随机变量采样方法：MCMC 和 Gibbs采样，这两种采样方法不仅效率更高，而且适用于多元随机变量的采样。
如果一定条件下，马尔可夫链可以收敛到平稳分布。一个绝妙的想法是：如果能构造一个转移矩阵为 P 的马尔可夫链，是其平稳分布刚好是 p(x) 。那我们就可以从任何一个初始状态 x0 出发，沿着马尔可夫链转移，得到一个转移序列 x0 , x1 , x2 ,…, xn , xn&#43;1 , xT , 如果马尔可夫链在第 n 布已经收敛，我们就得到了 p(x) 的样本 xn,xn&#43;1…xT , 过程如下所示：
设置 t=0 生成一个随机状态 u ， 设定初始状态 x0=u重复 t=t&#43;1 根据转移概率 p(xt|xt−1) , 采样得到 u 设置 xt=u直到 t=T 这种方法在1953年被 Metropolis 想到了，为了研究粒子系统的平稳性质，Metropolis 考虑了常见的玻尔兹曼分布的采样问题，首次提出了基于马尔可夫链蒙特卡罗的采样方法，即 Metropolis 算法，并在计算机上进行了编程实现。Metropolis 算法是首个普适的采样方法，并启发了一系列MCMC方法，所以人们把它作为随机模拟技术腾飞的起点。Metropolis 的这篇论文被收录在《统计学中的重大突破》，Metropolis 算法当选为二十世纪十个最重要的算法之一。
Metropolis 算法 假定目标概率分布为 p(x) , 我们已经有一个转移矩阵为 Q （q(i,j) 表示从状态 i 转移到状态 j 的概率）的马尔可夫链。通常情况下不满足马尔可夫链的细致平稳条件： p(i)q(i,j)≠p(j)q(j,i) 所以 p(x) 通常不是这个马尔可夫链的平稳分布。我们可否对该马氏链做一个改造，使得细致平稳条件成立呢？譬如，我们引入一个接受率 α(i,j) , 我们希望： p(i)q(i,j)α(i,j)=p(j)q(j,i)a(j,i) 取什么样的 α(i,j) 才能让上式成立呢？最简单的，根据对称性，我们可以取 α(i,j)=p(j)q(j,i) α(j,i)=p(i)q(i,j) 此时细致平稳条件成立： p(i)q(i,j)α(i,j)q′(i,j)=p(j)q(j,i)α(j,i)q′(j,i) 于是我们将原来具有转移矩阵 Q 的一个普通的马氏链，改造成了具有转移矩阵 Q′ （ q′(i,j) 表示从状态 i 转移到状态 j 的概率）的马氏链。而此马氏链的平稳分布刚好就是目标概率分布 p(x) ！ 接受率 α(i,j) 的理解 由于 α(i,j)=p(j)q(j,i)≤1 ，因此 ∑j∈Sq′(i,j)=∑j∈Sq(i,j)α(i,j)≤∑j∈Sq(i,j)=1 索引矩阵 Q′ 不满足马尔可夫链状态转移矩阵的条件，因而不能直接作为马尔可夫链的转移矩阵。 细致平稳条件的直观含义如下图所示：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/e47490d4199acfa62c17fde090cac73d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-12-26T20:24:27+08:00" />
<meta property="article:modified_time" content="2017-12-26T20:24:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MCMC</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2 id="背景"><strong>背景</strong></h2> 
<p>给定一个的概率分布 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame"> 
   
   <span class="math" id="MathJax-Span-1" style="width: 2.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-6" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-1">p(x)</script>, 我们希望产生服从该分布的样本。前面介绍过一些随机采样算法（如拒绝采样、重要性采样）可以产生服从特定分布的样本，但是这些采样算法存在一些缺陷（如难以选取合适的建议分布，只适合一元随机变量等）。下面将介绍一种更有效的随机变量采样方法：MCMC 和 Gibbs采样，这两种采样方法不仅效率更高，而且适用于多元随机变量的采样。</p> 
<p>如果一定条件下，马尔可夫链可以收敛到平稳分布。一个绝妙的想法是：<strong>如果能构造一个转移矩阵为 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame"> 
    
    <span class="math" id="MathJax-Span-7" style="width: 0.963em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.749em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.709em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.003em; vertical-align: -0.063em;"></span></span> 
   </span><script type="math/tex" id="MathJax-Element-2">P</script> 的马尔可夫链，是其平稳分布刚好是 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10" style="width: 2.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">p(x)</script></strong> 。那我们就可以从任何一个初始状态 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4-Frame"> 
   
   <span class="math" id="MathJax-Span-16" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.424em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-17"><span class="msubsup" id="MathJax-Span-18"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-20"><span class="mrow" id="MathJax-Span-21"><span class="mn" id="MathJax-Span-22" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-4">x_{0}</script> 出发，沿着马尔可夫链转移，得到一个转移序列 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame"> 
   
   <span class="math" id="MathJax-Span-23" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.424em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-24"><span class="msubsup" id="MathJax-Span-25"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-27"><span class="mrow" id="MathJax-Span-28"><span class="mn" id="MathJax-Span-29" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-5">x_{0}</script> , <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame"> 
   
   <span class="math" id="MathJax-Span-30" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.424em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-31"><span class="msubsup" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-34"><span class="mrow" id="MathJax-Span-35"><span class="mn" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-6">x_{1}</script> , <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame"> 
   
   <span class="math" id="MathJax-Span-37" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.424em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-38"><span class="msubsup" id="MathJax-Span-39"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-41"><span class="mrow" id="MathJax-Span-42"><span class="mn" id="MathJax-Span-43" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-7">x_{2}</script> ,…, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-8-Frame"> 
   
   <span class="math" id="MathJax-Span-44" style="width: 1.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.424em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-45"><span class="msubsup" id="MathJax-Span-46"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-48"><span class="mrow" id="MathJax-Span-49"><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-8">x_{n}</script> , <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-9-Frame"> 
   
   <span class="math" id="MathJax-Span-51" style="width: 2.509em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.976em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.723em -0.424em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-52"><span class="msubsup" id="MathJax-Span-53"><span style="display: inline-block; position: relative; width: 1.976em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-55"><span class="mrow" id="MathJax-Span-56"><span class="mi" id="MathJax-Span-57" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-58" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-59" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.937em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-9">x_{n+1}</script> , <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame"> 
   
   <span class="math" id="MathJax-Span-60" style="width: 1.443em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.123em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.424em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-61"><span class="msubsup" id="MathJax-Span-62"><span style="display: inline-block; position: relative; width: 1.123em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-64"><span class="mrow" id="MathJax-Span-65"><span class="mi" id="MathJax-Span-66" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-10">x_{T}</script> , 如果马尔可夫链在第 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame"> 
   
   <span class="math" id="MathJax-Span-67" style="width: 0.749em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.589em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-68"><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.67em; vertical-align: -0.063em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-11">n</script> 布已经收敛，我们就得到了 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-70" style="width: 2.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-71"><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">p(x)</script> 的样本 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame"> 
   
   <span class="math" id="MathJax-Span-76" style="width: 7.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.029em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(2.189em 1000em 3.149em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-77"><span class="msubsup" id="MathJax-Span-78"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-80"><span class="mrow" id="MathJax-Span-81"><span class="mi" id="MathJax-Span-82" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-84" style="padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 1.976em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-86"><span class="mrow" id="MathJax-Span-87"><span class="mi" id="MathJax-Span-88" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-89" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main; padding-left: 0.163em;">…</span><span class="msubsup" id="MathJax-Span-92" style="padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 1.123em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-94"><span class="mrow" id="MathJax-Span-95"><span class="mi" id="MathJax-Span-96" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.937em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-13">x_{n},x_{n+1} \ldots x_{T}</script> , 过程如下所示：</p> 
<ol><li>设置 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-14-Frame"> 
    
    <span class="math" id="MathJax-Span-97" style="width: 2.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.136em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.976em 1000em 2.936em -0.477em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-98"><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mn" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.269em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.003em; vertical-align: -0.063em;"></span></span> 
   </span><script type="math/tex" id="MathJax-Element-14">t=0</script></li><li>生成一个随机状态 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame"> 
    
    <span class="math" id="MathJax-Span-102" style="width: 0.749em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.589em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-103"><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.67em; vertical-align: -0.063em;"></span></span> 
   </span><script type="math/tex" id="MathJax-Element-15">u</script>， 设定初始状态 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-105" style="width: 3.629em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.883em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(2.189em 1000em 3.096em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-106"><span class="msubsup" id="MathJax-Span-107"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-109"><span class="mrow" id="MathJax-Span-110"><span class="mn" id="MathJax-Span-111" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mi" id="MathJax-Span-113" style="font-family: MathJax_Math-italic; padding-left: 0.269em;">u</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">x_{0} = u</script></li><li>重复 <br> <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-17-Frame"> 
    
    <span class="math" id="MathJax-Span-114" style="width: 0.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.003em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(3.843em 1000em 4.163em -0.477em); top: -3.997em; left: 0.003em;"><span class="mrow" id="MathJax-Span-115"></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.137em; vertical-align: -0.063em;"></span></span> 
   </span><script type="math/tex" id="MathJax-Element-17">  </script> <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-116" style="width: 4.643em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.683em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.976em 1000em 3.043em -0.477em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-117"><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math-italic; padding-left: 0.269em;">t</span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main; padding-left: 0.216em;">+</span><span class="mn" id="MathJax-Span-122" style="font-family: MathJax_Main; padding-left: 0.216em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.07em; vertical-align: -0.197em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">t=t+1</script> <br> 根据转移概率 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-19-Frame"> 
    
    <span class="math" id="MathJax-Span-123" style="width: 5.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.269em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-124"><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-127"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-129"><span class="mrow" id="MathJax-Span-130"><span class="mi" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="texatom" id="MathJax-Span-132"><span class="mrow" id="MathJax-Span-133"><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-135"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-137"><span class="mrow" id="MathJax-Span-138"><span class="mi" id="MathJax-Span-139" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-140" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
   </span><script type="math/tex" id="MathJax-Element-19">p(x_{t}|x_{t-1})</script> , 采样得到 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-20-Frame"> 
    
    <span class="math" id="MathJax-Span-143" style="width: 0.749em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.589em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-144"><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.67em; vertical-align: -0.063em;"></span></span> 
   </span><script type="math/tex" id="MathJax-Element-20">u</script> <br>
设置 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-146" style="width: 3.469em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.776em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(2.189em 1000em 3.096em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-147"><span class="msubsup" id="MathJax-Span-148"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-150"><span class="mrow" id="MathJax-Span-151"><span class="mi" id="MathJax-Span-152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-153" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Math-italic; padding-left: 0.269em;">u</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">x_{t} = u</script></li><li>直到 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22-Frame"> 
    
    <span class="math" id="MathJax-Span-155" style="width: 2.936em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.349em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.923em 1000em 2.936em -0.477em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-156"><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math-italic; padding-left: 0.269em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.003em; vertical-align: -0.063em;"></span></span> 
   </span><script type="math/tex" id="MathJax-Element-22">t=T</script></li></ol> 
<p>这种方法在1953年被 Metropolis 想到了，为了研究粒子系统的平稳性质，Metropolis 考虑了常见的玻尔兹曼分布的采样问题，首次提出了基于马尔可夫链蒙特卡罗的采样方法，即 Metropolis 算法，并在计算机上进行了编程实现。Metropolis 算法是首个普适的采样方法，并启发了一系列MCMC方法，所以人们把它作为随机模拟技术腾飞的起点。Metropolis 的这篇论文被收录在《统计学中的重大突破》，Metropolis 算法当选为二十世纪十个最重要的算法之一。</p> 
<h2 id="metropolis-算法"><strong>Metropolis 算法</strong></h2> 
<p>假定目标概率分布为 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-23-Frame"> 
   
   <span class="math" id="MathJax-Span-160" style="width: 2.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-161"><span class="mi" id="MathJax-Span-162" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-163" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-165" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-23">p(x)</script> , 我们已经有一个转移矩阵为 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-24-Frame"> 
   
   <span class="math" id="MathJax-Span-166" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.709em 1000em 2.936em -0.424em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-167"><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math-italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.27em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-24">Q</script> （<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-25-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-169" style="width: 3.043em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-170"><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-176" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">q(i,j)</script> 表示从状态 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-26-Frame"> 
   
   <span class="math" id="MathJax-Span-177" style="width: 0.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.376em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-178"><span class="mi" id="MathJax-Span-179" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.003em; vertical-align: -0.063em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-26">i</script> 转移到状态 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-27-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-180" style="width: 0.536em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.429em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.936em -0.477em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-181"><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.33em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">j</script> 的概率）的马尔可夫链。通常情况下不满足马尔可夫链的细致平稳条件： <br> <span class="MathJax_Preview"></span></p> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-28-Frame"> 
   
   <span class="math" id="MathJax-Span-183" style="width: 11.736em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.389em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-184"><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-186" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-188" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-190" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-195" style="font-family: MathJax_Main; padding-left: 0.269em;">≠</span><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math-italic; padding-left: 0.269em;">p</span><span class="mo" id="MathJax-Span-197" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-198" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-199" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-201" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-202" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-203" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-28">p(i)q(i,j) \not = p(j)q(j,i)</script> 
<br> 所以 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-29-Frame"> 
  
  <span class="math" id="MathJax-Span-206" style="width: 2.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-207"><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-209" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-210" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-211" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-29">p(x)</script> 通常不是这个马尔可夫链的平稳分布。我们可否对该马氏链做一个改造，使得细致平稳条件成立呢？譬如，我们引入一个接受率 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-30-Frame"> 
  
  <span class="math" id="MathJax-Span-212" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.616em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-213"><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-216" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-219" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-30">\alpha(i,j)</script>, 我们希望： 
<br> 
<span class="MathJax_Preview"></span> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-31-Frame"> 
   
   <span class="math" id="MathJax-Span-220" style="width: 18.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.456em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-221"><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-223" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-225" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-227" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-229" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-231" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-235" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-237" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mi" id="MathJax-Span-239" style="font-family: MathJax_Math-italic; padding-left: 0.269em;">p</span><span class="mo" id="MathJax-Span-240" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-241" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-244" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-248" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-31">p(i)q(i,j)\alpha(i,j)=p(j)q(j,i)a(j,i)</script> 
<br> 取什么样的 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-32-Frame"> 
  
  <span class="math" id="MathJax-Span-255" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.616em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-256"><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-259" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-260" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-261" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-262" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-32">\alpha(i,j)</script> 才能让上式成立呢？最简单的，根据对称性，我们可以取 
<br> 
<span class="MathJax_Preview"></span> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-33-Frame"> 
   
   <span class="math" id="MathJax-Span-263" style="width: 9.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.949em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-264"><span class="mi" id="MathJax-Span-265" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-266" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-268" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-269" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-271" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Math-italic; padding-left: 0.269em;">p</span><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-275" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-281" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-33">\alpha(i,j)=p(j)q(j,i)</script> 
<span class="MathJax_Preview"></span> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-34-Frame"> 
   
   <span class="math" id="MathJax-Span-282" style="width: 9.869em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.896em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-283"><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-289" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mi" id="MathJax-Span-291" style="font-family: MathJax_Math-italic; padding-left: 0.269em;">p</span><span class="mo" id="MathJax-Span-292" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-294" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-296" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-297" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-298" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-299" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-300" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-34">\alpha(j,i)=p(i)q(i,j)</script> 
<br> 此时细致平稳条件成立： 
<br> 
<span class="MathJax_Preview"></span> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-35-Frame"> 
   
   <span class="math" id="MathJax-Span-301" style="width: 18.296em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.616em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 4.856em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-302"><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-305" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-307"><span style="display: inline-block; position: relative; width: 5.016em; height: 0px;"><span style="position: absolute; clip: rect(3.096em 1000em 5.123em -0.477em); top: -3.997em; left: 0.003em;"><span class="munderover" id="MathJax-Span-308"><span style="display: inline-block; position: relative; width: 5.016em; height: 0px;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-309"><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-311" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-315" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-316" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-319" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.723em -0.477em); top: -1.597em; left: 0.003em;"><span class="mo" id="MathJax-Span-322" style=""><span style="display: inline-block; position: relative; width: 5.016em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.997em; left: 0.003em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.997em; left: 4.589em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.997em; left: 2.083em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 0.376em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 0.749em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 1.069em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 1.389em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 1.709em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 2.883em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 3.203em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 3.576em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 3.896em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 4.216em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(1.763em 1000em 2.883em -0.477em); top: -0.797em; left: 1.603em;"><span class="texatom" id="MathJax-Span-323"><span class="mrow" id="MathJax-Span-324"><span class="msup" id="MathJax-Span-325"><span style="display: inline-block; position: relative; width: 0.589em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.776em -0.477em); top: -2.451em; left: 0.003em;"><span class="mi" id="MathJax-Span-326" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span><span style="position: absolute; top: -2.611em; left: 0.376em;"><span class="mo" id="MathJax-Span-327" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span></span><span class="mo" id="MathJax-Span-328" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-329" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-330" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-331" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-332" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-333" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math-italic; padding-left: 0.269em;">p</span><span class="mo" id="MathJax-Span-335" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-337" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-338"><span style="display: inline-block; position: relative; width: 5.016em; height: 0px;"><span style="position: absolute; clip: rect(3.096em 1000em 5.123em -0.477em); top: -3.997em; left: 0.003em;"><span class="munderover" id="MathJax-Span-339"><span style="display: inline-block; position: relative; width: 5.016em; height: 0px;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-340"><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-342" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-344" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-345" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-348" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-349" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-350" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-351" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-352" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 2.723em -0.477em); top: -1.597em; left: 0.003em;"><span class="mo" id="MathJax-Span-353" style=""><span style="display: inline-block; position: relative; width: 5.016em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.997em; left: 0.003em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.997em; left: 4.589em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.997em; left: 2.083em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 0.376em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 0.749em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 1.069em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 1.389em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 1.709em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 2.883em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 3.203em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 3.576em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 3.896em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.997em; left: 4.216em;"><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(1.763em 1000em 2.883em -0.477em); top: -0.797em; left: 1.603em;"><span class="texatom" id="MathJax-Span-354"><span class="mrow" id="MathJax-Span-355"><span class="msup" id="MathJax-Span-356"><span style="display: inline-block; position: relative; width: 0.589em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.776em -0.477em); top: -2.451em; left: 0.003em;"><span class="mi" id="MathJax-Span-357" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span><span style="position: absolute; top: -2.611em; left: 0.376em;"><span class="mo" id="MathJax-Span-358" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span></span><span class="mo" id="MathJax-Span-359" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-360" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-361" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-362" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-363" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 3.47em; vertical-align: -2.463em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-35">p(i)\underbrace{q(i,j)\alpha(i,j)}_{q'(i,j)}=p(j)\underbrace{q(j,i)\alpha(j,i)}_{q'(j,i)}</script> 
<br> 于是我们将原来具有转移矩阵 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-36-Frame"> 
  
  <span class="math" id="MathJax-Span-364" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.709em 1000em 2.936em -0.424em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-365"><span class="mi" id="MathJax-Span-366" style="font-family: MathJax_Math-italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.27em; vertical-align: -0.33em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-36">Q</script> 的一个普通的马氏链，改造成了具有转移矩阵 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-37-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-367" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.336em 1000em 2.723em -0.424em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-368"><span class="msup" id="MathJax-Span-369"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.709em 1000em 2.936em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-370" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.877em; left: 0.803em;"><span class="mo" id="MathJax-Span-371" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.33em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">Q'</script> （ 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-38-Frame"> 
  
  <span class="math" id="MathJax-Span-372" style="width: 3.416em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.723em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-373"><span class="msup" id="MathJax-Span-374"><span style="display: inline-block; position: relative; width: 0.749em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.936em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-375" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.824em; left: 0.536em;"><span class="mo" id="MathJax-Span-376" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-377" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-379" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-380" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-381" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-38">q'(i,j)</script> 表示从状态 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-39-Frame"> 
  
  <span class="math" id="MathJax-Span-382" style="width: 0.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.376em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-383"><span class="mi" id="MathJax-Span-384" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.003em; vertical-align: -0.063em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-39">i</script> 转移到状态 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-40-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-385" style="width: 0.536em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.429em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.936em -0.477em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-386"><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.33em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">j</script> 的概率）的马氏链。而此马氏链的平稳分布刚好就是目标概率分布 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-41-Frame"> 
  
  <span class="math" id="MathJax-Span-388" style="width: 2.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-391" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-392" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-393" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-41">p(x)</script> ！ 
<p></p> 
<p><img src="https://images2.imgbox.com/e7/49/uHa0K7TD_o.png" alt="这里写图片描述" title=""></p> 
<h3 id="接受率-alphaij-的理解">接受率 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-42-Frame"> 
   
   <span class="math" id="MathJax-Span-394" style="width: 3.276em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.606em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.887em 1000.01em 3.028em -0.197em); top: -2.703em; left: 0.001em;"><span class="mrow" id="MathJax-Span-395"><span class="mi" id="MathJax-Span-396" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-397" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-398" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-399" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Math-italic; padding-left: 0.175em;">j</span><span class="mo" id="MathJax-Span-401" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left: 0.002em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.304em; vertical-align: -0.34em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-42">\alpha(i,j)</script> 的理解</h3> 
<p>由于 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-43-Frame"> 
   
   <span class="math" id="MathJax-Span-402" style="width: 12.216em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.763em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-403"><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-407" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-408" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-409" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math-italic; padding-left: 0.269em;">p</span><span class="mo" id="MathJax-Span-412" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-413" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-414" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-415" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-416" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-418" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-419" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-420" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-421" style="font-family: MathJax_Main; padding-left: 0.269em;">≤</span><span class="mn" id="MathJax-Span-422" style="font-family: MathJax_Main; padding-left: 0.269em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-43">\alpha(i,j) = p(j)q(j,i) \leq 1</script> ，因此 <br> <span class="MathJax_Preview"></span></p> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-44-Frame"> 
   
   <span class="math" id="MathJax-Span-423" style="width: 23.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.149em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.656em 1000em 4.269em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-424"><span class="munderover" id="MathJax-Span-425"><span style="display: inline-block; position: relative; width: 1.443em; height: 0px;"><span style="position: absolute; clip: rect(2.669em 1000em 4.376em -0.424em); top: -3.784em; left: 0.003em;"><span class="mo" id="MathJax-Span-426" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.789em;"></span></span><span style="position: absolute; clip: rect(1.816em 1000em 2.883em -0.477em); top: -1.331em; left: 0.109em;"><span class="texatom" id="MathJax-Span-427"><span class="mrow" id="MathJax-Span-428"><span class="mi" id="MathJax-Span-429" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-430" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-431" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msup" id="MathJax-Span-432" style="padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 0.749em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.936em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-433" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.877em; left: 0.536em;"><span class="mo" id="MathJax-Span-434" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-435" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-437" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-438" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-439" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-440" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="munderover" id="MathJax-Span-441" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 1.443em; height: 0px;"><span style="position: absolute; clip: rect(2.669em 1000em 4.376em -0.424em); top: -3.784em; left: 0.003em;"><span class="mo" id="MathJax-Span-442" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.789em;"></span></span><span style="position: absolute; clip: rect(1.816em 1000em 2.883em -0.477em); top: -1.331em; left: 0.109em;"><span class="texatom" id="MathJax-Span-443"><span class="mrow" id="MathJax-Span-444"><span class="mi" id="MathJax-Span-445" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-446" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-447" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mi" id="MathJax-Span-448" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-449" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-452" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-453" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-454" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-455" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-457" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-458" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-460" style="font-family: MathJax_Main; padding-left: 0.269em;">≤</span><span class="munderover" id="MathJax-Span-461" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 1.443em; height: 0px;"><span style="position: absolute; clip: rect(2.669em 1000em 4.376em -0.424em); top: -3.784em; left: 0.003em;"><span class="mo" id="MathJax-Span-462" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.789em;"></span></span><span style="position: absolute; clip: rect(1.816em 1000em 2.883em -0.477em); top: -1.331em; left: 0.109em;"><span class="texatom" id="MathJax-Span-463"><span class="mrow" id="MathJax-Span-464"><span class="mi" id="MathJax-Span-465" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-466" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-467" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mi" id="MathJax-Span-468" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-469" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-470" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-471" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-472" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-474" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mn" id="MathJax-Span-475" style="font-family: MathJax_Main; padding-left: 0.269em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 3.003em; vertical-align: -1.73em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-44">\sum_{j \in S} q'(i,j) = \sum_{j \in S} q(i,j) \alpha(i,j) \leq \sum_{j \in S} q(i,j) =1 </script> 索引矩阵 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-45-Frame"> 
  
  <span class="math" id="MathJax-Span-476" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.336em 1000em 2.723em -0.424em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-477"><span class="msup" id="MathJax-Span-478"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(1.709em 1000em 2.936em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.877em; left: 0.803em;"><span class="mo" id="MathJax-Span-480" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.33em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-45">Q'</script> 不满足马尔可夫链状态转移矩阵的条件，因而不能直接作为马尔可夫链的转移矩阵。 
<p></p> 
<p>细致平稳条件的直观含义如下图所示：</p> 
<p><img src="https://images2.imgbox.com/36/b6/hic6v6iA_o.png" alt="这里写图片描述" title=""></p> 
<p><strong>一般介绍MCMC的资料中没有说明状态自我转移永远是满足细致平稳条件的，自己转给自己，当然转入和转出相等。</strong> 因此可以增加自我转移的概率 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-46-Frame"> 
   
   <span class="math" id="MathJax-Span-481" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.616em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-482"><span class="msup" id="MathJax-Span-483"><span style="display: inline-block; position: relative; width: 0.749em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.936em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-484" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.824em; left: 0.536em;"><span class="mo" id="MathJax-Span-485" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-486" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-487" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-488" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-489" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-490" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-46">q'(i,i)</script> ，使 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-47-Frame"> 
   
   <span class="math" id="MathJax-Span-491" style="width: 8.749em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.989em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.363em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-492"><span class="munderover" id="MathJax-Span-493"><span style="display: inline-block; position: relative; width: 2.349em; height: 0px;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mo" id="MathJax-Span-494" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span><span style="position: absolute; top: -2.184em; left: 1.069em;"><span class="texatom" id="MathJax-Span-495"><span class="mrow" id="MathJax-Span-496"><span class="mi" id="MathJax-Span-497" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-498" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-499" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="msup" id="MathJax-Span-500" style="padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 0.749em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.936em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.824em; left: 0.536em;"><span class="mo" id="MathJax-Span-502" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-503" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-504" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-505" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mn" id="MathJax-Span-509" style="font-family: MathJax_Main; padding-left: 0.269em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.603em; vertical-align: -0.597em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-47">\sum_{j \in S} q'(i,j)=1</script> 成立 。Metropolis算法细致平稳条件如下图所示：</p> 
<p><img src="https://images2.imgbox.com/6f/0a/iMKFbzYk_o.png" alt="这里写图片描述" title=""></p> 
<p>从以上分析可以发现，<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-48-Frame"> 
   
   <span class="math" id="MathJax-Span-510" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.616em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-511"><span class="mi" id="MathJax-Span-512" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-513" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-514" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-515" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-517" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-48">\alpha(i,j)</script> 表示在原来转移矩阵为 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-49-Frame"> 
   
   <span class="math" id="MathJax-Span-518" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.709em 1000em 2.936em -0.424em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-519"><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math-italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.27em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-49">Q</script> 的马氏链中，从状态 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-50-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-521" style="width: 0.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.376em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-522"><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.003em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">i</script> 以概率 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-51-Frame"> 
   
   <span class="math" id="MathJax-Span-524" style="width: 3.043em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-525"><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-527" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-528" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-529" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-530" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-531" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-51">q(i,j)</script> 转移到状态 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-52-Frame"> 
   
   <span class="math" id="MathJax-Span-532" style="width: 0.536em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.429em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.936em -0.477em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-533"><span class="mi" id="MathJax-Span-534" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-52">j</script> 的时候，我们以 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-53-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-535" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.616em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-536"><span class="mi" id="MathJax-Span-537" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-539" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-540" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-542" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">\alpha(i,j)</script> 接受这个转移。而以概率 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-54-Frame"> 
   
   <span class="math" id="MathJax-Span-543" style="width: 9.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.469em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-544"><span class="mi" id="MathJax-Span-545" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-546" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-547" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-548" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-549" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-550" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-551" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-552" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-553" style="font-family: MathJax_Main; padding-left: 0.216em;">−</span><span class="mi" id="MathJax-Span-554" style="font-family: MathJax_Math-italic; padding-left: 0.216em;">α</span><span class="mo" id="MathJax-Span-555" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-556" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-557" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-558" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-559" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-560" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-54">q(i,j)(1-\alpha(i,j))</script> 拒绝这个转移（进行自我转移）。因此称 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-55-Frame"> 
   
   <span class="math" id="MathJax-Span-561" style="width: 0.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.643em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-562"><span class="mi" id="MathJax-Span-563" style="font-family: MathJax_Math-italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.67em; vertical-align: -0.063em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-55">\alpha</script> 为接受率。</p> 
<h3 id="metropolis算法流程">Metropolis算法流程</h3> 
<p>假定目标分布为 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-56-Frame"> 
   
   <span class="math" id="MathJax-Span-564" style="width: 2.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-565"><span class="mi" id="MathJax-Span-566" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-567" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-568" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-569" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-56">p(x)</script> ，我们已经有了一个转移矩阵为 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-57-Frame"> 
   
   <span class="math" id="MathJax-Span-570" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.709em 1000em 2.936em -0.424em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-571"><span class="mi" id="MathJax-Span-572" style="font-family: MathJax_Math-italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.27em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-57">Q</script> （对应元素为 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-58-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-573" style="width: 3.043em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-574"><span class="mi" id="MathJax-Span-575" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-576" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-578" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-579" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-580" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-58">q(i,j)</script> )，经典MCMC算法流程如下所示 <br> <img src="https://images2.imgbox.com/a4/83/D2Kip5on_o.png" alt="这里写图片描述" title=""></p> 
<p>以上分析中 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-59-Frame"> 
   
   <span class="math" id="MathJax-Span-581" style="width: 2.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-582"><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-584" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-585" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-586" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-59">p(x)</script> , <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-60-Frame"> 
   
   <span class="math" id="MathJax-Span-587" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.563em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-588"><span class="mi" id="MathJax-Span-589" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-590" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-591" style="font-family: MathJax_Math-italic;">x</span><span class="texatom" id="MathJax-Span-592"><span class="mrow" id="MathJax-Span-593"><span class="mo" id="MathJax-Span-594" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-595" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-596" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-60">q(x|y)</script> <strong>说的都是离散的情形，事实上即便这两个分布式连续的，以上算法仍然有效</strong>（此时 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-61-Frame"> 
   
   <span class="math" id="MathJax-Span-597" style="width: 2.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-598"><span class="mi" id="MathJax-Span-599" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-602" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-61">p(x)</script> 表示概率密度，<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-62-Frame"> 
   
   <span class="math" id="MathJax-Span-603" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.563em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-604"><span class="mi" id="MathJax-Span-605" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-606" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math-italic;">x</span><span class="texatom" id="MathJax-Span-608"><span class="mrow" id="MathJax-Span-609"><span class="mo" id="MathJax-Span-610" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-611" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-612" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-62">q(x|y)</script> 表示条件概率密度），因此可以生成服从连续的概率分布 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-63-Frame"> 
   
   <span class="math" id="MathJax-Span-613" style="width: 2.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-614"><span class="mi" id="MathJax-Span-615" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-616" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-617" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-618" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-63">p(x)</script> 的样本。</p> 
<p><font color="#FF0000"><em>注：MCMC算法是以于马尔可夫链为基础的。马尔可夫链通常研究的是时间和状态都是离散的随机过程。而连续分布实际上对应的状态是连续的。那么MCMC算法可以对连续分布进行采样的原因又是什么？？</em></font></p> 
<h2 id="metropolis-hastings-算法"><strong>Metropolis-Hastings 算法</strong></h2> 
<p>以上的Metropolis采样算法已经能漂亮地工作了，不过它有个小问题：马氏链在转移的过程中的接受率 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2688-Frame"> 
   
   <span class="math" id="MathJax-Span-44871" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.616em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-44872"><span class="mi" id="MathJax-Span-44873" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-44874" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44875" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-44876" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44877" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-44878" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-2688">\alpha(i,j)</script> 可能偏小，采样过程中容易原地踏步（自我转移），拒绝大量的跳转。这会导致马氏链收敛到稳态分布需要很长的时间。有没有办法提升接受率呢？</p> 
<p>假设在Metropolis算法中 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2689-Frame"> 
   
   <span class="math" id="MathJax-Span-44879" style="width: 6.509em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.176em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-44880"><span class="mi" id="MathJax-Span-44881" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-44882" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44883" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-44884" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44885" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-44886" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-44887" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mn" id="MathJax-Span-44888" style="font-family: MathJax_Main; padding-left: 0.269em;">0.1</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-2689">\alpha(i,j)=0.1</script> ，<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2690-Frame"> 
   
   <span class="math" id="MathJax-Span-44889" style="width: 6.509em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.176em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-44890"><span class="mi" id="MathJax-Span-44891" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-44892" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44893" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-44894" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44895" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-44896" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-44897" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mn" id="MathJax-Span-44898" style="font-family: MathJax_Main; padding-left: 0.269em;">0.2</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-2690">\alpha(j,i)=0.2</script>，满足细致平稳条件，下式成立： <br> <span class="MathJax_Preview"></span></p> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-2691-Frame"> 
   
   <span class="math" id="MathJax-Span-44899" style="width: 17.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.349em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-44900"><span class="mi" id="MathJax-Span-44901" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-44902" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44903" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-44904" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-44905" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-44906" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44907" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-44908" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44909" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-44910" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-44911" style="font-family: MathJax_Main; padding-left: 0.216em;">×</span><span class="mn" id="MathJax-Span-44912" style="font-family: MathJax_Main; padding-left: 0.216em;">0.1</span><span class="mo" id="MathJax-Span-44913" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mi" id="MathJax-Span-44914" style="font-family: MathJax_Math-italic; padding-left: 0.269em;">p</span><span class="mo" id="MathJax-Span-44915" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44916" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-44917" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-44918" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-44919" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44920" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-44921" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44922" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-44923" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-44924" style="font-family: MathJax_Main; padding-left: 0.216em;">×</span><span class="mn" id="MathJax-Span-44925" style="font-family: MathJax_Main; padding-left: 0.216em;">0.2</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-2691">p(i)q(i,j) \times 0.1=p(j)q(j,i) \times 0.2</script> 
<br> 将上式两边同时扩大5倍 
<br> 
<span class="MathJax_Preview"></span> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-2692-Frame"> 
   
   <span class="math" id="MathJax-Span-44926" style="width: 17.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.603em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-44927"><span class="mi" id="MathJax-Span-44928" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-44929" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44930" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-44931" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-44932" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-44933" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44934" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-44935" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44936" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-44937" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-44938" style="font-family: MathJax_Main; padding-left: 0.216em;">×</span><span class="mn" id="MathJax-Span-44939" style="font-family: MathJax_Main; padding-left: 0.216em;">0.5</span><span class="mo" id="MathJax-Span-44940" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mi" id="MathJax-Span-44941" style="font-family: MathJax_Math-italic; padding-left: 0.269em;">p</span><span class="mo" id="MathJax-Span-44942" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44943" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-44944" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-44945" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-44946" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44947" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-44948" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44949" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-44950" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-44951" style="font-family: MathJax_Main; padding-left: 0.216em;">×</span><span class="mn" id="MathJax-Span-44952" style="font-family: MathJax_Main; padding-left: 0.216em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-2692">p(i)q(i,j) \times 0.5=p(j)q(j,i) \times 1</script> 
<br> 看！我们将接受率 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-2693-Frame"> 
  
  <span class="math" id="MathJax-Span-44953" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.616em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-44954"><span class="mi" id="MathJax-Span-44955" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-44956" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44957" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-44958" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44959" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-44960" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-2693">\alpha(i,j)</script> ， 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-2694-Frame"> 
  
  <span class="math" id="MathJax-Span-44961" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.616em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-44962"><span class="mi" id="MathJax-Span-44963" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-44964" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44965" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-44966" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44967" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-44968" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-2694">\alpha(j,i)</script> 放大了5倍，而细致平稳条件仍然成立！这启发 
<strong>我们可以把接受率 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2695-Frame"> 
   
   <span class="math" id="MathJax-Span-44969" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.616em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-44970"><span class="mi" id="MathJax-Span-44971" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-44972" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44973" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-44974" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44975" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-44976" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-2695">\alpha(i,j)</script> ，<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2696-Frame"> 
   
   <span class="math" id="MathJax-Span-44977" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.616em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-44978"><span class="mi" id="MathJax-Span-44979" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-44980" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44981" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-44982" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44983" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-44984" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.397em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-2696">\alpha(j,i)</script> 同比例放大，最优的情况是使得两个数中较大的一个放大到1</strong>（因为接受率要求小于等于1）。所以我们可以取 
<br> 
<span class="MathJax_Preview"></span> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-2697-Frame"> 
   
   <span class="math" id="MathJax-Span-44985" style="width: 15.043em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.003em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.123em 1000em 3.896em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-44986"><span class="mi" id="MathJax-Span-44987" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-44988" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44989" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-44990" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44991" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-44992" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-44993" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mo" id="MathJax-Span-44994" style="font-family: MathJax_Main; padding-left: 0.269em;">min</span><span class="mo" id="MathJax-Span-44995" style="font-family: MathJax_Main;">{<!-- --></span><span class="mfrac" id="MathJax-Span-44996"><span style="display: inline-block; position: relative; width: 4.216em; height: 0px; margin-right: 0.109em; margin-left: 0.109em;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -3.517em; left: 50%; margin-left: -2.024em;"><span class="mrow" id="MathJax-Span-44997"><span class="mi" id="MathJax-Span-44998" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-44999" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-45000" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-45001" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-45002" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-45003" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-45004" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-45005" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-45006" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">i</span><span class="mo" id="MathJax-Span-45007" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.024em; left: 50%; margin-left: -1.971em;"><span class="mrow" id="MathJax-Span-45008"><span class="mi" id="MathJax-Span-45009" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-45010" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-45011" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-45012" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-45013" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-45014" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-45015" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-45016" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-45017" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">j</span><span class="mo" id="MathJax-Span-45018" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span><span style="position: absolute; clip: rect(0.856em 1000em 1.229em -0.477em); top: -1.277em; left: 0.003em;"><span style="border-left: 4.216em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.069em;"></span></span></span></span><span class="mo" id="MathJax-Span-45019" style="font-family: MathJax_Main; padding-left: 0.163em;">,</span><span class="mn" id="MathJax-Span-45020" style="font-family: MathJax_Main; padding-left: 0.163em;">1</span><span class="mo" id="MathJax-Span-45021" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 3.203em; vertical-align: -1.263em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-2697">\alpha(i,j)=\min\{\frac{p(j)q(j,i)}{p(i)q(i,j)},1\}</script> 
<br> 于是，通过对Metropolis算法中的接受率的微小改造，我们就得到了如下教科书中最常见的Metropolis-Hastings 算法。 
<p></p> 
<p><img src="https://images2.imgbox.com/7b/32/BxEwHVZi_o.png" alt="这里写图片描述" title=""></p> 
<p><font color="#FF0000"><strong>注：对未归一化的概率分布 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2698-Frame"> 
     
     <span class="math" id="MathJax-Span-45022" style="width: 6.136em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.909em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.496em 1000em 3.523em -0.531em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-45023"><span class="mi" id="MathJax-Span-45024" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-45025" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-45026" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-45027" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-45028" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mfrac" id="MathJax-Span-45029" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 1.549em; height: 0px; margin-right: 0.109em; margin-left: 0.109em;"><span style="position: absolute; clip: rect(1.763em 1000em 2.776em -0.531em); top: -3.037em; left: 50%; margin-left: -0.691em;"><span class="mrow" id="MathJax-Span-45030"><span class="texatom" id="MathJax-Span-45031"><span class="mrow" id="MathJax-Span-45032"><span class="munderover" id="MathJax-Span-45033"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.776em -0.531em); top: -2.451em; left: 0.003em;"><span class="mi" id="MathJax-Span-45034" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span><span style="position: absolute; clip: rect(2.083em 1000em 2.456em -0.424em); top: -2.771em; left: 0.109em;"><span class="mo" id="MathJax-Span-45035" style="font-size: 70.7%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-45036" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-45037" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-45038" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span><span style="position: absolute; clip: rect(3.363em 1000em 4.376em -0.477em); top: -3.624em; left: 50%; margin-left: -0.424em;"><span class="msubsup" id="MathJax-Span-45039"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(1.816em 1000em 2.616em -0.477em); top: -2.451em; left: 0.003em;"><span class="mi" id="MathJax-Span-45040" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span><span style="position: absolute; top: -2.237em; left: 0.589em;"><span class="texatom" id="MathJax-Span-45041"><span class="mrow" id="MathJax-Span-45042"><span class="mi" id="MathJax-Span-45043" style="font-size: 50%; font-family: MathJax_Math-italic;">p</span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(0.856em 1000em 1.229em -0.477em); top: -1.277em; left: 0.003em;"><span style="border-left: 1.549em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.069em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 2.27em; vertical-align: -0.797em;"></span></span> 
    </span><script type="math/tex" id="MathJax-Element-2698">p(x) = \frac{\tilde p(x)}{X_{p}}</script> (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2699-Frame"> 
     
     <span class="math" id="MathJax-Span-45044" style="width: 1.549em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.229em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.496em 1000em 2.776em -0.477em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-45045"><span class="msubsup" id="MathJax-Span-45046"><span style="display: inline-block; position: relative; width: 1.229em; height: 0px;"><span style="position: absolute; clip: rect(1.709em 1000em 2.723em -0.477em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-45047" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.803em;"><span class="texatom" id="MathJax-Span-45048"><span class="mrow" id="MathJax-Span-45049"><span class="mi" id="MathJax-Span-45050" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.337em; vertical-align: -0.397em;"></span></span> 
    </span><script type="math/tex" id="MathJax-Element-2699">X_{p}</script> 未知)。MH算法仍然适用。</strong>只需将 <strong>Algorithm 6</strong> 中的接受率可变换为： <br> <span class="MathJax_Preview"></span></font></p> 
<div class="MathJax_Display" style="text-align: center;"> 
 <font color="#FF0000"><span class="MathJax" id="MathJax-Element-2700-Frame"> 
    
    <span class="math" id="MathJax-Span-45051" style="width: 17.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.243em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(-0.637em 1000em 4.856em -0.317em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-45052"><span class="mtable" id="MathJax-Span-45053" style="padding-right: 0.163em; padding-left: 0.163em;"><span style="display: inline-block; position: relative; width: 13.976em; height: 0px;"><span style="position: absolute; clip: rect(2.189em 1000em 6.029em -0.477em); top: -4.477em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 3.256em; height: 0px;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.424em); top: -4.157em; right: 0.003em;"><span class="mtd" id="MathJax-Span-45054"><span class="mrow" id="MathJax-Span-45055"><span class="mi" id="MathJax-Span-45056" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-45057" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-45058"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-45059" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-45060"><span class="mrow" id="MathJax-Span-45061"><span class="mi" id="MathJax-Span-45062" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-45063" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-45064" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-45065" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span><span style="position: absolute; clip: rect(3.843em 1000em 4.163em -0.477em); top: -2.611em; right: 0.003em;"><span class="mtd" id="MathJax-Span-45115"><span class="mrow" id="MathJax-Span-45116"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.483em;"></span></span><span style="position: absolute; clip: rect(3.203em 1000em 8.696em -0.211em); top: -6.184em; left: 3.256em;"><span style="display: inline-block; position: relative; width: 10.723em; height: 0px;"><span style="position: absolute; clip: rect(1.123em 1000em 3.896em -0.211em); top: -4.157em; left: 0.003em;"><span class="mtd" id="MathJax-Span-45066"><span class="mrow" id="MathJax-Span-45067"><span class="mo" id="MathJax-Span-45068" style="font-family: MathJax_Main; padding-left: 0.216em; padding-right: 0.323em;">=</span><span class="mi" id="MathJax-Span-45069" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-45070" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-45071" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-45072" style="font-family: MathJax_Main;">{<!-- --></span><span class="mfrac" id="MathJax-Span-45073"><span style="display: inline-block; position: relative; width: 5.283em; height: 0px; margin-right: 0.109em; margin-left: 0.109em;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -3.517em; left: 50%; margin-left: -2.344em;"><span class="mrow" id="MathJax-Span-45074"><span class="mi" id="MathJax-Span-45075" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-45076" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-45077" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-45078" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-45079" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-45080" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-45081"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-45082" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-45083"><span class="mrow" id="MathJax-Span-45084"><span class="mi" id="MathJax-Span-45085" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="texatom" id="MathJax-Span-45086"><span class="mrow" id="MathJax-Span-45087"><span class="mo" id="MathJax-Span-45088" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-45089" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-45090" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.024em; left: 50%; margin-left: -2.557em;"><span class="mrow" id="MathJax-Span-45091"><span class="mi" id="MathJax-Span-45092" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-45093" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-45094"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-45095" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-45096"><span class="mrow" id="MathJax-Span-45097"><span class="mi" id="MathJax-Span-45098" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-45099" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-45100" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-45101" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-45102" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-45103"><span class="mrow" id="MathJax-Span-45104"><span class="mo" id="MathJax-Span-45105" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-45106"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-45107" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-45108"><span class="mrow" id="MathJax-Span-45109"><span class="mi" id="MathJax-Span-45110" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-45111" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span><span style="position: absolute; clip: rect(0.856em 1000em 1.229em -0.477em); top: -1.277em; left: 0.003em;"><span style="border-left: 5.283em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.069em;"></span></span></span></span><span class="mo" id="MathJax-Span-45112" style="font-family: MathJax_Main; padding-left: 0.163em;">,</span><span class="mn" id="MathJax-Span-45113" style="font-family: MathJax_Main; padding-left: 0.163em;">1</span><span class="mo" id="MathJax-Span-45114" style="font-family: MathJax_Main;">}</span></span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span><span style="position: absolute; clip: rect(1.123em 1000em 3.896em -0.211em); top: -1.384em; left: 0.003em;"><span class="mtd" id="MathJax-Span-45117"><span class="mrow" id="MathJax-Span-45118"><span class="mo" id="MathJax-Span-45119" style="font-family: MathJax_Main; padding-left: 0.216em; padding-right: 0.323em;">=</span><span class="mi" id="MathJax-Span-45120" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-45121" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-45122" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-45123" style="font-family: MathJax_Main;">{<!-- --></span><span class="mfrac" id="MathJax-Span-45124"><span style="display: inline-block; position: relative; width: 5.336em; height: 0px; margin-right: 0.109em; margin-left: 0.109em;"><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -3.517em; left: 50%; margin-left: -2.344em;"><span class="mrow" id="MathJax-Span-45125"><span class="texatom" id="MathJax-Span-45126"><span class="mrow" id="MathJax-Span-45127"><span class="munderover" id="MathJax-Span-45128"><span style="display: inline-block; position: relative; width: 0.589em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.936em -0.531em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-45129" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; clip: rect(2.296em 1000em 2.723em -0.371em); top: -3.144em; left: 0.109em;"><span class="mo" id="MathJax-Span-45130" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-45131" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-45132" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-45133" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-45134" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-45135" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-45136"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-45137" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-45138"><span class="mrow" id="MathJax-Span-45139"><span class="mi" id="MathJax-Span-45140" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="texatom" id="MathJax-Span-45141"><span class="mrow" id="MathJax-Span-45142"><span class="mo" id="MathJax-Span-45143" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-45144" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-45145" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span><span style="position: absolute; clip: rect(1.869em 1000em 3.203em -0.531em); top: -2.024em; left: 50%; margin-left: -2.611em;"><span class="mrow" id="MathJax-Span-45146"><span class="texatom" id="MathJax-Span-45147"><span class="mrow" id="MathJax-Span-45148"><span class="munderover" id="MathJax-Span-45149"><span style="display: inline-block; position: relative; width: 0.589em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.936em -0.531em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-45150" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; clip: rect(2.296em 1000em 2.723em -0.371em); top: -3.144em; left: 0.109em;"><span class="mo" id="MathJax-Span-45151" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-45152" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-45153"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-45154" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-45155"><span class="mrow" id="MathJax-Span-45156"><span class="mi" id="MathJax-Span-45157" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-45158" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-45159" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-45160" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-45161" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-45162"><span class="mrow" id="MathJax-Span-45163"><span class="mo" id="MathJax-Span-45164" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-45165"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-45166" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-45167"><span class="mrow" id="MathJax-Span-45168"><span class="mi" id="MathJax-Span-45169" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-45170" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span><span style="position: absolute; clip: rect(0.856em 1000em 1.229em -0.477em); top: -1.277em; left: 0.003em;"><span style="border-left: 5.336em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.069em;"></span></span></span></span><span class="mo" id="MathJax-Span-45171" style="font-family: MathJax_Main; padding-left: 0.163em;">,</span><span class="mn" id="MathJax-Span-45172" style="font-family: MathJax_Main; padding-left: 0.163em;">1</span><span class="mo" id="MathJax-Span-45173" style="font-family: MathJax_Main;">}</span></span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.189em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 6.603em; vertical-align: -2.997em;"></span></span> 
   </span></font> 
</div> 
<font color="#FF0000"><script type="math/tex; mode=display" id="MathJax-Element-2700">\begin{equation}
\begin{split}
\alpha(x_{t},y) &= min\{\frac{p(y)q(x_{t}|y)}{p(x_{t})p(y|x_{t})},1 \} \\
					   &= min\{\frac{\tilde p(y)q(x_{t}|y)}{\tilde p(x_{t})p(y|x_{t})},1 \} 
\end{split}
\end{equation}</script> 可以发现接受率 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2701-Frame"> 
   
   <span class="math" id="MathJax-Span-45174" style="width: 0.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.643em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-45175"><span class="mi" id="MathJax-Span-45176" style="font-family: MathJax_Math-italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.67em; vertical-align: -0.063em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-2701">\alpha</script> 与归一化常数无关！</font> 
<p></p> 
<h2 id="例子"><strong>例子</strong></h2> 
<p>采用 MH算法生成服从Cauchy分布的样本。MH算法采样的过程如下所示：</p> 
<p>当前的状态为 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-74-Frame"> 
   
   <span class="math" id="MathJax-Span-770" style="width: 1.176em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.763em 1000em 2.669em -0.424em); top: -2.344em; left: 0.003em;"><span class="mrow" id="MathJax-Span-771"><span class="msubsup" id="MathJax-Span-772"><span style="display: inline-block; position: relative; width: 0.909em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-773" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-774"><span class="mrow" id="MathJax-Span-775"><span class="mi" id="MathJax-Span-776" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-74">x_{t}</script> <br> <img src="https://images2.imgbox.com/63/2a/cJ4gZpRE_o.png" alt="这里写图片描述" title=""></p> 
<p>利用建议分布（这里使用正态分布）进行采样得到 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-75-Frame"> 
   
   <span class="math" id="MathJax-Span-777" style="width: 0.643em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.976em 1000em 2.936em -0.477em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-778"><span class="mi" id="MathJax-Span-779" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.937em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-75">y</script> <br>
<img src="https://images2.imgbox.com/79/ac/7BiGo7aT_o.png" alt="这里写图片描述" title=""></p>

<p>若接受转移，则 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-76-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-780" style="width: 4.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.576em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(2.189em 1000em 3.149em -0.424em); top: -2.771em; left: 0.003em;"><span class="mrow" id="MathJax-Span-781"><span class="msubsup" id="MathJax-Span-782"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px;"><span style="position: absolute; clip: rect(1.976em 1000em 2.723em -0.424em); top: -2.557em; left: 0.003em;"><span class="mi" id="MathJax-Span-783" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.563em;"></span></span><span style="position: absolute; top: -2.291em; left: 0.589em;"><span class="texatom" id="MathJax-Span-784"><span class="mrow" id="MathJax-Span-785"><span class="mi" id="MathJax-Span-786" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-787" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-788" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-789" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mi" id="MathJax-Span-790" style="font-family: MathJax_Math-italic; padding-left: 0.269em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.776em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.937em; vertical-align: -0.33em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-76">x_{t+1}=y</script> <br> <img src="https://images2.imgbox.com/c6/69/HBsfUUne_o.png" alt="这里写图片描述" title=""></p> 
<p>matlab代码如下：</p> 
<pre class="prettyprint"><code class="language-matlab hljs "><span class="hljs-comment">%%M-H算法</span>
T = <span class="hljs-number">500</span>;  <span class="hljs-comment">%the maximum number of iterations</span>
sigma = <span class="hljs-number">1</span>;<span class="hljs-comment">%the deviation of normal proposal density</span>
x_min=-<span class="hljs-number">10</span>; x_max=<span class="hljs-number">10</span>   <span class="hljs-comment">%define a range for starting values</span>
x = <span class="hljs-built_in">zeros</span>(<span class="hljs-number">1</span>,T);<span class="hljs-comment">%init storage space for our samples</span>
seed=<span class="hljs-number">1</span>; <span class="hljs-built_in">rand</span>(<span class="hljs-string">'state'</span>,seed); <span class="hljs-built_in">randn</span>(<span class="hljs-string">'state'</span>,seed);    <span class="hljs-comment">%random seed</span>
x(<span class="hljs-number">1</span>) = unifrnd(x_min,x_max);

<span class="hljs-comment">%%Start sampling</span>
t=<span class="hljs-number">1</span>;
<span class="hljs-keyword">while</span> t&lt;T   <span class="hljs-comment">%Iterate until we have T samples</span>
    t=t+<span class="hljs-number">1</span>;
    <span class="hljs-comment">%propose a new value for theta using a normal proposal density</span>
    y = normrnd(x(t-<span class="hljs-number">1</span>),sigma);
    <span class="hljs-comment">%Calculate the acceptance ratio</span>
    alpha = min(<span class="hljs-matrix">[<span class="hljs-number">1</span>,(cauchy(y)*normpdf(x(t-<span class="hljs-number">1</span>),y,sigma))/(cauchy(x(t-<span class="hljs-number">1</span>))*normpdf(y,x(t-<span class="hljs-number">1</span>),sigma))]</span>);
    <span class="hljs-comment">%draw a uniform deviate from [0,1]</span>
    u=<span class="hljs-built_in">rand</span>;
    <span class="hljs-comment">%accept this proposal?</span>
    <span class="hljs-keyword">if</span> u&lt;alpha
        x(t)=y;
    <span class="hljs-keyword">else</span>
        x(t)=x(t-<span class="hljs-number">1</span>);
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-comment">%%  Display histogram of our samples</span>
figure(<span class="hljs-number">1</span>); clf;
subplot(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>);
nbins=<span class="hljs-number">200</span>;
thetabins = <span class="hljs-built_in">linspace</span>(x_min,x_max,nbins);
counts = hist(x,thetabins);
bar(thetabins,counts/sum(counts),<span class="hljs-string">'k'</span>);
xlim(<span class="hljs-matrix">[x_min x_max]</span>);
xlabel(<span class="hljs-string">'x'</span>); ylabel(<span class="hljs-string">'p(x)'</span>);

<span class="hljs-comment">%% Overlay the theoretical density</span>
y=cauchy(thetabins);
hold on;
plot(thetabins,y/sum(y),<span class="hljs-string">'r--'</span>,<span class="hljs-string">'LineWidth'</span>,<span class="hljs-number">3</span>);
set(gca,<span class="hljs-string">'YTick'</span>,<span class="hljs-matrix">[]</span>);

<span class="hljs-comment">%% Display history of our samples</span>
subplot(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>:<span class="hljs-number">3</span>);
stairs(x,<span class="hljs-number">1</span>:T,<span class="hljs-string">'k-'</span>);
ylabel(<span class="hljs-string">'t'</span>);xlabel(<span class="hljs-string">'x'</span>);
set(gca,<span class="hljs-string">'YDir'</span>,<span class="hljs-string">'reverse'</span>);
xlim(<span class="hljs-matrix">[x_min x_max]</span>);</code></pre> 
<p>实验结果： <br> <img src="https://images2.imgbox.com/44/1d/c6N8j3Oo_o.jpg" alt="这里写图片描述" title=""></p> 
<h2 id="参考文献"><strong>参考文献</strong></h2> 
<p><a href="https://www.cnblogs.com/xbinworld/p/4266146.html" rel="nofollow noopener noreferrer" target="_blank">随机采样方法整理与讲解（MCMC、Gibbs Sampling等</a> <br> <a href="http://blog.sciencenet.cn/blog-110554-768148.html" rel="nofollow noopener noreferrer" target="_blank">MCMC方法的理解 </a> <br> Computational Statistics with Matlab</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/006c9daac286d39050f6320237775d65/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">马尔可夫链</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8cf88476c8e99c72fb0424a4f761c295/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">double类型的最大值表示</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>