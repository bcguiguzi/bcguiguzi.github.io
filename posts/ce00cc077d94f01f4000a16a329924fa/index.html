<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SG ：一个简单的PHP语法糖扩展 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SG ：一个简单的PHP语法糖扩展" />
<meta property="og:description" content="奇技指南
语法糖往往给程序员提供了更实用的编码方式，可以使代码更简洁流畅，语义更自然。本文介绍笔者自己写的PHP语法糖扩展，扩展了一种全新的PHP超全局变量获取方式。
本文作者范家鹏，360技术委员会--WEB服务端分TC委员。
说说语法糖
首先说说“语法糖”这个词绝非贬义词，它可以给我们的开发工作带来便利，是一种轻量级便捷的写法，既不会对语言本身的使用造成不利影响，也不会在性能上带来损失。
通常情况下，使用语法糖能够增加程序的可读性，减少程序复杂性，减少编码中出错的机会，也对开发工程师具有友好性，能够提升我们的开发效率。 优秀的语法糖，应该是一种灵魂思想的注入，简单写法的应用。我这里用一幅图来表示：
什么是SG？
SG 全称 Superglobals，引用全局作用域中可用的全部变量。SG扩展了一种全新的PHP超全局变量获取方式。 这些超全局变量是：_SERVER，_GET，_POST，_FILES，_COOKIE，_SESSION，_REQUEST，_ENV。 当然了，也可以应用到自定义变量场景。
非常重要的一点是：它很简单！
项目背景
这个idea出发点很简单，从扩展名称我们应该能猜到它是做什么的。
在性能最优的前提下： 能通俗易懂地简化HTTP参数获取方法
需要对HTTP参数值进行统一过滤、转换、解密操作
获取HTTP参数前，需要进行一些Predefined Operation
针对HTTP参数的一切行为，需要同步更新对应的PHP Superglobal
声明时才使用，而非请求一开始就对PHP Superglobals扫荡式处理
在global语法上，扩展一项能获取HTTP参数的能力
So，SG出现就是为了解决上面这些问题而来，它提供了一种更加甜蜜的语法，当前已经发布了v3.0.0。
项目地址
https://github.com/yulonghu/sg 欢迎大家来提交Issues~
当前支持的PHP版本，如下图所示：
SG的特性
简单，快速，轻量 零拷贝访问PHP超全局变量，使用SG会同步更新PHP超全局变量 支持取值前调用自定义函数，默认情况下，字符串变量会自动调用 PHP trim 解决使用PHP超全局变量时出现未定义系列的问题 (Undefined variable, Undefinedoffset) 采用静态方法时，以小数点代替PHP数组维度 采用global声明方式时，以下划线代替PHP数组维度
支持可配置的global $variable查找深度，默认一级查找
配置项(php.ini)
Hash Map
流程图
global 声明方式（PHP7）
函数方式
API
global 声明方式
静态方法
例子
global 声明例子
sg.global_level = 1
以上例子输出的结果：
sg.global_level = 0
以上例子输出的结果：
sg.func_name
以上例子输出的结果：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/ce00cc077d94f01f4000a16a329924fa/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-06-04T19:00:09+08:00" />
<meta property="article:modified_time" content="2019-06-04T19:00:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SG ：一个简单的PHP语法糖扩展</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="rich_media_content" id="js_content"> 
 <p><strong>奇技指南</strong></p> 
 <p>语法糖往往给程序员提供了更实用的编码方式，可以使代码更简洁流畅，语义更自然。本文介绍笔者自己写的PHP语法糖扩展，扩展了一种全新的PHP超全局变量获取方式。</p> 
 <p>本文作者范家鹏，360技术委员会--WEB服务端分TC委员。</p> 
 <p><br></p> 
 <p><strong>说说语法糖</strong></p> 
 <p>首先说说“语法糖”这个词绝非贬义词，它可以给我们的开发工作带来便利，是一种轻量级便捷的写法，既不会对语言本身的使用造成不利影响，也不会在性能上带来损失。</p> 
 <p><br></p> 
 <p>通常情况下，使用语法糖能够增加程序的可读性，减少程序复杂性，减少编码中出错的机会，也对开发工程师具有友好性，能够提升我们的开发效率。 </p> 
 <p><br></p> 
 <p>优秀的语法糖，应该是一种灵魂思想的注入，简单写法的应用。我这里用一幅图来表示：</p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/28/57/LCYkFVJH_o.png" alt="640?wx_fmt=jpeg"> 
 <p><br></p> 
 <p><strong>什么是SG？</strong></p> 
 <p><strong>SG</strong> 全称 Superglobals，引用全局作用域中可用的全部变量。<strong>SG</strong>扩展了一种全新的PHP超全局变量获取方式。 </p> 
 <p><br></p> 
 <p>这些超全局变量是：_SERVER，_GET，_POST，_FILES，_COOKIE，_SESSION，_REQUEST，_ENV。 </p> 
 <p><br></p> 
 <p>当然了，也可以应用到自定义变量场景。</p> 
 <p><br></p> 
 <p>非常重要的一点是：<strong>它很简单</strong>！</p> 
 <p><strong>项目背景</strong></p> 
 <p>这个idea出发点很简单，从扩展名称我们应该能猜到它是做什么的。</p> 
 <p><br></p> 
 <p>在性能最优的前提下： </p> 
 <ul class="list-paddingleft-2"><li><p>能通俗易懂地简化HTTP参数获取方法</p></li><li><p>需要对HTTP参数值进行统一过滤、转换、解密操作</p></li><li><p>获取HTTP参数前，需要进行一些Predefined Operation</p></li><li><p>针对HTTP参数的一切行为，需要同步更新对应的PHP Superglobal</p></li><li><p>声明时才使用，而非请求一开始就对PHP Superglobals扫荡式处理</p></li><li><p>在global语法上，扩展一项能获取HTTP参数的能力</p></li></ul> 
 <p><br></p> 
 <p>So，<strong>SG</strong>出现就是为了解决上面这些问题而来，它提供了一种更加甜蜜的语法，当前已经发布了v3.0.0。</p> 
 <p><strong>项目地址</strong></p> 
 <p><span style="color:rgb(35,71,40);">https://github.com/yulonghu/sg </span></p> 
 <p><br></p> 
 <p>欢迎大家来提交Issues~</p> 
 <p>当前支持的PHP版本，如下图所示：</p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/52/91/uIogxSYS_o.png" alt="640?wx_fmt=png"> 
 <p><br></p> 
 <p><strong>SG的特性</strong></p> 
 <ul class="list-paddingleft-2"><li><p>简单，快速，轻量 </p></li><li><p>零拷贝访问PHP超全局变量，使用SG会同步更新PHP超全局变量 </p></li><li><p>支持取值前调用自定义函数，默认情况下，字符串变量会自动调用 PHP trim </p></li><li><p>解决使用PHP超全局变量时出现未定义系列的问题 (Undefined variable, Undefinedoffset) </p></li><li><p>采用静态方法时，以小数点代替PHP数组维度 </p></li><li><p>采用global声明方式时，以下划线代替PHP数组维度</p></li><li><p>支持可配置的global $variable查找深度，默认一级查找</p><p><br></p></li></ul> 
 <p><strong>配置项(php.ini)</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/6d/e1/eUWDOuNH_o.png" alt="640?wx_fmt=png"> 
 <p><br></p> 
 <p><strong>Hash Map</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/fd/8d/H2770eOK_o.png" alt="640?wx_fmt=png"> 
 <p><br></p> 
 <p><strong>流程图</strong></p> 
 <p><strong>global 声明方式（PHP7）</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/b0/fa/tgDBnaWF_o.png" alt="640?wx_fmt=png"> 
 <p><strong>函数方式</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/6a/ea/hRh0dylH_o.png" alt="640?wx_fmt=png"> 
 <p><br></p> 
 <p><strong>API</strong></p> 
 <p><strong>global 声明方式</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/a5/81/4fWwKzA2_o.png" alt="640?wx_fmt=png"> 
 <p><span style="font-size:16px;"><strong>静态方法</strong></span></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/02/e3/p9AtZeEH_o.png" alt="640?wx_fmt=png"> 
 <p><br></p> 
 <p><strong>例子</strong></p> 
 <p><strong>global 声明例子</strong></p> 
 <span style="width:0px;border-left:.6em solid rgb(96,173,94);border-top:.5em solid transparent;border-bottom:.5em solid transparent;"> </span> 
 <span style="width:0px;border-left:.6em solid rgb(96,173,94);border-top:.5em solid transparent;border-bottom:.5em solid transparent;"> </span> 
 <p><strong>sg.global_level = 1</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/35/18/Pxshe5oq_o.png" alt="640?wx_fmt=png"> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/bb/ea/n23IM2mN_o.png" alt="640?wx_fmt=png"> 
 <p>以上例子输出的结果：</p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/6c/c2/cwOsmO1K_o.png" alt="640?wx_fmt=png"> 
 <span style="width:0px;border-left:.6em solid rgb(96,173,94);border-top:.5em solid transparent;border-bottom:.5em solid transparent;"> </span> 
 <span style="width:0px;border-left:.6em solid rgb(96,173,94);border-top:.5em solid transparent;border-bottom:.5em solid transparent;"> </span> 
 <p><strong>sg.global_level = 0</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/25/06/SDqcj28y_o.png" alt="640?wx_fmt=png"> 
 <p>以上例子输出的结果：</p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/b5/cb/ikgvpA0B_o.png" alt="640?wx_fmt=png"> 
 <span style="width:0px;border-left:.6em solid rgb(96,173,94);border-top:.5em solid transparent;border-bottom:.5em solid transparent;"> </span> 
 <span style="width:0px;border-left:.6em solid rgb(96,173,94);border-top:.5em solid transparent;border-bottom:.5em solid transparent;"> </span> 
 <p><strong>sg.func_name</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/af/29/JPbYT20j_o.png" alt="640?wx_fmt=png"> 
 <p>以上例子输出的结果：</p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/7b/4f/m3uOZ6kt_o.png" alt="640?wx_fmt=png"> 
 <p><br></p> 
 <p><strong>静态方法例子</strong></p> 
 <span style="width:0px;border-left:.6em solid rgb(96,173,94);border-top:.5em solid transparent;border-bottom:.5em solid transparent;"> </span> 
 <span style="width:0px;border-left:.6em solid rgb(96,173,94);border-top:.5em solid transparent;border-bottom:.5em solid transparent;"> </span> 
 <p><strong>get/set/has/del()</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/5b/4e/KURcE7UA_o.png" alt="640?wx_fmt=png"> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/0f/80/tCMSWccv_o.png" alt="640?wx_fmt=png"> 
 <p>以上例子输出的结果：</p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/87/fd/1tQ1pCvf_o.png" alt="640?wx_fmt=png"> 
 <span style="width:0px;border-left:.6em solid rgb(96,173,94);border-top:.5em solid transparent;border-bottom:.5em solid transparent;"> </span> 
 <span style="width:0px;border-left:.6em solid rgb(96,173,94);border-top:.5em solid transparent;border-bottom:.5em solid transparent;"> </span> 
 <p><strong>sg.func_name</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/ad/fe/XajXUHYR_o.png" alt="640?wx_fmt=png"> 
 <p>以上例子输出的结果：</p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/aa/11/wuY2nu3I_o.png" alt="640?wx_fmt=png"> 
 <p><br></p> 
 <p><strong>性能测试</strong></p> 
 <p>噼里啪啦说了大半天，性能到底怎么样呢？我在本地环境做了一个简单的ab测试（ab -c100 -n10000），PHP测试代码如下：</p> 
 <p><strong>default - 源码</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/ba/9c/Q90nWd4u_o.png" alt="640?wx_fmt=png"> 
 <p><strong>global 声明方式 - 源码</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/eb/ae/aHdj3ksj_o.png" alt="640?wx_fmt=png"> 
 <p><strong>default - 结果</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/ad/82/xsKCQU3J_o.png" alt="640?wx_fmt=png"> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/31/91/yze3Bd6M_o.png" alt="640?wx_fmt=png"> 
 <p><strong>global 声明方式 - 结果</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/99/c4/YwZuCDsD_o.png" alt="640?wx_fmt=png"> 
 <p><br></p> 
 <p><strong> 总  结 </strong></p> 
 <p><strong>SG</strong>具有以下优势：</p> 
 <ul class="list-paddingleft-2"><li><p>兼容了当前的主流PHP版本 </p></li><li><p>提供了一种更加甜蜜的语法，丰富了Superglobals的应用</p></li><li><p>我们始终相信：简单才是王道</p></li></ul> 
 <p><br></p> 
 <p>注意：global 声明方式，当前只支持不可变变量名。</p> 
 <p><br></p> 
 <p style="text-align:center;"><img class="rich_pages" style="width:218px;" src="https://images2.imgbox.com/08/52/lEb6t9IV_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:center;"><span style="font-size:15px;">喜欢记得关注鸭~</span></p> 
 <p style="text-align:center;"><span style="font-size:15px;"><br></span></p> 
 <p>界世的你当不<br></p> 
 <p>只做你的肩膀</p> 
 <p>无</p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/86/f4/iVyV3cPV_o.png" alt="640?wx_fmt=jpeg"> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/90/ca/tjbDOopa_o.png" alt="640?wx_fmt=jpeg"> 
 <p> 360官方技术公众号 </p> 
 <p>技术干货|一手资讯|精彩活动</p> 
 <p>空·</p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/08/8d/2w47c4mT_o.gif" alt="640?wx_fmt=gif"> 
 <p><strong>点击“阅读原文”查看项目详情</strong></p> 
 <p><strong>右边给我一朵小花花</strong></p> 
 <img class="raw-image" style="vertical-align:middle;" src="https://images2.imgbox.com/8b/43/p7yfdlr3_o.gif" alt="640?wx_fmt=gif"> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/034690a8ae78d47dd7dd9becebf2230a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">职业发展能力图谱</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fd4bda1bd05999f5d70701044db1c4c9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">django form表单渲染和验证</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>