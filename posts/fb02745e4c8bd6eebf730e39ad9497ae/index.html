<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PostgreSQL基本操作 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PostgreSQL基本操作" />
<meta property="og:description" content="目录
1.源码安装PostgreSQL
1.1.前置条件（root下操作）
1.1.1.卸载yum安装的postgresql
1.1.2.创建postgres用户
1.1.3.安装部分依赖
1.1.4.源码安装uuid
1.2.安装PostgreSQL
1.2.1.使用postgres用户管理PostgreSQL
1.2.2.下载解压postgres12源码包
1.2.3.编译及安装
1.2.4.安装contrib工具
1.2.5.配置环境变量
1.2.6.初始化postgreSQL 1.3.PostgreSQL服务基本管理
1.3.1启动数据库
1.3.2停止数据库
1.3.3 重启数据库
1.3.4 查看数据库状态
2.psql基本使用
2.1.登录PostgreSQL数据库
2.2.断开psql客户端
2.3.&#34;?&#34;查询PostgreSQL支持的所有命令
2.4.&#34;\l&#34;查看所有数据库
2.5.&#34;\c&#34;切换数据库
2.6.&#34;\d&#34;看当前数据库中所有表、视图、序列
2.7.&#34;\d tablename&#34;查看该表的表定义
2.8.&#34;\db&#34;查看表空间的信息
2.9.&#34;\dn&#34;查看所有的模式信息
2.10.&#34;\du&#34;或”\dg&#34;查看数据库中的所有角色或用户
2.11.&#34;\dt&#43; tablename&#34;查看表大小
2.12.&#34;\di&#43;&#34;查看索引大小
2.13.&#34;\h 命令&#34;查看SQL命令语法
2.14.&#34;\timing&#34;显示SQL语句执行时间
2.15.“\x”可以把按行展示的数据变成按列展示
2.16.自动提交功能
2.17.查看数据库版本
1.源码安装PostgreSQL 1.1.前置条件（root下操作） 1.1.1.卸载yum安装的postgresql #检查是否已经通过rpm安装postgresql数据库
rpm -qa|grep postgresql
# 卸载 包含postgresql名的程序包
yum remove postgresql*
# 删除postgres用户及其对应的用户目录（/home/postgres）
userdel -r postgres
# 检查是否存在 /usr/psqlXXX文件夹，有的话删除，例如
rm -rf /usr/pgsql-12
1.1.2.创建postgres用户 # 创建postgres用户" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/fb02745e4c8bd6eebf730e39ad9497ae/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-14T16:55:20+08:00" />
<meta property="article:modified_time" content="2023-11-14T16:55:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PostgreSQL基本操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1.%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85PostgreSQL-toc" style="margin-left:0px;"><a href="#1.%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85PostgreSQL" rel="nofollow">1.源码安装PostgreSQL</a></p> 
<p id="1.1.%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6%EF%BC%88root%E4%B8%8B%E6%93%8D%E4%BD%9C%EF%BC%89-toc" style="margin-left:40px;"><a href="#1.1.%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6%EF%BC%88root%E4%B8%8B%E6%93%8D%E4%BD%9C%EF%BC%89" rel="nofollow">1.1.前置条件（root下操作）</a></p> 
<p id="1.1.1.%E5%8D%B8%E8%BD%BDyum%E5%AE%89%E8%A3%85%E7%9A%84postgresql-toc" style="margin-left:80px;"><a href="#1.1.1.%E5%8D%B8%E8%BD%BDyum%E5%AE%89%E8%A3%85%E7%9A%84postgresql" rel="nofollow">1.1.1.卸载yum安装的postgresql</a></p> 
<p id="1.1.2.%E5%88%9B%E5%BB%BApostgres%E7%94%A8%E6%88%B7-toc" style="margin-left:80px;"><a href="#1.1.2.%E5%88%9B%E5%BB%BApostgres%E7%94%A8%E6%88%B7" rel="nofollow">1.1.2.创建postgres用户</a></p> 
<p id="1.1.3.%E5%AE%89%E8%A3%85%E9%83%A8%E5%88%86%E4%BE%9D%E8%B5%96-toc" style="margin-left:80px;"><a href="#1.1.3.%E5%AE%89%E8%A3%85%E9%83%A8%E5%88%86%E4%BE%9D%E8%B5%96" rel="nofollow">1.1.3.安装部分依赖</a></p> 
<p id="1.1.4.%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85uuid-toc" style="margin-left:80px;"><a href="#1.1.4.%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85uuid" rel="nofollow">1.1.4.源码安装uuid</a></p> 
<p id="1.2.%E5%AE%89%E8%A3%85PostgreSQL-toc" style="margin-left:40px;"><a href="#1.2.%E5%AE%89%E8%A3%85PostgreSQL" rel="nofollow">1.2.安装PostgreSQL</a></p> 
<p id="1.2.1.%E4%BD%BF%E7%94%A8postgres%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86PostgreSQL-toc" style="margin-left:80px;"><a href="#1.2.1.%E4%BD%BF%E7%94%A8postgres%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86PostgreSQL" rel="nofollow">1.2.1.使用postgres用户管理PostgreSQL</a></p> 
<p id="1.2.2.%E4%B8%8B%E8%BD%BD%E8%A7%A3%E5%8E%8Bpostgres12%E6%BA%90%E7%A0%81%E5%8C%85-toc" style="margin-left:80px;"><a href="#1.2.2.%E4%B8%8B%E8%BD%BD%E8%A7%A3%E5%8E%8Bpostgres12%E6%BA%90%E7%A0%81%E5%8C%85" rel="nofollow">1.2.2.下载解压postgres12源码包</a></p> 
<p id="1.2.3.%E7%BC%96%E8%AF%91%E5%8F%8A%E5%AE%89%E8%A3%85-toc" style="margin-left:80px;"><a href="#1.2.3.%E7%BC%96%E8%AF%91%E5%8F%8A%E5%AE%89%E8%A3%85" rel="nofollow">1.2.3.编译及安装</a></p> 
<p id="1.2.4.%E5%AE%89%E8%A3%85contrib%E5%B7%A5%E5%85%B7-toc" style="margin-left:80px;"><a href="#1.2.4.%E5%AE%89%E8%A3%85contrib%E5%B7%A5%E5%85%B7" rel="nofollow">1.2.4.安装contrib工具</a></p> 
<p id="1.2.5.%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F-toc" style="margin-left:80px;"><a href="#1.2.5.%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F" rel="nofollow">1.2.5.配置环境变量</a></p> 
<p id="1.2.6.%E5%88%9D%E5%A7%8B%E5%8C%96postgreSQL%C2%A0-toc" style="margin-left:80px;"><a href="#1.2.6.%E5%88%9D%E5%A7%8B%E5%8C%96postgreSQL%C2%A0" rel="nofollow">1.2.6.初始化postgreSQL </a></p> 
<p id="1.3.PostgreSQL%E6%9C%8D%E5%8A%A1%E5%9F%BA%E6%9C%AC%E7%AE%A1%E7%90%86-toc" style="margin-left:40px;"><a href="#1.3.PostgreSQL%E6%9C%8D%E5%8A%A1%E5%9F%BA%E6%9C%AC%E7%AE%A1%E7%90%86" rel="nofollow">1.3.PostgreSQL服务基本管理</a></p> 
<p id="1.3.1%E5%90%AF%E5%8A%A8%E6%95%B0%E6%8D%AE%E5%BA%93-toc" style="margin-left:80px;"><a href="#1.3.1%E5%90%AF%E5%8A%A8%E6%95%B0%E6%8D%AE%E5%BA%93" rel="nofollow">1.3.1启动数据库</a></p> 
<p id="1.3.2%E5%81%9C%E6%AD%A2%E6%95%B0%E6%8D%AE%E5%BA%93-toc" style="margin-left:80px;"><a href="#1.3.2%E5%81%9C%E6%AD%A2%E6%95%B0%E6%8D%AE%E5%BA%93" rel="nofollow">1.3.2停止数据库</a></p> 
<p id="1.3.3%20%E9%87%8D%E5%90%AF%E6%95%B0%E6%8D%AE%E5%BA%93-toc" style="margin-left:80px;"><a href="#1.3.3%20%E9%87%8D%E5%90%AF%E6%95%B0%E6%8D%AE%E5%BA%93" rel="nofollow">1.3.3 重启数据库</a></p> 
<p id="1.3.4%20%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%8A%B6%E6%80%81-toc" style="margin-left:80px;"><a href="#1.3.4%20%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%8A%B6%E6%80%81" rel="nofollow">1.3.4 查看数据库状态</a></p> 
<p id="2.psql%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8-toc" style="margin-left:0px;"><a href="#2.psql%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8" rel="nofollow">2.psql基本使用</a></p> 
<p id="2.1.%E7%99%BB%E5%BD%95PostgreSQL%E6%95%B0%E6%8D%AE%E5%BA%93-toc" style="margin-left:40px;"><a href="#2.1.%E7%99%BB%E5%BD%95PostgreSQL%E6%95%B0%E6%8D%AE%E5%BA%93" rel="nofollow">2.1.登录PostgreSQL数据库</a></p> 
<p id="2.2.%E6%96%AD%E5%BC%80psql%E5%AE%A2%E6%88%B7%E7%AB%AF-toc" style="margin-left:40px;"><a href="#2.2.%E6%96%AD%E5%BC%80psql%E5%AE%A2%E6%88%B7%E7%AB%AF" rel="nofollow">2.2.断开psql客户端</a></p> 
<p id="2.3.%22%3F%22%E6%9F%A5%E8%AF%A2PostgreSQL%E6%94%AF%E6%8C%81%E7%9A%84%E6%89%80%E6%9C%89%E5%91%BD%E4%BB%A4-toc" style="margin-left:40px;"><a href="#2.3.%22%3F%22%E6%9F%A5%E8%AF%A2PostgreSQL%E6%94%AF%E6%8C%81%E7%9A%84%E6%89%80%E6%9C%89%E5%91%BD%E4%BB%A4" rel="nofollow">2.3."?"查询PostgreSQL支持的所有命令</a></p> 
<p id="2.4.%22%5Cl%22%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE%E5%BA%93-toc" style="margin-left:40px;"><a href="#2.4.%22%5Cl%22%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE%E5%BA%93" rel="nofollow">2.4."\l"查看所有数据库</a></p> 
<p id="2.5.%22%5Cc%22%E5%88%87%E6%8D%A2%E6%95%B0%E6%8D%AE%E5%BA%93-toc" style="margin-left:40px;"><a href="#2.5.%22%5Cc%22%E5%88%87%E6%8D%A2%E6%95%B0%E6%8D%AE%E5%BA%93" rel="nofollow">2.5."\c"切换数据库</a></p> 
<p id="2.6.%22%5Cd%22%E7%9C%8B%E5%BD%93%E5%89%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E6%89%80%E6%9C%89%E8%A1%A8%E3%80%81%E8%A7%86%E5%9B%BE%E3%80%81%E5%BA%8F%E5%88%97-toc" style="margin-left:40px;"><a href="#2.6.%22%5Cd%22%E7%9C%8B%E5%BD%93%E5%89%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E6%89%80%E6%9C%89%E8%A1%A8%E3%80%81%E8%A7%86%E5%9B%BE%E3%80%81%E5%BA%8F%E5%88%97" rel="nofollow">2.6."\d"看当前数据库中所有表、视图、序列</a></p> 
<p id="2.7.%22%5Cd%20tablename%22%E6%9F%A5%E7%9C%8B%E8%AF%A5%E8%A1%A8%E7%9A%84%E8%A1%A8%E5%AE%9A%E4%B9%89-toc" style="margin-left:40px;"><a href="#2.7.%22%5Cd%20tablename%22%E6%9F%A5%E7%9C%8B%E8%AF%A5%E8%A1%A8%E7%9A%84%E8%A1%A8%E5%AE%9A%E4%B9%89" rel="nofollow">2.7."\d tablename"查看该表的表定义</a></p> 
<p id="2.8.%22%5Cdb%22%E6%9F%A5%E7%9C%8B%E8%A1%A8%E7%A9%BA%E9%97%B4%E7%9A%84%E4%BF%A1%E6%81%AF-toc" style="margin-left:40px;"><a href="#2.8.%22%5Cdb%22%E6%9F%A5%E7%9C%8B%E8%A1%A8%E7%A9%BA%E9%97%B4%E7%9A%84%E4%BF%A1%E6%81%AF" rel="nofollow">2.8."\db"查看表空间的信息</a></p> 
<p id="2.9.%22%5Cdn%22%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E7%9A%84%E6%A8%A1%E5%BC%8F%E4%BF%A1%E6%81%AF-toc" style="margin-left:40px;"><a href="#2.9.%22%5Cdn%22%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E7%9A%84%E6%A8%A1%E5%BC%8F%E4%BF%A1%E6%81%AF" rel="nofollow">2.9."\dn"查看所有的模式信息</a></p> 
<p id="2.10.%22%5Cdu%22%E6%88%96%E2%80%9D%5Cdg%22%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E8%A7%92%E8%89%B2%E6%88%96%E7%94%A8%E6%88%B7-toc" style="margin-left:40px;"><a href="#2.10.%22%5Cdu%22%E6%88%96%E2%80%9D%5Cdg%22%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E8%A7%92%E8%89%B2%E6%88%96%E7%94%A8%E6%88%B7" rel="nofollow">2.10."\du"或”\dg"查看数据库中的所有角色或用户</a></p> 
<p id="2.11.%22%5Cdt%2B%20tablename%22%E6%9F%A5%E7%9C%8B%E8%A1%A8%E5%A4%A7%E5%B0%8F-toc" style="margin-left:40px;"><a href="#2.11.%22%5Cdt%2B%20tablename%22%E6%9F%A5%E7%9C%8B%E8%A1%A8%E5%A4%A7%E5%B0%8F" rel="nofollow">2.11."\dt+ tablename"查看表大小</a></p> 
<p id="2.12.%22%5Cdi%2B%22%E6%9F%A5%E7%9C%8B%E7%B4%A2%E5%BC%95%E5%A4%A7%E5%B0%8F-toc" style="margin-left:40px;"><a href="#2.12.%22%5Cdi%2B%22%E6%9F%A5%E7%9C%8B%E7%B4%A2%E5%BC%95%E5%A4%A7%E5%B0%8F" rel="nofollow">2.12."\di+"查看索引大小</a></p> 
<p id="2.13.%22%5Ch%20%E5%91%BD%E4%BB%A4%22%E6%9F%A5%E7%9C%8BSQL%E5%91%BD%E4%BB%A4%E8%AF%AD%E6%B3%95-toc" style="margin-left:40px;"><a href="#2.13.%22%5Ch%20%E5%91%BD%E4%BB%A4%22%E6%9F%A5%E7%9C%8BSQL%E5%91%BD%E4%BB%A4%E8%AF%AD%E6%B3%95" rel="nofollow">2.13."\h 命令"查看SQL命令语法</a></p> 
<p id="2.14.%22%5Ctiming%22%E6%98%BE%E7%A4%BASQL%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4-toc" style="margin-left:40px;"><a href="#2.14.%22%5Ctiming%22%E6%98%BE%E7%A4%BASQL%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4" rel="nofollow">2.14."\timing"显示SQL语句执行时间</a></p> 
<p id="2.15.%E2%80%9C%5Cx%E2%80%9D%E5%8F%AF%E4%BB%A5%E6%8A%8A%E6%8C%89%E8%A1%8C%E5%B1%95%E7%A4%BA%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8F%98%E6%88%90%E6%8C%89%E5%88%97%E5%B1%95%E7%A4%BA-toc" style="margin-left:40px;"><a href="#2.15.%E2%80%9C%5Cx%E2%80%9D%E5%8F%AF%E4%BB%A5%E6%8A%8A%E6%8C%89%E8%A1%8C%E5%B1%95%E7%A4%BA%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8F%98%E6%88%90%E6%8C%89%E5%88%97%E5%B1%95%E7%A4%BA" rel="nofollow">2.15.“\x”可以把按行展示的数据变成按列展示</a></p> 
<p id="2.16.%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4%E5%8A%9F%E8%83%BD-toc" style="margin-left:40px;"><a href="#2.16.%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4%E5%8A%9F%E8%83%BD" rel="nofollow">2.16.自动提交功能</a></p> 
<p id="2.17.%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%89%88%E6%9C%AC-toc" style="margin-left:40px;"><a href="#2.17.%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%89%88%E6%9C%AC" rel="nofollow">2.17.查看数据库版本</a></p> 
<hr id="hr-toc"> 
<h2>1.源码安装PostgreSQL</h2> 
<h3 id="1.1.%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6%EF%BC%88root%E4%B8%8B%E6%93%8D%E4%BD%9C%EF%BC%89">1.1.前置条件（root下操作）</h3> 
<h4 id="1.1.1.%E5%8D%B8%E8%BD%BDyum%E5%AE%89%E8%A3%85%E7%9A%84postgresql">1.1.1.卸载yum安装的postgresql</h4> 
<blockquote> 
 <p>#检查是否已经通过rpm安装postgresql数据库<br> rpm -qa|grep postgresql<br> # 卸载 包含postgresql名的程序包<br> yum remove postgresql*<br> # 删除postgres用户及其对应的用户目录（/home/postgres）<br> userdel -r postgres<br> # 检查是否存在 /usr/psqlXXX文件夹，有的话删除，例如<br> rm -rf /usr/pgsql-12</p> 
</blockquote> 
<h4 id="1.1.2.%E5%88%9B%E5%BB%BApostgres%E7%94%A8%E6%88%B7">1.1.2.创建postgres用户</h4> 
<blockquote> 
 <p># 创建postgres用户<br> useradd postgres<br> # 为postgres用户设置密码<br> passwd postgres    </p> 
</blockquote> 
<h4 id="1.1.3.%E5%AE%89%E8%A3%85%E9%83%A8%E5%88%86%E4%BE%9D%E8%B5%96">1.1.3.安装部分依赖</h4> 
<blockquote> 
 <p>yum install -y perl-ExtUtils-Embed python-devel bison flex readline-devel zlib-devel gcc gcc-c++ wget</p> 
</blockquote> 
<h4 id="1.1.4.%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85uuid">1.1.4.源码安装uuid</h4> 
<blockquote> 
 <p> wget ftp://ftp.ossp.org/pkg/lib/uuid/uuid-1.6.2.tar.gz<br>  tar -zxvf uuid-1.6.2.tar.gz<br>  cd uuid-1.6.2<br>  ./configure  <br>  make &amp;&amp; make install</p> 
</blockquote> 
<h3 id="1.2.%E5%AE%89%E8%A3%85PostgreSQL">1.2.安装PostgreSQL</h3> 
<h4 id="1.2.1.%E4%BD%BF%E7%94%A8postgres%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86PostgreSQL">1.2.1.使用postgres用户管理PostgreSQL</h4> 
<blockquote> 
 <p># 切换用户<br> su postgres<br> # 回到用户目录<br> cd ~</p> 
</blockquote> 
<h4 id="1.2.2.%E4%B8%8B%E8%BD%BD%E8%A7%A3%E5%8E%8Bpostgres12%E6%BA%90%E7%A0%81%E5%8C%85">1.2.2.下载解压postgres12源码包</h4> 
<blockquote> 
 <p>tar -zxvf postgresql-12.13.tar.gz</p> 
</blockquote> 
<h4 id="1.2.3.%E7%BC%96%E8%AF%91%E5%8F%8A%E5%AE%89%E8%A3%85">1.2.3.编译及安装</h4> 
<blockquote> 
 <p># 新建PostgreSQL安装路径下的文件夹(/data/opt/postgresql)<br> mkdir postgresql<br> # 进入解压后的源码文件夹(/home/postgres/postgresql-12.13)<br> cd postgresql-12.3<br> # 检查、并配置(--prefix=/data/opt/postgresql 为配置postgreSQL的安装路径)<br> ./configure --prefix=/data/opt/postgresql --with-blocksize=32 --with-wal-blocksize=32 --with-wal-segsize=64<br> -–prefix 指定安装目录。<br> --with-perl <br> --with-python <br> --enable-thread-safety <br> --with-uuid=ossp<br> -–with-blocksize 以KB为单位设置block size。此为表中存储及I/O的单位。默认为8kb。值必须为2的1到32次方（kb），可选。<br> -–with-wal-blocksize 以kb为单位，设置WAL block size。此为WAL日志中存储及I/O的单位。默认为8kb。值必须为2的1到64次方（kb），可选。<br> -–with-wal-segsize 设置WAL段大小，以兆字节为单位。这是WAL日志中每个文件的大小。默认大小为16兆字节。该值必须是1到64（兆字节）之间的2的幂，可选。<br> 注意：数据块、WAL日志块的大小需要在编译的时候配置才生效，对应此时编译出来的PostgreSQL程序创建的PostgreSQL数据库，不能使用其他块大小的PostgreSQL程序启动!!!<br> # 编译及安装<br> make &amp;&amp; make install</p> 
</blockquote> 
<h4 id="1.2.4.%E5%AE%89%E8%A3%85contrib%E5%B7%A5%E5%85%B7">1.2.4.安装contrib工具</h4> 
<blockquote> 
 <p>cd postgresql-12.3/contrib<br> make &amp;&amp; make install</p> 
</blockquote> 
<h4 id="1.2.5.%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">1.2.5.配置环境变量</h4> 
<blockquote> 
 <p> # 切换到用户根目录下(/home/postgres)<br> cd ~<br> # 编辑 .bash_profile<br> vi .bash_profile<br> # 修改为<br> # 新增 <br> PGHOME=/data/opt/postgresql<br> PGDATA=/data/pgdata<br> PATH后追加 $PGHOME/bin<br> 例如：PATH=$PATH:$PGHOME/bin<br> # 保存，退出（命令模式下Esc）<br> # 输入： wq!  Enter(回车)<br> # 重载.bash_profile<br> source .bash_profile</p> 
</blockquote> 
<h4 id="1.2.6.%E5%88%9D%E5%A7%8B%E5%8C%96postgreSQL%C2%A0">1.2.6.初始化postgreSQL </h4> 
<blockquote> 
 <p># /data/pgdata为postgres数据文件的存放路径,如果环境变量已经配置PGDATA=/data/pgdata，则 -D /data/pgdata 参数可不加<br> initdb -D /data/pgdata</p> 
</blockquote> 
<p><img alt="" height="346" src="https://images2.imgbox.com/4a/0c/NE6KEqTU_o.png" width="691"></p> 
<h3 id="1.3.PostgreSQL%E6%9C%8D%E5%8A%A1%E5%9F%BA%E6%9C%AC%E7%AE%A1%E7%90%86">1.3.PostgreSQL服务基本管理</h3> 
<h4 id="1.3.1%E5%90%AF%E5%8A%A8%E6%95%B0%E6%8D%AE%E5%BA%93">1.3.1启动数据库</h4> 
<p>        # /data/pgdata为postgres数据文件的存放路径，里面也有一些配置文件,如果环境变量已经配置PGDATA=/data/pgdata，则 -D /data/pgdata 参数可不加<br> 启动：pg_ctl -D /data/pgdata -l logfile start</p> 
<p><img alt="" height="198" src="https://images2.imgbox.com/cf/b4/8QIUlKjn_o.png" width="692"></p> 
<h4 id="1.3.2%E5%81%9C%E6%AD%A2%E6%95%B0%E6%8D%AE%E5%BA%93">1.3.2停止数据库</h4> 
<p>停止：pg_ctl -D /data/pgdata -l logfile stop [-m smart]<br> -m 用于指定数据库停止方式：<br> smart: smart模式等待所有客户端断开连接以及任何在线备份结束。如果该服务器是热备，一旦所有的客户端已经断开连接，恢复和流复制将被终止。<br> fast: fast模式（默认）不会等待客户端断开连接并且将终止进行中的在线备份。所有活动事务都被回滚并且客户端被强制断开连接，然后服务器被关闭。<br> immediate: immediate模式将立刻中止所有服务器进程，而不是做一次干净的关闭。这将导致下一次重启时进行一次崩溃恢复。</p> 
<h4 id="1.3.3%20%E9%87%8D%E5%90%AF%E6%95%B0%E6%8D%AE%E5%BA%93">1.3.3 重启数据库</h4> 
<p>重启：pg_ctl -D /data/pgdata -l logfile restart</p> 
<h4 id="1.3.4%20%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%8A%B6%E6%80%81">1.3.4 查看数据库状态</h4> 
<p>查看状态：pg_ctl -D /data/pgdata -l logfile status</p> 
<p><img alt="" height="125" src="https://images2.imgbox.com/a1/dc/Gy2dwOFP_o.png" width="692"></p> 
<h2 id="2.psql%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8" style="background-color:transparent;">2.psql基本使用</h2> 
<p>        psql是PostgreSQL的一个命令行交互式客户端工具，它具有非常丰富的功能，类似于Oracle的命令行工具sqlplus。</p> 
<h3 id="2.1.%E7%99%BB%E5%BD%95PostgreSQL%E6%95%B0%E6%8D%AE%E5%BA%93">2.1.登录PostgreSQL数据库</h3> 
<p>使用psql命令登录数据库，格式：psql -h 127.0.0.1 -p 5432 -U postgres -d postgres<br> -h后面的IP地址（192.168.1.210）是数据库所在的IP地址<br> -p后面的端口（5432）是数据库的监听端口<br> -U后面的参数（postgres）是创建的用户名<br> -d后面的参数（postgres）是创建的数据库名称</p> 
<p><img alt="" height="152" src="https://images2.imgbox.com/21/c4/ivuruFWX_o.png" width="692"></p> 
<h3 id="2.2.%E6%96%AD%E5%BC%80psql%E5%AE%A2%E6%88%B7%E7%AB%AF" style="background-color:transparent;">2.2.断开psql客户端</h3> 
<p>按Ctrl+D组合键 或输入命令：\q</p> 
<p><img alt="" height="158" src="https://images2.imgbox.com/ff/37/tBEJuFoZ_o.png" width="692"></p> 
<h3 id="2.3.%22%3F%22%E6%9F%A5%E8%AF%A2PostgreSQL%E6%94%AF%E6%8C%81%E7%9A%84%E6%89%80%E6%9C%89%E5%91%BD%E4%BB%A4">2.3."?"查询PostgreSQL支持的所有命令</h3> 
<p><img alt="" height="295" src="https://images2.imgbox.com/5a/77/w9GviwPR_o.png" width="691"></p> 
<h3 id="2.4.%22%5Cl%22%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE%E5%BA%93">2.4."\l"查看所有数据库</h3> 
<p><img alt="" height="185" src="https://images2.imgbox.com/3a/05/clXuF9Qs_o.png" width="692"></p> 
<h3 id="2.5.%22%5Cc%22%E5%88%87%E6%8D%A2%E6%95%B0%E6%8D%AE%E5%BA%93">2.5."\c"切换数据库</h3> 
<p><img alt="" height="235" src="https://images2.imgbox.com/82/35/A5QjV1Sj_o.png" width="692"></p> 
<h3 id="2.6.%22%5Cd%22%E7%9C%8B%E5%BD%93%E5%89%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E6%89%80%E6%9C%89%E8%A1%A8%E3%80%81%E8%A7%86%E5%9B%BE%E3%80%81%E5%BA%8F%E5%88%97">2.6."\d"看当前数据库中所有表、视图、序列</h3> 
<p><img alt="" height="275" src="https://images2.imgbox.com/19/e4/k88WLclJ_o.png" width="692"></p> 
<h3 id="2.7.%22%5Cd%20tablename%22%E6%9F%A5%E7%9C%8B%E8%AF%A5%E8%A1%A8%E7%9A%84%E8%A1%A8%E5%AE%9A%E4%B9%89">2.7."\d tablename"查看该表的表定义</h3> 
<p><img alt="" height="143" src="https://images2.imgbox.com/1b/67/TwzOCJet_o.png" width="691"></p> 
<h3 id="2.8.%22%5Cdb%22%E6%9F%A5%E7%9C%8B%E8%A1%A8%E7%A9%BA%E9%97%B4%E7%9A%84%E4%BF%A1%E6%81%AF">2.8."\db"查看表空间的信息</h3> 
<p><img alt="" height="140" src="https://images2.imgbox.com/13/ae/6sich39n_o.png" width="692"></p> 
<h3 id="2.9.%22%5Cdn%22%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E7%9A%84%E6%A8%A1%E5%BC%8F%E4%BF%A1%E6%81%AF">2.9."\dn"查看所有的模式信息</h3> 
<p><img alt="" height="114" src="https://images2.imgbox.com/d5/55/KAdGCcex_o.png" width="692"></p> 
<h3 id="2.10.%22%5Cdu%22%E6%88%96%E2%80%9D%5Cdg%22%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E8%A7%92%E8%89%B2%E6%88%96%E7%94%A8%E6%88%B7">2.10."\du"或”\dg"查看数据库中的所有角色或用户</h3> 
<p><img alt="" height="158" src="https://images2.imgbox.com/b6/81/ghLKUPYj_o.png" width="692"></p> 
<h3 id="2.11.%22%5Cdt%2B%20tablename%22%E6%9F%A5%E7%9C%8B%E8%A1%A8%E5%A4%A7%E5%B0%8F">2.11."\dt+ tablename"查看表大小</h3> 
<p><img alt="" height="136" src="https://images2.imgbox.com/1d/7d/hEGMFJLl_o.png" width="692"></p> 
<h3 id="2.12.%22%5Cdi%2B%22%E6%9F%A5%E7%9C%8B%E7%B4%A2%E5%BC%95%E5%A4%A7%E5%B0%8F">2.12."\di+"查看索引大小</h3> 
<p><img alt="" height="189" src="https://images2.imgbox.com/9c/dd/as2CGPYE_o.png" width="692"></p> 
<h3 id="2.13.%22%5Ch%20%E5%91%BD%E4%BB%A4%22%E6%9F%A5%E7%9C%8BSQL%E5%91%BD%E4%BB%A4%E8%AF%AD%E6%B3%95">2.13."\h 命令"查看SQL命令语法</h3> 
<p><img alt="" height="233" src="https://images2.imgbox.com/2c/54/rN1XGyeG_o.png" width="692"></p> 
<h3 id="2.14.%22%5Ctiming%22%E6%98%BE%E7%A4%BASQL%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4">2.14."\timing"显示SQL语句执行时间</h3> 
<p><img alt="" height="137" src="https://images2.imgbox.com/23/40/mwt6pXZy_o.png" width="692"></p> 
<p>再执行一次关闭</p> 
<h3 id="2.15.%E2%80%9C%5Cx%E2%80%9D%E5%8F%AF%E4%BB%A5%E6%8A%8A%E6%8C%89%E8%A1%8C%E5%B1%95%E7%A4%BA%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8F%98%E6%88%90%E6%8C%89%E5%88%97%E5%B1%95%E7%A4%BA">2.15.“\x”可以把按行展示的数据变成按列展示</h3> 
<p><img alt="" height="295" src="https://images2.imgbox.com/51/32/UOc9wnKf_o.png" width="693"></p> 
<h3 id="2.16.%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4%E5%8A%9F%E8%83%BD">2.16.自动提交功能</h3> 
<p>方法1：运行”begin”命令，然后执行DML语句，最后再执行commint或rollback预计<br> 方法2：执行”\set AUTOCOMMIT off”关闭自动提交功能。AUTOCOMMINT必须是大小，小写无效也不报错。</p> 
<h3 id="2.17.%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%89%88%E6%9C%AC">2.17.查看数据库版本</h3> 
<p>方法1：psql –version<br> 方法2：select version();</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/970dddb34f0bfc01c3b9d81b5be7d446/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">2024年计算，信息科学与系统国际会议 (CCISS 2024)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0133c1c4a335cf53e6443a064ee9dce2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">git使用patch进行补丁操作</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>