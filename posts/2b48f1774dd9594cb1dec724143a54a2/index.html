<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【云服务环境】含泪总结：我在云服务安装Python爬虫环境Playwright的踩坑实录 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【云服务环境】含泪总结：我在云服务安装Python爬虫环境Playwright的踩坑实录" />
<meta property="og:description" content="大家好，我是同学小张，日常分享AI知识和实战案例欢迎 点赞 &#43; 关注 👏，持续学习，持续干货输出。&#43;v: jasper_8017 一起交流💬，一起进步💪。微信公众号也可搜【同学小张】 🙏 本站文章一览：
总是想在自己的微信公众号中开发点什么功能，于是我又开始来折腾服务端的环境了。
这次是希望能在服务端配置起爬虫的环境，于是想着装个 Playwright，但没想到遇到这么多坑…
文章目录 0. 背景1. Playwright 安装1.1 基本安装过程1.2 踩坑实录1.2.1 坑一：/lib64/libc.so.6: version `GLIBC_2.28’ not found1.2.2 坑二：These critical programs are missing or too old: make bison compiler1.2.3 坑三：bash: __vsc_prompt_cmd_original: command not found1.2.4 坑四：/lib64/libstdc&#43;&#43;.so.6: version `GLIBCXX_3.4.20‘ not found 2. 参考 0. 背景 环境：腾讯云服务，CentOS 7，宝塔面板
之前对环境做过的一些配置（安装 Anaconda，打通 GitHub，远程可视化开发）：
【超详细！超多图！】Python微信公众号开发（1）【超详细！超多图！】【代码管理】Python微信公众号开发（3）- 服务器代码上传Github【新人必会】远程开发可视化 - VSCode篇 为什么想到要安装 Playwright ？因为我运行 LangChain 加载URL网页内容时报错了：
运行的代码是这样的：
urls = [&#34;https://mp.weixin.qq.com/s/2m8MrsCxf5boiH4Dzpphrg&#34;] from langchain_community.document_loaders import AsyncChromiumLoader from langchain_community." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/2b48f1774dd9594cb1dec724143a54a2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-17T07:00:00+08:00" />
<meta property="article:modified_time" content="2024-03-17T07:00:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【云服务环境】含泪总结：我在云服务安装Python爬虫环境Playwright的踩坑实录</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <ul><li>大家好，我是同学小张，日常分享AI知识和实战案例</li><li>欢迎 <strong>点赞 + 关注</strong> 👏，<strong>持续学习</strong>，<strong>持续干货输出</strong>。</li><li>+v: <strong>jasper_8017</strong> 一起交流💬，一起进步💪。</li><li>微信公众号也可搜【同学小张】 🙏</li></ul> 
</blockquote> 
<p><strong><mark>本站文章一览：</mark></strong></p> 
<p><img src="https://images2.imgbox.com/b1/6d/23aJEUn9_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p>总是想在自己的微信公众号中开发点什么功能，于是我又开始来折腾服务端的环境了。</p> 
<p>这次是希望能在服务端配置起爬虫的环境，于是想着装个 Playwright，但没想到遇到这么多坑…</p> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#0__21" rel="nofollow">0. 背景</a></li><li><a href="#1_Playwright__59" rel="nofollow">1. Playwright 安装</a></li><li><ul><li><a href="#11__61" rel="nofollow">1.1 基本安装过程</a></li><li><a href="#12__73" rel="nofollow">1.2 踩坑实录</a></li><li><ul><li><a href="#121_lib64libcso6_version_GLIBC_228_not_found_78" rel="nofollow">1.2.1 坑一：/lib64/libc.so.6: version `GLIBC_2.28’ not found</a></li><li><a href="#122_These_critical_programs_are_missing_or_too_old_make_bison_compiler_94" rel="nofollow">1.2.2 坑二：These critical programs are missing or too old: make bison compiler</a></li><li><a href="#123_bash___vsc_prompt_cmd_original_command_not_found_107" rel="nofollow">1.2.3 坑三：bash: __vsc_prompt_cmd_original: command not found</a></li><li><a href="#124_lib64libstdcso6_version_GLIBCXX_3420_not_found_172" rel="nofollow">1.2.4 坑四：/lib64/libstdc++.so.6: version `GLIBCXX_3.4.20‘ not found</a></li></ul> 
  </li></ul> 
  </li><li><a href="#2__206" rel="nofollow">2. 参考</a></li></ul> 
</div> 
<p></p> 
<h2><a id="0__21"></a>0. 背景</h2> 
<blockquote> 
 <p>环境：腾讯云服务，CentOS 7，宝塔面板</p> 
</blockquote> 
<blockquote> 
 <p>之前对环境做过的一些配置（安装 Anaconda，打通 GitHub，远程可视化开发）：</p> 
 <ul><li><a href="https://blog.csdn.net/Attitude93/article/details/135383663">【超详细！超多图！】Python微信公众号开发（1）</a></li><li><a href="https://blog.csdn.net/Attitude93/article/details/135417490">【超详细！超多图！】【代码管理】Python微信公众号开发（3）- 服务器代码上传Github</a></li><li><a href="https://blog.csdn.net/Attitude93/article/details/135368358">【新人必会】远程开发可视化 - VSCode篇</a></li></ul> 
</blockquote> 
<p>为什么想到要安装 Playwright ？因为我运行 LangChain 加载URL网页内容时报错了：</p> 
<p><img src="https://images2.imgbox.com/e0/40/lqaEREXf_o.png" alt="在这里插入图片描述"><br> 运行的代码是这样的：</p> 
<pre><code class="prism language-python">urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"https://mp.weixin.qq.com/s/2m8MrsCxf5boiH4Dzpphrg"</span><span class="token punctuation">]</span>

<span class="token keyword">from</span> langchain_community<span class="token punctuation">.</span>document_loaders <span class="token keyword">import</span> AsyncChromiumLoader
<span class="token keyword">from</span> langchain_community<span class="token punctuation">.</span>document_transformers <span class="token keyword">import</span> BeautifulSoupTransformer

<span class="token comment"># Load HTML</span>
loader <span class="token operator">=</span> AsyncChromiumLoader<span class="token punctuation">(</span>urls<span class="token punctuation">)</span>
html <span class="token operator">=</span> loader<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># print("============= html =====================")</span>
<span class="token comment"># print(html)</span>

<span class="token comment"># Transform</span>
bs_transformer <span class="token operator">=</span> BeautifulSoupTransformer<span class="token punctuation">(</span><span class="token punctuation">)</span>
docs_transformed <span class="token operator">=</span> bs_transformer<span class="token punctuation">.</span>transform_documents<span class="token punctuation">(</span>html<span class="token punctuation">,</span> tags_to_extract<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"h1"</span><span class="token punctuation">,</span> <span class="token string">"h2"</span><span class="token punctuation">,</span> <span class="token string">"h3"</span><span class="token punctuation">,</span> <span class="token string">"span"</span><span class="token punctuation">,</span> <span class="token string">"code"</span><span class="token punctuation">,</span> <span class="token string">"p"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"================= doc_transformed ==============="</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>docs_transformed<span class="token punctuation">)</span>
</code></pre> 
<p>AsyncChromiumLoader 的背后是 Playwright。为了解决这个问题，于是开启了我艰难的环境搭建过程。</p> 
<h2><a id="1_Playwright__59"></a>1. Playwright 安装</h2> 
<h3><a id="11__61"></a>1.1 基本安装过程</h3> 
<pre><code class="prism language-python">pip install playwright
</code></pre> 
<p>上面安装完成之后，还需要执行下面命令：</p> 
<pre><code class="prism language-python">playwright install
</code></pre> 
<h3><a id="12__73"></a>1.2 踩坑实录</h3> 
<p>如果上面啥都没报错，恭喜你，运气太好了。</p> 
<p>下面展示我遇到的坑，<font color="blue"><strong>注意，这是一个连环坑，在解决一个问题的过程中遇到了另一个问题，所以请按顺序阅读，不要跳。</strong></font></p> 
<h4><a id="121_lib64libcso6_version_GLIBC_228_not_found_78"></a>1.2.1 坑一：/lib64/libc.so.6: version `GLIBC_2.28’ not found</h4> 
<p>解决步骤如下：</p> 
<pre><code class="prism language-bash">​cd /usr/local/
<span class="token function">wget</span> https://mirror.bjtu.edu.cn/gnu/libc/glibc-2.28.tar.xz --no-check-certificate
<span class="token function">tar</span> <span class="token parameter variable">-xf</span> glibc-2.28.tar.xz
<span class="token builtin class-name">cd</span> glibc-2.28/
<span class="token function">mkdir</span> build
<span class="token builtin class-name">cd</span> build/
<span class="token punctuation">..</span>/configure <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/usr/local/glibc-2.28
</code></pre> 
<p>执行以上命令，很可能再遇到下面错误。</p> 
<h4><a id="122_These_critical_programs_are_missing_or_too_old_make_bison_compiler_94"></a>1.2.2 坑二：These critical programs are missing or too old: make bison compiler</h4> 
<p>这是因为 make bison compiler 太过老旧，需要升级GCC编译器</p> 
<p><img src="https://images2.imgbox.com/3e/08/Z4Wb7Dth_o.png" alt="在这里插入图片描述" width="600"><br> 解决方法：</p> 
<pre><code class="prism language-bash">yum <span class="token parameter variable">-y</span> <span class="token function">install</span> centos-release-scl
yum <span class="token parameter variable">-y</span> <span class="token function">install</span> devtoolset-8-gcc devtoolset-8-gcc-c++ devtoolset-8-binutils
scl <span class="token builtin class-name">enable</span> devtoolset-8 <span class="token function">bash</span>
</code></pre> 
<p>执行上面这一句时，又遇到了下面的错误。</p> 
<h4><a id="123_bash___vsc_prompt_cmd_original_command_not_found_107"></a>1.2.3 坑三：bash: __vsc_prompt_cmd_original: command not found</h4> 
<p>解决方法：</p> 
<pre><code class="prism language-bash"><span class="token function">vim</span> ~/.bash_profile
</code></pre> 
<p>在文件中添加：<code>unset PROMPT_COMMAND</code></p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">source</span> ~/.bash_profile
</code></pre> 
<p>到此，1.2.3 解决完毕。然后继续 1.2.2 的问题解决：</p> 
<pre><code class="prism language-bash">scl <span class="token builtin class-name">enable</span> devtoolset-8 <span class="token function">bash</span>
<span class="token builtin class-name">echo</span> <span class="token string">"source /opt/rh/devtoolset-8/enable"</span> <span class="token operator">&gt;&gt;</span>/etc/profile
</code></pre> 
<p>之后需要升级 make</p> 
<pre><code class="prism language-bash"><span class="token function">wget</span> http://ftp.gnu.org/gnu/make/make-4.2.tar.gz
<span class="token function">tar</span> <span class="token parameter variable">-xzvf</span> make-4.2.tar.gz
<span class="token builtin class-name">cd</span> make-4.2
<span class="token function">sudo</span> ./configure
<span class="token function">sudo</span> <span class="token function">make</span>
<span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span>
<span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /usr/bin/make
<span class="token function">sudo</span> <span class="token function">cp</span> ./make /usr/bin/
<span class="token function">make</span> <span class="token parameter variable">-v</span>
</code></pre> 
<p>到此，问题 1.2.2 解决完毕，继续解决 1.2.1 的问题：</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> /<span class="token punctuation">{<!-- --></span>你的下载目录<span class="token punctuation">}</span>/glibc-2.28/build/ 
yum <span class="token function">install</span> <span class="token parameter variable">-y</span> bison
<span class="token function">sudo</span> <span class="token punctuation">..</span>/configure <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/usr --disable-profile --enable-add-ons --with-headers<span class="token operator">=</span>/usr/include --with-binutils<span class="token operator">=</span>/usr/bin
<span class="token function">make</span>  //make 运行时间较长
<span class="token function">make</span> <span class="token function">install</span>
</code></pre> 
<p>还有可能遇到下面的错，先不用管。</p> 
<p><img src="https://images2.imgbox.com/a1/b9/eNTEyYlH_o.png" alt="在这里插入图片描述" width="600"><br> 至此，问题 1.2.1 解决完毕。验证GLIBC是否存在GLIBC-2.28版本：</p> 
<pre><code class="prism language-bash">strings /lib64/libc.so.6 <span class="token operator">|</span> <span class="token function">grep</span> GLIBC
</code></pre> 
<p>运行结果里应该能看到 2.28 版本：</p> 
<p><img src="https://images2.imgbox.com/21/11/n6yFcAys_o.png" alt="在这里插入图片描述" width="600"></p> 
<p>至此，1.2.1 问题解决完毕。重新运行：</p> 
<pre><code class="prism language-bash">playwright <span class="token function">install</span>
</code></pre> 
<p>然后，你还能遇到下面的错误。</p> 
<h4><a id="124_lib64libstdcso6_version_GLIBCXX_3420_not_found_172"></a>1.2.4 坑四：/lib64/libstdc++.so.6: version `GLIBCXX_3.4.20‘ not found</h4> 
<p>这是因为 libstdc++.so.6 版本低。<br> <img src="https://images2.imgbox.com/44/0c/RP6jCvHQ_o.png" alt="在这里插入图片描述" width="700"><br> 解决方法：</p> 
<pre><code class="prism language-bash"><span class="token function">find</span> / <span class="token parameter variable">-name</span> <span class="token string">"libstdc++.so*"</span>
</code></pre> 
<p>以上命令查找当前服务中所有的 libstdc++.so：</p> 
<p><img src="https://images2.imgbox.com/34/ac/LaqUGmDc_o.png" alt="在这里插入图片描述" width="600"><br> 从中找个版本最高的，执行：</p> 
<pre><code class="prism language-bash"><span class="token function">cp</span> /root/anaconda3/lib/libstdc++.so.6.0.29 /usr/lib64
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> libstdc++.so.6
<span class="token function">ln</span> <span class="token parameter variable">-s</span> libstdc++.so.6.0.29 libstdc++.so.6
</code></pre> 
<p>至此，1.2.4 问题解决完毕。重新运行：</p> 
<pre><code class="prism language-bash">playwright <span class="token function">install</span>
</code></pre> 
<p>应该会看到下面的 warning，先不管。</p> 
<p><img src="https://images2.imgbox.com/ed/ca/pTnLMPyY_o.png" alt="在这里插入图片描述" width="600"><br> 至此，认为 Playwright 环境安装成功。再跑下刚开始的程序，成功爬取到数据：</p> 
<p><img src="https://images2.imgbox.com/86/ac/M2xNTWBa_o.png" alt="在这里插入图片描述" width="700"></p> 
<h2><a id="2__206"></a>2. 参考</h2> 
<ul><li>https://blog.csdn.net/NinjaKilling/article/details/125979091</li><li>https://blog.csdn.net/jiaoyangwm/article/details/134262152</li><li>https://blog.csdn.net/wuwei_201/article/details/136031168</li><li>https://blog.csdn.net/tianjinhuaysh/article/details/120901894</li></ul> 
<blockquote> 
 <p><strong>如果觉得本文对你有帮助，麻烦点个赞和关注呗 ~~~</strong></p> 
</blockquote> 
<hr> 
<blockquote> 
 <ul><li>大家好，我是 <font color="blue"><strong>同学小张</strong></font>，日常分享AI知识和实战案例</li><li>欢迎 <font color="red"><strong>点赞 + 关注</strong></font> 👏，<strong>持续学习</strong>，<strong>持续干货输出</strong>。</li><li>+v: <font color="blue"><strong>jasper_8017</strong></font> 一起交流💬，一起进步💪。</li><li>微信公众号也可搜<font color="blue">【<strong>同学小张</strong>】</font> 🙏</li></ul> 
</blockquote> 
<p><strong><mark>本站文章一览：</mark></strong></p> 
<p><img src="https://images2.imgbox.com/ff/76/OkQ0yFmJ_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/441ac34dbdf18e9c8a76346c8b288802/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">已解决org.apache.zookeeper.KeeperException.InvalidACLException异常的正确解决方法，亲测有效！！！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f37228c8d8ee87fcb6374a0d2700d777/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">云渗透工具-0.0.2版本更新</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>