<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python读取Excel工作表数据写入CSV、XML、文本 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python读取Excel工作表数据写入CSV、XML、文本" />
<meta property="og:description" content="Excel工作簿是常用的表格格式，许多数据呈现、数据分析和数据汇报都是以Excel工作表的形式进行。然而，在实际的数据管理、分析或自动化流程构建过程中，我们常常需要将这些Excel中的数据迁移至更其他数据系统，或者以文本形式存储以便与其他程序进行交互。Python作为一种强大且灵活的编程语言，能够高效地实现这一目标。本文将演示如何运用Python编程语言，将Excel工作表中的丰富数据导入到CSV、XML或文本中，我们也可以使用文中的方法读取数据并写入到其他文件或数据系统中。
文章目录 直接将Excel工作表转换为CSV读取Excel工作表数据保存到CSV将Excel工作簿转换为OpenXML读取Excel工作表数据写入XML读取Excel工作表数据保存为文本 本文所使用的方法需要用到Spire.XLS for Python，可从官网获取或通过PyPI：pip install Spire.XLS。
示例Excel文件
直接将Excel工作表转换为CSV 使用此API，我们可以直接获取指定工作表并转换为CSV文件。以下是操作步骤：
导入所需模块。创建 Workbook 类的对象 wb。使用 wb.LoadFromFile() 方法加载指定路径下的Excel文件。获取指定索引位置处的工作表 ws。使用 Worksheet.SaveToFile(string fileName, string Separator, Encoding) 方法将工作表转换为CSV文件并保存。释放资源。 代码示例
from spire.xls import * from spire.xls.common import * # 创建 Workbook 对象 wb = Workbook() # 加载 Excel 文件 wb.LoadFromFile(&#34;示例.xlsx&#34;) # 获取工作表 ws = wb.Worksheets.get_Item(0) # 将工作表保存为 CSV 文件 ws.SaveToFile(f&#34;output/{ws.Name}.csv&#34;, &#34;,&#34;, Encoding.get_UTF8()) wb.Dispose() 提取结果
读取Excel工作表数据保存到CSV 除了直接转换外，我们还可以直接读取指定单元格范围的数据，并写入CSV文件，来实现自定义的数据提取。以下是操作步骤：
导入所需模块。创建 Workbook 类的对象 wb。使用 wb.LoadFromFile() 方法加载指定路径下的Excel文件。获取指定索引位置处的工作表 ws。确定工作表的已使用范围（即有数据的部分）作为 usedRange。遍历 usedRange 中的每一行和每一列： 获取单元格的值，并对包含逗号的字符串单元格值添加双引号。将处理过的单元格值添加到 rowData 列表中。 对每一行的 rowData 列表进行处理，将其转换为逗号分隔的字符串，并在末尾添加换行符，然后将结果追加到 data 字符串中。打开一个CSV文件（以当前工作表名称命名），以写模式和UTF-8编码将 data 字符串内容写入该文件。使用 wb." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/71fa362b9c8d07ad49b4e90abbc23313/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-15T15:37:55+08:00" />
<meta property="article:modified_time" content="2024-03-15T15:37:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python读取Excel工作表数据写入CSV、XML、文本</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>Excel工作簿是常用的表格格式，许多数据呈现、数据分析和数据汇报都是以Excel工作表的形式进行。然而，在实际的数据管理、分析或自动化流程构建过程中，我们常常需要将这些Excel中的数据迁移至更其他数据系统，或者以文本形式存储以便与其他程序进行交互。Python作为一种强大且灵活的编程语言，能够高效地实现这一目标。本文将演示如何运用Python编程语言，将<strong>Excel工作表中的丰富数据导入到CSV、XML或文本</strong>中，我们也可以使用文中的方法读取数据并写入到其他文件或数据系统中。</p> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#ExcelCSV_11" rel="nofollow">直接将Excel工作表转换为CSV</a></li><li><a href="#ExcelCSV_44" rel="nofollow">读取Excel工作表数据保存到CSV</a></li><li><a href="#ExcelOpenXML_99" rel="nofollow">将Excel工作簿转换为OpenXML</a></li><li><a href="#ExcelXML_128" rel="nofollow">读取Excel工作表数据写入XML</a></li><li><a href="#Excel_195" rel="nofollow">读取Excel工作表数据保存为文本</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p>本文所使用的方法需要用到<a href="https://www.e-iceblue.com/Download/Spire-XLS-Python.html" rel="nofollow">Spire.XLS for Python</a>，可从官网获取或通过PyPI：<code>pip install Spire.XLS</code>。</p> 
<p>示例Excel文件</p> 
<p><img src="https://images2.imgbox.com/5d/0d/8pgHkBVQ_o.png" alt="Python读取Excel文件"></p> 
<h3><a id="ExcelCSV_11"></a>直接将Excel工作表转换为CSV</h3> 
<p>使用此API，我们可以直接获取指定工作表并转换为CSV文件。以下是操作步骤：</p> 
<ol><li>导入所需模块。</li><li>创建 <code>Workbook</code> 类的对象 <code>wb</code>。</li><li>使用 <code>wb.LoadFromFile()</code> 方法加载指定路径下的Excel文件。</li><li>获取指定索引位置处的工作表 <code>ws</code>。</li><li>使用 <code>Worksheet.SaveToFile(string fileName, string Separator, Encoding)</code> 方法将工作表转换为CSV文件并保存。</li><li>释放资源。</li></ol> 
<p><strong>代码示例</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> spire<span class="token punctuation">.</span>xls <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> spire<span class="token punctuation">.</span>xls<span class="token punctuation">.</span>common <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># 创建 Workbook 对象</span>
wb <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 加载 Excel 文件</span>
wb<span class="token punctuation">.</span>LoadFromFile<span class="token punctuation">(</span><span class="token string">"示例.xlsx"</span><span class="token punctuation">)</span>

<span class="token comment"># 获取工作表</span>
ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>Worksheets<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># 将工作表保存为 CSV 文件</span>
ws<span class="token punctuation">.</span>SaveToFile<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"output/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>ws<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">.csv"</span></span><span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">,</span> Encoding<span class="token punctuation">.</span>get_UTF8<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
wb<span class="token punctuation">.</span>Dispose<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>提取结果</strong></p> 
<p><img src="https://images2.imgbox.com/e5/0c/QSW4U6DG_o.png" alt="Python Excel工作表转CSV"></p> 
<h3><a id="ExcelCSV_44"></a>读取Excel工作表数据保存到CSV</h3> 
<p>除了直接转换外，我们还可以直接读取指定单元格范围的数据，并写入CSV文件，来实现自定义的数据提取。以下是操作步骤：</p> 
<ol><li>导入所需模块。</li><li>创建 <code>Workbook</code> 类的对象 <code>wb</code>。</li><li>使用 <code>wb.LoadFromFile()</code> 方法加载指定路径下的Excel文件。</li><li>获取指定索引位置处的工作表 <code>ws</code>。</li><li>确定工作表的已使用范围（即有数据的部分）作为 <code>usedRange</code>。</li><li>遍历 <code>usedRange</code> 中的每一行和每一列： 
  <ul><li>获取单元格的值，并对包含逗号的字符串单元格值添加双引号。</li><li>将处理过的单元格值添加到 <code>rowData</code> 列表中。</li></ul> </li><li>对每一行的 <code>rowData</code> 列表进行处理，将其转换为逗号分隔的字符串，并在末尾添加换行符，然后将结果追加到 <code>data</code> 字符串中。</li><li>打开一个CSV文件（以当前工作表名称命名），以写模式和UTF-8编码将 <code>data</code> 字符串内容写入该文件。</li><li>使用 <code>wb.Dispose()</code> 方法释放资源，清理内存。</li></ol> 
<p><strong>代码示例</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> spire<span class="token punctuation">.</span>xls <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> spire<span class="token punctuation">.</span>xls<span class="token punctuation">.</span>common <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># 创建 Workbook 对象</span>
wb <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 加载 Excel 文件</span>
wb<span class="token punctuation">.</span>LoadFromFile<span class="token punctuation">(</span><span class="token string">"示例.xlsx"</span><span class="token punctuation">)</span>

<span class="token comment"># 获取工作表</span>
ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>Worksheets<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># 获取已使用的区域</span>
usedRange <span class="token operator">=</span> ws<span class="token punctuation">.</span>AllocatedRange

data <span class="token operator">=</span> <span class="token string">""</span>
<span class="token comment"># 遍历已使用的区域</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> usedRange<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">:</span>
    rowData <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>usedRange<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取单元格的值</span>
        cellValue <span class="token operator">=</span> usedRange<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value
        <span class="token comment"># 对包含逗号的数据添加引号</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>cellValue<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token string">','</span> <span class="token keyword">in</span> cellValue<span class="token punctuation">:</span>
            cellValue <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>cellValue<span class="token punctuation">}</span></span><span class="token string">"'</span></span>
        rowData<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cellValue<span class="token punctuation">)</span>
    data <span class="token operator">+=</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>rowData<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span>

<span class="token comment"># 将数据写入 CSV 文件</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"output/CSV/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>ws<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">.csv"</span></span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
wb<span class="token punctuation">.</span>Dispose<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>提取效果</strong></p> 
<p><img src="https://images2.imgbox.com/ab/fc/MZVMVY7s_o.png" alt="Python读取Excel工作表写入CSV"></p> 
<h3><a id="ExcelOpenXML_99"></a>将Excel工作簿转换为OpenXML</h3> 
<p>使用 Workbook 类的 SaveAsXml 方法可以直接将一个工作簿转换为Open XML文件。以下是操作步骤：</p> 
<ol><li>导入所需模块。</li><li>创建 <code>Workbook</code> 类的对象 <code>wb</code>。</li><li>使用 <code>wb.LoadFromFile()</code> 方法加载指定路径下的Excel文件。</li><li>使用 <code>Workbook.SaveAsXml()</code> 方法将工作簿转换为Open XML文件并保存。</li><li>释放资源。</li></ol> 
<p><strong>代码示例</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> spire<span class="token punctuation">.</span>xls <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> spire<span class="token punctuation">.</span>xls<span class="token punctuation">.</span>common <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># 创建 Workbook 对象</span>
wb <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 加载 Excel 文件</span>
wb<span class="token punctuation">.</span>LoadFromFile<span class="token punctuation">(</span><span class="token string">"示例.xlsx"</span><span class="token punctuation">)</span>

<span class="token comment"># 保存为 OpenXML 文件</span>
wb<span class="token punctuation">.</span>SaveAsXml<span class="token punctuation">(</span><span class="token string">"output/工作簿转OpenXML.xml"</span><span class="token punctuation">)</span>
wb<span class="token punctuation">.</span>Dispose<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>提取效果</strong></p> 
<p><img src="https://images2.imgbox.com/45/5a/TPkrmO1F_o.png" alt="Python Excel转换为Open XML"></p> 
<h3><a id="ExcelXML_128"></a>读取Excel工作表数据写入XML</h3> 
<p>除了将工作簿直接转换为Open XML文件外，我们还可以读取表格数据，制作自定义的XML文件。我们可以引入 <code>xml.etree.ElementTree</code> 来方便对XML的写入。以下是操作示例：</p> 
<ol><li>导入所需模块。</li><li>创建 <code>Workbook</code> 类的对象 <code>wb</code>。</li><li>使用 <code>wb.LoadFromFile()</code> 方法加载指定路径下的Excel文件。</li><li>获取工作表 <code>ws</code>，其索引为0。</li><li>获取工作表中的已使用区域 <code>usedRange</code>。</li><li>创建 XML 的根元素 <code>root</code>，命名为 “Worksheet”。</li><li>在 XML 根元素下创建子元素 “Name”，并将其文本内容设置为当前工作表的名称。</li><li>遍历已使用的区域（按行）： 
  <ul><li>对于每一行，创建一个 “Row” 子元素。</li><li>再对该行的每个单元格进行遍历（按列）： 
    <ul><li>获取单元格的值。</li><li>在 “Row” 元素下创建一个 “Cell” 子元素。</li><li>在 “Cell” 元素下进一步创建一个 “Data” 子元素，将单元格值转换为字符串并设置为其文本内容。</li></ul> </li></ul> </li><li>将所有生成的 XML 元素构建成一个完整的 XML 树结构，存储在 <code>xml_tree</code> 变量中。</li><li>使用 <code>xml_tree.write()</code> 方法将 XML 数据写入名为 “工作表写入XML.xml” 的文件中，同时指定 UTF-8 编码和添加 XML 声明。</li><li>最后，调用 <code>wb.Dispose()</code> 方法释放资源，关闭并清理 Excel 工作簿对象。</li></ol> 
<p><strong>代码示例</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> xml<span class="token punctuation">.</span>etree<span class="token punctuation">.</span>ElementTree <span class="token keyword">as</span> ET
<span class="token keyword">from</span> spire<span class="token punctuation">.</span>xls <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> spire<span class="token punctuation">.</span>xls<span class="token punctuation">.</span>common <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># 创建 Workbook 对象</span>
wb <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 加载 Excel 文件</span>
wb<span class="token punctuation">.</span>LoadFromFile<span class="token punctuation">(</span><span class="token string">"示例.xlsx"</span><span class="token punctuation">)</span>

<span class="token comment"># 获取工作表</span>
ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>Worksheets<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># 获取已使用的区域</span>
usedRange <span class="token operator">=</span> ws<span class="token punctuation">.</span>AllocatedRange

<span class="token comment"># 创建 XML 根元素</span>
root <span class="token operator">=</span> ET<span class="token punctuation">.</span>Element<span class="token punctuation">(</span><span class="token string">"Worksheet"</span><span class="token punctuation">)</span>

<span class="token comment"># 设置工作表名称</span>
name_element <span class="token operator">=</span> ET<span class="token punctuation">.</span>SubElement<span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token string">"Name"</span><span class="token punctuation">)</span>
name_element<span class="token punctuation">.</span>text <span class="token operator">=</span> ws<span class="token punctuation">.</span>Name

<span class="token comment"># 遍历已使用的区域</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> usedRange<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">:</span>
    row_element <span class="token operator">=</span> ET<span class="token punctuation">.</span>SubElement<span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token string">"Row"</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>usedRange<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取单元格的值</span>
        cellValue <span class="token operator">=</span> usedRange<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value
        <span class="token comment"># 创建单元格元素</span>
        cell_element <span class="token operator">=</span> ET<span class="token punctuation">.</span>SubElement<span class="token punctuation">(</span>row_element<span class="token punctuation">,</span> <span class="token string">"Cell"</span><span class="token punctuation">)</span>
        <span class="token comment"># 创建数据元素</span>
        data_element <span class="token operator">=</span> ET<span class="token punctuation">.</span>SubElement<span class="token punctuation">(</span>cell_element<span class="token punctuation">,</span> <span class="token string">"Data"</span><span class="token punctuation">)</span>
        data_element<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>cellValue<span class="token punctuation">)</span>

<span class="token comment"># 创建 XML 文档</span>
xml_tree <span class="token operator">=</span> ET<span class="token punctuation">.</span>ElementTree<span class="token punctuation">(</span>root<span class="token punctuation">)</span>
<span class="token comment"># 将数据写入 XML 文件</span>
xml_tree<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"output/XML/工作表写入XML.xml"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">,</span> xml_declaration<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
wb<span class="token punctuation">.</span>Dispose<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>代码示例</strong><br> <img src="https://images2.imgbox.com/26/ce/4nbEFxwj_o.png" alt="Python读取Excel写入XML"></p> 
<h3><a id="Excel_195"></a>读取Excel工作表数据保存为文本</h3> 
<p>我们还可以直接读取表格文件写入普通文本文件，用于其他用途。以下是操作步骤：</p> 
<ol><li>导入模块。</li><li>初始化一个新的 <code>Workbook</code> 实例 <code>wb</code>。</li><li>使用 <code>wb.LoadFromFile()</code> 函数加载 Excel 文件。</li><li>选取第一个工作表（索引为0），赋值给变量 <code>ws</code>。</li><li>获取该工作表的已使用区域，存放在变量 <code>usedRange</code> 中。</li><li>初始化一个空字符串 <code>data</code>，用于收集所有单元格的数据。</li><li>遍历已使用的行与列范围： 
  <ul><li>对于每一行（从第二行开始计数，因为Excel索引从1开始）： 
    <ul><li>对于该行内的每一个单元格： 
      <ul><li>获取单元格的值，并将其转换为字符串形式，追加到 <code>data</code> 后面。</li><li>如果当前单元格不是本行的最后一个单元格，则在其后添加制表符 <code>\t</code> 分隔数据。</li></ul> </li><li>完成一行的所有单元格之后，在 <code>data</code> 后面添加换行符 <code>\n</code>，以便在输出时区分不同行的数据。</li></ul> </li></ul> </li><li>使用 <code>with open()</code> 语句以“写入”模式打开一个新文件，文件名基于当前工作表的名称加上 <code>.txt</code> 扩展名，且路径设为 “output/” 目录下。</li><li>将之前拼接好的包含所有单元格数据的字符串 <code>data</code> 写入所创建的文本文件中。</li><li>关闭文件流，确保数据成功写入。</li><li>调用 <code>wb.Dispose()</code> 方法释放资源，关闭并清理 Excel 工作簿对象。</li></ol> 
<p><strong>代码示例</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> spire<span class="token punctuation">.</span>xls <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> spire<span class="token punctuation">.</span>xls<span class="token punctuation">.</span>common <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># 创建 Workbook 对象</span>
wb <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 加载 Excel 文件</span>
wb<span class="token punctuation">.</span>LoadFromFile<span class="token punctuation">(</span><span class="token string">"示例.xlsx"</span><span class="token punctuation">)</span>

<span class="token comment"># 获取工作表</span>
ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>Worksheets<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># 获取已使用的区域</span>
usedRange <span class="token operator">=</span> ws<span class="token punctuation">.</span>AllocatedRange

data <span class="token operator">=</span> <span class="token string">""</span>
<span class="token comment"># 遍历已使用的区域</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> usedRange<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>usedRange<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取单元格的值</span>
        cellValue <span class="token operator">=</span> usedRange<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value
        data <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>cellValue<span class="token punctuation">)</span>
        <span class="token keyword">if</span> j <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>usedRange<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Columns<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
            data <span class="token operator">+=</span> <span class="token string">"\t"</span>
    data <span class="token operator">+=</span> <span class="token string">"\n"</span>

<span class="token comment"># 将数据写入 CSV 文件</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"output/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>ws<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">.txt"</span></span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
wb<span class="token punctuation">.</span>Dispose<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>提取结果</strong></p> 
<p><img src="https://images2.imgbox.com/90/24/hyh3us9X_o.png" alt="Python读取Excel工作表写入文本文件"></p> 
<p>以上内容演示了如何使用Python读取Excel数据并写入到CSV、XML和文本文件中。<br> <a href="https://www.e-iceblue.cn/xlsforpython/spire-xls-for-python-program-guide-content.html" rel="nofollow">更多Excel操作文章</a><br> <strong><a href="https://www.e-iceblue.com/TemLicense.html" rel="nofollow">申请免费License</a></strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6674004a126be3b7fa74462f908bc066/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Solidity Uniswap V2 library contract</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/48ffb345cf3e610e18f66d76ea39d3e2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">实验11-2-5 链表拼接（PTA）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>