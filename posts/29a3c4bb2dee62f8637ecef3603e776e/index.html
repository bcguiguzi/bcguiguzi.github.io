<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>黑马瑞吉外卖-菜品管理-批量删除，批量启售停售，套餐管理-修改套餐和批量启售停售 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="黑马瑞吉外卖-菜品管理-批量删除，批量启售停售，套餐管理-修改套餐和批量启售停售" />
<meta property="og:description" content="编写瑞吉外卖项目未讲解到的功能代码
菜品管理模块：批量删除和批量启售停售功能需求实现。
套餐管理模块：修改套餐，批量启售停售功能需求实现。
菜品管理模块 删除和批量删除---请求接口信息：
代码 /** * 批量删除菜品 * @param ids 需要删除的id数组 * @return 返回数据联调对象R */ @DeleteMapping public R&lt;String&gt; deleteIds(Long[] ids){ //将数组转为集合 List&lt;Long&gt; longs = Arrays.asList(ids); //批量删除 dishService.removeByIds(longs); return R.success(&#34;删除成功！&#34;); } 启售停售和批量启售停售---请求接口信息：
代码
/** * 批量起售和停售 * @param ids 传入需要操作的id数组 * @param status 需要变更到的状态 * @return 返回数据联调对象R */ @PostMapping(&#34;/status/{status}&#34;) public R&lt;String&gt; updateStatus(Long[] ids,@PathVariable int status){ //将数组转为集合 List&lt;Long&gt; idsList = Arrays.asList(ids); //创建更新的条件构造器 LambdaUpdateWrapper&lt;Dish&gt; queryWrapper = new LambdaUpdateWrapper&lt;&gt;(); //设置修改状态和条件 queryWrapper.set(Dish::getStatus,status).in(Dish::getId,idsList); //执行更新操作 dishService." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/29a3c4bb2dee62f8637ecef3603e776e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-13T23:02:24+08:00" />
<meta property="article:modified_time" content="2023-03-13T23:02:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">黑马瑞吉外卖-菜品管理-批量删除，批量启售停售，套餐管理-修改套餐和批量启售停售</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>编写瑞吉外卖项目未讲解到的功能代码</strong></p> 
<p><strong><span style="background-color:#c7e6ea;">菜品管理模块</span></strong>：<strong>批量删除</strong>和<strong>批量启售停售</strong>功能需求实现。</p> 
<p><strong><span style="background-color:#c7e6ea;">套餐管理模块</span></strong>：<strong>修改套餐</strong>，<strong>批量启售停售</strong>功能需求实现。</p> 
<hr> 
<h2>菜品管理模块</h2> 
<p><span style="background-color:#fbd4d0;"><strong>删除和批量删除--</strong>-</span><strong><span style="background-color:#fbd4d0;">请求接口信息：</span></strong></p> 
<p><img alt="" height="59" src="https://images2.imgbox.com/39/b9/VC7GZOgT_o.png" width="548"></p> 
<p><strong><span style="background-color:#d4e9d5;"> 代码  </span></strong></p> 
<pre><code class="language-java">/**
 * 批量删除菜品
 * @param ids 需要删除的id数组
 * @return 返回数据联调对象R
 */
@DeleteMapping
public R&lt;String&gt; deleteIds(Long[] ids){
    //将数组转为集合
    List&lt;Long&gt; longs = Arrays.asList(ids);
    //批量删除
    dishService.removeByIds(longs);
    return R.success("删除成功！");
}

</code></pre> 
<p><strong><span style="background-color:#fbd4d0;">启售停售和批量启售停售---</span></strong><strong><span style="background-color:#fbd4d0;">请求接口信息：</span></strong></p> 
<p> <img alt="" height="55" src="https://images2.imgbox.com/4b/f2/evJVZIxZ_o.png" width="591"></p> 
<p><strong><span style="background-color:#d4e9d5;">代码</span></strong></p> 
<pre><code class="language-java">/**
 * 批量起售和停售
 * @param ids 传入需要操作的id数组
 * @param status 需要变更到的状态
 * @return 返回数据联调对象R
 */
@PostMapping("/status/{status}")
public R&lt;String&gt; updateStatus(Long[] ids,@PathVariable int status){
    //将数组转为集合
    List&lt;Long&gt; idsList = Arrays.asList(ids);
    //创建更新的条件构造器
    LambdaUpdateWrapper&lt;Dish&gt; queryWrapper = new LambdaUpdateWrapper&lt;&gt;();
    //设置修改状态和条件
    queryWrapper.set(Dish::getStatus,status).in(Dish::getId,idsList);
    //执行更新操作
    dishService.update(queryWrapper);
    return R.success("操作成功！");
}

</code></pre> 
<hr> 
<h2>套餐管理模块</h2> 
<p><strong><span style="background-color:#fbd4d0;"> 修改套餐，请求接口信息（<span style="color:#fe2c24;">数据回显和修改提交</span>）：</span></strong></p> 
<p><img alt="" height="87" src="https://images2.imgbox.com/e0/81/4AqpKyFj_o.png" width="523"></p> 
<p><img alt="" height="92" src="https://images2.imgbox.com/b2/2c/GCPf8oyS_o.png" width="521"></p> 
<blockquote> 
 <p> 说明：由于更新套餐需要操作到数据表setmeal和setmeal_dish表，所以我们需要到service实现类中编写更新逻辑，操作两张表。</p> 
 <p></p> 
 <p>整个更新流程包括<strong>数据回显</strong>和<strong>数据提交</strong>两个动作。</p> 
</blockquote> 
<p><span style="color:#fe2c24;"><strong>接口：SetmealService</strong></span></p> 
<pre><code class="language-java">/**
 * 修改套餐数据回显
 * @param id 套餐ID
 * @return Dto对象
 */
public SetmealDto setmealBackData(Long id);

/**
 * 更新套餐-提交
 * @param setmealDto 更新数据
 */
public void setmealUpdate(SetmealDto setmealDto);</code></pre> 
<p><span style="color:#fe2c24;"><strong> 实现类：SetmealServiceImpl</strong></span></p> 
<pre><code class="language-java"> /**
 * 修改套餐数据回显
 * @param id 套餐ID
 * @return Dto对象
 */
@Override
public SetmealDto setmealBackData(Long id) {
    //创建dto对象用于赋值后返回
    SetmealDto setmealDto = new SetmealDto();

    //根据ID查询setmeal
    Setmeal setmeal = this.getById(id);

    //对象拷贝，将查询出来的setmeal给dto赋值
    BeanUtils.copyProperties(setmeal,setmealDto);
    
    //根据setmealId查询出setmeal_dish表中的所有对应数据
    LambdaQueryWrapper&lt;SetmealDish&gt; queryWrapper = new LambdaQueryWrapper&lt;&gt;();
    queryWrapper.eq(SetmealDish::getSetmealId,id);
    List&lt;SetmealDish&gt; list = setmealDishService.list(queryWrapper);
        
    //将查询出来的套餐菜品对应关系列表数据添加入dto中
    setmealDto.setSetmealDishes(list);

    return setmealDto;
}</code></pre> 
<pre><code class="language-java">/**
 * 更新套餐
 * @param setmealDto 更新数据
 */
@Override
public void setmealUpdate(SetmealDto setmealDto) {
    //向setmeal更新数据
    this.updateById(setmealDto);
    //向setmeal_dish表更新数据
    List&lt;SetmealDish&gt; list = setmealDto.getSetmealDishes();

    //因为套餐菜品关系表中没有套餐的ID，需要手动设置
    Long id = setmealDto.getId();
    list.stream().map((item)-&gt;{
        item.setSetmealId(id);
        return item;
    }).collect(Collectors.toList());

    //更新setmeal_dish'表策略：先删除原来内容，后添加新内容即可
    LambdaQueryWrapper&lt;SetmealDish&gt; queryWrapper = new LambdaQueryWrapper&lt;&gt;();
    queryWrapper.eq(SetmealDish::getSetmealId,id);
    setmealDishService.remove(queryWrapper);
    //添加
    setmealDishService.saveBatch(list);
}
</code></pre> 
<p><span style="color:#fe2c24;"><strong> 控制层调用（SetMealController）：</strong></span></p> 
<pre><code class="language-java">// 注入业务层
@Autowired
private SetMealService setMealService;

/**
 * 修改套餐数据回显
 * @param id 接收传入数据回显的ID
 * @return 返回数据联调对象
 */
@GetMapping("/{id}")
public R&lt;SetmealDto&gt; getSetmealBackData(@PathVariable Long id){
    //调用自定义查询方法
    SetmealDto setmealDto = setMealService.setmealBackData(id);
    return R.success(setmealDto);
}

/**
 * 更新套餐信息
 * @param setmealDto 前端传入数据
 * @return 返回数据联调对象
 */
@PutMapping
public R&lt;String&gt; setmealUpdate(@RequestBody SetmealDto setmealDto){
    log.info("======={}",setmealDto);
    setMealService.setmealUpdate(setmealDto);
    return R.success("修改成功");
}
</code></pre> 
<p><span style="color:#fe2c24;"> <strong>批量启售停售功能实现：</strong></span></p> 
<pre><code class="language-java">/**
 * 批量起售和停售
 * @param status 需要修改为的状态
 * @param ids 需要进行操作的id
 * @return 数据联调对象R
 */
@PostMapping("/status/{status}")
public R&lt;String&gt; statusUpdate(@PathVariable int status, Long[] ids){
	//将数组转换成集合
    List&lt;Long&gt; idsList = Arrays.asList(ids);
	//创建更新条件构造器
    LambdaUpdateWrapper&lt;Setmeal&gt; updateWrapper = new LambdaUpdateWrapper&lt;&gt;();
	//设置更新条件
    updateWrapper.set(Setmeal::getStatus,status).in(Setmeal::getId,idsList);
	//执行更新动作
    setMealService.update(updateWrapper);
    return R.success("操作成功!");
}</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e57c7332f15cce5b2a5da2f5705c77e5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spring Boot框架知识总结笔记（超详细，一次性到位）狂神说SpringBoot笔记</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/280f6c0ff0b047d386bd1c1cf568b6b8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">fabric网络搭建</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>