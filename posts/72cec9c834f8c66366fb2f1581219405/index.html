<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Git命令操作【全系列】 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Git命令操作【全系列】" />
<meta property="og:description" content="Git常用命令操作 1 基础命令 ①git config --global user.name [‘你的用户名’]：查看/设置 git config --global user.name ziyi：设置用户名为ziyi
git config --global user.name：查看用户名
②git config --global user.email [‘你的邮箱’]：查看/设置 设置邮箱
③git reset HEAD test.txt 取消已经缓存的内容 取消test.txt已经缓存的内容
④git rm --cached &lt;file&gt; 将文件从暂存区删除 ⑤git branch 相关命令 git branch (-a): 查看(所有)分支 git branch -r ：查看远程分支
git branch &lt;branchName&gt; :创建本地分支 也可以通过：git checkout -b dev 本地创建dev分支
git push origin dev:dev：创建远程分支 git push &lt;远程主机名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;
git branch -vv：查看本地分支与远程分支对应关系 查看本地分支&#43;上次提交的信息&#43;本地和远程分支的关系，如果本地分支没有和任何远程分支建立追踪关系，那么就不显示。
如果要建立关系：git branch --set-upstream-to=origin/dev dev git branch --set-upstream-to=origin/dev dev：本地分支与远程分支建立关系 将本地dev与origin/dev(远程)建立联系" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/72cec9c834f8c66366fb2f1581219405/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-03T07:49:37+08:00" />
<meta property="article:modified_time" content="2024-01-03T07:49:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Git命令操作【全系列】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Git_1"></a>Git常用命令操作</h2> 
<h3><a id="1__2"></a>1 基础命令</h3> 
<h5><a id="git_config_global_username__3"></a>①git config --global user.name [‘你的用户名’]：查看/设置</h5> 
<blockquote> 
 <p>git config --global user.name ziyi：设置用户名为ziyi<br> git config --global user.name：查看用户名</p> 
</blockquote> 
<h5><a id="git_config_global_useremail__6"></a>②git config --global user.email [‘你的邮箱’]：查看/设置</h5> 
<blockquote> 
 <p>设置邮箱</p> 
</blockquote> 
<h5><a id="git_reset_HEAD_testtxt__8"></a>③git reset HEAD test.txt 取消已经缓存的内容</h5> 
<blockquote> 
 <p>取消test.txt已经缓存的内容</p> 
</blockquote> 
<h5><a id="git_rm_cached_file__11"></a>④git rm --cached &lt;file&gt; 将文件从暂存区删除</h5> 
<h5><a id="git_branch__13"></a>⑤git branch 相关命令</h5> 
<h6><a id="git_branch_a__14"></a>git branch (-a): 查看(所有)分支</h6> 
<blockquote> 
 <p>git branch -r ：查看远程分支</p> 
</blockquote> 
<h6><a id="git_branch_branchName__16"></a>git branch &lt;branchName&gt; :创建本地分支</h6> 
<blockquote> 
 <p>也可以通过：git checkout -b dev 本地创建dev分支</p> 
</blockquote> 
<h6><a id="git_push_origin_devdev_18"></a>git push origin dev:dev：创建远程分支</h6> 
<blockquote> 
 <p>git push &lt;远程主机名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;</p> 
</blockquote> 
<h6><a id="git_branch_vv_21"></a>git branch -vv：查看本地分支与远程分支对应关系</h6> 
<p><img src="https://images2.imgbox.com/a3/69/Q7melmnW_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>查看本地分支+上次提交的信息+本地和远程分支的关系，如果本地分支没有和任何远程分支建立追踪关系，那么就不显示。</p> 
 <ul><li>如果要建立关系：</li><li>git branch --set-upstream-to=origin/dev dev</li></ul> 
</blockquote> 
<h6><a id="git_branch_setupstreamtoorigindev_dev_28"></a>git branch --set-upstream-to=origin/dev dev：本地分支与远程分支建立关系</h6> 
<blockquote> 
 <p>将本地dev与origin/dev(远程)建立联系</p> 
</blockquote> 
<h6><a id="git_checkout_branchName_31"></a>git checkout &lt;branchName&gt;:切换分支</h6> 
<h6><a id="git_merge_branchName_branchName_32"></a>git merge &lt;branchName&gt;: 将branchName内容合并到当前分支</h6> 
<h6><a id="git_branch_d_branchName_33"></a>git branch -d &lt;branchName&gt;:删除分支</h6> 
<h6><a id="git_checkout_b_devlocal_origindevdevlocal_34"></a>git checkout -b dev-local origin/dev：拉取远端的开发分支并在本地建立一个dev-local分支与其对应</h6> 
<blockquote> 
 <p>git checkout -b dev origin/dev</p> 
</blockquote> 
<blockquote> 
 <p>如果我们此时远程没有origin/dev ，我们想从main分支拉一个新的分支出来：</p> 
 <ol><li>git checkout -b dev origin/main # 基于main分支新建一个分支</li><li>git push origin dev:dev # 创建远程dev分支</li><li>git branch -vv # 查看本地dev分支与远程分支对应关系，如果对应关系不为origin/dev，执行下面命令建立关系:<br> git branch --set-upstream-to=origin/dev dev</li></ol> 
 <ul><li>如果出现报错：fatal: cannot set up tracking information; starting point ‘origin/main’ is not a branch</li><li>可能您的 origin 远程设置为仅获取某些分支。</li><li>解决办法：git remote set-branches --add origin main</li></ul> 
</blockquote> 
<h5><a id="git_log_47"></a>⑥git log相关命令</h5> 
<h6><a id="git_show_raw_48"></a>git show --raw：查看最后一次提交记录的修改文件信息</h6> 
<h6><a id="git_show_raw_commit_idcommit_id_49"></a>git show --raw commit_id：指定commit_id对应修改文件列表</h6> 
<h6><a id="git_log_stat_50"></a>git log --stat：查看所有提交记录的修改文件信息</h6> 
<h6><a id="git_log__51"></a>git log 文件名：查看某个文件的历史提交信息</h6> 
<h6><a id="git_log_authorziyiauthor_52"></a>git log --author=ziyi：查看指定author的修改信息</h6> 
<h6><a id="git_log_prettyonelinecommitID_53"></a>git log --pretty=oneline：查看所有修改相关的commitID和修改文件信息</h6> 
<h6><a id="git_log_graph_54"></a>git log -graph：查看历史中什么时候出现分支、合并</h6> 
<h6><a id="git_log_reverse_55"></a>git log --reverse：逆向输出日志</h6> 
<h6><a id="git_log_authorziyi_online_5ziyi_56"></a>git log --author=ziyi --online -5：简洁版本查看ziyi最近的五次提交</h6> 
<h5><a id="git_tag_58"></a>⑦git tag相关命令</h5> 
<h6><a id="git_tag_59"></a>git tag：查看所有标签</h6> 
<h6><a id="git_tag_a_tagname_m__60"></a>git tag -a -m “某某标签”：打标签</h6> 
<h5><a id="git_reset_soft_commit_62"></a>⑧git reset --soft &lt;commit&gt;:回退版本</h5> 
<blockquote> 
 <ol><li>git reset --soft &lt;commit&gt;: 回退到指定 commit，保留修改内容，并将这些修改放在暂存区。</li><li>git reset --mixed &lt;commit&gt;: 回退到指定 commit，保留修改内容，但将这些修改放在工作目录。</li><li>git reset --hard &lt;commit&gt;: 回退到指定 commit，删除所有修改内容，包括暂存区和工作目录中的修改。</li></ol> 
</blockquote> 
<p>需要注意的是，reset --soft指定commit号，会将该commit到最近一次commit的所有修改内容全部回到暂存区，而不是只针对该commit。</p> 
<pre><code class="prism language-bash"><span class="token comment"># 例如：commit记录有c、b、a</span>
commit cfasfas
commit bfadsfs
commit afasdfa
<span class="token comment">#此时我们reset到a，那么我们的HEAD就会到a，而b、c的修改内容都回到暂存区</span>
</code></pre> 
<h5><a id="git_merge_abort_75"></a>⑨git merge --abort：放弃本次合并</h5> 
<blockquote> 
 <p>本地解决冲突完成之后</p> 
</blockquote> 
<ul><li>git status：查看状态</li><li>git commit -m “xxx”:提交信息</li><li>git push：推送到远程</li></ul> 
<h3><a id="2__80"></a>2 进阶命令</h3> 
<h4><a id="21_fork_81"></a>2.1 fork别人仓库并同步保持更新</h4> 
<blockquote> 
 <ol><li>把fork的项目克隆到本地仓库中</li><li>Configuring a remote for a fork</li><li>Syncing a fork</li></ol> 
</blockquote> 
<blockquote> 
 <p>例如：我fork了一份https://github.com/simplezhli/flutter_deer.git（下文叫做A）到我自己的仓库（下文叫做B）</p> 
</blockquote> 
<h5><a id="git_clone_B_88"></a>①git clone B（自己的仓库）</h5> 
<pre><code class="prism language-bash"><span class="token function">git</span> clone 我自己fork的大佬的项目的GitHub地址
</code></pre> 
<h5><a id="git_remote_addremove_upstream_A_92"></a>②git remote add/remove upstream A仓库地址</h5> 
<pre><code class="prism language-bash"><span class="token comment"># 查看当前仓库的远程状态</span>
<span class="token function">git</span> remote <span class="token parameter variable">-v</span>
<span class="token comment"># 被本地仓库添加一个将被同步给 fork 远程的上游仓库</span>
<span class="token function">git</span> remote <span class="token function">add</span> upstream https://github.com/simplezhli/flutter_deer.git【A仓库地址】
<span class="token comment"># 这里后面的那个地址就是你fork的项目的源地址</span>
<span class="token comment">#　如果upstream的地址设置错了，可以执行下面命令删除upstream</span>
<span class="token function">git</span> remote remove upstream
</code></pre> 
<blockquote> 
 <p>下面会多出两个upstream，说明第二步已经成功了。这就相当于有一个管道在源项目和你fork的项目之间建立了，下面看看如何通信更新。</p> 
</blockquote> 
<h5><a id="forkfetch_105"></a>③同步fork（拉取远程fetch，然后合并到本地）</h5> 
<pre><code class="prism language-bash"><span class="token comment"># 从upstream拉取信息</span>
<span class="token function">git</span> fetch upstream <span class="token punctuation">[</span>分支名<span class="token punctuation">]</span>
<span class="token comment"># 切换到本地主分支</span>
<span class="token function">git</span> checkout master
<span class="token comment"># 把 upstream/master 分支合并到本地 master 上，这样就完成了同步，并且不会丢掉本地修改的内容。</span>
<span class="token function">git</span> merge upstream/master
<span class="token comment"># 这样，就把源项目同步更新到你的本地仓库中了。 如果再想更新到远程仓库fork（B），只需要：</span>
<span class="token function">git</span> push origin master
</code></pre> 
<h5><a id="_116"></a>实操效果图：</h5> 
<p><img src="https://images2.imgbox.com/1b/92/B1NB7COh_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="22_commit1_118"></a>2.2 多个commit合并为1个</h4> 
<blockquote> 
 <p>一般来说，开源社区提交pr都是需要合并为一个commit的</p> 
</blockquote> 
<ol><li>比如，我现在有4个commit：</li></ol> 
<pre><code class="prism language-bash">85d5d8fa468b06bb9a62fafde01d80cbb7396682 <span class="token comment"># 我改的</span>

621ca4121f971d9604e395556763551427d799d9 <span class="token comment"># 我改的</span>

f744d2e91916ab7831f3a7695d1d1825916db164 <span class="token comment"># 我改的</span>

5c135e49e683563fa470d7f5c281050ec1d73af9 <span class="token comment"># 我改的</span>

295ac3b842b4ecb6eff1c9954a281a4606a8bc84 <span class="token comment"># 别人改的</span>
</code></pre> 
<ol start="2"><li>我现在想把我提交的commit合并为1个</li></ol> 
<pre><code class="prism language-bash">8403afe13664d6bb7f5a5557716a030e9389a944 <span class="token comment"># 我改的</span>

295ac3b842b4ecb6eff1c9954a281a4606a8bc84 <span class="token comment"># 别人改的</span>
</code></pre> 
<ol start="3"><li>具体操作方法</li></ol> 
<h5><a id="221_commitID_142"></a>2.2.1 方法一：合并commitID</h5> 
<blockquote> 
 <p>先从版本库回退内容到暂存区，再重新提交工作区的内容</p> 
 <ul><li>思路：使用 git reset --soft 回退版本库和暂存区的版本，同时保留工作区的变动，之后再重新提交工作区的内容就好了。</li></ul> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token comment"># 查看前10个commit【找到别人最后一次提交的位置】</span>
<span class="token function">git</span> log <span class="token parameter variable">-10</span>
<span class="token comment"># 从版本库恢复文件到暂存区，不改动工作区的内容</span>
<span class="token function">git</span> reset <span class="token parameter variable">--soft</span> 295ac3b842b4ecb6eff1c9954a281a4606a8bc84	<span class="token comment"># 别人改的commitID</span>
<span class="token comment"># add已经跟踪的文件</span>
<span class="token function">git</span> <span class="token function">add</span> <span class="token parameter variable">-u</span>
<span class="token comment"># 提交</span>
<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">"修改信息"</span>
<span class="token comment"># 强制push以替换远程仓的commitID</span>
<span class="token function">git</span> push <span class="token parameter variable">--force</span>
</code></pre> 
<blockquote> 
 <p>如果push失败，出现Reject，则需要开启分支强制合入的选项，取消分支保护。</p> 
 <ul><li>Settings -&gt; Repository -&gt; Protected Branches -&gt; Protected branch （找到分支） -&gt; Unprotect</li></ul> 
</blockquote> 
<h5><a id="222_git_rebase_162"></a>2.2.2 方法二：git rebase</h5> 
<pre><code class="prism language-bash"><span class="token comment"># 查看前10个commit</span>
<span class="token function">git</span> log <span class="token parameter variable">-10</span>
<span class="token comment"># 将4个commit压缩成一个commit</span>
<span class="token function">git</span> rebase <span class="token parameter variable">-i</span> HEAD~4	
<span class="token comment"># add已经跟踪的文件</span>
<span class="token function">git</span> <span class="token function">add</span> <span class="token parameter variable">-u</span>
<span class="token comment"># 提交</span>
<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">"修改信息"</span>
<span class="token comment"># 强制push以替换远程仓的commitID</span>
<span class="token function">git</span> push <span class="token parameter variable">--force</span>
</code></pre> 
<blockquote> 
 <p>注意：<code>git rebase</code> 会<code>临时</code>创建一个<code>新分支</code>进行，如果弄着出错了，可以 git checkout 原分支名 切换回原分支之后重新 git rebase。</p> 
</blockquote> 
<p>git rebase具体演示：</p> 
<blockquote> 
 <p>我想合并前四个 commit 到最后一个。如下所示：</p> 
</blockquote> 
<p>①git log 查看历史提交信息<br> <img src="https://images2.imgbox.com/1f/55/BMgmGqJL_o.png" alt="在这里插入图片描述"><br> ②git rebase -i HEAD~n</p> 
<blockquote> 
 <p>使用 git rebase -i HEAD~5 压缩5个commit为1个，或者git rebase -i 51efaef517abdbf674478de6073c12239d78a56a （第一个commit的id）</p> 
</blockquote> 
<p>vim编辑器，按i编辑，将后4个commit的pick修改为fixup，保留第一个pick。按esc键，输入:wq保存退出。</p> 
<ul><li> <p>pick：使用commit。</p> </li><li> <p>reword：使用commit，修改commit信息。</p> </li><li> <p>squash：使用commit，将commit信息合入上一个commit。</p> </li><li> <p>fixup：使用commit，丢弃commit信息。<br> <img src="https://images2.imgbox.com/09/23/oMuvB6bf_o.png" alt="在这里插入图片描述"><br> 操作完之后，发现commit都合并成了一个。<br> <img src="https://images2.imgbox.com/d7/04/lwzrkkoS_o.png" alt="在这里插入图片描述"><br> ③git push --force 提交<br> <img src="https://images2.imgbox.com/71/4b/ZPPZRoaw_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h3><a id="3__200"></a>3 必备命令</h3> 
<h4><a id="31_git_remote_201"></a>3.1 git remote相关</h4> 
<h6><a id="git_remote_add_alias_url_202"></a>git remote add [alias] [url]:添加远程仓库</h6> 
<h6><a id="git_remote_rm_alias_203"></a>git remote rm [alias]:删除远程仓库</h6> 
<h4><a id="32_git_fetch_205"></a>3.2 git fetch相关【拉取最新代码不合并】</h4> 
<h5><a id="git_fetch_testtestfetch_206"></a>git fetch test:从远程仓库test中fetch【有多个远程仓库则指定名字】</h5> 
<blockquote> 
 <p>如果本地git添加了多个远程仓库，则指定远程仓库名字</p> 
</blockquote> 
<h4><a id="33_git_pull_209"></a>3.3 git pull【拉取最新代码并合并】</h4> 
<h5><a id="git_pull_origin_15000origin15000_210"></a>git pull origin 1.5.000：从origin拉取1.5.000分支</h5> 
<blockquote> 
 <p>git pull = git fetch + git merge</p> 
</blockquote> 
<h4><a id="34_git_push_213"></a>3.4 git push</h4> 
<h6><a id="git_push_alias_branch__214"></a>git push [alias] [branch] ：推送到指定仓库的指定分支</h6> 
<h4><a id="35_git_rebase_216"></a>3.5 git rebase</h4> 
<h6><a id="git_rebase_continuerebase_217"></a>git rebase --continue：继续执行rebase</h6> 
<h6><a id="git_rebase_abortrebase_219"></a>git rebase --abort：放弃本次rebase</h6> 
<h6><a id="git_rebase_skipcommitcommit_221"></a>git rebase --skip：跳过本次commit（多个commit合并为一个）</h6> 
<h4><a id="36_git_cherrypick_commit_hash_223"></a>3.6 git cherry-pick commit_hash:应用指定分支提交</h4> 
<blockquote> 
 <ul><li>假设我们正在开发一个新功能，但是在开发过程中，发现另一个分支上的某个提交对我们的新功能也非常有用。但是我们不想将其整个分支合并到当前的分支上，只想选择性地将该提交应用到我们的分支上。这时，就可以使用git cherry-pick命令来实现。</li></ul> 
</blockquote> 
<p>比如：我现在在main修改了tool.go，并且提交到了本地。此时我需要发布1.5.000的版本，并且我需要将我main分支上修改的commit应用到1.5.000的分支上。</p> 
<pre><code class="prism language-bash"><span class="token comment"># 切到main，修改main分支上的代码，然后提交到本地</span>
<span class="token function">git</span> checkout main
<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">"xxxx"</span>
<span class="token comment"># git log -n 1 查看对应hash值，例：9ad702aa23664</span>
<span class="token comment">#此时我们想要将该提交应用到1.5.000的分支上</span>
<span class="token comment"># 切换到1.5.000的分支上，然后cherry-pick该提交，最后推送到1.5.000远端</span>
<span class="token function">git</span> chekout <span class="token number">1.5</span>.000
<span class="token function">git</span> cherry-pick 9ad702aa23664
<span class="token function">git</span> push
</code></pre> 
<blockquote> 
 <ul><li>git cherry-pick &lt;commit_hash&gt;，将 &lt;commit_hash&gt; 替换为您想要应用的本地提交的实际哈希值。如果您想要应用多个提交，可以指定多个&lt;commit_hash&gt;。 
   <ul><li>cherry-pick会产生新的commit</li></ul> </li></ul> 
</blockquote> 
<ul><li>如果发生冲突： 
  <ul><li>解决冲突之后，将冲突文件重新添加，并执行 git cherry-pick --continue命令，继续cherry-pick</li><li>git add &lt;conflicted_files&gt;<br> git cherry-pick --continue</li></ul> </li><li>git push &lt;remote_name&gt; &lt;remote_branch&gt;：将应用提交到远程</li></ul> 
<h5><a id="git_cherrypick_commit1_commit2_251"></a>①git cherry-pick commit1 commit2：一次应用多个提交</h5> 
<h5><a id="git_cherrypick_commit1commit2commit_252"></a>②git cherry-pick commit1^…commit2：应用commit区间</h5> 
<h5><a id="git_cherrypick_253"></a>③git cherry-pick代码冲突如何解决</h5> 
<ul><li>在cherry-pic多个commit时，可能会遇到代码冲突，这时cherry-pick会停下来，让用户决定如何继续操作。<br> <img src="https://images2.imgbox.com/55/45/5B1UrQ4h_o.png" alt="在这里插入图片描述"></li></ul> 
<blockquote> 
 <p>还是在feature分支上，现在需要把c、d、e都复制到master分支上:</p> 
 <ol><li>先把起点c和终点e的commitHash都记录下来。</li></ol> 
</blockquote> 
<p><img src="https://images2.imgbox.com/f3/d4/VsRIDQ7D_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <ol start="2"><li>切换到master分支上，使用区间cherry-pick可以看到c被成功复制，当进行到d时，发现代码冲突，cherry-pick被中断了，这时需要解决代码冲突，重新提交到暂存区。</li></ol> 
</blockquote> 
<p><img src="https://images2.imgbox.com/72/a2/7vabyI0y_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <ol start="3"><li>然后使用cherry-pick --continue让cherry-pick继续进行下去，最后e也被复制进来，整个流程就完成了。</li></ol> 
</blockquote> 
<p>以上就是解决cherry-pick冲突的完整流程。</p> 
<h5><a id="git_cherrypick_abortcherrypick_267"></a>④git cherry-pick --abort：放弃cherry-pick</h5> 
<blockquote> 
 <p>回到cherry-pick操作前的样子，就像什么都没发生过</p> 
</blockquote> 
<h5><a id="git_cherrypick_quitcommitcherrypick_269"></a>⑤git cherry-pick --quit：保留已经成功的commit，然后退出cherry-pick</h5> 
<blockquote> 
 <p>不回到操作前的样子，保留已经cherry-pick成功的commit，并退出cherry-pick流程。</p> 
</blockquote> 
<h4><a id="37_git_stash_276"></a>3.7 git stash命令</h4> 
<blockquote> 
 <p>有时我们在feature分支开发新需求时，突然被告知有线上bug，必须马上修复。而此时我们的功能刚好开发到一半，于是我们就必须要重新拉取正式版本的代码到本地，查看问题并修复。</p> 
 <ul><li>但如果我们本地的代码（我们功能刚好开发到一半）和线上代码冲突了，此时就可以使用<code>git stash</code>暂存代码了。</li></ul> 
</blockquote> 
<h5><a id="git_stash_save_commit_280"></a>①git stash save “备注内容”：保存当前未commit代码</h5> 
<h5><a id="git_stash_liststash_281"></a>②git stash list：列出所有stash记录</h5> 
<h5><a id="git_stash_applystash_282"></a>③git stash apply：应用最近一次的stash</h5> 
<h5><a id="git_stash_apply_stashstash_284"></a>④git stash apply stash@{对应数}：应用指定stash</h5> 
<pre><code class="prism language-bash"><span class="token comment"># 先列出所有记录</span>
<span class="token function">git</span> stash list
<span class="token comment"># 然后会看到如下记录</span>
stash@<span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span>:WIP on<span class="token punctuation">..</span>.
stash@<span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span>:WIP on<span class="token punctuation">..</span>.
stash@<span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span>:On<span class="token punctuation">..</span>.
<span class="token comment"># 应用第二条stash记录</span>
<span class="token function">git</span> stash apply stash@<span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span>
</code></pre> 
<p><code>pop、drop同理。</code></p> 
<h5><a id="git_stash_clearstash_296"></a>④git stash clear：删除所有stash记录</h5> 
<h5><a id="git_stash_dropstash_297"></a>⑤git stash drop：删除最近一次的stash</h5> 
<h4><a id="38_git_revert_299"></a>3.8 git revert命令</h4> 
<h5><a id="git_revert_commit_hashcommit_300"></a>①git revert commit_hash：撤销自己的commit</h5> 
<blockquote> 
 <p>有一天测试突然给你说，你开发上线的功能有问题，需要马上撤回，否则会影响到系统使用。这时你可能会想到用reset回退，可是你看了看分支上最新的提交有其他同事的代码，用reset会把这部分代码也撤回了。</p> 
 <ul><li>这个时候就需要用到<code>git revert</code>了</li></ul> 
</blockquote> 
<ol><li>找到自己提交的有bug的commit</li></ol> 
<p>现在master记录如下：</p> 
<pre><code class="prism language-bash"><span class="token comment"># 查看最近3次提交，记录自己的commit</span>
<span class="token function">git</span> log <span class="token parameter variable">-n</span> <span class="token number">3</span> 
</code></pre> 
<p><img src="https://images2.imgbox.com/74/ad/KbZ7vR1f_o.png" alt="在这里插入图片描述"><br> 2. git revert commitHash撤回提交</p> 
<pre><code class="prism language-bash"><span class="token comment"># 使用revert关掉自己的commit</span>
<span class="token function">git</span> revert 21dcxxxx
</code></pre> 
<ol start="3"><li>编辑提交信息<br> <img src="https://images2.imgbox.com/71/0c/1KtvnMdU_o.png" alt="在这里插入图片描述"></li></ol> 
<blockquote> 
 <p>因为revert会生成一条新的提交记录，这时会让你编辑提交信息，编辑完后<code>:wq</code>保存退出就好</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/86/07/KXvstWNP_o.png" alt="在这里插入图片描述"><br> 再来看下最新的log，生成了一条revert记录，<code>虽然自己之前的提交记录还会保留着，但是你修改的代码内容已经被撤回了。</code></p> 
<h4><a id="39_git_reflog_325"></a>3.9 git reflog：查看历史记录</h4> 
<blockquote> 
 <p>应用场景：某天你眼花，发现自己在其他人分支提交了代码还推到远程分支，这时因为分支只有你的最新提交，就想着使用reset --hard，结果紧张不小心记错了 commitHash，reset 过头，把同事的 commit 搞没了。没办法，reset --hard是强制回退的，找不到 commitHash 了，只能让同事从本地分支再推一次（同事瞬间拳头就硬了，怎么又是你）。于是，你的技术形象又一落千丈。</p> 
</blockquote> 
<ol><li>分支记录如下：我们想要reset到b<br> <img src="https://images2.imgbox.com/22/97/JdGw7s1r_o.png" alt="在这里插入图片描述"></li><li>但是由于我们的误操作，reset过头，b没了，最新的只剩a了<br> <img src="https://images2.imgbox.com/8e/35/i71yMc4c_o.png" alt="在这里插入图片描述"></li><li>这时，就需要使用git reflog查看历史记录，把错误提交的那次commitHash记下来。<br> <img src="https://images2.imgbox.com/a9/b0/mw68w7zg_o.png" alt="在这里插入图片描述"></li><li>记录下误操作的commitHash之后，再reset回去，就会发现b回来了</li></ol> 
<p><img src="https://images2.imgbox.com/75/a9/gG56dBNQ_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="310_git_diff__337"></a>3.10 git diff 命令</h4> 
<h5><a id="git_diff_338"></a>①git diff：查看工作区与暂存区所有文件差异</h5> 
<h5><a id="git_diff__340"></a>②git diff 文件名(可多个文件，空格分割)：查看某个文件在工作区与暂存区差异</h5> 
<h5><a id="git_diff_cached_342"></a>③git diff --cached：查看暂存区与上一次提交的差异</h5> 
<h5><a id="git_diff_cached_commitID_343"></a>④git diff --cached commitID：查看暂存区与指定版本之间的所有文件差异</h5> 
<h5><a id="git_diff_cached_1_2HEAD_345"></a>⑤git diff --cached 文件名1 文件名2…:查看暂存区与HEAD之间文件差异</h5> 
<h5><a id="git_diff_cached___346"></a>⑥git diff --cached 版本号 文件名（多个，空格分割）</h5> 
<pre><code class="prism language-bash"><span class="token comment"># 查看暂存区的Register.vue与9c32de8b9c84b8edbcbd615e7662316008e7b5dc版本中的Register.vue的区别</span>
<span class="token function">git</span> <span class="token function">diff</span> <span class="token parameter variable">--cached</span> 9c32de8b9c84b8edbcbd615e7662316008e7b5dc  src/pages/Register.vue
</code></pre> 
<h4><a id="_354"></a>实战：</h4> 
<h5><a id="1_pr_355"></a>1 提交pr</h5> 
<pre><code class="prism language-bash"><span class="token comment"># 将fork出来的仓库clone到本地（自己的仓库）</span>
<span class="token function">git</span> clone git@github.com:xxxxx/local.git
<span class="token comment"># 查看仓库情况</span>
<span class="token function">git</span> remote <span class="token parameter variable">-v</span> 
<span class="token comment"># 添加自己fork的那个仓库（公司的仓库地址）</span>
<span class="token function">git</span> remote <span class="token function">add</span> upstream git@github.xxxxx/company.git

<span class="token comment"># 从upstream/main分支上新建一个upstream-local本地分支，并切换到该分支</span>
<span class="token function">git</span> checkout <span class="token parameter variable">-b</span> upstream-local upstream/main

<span class="token comment"># 将upsream/main分支上的提交rebase(同步)到本地</span>
<span class="token function">git</span> fetch upstream
<span class="token function">git</span> rebase upstream/main
 
 <span class="token comment"># 将本地提交push到远程，然后我们就可以在github的upstream-loca分支上提交pr了</span>
 <span class="token function">git</span> push --set-upstream origin
</code></pre> 
<h5><a id="2_git_reflogrollback_374"></a>2 git reflog：恢复自己rollback掉的文件</h5> 
<blockquote> 
 <p>git不小心将已经提交的记录rollback了，恢复步骤：<br> 演示：本地修改了一个文件， 然后commit到本地</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/50/ad/Mbql1IE4_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash"><span class="token comment">#查看提交记录</span>
<span class="token function">git</span> log <span class="token parameter variable">-n</span> <span class="token number">5</span> <span class="token parameter variable">--oneline</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/35/12/mvOJ4cdU_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>这个时候由于某些原因，我需要reset分支，然后将本地修改合并为1个</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token function">git</span> reset <span class="token parameter variable">--soft</span> commitID
<span class="token comment"># 查看要reset的commitId</span>
<span class="token comment"># git log -n 5 --oneline</span>
<span class="token comment"># reset到指定位置</span>
<span class="token comment"># git reset --soft 40359bc0c1b630a88d1e1aaaac1ae71999085059 </span>

<span class="token comment"># 查看最近5次提交记录，发现之前的commit已经不存在了，成功reset到了4039xx的记录</span>
<span class="token comment"># git log -n 5 --oneline</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0a/b8/SDTsG3py_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/84/27/E0532H3y_o.png" alt="在这里插入图片描述"><br> 这个时候意外发生了，由于我们这常年的风湿老手，导致点错了，点成了rollback，丢失了我们本地的提交<br> <img src="https://images2.imgbox.com/f2/16/96LI4BDY_o.png" alt="在这里插入图片描述"><br> 我们不小心丢失了我们本地的提交：<br> <img src="https://images2.imgbox.com/2c/05/5Q7kOUtg_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>不要慌不要急，补救措施来了，神级命令：reflog</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/8a/c4/0wnASi7b_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>这个时候我们要撤销我们的rollback操作，直接找到rollback的前一个commitId（为61xxx）</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token function">git</span> reset <span class="token parameter variable">--hard</span> 61a10660
</code></pre> 
<p><img src="https://images2.imgbox.com/99/b7/YLYcVxTy_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="tips_416"></a>tips：</h4> 
<h5><a id="gitalias_417"></a>设置git短命令（alias）</h5> 
<blockquote> 
 <p>对于喜欢敲命令的程序员来说，设置alias可以很好提高工作效率</p> 
</blockquote> 
<p>方式一：</p> 
<pre><code class="prism language-bash"><span class="token comment"># 将push设置为ps</span>
<span class="token function">git</span> config <span class="token parameter variable">--global</span> alias.ps push
</code></pre> 
<p>方式二：</p> 
<pre><code class="prism language-bash"><span class="token comment"># 打开全局配置文件</span>
<span class="token function">vim</span> ~/.gitconfig

<span class="token comment"># 写入如下内容</span>
<span class="token punctuation">[</span>alias<span class="token punctuation">]</span>
	co <span class="token operator">=</span> checkout
	<span class="token function">ps</span> <span class="token operator">=</span> push
	pl <span class="token operator">=</span> pull
	mer <span class="token operator">=</span> merge --no-ff
	<span class="token function">cp</span> <span class="token operator">=</span> cherry-pick
</code></pre> 
<blockquote> 
 <p>git merge --no-ff</p> 
 <ul><li>由于–no-ff选项参数会产生合并提交，因此可以在提交历史中清晰地看到每次合并的情况，这样可以更容易地追溯每次合并的来源，以及跟踪问题和进行代码审核等。</li></ul> 
</blockquote> 
<p>参考：https://www.jianshu.com/p/021bb953ee8d</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d6d32ebbca0928d6578ea848df4c87bf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">云原生技术简介</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9da882ac731fcb5aebf34734327f5eeb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Flutter android及ios屏幕调整</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>