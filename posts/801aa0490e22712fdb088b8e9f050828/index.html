<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue 的ant design的Switch开关不支持二次确认，自定义封装 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue 的ant design的Switch开关不支持二次确认，自定义封装" />
<meta property="og:description" content="原因：切换switch会直接触发状态改变，二次弹窗无法使用
实现效果图：
一、使用步骤
1.封装SwitchButton组件 代码如下：新建一个SwitchButton.vue的文件，最好放在公共组件中，也是方便后续使用
&lt;template&gt; &lt;div :class=&#34;[&#39;d-switch&#39;, { &#39;is-checked&#39;: checked }]&#34;&gt; &lt;input class=&#34;d-switch__input&#34; ref=&#34;input&#34; type=&#34;checkbox&#34; :checked=&#34;checked&#34; @change=&#34;handleInput&#34; :true-value=&#34;props.trueValue&#34; :false-value=&#34;props.falseValue&#34; /&gt; &lt;span :class=&#34;[&#39;d-switch__label&#39;, { &#39;is-checked&#39;: checked }]&#34;&gt; {{ checked ? props.trueName : props.falseName }} &lt;/span&gt; &lt;span class=&#34;d-switch_action&#34;&gt;&lt;/span&gt; &lt;/div&gt; &lt;/template&gt; &lt;script setup&gt; import { computed, ref, nextTick } from &#39;vue&#39;; const props = defineProps({ modelValue: { // 绑定值 type: [Number, String, Boolean], }, modelRecord: { // 绑定的json type: Object, }, trueValue: { // switch 打开时的值 type: [Number, String, Boolean], default: true, }, falseValue: { // switch 关闭时的值 type: [Number, String, Boolean], default: true, }, trueName: { // switch 打开时显示的文字 type: String, default: &#39;开&#39;, }, falseName: { // switch 关闭时显示的文字 type: String, default: &#39;关&#39;, }, }); const emits = defineEmits([&#39;update:modelValue&#39;, &#39;change&#39;]); const input = ref(null); // 判断当前组件是否是打开状态 const checked = computed(() =&gt; { // 因为可以自定义打开和关闭的值 所以这里必须判断 v-model绑定的值 === 组件自定义打开的值 return props." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/801aa0490e22712fdb088b8e9f050828/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-01T16:59:57+08:00" />
<meta property="article:modified_time" content="2022-11-01T16:59:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue 的ant design的Switch开关不支持二次确认，自定义封装</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2><a id="_0"></a></h2> 
<p><code>原因：切换switch会直接触发状态改变，二次弹窗无法使用</code></p> 
<p><code>实现效果图：</code></p> 
<p style="text-align:center;"><code><img alt="" src="https://images2.imgbox.com/7b/d3/u352GeAl_o.jpg"></code></p> 
<p></p> 
<p><strong>一、使用步骤</strong></p> 
<h3><a id="1_27"></a>1.封装SwitchButton组件</h3> 
<blockquote> 
 <p>代码如下：新建一个SwitchButton.vue的文件，最好放在公共组件中，也是方便后续使用</p> 
</blockquote> 
<pre><code class="language-html">&lt;template&gt;
  &lt;div :class="['d-switch', { 'is-checked': checked }]"&gt;
    &lt;input
      class="d-switch__input"
      ref="input"
      type="checkbox"
      :checked="checked"
      @change="handleInput"
      :true-value="props.trueValue"
      :false-value="props.falseValue"
    /&gt;
    &lt;span :class="['d-switch__label', { 'is-checked': checked }]"&gt;
      {<!-- -->{ checked ? props.trueName : props.falseName }}
    &lt;/span&gt;
    &lt;span class="d-switch_action"&gt;&lt;/span&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { computed, ref, nextTick } from 'vue';

const props = defineProps({
  modelValue: {
    // 绑定值
    type: [Number, String, Boolean],
  },
  modelRecord: {
    // 绑定的json
    type: Object,
  },
  trueValue: {
    // switch 打开时的值
    type: [Number, String, Boolean],
    default: true,
  },
  falseValue: {
    // switch 关闭时的值
    type: [Number, String, Boolean],
    default: true,
  },
  trueName: {
    // switch 打开时显示的文字
    type: String,
    default: '开',
  },
  falseName: {
    // switch 关闭时显示的文字
    type: String,
    default: '关',
  },
});

const emits = defineEmits(['update:modelValue', 'change']);

const input = ref(null);

// 判断当前组件是否是打开状态
const checked = computed(() =&gt; {
  // 因为可以自定义打开和关闭的值 所以这里必须判断 v-model绑定的值 === 组件自定义打开的值
  return props.modelValue === props.trueValue;
});

//input事件 获取当前input事件
const handleInput = () =&gt; {
  nextTick(() =&gt; {
    const val = input.value.checked;
    emits('update:modelValue', val);
    emits('change', props.modelRecord);
  });
};
&lt;/script&gt;

&lt;style lang="less" scoped&gt;
.d-switch {
  position: relative;
  height: 22px;
  transition: background 0.2s;
  width: 44px;
  background: #00000040;
  border-radius: 100px;
  display: inline-flex;
  align-items: center;
  vertical-align: middle;
  .d-switch__input {
    position: relative;
    z-index: 1;
    margin: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    cursor: pointer;
  }
  .d-switch_action {
    position: absolute;
    transition: 0.2s;
    left: 2px;
    top: 2px;
    z-index: 0;
    height: 18px;
    width: 18px;
    background: #fff;
    border-radius: 50%;
  }
  &amp;.is-checked {
    background-color: #1890ff;
    .d-switch_action {
      left: 100%;
      background: #fff;
      margin-left: -20px;
    }
  }
  .d-switch__label {
    position: absolute;
    margin: 0 7px 0 25px;
    color: #fff;
    font-size: 12px;
    transition: margin 0.2s;
    &amp;.is-checked {
      margin: 0 25px 0 7px;
    }
  }
}
&lt;/style&gt;
</code></pre> 
<h3><a id="2_41"></a>2.引入SwitchButton</h3> 
<pre><code class="language-html">import SwitchButton from '@/views/Common/SwitchButton';</code></pre> 
<h3>3.html中SwitchButton使用</h3> 
<pre><code class="language-html">&lt;SwitchButton
            :modelValue="record.status"
            :modelRecord="record"
            :trueValue="1"
            :falseValue="0"
            @change="change(record)"
          &gt;&lt;/SwitchButton&gt;</code></pre> 
<p> siwtch中调用@change中的方法</p> 
<pre><code class="language-html">const change = async (record) =&gt; {
  let str = record.status ? '关闭' : '启用';
  Modal.confirm({
    title: `确认${str}状态吗?`,
    icon: createVNode(ExclamationCircleOutlined),
    async onOk() {
      let params = {
        status: record.status ? 0 : 1,
        id: record.id,
      };
      let res = await setEditAccessInfo(params).catch(() =&gt; {
        message.error(`${str}失败`);
      });
      if (res) {
        record.status = record.status ? 0 : 1;
        message.success(`${str}成功`);
      }
    },
    onCancel() {},
  });
  return record;
};</code></pre> 
<hr> 
<h2><a id="_55"></a>总结</h2> 
<p>先二次确认提示，再改变状态</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6845e6fe2340073670427fb512e1453b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux：SSH密钥认证登录</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7392bbb0aac0e45f3b721bf23ca08054/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">a-table</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>