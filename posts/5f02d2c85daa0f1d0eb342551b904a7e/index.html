<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>perl 用 XML::LibXML DOM 解析 Freeplane.mm文件，生成测试用例.csv文件 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="perl 用 XML::LibXML DOM 解析 Freeplane.mm文件，生成测试用例.csv文件" />
<meta property="og:description" content="Freeplane 是一款基于 Java 的开源软件，继承 Freemind 的思维导图工具软件，它扩展了知识管理功能，在 Freemind 上增加了一些额外的功能，比如数学公式、节点属性面板等。
在云计算中，解析XML元素和属性是一种常见的操作，因为XML是一种常见的数据交换格式，可以用来表示各种不同的数据结构和信息。Perl 是一种过去流行的脚本语言，可以用来处理各种文本数据，包括XML数据。
在Perl 中，可以使用各种模块和函数来解析 XML元素和属性。其中，最常用的模块是 XML::LibXML，它提供了一组完整的XML解析和处理函数，可以非常方便地解析XML文档中的元素和属性。
例如，下面是一个使用 XML::LibXML 模块 DOM方式 解析 XML元素和属性 的示例代码：
编写 test_LibXML_dom.pl 如下
#!/usr/bin/perl use 5.010; use strict; use warnings; use utf8; use XML::LibXML; # 解析 Freeplane.mm文件，生成测试用例.csv文件 # xt: 应用系统名的英文或拼音缩写 # testno: 测试用例编号 # zd?: 字段?的拼音缩写 # zd1: 模块名 # zd2: 功能名 # zd3: 正向 或 反向 # zd4: 测试要点 # zd5: 执行步骤 # zd6: 预期结果 # csylms:测试用例描述 if ($#ARGV !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/5f02d2c85daa0f1d0eb342551b904a7e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-15T21:16:16+08:00" />
<meta property="article:modified_time" content="2024-03-15T21:16:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">perl 用 XML::LibXML DOM 解析 Freeplane.mm文件，生成测试用例.csv文件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>Freeplane 是一款基于 Java 的开源软件，继承 Freemind 的思维导图工具软件，它扩展了知识管理功能，在 Freemind 上增加了一些额外的功能，比如数学公式、节点属性面板等。</p> 
<p>在云计算中，解析XML元素和属性是一种常见的操作，因为XML是一种常见的数据交换格式，可以用来表示各种不同的数据结构和信息。Perl 是一种过去流行的脚本语言，可以用来处理各种文本数据，包括XML数据。</p> 
<p>在Perl 中，可以使用各种模块和函数来解析 XML元素和属性。其中，最常用的模块是  XML::LibXML，它提供了一组完整的XML解析和处理函数，可以非常方便地解析XML文档中的元素和属性。</p> 
<p>例如，下面是一个使用 XML::LibXML 模块 DOM方式 解析 XML元素和属性 的示例代码：</p> 
<p>编写  test_LibXML_dom.pl  如下</p> 
<pre><code class="language-perl">#!/usr/bin/perl
use 5.010;
use strict;
use warnings;
use utf8;
use XML::LibXML;

# 解析 Freeplane.mm文件，生成测试用例.csv文件
#  xt: 应用系统名的英文或拼音缩写
# testno: 测试用例编号
# zd?: 字段?的拼音缩写
# zd1: 模块名
# zd2: 功能名
# zd3: 正向 或 反向
# zd4: 测试要点
# zd5: 执行步骤
# zd6: 预期结果
# csylms:测试用例描述

if ($#ARGV != 0){
    die "You must specify a file.xml to parse";
}
my $file = shift @ARGV;

# 创建一个XML解析器对象
my $p = XML::LibXML-&gt;new();

# 解析XML文档
my $dom = $p-&gt;load_xml(location =&gt; $file)
         or die "cannot read file.xml\n";

my $f2 = $file .'.csv';
# 写入文件
open(my $fw, '&gt;:encoding(UTF-8)', $f2) or die "cannot open file '$f2' $!";
print $fw "应用系统名,模块名,测试用例描述,正反向,执行步骤,预期结果\n";

# 要检查一个字符串是否以另一个字符串开始，可使用字符串比较：
sub startsWith {  
    my ($str, $prefix) = @_;  
    return substr($str,0, length($prefix)) eq $prefix;
} 

my $root = $dom-&gt;documentElement;
my($node) = $root-&gt;getChildrenByTagName('node');
say '$node is a ', ref($node);

#获取某个节点的TEXT属性和属性值
sub getAttribute {
    my($node) = @_;
    my @attrs = $node-&gt;attributes();
    my $txt ='';
    foreach my $attr (@attrs) {
      if( $attr-&gt;nodeName() eq 'TEXT'){
        $txt = $attr-&gt;value();
        $txt =~s/\s+$//;
      }    
    }
    return $txt;
}
my $xt = getAttribute($node);
#print $xt; 
my ($zd1,$zd2,$zd3,$zd4,$zd5,$zd6,$txt,$csylms);
$zd5 =''; $zd6 ='';
#my @childs = $node-&gt;childNodes;
foreach my $node1 ($node-&gt;childNodes){
  if( $node1-&gt;nodeName() eq 'node'){
    $zd1 = getAttribute($node1);
    foreach my $node2 ($node1-&gt;childNodes){
      if( $node2-&gt;nodeName() eq 'node'){
        $zd2 = getAttribute($node2);
        foreach my $node3 ($node2-&gt;childNodes){
          if( $node3-&gt;nodeName() eq 'node'){
            $zd3 = getAttribute($node3);
            foreach my $node4 ($node3-&gt;childNodes){
              if( $node4-&gt;nodeName() eq 'node'){
                $zd4 = getAttribute($node4);
                foreach my $node5 ($node4-&gt;childNodes){
                  if( $node5-&gt;nodeName() eq 'node'){
                    $txt = getAttribute($node5);
                    if (startsWith($txt, '步骤：')){
                      $zd5 = substr($txt, 3);
                    } elsif (startsWith($txt, '预期结果：')){
                      $zd6 = substr($txt, 5);
                      $csylms = $zd2 .'-'. $zd4; # 测试用例描述
                      print $fw "$xt,$zd1,$csylms,$zd3,$zd5,$zd6\n";
                    } else {
                      $zd5 =''; $zd6 ='';
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
close($fw);
</code></pre> 
<p>注意关键这一句：my $dom = $p-&gt;load_xml(location =&gt; $file)；<br> 上一篇对应这句：my $doc = $parser-&gt;parse_file($file);</p> 
<p>运行 perl test_LibXML_dom.pl your_test.mm </p> 
<pre><code class="language-perl">应用系统名,模块名,测试用例描述,正反向,执行步骤,预期结果
应用系统,模块1,功能11-测试要点111,正向,1.步骤,1.结果
应用系统,模块1,功能11-测试要点112,正向,2.步骤,2.结果
应用系统,模块1,功能11-要点111,反向,3.步骤,3.结果
应用系统,模块1,功能11-要点112,反向,4.步骤,4.结果
应用系统,模块2,功能21-测试要点211,正向,5.步骤,5.结果
应用系统,模块2,功能21-测试要点212,正向,6.步骤,6.结果
应用系统,模块2,功能21-要点211,反向,7.步骤,7.结果
应用系统,模块2,功能21-要点212,反向,8.步骤,8.结果
</code></pre> 
<p style="text-align:center;">参阅：<a href="http://grantm.github.io/perl-libxml-by-example/dom.html" rel="nofollow" title="The Document Object Model — Perl XML::LibXML by Example  documentation">The Document Object Model — Perl XML::LibXML by Example documentation</a></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/97/a7/g1qjWNCN_o.png"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9e066b25950656fc7f8b6689289764f5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Elasticsearch(11) intervals的使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a9576b4f10ab87dd24ceae99fe8574f1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">DVWA靶场-CSRF跨站请求伪造</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>