<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>5T的个人云盘可真香，你确定不来？OneDrive&#43;OneIndex无敌组合 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="5T的个人云盘可真香，你确定不来？OneDrive&#43;OneIndex无敌组合" />
<meta property="og:description" content="OneIndex 个人整合了“0oVicero0”和“Zisbusy”两位大佬的2020全新版本，内附Microsoft2020最新应用API使用方法。此项目针对于国际版（反正不是世纪互联那个版本，至于怎么改世纪互联版本看简介吧），下载后需要自己改动几处地方，还差一个网站图标没有加上，后期解决了会追加。
参考项目预览地址： 0oVicero0大佬项目
Zisbusy大佬项目地址
我的项目
功能： 不用服务器空间，不走服务器流量直接列onedrive目录，文件直链下载可做图床，可预览文件，功能强大 一键安装（Debian 8）： wget --no-check-certificate -qO- https://github.com/0oVicero0/oneindex/raw/master/install.sh |bash 添加 Redis 支持（Debian 8）： # 安装 redis 支持 apt-get install -y redis-server php5-redis # 重启 fcgiwrap-php 进程 bash /etc/init.d/fcgiwrap-php restart # 后台选择 redis 模式, 并更新缓存. 创意整合： 极大简化安装步骤。一些样式美化修改。分页模式，加快页面预览速度。创意来自oneindex-h可后台自定义网站主标题,副标题。可后台自定义每页显示项目数量。对于flac格式音乐加入图标显示对于页面顶部添加动态效果美化添加了针对Apache服务器的伪静态配合文件（.htaccess），后台开启伪静态即可去掉/?/ 安装： 由于整合了美化，需要做一些改动，再进行安装
打开 view/nexmoe目录 下 的layout.php文件
修改 第7行 、第9行 第19行 download.99couple.top 为自己下载站的域名（或者自己引用的目录）
修改 第15行 链接里的81895257为自己QQ（或者自己引用的图片）
修改18行的99couple.top为自己的博客域名，没有就还填下载站域名呗，小问题
打开 theme目录 下 style.css 文件
修改 第97行、第103行 download.99couple.top 为自己域名（或者自己引用的目录）
至此美化改动完成
针对于拥有个人下载站域名的同学来说，我们不应该中转到别人的域名下，加以如下修改" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/f4d3340ddd7f13740039780020da0b65/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-07-12T12:06:36+08:00" />
<meta property="article:modified_time" content="2020-07-12T12:06:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">5T的个人云盘可真香，你确定不来？OneDrive&#43;OneIndex无敌组合</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="OneIndex_2"></a>OneIndex</h2> 
<p>个人整合了“0oVicero0”和“Zisbusy”两位大佬的2020全新版本，内附Microsoft2020最新应用API使用方法。此项目针对于国际版（反正不是世纪互联那个版本，至于怎么改世纪互联版本看简介吧），下载后需要自己改动几处地方，还差一个网站图标没有加上，后期解决了会追加。</p> 
<h3><a id="_6"></a>参考项目预览地址：</h3> 
<p><a href="https://github.com/0oVicero0/oneindex">0oVicero0大佬项目</a><br> <a href="https://github.com/Zisbusy/OneIndex-theme">Zisbusy大佬项目地址</a><br> <a href="https://download.99couple.top/" rel="nofollow">我的项目</a></p> 
<h3><a id="_12"></a>功能：</h3> 
<ul><li>不用服务器空间，不走服务器流量</li><li>直接列onedrive目录，文件直链下载</li><li>可做图床，可预览文件，功能强大</li></ul> 
<h3><a id="Debian_8_18"></a>一键安装（Debian 8）：</h3> 
<pre><code>wget --no-check-certificate -qO- https://github.com/0oVicero0/oneindex/raw/master/install.sh |bash
</code></pre> 
<h3><a id="_Redis_Debian_8_24"></a>添加 Redis 支持（Debian 8）：</h3> 
<pre><code># 安装 redis 支持
apt-get install -y redis-server php5-redis
# 重启 fcgiwrap-php 进程
bash /etc/init.d/fcgiwrap-php restart
# 后台选择 redis 模式, 并更新缓存.
</code></pre> 
<h3><a id="_34"></a>创意整合：</h3> 
<ol><li>极大简化安装步骤。</li><li>一些样式美化修改。</li><li>分页模式，加快页面预览速度。创意来自<a href="https://github.com/hang666/oneindex-h">oneindex-h</a></li><li>可后台自定义网站主标题,副标题。</li><li>可后台自定义每页显示项目数量。</li><li>对于flac格式音乐加入图标显示</li><li>对于页面顶部添加动态效果美化</li><li>添加了针对Apache服务器的伪静态配合文件（.htaccess），后台开启伪静态即可去掉/?/</li></ol> 
<h3><a id="_45"></a>安装：</h3> 
<ol><li> <p>由于整合了美化，需要做一些改动，再进行安装</p> 
  <ul><li> <p>打开 <code>view/nexmoe目录</code> 下 <code>的layout.php</code>文件</p> </li><li> <p>修改 第7行 、第9行 第19行 download.99couple.top 为自己下载站的域名（或者自己引用的目录）</p> </li><li> <p>修改 第15行 链接里的<code>81895257</code>为自己QQ（或者自己引用的图片）</p> <p>修改18行的<code>99couple.top</code>为自己的博客域名，没有就还填下载站域名呗，小问题</p> </li><li> <p>打开 <code>theme目录</code> 下 <code>style.css</code> 文件</p> </li><li> <p>修改 第97行、第103行 download.99couple.top 为自己域名（或者自己引用的目录）</p> </li><li> <p>至此美化改动完成</p> </li></ul> </li><li> <p>针对于拥有个人下载站域名的同学来说，我们不应该中转到别人的域名下，加以如下修改</p> 
  <ul><li>打开<code>controller/AdminController.php</code>文件</li><li>修改163行引号内的地址为你的下载站地址，必须是HTTPS协议的，微软强制。</li></ul> </li><li> <p>针对于国内比较富裕的同学可以直接重金包月续订世纪互联版本（不是世纪互联版本的自动跳过这一条）</p> 
  <ul><li>首先声明世纪互联版本确实快，因为数据中心就在国内，峰值达到4MB/s没问题。而国际版的小伙伴，就不要强求了，你的峰值再高也不可能高过世纪互联版本的用户的。</li><li>打开根目录下的index.php文件</li><li>将6、7行的注释去掉</li><li>这样我们在获取应用ID和应用密钥的时候是跳转到世纪互联代理的网站来登录的</li><li>别问我知道的，因为你国际版的账户ID根本不在世纪互联的库里面，如果国际版的小伙伴也将注释去掉，你在获取应用ID时登录你的账户时，会提示你没有这个用户。</li><li>对了，大佬在魔改原版OneIndex时去掉了获取应用ID和密钥的跳转按钮，附上新版链接（微软已经于2020年强制应用注册接入Microsoft Azure了，有兴趣的小伙伴可以搜索相关知识）</li><li><a href="https://portal.azure.com/#home" rel="nofollow">新版Microsoft Azure链接</a></li></ul> </li><li> <p>我们先来打开新版Microsoft Azure链接来注册应用</p> 
  <ul><li>打开Azure Active Directory</li><li><img src="https://images2.imgbox.com/34/a1/P6FDd26Y_o.png" alt="image-20200712114327996"></li><li>注册新的应用</li><li><img src="https://images2.imgbox.com/98/f2/X6UAJvJR_o.png" alt="image-20200712114504362"></li><li><img src="https://images2.imgbox.com/e3/80/vVQQNoiW_o.png" alt="img-MheLLYkf-1594526637683"></li><li><img src="https://images2.imgbox.com/74/16/3FrNSEZB_o.png" alt="image-20200712114904574"></li><li><img src="https://images2.imgbox.com/94/55/7KTaeueK_o.png" alt="image-20200712115137320"></li><li><img src="https://images2.imgbox.com/de/53/9TjAsJkA_o.png" alt="image-20200712115304012"></li><li><img src="https://images2.imgbox.com/82/43/w19vsFuB_o.png" alt="image-20200712115445024"></li><li>到这里应用ID和密钥就注册完了</li></ul> </li><li> <p>安装OneIndex程序</p> 
  <ul><li>这个程序安装就不写了，网上多的很，就是把项目文件全部丢进你网站目录下面</li><li>现在主要麻烦的就是这个应用ID和密钥强制接入Microsoft Azure了</li><li>还有啥不懂的可以私信我哈。</li></ul> </li><li> <p>安装完会是这样，也可以点上面的预览链接去看看</p> </li></ol> 
<p><img src="https://images2.imgbox.com/31/e8/OvV2Nexp_o.png" alt="img-skQKbNNE-1594526637699">]</p> 
<h3><a id="_103"></a>重新安装：</h3> 
<p>删除 oneindex/config 下的所有文件即可.<br> 一键安装的地址: /var/www/oneindex/config</p> 
<h3><a id="change_log_108"></a>change log:</h3> 
<p>18-03-29: 更新直链获取机制、缓存机制，避免频繁访问的token失效<br> 18-03-29: 解决非英文编码问题<br> 18-03-29: 添加onedrive共享的起始目录 功能<br> 18-03-29: 添加rewrite的配置文件<br> 18-03-29: 增加sqlite模式cache支持<br> 18-03-29: 添加缩略图功能<br> 18-03-29: 添加404判断<br> 18-03-31: 添加console<br> 18-04-13: 修复特殊文件名无法下载问题<br> 18-04-13: 添加命令行上传功能<br> 18-04-16: 更新 2.0 beta<br> 18-04-16: 更新展示界面<br> 18-04-16: 响应式，支持小屏设备<br> 18-04-16: 图片在线预览<br> 18-04-16: 视频在线播放<br> 18-04-16: 代码在线查看（js、css、html、sh、php、java、md等）<br> 18-04-16: README.md 支持，解析各目录下(onedirive目录下) README.md 文件，在页面尾部展示。<br> 18-04-18: 音频在线播放<br> 18-04-18: HEAD.md 支持，在页面头部展示<br> 18-04-18: .password 文件夹加密<br> 18-05-06: 在线视频播放器替换成 Dplayer<br> 18-05-06: 在线视频播放支持’mp4’,‘webm’,‘avi’,‘mpg’, ‘mpeg’, ‘rm’, ‘rmvb’, ‘mov’, ‘wmv’, ‘mkv’, ‘asf’<br> 18-06-01: 支持个人账号<br> 18-06-01: cli文件夹上传（单线程）<br> 18-06-01: 管理后台(后台地址:?/admin 默认密码:oneindex)<br> 18-06-01: 不同后缀展示设置<br> 18-06-01: 文件直接输出<br> 18-06-01: 文件上传管理（后台）<br> 18-06-01: 增加index.html特性<br> 18-06-01: 图床功能</p> 
<h3><a id="_141"></a>需求：</h3> 
<p>1、PHP空间，PHP 5.6+ 打开curl支持<br> 2、onedrive 账号 (个人、企业版或教育版/工作或学校帐户)<br> 3、oneindex 程序</p> 
<h3><a id="_147"></a>计划任务：</h3> 
<p>[可选]<strong>推荐配置</strong>，非必需。后台定时刷新缓存，可增加前台访问的速度</p> 
<pre><code># 每小时刷新一次token
0 * * * * /具体路径/php /程序具体路径/one.php token:refresh

# 每十分钟后台刷新一遍缓存
*/10 * * * * /具体路径/php /程序具体路径/one.php cache:refresh
</code></pre> 
<h3><a id="_159"></a>特殊文件实现功能：</h3> 
<p><code>README.md</code>、<code>HEAD.md</code> 、 <code>.password</code>特殊文件使用</p> 
<p>可以参考<a href="https://github.com/0oVicero0/oneindex/tree/files">https://github.com/0oVicero0/oneindex/tree/files</a></p> 
<p><strong>在文件夹底部添加说明:</strong></p> 
<blockquote> 
 <p>在onedrive的文件夹中添加<code>README.md</code>文件，使用markdown语法。</p> 
</blockquote> 
<p><strong>在文件夹头部添加说明:</strong></p> 
<blockquote> 
 <p>在onedrive的文件夹中添加<code>HEAD.md</code> 文件，使用markdown语法。</p> 
</blockquote> 
<p><strong>加密文件夹:</strong></p> 
<blockquote> 
 <p>在onedrive的文件夹中添加<code>.password</code>文件，填入密码，密码不能为空。</p> 
</blockquote> 
<p><strong>直接输出网页:</strong></p> 
<blockquote> 
 <p>在onedrive的文件夹中添加<code>index.html</code> 文件，程序会直接输出网页而不列目录。<br> 配合 文件展示设置-直接输出 效果更佳</p> 
</blockquote> 
<h3><a id="_182"></a>命令行功能：</h3> 
<p>仅能在php cli模式下运行<br> <strong>清除缓存:</strong></p> 
<pre><code>php one.php cache:clear
</code></pre> 
<p><strong>刷新缓存:</strong></p> 
<pre><code>php one.php cache:refresh
</code></pre> 
<p><strong>刷新令牌:</strong></p> 
<pre><code>php one.php token:refresh
</code></pre> 
<p><strong>上传文件:</strong></p> 
<pre><code>php one.php upload:file 本地文件 [onedrive文件]
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1b315c8017cc9bf54260cade49773db2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">最新版配置Microsoft Azure之后利用Aria2&#43;AriaNg&#43;Onedrive&#43;OneIndex搭建私人网盘</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0f39b59422d2ec6f0cb78833e2ff5979/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[LeetCode]（面试题30）包含min函数的栈</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>