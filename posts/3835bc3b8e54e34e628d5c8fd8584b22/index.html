<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ORM常见问题 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ORM常见问题" />
<meta property="og:description" content="ORM常见问题解答 前言
​ 结构体标签（tag）在 xorm 和 gorm 中都是用于定义数据库表和结构体字段之间映射关系的，但是它们的具体使用方式略有不同。
​ 在 xorm 中，结构体字段的 tag 是由 xorm 标准和用户自定义两部分组成。其中，xorm 标准的 tag 包括：pk（主键）、notnull（非空）、autoincr（自增）、unique（唯一键）、index（索引）、default（默认值）、created（记录创建时间）、updated（记录更新时间）等。用户自定义的 tag 则可以通过 xorm:&#34;tag_name&#34; 的形式来定义。
​ 在 gorm 中，结构体字段的 tag 则由 gorm 标准和用户自定义两部分组成。其中，gorm 标准的 tag 包括：primary_key（主键）、not null（非空）、auto_increment（自增）、unique_index（唯一键）、index（索引）、default（默认值）、created_at（记录创建时间）、updated_at（记录更新时间）、deleted_at（记录删除时间）等。用户自定义的 tag 则可以通过 gorm:&#34;tag_name&#34; 的形式来定义。
​ 虽然 xorm 和 gorm 中的 tag 使用方式略有不同，但它们的本质都是用于将数据库表和结构体字段之间建立映射关系。因此，使用哪个 ORM 框架，应该根据自己的实际需求来选择。
XORM 1. XORM是什么？ XORM是一个简单而强大的Go语言ORM库，支持MySQL、PostgreSQL、SQLite、Oracle、mssql、TiDB等多种数据库，实现了对象关系映射，即ORM。
2. 如何使用XORM？ 使用XORM，需要先安装XORM包，可以使用如下命令：
go get xorm.io/xorm # or go install github.com/go-xorm/cmd/xorm@latest 安装完成后，可以使用XORM提供的Reverse功能来生成Go结构体，或者使用XORM提供的API操作数据库。
3. 如何使用XORM的Reverse功能生成Go结构体？ 使用XORM的Reverse功能，需要先编写一个配置文件（比如config.yaml）
# 数据库引擎，支持的选项：mysql、postgres、mssql、sqlite3、oracle、odbc dbType: mysql # 数据库连接字符串，根据实际情况修改 connStr: root:password@tcp(localhost:3306)/test?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/3835bc3b8e54e34e628d5c8fd8584b22/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-15T18:21:43+08:00" />
<meta property="article:modified_time" content="2023-05-15T18:21:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ORM常见问题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="ORM_0"></a>ORM常见问题解答</h2> 
<blockquote> 
 <p><strong>前言</strong></p> 
 <p>​ 结构体标签（tag）在 xorm 和 gorm 中都是用于定义数据库表和结构体字段之间映射关系的，但是它们的具体使用方式略有不同。</p> 
 <p>​ 在 xorm 中，结构体字段的 tag 是由 xorm 标准和用户自定义两部分组成。其中，xorm 标准的 tag 包括：<code>pk</code>（主键）、<code>notnull</code>（非空）、<code>autoincr</code>（自增）、<code>unique</code>（唯一键）、<code>index</code>（索引）、<code>default</code>（默认值）、<code>created</code>（记录创建时间）、<code>updated</code>（记录更新时间）等。用户自定义的 tag 则可以通过 <code>xorm:"tag_name"</code> 的形式来定义。</p> 
 <p>​ 在 gorm 中，结构体字段的 tag 则由 gorm 标准和用户自定义两部分组成。其中，gorm 标准的 tag 包括：<code>primary_key</code>（主键）、<code>not null</code>（非空）、<code>auto_increment</code>（自增）、<code>unique_index</code>（唯一键）、<code>index</code>（索引）、<code>default</code>（默认值）、<code>created_at</code>（记录创建时间）、<code>updated_at</code>（记录更新时间）、<code>deleted_at</code>（记录删除时间）等。用户自定义的 tag 则可以通过 <code>gorm:"tag_name"</code> 的形式来定义。</p> 
 <p>​ 虽然 xorm 和 gorm 中的 tag 使用方式略有不同，但它们的本质都是用于将数据库表和结构体字段之间建立映射关系。因此，使用哪个 ORM 框架，应该根据自己的实际需求来选择。</p> 
</blockquote> 
<h3><a id="XORM_14"></a>XORM</h3> 
<h4><a id="1_XORM_16"></a>1. XORM是什么？</h4> 
<p>XORM是一个简单而强大的Go语言ORM库，支持MySQL、PostgreSQL、SQLite、Oracle、mssql、TiDB等多种数据库，实现了对象关系映射，即ORM。</p> 
<h4><a id="2_XORM_20"></a>2. 如何使用XORM？</h4> 
<p>使用XORM，需要先安装XORM包，可以使用如下命令：</p> 
<pre><code>go get xorm.io/xorm
# or 
go install github.com/go-xorm/cmd/xorm@latest
</code></pre> 
<p>安装完成后，可以使用XORM提供的Reverse功能来生成Go结构体，或者使用XORM提供的API操作数据库。</p> 
<h4><a id="3_XORMReverseGo_32"></a>3. 如何使用XORM的Reverse功能生成Go结构体？</h4> 
<p>使用XORM的Reverse功能，需要先编写一个配置文件（比如config.yaml）</p> 
<pre><code class="prism language-yaml"><span class="token comment"># 数据库引擎，支持的选项：mysql、postgres、mssql、sqlite3、oracle、odbc</span>
<span class="token key atrule">dbType</span><span class="token punctuation">:</span> mysql

<span class="token comment"># 数据库连接字符串，根据实际情况修改</span>
<span class="token key atrule">connStr</span><span class="token punctuation">:</span> root<span class="token punctuation">:</span>password@tcp(localhost<span class="token punctuation">:</span>3306)/test<span class="token punctuation">?</span>charset=utf8mb4

<span class="token comment"># 数据库表前缀，可选项</span>
<span class="token key atrule">tablePrefix</span><span class="token punctuation">:</span> 

<span class="token comment"># 模型生成的路径</span>
<span class="token key atrule">outputPath</span><span class="token punctuation">:</span> models/

<span class="token comment"># 模型包名 </span>
<span class="token comment"># 在生成的数据模型文件中修改包名为指定的包名。例如，如果 packageName 为 models，则需要将生成的数据模型文件中的 package main 修改为 package models</span>
<span class="token key atrule">packageName</span><span class="token punctuation">:</span> models  

<span class="token comment"># 模型所使用的标签，可选项</span>
<span class="token key atrule">tag</span><span class="token punctuation">:</span> xorm

<span class="token comment"># 指定数据表</span>
<span class="token key atrule">tables</span><span class="token punctuation">:</span>
	<span class="token punctuation">-</span> users
  <span class="token punctuation">-</span> orders
</code></pre> 
<p>配置文件的详细说明可以查看<a href="xorm.io" rel="nofollow">XORM官方文档</a>。然后，在终端执行以下命令即可：</p> 
<pre><code class="prism language-bash">xorm reverse config.yaml
</code></pre> 
<p>生成结果实例:</p> 
<pre><code class="prism language-go"><span class="token comment">// User Model</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
    Id   <span class="token builtin">int64</span>  <span class="token string">`xorm:"'id' pk autoincr" json:"id"`</span>
    Pwd  <span class="token builtin">string</span> <span class="token string">`xorm:"'pwd'" json:"pwd"`</span>
    Name <span class="token builtin">string</span> <span class="token string">`xorm:"'name'" json:"name"`</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>每个标签之间都用分号分隔，每个标签的格式为 <code>tag:"value"</code></p> 
<p>生成的Go结构体中，默认使用xorm的标签。如果需要使用json标签，可以在配置文件中指定，例如：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">tag</span><span class="token punctuation">:</span> xorm json
</code></pre> 
<p>除了在 config.yaml 文件中定义tables外，还可以在命令行添加，他俩本质上是一样的。其实都是命令行参数：</p> 
<pre><code class="prism language-bash"><span class="token comment"># --tables 参数用于指定要生成数据模型的数据库表，多个表名之间用逗号分隔</span>
xorm reverse config.yaml --tables<span class="token operator">=</span>users,orders
<span class="token comment"># 指定配置文件</span>
xorm reverse --config<span class="token operator">=</span>config.yaml --tables<span class="token operator">=</span>table1,table2
</code></pre> 
<p>除了之前提到的 dbType、connStr、tablePrefix、outputPath、packageName、tag 等参数，xorm reverse 命令的配置文件 config.yaml 还支持以下参数:</p> 
<pre><code class="prism language-go">cache：是否使用缓存，默认为 <span class="token boolean">false</span>，建议生产环境下开启，以减轻数据库的压力。
cacheDir：缓存文件存储目录，默认为 <span class="token punctuation">.</span>xormcache。
template：指定模板引擎，默认为 <span class="token keyword">go</span>，也可以设置为 mustache，pongo2，amber，ace，django，freemarker 等其他模板引擎。
templateDir：模板文件所在目录。
templateFile：模板文件名，需要包含扩展名。
goimports：是否使用 goimports 来格式化 Go 代码，默认为 <span class="token boolean">false</span>。若设置为 <span class="token boolean">true</span>，则会自动下载安装 goimports，因此需要保证网络畅通。
schemas：指定要生成的数据库表，可以是一个字符串，也可以是一个字符串数组，如：schemas<span class="token punctuation">:</span> <span class="token string">"user"</span> 或 schemas<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"product"</span><span class="token punctuation">]</span>。
primaryKey：指定主键名称，默认为 <span class="token string">"id"</span>。
singularizeTableNames：是否对表名进行单数化处理，默认为 <span class="token boolean">false</span>。
camelCasedTableNames：是否对表名进行驼峰命名处理，默认为 <span class="token boolean">false</span>。
appendPkToTable：是否在表名后面添加主键名作为结尾，默认为 <span class="token boolean">false</span>。
generateMethods：是否生成表的增删改查操作方法，默认为 <span class="token boolean">true</span>。
generateUpdateMethod：是否生成表的更新操作方法，默认为 <span class="token boolean">true</span>。
generateDeleteMethod：是否生成表的删除操作方法，默认为 <span class="token boolean">true</span>。
generateInsertMethod：是否生成表的插入操作方法，默认为 <span class="token boolean">true</span>。
generateSelectMethod：是否生成表的查询操作方法，默认为 <span class="token boolean">true</span>。
generateExistMethod：是否生成表的存在性检查方法，默认为 <span class="token boolean">true</span>。
generateCountMethod：是否生成表的计数方法，默认为 <span class="token boolean">true</span>。
generateFindByMethod：是否生成表的单条记录查询方法，默认为 <span class="token boolean">false</span>。
generateFindOneMethod：是否生成表的单条记录查询方法，默认为 <span class="token boolean">true</span>。
generateRelationMethods：是否生成表之间关系查询方法，默认为 <span class="token boolean">true</span>。
generateLeftJoinMethod：是否生成表的左连接查询方法，默认为 <span class="token boolean">true</span>。
generateRightJoinMethod：是否生成表的右连接查询方法，默认为 <span class="token boolean">true</span>。
generateInnerJoinMethod：是否生成表的内连接查询方法，默认为 <span class="token boolean">true</span>。
generateAutoMigrate：是否自动创建数据表，默认为 <span class="token boolean">false</span>。
generateIndexMethods：是否生成表
</code></pre> 
<p>在数据库中，一个数据库实例可以包含多个数据库，每个数据库可以包含多个表。在xorm中，schemas指的是数据库的名称（schema name），而tables指的是数据库中表的名称（table name）。</p> 
<p>通常情况下，xorm会将schemas和tables配置为通配符（“*”），这样就可以对数据库中所有的表都生成数据模型。但如果需要生成特定数据库中的表的数据模型，就需要修改schemas和tables的配置，具体可以参考xorm的文档和配置示例。</p> 
<p>Tips:</p> 
<p>xorm 生成的数据模型默认使用的是 xorm 的标签，不支持直接生成 gorm 标签。不过，你可以手动修改生成的结构体，将 xorm 的标签改为 gorm 的标签。或者使用第三方的转换工具进行自动转换。例如，可以使用 gormt 工具将 xorm 标签转换为 gorm 标签。</p> 
<p>可以使用 gormt 提供的 <code>-transform</code> 参数将 xorm 标签转换为 gorm 标签。</p> 
<p>具体使用方法如下：</p> 
<ol><li> <p>首先，使用 xorm 标签生成数据模型，例如：</p> <pre><code class="prism language-bash">gorment generate -t table1 -c <span class="token string">"root:password@tcp(localhost:3306)/test"</span> -p models -o models/ -t <span class="token string">"xorm"</span>
</code></pre> </li><li> <p>使用 gormt 工具将生成的模型文件中的 xorm 标签转换为 gorm 标签，例如：</p> </li></ol> 
<pre><code class="prism language-bash">gormt -f models/table1.go -transform<span class="token operator">=</span>xorm2gorm -o models/
</code></pre> 
<p>其中，<code>-f</code> 参数指定需要转换的文件路径，<code>-transform</code> 参数指定转换类型为 <code>xorm2gorm</code>，<code>-o</code> 参数指定输出路径。</p> 
<ol><li>转换完成后，可以在输出路径下找到转换后的文件，例如 <code>models/table1.go</code> 文件中的 xorm 标签被转换为了 gorm 标签。</li></ol> 
<h4><a id="4_XORM_157"></a>4. XORM支持哪些数据库？</h4> 
<p>XORM支持MySQL、PostgreSQL、SQLite、Oracle、mssql、TiDB等多种数据库。</p> 
<h4><a id="5_XORMAPI_161"></a>5. XORM提供哪些API？</h4> 
<p>XORM提供了众多的API，可以进行ORM操作、数据库连接池管理、Session管理等，详细信息请查看<a href="xorm.io" rel="nofollow">XORM官方文档</a>。</p> 
<h3><a id="Bee_167"></a>Bee</h3> 
<h4><a id="1_Bee_169"></a>1. Bee是什么？</h4> 
<p>Bee是一个基于Go语言的开发工具，可以用来快速开发Web应用程序。Bee提供了众多功能，包括路由、模板、ORM等。</p> 
<h4><a id="2_BeeORM_173"></a>2. Bee支持哪些ORM？</h4> 
<p>Bee支持xorm、gorm、QBS等ORM库，可以根据需要进行选择。</p> 
<h4><a id="3_BeeORM_177"></a>3. Bee如何使用ORM？</h4> 
<p>Bee默认使用xorm作为ORM库，可以在创建项目时指定ORM库，例如:</p> 
<pre><code class="prism language-bash">bee new myproject -orm<span class="token operator">=</span>gorm
</code></pre> 
<p>Bee还提供了Model生成工具，可以根据指定的字段快速生成模型文件，例如：</p> 
<pre><code class="prism language-bash">bee generate model User -fields<span class="token operator">=</span><span class="token string">"Id:int64,Pwd:string,Name:string"</span> -orm<span class="token operator">=</span>xorm -tags<span class="token operator">=</span>json

<span class="token comment"># or </span>

bee generate model -driver<span class="token operator">=</span>mysql -conn<span class="token operator">=</span><span class="token string">"root:123456@tcp(127.0.0.1:3306)/mydb?charset=utf8mb4"</span> -tables<span class="token operator">=</span><span class="token string">"user"</span> -pkg-model<span class="token operator">=</span>models

</code></pre> 
<p>其中，<code>-driver</code>指定数据库驱动，<code>-conn</code>指定数据库连接信息，<code>-tables</code>指定要生成模型的数据表，<code>-pkg-model</code>指定模型所属的包名。</p> 
<p>生成的数据模型文件位于<code>models</code>目录下，示例代码如下：</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> models

<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Id      <span class="token builtin">int</span>    <span class="token string">`xorm:"not null pk autoincr INT(11)"`</span>
	Name    <span class="token builtin">string</span> <span class="token string">`xorm:"not null VARCHAR(32)"`</span>
	Age     <span class="token builtin">int</span>    <span class="token string">`xorm:"not null INT(11)"`</span>
	Address <span class="token builtin">string</span> <span class="token string">`xorm:"VARCHAR(256)"`</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>也可以使用配置文件</p> 
<ol><li>配置信息，可以是json格式或 yaml格式</li></ol> 
<p>在<code>conf/app.json</code>文件中添加以下配置信息：</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"driver"</span><span class="token operator">:</span> <span class="token string">"mysql"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"conn"</span><span class="token operator">:</span> <span class="token string">"root:123456@tcp(127.0.0.1:3306)/test?charset=utf8&amp;parseTime=True&amp;loc=Local"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"dbprefix"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token string-property property">"language"</span><span class="token operator">:</span> <span class="token string">"go"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"tables"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"structName"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
            <span class="token string-property property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"id"</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"int64"</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"tag"</span><span class="token operator">:</span> <span class="token string">"json:\"id\""</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"tag"</span><span class="token operator">:</span> <span class="token string">"json:\"name\""</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"email"</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"tag"</span><span class="token operator">:</span> <span class="token string">"json:\"email\""</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"password"</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"tag"</span><span class="token operator">:</span> <span class="token string">"json:\"password\""</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>在上述配置文件中，<code>version</code> 字段为配置文件的版本号，目前为 1.0。<code>driver</code> 和 <code>conn</code> 字段分别指定数据库的驱动和连接字符串。<code>dbprefix</code> 字段用于指定表名前缀。<code>language</code> 字段指定生成数据模型的语言，这里使用的是 Go。<code>tables</code> 字段是一个数组，每个元素是一个表的配置，包括表名、结构体名和字段等信息。</p> 
<p>在 Bee 工具中，<code>tables</code> 命令中的 <code>-fields</code> 选项是用来指定数据表的字段信息的，这个选项是必须的，不能省略。如果不指定该选项，则 Bee 工具会报错提示缺少必要参数。</p> 
<p>使用 Bee 工具生成数据模型时，可以通过 <code>-config</code> 参数指定配置文件路径。假设配置文件名为 <code>config.yaml</code>，则可以使用以下命令生成数据模型：</p> 
<p><code>bee generate model &lt;ModelName&gt; -config=config.yaml</code></p> 
<p>其中，<code>&lt;ModelName&gt;</code> 为要生成的数据模型的名称。</p> 
<p>如果配置文件与 Bee 工具在同一目录下，则可以省略 <code>-config</code> 参数：</p> 
<pre><code class="prism language-bash">bee generate model <span class="token operator">&lt;</span>ModelName<span class="token operator">&gt;</span>
</code></pre> 
<p>在配置文件中，可以通过 <code>tables</code> 字段指定要生成数据模型的数据库表信息，也可以通过 <code>fields</code> 字段指定要生成的字段信息。具体配置方式可以参考 Bee 工具官方文档。</p> 
<p>命令解析：</p> 
<pre><code class="prism language-bash">bee generate model User -fields<span class="token operator">=</span><span class="token string">"Id:int64,Pwd:string,Name:string"</span> -orm<span class="token operator">=</span>xorm -tags<span class="token operator">=</span>json
</code></pre> 
<ol><li> <p>上面的命令将创建一个名为<code>User</code>的数据模型，该模型有三个字段：<code>Id</code>，<code>Pwd</code>和<code>Name</code>，并使用xorm和JSON标签。</p> <p>在这个命令中，<code>-fields</code>选项用于指定模型的字段和类型，<code>-orm</code>选项用于指定使用的ORM框架，<code>-tags</code>选项用于指定用于生成JSON标签的结构体标记。</p> </li><li> <p>运行上述命令后，我们将在<code>models</code>目录下看到生成的<code>user.go</code>文件，其中包含有关我们的<code>User</code>数据模型的定义和xorm和JSON标记。</p> </li><li> <pre><code class="prism language-go"><span class="token comment">// User Model</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
    Id   <span class="token builtin">int64</span>  <span class="token string">`xorm:"'id' pk autoincr" json:"id"`</span>
    Pwd  <span class="token builtin">string</span> <span class="token string">`xorm:"'pwd'" json:"pwd"`</span>
    Name <span class="token builtin">string</span> <span class="token string">`xorm:"'name'" json:"name"`</span>
<span class="token punctuation">}</span>
</code></pre> </li></ol> 
<p>在这个示例中，我们使用了<code>-fields</code>、<code>-orm</code>和<code>-tags</code>选项来生成一个有xorm和JSON标签的<code>User</code>数据模型。</p> 
<h4><a id="4_Bee_301"></a>4. Bee支持哪些数据库？</h4> 
<p>Bee支持MySQL、PostgreSQL、SQLite等多种数据库。</p> 
<h4><a id="5_BeeAPI_305"></a>5. Bee提供哪些API？</h4> 
<p>Bee提供了路由、模板、ORM等API，详细信息请查看Bee官方文档。</p> 
<hr> 
<h3><a id="Gormt_315"></a>Gormt</h3> 
<h4><a id="1_Gormt_317"></a>1. Gormt是什么？</h4> 
<p>Gormt是一个用于生成Golang Gorm数据库模型的命令行工具。</p> 
<h4><a id="2_Gormt_321"></a>2. 如何使用Gormt？</h4> 
<p>使用Gormt，需要先安装Gormt包，可以使用如下命令：</p> 
<pre><code class="prism language-bash">go get -u github.com/xxjwxc/gormt@latest
</code></pre> 
<h4><a id="3__Gormt__329"></a>3. 如何使用 Gormt 生成数据模型？</h4> 
<p>使用以下命令可以生成数据模型：</p> 
<pre><code class="prism language-bash">gormt gen -d<span class="token operator">=</span><span class="token operator">&lt;</span>database<span class="token operator">&gt;</span> -h<span class="token operator">=</span><span class="token operator">&lt;</span>host<span class="token operator">&gt;</span> -p<span class="token operator">=</span><span class="token operator">&lt;</span>port<span class="token operator">&gt;</span> -u<span class="token operator">=</span><span class="token operator">&lt;</span>user<span class="token operator">&gt;</span> -pwd<span class="token operator">=</span><span class="token operator">&lt;</span>password<span class="token operator">&gt;</span> -o<span class="token operator">=</span><span class="token operator">&lt;</span>outputpath<span class="token operator">&gt;</span> -pkg<span class="token operator">=</span><span class="token operator">&lt;</span>package<span class="token operator">&gt;</span>
</code></pre> 
<p>其中：</p> 
<ul><li><code>-d</code>：数据库名称</li><li><code>-h</code>：数据库服务器地址</li><li><code>-p</code>：数据库端口号</li><li><code>-u</code>：数据库用户名</li><li><code>-pwd</code>：数据库密码</li><li><code>-o</code>：生成的数据模型文件路径</li><li><code>-pkg</code>：生成的数据模型所在的包名</li></ul> 
<p>或者定义配置文件</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">output</span><span class="token punctuation">:</span> ./models
<span class="token key atrule">dialect</span><span class="token punctuation">:</span> mysql
<span class="token key atrule">conn</span><span class="token punctuation">:</span> root<span class="token punctuation">:</span>password@tcp(localhost<span class="token punctuation">:</span>3306)/test<span class="token punctuation">?</span>charset=utf8mb4
<span class="token key atrule">tag</span><span class="token punctuation">:</span> gorm
<span class="token key atrule">tables</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> user
  <span class="token punctuation">-</span> order
</code></pre> 
<ul><li><code>output</code>：生成的模型文件存放路径</li><li><code>dialect</code>：数据库类型，支持 <code>mysql</code>、<code>postgresql</code>、<code>sqlite3</code>、<code>mssql</code> 等多种数据库类型</li><li><code>conn</code>：数据库连接字符串</li><li><code>tag</code>：生成的模型中结构体标签的类型，默认是 <code>gorm</code></li><li><code>tables</code>：需要生成数据模型的数据库表名，可以指定多个</li></ul> 
<p>在项目跟目录执行以下命令：</p> 
<pre><code class="prism language-bash">gormt generate -f gormt.yaml
</code></pre> 
<p>生成的gorm结构体默认使用的是gorm的tag，而不是xorm的tag。如果需要使用xorm的tag，需要在gormt的配置文件中进行相应的设置。可以在配置文件中添加<code>TagToOrm</code>选项，并将其值设置为<code>xorm</code>，这样生成的结构体就会使用xorm的tag了。例如：</p> 
<pre><code class="prism language-yaml"><span class="token comment"># gormt 配置文件</span>

<span class="token comment"># 数据库类型，支持 mysql、postgres 等</span>
<span class="token key atrule">DbType</span><span class="token punctuation">:</span> mysql

<span class="token comment"># 数据库连接信息</span>
<span class="token key atrule">DbUrl</span><span class="token punctuation">:</span> root<span class="token punctuation">:</span>password@tcp(localhost<span class="token punctuation">:</span>3306)/test<span class="token punctuation">?</span>charset=utf8mb4

<span class="token comment"># 数据表前缀</span>
<span class="token key atrule">TablePrefix</span><span class="token punctuation">:</span> 

<span class="token comment"># 生成结构体的输出目录</span>
<span class="token key atrule">OutPath</span><span class="token punctuation">:</span> models/

<span class="token comment"># 生成结构体使用的包名</span>
<span class="token key atrule">PkgName</span><span class="token punctuation">:</span> models

<span class="token comment"># 使用 xorm 的 tag，而不是默认的 gorm 的 tag</span>
<span class="token key atrule">TagToOrm</span><span class="token punctuation">:</span> xorm

</code></pre> 
<h4><a id="4__Gormt__JSON__400"></a>4. 如何在 Gormt 中添加 JSON 标签？</h4> 
<p>在 Gormt 中添加 JSON 标签的方法如下：</p> 
<pre><code class="prism language-bash">gormt gen -d<span class="token operator">=</span><span class="token operator">&lt;</span>database<span class="token operator">&gt;</span> -h<span class="token operator">=</span><span class="token operator">&lt;</span>host<span class="token operator">&gt;</span> -p<span class="token operator">=</span><span class="token operator">&lt;</span>port<span class="token operator">&gt;</span> -u<span class="token operator">=</span><span class="token operator">&lt;</span>user<span class="token operator">&gt;</span> -pwd<span class="token operator">=</span><span class="token operator">&lt;</span>password<span class="token operator">&gt;</span> -o<span class="token operator">=</span><span class="token operator">&lt;</span>outputpath<span class="token operator">&gt;</span> -pkg<span class="token operator">=</span><span class="token operator">&lt;</span>package<span class="token operator">&gt;</span> -tag<span class="token operator">=</span>json
</code></pre> 
<p>使用 <code>-tag=json</code> 参数可以在生成的结构体中添加 JSON 标签。</p> 
<h4><a id="5__Gormt__Gorm__410"></a>5. 如何在 Gormt 中添加 Gorm 标签？</h4> 
<p>在 Gormt 中添加 Gorm 标签的方法如下：</p> 
<pre><code class="prism language-bash">gormt gen -d<span class="token operator">=</span><span class="token operator">&lt;</span>database<span class="token operator">&gt;</span> -h<span class="token operator">=</span><span class="token operator">&lt;</span>host<span class="token operator">&gt;</span> -p<span class="token operator">=</span><span class="token operator">&lt;</span>port<span class="token operator">&gt;</span> -u<span class="token operator">=</span><span class="token operator">&lt;</span>user<span class="token operator">&gt;</span> -pwd<span class="token operator">=</span><span class="token operator">&lt;</span>password<span class="token operator">&gt;</span> -o<span class="token operator">=</span><span class="token operator">&lt;</span>outputpath<span class="token operator">&gt;</span> -pkg<span class="token operator">=</span><span class="token operator">&lt;</span>package<span class="token operator">&gt;</span> -orm<span class="token operator">=</span>gorm
</code></pre> 
<p>使用 <code>-orm=gorm</code> 参数可以在生成的结构体中添加 Gorm 标签。</p> 
<h4><a id="6_Gormt__420"></a>6. Gormt 支持哪些数据库？</h4> 
<p>Gormt 目前支持 MySQL、PostgreSQL、SQLite 和 Microsoft SQL Server 这四种数据库。</p> 
<h4><a id="7_Gormt__424"></a>7. Gormt 生成的结构体中默认使用的是哪种标签？</h4> 
<p>Gormt 生成的结构体默认使用的是 Gorm 标签。</p> 
<h4><a id="8_Gormt__428"></a>8. Gormt 生成的结构体中可以同时添加多种标签吗？</h4> 
<p>可以，可以在命令中使用 <code>-tag</code> 参数指定需要添加的标签，例如：</p> 
<pre><code class="prism language-bash">gormt gen -d<span class="token operator">=</span><span class="token operator">&lt;</span>database<span class="token operator">&gt;</span> -h<span class="token operator">=</span><span class="token operator">&lt;</span>host<span class="token operator">&gt;</span> -p<span class="token operator">=</span><span class="token operator">&lt;</span>port<span class="token operator">&gt;</span> -u<span class="token operator">=</span><span class="token operator">&lt;</span>user<span class="token operator">&gt;</span> -pwd<span class="token operator">=</span><span class="token operator">&lt;</span>password<span class="token operator">&gt;</span> -o<span class="token operator">=</span><span class="token operator">&lt;</span>outputpath<span class="token operator">&gt;</span> -pkg<span class="token operator">=</span><span class="token operator">&lt;</span>package<span class="token operator">&gt;</span> -tag<span class="token operator">=</span>json gormt
</code></pre> 
<p>以上命令可以在生成的结构体中同时添加 JSON 和 Gorm 标签。</p> 
<h4><a id="9_Gormt__438"></a>9. Gormt 生成的结构体中可以自定义函数吗？</h4> 
<p>可以，可以在模板文件中添加自定义函数。在模板文件中定义的自定义函数可以在生成的结构体中使用。</p> 
<h4><a id="10_Gormt__442"></a>10. Gormt 有哪些模板文件可以使用？</h4> 
<p>Gormt 提供了多个模板文件供用户使用，可以根据需要选择使用。常用的模板文件有：</p> 
<ul><li><code>gormt</code>: 生成 GORM 模型的默认模板，使用 GORM 的注释标签。</li><li><code>gormt2</code>: 生成 GORM 模型的默认模板，使用 GORM v2 的注释标签。</li><li><code>gormt_xorm</code>: 生成 XORM 模型的默认模板，使用 XORM 的注释标签。</li><li><code>gormt_sqlboiler</code>: 生成 SQLBoiler 模型的默认模板，使用 SQLBoiler 的注释标签。</li><li><code>gormt_guregu</code>: 生成 Guregu 模型的默认模板，使用 Guregu 的注释标签。</li></ul> 
<p>用户还可以根据自己的需求编写自定义模板文件。</p> 
<ol><li>Gormt 支持哪些数据库？ Gormt 支持 MySQL、PostgreSQL、SQLite、Microsoft SQL Server 和 Oracle 数据库。</li><li>Gormt 的安装和使用方法是什么？ Gormt 的安装和使用方法如下：</li><li>安装 Gormt：在命令行中运行 <code>go get github.com/xxjwxc/gormt</code>。</li><li>在数据库中创建表，并在表中添加注释。</li><li>在命令行中进入项目的根目录，运行 <code>gormt gen -h</code>，查看命令行参数和使用说明。</li><li>根据需求编写 Gormt 的配置文件 <code>gormt.yaml</code>。</li><li>在命令行中运行 <code>gormt gen</code> 命令，生成 GORM 模型。</li><li>Gormt 的优缺点是什么？ Gormt 的优点包括：</li></ol> 
<ul><li>支持多种数据库。</li><li>支持自定义模板，方便用户根据自己的需求进行扩展。</li><li>支持生成 GORM v2 版本的模型。</li><li>使用简单，命令行参数和配置文件都很清晰。</li></ul> 
<p>Gormt 的缺点包括：</p> 
<ul><li>仅支持 GORM 框架，不支持其他框架。</li><li>在生成模型时，不支持对外键、联合主键等复杂场景的处理。</li><li>生成的模型文件过于冗长，缺乏一定的可读性。</li></ul> 
<p>总体来说，Gormt 是一个功能较为完善、易于使用的 ORM 模型生成工具，适合用于快速生成 GORM 模型的开发场景。</p> 
<hr> 
<h3><a id="Gorment_482"></a>Gorment</h3> 
<p>Gorment 是一个使用 Go 语言开发的 ORM 框架，类似于 Gorm 和 Xorm。它支持多种数据库，包括 MySQL、PostgreSQL、SQLite3、MSSQL、Oracle 等，其支持自动代码生成，可以根据数据库表结构自动生成相应的数据模型。与其他 ORM 框架相比，Gorment 的特点是它支持异步操作，可以更好地利用 Go 语言的并发性能。</p> 
<h3><a id="_Gorment_486"></a>使用 Gorment</h3> 
<h4><a id="_488"></a>安装</h4> 
<p>可以使用以下命令来安装 Gorment：</p> 
<pre><code class="prism language-bash">go get -u github.com/volatiletech/gorment
</code></pre> 
<h4><a id="_496"></a>使用</h4> 
<p>使用 Gorment 生成数据模型的方法与 Gormt 和 Xorm 差不多。我们可以使用 Gorment 的命令行工具 <code>gorment-cli</code> 来生成模型文件。具体步骤如下：</p> 
<ol><li> <p>在项目的根目录下创建一个配置文件 <code>gorment.yaml</code>，用于指定数据库连接信息和生成模型文件的选项。下面是一个例子：</p> </li><li> <pre><code class="prism language-yaml"><span class="token comment"># 数据库引擎，支持的选项：mysql、postgres、mssql、sqlite3、oracle</span>
<span class="token key atrule">dbType</span><span class="token punctuation">:</span> mysql

<span class="token comment"># 数据库连接字符串，根据实际情况修改</span>
<span class="token key atrule">connStr</span><span class="token punctuation">:</span> root<span class="token punctuation">:</span>password@tcp(localhost<span class="token punctuation">:</span>3306)/test<span class="token punctuation">?</span>charset=utf8mb4

<span class="token comment"># 数据库表前缀，可选项</span>
<span class="token key atrule">tablePrefix</span><span class="token punctuation">:</span> 

<span class="token comment"># 模型生成的路径</span>
<span class="token key atrule">outputPath</span><span class="token punctuation">:</span> models/

<span class="token comment"># 模型包名</span>
<span class="token key atrule">packageName</span><span class="token punctuation">:</span> models

<span class="token comment"># 模型所使用的标签，可选项</span>
<span class="token key atrule">tag</span><span class="token punctuation">:</span> gorm json

</code></pre> </li><li> <p>在命令行中执行以下命令：</p> <pre><code class="prism language-bash">gorment generate
</code></pre> </li><li> <p>执行该命令后，Gorment 会根据 <code>gorment.yaml</code> 文件中的配置信息自动生成数据模型。生成的模型文件会存放在 <code>outputPath</code> 指定的目录中，文件名为表名的单数形式。例如，如果数据库中有一个名为 <code>users</code> 的表，那么生成的模型文件名为 <code>user.go</code>。</p> <p>生成的模型文件中会自动添加 <code>gorm.Model</code> 结构体，这是 Gorm 框架内置的一个模型结构体，包含了常见的数据库字段（<code>ID</code>、<code>CreatedAt</code>、<code>UpdatedAt</code>、<code>DeletedAt</code>）和一些常用的方法。除此之外，Gorment 还会自动添加字段和标签，其中标签由 <code>tag</code> 选项指定。在上面的例子中，Gorment 会自动添加 <code>gorm</code> 和 <code>json</code> 两个标签。</p> </li></ol> 
<h4><a id="_533"></a>生成数据模型</h4> 
<p>使用 Gorment 生成数据模型非常简单，只需要执行以下命令：</p> 
<pre><code class="prism language-bash">gorment generate -t <span class="token operator">&lt;</span>table<span class="token operator">&gt;</span> -c <span class="token operator">&lt;</span>connection-string<span class="token operator">&gt;</span> -p <span class="token operator">&lt;</span>package-name<span class="token operator">&gt;</span> -o <span class="token operator">&lt;</span>output-path<span class="token operator">&gt;</span>
</code></pre> 
<p>其中：</p> 
<ul><li><code>&lt;table&gt;</code>：需要生成数据模型的数据库表名。</li><li><code>&lt;connection-string&gt;</code>：数据库连接字符串，格式为 <code>user:password@tcp(host:port)/database</code>。</li><li><code>&lt;package-name&gt;</code>：生成的数据模型所在的包名。</li><li><code>&lt;output-path&gt;</code>：生成的数据模型文件所在的路径。</li></ul> 
<p>执行命令后，Gorment 将会自动生成相应的数据模型文件。</p> 
<h4><a id="_550"></a>标签设置</h4> 
<p>Gorment 的默认标签是 <code>gorm</code>，如果需要设置其他标签，可以在生成数据模型命令中使用 <code>-t</code> 参数，例如：</p> 
<pre><code class="prism language-bash">gorment generate -t <span class="token operator">&lt;</span>table<span class="token operator">&gt;</span> -c <span class="token operator">&lt;</span>connection-string<span class="token operator">&gt;</span> -p <span class="token operator">&lt;</span>package-name<span class="token operator">&gt;</span> -o <span class="token operator">&lt;</span>output-path<span class="token operator">&gt;</span> -t <span class="token string">"xorm json"</span>
</code></pre> 
<p>其中 <code>-t "xorm json"</code> 表示使用 <code>xorm</code> 和 <code>json</code> 两个标签。</p> 
<blockquote> 
 <p>对于 Gorment 中的命令 <code>gorment generate</code> 来说，两个 <code>-t</code> 参数是不冲突的，因为它们是针对不同的选项的。</p> 
 <p>第一个 <code>-t</code> 参数用于指定要生成数据模型的表名，如果不指定，则会生成所有表的数据模型。例如 <code>-t my_table</code> 表示只生成名为 <code>my_table</code> 的表的数据模型。</p> 
 <p>第二个 <code>-t</code> 参数用于指定生成的数据模型所使用的标签，可以指定多个标签，多个标签之间使用空格分隔。例如 <code>-t "xorm json"</code> 表示生成的数据模型中会同时包含 <code>xorm</code> 和 <code>json</code> 两个标签。</p> 
</blockquote> 
<h3><a id="_568"></a>总结</h3> 
<p>以上就是 Gorment 的基本使用方法和常用功能，通过 Gorment，我们可以方便地生成数据模型，并根据需要设置标签以及模板文件。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b2d8dde631990aa5825ccba7e768fbd5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">云原生技术的个人总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1b2e47fe24d6cde6ac2e9a9ecd282c98/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Vmware配置centos7（简单上手）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>