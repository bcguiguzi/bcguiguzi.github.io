<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于Python实现的神经网络分类MNIST数据集 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于Python实现的神经网络分类MNIST数据集" />
<meta property="og:description" content="神经网络分类MNIST数据集
目录
神经网络分类MNIST数据集 1
一 、问题背景 1
1.1 神经网络简介 1
前馈神经网络模型： 1
1.2 MINST 数据说明 4
1.3 TensorFlow基本概念 5
二 、实现说明 5
2.1 构建神经网络模型 5
为输入输出分配占位符 5
搭建分层的神经网络 6
处理预测结果 8
2.2 运行模型 9
三 、程序测试 9
3.1 运行说明 10
3.2 运行输出 10
四 、实验总结 11
2.2运行模型
首先调用 tf.global_variables_initializer() 初始化模型的参数，Session提供了Operation执行和Tensor求值的环境
其中：
模型训练分批次，每一批用100个样本训练神经网络模型，每一批都在上一批的基础上对网络模型 的参数进行调整。
mnist.train.next_batch ：返回的是一组元组，元组的第一个元素图片像素阵列，第二个元素为 one-hot 格式的预测标签。
：在一个Session 里面计算张量的值，执行定义的所有必要的操作来产生这个计算这个张量需要的输入，然后通过这些输入产生这个张量。
feed_dict 作用是给使用 placeholder 创建出来的张量赋值，上述我们使用 定义
的占位符包括输入 x 、输出 y 和Dropout 层保留比例 keep_prob 。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/7e77c7777d3f0976611f74d0bea3f95e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-15T19:46:29+08:00" />
<meta property="article:modified_time" content="2023-10-15T19:46:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于Python实现的神经网络分类MNIST数据集</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>神经网络分类MNIST数据集<br> 目录<br> 神经网络分类MNIST数据集 1<br> 一 、问题背景 1<br> 1.1 神经网络简介 1<br> 前馈神经网络模型： 1<br> 1.2 MINST 数据说明 4<br> 1.3 TensorFlow基本概念 5<br> 二 、实现说明 5<br> 2.1 构建神经网络模型 5</p> 
<p>为输入输出分配占位符 5<br> 搭建分层的神经网络 6<br> 处理预测结果 8<br> 2.2 运行模型 9<br> 三 、程序测试 9<br> 3.1 运行说明 10<br> 3.2 运行输出 10<br> 四 、实验总结 11<br> 2.2运行模型<br> 首先调用 tf.global_variables_initializer() 初始化模型的参数，Session提供了Operation执行和Tensor求值的环境<br> 其中：<br> 模型训练分批次，每一批用100个样本训练神经网络模型，每一批都在上一批的基础上对网络模型 的参数进行调整。<br> mnist.train.next_batch ：返回的是一组元组，元组的第一个元素图片像素阵列，第二个元素为 one-hot 格式的预测标签。<br> ：在一个Session 里面计算张量的值，执行定义的所有必要的操作来产生这个计算这个张量需要的输入，然后通过这些输入产生这个张量。<br> feed_dict 作用是给使用 placeholder 创建出来的张量赋值，上述我们使用 定义<br> 的占位符包括输入 x 、输出 y 和Dropout 层保留比例 keep_prob 。<br> 三 、程序测试<br> 3.1运行说明<br> 因为实验代码所需要的TensorFlow版本为1.4.0，而现在TensorFlow的版本已经上升到了2.x，一些以前<br> 提供的数据集、函数已经被删除，故直接运行会报错，报错内容为找不到 包。<br> 我们可以使用一些Online运行环境，如 Google Colab （https://colab.research.google.com/）。使用云计算来运行我们的程序，将TensorFlow降级至1.4.0，而不修改本地 Python 的配置。<br> 将TensorFlow降级的方法如下：在文件首行加入以下代码，然后再 import tensorflow 。<br> 执行程序后会首先出现以下输出，本文转载自http://www.biyezuopin.vip/onews.asp?id=16721程序其他部分无需修改即可以正常运行，运行结果与预期一致。<br> 3.2运行输出<br> 运行输出如下：可以看到随着测试规模的增加，训练和测试的准确率也不断地在上升。<br> step 0, training accuracy 0.07, test accuracy 0.1024<br> step 50, training accuracy 0.91, test accuracy 0.8892<br> 3 step 100, training accuracy 0.95, test accuracy 0.9325<br> 4 step 150, training accuracy 0.94, test accuracy 0.9405<br> 5 step 200, training accuracy 0.95, test accuracy 0.9468<br> 6 step 250, training accuracy 0.96, test accuracy 0.9518<br> 7 step 300, training accuracy 0.94, test accuracy 0.9543<br> 8 step 350, training accuracy 0.97, test accuracy 0.9645<br> 9 step 400, training accuracy 0.94, test accuracy 0.9588<br> 10 step 450, training accuracy 0.95, test accuracy 0.9655<br> 11<br> 12 step 500, training accuracy 1, test accuracy 0.9608<br> test accuracy 0.9586<br> 尝试修改部分参数，观察输出变化情况。<br> 提高Adam下降算法的学习率：将学习率从 提高到 、<br> 可以看到随着学习率的提高，测试正确率有明显的提高，但耗时随之上升。<br> step 0, training accuracy 0.08, test accuracy 0.1123<br> step 50, training accuracy 0.94, test accuracy 0.913<br> step 100, training accuracy 0.9, test accuracy 0.9283<br> 4 step 150, training accuracy 0.95, test accuracy 0.9442<br> 5 step 200, training accuracy 0.91, test accuracy 0.9413<br> 6 step 250, training accuracy 0.94, test accuracy 0.954<br> 7 step 300, training accuracy 0.93, test accuracy 0.9513<br> 8 step 350, training accuracy 0.99, test accuracy 0.9598<br> 9 step 400, training accuracy 0.97, test accuracy 0.9609<br> 10 step 450, training accuracy 0.94, test accuracy 0.9584<br> 11 step 500, training accuracy 0.96, test accuracy 0.9609<br> 12 test accuracy 0.9651<br> 当学习率提高到 时，过高的学习率容易跳过最优值，预测效果反而下降。<br> step 0, training accuracy 0.07, test accuracy 0.0877<br> step 50, training accuracy 0.89, test accuracy 0.9095<br> 3 step 100, training accuracy 0.94, test accuracy 0.9233<br> 4 step 150, training accuracy 0.91, test accuracy 0.9267<br> 5 step 200, training accuracy 0.89, test accuracy 0.882<br> 6 step 250, training accuracy 0.96, test accuracy 0.9383<br> 7 step 300, training accuracy 0.92, test accuracy 0.9426<br> 8 step 350, training accuracy 0.96, test accuracy 0.9384<br> 9 step 400, training accuracy 0.95, test accuracy 0.9524<br> 10 step 450, training accuracy 0.93, test accuracy 0.9504<br> 11 step 500, training accuracy 0.95, test accuracy 0.9563<br> 12 test accuracy 0.9469<br> 增加/减少神经网络隐层<br> 经测试，网络层数（3，4，5）对模型效果的影响不明显。而层次相同的神经网络中节点数目多的 表现出性能更优。<br> 四 、实验总结<br> 通过本次实验，我们深入理解了前馈神经网络模型，通过示例代码，研究MINST数据集训练神经网络的过程。第一次了解 TensorFlow，学习了TensorFlow的基本概念和用法，掌握了如何运用<br> TensorFlow来构建一个神经网络模型。<br>  </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dff24126d95e39fd4719f4119d3c24c6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">qemu基础篇——VSCode 配置 GDB 调试</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3022e098cc47eae2e3e6049401de240f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">人工智能的基础.pdf</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>