<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>RedHat 和 CentOS 日常运维十大技能 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="RedHat 和 CentOS 日常运维十大技能" />
<meta property="og:description" content="转自:https://mp.weixin.qq.com/s/yTG7W1qTEYMb_xA4-7dzAw 1
Linux选择
选择一个适合自身企业的Linux版本系列和主流版本还是相对不容易的，下面我们来介绍一下在选择时各企业所参考的依据：
RedHat和CentOS 选择红帽子系列产品，以centos为主，主要考虑有几个方面：
1. centos是redhat的编译版本，基本上没有什么大的变动
2. 现在很多环境都是集群环境，包括web集群，中间件集群，rac群集等等，OS层面本身的高可用系数已经不是100%要求那么高了。
3. 主流版本生命周期比较长，比较适合一个硬件的生命周期管理，基本上安装一次直到设备报废了。
4. 批量安装部署方便，硬件和软件兼容性都挺好。
5. 版本主要使用6版本，新上应用可以全面考虑升级使用7版本
SuSe 使用的Suse Linux Enterprise版，主要考虑因素如下：
1、该发行版本性能和稳定性比较突出
2、对客户的技术支持体系较为完备，服务响应较快（这基本上是最重要的因素）
3、对开源社区如openstack等生态拥抱得也较好。
4、版本主要是SUSE11 较多。
2
安装部署
方式：U盘，光盘和网络安装
其中网络安装已经成为了目前批量部署的首选方式：主要工具有Cobbler和PXE&#43;kickstart
可以参考如下链接内容：
http://www.cnblogs.com/mchina/p/centos-pxe-kickstart-auto-install-os.html
3
初始化配置
禁用服务
禁用SeLinux 配置YUM源配置 可以配置为光盘，内部YUM源或EPEL等
常用软件安装 安装xwindows 配置ntp Crontab 添加如上记录，指定内部ntp服务器
SSH 登录设置 修改ssh 禁用DNS 选项:
添加允许指定用户登录：
上传扫描工具 网络上有该脚本，下载自行使用
修改历史记录格式 4
安全加固
本次安全加固内容主要参考的是Redhat和Centos系列版本系统： 参考链接
http://www.centoscn.com/CentosSecurity/CentosSafe/2015/0315/4881.html
注释掉系统不需要的用户和用户组 注意：不建议直接删除，当你需要某个用户时，自己重新添加会很麻烦。
关闭系统不需要的服务 给下面的文件加上不可更改属性，从而防止非授权用户获得权限 限制不同文件的权限 禁止使用Ctrl&#43;Alt&#43;Del快捷键重启服务器 使用yum update更新系统时不升级内核，只更新软件包 注意：由于系统与硬件的兼容性问题，有可能升级内核后导致服务器不能正常启动，这是非常可怕的，没有特别的需要，建议不要随意升级内核。
关闭Centos自动更新 关闭多余的虚拟控制台 我们知道从控制台切换到 X 窗口，一般采用 Alt-F7 ，为什么呢？因为系统默认定义了 6 个虚拟控制台， 所以 X 就成了第7个。实际上，很多人一般不会需要这么多虚拟控制台的，修改/etc/inittab ，注释掉那些你不需要的。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/94ce6bba5815233eda6f64d3db2e7313/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-04-17T10:52:49+08:00" />
<meta property="article:modified_time" content="2019-04-17T10:52:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">RedHat 和 CentOS 日常运维十大技能</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>转自:<a href="https://mp.weixin.qq.com/s/yTG7W1qTEYMb_xA4-7dzAw" rel="nofollow">https://mp.weixin.qq.com/s/yTG7W1qTEYMb_xA4-7dzAw</a> </p> 
<p> </p> 
<p><strong>1</strong></p> 
<p><strong>Linux选择</strong></p> 
<p> </p> 
<p>选择一个适合自身企业的Linux版本系列和主流版本还是相对不容易的，下面我们来介绍一下在选择时各企业所参考的依据：</p> 
<h3><strong>RedHat和CentOS</strong></h3> 
<p>选择红帽子系列产品，以centos为主，主要考虑有几个方面：</p> 
<p>1. centos是redhat的编译版本，基本上没有什么大的变动</p> 
<p>2. 现在很多环境都是集群环境，包括web集群，中间件集群，rac群集等等，OS层面本身的高可用系数已经不是100%要求那么高了。</p> 
<p>3. 主流版本生命周期比较长，比较适合一个硬件的生命周期管理，基本上安装一次直到设备报废了。</p> 
<p>4. 批量安装部署方便，硬件和软件兼容性都挺好。</p> 
<p>5. 版本主要使用6版本，新上应用可以全面考虑升级使用7版本</p> 
<h3><strong>SuSe</strong></h3> 
<p>使用的Suse Linux Enterprise版，主要考虑因素如下：</p> 
<p>1、该发行版本性能和稳定性比较突出</p> 
<p>2、对客户的技术支持体系较为完备，服务响应较快（这基本上是最重要的因素）</p> 
<p>3、对开源社区如openstack等生态拥抱得也较好。</p> 
<p>4、版本主要是SUSE11 较多。</p> 
<p> </p> 
<p><strong>2</strong></p> 
<p><strong>安装部署</strong></p> 
<p> </p> 
<p>方式：U盘，光盘和网络安装</p> 
<p>其中网络安装已经成为了目前批量部署的首选方式：主要工具有Cobbler和PXE+kickstart</p> 
<p>可以参考如下链接内容：</p> 
<p>http://www.cnblogs.com/mchina/p/centos-pxe-kickstart-auto-install-os.html</p> 
<p> </p> 
<p><strong>3</strong></p> 
<p><strong>初始化配置</strong></p> 
<p> </p> 
<p><strong>禁用服务</strong></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/25/9a/GQT9xewm_o.jpg"></p> 
<h3><strong>禁用SeLinux</strong></h3> 
<p><img alt="" class="has" src="https://images2.imgbox.com/8a/ac/SMREGEpw_o.jpg"></p> 
<h3><strong>配置YUM源配置</strong></h3> 
<p><img alt="" class="has" src="https://images2.imgbox.com/9e/a4/RQnXYhUH_o.jpg"></p> 
<p>可以配置为光盘，内部YUM源或EPEL等</p> 
<h3><strong>常用软件安装</strong></h3> 
<p><img alt="" class="has" src="https://images2.imgbox.com/40/d7/SlKpNfqB_o.jpg"></p> 
<h3><strong>安装xwindows</strong></h3> 
<h3><img alt="" class="has" src="https://images2.imgbox.com/b9/04/GN3cSJrI_o.jpg"></h3> 
<h3><strong>配置ntp</strong></h3> 
<h3><img alt="" class="has" src="https://images2.imgbox.com/6b/7f/8aV7n2Bi_o.jpg"></h3> 
<p>Crontab 添加如上记录，指定内部ntp服务器</p> 
<h3><strong>SSH 登录设置</strong></h3> 
<p>修改ssh 禁用DNS 选项:</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/49/cc/ULF7FGC8_o.jpg"></p> 
<p>添加允许指定用户登录：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/49/8e/FdagjdpN_o.jpg"></p> 
<h3><strong>上传扫描工具</strong></h3> 
<h3><img alt="" class="has" src="https://images2.imgbox.com/4e/dc/wDnqyFfp_o.jpg"></h3> 
<p>网络上有该脚本，下载自行使用</p> 
<h3><strong>修改历史记录格式</strong></h3> 
<h3><img alt="" class="has" src="https://images2.imgbox.com/a7/d0/LGSGgHOk_o.jpg"></h3> 
<p> </p> 
<p><strong>4</strong></p> 
<p><strong>安全加固</strong></p> 
<p> </p> 
<h2>本次安全加固内容主要参考的是Redhat和Centos系列版本系统：</h2> 
<p>参考链接<br> http://www.centoscn.com/CentosSecurity/CentosSafe/2015/0315/4881.html</p> 
<h3><strong>注释掉系统不需要的用户和用户组</strong></h3> 
<p>注意：不建议直接删除，当你需要某个用户时，自己重新添加会很麻烦。</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/6c/70/Nj8b4C4K_o.jpg"></p> 
<h3><strong>关闭系统不需要的服务</strong></h3> 
<p><img alt="" class="has" src="https://images2.imgbox.com/7c/64/X2j5XDTG_o.jpg"></p> 
<h3><strong>给下面的文件加上不可更改属性，从而防止非授权用户获得权限</strong></h3> 
<h3><img alt="" class="has" src="https://images2.imgbox.com/19/3c/FQ2mFXyR_o.jpg"></h3> 
<h3><strong>限制不同文件的权限</strong></h3> 
<h3><img alt="" class="has" height="1" src="https://images2.imgbox.com/f9/28/q1rdITsz_o.gif" width="1"></h3> 
<h3><strong>禁止使用Ctrl+Alt+Del快捷键重启服务器</strong></h3> 
<p><img alt="" class="has" height="1" src="https://images2.imgbox.com/88/84/Eo0XE9dT_o.gif" width="1"></p> 
<h3><strong>使用yum update更新系统时不升级内核，只更新软件包</strong></h3> 
<p>注意：由于系统与硬件的兼容性问题，有可能升级内核后导致服务器不能正常启动，这是非常可怕的，没有特别的需要，建议不要随意升级内核。</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/3f/8f/9NfJhwbH_o.jpg"></p> 
<h3><strong>关闭Centos自动更新</strong></h3> 
<h3><img alt="" class="has" src="https://images2.imgbox.com/7d/4a/Brs5oUxK_o.jpg"></h3> 
<h3><strong>关闭多余的虚拟控制台</strong></h3> 
<h3>我们知道从控制台切换到 X 窗口，一般采用 Alt-F7 ，为什么呢？因为系统默认定义了 6 个虚拟控制台，</h3> 
<p>所以 X 就成了第7个。实际上，很多人一般不会需要这么多虚拟控制台的，修改/etc/inittab ，注释掉那些你不需要的。</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/54/25/rworVEtg_o.jpg"></p> 
<h3><strong>修改history命令记录</strong></h3> 
<h3><img alt="" class="has" src="https://images2.imgbox.com/68/07/wcFZ88rw_o.jpg"></h3> 
<h3><strong>隐藏服务器系统信息</strong></h3> 
<p>在缺省情况下，当你登陆到linux系统，它会告诉你该linux发行版的名称、版本、内核版本、服务器的名称。</p> 
<p>为了不让这些默认的信息泄露出来，我们要进行下面的操作，让它只显示一个"login:"提示符。</p> 
<p>删除/etc/issue和/etc/issue.net这两个文件，或者把这2个文件改名，效果是一样的。</p> 
<p><img alt="" class="has" height="1" src="https://images2.imgbox.com/a9/5e/F4pTA2Au_o.gif" width="1"></p> 
<h3><strong>优化Linux内核参数</strong></h3> 
<h3><img alt="" class="has" src="https://images2.imgbox.com/66/82/Tg6fnIXZ_o.jpg"></h3> 
<h3><strong>系统优化</strong></h3> 
<h3><img alt="" class="has" src="https://images2.imgbox.com/81/20/Ean1m6yM_o.jpg"></h3> 
<h3><strong>服务器禁止ping</strong></h3> 
<h3><img alt="" class="has" src="https://images2.imgbox.com/2f/b8/8KDLZ6f8_o.jpg"></h3> 
<h3><strong>检查口令策略设置是否符合复杂度要求</strong></h3> 
<h3><img alt="" class="has" src="https://images2.imgbox.com/17/d4/cFUnHQfl_o.jpg"></h3> 
<h3><strong>检查登录提示-是否设置登录成功后警告Banner</strong></h3> 
<p>修改文件/etc/motd的内容，如没有该文件，则创建它。</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/24/3b/sI3ei7pP_o.jpg"></p> 
<h3><strong>检查是否设置登录超时</strong></h3> 
<p>执行备份：</p> 
<p><img alt="" class="has" height="1" src="https://images2.imgbox.com/91/ed/2i6YQAFF_o.gif" width="1"></p> 
<p>修改/etc/csh.cshrc文件，添加如下行：</p> 
<p><img alt="" class="has" height="1" src="https://images2.imgbox.com/fb/6d/x5qiOkE3_o.gif" width="1"></p> 
<p>改变这项设置后，重新登录才能有效</p> 
<p> </p> 
<p><strong>5</strong></p> 
<p><strong>多路径设置</strong></p> 
<p> </p> 
<p>随着X86 环境的普及化，Linux 的市场占有率也越来越高，为了方便后续的设备管理我们和Linux 自带多路径软件的成熟化，我们在日常的设备多路径软件选择方面经常会首先考虑使用DM 软件，本次多路径设置主要是结合REDHAT和CENTOS自带软件DM--- Multipath</p> 
<p>参考：<br><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTk0MTM1Mw==&amp;mid=2650626579&amp;idx=2&amp;sn=5ebc8b566abd20d9a20e84ada309e183&amp;chksm=bef92495898ead8341ed5507f72acd1c37b5303d6a87331431588cfa547668c37ed55751a63e&amp;scene=21#wechat_redirect" rel="nofollow">Linux 操作系统层面Multipath 配置使用技巧及注意事项</a>（点击标题可读）</p> 
<p> </p> 
<p><strong>6</strong></p> 
<p><strong>系统异常性能指标获取</strong></p> 
<p> </p> 
<h3><strong>CPU占用最高的10个进程</strong></h3> 
<p><img alt="" class="has" src="https://images2.imgbox.com/46/1c/TUYbd50u_o.jpg"></p> 
<h3><strong>内存占用最高的10个进程</strong></h3> 
<h3><img alt="" class="has" src="https://images2.imgbox.com/6f/13/gagFu15m_o.jpg"></h3> 
<h3><strong>虚拟内存使用最多的前10个进程</strong></h3> 
<p><img alt="" class="has" src="https://images2.imgbox.com/43/8a/9RWG9naZ_o.jpg"></p> 
<h3><strong>查看系统负载</strong></h3> 
<p><img alt="" class="has" src="https://images2.imgbox.com/56/4f/TYo6hj0M_o.jpg"></p> 
<h3><strong>统计当前连接数</strong></h3> 
<p><img alt="" class="has" src="https://images2.imgbox.com/8d/cd/OnIFoUQU_o.jpg"></p> 
<h3><strong>当前连接数最多的10个进程</strong></h3> 
<p><img alt="" class="has" height="1" src="https://images2.imgbox.com/08/80/59qefn1A_o.gif" width="1"></p> 
<p> </p> 
<p><strong>7</strong></p> 
<p><strong>LVM日常使用</strong></p> 
<p> </p> 
<p>LVM在日常运维工作当中占据着很大的比重，在此我列举LVM常见的日常操作及步骤。</p> 
<p>1. 添加一个磁盘到OS，格式化文件系统使用，参考如下：</p> 
<p>扫描磁盘</p> 
<p><img alt="" class="has" height="1" src="https://images2.imgbox.com/ae/6a/OB8A1Gpe_o.gif" width="1"></p> 
<p>这个其中每个步骤就不在做详细解释，有兴趣的可以独自搜索</p> 
<p>2.文件系统的扩容和缩小（根文件系统缩小要相当的慎重）</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/ba/d6/Tp2R3HFi_o.jpg"></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/c5/51/sdm1Sn1s_o.jpg"></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/ee/24/4ki18Ruv_o.jpg"></p> 
<p>在线扩容文件系统：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/a4/0c/KmUTLxrQ_o.jpg"></p> 
<p>缩小文件系统：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/02/79/UyDP554L_o.jpg"></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/8a/f6/O7Bp8eMd_o.jpg"></p> 
<p>3. 在线删除一个共享磁盘LUN</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/ec/ea/tnHlX8q9_o.jpg"></p> 
<p>例如：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/91/5c/dkb9N5kq_o.jpg"></p> 
<p>删除一个不用的lun</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/4b/10/rLKdF0jV_o.jpg"></p> 
<p>删除环节：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/d9/41/B4phchTN_o.jpg"></p> 
<p> </p> 
<p><strong>8</strong></p> 
<p><strong>Linux 运维命令掌握</strong></p> 
<p> </p> 
<p>Linux 下面日常运维使用的命令有太多了，可以根据个人的情况进行适当的记忆。</p> 
<p>系统负载：top ，nmon，dstat 等</p> 
<p>网络：ss，netstat，route，diag，ping，ip，lsof 等</p> 
<p>io：dd，iostat，fio，nmon，dstat，pvs，lvs，vgs 等</p> 
<p>内存：free，dstat等</p> 
<p>进程：ps，lsof 等</p> 
<p>配置：lscpu，lspci，dmidecode,lsscsi，udev 等</p> 
<p>设备识别：echo '---' ,rescan-scsi-bus.sh 等</p> 
<p>诊断：strace,ltrace等</p> 
<p>比如还有find 如何结合xargs ，tree的使用，lsblk 等等，还有很多很多，需要长期的积累，当然主要使用还是配置查看，LVM设置，网络</p> 
<p>还有很多成熟的开源和商业产品进行管理，在此不一一列举，感觉可自行百度和google。</p> 
<p>目前主流的python，ruby这些语言工具可以根据自身情况选择一个掌握。</p> 
<p> </p> 
<p><strong>9</strong></p> 
<p><strong>诊断工具</strong></p> 
<p> </p> 
<p>在日常的运维过程当中，不免要进行所谓的性能或者故障方面问题的诊断，工具和手段包罗万象，在此列举一些日常使用的工具用于参考。</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/99/d3/JY9R0zgC_o.jpg"></p> 
<p>这里附上一幅Linux 开机流程图，这样很多人就可以更加清楚的了解了Linux在启动的整个流程，便于此类问题的解决。</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/67/c3/GyckpNtR_o.jpg"></p> 
<p> </p> 
<p><strong>10</strong></p> 
<p><strong>网络必杀技</strong></p> 
<p> </p> 
<p>Netcat，SSH 几种隧道转发模式 ，lsof，dstat ，ethtool，iptraf，iperf，diag，route 和多个网卡路由及双网卡绑定技术值得了解，这些都是os层面运维网络方面经常会使用到的几个方面</p> 
<p>在日常较为常用的操作就是进行双网卡的绑定，下面分享一个绑定的具体流程：</p> 
<p>1、cp /etc/sysconfig/network/ifcfg-eth0 /etc/sysconfig/network/ifcfg-eth0.bak</p> 
<p>cp /etc/sysconfig/network/ifcfg-eth0 /etc/sysconfig/network/ifcfg-bond0</p> 
<p>2、vi /etc/sysconfig/network/ifcfg-eth0，注释所有（除以下两行内容），并将值修改如下：</p> 
<p>BOOTPROTO='none'</p> 
<p>STARTMODE='off'</p> 
<p>3、cp /etc/sysconfig/network/ifcfg-eth0 /etc/sysconfig/network/ifcfg-eth1</p> 
<p>4、vi /etc/sysconfig/network/ifcfg-bond0，增加或更新如下内容，其他内容可注释：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/85/da/blRMOpkZ_o.jpg"></p> 
<p>说明：以上配置mode=0为负载均衡模式，如果需要配置成主备模式，BONDING_MODULE_OPTS配置如下：</p> 
<p>BONDING_MODULE_OPTS='mode=1 miimon=100 use_carrier=0 primary=eth0'</p> 
<p>5、rcnetwork restart，重启网络服务生效，并进行测试。</p> 
<p>6、cat /proc/net/bonding/bond0 可以查看bonding的状态。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/62b484ff2a703f1f252f121c19c60660/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">两数相乘溢出的问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/97583d008952f58a2f8380aefbe19189/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">selenium保存网页html文件的几种方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>