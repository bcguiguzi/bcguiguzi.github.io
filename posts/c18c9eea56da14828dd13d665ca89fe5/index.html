<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux环境搭建OpenCV运行java-cv代码 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux环境搭建OpenCV运行java-cv代码" />
<meta property="og:description" content="1.Windows系统运行java-cv代码 安装OpenCV 在Windows安装OpenCV比较简单，进入官网，进入releases，选择Windows版本，下载执行文件，然后一步一步执行可视化安装即可。
OpenCV官网：https://opencv.org
安装完成后，安装目录如下：
进入build目录:
进入java目录：
可以看到opencv-460.jar包，这个后续会用到。
进入x64目录：
这里的opencv_java460.dll是后续Native类会调用的动态链接库。
运行java-cv进行人脸检测 引入依赖 &lt;dependency&gt; &lt;groupId&gt;org.bytedeco&lt;/groupId&gt; &lt;artifactId&gt;javacv&lt;/artifactId&gt; &lt;version&gt;1.5.8&lt;/version&gt; &lt;/dependency&gt; 添加opencv-460到类路径 打开IDEA的工程结构界面，将opencv-460.jar包添加到依赖库中。
配置opencv_java460.dll 后续代码需要加载dll文件，所以需要将opencv_java460.dll放到path路径中，Windows系统，直接放到C:\Windows\System32目录即可。
代码案例 下面的代码进行人脸检测：
// 加载本地库 System.loadLibrary(Core.NATIVE_LIBRARY_NAME); // 新建人脸识别类对象 CascadeClassifier faceDetector = new CascadeClassifier(&#34;D:\\haarcascade_frontalface_alt.xml&#34;); // 原始照片 Mat image = Imgcodecs.imread(&#34;D:\\test.png&#34;); MatOfRect faceDetections = new MatOfRect(); // 进行人脸检测 faceDetector.detectMultiScale(image, faceDetections); 上面代码主要分为四个步骤：
从系统中加载native库创建人脸识别类对象读取图片进行人脸检测 OpenCV 库中的人脸检测功能，需要用到haarcascade_frontalface_alt.xml 特征分类器文件，该文件包含了一系列针对人脸的分类器，可以用于识别图像或视频中的人脸区域。
代码调用链分析 下面来分析一下下面这段代码(加载本地库)的调用链路：
System.loadLibrary(Core.NATIVE_LIBRARY_NAME); 通过libname加载本地库：
public static void loadLibrary(String libname) { Runtime.getRuntime().loadLibrary0(Reflection.getCallerClass(), libname); } 查看libname取值：
public static final String NATIVE_LIBRARY_NAME = getNativeLibraryName(); private static String getNativeLibraryName() { return &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/c18c9eea56da14828dd13d665ca89fe5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-30T17:21:55+08:00" />
<meta property="article:modified_time" content="2023-05-30T17:21:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux环境搭建OpenCV运行java-cv代码</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h5><a id="1Windowsjavacv_0"></a>1.Windows系统运行java-cv代码</h5> 
<h6><a id="OpenCV_1"></a>安装OpenCV</h6> 
<p>在Windows安装OpenCV比较简单，进入官网，进入releases，选择Windows版本，下载执行文件，然后一步一步执行可视化安装即可。<br> OpenCV官网：<a href="https://opencv.org/releases/" rel="nofollow">https://opencv.org</a><br> 安装完成后，安装目录如下：<br> <img src="https://images2.imgbox.com/bd/1d/WL4hwY6K_o.png" alt="image.png"><br> 进入build目录:<br> <img src="https://images2.imgbox.com/d1/8d/uHwfqqix_o.png" alt="image.png"><br> 进入java目录：<br> <img src="https://images2.imgbox.com/90/bc/wNh9vj0h_o.png" alt="image.png"><br> 可以看到opencv-460.jar包，这个后续会用到。<br> 进入x64目录：<br> <img src="https://images2.imgbox.com/b4/fa/AWuwB1Uc_o.png" alt="image.png"><br> 这里的opencv_java460.dll是后续Native类会调用的动态链接库。</p> 
<h6><a id="javacv_14"></a>运行java-cv进行人脸检测</h6> 
<h6><a id="_15"></a>引入依赖</h6> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.bytedeco<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>javacv<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.5.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h6><a id="opencv460_23"></a>添加opencv-460到类路径</h6> 
<p>打开IDEA的工程结构界面，将opencv-460.jar包添加到依赖库中。<br> <img src="https://images2.imgbox.com/5d/ee/5knJOVGH_o.png" alt="image.png"></p> 
<h6><a id="opencv_java460dll_26"></a>配置opencv_java460.dll</h6> 
<p>后续代码需要加载dll文件，所以需要将opencv_java460.dll放到path路径中，Windows系统，直接放到C:\Windows\System32目录即可。</p> 
<h6><a id="_28"></a>代码案例</h6> 
<p>下面的代码进行人脸检测：</p> 
<pre><code class="prism language-java"><span class="token comment">// 加载本地库</span>
<span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token class-name">Core</span><span class="token punctuation">.</span>NATIVE_LIBRARY_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 新建人脸识别类对象</span>
<span class="token class-name">CascadeClassifier</span> faceDetector <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CascadeClassifier</span><span class="token punctuation">(</span><span class="token string">"D:\\haarcascade_frontalface_alt.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 原始照片</span>
<span class="token class-name">Mat</span> image <span class="token operator">=</span> <span class="token class-name">Imgcodecs</span><span class="token punctuation">.</span><span class="token function">imread</span><span class="token punctuation">(</span><span class="token string">"D:\\test.png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">MatOfRect</span> faceDetections <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MatOfRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 进行人脸检测</span>
faceDetector<span class="token punctuation">.</span><span class="token function">detectMultiScale</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> faceDetections<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>上面代码主要分为四个步骤：</p> 
<ul><li>从系统中加载native库</li><li>创建人脸识别类对象</li><li>读取图片</li><li>进行人脸检测</li></ul> 
<p>OpenCV 库中的人脸检测功能，需要用到haarcascade_frontalface_alt.xml 特征分类器文件，该文件包含了一系列针对人脸的分类器，可以用于识别图像或视频中的人脸区域。</p> 
<h6><a id="_49"></a>代码调用链分析</h6> 
<p>下面来分析一下下面这段代码(加载本地库)的调用链路：</p> 
<pre><code class="prism language-java"><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token class-name">Core</span><span class="token punctuation">.</span>NATIVE_LIBRARY_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>通过libname加载本地库：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token class-name">String</span> libname<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadLibrary0</span><span class="token punctuation">(</span><span class="token class-name">Reflection</span><span class="token punctuation">.</span><span class="token function">getCallerClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> libname<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>查看libname取值：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> NATIVE_LIBRARY_NAME <span class="token operator">=</span> <span class="token function">getNativeLibraryName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getNativeLibraryName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> <span class="token string">"opencv_java460"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre> 
<p>从上面可以看出代码是通过opencv_java460这个名称来加载本地库的。<br> 接下来看看是从哪加载的本地库：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token class-name">String</span> libname<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">loadLibrary0</span><span class="token punctuation">(</span><span class="token class-name">Reflection</span><span class="token punctuation">.</span><span class="token function">getCallerClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> libname<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">loadLibrary0</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> fromClass<span class="token punctuation">,</span> <span class="token class-name">String</span> libname<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">SecurityManager</span> security <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>security <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        security<span class="token punctuation">.</span><span class="token function">checkLink</span><span class="token punctuation">(</span>libname<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>libname<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token class-name">File</span><span class="token punctuation">.</span>separatorChar<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsatisfiedLinkError</span><span class="token punctuation">(</span><span class="token string">"Directory separator should not appear in library name: "</span> <span class="token operator">+</span> libname<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span>fromClass<span class="token punctuation">,</span> libname<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> fromClass<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isAbsolute<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">ClassLoader</span> loader <span class="token operator">=</span><span class="token punctuation">(</span>fromClass <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> fromClass<span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>sys_paths <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        usr_paths <span class="token operator">=</span> <span class="token function">initializePath</span><span class="token punctuation">(</span><span class="token string">"java.library.path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sys_paths <span class="token operator">=</span> <span class="token function">initializePath</span><span class="token punctuation">(</span><span class="token string">"sun.boot.library.path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>上面代码表明是从"java.library.path"路径加载的本地库，至于"java.library.path"路径是哪个目录，可以通过下面代码确认：</p> 
<pre><code class="prism language-java"><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"java.library.path"</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行改代码输出结果为opencv_java460.dll所在的路径。</p> 
<h5><a id="2LinuxOpenCV_97"></a>2.Linux系统安装OpenCV</h5> 
<h6><a id="jdk_98"></a>安装jdk配置环境变量</h6> 
<p>略</p> 
<h6><a id="ant_100"></a>安装ant</h6> 
<p>JavaCV 在构建过程中需要Ant 来构建和编译 C++ 代码，生成对应的 Java JNI 接口和共享库文件，在安装 JavaCV 之前，需要先安装 Ant 工具。下面通过yum来安装ant</p> 
<pre><code class="prism language-shell"><span class="token function">sudo</span> yum <span class="token function">install</span> ant
</code></pre> 
<p>配置环境变量：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">ANT_HOME</span><span class="token operator">=</span>/usr/share/ant
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$ANT_HOME</span>/bin
</code></pre> 
<p>安装完成后查看ant版本：</p> 
<pre><code class="prism language-shell">ant -version
</code></pre> 
<p>如果上面代码报错：Caused by: java.lang.ClassNotFoundException: org.apache.tools.ant.launch.Launcher<br> 表示Ant 的 launcher JAR 文件没有在 classpath 中找到，需要将 Ant launcher JAR 文件添加到 classpath中：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">CLASSPATH</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$ANT_HOME</span>/lib/ant-launcher.jar:<span class="token variable">$CLASSPATH</span>"</span>
</code></pre> 
<h6><a id="OpenCV_119"></a>安装OpenCV</h6> 
<p>首先下载opencv-4.5.5.tar.gz、opencv_contrib-4.5.5.tar.gz两个安装包，<br> opencv-4.5.5.tar.gz下载地址：<a href="https://github.com/opencv/opencv/tags">https://github.com/opencv/opencv/tags</a><br> opencv_contrib-4.5.5.tar.gz下载地址：<a href="https://github.com/opencv/opencv_contrib/tags">https://github.com/opencv/opencv_contrib/tags</a><br> 解压安装包：</p> 
<pre><code class="prism language-shell"><span class="token function">tar</span> -zxvf opencv-4.5.5.tar.gz
<span class="token function">tar</span> -zxvf opencv_contrib-4.5.5.tar.gz
</code></pre> 
<p>进入opencv-4.5.5目录，新建build目录：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">cd</span> ./opencv-4.5.5
<span class="token function">mkdir</span> build
</code></pre> 
<p>进入build目录：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">cd</span> build
</code></pre> 
<p>执行构建：</p> 
<pre><code class="prism language-shell">cmake -D <span class="token assign-left variable">CMAKE_BUILD_TYPE</span><span class="token operator">=</span>RELEASE -D <span class="token assign-left variable">CMAKE_INSTALL_PREFIX</span><span class="token operator">=</span>/usr/local -D <span class="token assign-left variable">OPENCV_GENERATE_PKGCONFIG</span><span class="token operator">=</span>ON -D <span class="token assign-left variable">OPENCV_EXTRA_MODULES_PATH</span><span class="token operator">=</span>/root/software/opencv_contrib-4.5.5/modules -D <span class="token assign-left variable">ENABLE_CXX11</span><span class="token operator">=</span>ON -D <span class="token assign-left variable">WITH_1394</span><span class="token operator">=</span>OFF -D <span class="token assign-left variable">BUILD_opencv_xfeatures2d</span><span class="token operator">=</span>OFF -D <span class="token assign-left variable">BUILD_SHARED_LIBS</span><span class="token operator">=</span>OFF -D <span class="token assign-left variable">BUILD_TESTS</span><span class="token operator">=</span>OFF <span class="token punctuation">..</span>
</code></pre> 
<p>上面构建过程参考：<a href="https://blog.csdn.net/qq_21347647/article/details/127746951">https://blog.csdn.net/qq_21347647/article/details/127746951</a>《Linux环境下编译并使用java_opencv》<br> 然后进行编译：</p> 
<pre><code class="prism language-shell"><span class="token function">make</span> -j4
<span class="token function">make</span> <span class="token function">install</span>
</code></pre> 
<p>编译完成后，查看/usr/local/share/java/opencv4目录：<br> <img src="https://images2.imgbox.com/fe/d0/E61ZOgC3_o.png" alt="image.png"><br> 看是否生成so与jar文件，没有的话需要分析原因重新编译。</p> 
<h6><a id="javacv_150"></a>运行java-cv进行人脸检测</h6> 
<h6><a id="_151"></a>可能的报错</h6> 
<p>完成OpenCV安装后，在Linux环境运行java-cv代码进行人脸检测，如果报如下错误：<br> <img src="https://images2.imgbox.com/29/e5/mzqhAFY5_o.png" alt="image.png"><br> 根据上面的代码调用链分析，系统在loadLibrary的时候没有从java.library.path中找到相关的库文件(报错信息里面是opencv_java460.so文件)。</p> 
<h6><a id="opencv_java460_155"></a>为什么是读取opencv_java460库文件</h6> 
<p>Linux环境安装的OpenCV版本是4.5.5，可是代码缺报错找不到opencv_java460对应的本地库文件。<br> 先看maven依赖：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.bytedeco<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>javacv<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.5.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>通过Dependency Analyzer插件查看引入的opencv版本：<br> <img src="https://images2.imgbox.com/32/16/BoVsxHe6_o.png" alt="image.png"><br> 从上面的依赖树可以看出，javacv1.5.8对应引入的opencv是4.6.0版本(Windows系统安装的也是该版本)，<br> 通过下面的代码可以看出，系统是通过opencv_java460这个name来加载相关本地库的：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> NATIVE_LIBRARY_NAME <span class="token operator">=</span> <span class="token function">getNativeLibraryName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getNativeLibraryName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> <span class="token string">"opencv_java460"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre> 
<p>下面将javacv的版本改成1.5.7，再通过Dependency Analyzer插件查看引入的opencv版本：<br> <img src="https://images2.imgbox.com/28/a6/GqoTntM2_o.png" alt="image.png"><br> 可以看出，javacv1.5.7对应的opencv版本正是4.5.5，由于Linux环境安装的OpenCV是4.5.5，所以将代码重新打包到Linux环境运行。</p> 
<h6><a id="_177"></a>配置环境变量</h6> 
<p>将/usr/local/share/java/opencv4目录下的libopencv_java455.so文件路径添加到LD_LIBRARY_PATH路径中：</p> 
<pre><code class="prism language-shell"><span class="token assign-left variable">LD_LIBRARY_PATH</span><span class="token operator">=</span><span class="token variable">$LD_LIBRARY_PATH</span>:/usr/local/leptonica/lib:/usr/local/tesseract/lib:/usr/local/share/java/opencv4
<span class="token builtin class-name">export</span> LD_LIBRARY_PATH
</code></pre> 
<p>重新运行java-cv代码。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f5670294a68185167a941be4ee3aff24/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于HTTP/HTTPS协议的京东 API接口的接入示例</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2a66617163e4548ea740a32a67d8686e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux环境下运行Tess4j进行OCR识别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>