<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【最短路&amp;DP】BZOJ5047空间传送装置 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【最短路&amp;DP】BZOJ5047空间传送装置" />
<meta property="og:description" content="说实话，第一次打BZOJ的月赛，本来是准备充分的，但由于英语考试，然后班主任又喂了一节课的鸡汤，导致最后只剩下一个半小时。也只做出来这一道题（蒟蒻属性暴露无遗）
题目描述 太空中一共有n座星球，它们之间可以通过空间传送装置进行转移。空间传送装置分为m种，第i种装置可以用4个参数 ai,bi,ci,di 来描述。因为时空抖动的问题，在非整数时刻禁止使用空间传送装置。如果在整数s时刻使用装置，那么需要花费 ((ai∗s&#43;bi)modci)&#43;di 单位时间才能完成传送。现在是s时刻，小Q位于1号星球，请写一个程序计算从1号星球到每个星球最少需要的时间。
第一行包含4个正整数n,m,s,e(2&lt;=n&lt;=100000,1&lt;=m&lt;=50,1&lt;=s&lt;=2000,1&lt;=e&lt;=200000) 分别表示星球的个数、空间传送装置的种类数、当前的时间以及空间传送装置的个数。 接下来m行，每行4个正整数a_i,b_i,c_i,d_i(1&lt;=a_i,b_i,c_i,d_i&lt;=2000)，依次描述每种装置的参数。 接下来e行，每行3个正整数u_i,v_i,w_i(1&lt;=u_i,v_i&lt;=n,u_i!=v_i,1&lt;=w_i&lt;=m) 表示从星球u_i可以使用第w_i种装置单向传送到星球v_i。
分析 设我们可以在 i,j 两个时间到达某一个点 （i&lt;j） 因为这道题的路程消耗与出发时间有关，所以可能会担忧这样会不会i比j还要劣一些。然而其实只要稍加思考，就会发现不存在这样的问题，因为这道题允许等待！i时刻完全可以在原地等到j时刻再出发，这样早到的无论如何都不比晚到的差。这样一来，只要能算出 ((ai∗s&#43;bi)modci)&#43;di 在不同s下的最小值，那么这道题就变成了裸的最短路了。 首先，我们很容易想到，我们需要考虑的出发时间只有 [0,ci) 这个区间，不在这个区间内的，我们把出发时间s mod c_i即可。 那么整个问题就变成了： 统计不同出发时间的分别的路程消耗的最小值。 机制地发现数据范围小了很多： m&lt;=50,c&lt;=2000 感受到了DP的气息。 首先，我们忽略c-1秒，在0秒到c-2秒中： 对于某个时间t，设其消耗时间为dp[t]， 我们可以选择： 等待一秒， dp[t]=dp[t&#43;1]&#43;1 一秒钟都不等，直接从当前时刻出发：即 dp[t]=((ai∗t&#43;bi)modci)&#43;di 转移方程很容易理解，那么问题来了，c-1秒怎么解决？ 答案是：暴力呗。。。 只有50个c-1秒，我们等待时间也在 [0,c−1] 的范围内，直接每个等待时间枚举一次就好了嘛（亏cch还想了半天怎么高效地算出c-1的消耗）。
附上代码：（考场上脑残地wa了4次，全是因为输出的时候逗逼了）
#include&lt;cstdio&gt; #include&lt;cstring&gt; #include&lt;algorithm&gt; #include&lt;climits&gt; #include&lt;cmath&gt; #include&lt;vector&gt; #include&lt;queue&gt; #define SF scanf #define PF printf #define MAXT 55 #define MAXC 2010 #define MAXN 100010 #define MAXM 200010 using namespace std; int n,m,tot,dist[MAXN],res; vector&lt;int&gt; d[MAXN],p[MAXN]; bool inq[MAXN]; int dp[MAXT][MAXC]; queue&lt;int&gt; q; struct node{ int a,b,c,d; }s[MAXT]; void prepare(){ for(int i=1;i&lt;=tot;i&#43;&#43;){ int st=s[i]." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/9ca17e45384a35820fdaaf6fec6cbacb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-09-23T07:50:44+08:00" />
<meta property="article:modified_time" content="2017-09-23T07:50:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【最短路&amp;DP】BZOJ5047空间传送装置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>说实话，第一次打BZOJ的月赛，本来是准备充分的，但由于英语考试，然后班主任又喂了一节课的鸡汤，导致最后只剩下一个半小时。也只做出来这一道题（蒟蒻属性暴露无遗）</p> 
<h5 id="题目描述"><strong>题目描述</strong></h5> 
<p>太空中一共有n座星球，它们之间可以通过空间传送装置进行转移。空间传送装置分为m种，第i种装置可以用4个参数<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-308-Frame"> 
   
   <span class="math" id="MathJax-Span-6041" style="width: 4.88em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.509em; height: 0px; font-size: 108%;"><span style="position: absolute; clip: rect(1.299em 1000em 2.534em -0.491em); top: -2.157em; left: 0.003em;"><span class="mrow" id="MathJax-Span-6042"><span class="msubsup" id="MathJax-Span-6043"><span style="display: inline-block; position: relative; width: 0.806em; height: 0px;"><span style="position: absolute; clip: rect(1.485em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-6044" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.497em;"><span class="mi" id="MathJax-Span-6045" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span><span class="mo" id="MathJax-Span-6046" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-6047" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px;"><span style="position: absolute; clip: rect(1.238em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-6048" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.435em;"><span class="mi" id="MathJax-Span-6049" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span><span class="mo" id="MathJax-Span-6050" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-6051" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px;"><span style="position: absolute; clip: rect(1.485em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-6052" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.435em;"><span class="mi" id="MathJax-Span-6053" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span><span class="mo" id="MathJax-Span-6054" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-6055" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.867em; height: 0px;"><span style="position: absolute; clip: rect(1.238em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-6056" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.559em;"><span class="mi" id="MathJax-Span-6057" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.164em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.07em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-308">a_i,b_i,c_i,d_i</script>来描述。因为时空抖动的问题，在非整数时刻禁止使用空间传送装置。如果在整数s时刻使用装置，那么需要花费<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-309-Frame"> 
   
   <span class="math" id="MathJax-Span-6058" style="width: 11.361em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.497em; height: 0px; font-size: 108%;"><span style="position: absolute; clip: rect(1.238em 1000em 2.596em -0.429em); top: -2.157em; left: 0.003em;"><span class="mrow" id="MathJax-Span-6059"><span class="mo" id="MathJax-Span-6060" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-6061" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-6062"><span style="display: inline-block; position: relative; width: 0.806em; height: 0px;"><span style="position: absolute; clip: rect(1.485em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-6063" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.497em;"><span class="mi" id="MathJax-Span-6064" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span><span class="mo" id="MathJax-Span-6065" style="font-family: MathJax_Main; padding-left: 0.25em;">∗</span><span class="mi" id="MathJax-Span-6066" style="font-family: MathJax_Math-italic; padding-left: 0.25em;">s</span><span class="mo" id="MathJax-Span-6067" style="font-family: MathJax_Main; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-6068" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px;"><span style="position: absolute; clip: rect(1.238em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-6069" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.435em;"><span class="mi" id="MathJax-Span-6070" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span><span class="mo" id="MathJax-Span-6071" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-6072" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-6073" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-6074" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-6075"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px;"><span style="position: absolute; clip: rect(1.485em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-6076" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.435em;"><span class="mi" id="MathJax-Span-6077" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span><span class="mo" id="MathJax-Span-6078" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-6079" style="font-family: MathJax_Main; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-6080" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.867em; height: 0px;"><span style="position: absolute; clip: rect(1.238em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-6081" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.559em;"><span class="mi" id="MathJax-Span-6082" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.164em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-309">((a_i*s+b_i) mod c_i)+d_i</script>单位时间才能完成传送。现在是s时刻，小Q位于1号星球，请写一个程序计算从1号星球到每个星球最少需要的时间。</p> 
<p>第一行包含4个正整数n,m,s,e(2&lt;=n&lt;=100000,1&lt;=m&lt;=50,1&lt;=s&lt;=2000,1&lt;=e&lt;=200000) <br> 分别表示星球的个数、空间传送装置的种类数、当前的时间以及空间传送装置的个数。 <br> 接下来m行，每行4个正整数a_i,b_i,c_i,d_i(1&lt;=a_i,b_i,c_i,d_i&lt;=2000)，依次描述每种装置的参数。 <br> 接下来e行，每行3个正整数u_i,v_i,w_i(1&lt;=u_i,v_i&lt;=n,u_i!=v_i,1&lt;=w_i&lt;=m) <br> 表示从星球u_i可以使用第w_i种装置单向传送到星球v_i。</p> 
<hr> 
<h5 id="分析"><strong>分析</strong></h5> 
<p>设我们可以在<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1251-Frame"> 
   
   <span class="math" id="MathJax-Span-19525" style="width: 1.361em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.238em; height: 0px; font-size: 108%;"><span style="position: absolute; clip: rect(1.299em 1000em 2.534em -0.552em); top: -2.157em; left: 0.003em;"><span class="mrow" id="MathJax-Span-19526"><span class="mi" id="MathJax-Span-19527" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-19528" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-19529" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">j</span></span><span style="display: inline-block; width: 0px; height: 2.164em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.07em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-1251">i,j</script>两个时间到达某一个点<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1252-Frame"> 
   
   <span class="math" id="MathJax-Span-19530" style="width: 4.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.015em; height: 0px; font-size: 108%;"><span style="position: absolute; clip: rect(1.238em 1000em 2.596em -0.552em); top: -2.219em; left: 0.003em;"><span class="mrow" id="MathJax-Span-19531"><span class="texatom" id="MathJax-Span-19532"><span class="mrow" id="MathJax-Span-19533"><span class="mo" id="MathJax-Span-19534"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 93%; font-style: normal; font-weight: normal;">（</span></span></span></span><span class="mi" id="MathJax-Span-19535" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-19536" style="font-family: MathJax_Main; padding-left: 0.312em;">&lt;</span><span class="mi" id="MathJax-Span-19537" style="font-family: MathJax_Math-italic; padding-left: 0.312em;">j</span><span class="texatom" id="MathJax-Span-19538"><span class="mrow" id="MathJax-Span-19539"><span class="mo" id="MathJax-Span-19540"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 93%; font-style: normal; font-weight: normal;">）</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-1252">（i<j）</script> <br> 因为这道题的路程消耗与出发时间有关，所以可能会担忧这样会不会i比j还要劣一些。然而其实只要稍加思考，就会发现不存在这样的问题，因为这道题允许等待！i时刻完全可以在原地等到j时刻再出发，这样早到的无论如何都不比晚到的差。这样一来，只要能算出<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1253-Frame"> 
   
   <span class="math" id="MathJax-Span-19541" style="width: 11.361em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.497em; height: 0px; font-size: 108%;"><span style="position: absolute; clip: rect(1.238em 1000em 2.596em -0.429em); top: -2.157em; left: 0.003em;"><span class="mrow" id="MathJax-Span-19542"><span class="mo" id="MathJax-Span-19543" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-19544" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-19545"><span style="display: inline-block; position: relative; width: 0.806em; height: 0px;"><span style="position: absolute; clip: rect(1.485em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-19546" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.497em;"><span class="mi" id="MathJax-Span-19547" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span><span class="mo" id="MathJax-Span-19548" style="font-family: MathJax_Main; padding-left: 0.25em;">∗</span><span class="mi" id="MathJax-Span-19549" style="font-family: MathJax_Math-italic; padding-left: 0.25em;">s</span><span class="mo" id="MathJax-Span-19550" style="font-family: MathJax_Main; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-19551" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px;"><span style="position: absolute; clip: rect(1.238em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-19552" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.435em;"><span class="mi" id="MathJax-Span-19553" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span><span class="mo" id="MathJax-Span-19554" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-19555" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-19556" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-19557" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-19558"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px;"><span style="position: absolute; clip: rect(1.485em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-19559" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.435em;"><span class="mi" id="MathJax-Span-19560" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span><span class="mo" id="MathJax-Span-19561" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-19562" style="font-family: MathJax_Main; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-19563" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.867em; height: 0px;"><span style="position: absolute; clip: rect(1.238em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-19564" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.559em;"><span class="mi" id="MathJax-Span-19565" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.164em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-1253">((a_i*s+b_i) mod c_i)+d_i</script>在不同s下的最小值，那么这道题就变成了裸的最短路了。 <br> 首先，我们很容易想到，我们需要考虑的出发时间只有<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1254-Frame"> 
   
   <span class="math" id="MathJax-Span-19566" style="width: 2.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.349em; height: 0px; font-size: 108%;"><span style="position: absolute; clip: rect(1.238em 1000em 2.596em -0.429em); top: -2.157em; left: 0.003em;"><span class="mrow" id="MathJax-Span-19567"><span class="mo" id="MathJax-Span-19568" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-19569" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-19570" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-19571" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px;"><span style="position: absolute; clip: rect(1.485em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-19572" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.435em;"><span class="mi" id="MathJax-Span-19573" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span><span class="mo" id="MathJax-Span-19574" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.164em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-1254">[0,c_i)</script>这个区间，不在这个区间内的，我们把出发时间s mod c_i即可。 <br> 那么整个问题就变成了： <br> 统计不同出发时间的分别的路程消耗的最小值。 <br> 机制地发现数据范围小了很多： <br> m&lt;=50,c&lt;=2000 <br> 感受到了DP的气息。 <br> 首先，我们忽略c-1秒，在0秒到c-2秒中： <br> 对于某个时间t，设其消耗时间为dp[t]， <br> 我们可以选择： <br> 等待一秒，<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1255-Frame"> 
   
   <span class="math" id="MathJax-Span-19575" style="width: 9.262em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.583em; height: 0px; font-size: 108%;"><span style="position: absolute; clip: rect(1.238em 1000em 2.596em -0.491em); top: -2.157em; left: 0.003em;"><span class="mrow" id="MathJax-Span-19576"><span class="mi" id="MathJax-Span-19577" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-19578" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-19579" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-19580" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-19581" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-19582" style="font-family: MathJax_Main; padding-left: 0.312em;">=</span><span class="mi" id="MathJax-Span-19583" style="font-family: MathJax_Math-italic; padding-left: 0.312em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-19584" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-19585" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-19586" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-19587" style="font-family: MathJax_Main; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-19588" style="font-family: MathJax_Main; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-19589" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-19590" style="font-family: MathJax_Main; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-19591" style="font-family: MathJax_Main; padding-left: 0.25em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.164em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-1255">dp[t]=dp[t+1]+1</script> <br> 一秒钟都不等，直接从当前时刻出发：即<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1256-Frame"> 
   
   <span class="math" id="MathJax-Span-19592" style="width: 14.694em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.583em; height: 0px; font-size: 108%;"><span style="position: absolute; clip: rect(1.238em 1000em 2.596em -0.491em); top: -2.157em; left: 0.003em;"><span class="mrow" id="MathJax-Span-19593"><span class="mi" id="MathJax-Span-19594" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-19595" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-19596" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-19597" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-19598" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-19599" style="font-family: MathJax_Main; padding-left: 0.312em;">=</span><span class="mo" id="MathJax-Span-19600" style="font-family: MathJax_Main; padding-left: 0.312em;">(</span><span class="mo" id="MathJax-Span-19601" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-19602"><span style="display: inline-block; position: relative; width: 0.806em; height: 0px;"><span style="position: absolute; clip: rect(1.485em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-19603" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.497em;"><span class="mi" id="MathJax-Span-19604" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span><span class="mo" id="MathJax-Span-19605" style="font-family: MathJax_Main; padding-left: 0.25em;">∗</span><span class="mi" id="MathJax-Span-19606" style="font-family: MathJax_Math-italic; padding-left: 0.25em;">t</span><span class="mo" id="MathJax-Span-19607" style="font-family: MathJax_Main; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-19608" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px;"><span style="position: absolute; clip: rect(1.238em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-19609" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.435em;"><span class="mi" id="MathJax-Span-19610" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span><span class="mo" id="MathJax-Span-19611" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-19612" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-19613" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-19614" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-19615"><span style="display: inline-block; position: relative; width: 0.744em; height: 0px;"><span style="position: absolute; clip: rect(1.485em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-19616" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.435em;"><span class="mi" id="MathJax-Span-19617" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span><span class="mo" id="MathJax-Span-19618" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-19619" style="font-family: MathJax_Main; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-19620" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.867em; height: 0px;"><span style="position: absolute; clip: rect(1.238em 1000em 2.287em -0.491em); top: -2.096em; left: 0.003em;"><span class="mi" id="MathJax-Span-19621" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span><span style="position: absolute; top: -1.972em; left: 0.559em;"><span class="mi" id="MathJax-Span-19622" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.102em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.164em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-1256">dp[t]=((a_i*t+b_i) mod c_i)+d_i</script> <br> 转移方程很容易理解，那么问题来了，c-1秒怎么解决？ <br> 答案是：暴力呗。。。 <br> 只有50个c-1秒，我们等待时间也在<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1257-Frame"> 
   
   <span class="math" id="MathJax-Span-19623" style="width: 3.892em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.583em; height: 0px; font-size: 108%;"><span style="position: absolute; clip: rect(1.238em 1000em 2.596em -0.429em); top: -2.157em; left: 0.003em;"><span class="mrow" id="MathJax-Span-19624"><span class="mo" id="MathJax-Span-19625" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-19626" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-19627" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-19628" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">c</span><span class="mo" id="MathJax-Span-19629" style="font-family: MathJax_Main; padding-left: 0.25em;">−</span><span class="mn" id="MathJax-Span-19630" style="font-family: MathJax_Main; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-19631" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.164em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-1257">[0,c-1]</script>的范围内，直接每个等待时间枚举一次就好了嘛（亏cch还想了半天怎么高效地算出c-1的消耗）。</p> 
<p>附上代码：（考场上脑残地wa了4次，全是因为输出的时候逗逼了）</p> 
<pre class="prettyprint"><code class=" hljs cpp"><span class="hljs-preprocessor">#include&lt;cstdio&gt;</span>
<span class="hljs-preprocessor">#include&lt;cstring&gt;</span>
<span class="hljs-preprocessor">#include&lt;algorithm&gt;</span>
<span class="hljs-preprocessor">#include&lt;climits&gt;</span>
<span class="hljs-preprocessor">#include&lt;cmath&gt;</span>
<span class="hljs-preprocessor">#include&lt;vector&gt;</span>
<span class="hljs-preprocessor">#include&lt;queue&gt;</span>
<span class="hljs-preprocessor">#define SF scanf</span>
<span class="hljs-preprocessor">#define PF printf</span>
<span class="hljs-preprocessor">#define MAXT 55</span>
<span class="hljs-preprocessor">#define MAXC 2010</span>
<span class="hljs-preprocessor">#define MAXN 100010</span>
<span class="hljs-preprocessor">#define MAXM 200010</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> n,m,tot,dist[MAXN],res;
<span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span> d[MAXN],p[MAXN];
<span class="hljs-keyword">bool</span> inq[MAXN];
<span class="hljs-keyword">int</span> dp[MAXT][MAXC];
<span class="hljs-stl_container"><span class="hljs-built_in">queue</span>&lt;<span class="hljs-keyword">int</span>&gt;</span> q;
<span class="hljs-keyword">struct</span> node{
    <span class="hljs-keyword">int</span> a,b,c,d;
}s[MAXT];
<span class="hljs-keyword">void</span> prepare(){
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=tot;i++){
        <span class="hljs-keyword">int</span> st=s[i].c-<span class="hljs-number">1</span>;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;s[i].c;j++)
            dp[i][st]=min(dp[i][st],((st+j)*s[i].a+s[i].b)%s[i].c+s[i].d+j);
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=s[i].c-<span class="hljs-number">2</span>;j&gt;=<span class="hljs-number">0</span>;j--)
            dp[i][j]=min(dp[i][j+<span class="hljs-number">1</span>]+<span class="hljs-number">1</span>,(j*s[i].a+s[i].b)%s[i].c+s[i].d);
    }
}
<span class="hljs-keyword">void</span> spfa(){
    q.push(<span class="hljs-number">1</span>);
    <span class="hljs-keyword">while</span>(!q.empty()){
        <span class="hljs-keyword">int</span> x=q.front();
        q.pop();
        inq[x]=<span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;d[x].size();i++){
            <span class="hljs-keyword">int</span> t=dp[p[x][i]][dist[x]%s[p[x][i]].c];
            <span class="hljs-keyword">int</span> y=d[x][i];
            <span class="hljs-keyword">if</span>(dist[y]==-<span class="hljs-number">1</span>||dist[y]&gt;dist[x]+t){
                dist[y]=dist[x]+t;
                <span class="hljs-keyword">if</span>(inq[y]==<span class="hljs-number">0</span>){
                    q.push(y);
                    inq[y]=<span class="hljs-number">1</span>;
                }
            }
        }
    }
}
<span class="hljs-keyword">int</span> main(){
    <span class="hljs-built_in">memset</span>(dp,<span class="hljs-number">0x3f</span>,<span class="hljs-keyword">sizeof</span> dp);
    <span class="hljs-keyword">int</span> st;
    <span class="hljs-built_in">memset</span>(dist,-<span class="hljs-number">1</span>,<span class="hljs-keyword">sizeof</span> dist);
    SF(<span class="hljs-string">"%d%d%d%d"</span>,&amp;n,&amp;tot,&amp;st,&amp;m);
    <span class="hljs-keyword">int</span> x,y,z;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=tot;i++){
        SF(<span class="hljs-string">"%d%d%d%d"</span>,&amp;s[i].a,&amp;s[i].b,&amp;s[i].c,&amp;s[i].d);
        s[i].a%=s[i].c;
        s[i].b%=s[i].c;
    }
    prepare();
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++){
        SF(<span class="hljs-string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);
        d[x].push_back(y);
        p[x].push_back(z);
    }
    dist[<span class="hljs-number">1</span>]=st;
    spfa();
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">2</span>;i&lt;=n;i++)
        <span class="hljs-keyword">if</span>(dist[i]==-<span class="hljs-number">1</span>)
            PF(<span class="hljs-string">"-1\n"</span>);
        <span class="hljs-keyword">else</span>
            PF(<span class="hljs-string">"%d\n"</span>,dist[i]-st);<span class="hljs-comment">//注意审题！是需要的时间！不是到达时间！</span>
}</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/195ddbd59b7b582814f477122c4d9152/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux彻底删除mysql5.6</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/282a754b729c504e4474009b5eff80b2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">编写代码模拟手机与SIM卡的组合关系。</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>