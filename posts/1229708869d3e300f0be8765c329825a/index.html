<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android推送 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android推送" />
<meta property="og:description" content="Android推送 前言一、实现方式方案1、使用C2DM服务（Google Cloud Messaging）方案2、使用XMPP协议（Openfire &#43; Spark &#43; Smack）方案3、使用MQTT协议方案4、使用第三方推送服务 二、实现步骤1.创建应用2.引入依赖3.创建常量类4.创建工具类5.测试 前言 手机推送服务是指服务器定向将信息实时送达手机的服务。与常见的轮询方式（伪推送），相比区别主要在于两点，一是否长联网，二是到达实时性。推送服务是长联网的，一般到达手机的延迟在0.1-0.5秒左右，而轮询方式（伪推送）不是长联网的，达到延迟时间则根据轮
询时间的不同为1-10分钟，也有延迟1小时或一天的情况。一般来说，自黑莓，苹果和安卓采用标准长连接推送方式后，手机推送服务就特指能够实时到达的形式。
手机推送服务的原理很简单，就是通过建立一条手机与服务器的连接链路，当有消息需要发送到手机时，通过此链路发送即可。
** 推送服务的使用流程虽然略有差别但是大致都和 iOS的APNs 相似：**
1、首先是应用程序注册消息推送。
2、 iOS 向 APNs Server 取得deviceToken。应用程序接受deviceToken。
3、应用程序将deviceToken发送给PUSH服务端程序。
4、 服务端程序向APNs服务发送消息。
5、APNs服务将消息发送给iPhone应用程序。
一、实现方式 方案1、使用C2DM服务（Google Cloud Messaging） 简介：Google推出的云消息服务，即第二代的G2DM。
优点：Google提供的服务、原生、简单，无需实现和部署服务端。
缺点：Android版本限制（必须大于2.2版本），该服务在国内不够稳定、需要用户绑定Goo
gle帐号，受限于Google。
方案2、使用XMPP协议（Openfire &#43; Spark &#43; Smack） 简介：基于XML协议的通讯协议，前身是Jabber，已由IETF国际标准化组织完成了标准化工作。
优点：协议成熟、强大、可扩展性强、主要应用于许多聊天系统中，且已有开源的Java版的开发实例androidpn。
缺点：协议较复杂、冗余（基于XML）、费流量、费电，部署硬件成本高。
方案3、使用MQTT协议 简介：轻量级的、基于代理的“发布/订阅”模式的消息传输协议。
优点：协议简洁、小巧、可扩展性强、省流量、省电，应用到企业领域，且已有C&#43;&#43;版的服务端组件rsmb。
缺点：不够成熟、实现较复杂、服务端组件 rsmb 不开源，部署硬件成本较高。
方案4、使用第三方推送服务 简介：通过嵌入SDK使用第三方提供的推送服务，主流的有百度云推送，极光推送，智游推送，Urban Airship，个推，PUBNUB，蝴蝶等。
优点：稳定，成熟，节省开发和探索时间，相对自己开发成本低，推送管理界面及统计程序完善。
缺点：有程序嵌入顾虑 [2]
示例：pandas 是基于NumPy 的一种工具，该工具是为了解决数据分析任务而创建的。
二、实现步骤 极光推送官网：https://www.jiguang.cn/
1.创建应用 根据官网提示创建应用，并且得到 AppKey 和 Master Secret
2.引入依赖 &lt;!-- 极光推送 --&gt; &lt;dependency&gt; &lt;groupId&gt;cn." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/1229708869d3e300f0be8765c329825a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-21T10:28:52+08:00" />
<meta property="article:modified_time" content="2022-03-21T10:28:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android推送</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Android推送</h4> 
 <ul><li><a href="#_4" rel="nofollow">前言</a></li><li><a href="#_28" rel="nofollow">一、实现方式</a></li><li><ul><li><a href="#1C2DMGoogle_Cloud_Messaging_29" rel="nofollow">方案1、使用C2DM服务（Google Cloud Messaging）</a></li><li><a href="#2XMPPOpenfire__Spark__Smack_35" rel="nofollow">方案2、使用XMPP协议（Openfire + Spark + Smack）</a></li><li><a href="#3MQTT_40" rel="nofollow">方案3、使用MQTT协议</a></li><li><a href="#4_45" rel="nofollow">方案4、使用第三方推送服务</a></li></ul> 
  </li><li><a href="#_51" rel="nofollow">二、实现步骤</a></li><li><ul><li><a href="#1_54" rel="nofollow">1.创建应用</a></li><li><a href="#2_58" rel="nofollow">2.引入依赖</a></li><li><a href="#3_73" rel="nofollow">3.创建常量类</a></li><li><a href="#4_95" rel="nofollow">4.创建工具类</a></li><li><a href="#5_250" rel="nofollow">5.测试</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_4"></a>前言</h2> 
<p>手机推送服务是指服务器定向将信息实时送达手机的服务。与常见的轮询方式（伪推送），相比区别主要在于两点，一是否长联网，二是到达实时性。推送服务是长联网的，一般到达手机的延迟在0.1-0.5秒左右，而轮询方式（伪推送）不是长联网的，达到延迟时间则根据轮</p> 
<p>询时间的不同为1-10分钟，也有延迟1小时或一天的情况。一般来说，自黑莓，苹果和安卓采用标准长连接推送方式后，手机推送服务就特指能够实时到达的形式。</p> 
<p>手机推送服务的原理很简单，就是通过建立一条手机与服务器的连接链路，当有消息需要发送到手机时，通过此链路发送即可。</p> 
<p>** 推送服务的使用流程虽然略有差别但是大致都和 iOS的APNs 相似：**</p> 
<p>1、首先是应用程序注册消息推送。</p> 
<p>2、 iOS 向 APNs Server 取得deviceToken。应用程序接受deviceToken。</p> 
<p>3、应用程序将deviceToken发送给PUSH服务端程序。</p> 
<p>4、 服务端程序向APNs服务发送消息。</p> 
<p>5、APNs服务将消息发送给iPhone应用程序。</p> 
<hr> 
<h2><a id="_28"></a>一、实现方式</h2> 
<h3><a id="1C2DMGoogle_Cloud_Messaging_29"></a>方案1、使用C2DM服务（Google Cloud Messaging）</h3> 
<p>简介：Google推出的云消息服务，即第二代的G2DM。<br> 优点：Google提供的服务、原生、简单，无需实现和部署服务端。<br> 缺点：Android版本限制（必须大于2.2版本），该服务在国内不够稳定、需要用户绑定Goo<br> gle帐号，受限于Google。</p> 
<h3><a id="2XMPPOpenfire__Spark__Smack_35"></a>方案2、使用XMPP协议（Openfire + Spark + Smack）</h3> 
<p>简介：基于XML协议的通讯协议，前身是Jabber，已由IETF国际标准化组织完成了标准化工作。<br> 优点：协议成熟、强大、可扩展性强、主要应用于许多聊天系统中，且已有开源的Java版的开发实例androidpn。<br> 缺点：协议较复杂、冗余（基于XML）、费流量、费电，部署硬件成本高。</p> 
<h3><a id="3MQTT_40"></a>方案3、使用MQTT协议</h3> 
<p>简介：轻量级的、基于代理的“发布/订阅”模式的消息传输协议。<br> 优点：协议简洁、小巧、可扩展性强、省流量、省电，应用到企业领域，且已有C++版的服务端组件rsmb。<br> 缺点：不够成熟、实现较复杂、服务端组件 rsmb 不开源，部署硬件成本较高。</p> 
<h3><a id="4_45"></a>方案4、使用第三方推送服务</h3> 
<p>简介：通过嵌入SDK使用第三方提供的推送服务，主流的有百度云推送，极光推送，智游推送，Urban Airship，个推，PUBNUB，蝴蝶等。<br> 优点：稳定，成熟，节省开发和探索时间，相对自己开发成本低，推送管理界面及统计程序完善。<br> 缺点：有程序嵌入顾虑 [2]<br> 示例：pandas 是基于NumPy 的一种工具，该工具是为了解决数据分析任务而创建的。</p> 
<h2><a id="_51"></a>二、实现步骤</h2> 
<p>极光推送官网：<a href="https://www.jiguang.cn/" rel="nofollow">https://www.jiguang.cn/</a></p> 
<h3><a id="1_54"></a>1.创建应用</h3> 
<p>根据官网提示创建应用，并且得到 <strong>AppKey</strong> 和 <strong>Master Secret</strong><br> <img src="https://images2.imgbox.com/fb/40/nJp5BBrR_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_58"></a>2.引入依赖</h3> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 极光推送 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token generics function"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics function"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>cn<span class="token punctuation">.</span>jpush<span class="token punctuation">.</span>api<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics function"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>jpush<span class="token operator">-</span>client<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics function"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">3.4</span><span class="token number">.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token generics function"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics function"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>msgpack<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics function"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>msgpack<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics function"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">0.6</span><span class="token number">.12</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="3_73"></a>3.创建常量类</h3> 
<pre><code class="prism language-java"><span class="token keyword">package</span> common<span class="token punctuation">.</span>constant<span class="token punctuation">;</span>

<span class="token comment">/**
 * 极光推送常量
 * @author gsz
 * @date 2022/03/18 14:21
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JpushConstants</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">/**
	 * 根据官网创建自己的key 和 密匙
	 */</span>

    <span class="token comment">//应用key </span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String APPKEY <span class="token operator">=</span> <span class="token string">"32e0xxxxxxxxxxxa490"</span><span class="token punctuation">;</span>
    <span class="token comment">//密匙</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String MASTERSECRET <span class="token operator">=</span> <span class="token string">"6fc9xxxxxxxxxxx0af9"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="4_95"></a>4.创建工具类</h3> 
<pre><code class="prism language-java"><span class="token keyword">package</span> common<span class="token punctuation">.</span>util<span class="token punctuation">.</span>jpush<span class="token punctuation">;</span>

<span class="token keyword">import</span> cn<span class="token punctuation">.</span>jiguang<span class="token punctuation">.</span>common<span class="token punctuation">.</span>resp<span class="token punctuation">.</span>APIConnectionException<span class="token punctuation">;</span>
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>jiguang<span class="token punctuation">.</span>common<span class="token punctuation">.</span>resp<span class="token punctuation">.</span>APIRequestException<span class="token punctuation">;</span>
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>jpush<span class="token punctuation">.</span>api<span class="token punctuation">.</span>JPushClient<span class="token punctuation">;</span>
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>jpush<span class="token punctuation">.</span>api<span class="token punctuation">.</span>push<span class="token punctuation">.</span>PushResult<span class="token punctuation">;</span>
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>jpush<span class="token punctuation">.</span>api<span class="token punctuation">.</span>push<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Message<span class="token punctuation">;</span>
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>jpush<span class="token punctuation">.</span>api<span class="token punctuation">.</span>push<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Options<span class="token punctuation">;</span>
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>jpush<span class="token punctuation">.</span>api<span class="token punctuation">.</span>push<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Platform<span class="token punctuation">;</span>
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>jpush<span class="token punctuation">.</span>api<span class="token punctuation">.</span>push<span class="token punctuation">.</span>model<span class="token punctuation">.</span>PushPayload<span class="token punctuation">;</span>
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>jpush<span class="token punctuation">.</span>api<span class="token punctuation">.</span>push<span class="token punctuation">.</span>model<span class="token punctuation">.</span>audience<span class="token punctuation">.</span>Audience<span class="token punctuation">;</span>
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>jpush<span class="token punctuation">.</span>api<span class="token punctuation">.</span>push<span class="token punctuation">.</span>model<span class="token punctuation">.</span>notification<span class="token punctuation">.</span>AndroidNotification<span class="token punctuation">;</span>
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>jpush<span class="token punctuation">.</span>api<span class="token punctuation">.</span>push<span class="token punctuation">.</span>model<span class="token punctuation">.</span>notification<span class="token punctuation">.</span>Notification<span class="token punctuation">;</span>
<span class="token keyword">import</span> common<span class="token punctuation">.</span>constant<span class="token punctuation">.</span>JpushConstants<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>Logger<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>LoggerFactory<span class="token punctuation">;</span>

<span class="token comment">/**
 * 极光推送工具类
 * @author gsz
 * @date 2022/03/18 10:40
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JpushUtils</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Logger log <span class="token operator">=</span> LoggerFactory<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>JpushUtils<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> JPushClient jPushClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JPushClient</span><span class="token punctuation">(</span>JpushConstants<span class="token punctuation">.</span>MASTERSECRET<span class="token punctuation">,</span> JpushConstants<span class="token punctuation">.</span>APPKEY<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * @description: 推送给所有Android用户
     * @author: gsz
     * @date: 2022/3/18 14:58
     * @param notification_title 通知标题
     * @param msg_title 标题
     * @param msg_content 内容
     * @param extrasparam 附加参数
     * @return 0推送失败，1推送成功
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">sendToAllAndroid</span><span class="token punctuation">(</span>String notification_title<span class="token punctuation">,</span> String msg_title<span class="token punctuation">,</span> String msg_content<span class="token punctuation">,</span> String extrasparam<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> resule <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            PushPayload pushPayload <span class="token operator">=</span> JpushUtils<span class="token punctuation">.</span><span class="token function">buildPushObject_android_all_alertWithTitleAll</span><span class="token punctuation">(</span>notification_title<span class="token punctuation">,</span> msg_title<span class="token punctuation">,</span> msg_content<span class="token punctuation">,</span> extrasparam<span class="token punctuation">)</span><span class="token punctuation">;</span>
            PushResult pushResult <span class="token operator">=</span> jPushClient<span class="token punctuation">.</span><span class="token function">sendPush</span><span class="token punctuation">(</span>pushPayload<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pushResult<span class="token punctuation">.</span><span class="token function">getResponseCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                resule <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">APIConnectionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">APIRequestException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"推送给所有Android用户Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> resule<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @description:
     * @author: gsz
     * @date: 2022/3/18 15:09
     * @param notification_title 通知标题
     * @param msg_title 标题
     * @param msg_content 内容
     * @param extrasparam 附加参数
     * @param alias 别名
     * @return 0推送失败，1推送成功
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">sendToOneAndroid</span><span class="token punctuation">(</span>String notification_title<span class="token punctuation">,</span> String msg_title<span class="token punctuation">,</span> String msg_content<span class="token punctuation">,</span> String extrasparam<span class="token punctuation">,</span> String alias<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> resule <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            PushPayload pushPayload <span class="token operator">=</span> JpushUtils<span class="token punctuation">.</span><span class="token function">buildPushObject_android_all_alertWithTitle</span><span class="token punctuation">(</span>notification_title<span class="token punctuation">,</span> msg_title<span class="token punctuation">,</span> msg_content<span class="token punctuation">,</span> extrasparam<span class="token punctuation">,</span> null<span class="token punctuation">,</span> alias<span class="token punctuation">)</span><span class="token punctuation">;</span>
            PushResult pushResult <span class="token operator">=</span> jPushClient<span class="token punctuation">.</span><span class="token function">sendPush</span><span class="token punctuation">(</span>pushPayload<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pushResult<span class="token punctuation">.</span><span class="token function">getResponseCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                resule <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">APIConnectionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">APIRequestException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"推送给指定Android用户Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> resule<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> PushPayload <span class="token function">buildPushObject_android_all_alertWithTitleAll</span><span class="token punctuation">(</span>String notification_title<span class="token punctuation">,</span> String msg_title<span class="token punctuation">,</span> String msg_content<span class="token punctuation">,</span> String extrasparam<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> PushPayload<span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setPlatform</span><span class="token punctuation">(</span>Platform<span class="token punctuation">.</span><span class="token function">android</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setAudience</span><span class="token punctuation">(</span>Audience<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setNotification</span><span class="token punctuation">(</span>Notification<span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">addPlatformNotification</span><span class="token punctuation">(</span>AndroidNotification<span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">setAlert</span><span class="token punctuation">(</span>msg_content<span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span>msg_title<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addExtra</span><span class="token punctuation">(</span><span class="token string">"type"</span><span class="token punctuation">,</span> extrasparam<span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span>Message<span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">setMsgContent</span><span class="token punctuation">(</span>msg_content<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span>msg_title<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">addExtra</span><span class="token punctuation">(</span><span class="token string">"status"</span><span class="token punctuation">,</span> extrasparam<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setOptions</span><span class="token punctuation">(</span>Options<span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">setApnsProduction</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">setSendno</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">setTimeToLive</span><span class="token punctuation">(</span><span class="token number">86400</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> PushPayload <span class="token function">buildPushObject_android_all_alertWithTitle</span><span class="token punctuation">(</span>String notification_title<span class="token punctuation">,</span> String msg_title<span class="token punctuation">,</span> String msg_content<span class="token punctuation">,</span> String extrasparam<span class="token punctuation">,</span> String type<span class="token punctuation">,</span> String value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
       <span class="token keyword">return</span> PushPayload<span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">//指定要推送的平台，all代表当前应用配置了的所有平台，也可以传android等具体平台</span>
                <span class="token punctuation">.</span><span class="token function">setPlatform</span><span class="token punctuation">(</span>Platform<span class="token punctuation">.</span><span class="token function">android</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment">//指定推送的接收对象，all代表所有人，也可以指定已经设置成功的tag或alias或该应应用客户端调用接口获取到的registration id</span>
                <span class="token comment">//根据别名推送</span>
                <span class="token punctuation">.</span><span class="token function">setAudience</span><span class="token punctuation">(</span>Audience<span class="token punctuation">.</span><span class="token function">alias</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>

                <span class="token comment">//jpush的通知，android的由jpush直接下发，iOS的由apns服务器下发，Winphone的由mpns下发</span>
                <span class="token punctuation">.</span><span class="token function">setNotification</span><span class="token punctuation">(</span>Notification<span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token comment">//指定当前推送的android通知</span>
                        <span class="token punctuation">.</span><span class="token function">addPlatformNotification</span><span class="token punctuation">(</span>AndroidNotification<span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">setAlert</span><span class="token punctuation">(</span>msg_content<span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span>msg_title<span class="token punctuation">)</span>
                                <span class="token comment">//此字段为透传字段，不会显示在通知栏。用户可以通过此字段来做一些定制需求，如特定的key传要指定跳转的页面（value）</span>
                                <span class="token punctuation">.</span><span class="token function">addExtra</span><span class="token punctuation">(</span><span class="token string">"type"</span><span class="token punctuation">,</span> extrasparam<span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
                <span class="token comment">//Platform指定了哪些平台就会像指定平台中符合推送条件的设备进行推送。 jpush的自定义消息，</span>
                <span class="token comment">// sdk默认不做任何处理，不会有通知提示。建议看文档http://docs.jpush.io/guideline/faq/的</span>
                <span class="token comment">// [通知与自定义消息有什么区别？]了解通知和自定义消息的区别</span>
                <span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span>Message<span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">setMsgContent</span><span class="token punctuation">(</span>msg_content<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span>msg_title<span class="token punctuation">)</span>
<span class="token comment">//                        .addExtra("message extras key",extrasparam)</span>
                        <span class="token punctuation">.</span><span class="token function">addExtra</span><span class="token punctuation">(</span><span class="token string">"status"</span><span class="token punctuation">,</span> extrasparam<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

                <span class="token punctuation">.</span><span class="token function">setOptions</span><span class="token punctuation">(</span>Options<span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token comment">//此字段的值是用来指定本推送要推送的apns环境，false表示开发，true表示生产；对android和自定义消息无意义</span>
                        <span class="token punctuation">.</span><span class="token function">setApnsProduction</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
                        <span class="token comment">//此字段是给开发者自己给推送编号，方便推送者分辨推送记录</span>
                        <span class="token punctuation">.</span><span class="token function">setSendno</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token comment">//此字段的值是用来指定本推送的离线保存时长，如果不传此字段则默认保存一天，最多指定保留十天，单位为秒</span>
                        <span class="token punctuation">.</span><span class="token function">setTimeToLive</span><span class="token punctuation">(</span><span class="token number">86400</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="5_250"></a>5.测试</h3> 
<pre><code class="prism language-java">	<span class="token comment">/**
     * @description: 推送给所有Android用户
     * @author: gsz
     * @date: 2022/3/18 15:01
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">jpushTextToAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>JpushUtils<span class="token punctuation">.</span><span class="token function">sendToAllAndroid</span><span class="token punctuation">(</span><span class="token string">"推送给所有Android用户"</span><span class="token punctuation">,</span>
                <span class="token string">"标题"</span><span class="token punctuation">,</span> <span class="token string">"测试文本"</span><span class="token punctuation">,</span> <span class="token string">"101"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"推送给所有Android用户成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

	<span class="token comment">/**
     * @description: 推送给指定Android用户
     * @author: gsz
     * @date: 2022/3/18 15:01
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">jpushTextToOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    	<span class="token comment">// 注： aaaaaa 为指定的设备码</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>JpushUtils<span class="token punctuation">.</span><span class="token function">sendToOneAndroid</span><span class="token punctuation">(</span><span class="token string">"推送给指定Android用户"</span><span class="token punctuation">,</span>
                <span class="token string">"标题"</span><span class="token punctuation">,</span> <span class="token string">"测试文本"</span><span class="token punctuation">,</span> <span class="token string">"101"</span><span class="token punctuation">,</span><span class="token string">"aaaaaa"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"推送给指定Android用户成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>输出结果分别是：</p> 
<pre><code class="prism language-java">推送给所有Android用户成功
</code></pre> 
<pre><code class="prism language-java">推送给指定Android用户成功
</code></pre> 
<p><img src="https://images2.imgbox.com/ba/f7/XqrWerHB_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3b784740b08042a95df7f342bc2ed875/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">git常见命令和更新、发布</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5bd58288cc1d7a05c140b4f22898490d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Spring初始</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>