<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>计算机网络笔记（王道考研） 第四章：网络层 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="计算机网络笔记（王道考研） 第四章：网络层" />
<meta property="og:description" content="内容基于中国大学MOOC的2023考研计算机网络课程所做的笔记。
感谢LY，他帮我做了一部分笔记。其中第四章网络层各小节的顺序稍微做了下调整，和上课老师讲的先后顺序稍有不同，但内容是完整的。
课程内容和西电平时讲课的内容大致重合，西电可能会多讲一点内容，但多讲的考试基本不是重点，自己对照任课老师的课件补一下即可。考试要复习的内容看上去很多，但最后考的都很基础，基本不会考特别偏的知识。
王道的计网讲的中规中矩，听课听完可能会有点懵，建议快速过一遍内容后就开始刷题来加深理解。
其他章节的链接如下：
计算机网络笔记（王道考研） 第一章：计算机网络体系结构
计算机网络笔记（王道考研） 第二章：物理层
计算机网络笔记（王道考研） 第三章：数据链路层
计算机网络笔记（王道考研） 第四章：网络层
计算机网络笔记（王道考研） 第五章：传输层
计算机网络笔记（王道考研） 第六章：应用层
其他各科笔记汇总
网络层 网络层功能概述 网络层 主要任务是把分组从源端传到目的端，为分组交换网上的不同主机提供通信服务
网络传输单位是数据报
IP数据报过大就会进行分片，分片后的小单位即网络层的传输单元分组
功能一：路由选择和分组转发 最佳路径
功能二：异构网络互联
功能三：拥塞控制
若所有结点都来不及接受分组，而要丢弃大量分组的话，网络就处于拥塞状态。因此要采取一定措施，缓解这种拥塞
解决拥塞的方法：
开环控制：静态。在网络开始工作前就考虑所有能够产生拥塞的因素进行预先控制闭环控制：动态。网络运行起来后自动调整 路由算法及路由协议 路由算法 路由协议使用路由算法算出最佳路由填入路由表的每一个表项
路由算法的分类 链路费用（路径代价）即路由器的跳数
分层次的路由选择协议 产生原因：
因特网的规模很大。如果让所有的路由器都知道所有的网络如何到达，每个路由器的路由表都会异常庞大，处理起来很耗时许多单位不想让外界知道自己的路由选择协议，但还是想连入因特网 将整个因特网分成许多自治系统AS，AS外部和内部互相看不到使用的协议
网关≈路由器
RIP协议与距离路由算法 RIP和OSPF使用的路由算法不同（RIP —— 距离向量路由算法，OSPF —— 链路状态路由算法），适用的网络大小不同（RIP —— 较小网络，OSPF —— 较大网络）
RIP协议 直接交付：路由器和目的网络直接相连
RIP协议和谁交换？多久交换一次？交换什么？ 距离向量算法 之所以要替换是因为路由表的更新要以最新消息为准
练习1：
练习2：
RIP协议的报文格式 不需要记忆报文的格式以及相应字段。只需要注意到RIP是应用层协议，封装好的RIP报文塞到UDP数据报中传送，并且一个报文最多可以传送25条路由表项信息
RIP协议好消息传得快，坏消息传得慢 RIP的特点：当网络出现故障时，要经过比较长的时间（例如数分钟）才能将此信息传送到所有的路由器，”慢收敛“
OSPF协议及链路状态算法 OSPF协议 链路状态协议≈链路状态算法
注意这里链路的度量/代价和之前讲的距离向量不一样，不是跳数
链路状态路由算法 OSPF区域 主干区域的标识符规定为0.0.0.0，负责连通其他下层区域" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/b286997cab855d4c517b24a03cdb7e5e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-01T00:06:12+08:00" />
<meta property="article:modified_time" content="2022-09-01T00:06:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">计算机网络笔记（王道考研） 第四章：网络层</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>内容基于中国大学MOOC的2023考研计算机网络课程所做的笔记。</p> 
<p>感谢LY，他帮我做了一部分笔记。其中第四章网络层各小节的顺序稍微做了下调整，和上课老师讲的先后顺序稍有不同，但内容是完整的。</p> 
<p>课程内容和西电平时讲课的内容大致重合，西电可能会多讲一点内容，但多讲的考试基本不是重点，自己对照任课老师的课件补一下即可。考试要复习的内容看上去很多，但最后考的都很基础，基本不会考特别偏的知识。</p> 
<p>王道的计网讲的中规中矩，听课听完可能会有点懵，建议快速过一遍内容后就开始刷题来加深理解。</p> 
<p> </p> 
<p>其他章节的链接如下：</p> 
<p><a href="https://blog.csdn.net/zimuzi2019/article/details/126634216">计算机网络笔记（王道考研） 第一章：计算机网络体系结构</a></p> 
<p><a href="https://blog.csdn.net/zimuzi2019/article/details/126634063">计算机网络笔记（王道考研） 第二章：物理层</a></p> 
<p><a href="https://blog.csdn.net/zimuzi2019/article/details/126634296">计算机网络笔记（王道考研） 第三章：数据链路层</a></p> 
<p><a href="https://blog.csdn.net/zimuzi2019/article/details/126634461">计算机网络笔记（王道考研） 第四章：网络层</a></p> 
<p><a href="https://blog.csdn.net/zimuzi2019/article/details/126634511">计算机网络笔记（王道考研） 第五章：传输层</a></p> 
<p><a href="https://blog.csdn.net/zimuzi2019/article/details/126634551">计算机网络笔记（王道考研） 第六章：应用层</a></p> 
<p><a href="https://blog.csdn.net/zimuzi2019/article/details/126227917">其他各科笔记汇总</a></p> 
<h2><a id="_25"></a>网络层</h2> 
<img src="https://images2.imgbox.com/12/49/bCtYKkdn_o.png" alt="image-20220822160250007"> 
<h3><a id="_29"></a>网络层功能概述</h3> 
<h4><a id="_31"></a>网络层</h4> 
<p>主要任务是把分组从源端传到目的端，为分组交换网上的不同主机提供通信服务</p> 
<p>网络传输单位是数据报</p> 
<blockquote> 
 <p>IP数据报过大就会进行分片，分片后的小单位即网络层的传输单元分组</p> 
</blockquote> 
<p> </p> 
<p>功能一：路由选择和分组转发 最佳路径</p> 
<p>功能二：异构网络互联</p> 
<p>功能三：拥塞控制</p> 
<p>若所有结点都来不及接受分组，而要丢弃大量分组的话，网络就处于拥塞状态。因此要采取一定措施，缓解这种拥塞</p> 
<p>解决拥塞的方法：</p> 
<ul><li>开环控制：静态。在网络开始工作前就考虑所有能够产生拥塞的因素进行预先控制</li><li>闭环控制：动态。网络运行起来后自动调整</li></ul> 
<h3><a id="_54"></a>路由算法及路由协议</h3> 
<h4><a id="_56"></a>路由算法</h4> 
<p>路由协议使用路由算法算出最佳路由填入路由表的每一个表项</p> 
<img src="https://images2.imgbox.com/f2/ea/ayog3tTj_o.png" alt="image-20220822193434166"> 
<h4><a id="_62"></a>路由算法的分类</h4> 
<img src="https://images2.imgbox.com/0b/0a/Ug45cULS_o.png" alt="Screen Shot 2022-08-03 at 11.32.59"> 
<blockquote> 
 <p>链路费用（路径代价）即路由器的跳数</p> 
</blockquote> 
<h4><a id="_68"></a>分层次的路由选择协议</h4> 
<p>产生原因：</p> 
<ol><li>因特网的规模很大。如果让所有的路由器都知道所有的网络如何到达，每个路由器的路由表都会异常庞大，处理起来很耗时</li><li>许多单位不想让外界知道自己的路由选择协议，但还是想连入因特网</li></ol> 
<p> </p> 
<p>将整个因特网分成许多自治系统AS，AS外部和内部互相看不到使用的协议</p> 
<img src="https://images2.imgbox.com/be/9d/5ivD7zcL_o.png" alt="Screen Shot 2022-08-03 at 11.39.14"> 
<img src="https://images2.imgbox.com/18/e9/1q7Oc6qf_o.png" alt="Screen Shot 2022-08-03 at 11.40.48"> 
<blockquote> 
 <p>网关≈路由器</p> 
</blockquote> 
<h3><a id="RIP_87"></a>RIP协议与距离路由算法</h3> 
<p>RIP和OSPF使用的路由算法不同（RIP —— 距离向量路由算法，OSPF —— 链路状态路由算法），适用的网络大小不同（RIP —— 较小网络，OSPF —— 较大网络）</p> 
<img src="https://images2.imgbox.com/48/44/wQoO4xPI_o.png" alt="image-20220822230503514"> 
<h4><a id="RIP_93"></a>RIP协议</h4> 
<img src="https://images2.imgbox.com/d6/3c/XkAhpNTl_o.png" alt="image-20220822214448970"> 
<blockquote> 
 <p>直接交付：路由器和目的网络直接相连</p> 
</blockquote> 
<h4><a id="RIP_99"></a>RIP协议和谁交换？多久交换一次？交换什么？</h4> 
<img src="https://images2.imgbox.com/53/b2/EpnjkhkB_o.png" alt="image-20220822214603216"> 
<h4><a id="_103"></a>距离向量算法</h4> 
<img src="https://images2.imgbox.com/53/d1/iAeIAq1M_o.png" alt="image-20220822214938028"> 
<blockquote> 
 <p>之所以要替换是因为路由表的更新要以最新消息为准</p> 
</blockquote> 
<p> </p> 
<p>练习1：</p> 
<img src="https://images2.imgbox.com/68/09/etYXJidr_o.png" alt="image-20220822215904253"> 
<p>练习2：</p> 
<img src="https://images2.imgbox.com/28/0b/QUC8oGUE_o.png" alt="image-20220822215950391"> 
<h4><a id="RIP_119"></a>RIP协议的报文格式</h4> 
<img src="https://images2.imgbox.com/0c/52/paEPBSTx_o.png" alt="image-20220822220035208"> 
<blockquote> 
 <p>不需要记忆报文的格式以及相应字段。只需要注意到RIP是应用层协议，封装好的RIP报文塞到UDP数据报中传送，并且一个报文最多可以传送25条路由表项信息</p> 
</blockquote> 
<h4><a id="RIP_125"></a>RIP协议好消息传得快，坏消息传得慢</h4> 
<p>RIP的特点：当网络出现故障时，要经过比较长的时间（例如数分钟）才能将此信息传送到所有的路由器，”慢收敛“</p> 
<img src="https://images2.imgbox.com/6d/e4/knfF0xOI_o.png" alt="image-20220822221921715"> 
<img src="https://images2.imgbox.com/ce/bb/WotyYF9U_o.png" alt="image-20220822221950079"> 
<p> </p> 
<p> </p> 
<img src="https://images2.imgbox.com/ff/97/R20OIq24_o.png" alt="image-20220822221844445"> 
<img src="https://images2.imgbox.com/88/d0/giK8bKBq_o.png" alt="image-20220822221815182"> 
<img src="https://images2.imgbox.com/23/69/Gku3G2eC_o.png" alt="image-20220822221735081"> 
<img src="https://images2.imgbox.com/5c/e1/fetuKMYo_o.png" alt="image-20220822221659711"> 
<h3><a id="OSPF_145"></a>OSPF协议及链路状态算法</h3> 
<h4><a id="OSPF_147"></a>OSPF协议</h4> 
<img src="https://images2.imgbox.com/c4/8d/SRPZVp2t_o.png" alt="image-20220822231035998"> 
<blockquote> 
 <p>链路状态协议≈链路状态算法</p> 
</blockquote> 
<blockquote> 
 <p>注意这里链路的度量/代价和之前讲的距离向量不一样，不是跳数</p> 
</blockquote> 
<h4><a id="_155"></a>链路状态路由算法</h4> 
<img src="https://images2.imgbox.com/b8/42/TuadAV4r_o.png" alt="image-20220822231617822"> 
<h4><a id="OSPF_159"></a>OSPF区域</h4> 
<img src="https://images2.imgbox.com/ca/43/uKjhY4u7_o.png" alt="image-20220822232408212"> 
<blockquote> 
 <p>主干区域的标识符规定为0.0.0.0，负责连通其他下层区域</p> 
</blockquote> 
<blockquote> 
 <p>主干区域当中的路由器都是主干路由器，上图中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           R 
          
         
           3 
          
         
        
          , 
         
         
         
           R 
          
         
           4 
          
         
        
          , 
         
         
         
           R 
          
         
           7 
          
         
        
       
         R_3,R_4,R_7 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>既是区域边界路由器也是主干路由器</p> 
</blockquote> 
<p>采用分层次划分区域的方法虽然使得交换信息的种类增多，同时使OSPF协议更加复杂，但这样可以使得每个区域内部交换路由信息的通信量大大减小，因而OSPF协议能够适用于规模较大的自治系统</p> 
<h4><a id="OSPF_169"></a>OSPF分组</h4> 
<img src="https://images2.imgbox.com/ff/cb/00KC2a6C_o.png" alt="image-20220822232446811"> 
<p>考纲上OSPF是网络层协议（也有人说是传输层协议，因为相当于是传输层的数据单元放到网络层的数据部分进行封装）</p> 
<h4><a id="OSPF_175"></a>OSPF其他特点</h4> 
<img src="https://images2.imgbox.com/07/39/iIfrGOkL_o.png" alt="image-20220822232717349"> 
<p> </p> 
<p>可以看这个视频<a href="https://www.bilibili.com/video/BV1YV41127U5" rel="nofollow">https://www.bilibili.com/video/BV1YV41127U5</a>作为补充</p> 
<h3><a id="BGP_183"></a>BGP协议</h3> 
<h4><a id="BGP_185"></a>BGP协议</h4> 
<img src="https://images2.imgbox.com/40/76/K9r3qT7p_o.png" alt="image-20220822233314390"> 
<blockquote> 
 <p>配置BGP时，每个AS的管理员都要选择至少一个路由器作为AS的BGP发言人。一般来说两个BGP发言人都是通过一个共享的网络连接在一起。BGP发言人往往是BGP边界路由器</p> 
</blockquote> 
<blockquote> 
 <p>BGP发言人既使用BGP协议，也使用AS内部使用的内部网关协议。它既要清楚到达其他AS内的子网应该经过哪几个AS，同时也要清楚外来分组在AS内下一跳应该走哪里</p> 
</blockquote> 
<h4><a id="BGP_193"></a>BGP协议交换信息的过程</h4> 
<img src="https://images2.imgbox.com/4a/8b/sP3EihgW_o.png" alt="image-20220822234908897"> 
<blockquote> 
 <p>上图即是一个BGP发言人构造出的树形结构的AS连通图</p> 
</blockquote> 
<p> </p> 
<img src="https://images2.imgbox.com/b3/0a/VKYsJBWU_o.png" alt="image-20220822235251885"> 
<img src="https://images2.imgbox.com/18/6d/p6z9ch6k_o.png" alt="image-20220822235306181"> 
<h4><a id="BGP_205"></a>BGP协议报文格式</h4> 
<img src="https://images2.imgbox.com/5b/38/q3mKJ3Zz_o.png" alt="image-20220815213520074"> 
<h4><a id="BGP_209"></a>BGP协议特点</h4> 
<img src="https://images2.imgbox.com/65/07/SBdfdRZB_o.png" alt="image-20220815213527367"> 
<h4><a id="BGP4_213"></a>BGP-4的四种报文</h4> 
<img src="https://images2.imgbox.com/ea/2a/2GOkh9jL_o.png" alt="image-20220815213532779"> 
<blockquote> 
 <p>UPDATE最常用</p> 
</blockquote> 
<blockquote> 
 <p>连接指TCP连接</p> 
</blockquote> 
<p> </p> 
<p> </p> 
<p>三种路由协议比较：</p> 
<img src="https://images2.imgbox.com/18/83/sjIkzSkm_o.png" alt="image-20220823000402971"> 
<img src="https://images2.imgbox.com/ad/e6/dCAByMEl_o.png" alt="image-20220823000331796"> 
<h3><a id="IP_231"></a>IP数据报格式</h3> 
<h4><a id="TCPIP_233"></a>TCP/IP协议栈</h4> 
<img src="https://images2.imgbox.com/10/70/L4eByxOK_o.png" alt="image-20220823133252247"> 
<blockquote> 
 <p>ARP协议为IP协议服务。IP协议也要为ICMP，IGMP两个协议服务</p> 
</blockquote> 
<h4><a id="IP_239"></a>IP数据报格式</h4> 
<img src="https://images2.imgbox.com/da/d1/T0flC3AW_o.png" alt="image-20220823133638881"> 
<img src="https://images2.imgbox.com/4f/b2/zllKgb45_o.png" alt="Screen Shot 2022-08-03 at 11.57.41"> 
<ul><li> <p>版本：IPv4 / IPv6?</p> </li><li> <p>首部长度：单位是4B（4字节），最小为5</p> </li><li> <p>区分服务：指示期望获得哪种类型的服务</p> 
  <blockquote> 
   <p>比如想要优先发送某数据报，要强调数据报的优先级就在这进行规定。</p> 
   <p>在实际应用中很少用</p> 
  </blockquote> </li><li> <p>总长度：占16bit，单位为1B，表明整个IP数据报的长度</p> 
  <blockquote> 
   <p>总长度的最大值为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
             2 
            
           
             16 
            
           
          
            − 
           
          
            1 
           
          
            = 
           
          
            65535 
           
          
            B 
           
          
         
           2^{16}-1=65535B 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8974em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">65535</span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span>。但实际上不会达到，因为长度过大就要进行分片以满足数据链路层MTU的要求</p> 
  </blockquote> </li><li> <p>标识、标志、片偏移：与IP数据报的分片有关</p> </li><li> <p>生存时间（TTL）：IP分组的保质期。经过一个路由器-1，变成0则丢弃</p> </li><li> <p>协议：数据部分的协议<br> <img src="https://images2.imgbox.com/bd/34/z1Xtbapx_o.png" alt="Screen Shot 2022-08-03 at 12.06.55"></p> </li><li> <p>首部检验和：只检验首部</p> 
  <blockquote> 
   <p>使用二进制求和方法检验，具体不要求</p> 
   <p>数据报每经过一个路由器，路由器都要重新计算首部检验和，因为一些字段（如生存时间、标志、片偏移等）都可能发生变化，需要通过首部检验和检验发生变化之后IP数据报是否出错，如果出错就丢弃</p> 
  </blockquote> </li><li> <p>源地址和目的地址：32位</p> </li><li> <p>可选字段：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           0 
          
         
           ∼ 
          
         
           40 
          
         
           B 
          
         
        
          0\sim40B 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">40</span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span>，用来支持排错、测量以及安全等措施</p> </li><li> <p>填充：全0，把首部补成4B的整数倍</p> </li></ul> 
<h3><a id="IP_278"></a>IP数据报分片</h3> 
<h4><a id="MTU_280"></a>最大传送单元MTU</h4> 
<img src="https://images2.imgbox.com/9e/f8/J22yiq73_o.png" alt="image-20220823140656372"> 
<blockquote> 
 <p>MTU不算头尾</p> 
</blockquote> 
<blockquote> 
 <p>过长但是IP数据报不同意分片则无法往下传递，就会返回ICMP差错报文</p> 
</blockquote> 
<h4><a id="IP_288"></a>IP数据报格式补充</h4> 
<img src="https://images2.imgbox.com/0b/65/BYQv5enR_o.png" alt="image-20220823141542308"> 
<blockquote> 
 <p>只有DF=0，MF才有意义</p> 
</blockquote> 
<blockquote> 
 <p>相对位置指距原数据报数据部分开始位置有多远</p> 
</blockquote> 
<p> </p> 
<p> </p> 
<p>例题：</p> 
<blockquote> 
 <p>原数据报数据部分的第一个字节称之为0字节，后面依次是1字节、2字节 …</p> 
</blockquote> 
<img src="https://images2.imgbox.com/27/9a/9xr6yhGV_o.png" alt="image-20220823142808787"> 
<h3><a id="IPv4_306"></a>IPv4地址</h3> 
<h4><a id="IP_308"></a>IP地址</h4> 
<img src="https://images2.imgbox.com/29/e6/QDRYi8eh_o.png" alt="image-20220823154042869"> 
<blockquote> 
 <p>并不是一个IP地址就标识一个主机，一个主机可以有很多个接口（比如分别用于有线上网的有线接口和无线上网的无线接口）。路由器可以连接很多个主机和路由器，这样一个路由器就会有很多个接口，每一个接口都会分配一个唯一的IP地址</p> 
</blockquote> 
<h4><a id="IP_314"></a>IP编址的历史阶段</h4> 
<p>分类的IP地址 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         → 
        
       
      
        \to 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel">→</span></span></span></span></span> 子网的划分 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         → 
        
       
      
        \to 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel">→</span></span></span></span></span> 构成超网（无分类编址方法）</p> 
<h4><a id="IP_318"></a>互联网中的IP地址</h4> 
<img src="https://images2.imgbox.com/98/91/L2WUjaDl_o.png" alt="image-20220823154116438"> 
<p>橘色区域都是路由器的一个接口所连接的一些主机以及链路层设备（如网桥）构成的一个局域网，每个局域网也会用一个主机号全0的IP地址来标识。同属一局域网范围的主机以及设备IP地址网络号相同，主机号不同</p> 
<p>绿色区域称之为无编号网络/无名网络，之所以叫网络是因为这个网络当中有IP地址，但是这个网络是由一段连线构成的</p> 
<h4><a id="IP_326"></a>分类的IP地址</h4> 
<img src="https://images2.imgbox.com/d6/54/hpt2fHU2_o.png" alt="image-20220823155105058"> 
<h4><a id="IP_330"></a>特殊IP地址</h4> 
<p>这一系列IP地址不能用于标识主机或者路由器的具体接口，无法分配给主机</p> 
<img src="https://images2.imgbox.com/e8/c2/RGGv2oU3_o.png" alt="image-20220823155427024"> 
<blockquote> 
 <p>网络号全0，主机号全0：表示本网范围内的这台主机，如果一台主机在发送分组时不清楚自己的IP地址就填上全0</p> 
 <p>网络号全0，主机号特定：全0网络号表示本网络</p> 
 <p>网络号全1，主机号全1：不可以标识某一个主机或者路由器的接口，只能作为目的地址使用，向本网内的所有主机发送广播分组。路由器隔离广播域不转发分组</p> 
 <p>拥有环回地址的数据报永远离开主机，不会进入到网络当中</p> 
</blockquote> 
<h4><a id="_344"></a>私有地址</h4> 
<p>把这些地址放到互联网上是无效的，路由器不认。这些地址只适用于在内部网络当中使用，比如一个学校一个单位的内部网络使用这些地址</p> 
<p>内部IP地址和外部进行通信需要借助NAT技术</p> 
<img src="https://images2.imgbox.com/2c/10/8Jzo0xQU_o.png" alt="image-20220823160858227"> 
<blockquote> 
 <p>网段个数指可以分配多少个网络号</p> 
</blockquote> 
<p> </p> 
<img src="https://images2.imgbox.com/b9/aa/6crmmsFZ_o.png" alt="image-20220823162551242"> 
<blockquote> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           2 
          
         
           7 
          
         
        
          − 
         
        
          2 
         
        
       
         2^7-2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8974em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span></span>：网络号全0表示本网络，网络号127表示环回地址，均不能使用</p> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           2 
          
         
           24 
          
         
        
          − 
         
        
          2 
         
        
       
         2^{24}-2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8974em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">24</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span></span>：主机号全1表示广播地址，主机号全0和全1均不能使用</p> 
</blockquote> 
<h3><a id="NAT_362"></a>网络地址转换NAT</h3> 
<h4><a id="IPIP_364"></a>私有IP地址/本地IP地址</h4> 
<p>只可以在本地网、专用网当中使用，在外网、因特网当中是无效的</p> 
<p>广域网当中的路由器以及其他的主机无法识别这些IP地址，路由器对目的地址是私有IP地址的数据报一律不进行转发</p> 
<img src="https://images2.imgbox.com/27/5a/VBGCnIho_o.png" alt="image-20220823163222061"> 
<p>本地IP地址跟因特网上的主机进行通信需要NAT技术</p> 
<h4><a id="NAT_374"></a>地址转换NAT</h4> 
<img src="https://images2.imgbox.com/38/77/vdocflnc_o.png" alt="image-20220823163558510"> 
<blockquote> 
 <p>WAN端：广域网端，外网端</p> 
 <p>LAN端：局域网端，内网端，本地网端</p> 
</blockquote> 
<p>所有使用本地地址的主机在与外界通信时都要经历NAT路由器的地址转换</p> 
<p>这些主机如果要把自己的数据发到网上去就要用NAT路由器的外部全球IP地址，要给本地网当中的主机发送数据IP数据报当中的目的地址也填NAT路由器的外部全球IP地址，由NAT路由器再分发给具体的主机</p> 
<h3><a id="_386"></a>子网划分和子网掩码</h3> 
<h4><a id="_388"></a>子网划分</h4> 
<img src="https://images2.imgbox.com/45/ed/BHpdvbm3_o.png" alt="image-20220823201848658"> 
<img src="https://images2.imgbox.com/cc/f6/qinFiZt9_o.png" alt="image-20220823201900314"> 
<blockquote> 
 <p>子网号可以1位都没有，但是至少要留2位作为主机号分配给主机</p> 
</blockquote> 
<p> </p> 
<p> </p> 
<img src="https://images2.imgbox.com/c7/41/LxdqRCMk_o.png" alt="image-20220823203514744"> 
<p>当从外部发送IP分组给本单位某一个子网的某一台主机时，路由器需要从收到的IP分组当中提取出目的IP地址，进而根据目的IP地址判断是应该发给本单位的哪个子网</p> 
<h4><a id="_406"></a>子网掩码</h4> 
<img src="https://images2.imgbox.com/6f/cc/7sXCV4yC_o.png" alt="image-20220823204129940"> 
<p> </p> 
<p> </p> 
<p>例题1：</p> 
<img src="https://images2.imgbox.com/43/b5/CcT8xnRk_o.png" alt="image-20220823205459651"> 
<blockquote> 
 <p>同样的IP地址和不同子网掩码可以相与得出相同的网络地址，但是这几种掩码所达到的效果不同，它们各自子网号和主机号所占的位数不一样，可以划分的子网个数以及每一个子网当中可以使用的最大主机数也不同</p> 
</blockquote> 
<p> </p> 
<p>例题2：</p> 
<img src="https://images2.imgbox.com/2f/7f/jlik0sPU_o.png" alt="image-20220823205529592"> 
<h4><a id="_426"></a>使用子网时分组的转发</h4> 
<img src="https://images2.imgbox.com/91/ef/82S7DHTG_o.png" alt="Screen Shot 2022-08-03 at 16.32.24"> 
<blockquote> 
 <p>直接交付：直接给路由器所连的一个子网</p> 
 <p>间接交付：路由器所连的网络当中并不存在目的地址，需要再转给别的路由器</p> 
</blockquote> 
<blockquote> 
 <p>直接交付用目的地址和各个子网的子网掩码相与，看结果是否和某个子网相对应，是则转发给这个子网</p> 
</blockquote> 
<blockquote> 
 <p>检测路径用目的地址和路由表当中每一行的子网掩码相与，看结果是否和某个目的网络地址相对应，是则按该行规定的下一条地址走</p> 
</blockquote> 
<blockquote> 
 <p>默认路由的IP地址和对应子网掩码均为全0，通常是局域网当中的一个路由器，默认路由会发给另一个路由器再循环以上步骤</p> 
</blockquote> 
<h3><a id="CIDR_440"></a>无分类编址CIDR</h3> 
<h4><a id="CIDR_442"></a>无分类编址CIDR</h4> 
<img src="https://images2.imgbox.com/e7/1f/b1aDBa2B_o.png" alt="image-20220823231342394"> 
<img src="https://images2.imgbox.com/ca/52/nwlGKp0o_o.png" alt="image-20220823231423088"> 
<blockquote> 
 <p>CIDR地址块是主机号全0的最小地址，表示本网络</p> 
</blockquote> 
<h4><a id="_450"></a>构成超网</h4> 
<p>路由表当中有几个路由都走的同一个接口就可以对这几个目的网络地址进行聚合</p> 
<img src="https://images2.imgbox.com/6d/62/X2r7CSrn_o.png" alt="image-20220823231524028"> 
<blockquote> 
 <p>206.1.0.0/17 和 206.1.128.0/17 聚合后得到206.1.0.0/16</p> 
</blockquote> 
<p> </p> 
<p>例题：</p> 
<img src="https://images2.imgbox.com/44/e7/nvIwIZT5_o.png" alt="image-20220823233453984"> 
<h4><a id="_464"></a>最长前缀匹配</h4> 
<img src="https://images2.imgbox.com/ef/76/K51j6T1c_o.png" alt="image-20220823231644098"> 
<blockquote> 
 <p>对于各个单位都分了地址块，学校的地址块由各个系进行路由聚合得到</p> 
 <p>每个系下面可以继续再分，将网络前缀变长</p> 
 <p>通过最长前缀匹配就可以将分组直接送达目标系而不让其他系和学校收到</p> 
</blockquote> 
<p> </p> 
<p>例题：</p> 
<img src="https://images2.imgbox.com/61/b4/9SvHb3cl_o.png" alt="image-20220823233411274"> 
<blockquote> 
 <p>所有路由表的目的网络当中，没有任何一个目的网络和分组的目的地址相匹配就走默认路由，默认路由接下来会交付给另一个路由器</p> 
</blockquote> 
<h3><a id="ARP_482"></a>ARP协议</h3> 
<h4><a id="_484"></a>发送数据的过程</h4> 
<p>主机1向主机3发送文件，由于二者处于同一网络，链路层封装时目的MAC地址应填主机3的MAC地址</p> 
<p>每一个主机和路由器都会有ARP高速缓存，存同一局域网内部主机和路由器连接该局域网端口的IP地址与MAC地址的映射</p> 
<p>如果缓存中并没有主机3的IP地址与MAC地址映射，就需要使用ARP协议，ARP协议通过接收方的IP地址查询其MAC地址。首先广播ARP请求分组，1号主机会发送数据帧，该数据帧的目的MAC地址填全1代表在局域网内进行广播的帧，该帧经过交换机时会从所有端口转发出去，主机2和3、路由器的这个端口都会收到</p> 
<p>收到后只有主机3会响应，主机3返回单播ARP响应分组，内部包括主机3的MAC地址</p> 
<img src="https://images2.imgbox.com/c3/2d/WoWCcefy_o.png" alt="image-20220824000214278"> 
<p> </p> 
<p>若源主机和目的主机不在一个局域网内部，如主机1要和主机5通信时同样使用ARP协议，只不过MAC地址和之前有差别。链路层封装时主机1用自己的子网掩码和目的IP地址相与发现不在同一网络就会查询默认网关IP6的MAC地址MAC6填入目的MAC地址</p> 
<blockquote> 
 <p>主机和路由器端口才有的MAC地址，交换机没有MAC地址</p> 
</blockquote> 
<blockquote> 
 <p>默认网关就是与外界沟通的路由器，是局域网连入因特网的关口</p> 
</blockquote> 
<p>传输到路由器进行数据封装和解封装时源IP地址和目的IP地址不变，但由于到了一个新的网络内，源MAC地址和目的MAC地址会改变</p> 
<blockquote> 
 <p>如果考虑NAT，IP地址也可能发生改变</p> 
</blockquote> 
<blockquote> 
 <p>当然这里两个路由器间是点对点式通信，应使用PPP协议，PPP协议中目的MAC地址为全1</p> 
</blockquote> 
<img src="https://images2.imgbox.com/dd/fd/sCZMHlSb_o.png" alt="image-20220824001622818"> 
<h4><a id="ARP_512"></a>ARP协议</h4> 
<img src="https://images2.imgbox.com/e5/86/U9Tnd1DN_o.png" alt="image-20220824003022000"> 
<p>数据最后要到达一个局域网内部，局域网内部只看得懂MAC地址</p> 
<p> </p> 
<p>例题：</p> 
<img src="https://images2.imgbox.com/e8/2e/gz4EYgis_o.png" alt="image-20220824003050932"> 
<blockquote> 
 <p>其中的路由器可能会连着很多个路由器和主机，不一定是点对点通信。这里就默认它都是要使用一次ARP协议</p> 
</blockquote> 
<p> </p> 
<p> </p> 
<p>ARP协议因为结合了IP地址和MAC地址，是处于链路层和网络层中间的协议，但是现在主要被划分成网络层协议，它给IP协议提供服务</p> 
<h3><a id="DHCP_532"></a>DHCP协议</h3> 
<h4><a id="IP_534"></a>主机如何获得IP地址？</h4> 
<img src="https://images2.imgbox.com/97/d4/WHQlaihK_o.png" alt="image-20220824095518949"> 
<blockquote> 
 <p>静态配置 —— 如学校机房内每一台主机都由管理员分配一个固定IP地址</p> 
</blockquote> 
<blockquote> 
 <p>默认网关通常指的是一个路由器的一个接口的IP地址。只有通过默认网关局域网内部的主机才能够跟外界进行通信</p> 
</blockquote> 
<h4><a id="DHCP_542"></a>DHCP服务器</h4> 
<img src="https://images2.imgbox.com/12/6b/yxOpHrEJ_o.png" alt="image-20220824100758574"> 
<blockquote> 
 <p>即插即用 —— 只要设备进入DHCP服务器所管辖的局域网内，就可以被动态地分配一个IP地址</p> 
</blockquote> 
<blockquote> 
 <p>地址重用 —— 每个DHCP服务器都有一个IP地址池，主机进入局域网中被分配IP地址，等离开后DHCP服务器可以把该IP地址分配给新的主机</p> 
</blockquote> 
<blockquote> 
 <p>在用地址续租 —— 通常DHCP动态分配地址是有时间性的，这段可以使用IP地址的时期叫租用期，过后可以重新向DHCP服务器请求一个IP地址或者续租</p> 
</blockquote> 
<blockquote> 
 <p>所有有地址的服务器都可以发送DHCP提供报文，广播DHCP请求报文就是为了告知其他DHCP服务器可以收回刚刚分配的IP地址</p> 
</blockquote> 
<h3><a id="ICMP_554"></a>ICMP协议</h3> 
<p>为了更有效地转发IP数据报和提高交付成功的机会</p> 
<p> </p> 
<h4><a id="ICMP_560"></a>网际控制报文协议ICMP</h4> 
<img src="https://images2.imgbox.com/a5/ea/bjhL3Eeq_o.png" alt="image-20220824104908881"> 
<blockquote> 
 <p>代码字段是为了进一步区分某种类型当中一些不同的情况</p> 
</blockquote> 
<blockquote> 
 <p>检验和字段用来检验整个ICMP报文</p> 
</blockquote> 
<h4><a id="ICMP_568"></a>ICMP差错报告报文</h4> 
<img src="https://images2.imgbox.com/bc/91/rhPkRqVm_o.png" alt="image-20220824105707201"> 
<img src="https://images2.imgbox.com/a1/75/SMwrAevM_o.png" alt="image-20220824105902946"> 
<h4><a id="ICMP_574"></a>不应发送ICMP差错报文的情况</h4> 
<img src="https://images2.imgbox.com/d2/ae/hJHYTAHx_o.png" alt="image-20220824110028474"> 
<h4><a id="ICMP_578"></a>ICMP询问报文</h4> 
<img src="https://images2.imgbox.com/04/24/VC0r1Atd_o.png" alt="image-20220824110056757"> 
<h4><a id="ICMP_582"></a>ICMP的应用</h4> 
<p>PING:：测试两个主机之间的连通性，使用了ICMP回送请求和回答报文</p> 
<p>Traceroute：跟踪一个分组从源点到终点的路径，使用了ICMP时间超过差错报告报文</p> 
<blockquote> 
 <p>源主机和目的主机之间有多个路由器，源主机会向目的主机发送一连串TTL依次被设置为1，2，… 的数据报，链路上的路由器会将TTL减为0的数据报丢弃再返回给源主机ICMP时间超过差错报告报文</p> 
</blockquote> 
<h3><a id="IP_590"></a>IP组播</h3> 
<img src="https://images2.imgbox.com/49/e4/YA60eVTb_o.png" alt="image-20220824194705484"> 
<h4><a id="IP_594"></a>IP数据报的三种传输方式</h4> 
<img src="https://images2.imgbox.com/90/91/EXA3isgt_o.png" alt="image-20220824161731550"> 
<blockquote> 
 <p>单播IP地址就是之前讲的A、B、C类里经常使用的一些IP地址</p> 
 <p>单播 —— 源地址和目的地址均为单播IP地址</p> 
 <p>广播 —— 源地址为单播IP地址，目的地址为全1的广播地址。只要一个IP数据报目的地址为全1，它所对应的MAC地址也是全1，这样的数据报会发给局域网内的全部主机，会从交换机的所有端口转发出去</p> 
 <p>组播 —— 广播不管用户需求，组播则只会给有相同需求的一个组播组内的主机发送相同的数据报。比如看主播直播、腾讯会议时</p> 
</blockquote> 
<p> </p> 
<img src="https://images2.imgbox.com/3d/53/POsEAqIm_o.png" alt="image-20220824161933772"> 
<img src="https://images2.imgbox.com/3d/cc/ecW7Jsbu_o.png" alt="image-20220824162010990"> 
<blockquote> 
 <p>在同一个物理网络 —— 在同一局域网内</p> 
</blockquote> 
<blockquote> 
 <p>组播路由器既可以运行组播协议也可以运行单播协议</p> 
</blockquote> 
<h4><a id="IP_616"></a>IP组播地址</h4> 
<img src="https://images2.imgbox.com/ce/00/qojNidT8_o.png" alt="image-20220824224016144"> 
<blockquote> 
 <p>有些D类地址已经被指派了永久组地址</p> 
</blockquote> 
<p>对IP组播进行分类，一种是只能在本局域网内进行的硬件组播，一种是没有进入局域网在因特网范围内的组播。现在大部分主机都是通过连在局域网然后再连入因特网，所以最后通过因特网范围内组播之后还是要进入到局域网内的硬件组播</p> 
<h4><a id="_624"></a>硬件组播</h4> 
<blockquote> 
 <p>如果现在发来一个单播数据报，进入局域网后看目标MAC地址决定应该交付给哪个主机。同样在硬件组播也需要根据MAC地址找到可以接收组播数据报的主机</p> 
 <p>如果现在发来一个广播数据报，进入局域网后看到全1的目标MAC地址就会把数据报发给局域网中的所有主机，不管有没有交换机</p> 
</blockquote> 
<img src="https://images2.imgbox.com/ee/98/c0wtPG2p_o.png" alt="image-20220824164908259"> 
<blockquote> 
 <p>之所以要过滤是为了要解决地址中这5位不一样，但最低23位一样的情况。此时会导致不同组播组但是映射得到的MAC地址相同</p> 
</blockquote> 
<p> </p> 
<p>IGMP协议和组播路由选择协议是因特网范围内组播要使用的协议，它们都使用IP数据报传输报文，都是网络层协议</p> 
<h4><a id="IGMP_638"></a>网际组管理协议IGMP</h4> 
<img src="https://images2.imgbox.com/9c/e7/tK3OifoB_o.png" alt="image-20220824194238586"> 
<blockquote> 
 <p>一个主机的多个进程都可以有对应的组播IP地址</p> 
</blockquote> 
<blockquote> 
 <p>加入组播组的几台主机的组播IP地址是226.15.37.123。135.27.74.52，130.12.14.56这些是主机本身就有的全球唯一的IP地址，要注意区分</p> 
</blockquote> 
<p>每一个路由器通过使用IGMP协议就可以判断接收到组播组时是否要给局域网当中的主机</p> 
<blockquote> 
 <p>IGMP协议不知道局域网当中组播组的成员个数，同时也不知道这些成员在哪些网络上面，它只能让路由器知道是否有主机参加或者退出了组播组</p> 
</blockquote> 
<h4><a id="IGMP_650"></a>IGMP工作的两个阶段</h4> 
<img src="https://images2.imgbox.com/7e/64/sTz9k0lz_o.png" alt="image-20220824194313377"> 
<blockquote> 
 <p>Round1：路由器以及同属于组播组的成员都会收到报文</p> 
 <p>Round2：探询是在发送IGMP询问报文。其他主机只要监听到有一台主机先响应就不需要再发送响应</p> 
</blockquote> 
<h4><a id="_658"></a>组播路由选择协议</h4> 
<img src="https://images2.imgbox.com/2b/32/lZLnArqd_o.png" alt="image-20220824194357327"> 
<img src="https://images2.imgbox.com/a1/db/8Mt8fOuU_o.png" alt="image-20220824194434835"> 
<blockquote> 
 <p>协议无关 —— 虽然在建立转发树时使用单播数据报和远程路由器联系，但是并不要求使用相同的单播路由选择协议</p> 
 <p>稀疏/密集 —— 一个组播组的主机间离的远近</p> 
</blockquote> 
<h3><a id="IPv6_668"></a>IPv6</h3> 
<img src="https://images2.imgbox.com/b3/d1/MVv5K0B1_o.png" alt="image-20220824161659067"> 
<h4><a id="IPv6_672"></a>IPv6产生原因</h4> 
<img src="https://images2.imgbox.com/70/02/WbH2cDu7_o.png" alt="image-20220824150356585"> 
<h4><a id="IPv6_676"></a>IPv6数据报格式</h4> 
<img src="https://images2.imgbox.com/1c/0a/w5N5u0wF_o.png" alt="image-20220824150631564"> 
<img src="https://images2.imgbox.com/fc/29/MooAsLrd_o.png" alt="image-20220824150711168"> 
<blockquote> 
 <p>下一个首部字段 —— 假如有一个IP数据报除了基本首部外还有若干个扩展首部，每个首部内都有下一个首部字段，指向下一个扩展首部，最后一个扩展首部指向数据部分</p> 
</blockquote> 
<h4><a id="IPv4_684"></a>和IPv4的区别</h4> 
<img src="https://images2.imgbox.com/b0/0f/PpWaXt0f_o.png" alt="image-20220824150727129"> 
<h4><a id="IPv6_688"></a>IPv6地址表示形式</h4> 
<img src="https://images2.imgbox.com/1f/83/LbVIE3hB_o.png" alt="image-20220824150818829"> 
<h4><a id="IPv6_692"></a>IPv6基本地址类型</h4> 
<img src="https://images2.imgbox.com/af/68/7KoZD0tV_o.png" alt="image-20220824150936846"> 
<blockquote> 
 <p>多播 —— 一台主机要跟多播组内的所有主机进行通信，把多播地址放入IPv6数据报的目的地址字段。IPv6并没有使用IPv4的广播地址，因为多播地址可以包括广播地址，IPv4当中的广播发给本局域网当中的所有节点，对应于IPv6可以把广播想象成一组多播组当中的所有主机</p> 
 <p>任播 —— 是IPv6独有一种的地址。假如一台主机IP数据报当中封装的目的地址是任播地址，它会给任播组内的一台主机发送数据报，通常是离它最近的一台</p> 
</blockquote> 
<h4><a id="IPv6IPv4_700"></a>IPv6向IPv4过渡的策略</h4> 
<img src="https://images2.imgbox.com/68/7b/EV90limP_o.png" alt="image-20220824151023454"> 
<blockquote> 
 <p>上图中不同的路由器使用不同版本的IP协议，使用IPv4协议的路由器收到IPv6数据报时会将其作为数据报封装到一个IPv4首部的数据报当中进行传输，进入IPv6网络时再去掉首部</p> 
</blockquote> 
<h3><a id="IP_706"></a>移动IP</h3> 
<img src="https://images2.imgbox.com/c4/5b/L27ph5oL_o.png" alt="image-20220824194939953"> 
<blockquote> 
 <p>QQ依据IP登录，没有在你开通手机号的地区登录就会因为IP地址发生变化而显示异地登录提醒</p> 
</blockquote> 
<h4><a id="IP_712"></a>移动IP相关概念</h4> 
<img src="https://images2.imgbox.com/c7/79/MUqRPhds_o.png" alt="image-20220824200909677"> 
<blockquote> 
 <p>归属代理和外部代理都可以是一个路由器</p> 
</blockquote> 
<h4><a id="IP_718"></a>移动IP通信过程</h4> 
<img src="https://images2.imgbox.com/51/9c/RB3IIrz6_o.png" alt="image-20220824201208065"> 
<blockquote> 
 <p>转交地址的获得有两种形式，被动获得和主动获得</p> 
 <p>被动获得：外部代理会在外部网络内广播ICMP报文，内部包含转交地址</p> 
 <p>主动获得：移动结点主动发送广播报文获得转交地址</p> 
</blockquote> 
<blockquote> 
 <p>注册之后，发给移动结点的数据报到达归属代理都会被封装，并且以隧道的形式发送给外部代理，外部代理再根据永久地址发送给移动结点</p> 
</blockquote> 
<h3><a id="_730"></a>网络层设备</h3> 
<h4><a id="_732"></a>路由器</h4> 
<img src="https://images2.imgbox.com/37/4b/DsKqmpMb_o.png" alt="image-20220824201448830"> 
<blockquote> 
 <p>转发：把分组从一个输入端口转发到另一个输出端口，在路由器内部</p> 
 <p>路由选择：在路由之间选择一个合适的路径把数据从源主机发送到目的主机，在路由器外部</p> 
</blockquote> 
<h4><a id="_740"></a>输入端口对线路上收到的分组的处理</h4> 
<img src="https://images2.imgbox.com/00/e5/hNWUe2Tw_o.png" alt="image-20220824214733985"> 
<h4><a id="_744"></a>输出端口对交换结构传送来的分组发送到线路</h4> 
<img src="https://images2.imgbox.com/8d/87/5PfUa88u_o.png" alt="image-20220824214844942"> 
<h4><a id="_748"></a>三层设备区别</h4> 
<img src="https://images2.imgbox.com/6f/16/0LvsZWY8_o.png" alt="image-20220824214913479"> 
<blockquote> 
 <p>对于任何层次的设备，都可以互联它所在的层次以及以下层次不同协议的网段 ×</p> 
</blockquote> 
<blockquote> 
 <p>集线器是直通式设备，来什么就发什么</p> 
 <p>交换机的每一个端口都是一个冲突域</p> 
</blockquote> 
<h4><a id="_758"></a>路由表与路由转发</h4> 
<img src="https://images2.imgbox.com/24/2e/B5wBHG4v_o.png" alt="image-20220824214957296"> 
<blockquote> 
 <p>转发表由路由表得来，要结合主机的一些具体信息确定输出端口</p> 
</blockquote> 
<blockquote> 
 <p>某些MAC地址可以是下一跳以太网的地址</p> 
</blockquote> 
<h3><a id="SDN_766"></a>SDN的基本概念</h3> 
<img src="https://images2.imgbox.com/1d/d8/k5d27ozP_o.png" alt="image-20220824222702102"> 
<h4><a id="_770"></a>路由器功能：转发&amp;路由选择</h4> 
<p>数据平面对应转发过程，控制平面对应路由选择过程</p> 
<img src="https://images2.imgbox.com/50/eb/XSgH28bC_o.png" alt="image-20220824222008822"> 
<h4><a id="_776"></a>数据平面</h4> 
<img src="https://images2.imgbox.com/fa/fa/wSBnFK3b_o.png" alt="image-20220824222051053"> 
<h4><a id="_780"></a>控制平面（传统方法/每路由器法）</h4> 
<p>控制平面和数据平面都在一个路由器内进行</p> 
<img src="https://images2.imgbox.com/a4/c7/o56nFQ5a_o.png" alt="image-20220824222219197"> 
<h4><a id="SDNSoftwareDefined_Networking_786"></a>控制平面（SDN方法：Software-Defined Networking）</h4> 
<p>数据平面和传统方法一样，控制平面从路由器物理上分离</p> 
<img src="https://images2.imgbox.com/18/09/b2Pyo8WJ_o.png" alt="image-20220824222256607"> 
<blockquote> 
 <p>这里的交换器其实指的是路由器</p> 
</blockquote> 
<h4><a id="_794"></a>控制平面中的路由选择处理器</h4> 
<img src="https://images2.imgbox.com/cf/30/UvrQI5KD_o.png" alt="image-20220824222410543"> 
<h4><a id="SDN_798"></a>SDN控制平面</h4> 
<img src="https://images2.imgbox.com/34/ea/lVHyNW3U_o.png" alt="image-20220824222522146"> 
<h4><a id="SDN_802"></a>SDN控制器的三个层次</h4> 
<img src="https://images2.imgbox.com/6f/cf/EGMDJBEc_o.png" alt="image-20220824222445504"> 
<p> </p> 
<p>例题：</p> 
<img src="https://images2.imgbox.com/e0/04/sdNoTh80_o.png" alt="image-20220824222555901">
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4d3e6b728260170e4bc97e4f3ac115c1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">25. Python 字符串的切片方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8467a3088bd6ccbccf55b34c26b845d2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于篮球计算战斗力的一道题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>