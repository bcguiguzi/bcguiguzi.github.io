<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>卷积神经网络识别人脸项目—使用百度飞桨ai计算 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="卷积神经网络识别人脸项目—使用百度飞桨ai计算" />
<meta property="og:description" content="卷积神经网络识别人脸项目的详细过程 整个项目需要的准备文件：
下载链接：
链接：https://pan.baidu.com/s/1WEndfi14EhVh-8Vvt62I_w
提取码：7777
链接：https://pan.baidu.com/s/10weqx3r_zbS5gNEq-xGrzg
提取码：7777
1、模型推理文件
2、模型转换文件
1、数据集准备 数据集的文件夹格式如下图：一共两个文件夹
images文件夹装所有的图片，图片需随机打乱和编号
labels文件夹内是对图片进行打标签操作的标签
打标签使用的是labelimg，安装过程可自行百度
open Dir是打开存放图片的路径，我们这里就是images文件夹
Change Save Dir是存放标签的路径，我们这里选择labels文件夹
打标签模式选择YOLO
然后点击Create RectBox选择关键位置就可以打标签了。
然后是上一级文件夹格式：
其中sex文件夹包括了上面两个文件夹
classes.txt是打标签是生成的，包括了标签的顺序和种类，这里的男女识别classes.txt内部就是：
man woman gen.py是用于随机提取出训练集和测试集
运行gen.py后，生成了train.txt，val.txt两个txt
train.txt就是训练集，包括了训练集的图片路径名称
val.txt同理
然后来到主文件夹中：
点击路径，运行cmd:
运行python yolov5_2_coco.py ，生成的文件夹保存到相应路径中
python yolov5_2_coco.py --dir_path D:\Pycharm\code\YOLO2COCO\dataset\YOLOV5 打包数据集，然后压缩后上传到百度飞桨ai数据集平台
2、模型训练 点击创建项目：
项目创建成功后，启动环境，选择一个GPU：
新建一个notebook文件，然后重命名为ppyoloe
上传PaddleYOLO文件
然后将上传的文件重命名为PaddleYOLO
然后进入此文件夹
cd /home/aistudio/PaddleYOLO 然后根据自己的模型实际情况，修改下图文件，num_classes是分类的种类，这里一共两种，所以改为2
dataset/sex是存放数据的位置，按实际情况修改，我这里是男女识别数据集，所以文件夹命名为sex
因为配置文件中要求数据放到dataset/sex里面，所以需要把数据集放置到此处。
新建一个mask文件夹，把解压过后的数据文件夹拖到mask里面。
粘贴到dataset文件夹下，注意红色框的路径。
如果想要修改迭代次数，在此处修改：
/home/aistudio/PaddleYOLO/configs/ppyoloe/_base_/optimizer_80e.yml epoch: 40 表示迭代次数为40次
输入下列代码，开始训练
第二行代码如果出错，权限不够，后面加上 --user
pip install -r requirements.txt --user 模型训练标志，此时是0 epoch" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/6c30cf6e8eb27c787100aae19f42dc49/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-16T17:24:14+08:00" />
<meta property="article:modified_time" content="2023-07-16T17:24:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">卷积神经网络识别人脸项目—使用百度飞桨ai计算</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>卷积神经网络识别人脸项目的详细过程</h2> 
<p>整个项目需要的准备文件：<br> 下载链接：<br> 链接：https://pan.baidu.com/s/1WEndfi14EhVh-8Vvt62I_w<br> 提取码：7777<br> 链接：https://pan.baidu.com/s/10weqx3r_zbS5gNEq-xGrzg<br> 提取码：7777</p> 
<p>1、模型推理文件</p> 
<p><img src="https://images2.imgbox.com/2d/61/vT3Cni9u_o.png" alt="在这里插入图片描述"></p> 
<p>2、模型转换文件</p> 
<p><img src="https://images2.imgbox.com/fe/33/C9Lpqej4_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="1_20"></a>1、数据集准备</h3> 
<p>数据集的文件夹格式如下图：一共两个文件夹</p> 
<p><img src="https://images2.imgbox.com/37/2c/QcYgJePJ_o.png" alt=""></p> 
<p>images文件夹装所有的图片，图片需随机打乱和编号<br> <img src="https://images2.imgbox.com/86/3f/MXqEF507_o.png" alt="在这里插入图片描述"></p> 
<p>labels文件夹内是对图片进行打标签操作的标签</p> 
<p><img src="https://images2.imgbox.com/9b/61/0mJK3vtj_o.png" alt="在这里插入图片描述"></p> 
<p>打标签使用的是labelimg，安装过程可自行百度</p> 
<p>open Dir是打开存放图片的路径，我们这里就是images文件夹</p> 
<p>Change Save Dir是存放标签的路径，我们这里选择labels文件夹</p> 
<p>打标签模式选择YOLO</p> 
<p>然后点击Create RectBox选择关键位置就可以打标签了。</p> 
<p><img src="https://images2.imgbox.com/b6/c1/23oZgm63_o.png" alt="在这里插入图片描述"></p> 
<p>然后是上一级文件夹格式：</p> 
<p>其中sex文件夹包括了上面两个文件夹</p> 
<p>classes.txt是打标签是生成的，包括了标签的顺序和种类，这里的男女识别classes.txt内部就是：</p> 
<pre><code>man

woman
</code></pre> 
<p>gen.py是用于随机提取出训练集和测试集</p> 
<p>运行gen.py后，生成了train.txt，val.txt两个txt</p> 
<p>train.txt就是训练集，包括了训练集的图片路径名称</p> 
<p>val.txt同理</p> 
<p><img src="https://images2.imgbox.com/4f/58/ovXJrUIU_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-pVbSEcox-1689495250366)(C:\Users\vers\AppData\Roaming\Typora\typora-user-images\image-20230716111500162.png)]"></p> 
<p>然后来到主文件夹中：</p> 
<p><img src="https://images2.imgbox.com/10/ad/9jjbMJWh_o.png" alt="在这里插入图片描述"></p> 
<p>点击路径，运行cmd:<br> <img src="https://images2.imgbox.com/b0/b1/0kAqAA4d_o.png" alt="在这里插入图片描述"></p> 
<p>运行python yolov5_2_coco.py ，生成的文件夹保存到相应路径中</p> 
<pre><code>python yolov5_2_coco.py --dir_path D:\Pycharm\code\YOLO2COCO\dataset\YOLOV5
</code></pre> 
<p><img src="https://images2.imgbox.com/bb/0a/1FVCZksa_o.png" alt="在这里插入图片描述"></p> 
<p>打包数据集，然后压缩后上传到百度飞桨ai数据集平台</p> 
<p><img src="https://images2.imgbox.com/19/01/5Gn67Oaf_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_104"></a>2、模型训练</h3> 
<p>点击创建项目：</p> 
<p><img src="https://images2.imgbox.com/93/1e/qG1BGzMY_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-dUdGgNWz-1689495250370)(C:\Users\vers\AppData\Roaming\Typora\typora-user-images\image-20230716121747564.png)]"></p> 
<p><img src="https://images2.imgbox.com/ea/9e/ZyM0f06c_o.png" alt="在这里插入图片描述"></p> 
<p>项目创建成功后，启动环境，选择一个GPU：</p> 
<p><img src="https://images2.imgbox.com/73/2d/7J037v15_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-cpE6hFmC-1689495250371)(C:\Users\vers\AppData\Roaming\Typora\typora-user-images\image-20230716122037028.png)]"></p> 
<p>新建一个notebook文件，然后重命名为ppyoloe</p> 
<p><img src="https://images2.imgbox.com/85/17/2GFaQ9W9_o.png" alt="在这里插入图片描述"></p> 
<p>上传PaddleYOLO文件</p> 
<p><img src="https://images2.imgbox.com/63/3f/5OSJxswL_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-0lJYBIUJ-1689495250372)(C:\Users\vers\AppData\Roaming\Typora\typora-user-images\image-20230716122458800.png)]"></p> 
<p>然后将上传的文件重命名为PaddleYOLO</p> 
<p>然后进入此文件夹</p> 
<pre><code>cd /home/aistudio/PaddleYOLO
</code></pre> 
<p><img src="https://images2.imgbox.com/ea/1e/XkUnrD6V_o.png" alt="在这里插入图片描述"></p> 
<p>然后根据自己的模型实际情况，修改下图文件，num_classes是分类的种类，这里一共两种，所以改为2</p> 
<p>dataset/sex是存放数据的位置，按实际情况修改，我这里是男女识别数据集，所以文件夹命名为sex</p> 
<p><img src="https://images2.imgbox.com/3c/5f/zIQ4w9T3_o.png" alt=""></p> 
<p>因为配置文件中要求数据放到dataset/sex里面，所以需要把数据集放置到此处。</p> 
<p><img src="https://images2.imgbox.com/a5/f6/Ep51cjmX_o.png" alt=""></p> 
<p>新建一个mask文件夹，把解压过后的数据文件夹拖到mask里面。</p> 
<p><img src="https://images2.imgbox.com/46/2f/z72mPh15_o.png" alt=""></p> 
<p>粘贴到dataset文件夹下，注意红色框的路径。</p> 
<p><img src="https://images2.imgbox.com/a7/a9/EDf1VXDN_o.png" alt=""></p> 
<p>如果想要修改迭代次数，在此处修改：</p> 
<pre><code>/home/aistudio/PaddleYOLO/configs/ppyoloe/_base_/optimizer_80e.yml
</code></pre> 
<p>epoch: 40 表示迭代次数为40次</p> 
<p><img src="https://images2.imgbox.com/cb/8f/0z6uqlwF_o.png" alt="在这里插入图片描述"></p> 
<p>输入下列代码，开始训练</p> 
<p>第二行代码如果出错，权限不够，后面加上 --user</p> 
<pre><code>pip install -r requirements.txt --user
</code></pre> 
<p><img src="https://images2.imgbox.com/90/d2/IocEAYam_o.png" alt=""></p> 
<p>模型训练标志，此时是0 epoch</p> 
<p><img src="https://images2.imgbox.com/47/6e/t7I2Q0nP_o.png" alt="在这里插入图片描述"></p> 
<p>等待40次迭代完成：</p> 
<p><img src="https://images2.imgbox.com/37/6f/mwZEA9k5_o.png" alt="在这里插入图片描述"></p> 
<p>训练完毕后，需要导出训练数据文件：</p> 
<pre><code>!python tools/export_model.py -c configs/ppyoloe/ppyoloe_plus_crn_s_80e_coco.yml -o weights=/home/aistudio/PaddleYOLO/output/ppyoloe_plus_crn_s_80e_coco/model_final.pdparams
</code></pre> 
<p><img src="https://images2.imgbox.com/aa/b8/RauQR1WX_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-QlvXe2NL-1689495250376)(C:\Users\vers\AppData\Roaming\Typora\typora-user-images\image-20230716143851858.png)]"></p> 
<p>导出成功后，保存在以下路径中：</p> 
<pre><code>/home/aistudio/PaddleYOLO/output_inference/ppyoloe_plus_crn_s_80e_coco
</code></pre> 
<p><img src="https://images2.imgbox.com/50/6d/Ihe5IZeO_o.png" alt="在这里插入图片描述"></p> 
<p>然后下载以下的四个文件到电脑中：</p> 
<p><img src="https://images2.imgbox.com/5c/49/BrbadMLg_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-dsgYtujP-1689495250377)(C:\Users\vers\AppData\Roaming\Typora\typora-user-images\image-20230716123546754.png)]"></p> 
<h3><a id="3_218"></a>3、模型转换</h3> 
<p>将上一步获得的四个文件放入下图的文件夹中</p> 
<p><img src="https://images2.imgbox.com/ed/ba/oyMmvqHL_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-oyx5Cju8-1689495250379)(C:\Users\vers\AppData\Roaming\Typora\typora-user-images\image-20230716135057966.png)]"></p> 
<p>进入模型可视化网站查看模型：<a href="https://netron.app/" rel="nofollow">Netron</a> 选择模型</p> 
<p><img src="https://images2.imgbox.com/9c/eb/jfr7T9Cx_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d7/f1/FIVsLJR0_o.png" alt="在这里插入图片描述"></p> 
<p>然后进行模型剪枝，在如下目录下打开cmd：</p> 
<p><img src="https://images2.imgbox.com/89/c3/nkALk8bP_o.png" alt="在这里插入图片描述"></p> 
<p>运行这个模型剪枝文件</p> 
<p><img src="https://images2.imgbox.com/ef/ca/2RpY0aFH_o.png" alt="在这里插入图片描述"></p> 
<pre><code>python prune_paddle_model.py --model_dir ppyoloe_crn_s_80 --model_filename model.pdmodel --params_filename model.pdiparams --output_names tmp_16 concat_14.tmp_0 --save_dir export_model

</code></pre> 
<p><img src="https://images2.imgbox.com/ef/ac/153MxgTm_o.png" alt="img"></p> 
<p>运行过后新增一个减支完成的模型文件夹</p> 
<p><img src="https://images2.imgbox.com/f1/af/kedzaznz_o.png" alt="在这里插入图片描述"></p> 
<p>然后进行模型转换，把Paddle模型转换为onnx，需要在环境中提前安装好paddle2onnx。</p> 
<p>执行以下命令进行模型转换：</p> 
<pre><code>paddle2onnx --model_dir export_model --model_filename model.pdmodel --params_filename model.pdiparams --input_shape_dict "{'image':[1,3,640,640]}" --opset_version 11 --save_file ppyoloe_crn_s_80.onnx

</code></pre> 
<p><img src="https://images2.imgbox.com/69/97/KKAFocEX_o.png" alt="在这里插入图片描述"></p> 
<p>执行生成的ppyoloe_crn_s_80.onnx</p> 
<p><img src="https://images2.imgbox.com/2b/f3/Om0UPqLe_o.png" alt="在这里插入图片描述"></p> 
<pre><code>mo --input_model ppyoloe_crn_s_80.onnx
</code></pre> 
<p><img src="https://images2.imgbox.com/f8/99/6zIWMTUC_o.png" alt="在这里插入图片描述"></p> 
<p>执行结果如下：</p> 
<p><img src="https://images2.imgbox.com/19/9f/n9cpadCL_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_276"></a>4、模型推理</h3> 
<p>增加一个文件labels.txt，内容是我们的标签，注意存放路径</p> 
<p><img src="https://images2.imgbox.com/a6/be/lp5mgkFG_o.png" alt="在这里插入图片描述"></p> 
<p>增加一个inference.ipynb用于编写推理代码，注意存放路径<br> <img src="https://images2.imgbox.com/3b/42/TD2EByd1_o.png" alt="在这里插入图片描述"></p> 
<p>inference.ipynb 文件代码如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> openvino<span class="token punctuation">.</span>runtime <span class="token keyword">import</span> Core
<span class="token keyword">import</span> openvino<span class="token punctuation">.</span>runtime <span class="token keyword">as</span> ov
<span class="token keyword">import</span> cv2 <span class="token keyword">as</span> cv
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
</code></pre> 
<p>OpenVINO 模型推理器（class）</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">Predictor</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    OpenVINO 模型推理器
    """</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> model_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        ie_core <span class="token operator">=</span> Core<span class="token punctuation">(</span><span class="token punctuation">)</span>
        model <span class="token operator">=</span> ie_core<span class="token punctuation">.</span>read_model<span class="token punctuation">(</span>model<span class="token operator">=</span>model_path<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>compiled_model <span class="token operator">=</span> ie_core<span class="token punctuation">.</span>compile_model<span class="token punctuation">(</span>model<span class="token operator">=</span>model<span class="token punctuation">,</span> device_name<span class="token operator">=</span><span class="token string">"CPU"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">get_inputs_name</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>compiled_model<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">get_outputs_name</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>compiled_model<span class="token punctuation">.</span>output<span class="token punctuation">(</span>num<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>compiled_model<span class="token punctuation">(</span><span class="token punctuation">[</span>input_data<span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">get_request</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>compiled_model<span class="token punctuation">.</span>create_infer_request<span class="token punctuation">(</span><span class="token punctuation">)</span>


</code></pre> 
<p>图像预处理</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">process_image</span><span class="token punctuation">(</span>input_image<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""输入图片与处理方法，按照PP-Yoloe模型要求预处理图片数据

    Args:
        input_image (uint8): 输入图片矩阵
        size (int): 模型输入大小

    Returns:
        float32: 返回处理后的图片矩阵数据
    """</span>
    max_len <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>input_image<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    img <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span>max_len<span class="token punctuation">,</span>max_len<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
    img<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>input_image<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">:</span>input_image<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> input_image <span class="token comment"># 将图片放到正方形背景中</span>
    img <span class="token operator">=</span> cv<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span>cv<span class="token punctuation">.</span>COLOR_BGR2RGB<span class="token punctuation">)</span>  <span class="token comment"># BGR转RGB</span>
    img <span class="token operator">=</span> cv<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">(</span>size<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">,</span> cv<span class="token punctuation">.</span>INTER_NEAREST<span class="token punctuation">)</span> <span class="token comment"># 缩放图片</span>
    img <span class="token operator">=</span> np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>img<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 转换格式</span>
    img <span class="token operator">=</span> img <span class="token operator">/</span> <span class="token number">255.0</span> <span class="token comment"># 归一化</span>
    img <span class="token operator">=</span> np<span class="token punctuation">.</span>expand_dims<span class="token punctuation">(</span>img<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># 增加维度</span>
    <span class="token keyword">return</span> img<span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>


</code></pre> 
<p>图像后处理</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">process_result</span><span class="token punctuation">(</span>box_results<span class="token punctuation">,</span> conf_results<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""按照PP-Yolove模型输出要求，处理数据，非极大值抑制，提取预测结果

    Args:
        box_results (float32): 预测框预测结果
        conf_results (float32): 置信度预测结果
    Returns:
        float: 预测框
        float: 分数
        int: 类别
    """</span>
    conf_results <span class="token operator">=</span> np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>conf_results<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 转置</span>
    <span class="token comment"># 设置输出形状</span>
    box_results <span class="token operator">=</span>box_results<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">8400</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> 
    conf_results <span class="token operator">=</span> conf_results<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">8400</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    scores <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    classes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    boxes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8400</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        conf <span class="token operator">=</span> conf_results<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment"># 预测分数</span>
        score <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span> <span class="token comment"># 获取类别</span>
        <span class="token comment"># 筛选较小的预测类别</span>
        <span class="token keyword">if</span> score <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">:</span>
            classes<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">)</span> 
            scores<span class="token punctuation">.</span>append<span class="token punctuation">(</span>score<span class="token punctuation">)</span> 
            boxes<span class="token punctuation">.</span>append<span class="token punctuation">(</span>box_results<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    scores <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>scores<span class="token punctuation">)</span>
    boxes <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>boxes<span class="token punctuation">)</span>
    
    result_box <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    result_score <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    result_class <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># 非极大值抑制筛选重复的预测结果</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>boxes<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token comment"># 非极大值抑制结果</span>
        indexs <span class="token operator">=</span> tf<span class="token punctuation">.</span>image<span class="token punctuation">.</span>non_max_suppression<span class="token punctuation">(</span>boxes<span class="token punctuation">,</span>scores<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0.25</span><span class="token punctuation">,</span><span class="token number">0.35</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i<span class="token punctuation">,</span> index <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>indexs<span class="token punctuation">)</span><span class="token punctuation">:</span>
            result_score<span class="token punctuation">.</span>append<span class="token punctuation">(</span>scores<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
            result_box<span class="token punctuation">.</span>append<span class="token punctuation">(</span>boxes<span class="token punctuation">[</span>index<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            result_class<span class="token punctuation">.</span>append<span class="token punctuation">(</span>classes<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 返回结果</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>result_box<span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>result_score<span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>result_class<span class="token punctuation">)</span>


</code></pre> 
<p>画出预测框</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">draw_box</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> boxes<span class="token punctuation">,</span> scores<span class="token punctuation">,</span> classes<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""将预测结果绘制到图像上

    Args:
        image (uint8): 原图片
        boxes (float32): 预测框
        scores (float32): 分数
        classes (int): 类别
        lables (str): 标签

    Returns:
        uint8: 标注好的图片
    """</span>
    colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    scale <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">640.0</span> <span class="token comment"># 缩放比例</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>classes<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>classes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            box <span class="token operator">=</span> boxes<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
            x1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>box<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> scale<span class="token punctuation">)</span>
            y1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>box<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> scale<span class="token punctuation">)</span>
            x2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>box<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> scale<span class="token punctuation">)</span>
            y2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>box<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> scale<span class="token punctuation">)</span>
            label <span class="token operator">=</span> labels<span class="token punctuation">[</span>classes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
            score <span class="token operator">=</span> scores<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            cv<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x2<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span> colors<span class="token punctuation">[</span>classes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> cv<span class="token punctuation">.</span>LINE_8<span class="token punctuation">)</span>
            cv<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>image<span class="token punctuation">,</span>label<span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>cv<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX<span class="token punctuation">,</span> <span class="token number">0.55</span><span class="token punctuation">,</span> colors<span class="token punctuation">[</span>classes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        
    <span class="token keyword">return</span> image


</code></pre> 
<p>读取标签</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">read_label</span><span class="token punctuation">(</span>label_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>label_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        labels <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> labels

</code></pre> 
<p>同步推理</p> 
<pre><code class="prism language-python">label_path <span class="token operator">=</span> <span class="token string">"labels.txt"</span>
yoloe_model_path <span class="token operator">=</span> <span class="token string">"ppyoloe_crn_s_80.xml"</span>
predictor <span class="token operator">=</span> Predictor<span class="token punctuation">(</span>model_path <span class="token operator">=</span> yoloe_model_path<span class="token punctuation">)</span>
boxes_name <span class="token operator">=</span> predictor<span class="token punctuation">.</span>get_outputs_name<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
conf_name <span class="token operator">=</span> predictor<span class="token punctuation">.</span>get_outputs_name<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
labels <span class="token operator">=</span> read_label<span class="token punctuation">(</span>label_path<span class="token operator">=</span>label_path<span class="token punctuation">)</span>
cap <span class="token operator">=</span> cv<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> cap<span class="token punctuation">.</span>isOpened<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ret<span class="token punctuation">,</span> frame <span class="token operator">=</span> cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    frame <span class="token operator">=</span> cv<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>namedWindow<span class="token punctuation">(</span><span class="token string">"MaskDetection"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 0可调大小，注意：窗口名必须imshow里面的一窗口名一直</span>
    cv<span class="token punctuation">.</span>resizeWindow<span class="token punctuation">(</span><span class="token string">"MaskDetection"</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">)</span>    <span class="token comment"># 设置长和宽</span>
    input_frame <span class="token operator">=</span> process_image<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">)</span>
    results <span class="token operator">=</span> predictor<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>input_data<span class="token operator">=</span>input_frame<span class="token punctuation">)</span>
    boxes<span class="token punctuation">,</span> scores<span class="token punctuation">,</span> classes <span class="token operator">=</span> process_result<span class="token punctuation">(</span>box_results<span class="token operator">=</span>results<span class="token punctuation">[</span>boxes_name<span class="token punctuation">]</span><span class="token punctuation">,</span> conf_results<span class="token operator">=</span>results<span class="token punctuation">[</span>conf_name<span class="token punctuation">]</span><span class="token punctuation">)</span>
    result_frame <span class="token operator">=</span> draw_box<span class="token punctuation">(</span>image<span class="token operator">=</span>frame<span class="token punctuation">,</span> boxes<span class="token operator">=</span>boxes<span class="token punctuation">,</span> scores<span class="token operator">=</span>scores<span class="token punctuation">,</span> classes<span class="token operator">=</span>classes<span class="token punctuation">,</span> labels<span class="token operator">=</span>labels<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'MaskDetection'</span><span class="token punctuation">,</span> result_frame<span class="token punctuation">)</span>
    key <span class="token operator">=</span> cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> key <span class="token operator">==</span> <span class="token number">27</span><span class="token punctuation">:</span> <span class="token comment">#esc退出</span>
        <span class="token keyword">break</span>
cap<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
cv<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>异步推理</p> 
<pre><code class="prism language-python">label_path <span class="token operator">=</span> <span class="token string">"labels.txt"</span>
yoloe_model_path <span class="token operator">=</span> <span class="token string">"ppyoloe_crn_s_80.xml"</span>
predictor <span class="token operator">=</span> Predictor<span class="token punctuation">(</span>model_path <span class="token operator">=</span> yoloe_model_path<span class="token punctuation">)</span>
input_layer <span class="token operator">=</span> predictor<span class="token punctuation">.</span>get_inputs_name<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
labels <span class="token operator">=</span> read_label<span class="token punctuation">(</span>label_path<span class="token operator">=</span>label_path<span class="token punctuation">)</span>
cap <span class="token operator">=</span> cv<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
curr_request <span class="token operator">=</span> predictor<span class="token punctuation">.</span>get_request<span class="token punctuation">(</span><span class="token punctuation">)</span>
next_request <span class="token operator">=</span> predictor<span class="token punctuation">.</span>get_request<span class="token punctuation">(</span><span class="token punctuation">)</span>
ret<span class="token punctuation">,</span> frame <span class="token operator">=</span> cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
curr_frame <span class="token operator">=</span> process_image<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">)</span>
curr_request<span class="token punctuation">.</span>set_tensor<span class="token punctuation">(</span>input_layer<span class="token punctuation">,</span> ov<span class="token punctuation">.</span>Tensor<span class="token punctuation">(</span>curr_frame<span class="token punctuation">)</span><span class="token punctuation">)</span>
curr_request<span class="token punctuation">.</span>start_async<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> cap<span class="token punctuation">.</span>isOpened<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ret<span class="token punctuation">,</span> next_frame <span class="token operator">=</span> cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    next_frame <span class="token operator">=</span> cv<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>next_frame<span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>namedWindow<span class="token punctuation">(</span><span class="token string">"MaskDetection"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 0可调大小，注意：窗口名必须imshow里面的一窗口名一直</span>
    cv<span class="token punctuation">.</span>resizeWindow<span class="token punctuation">(</span><span class="token string">"MaskDetection"</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">)</span>    <span class="token comment"># 设置长和宽</span>
    in_frame <span class="token operator">=</span> process_image<span class="token punctuation">(</span>next_frame<span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">)</span>
    next_request<span class="token punctuation">.</span>set_tensor<span class="token punctuation">(</span>input_layer<span class="token punctuation">,</span> ov<span class="token punctuation">.</span>Tensor<span class="token punctuation">(</span>in_frame<span class="token punctuation">)</span><span class="token punctuation">)</span>
    next_request<span class="token punctuation">.</span>start_async<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> curr_request<span class="token punctuation">.</span>wait_for<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        boxes_name <span class="token operator">=</span> curr_request<span class="token punctuation">.</span>get_output_tensor<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>data
        conf_name <span class="token operator">=</span> curr_request<span class="token punctuation">.</span>get_output_tensor<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>data
        boxes<span class="token punctuation">,</span> scores<span class="token punctuation">,</span> classes <span class="token operator">=</span> process_result<span class="token punctuation">(</span>box_results<span class="token operator">=</span>boxes_name<span class="token punctuation">,</span> conf_results<span class="token operator">=</span>conf_name<span class="token punctuation">)</span>
        frame <span class="token operator">=</span> draw_box<span class="token punctuation">(</span>image<span class="token operator">=</span>frame<span class="token punctuation">,</span> boxes<span class="token operator">=</span>boxes<span class="token punctuation">,</span> scores<span class="token operator">=</span>scores<span class="token punctuation">,</span> classes<span class="token operator">=</span>classes<span class="token punctuation">,</span> labels<span class="token operator">=</span>labels<span class="token punctuation">)</span>
        cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'MaskDetection'</span><span class="token punctuation">,</span> frame<span class="token punctuation">)</span>
    frame <span class="token operator">=</span> next_frame
    curr_request<span class="token punctuation">,</span> next_request <span class="token operator">=</span> next_request<span class="token punctuation">,</span> curr_request
    key <span class="token operator">=</span> cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> key <span class="token operator">==</span> <span class="token number">27</span><span class="token punctuation">:</span> <span class="token comment">#esc退出</span>
        <span class="token keyword">break</span>
cap<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
cv<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>最终实现效果如图：</p> 
<p>笑容识别：<br> <img src="https://images2.imgbox.com/a7/d4/bC3n20qf_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6e/13/AKxMnoPg_o.png" alt="在这里插入图片描述"></p> 
<p>性别识别：</p> 
<p><img src="https://images2.imgbox.com/b7/5b/ZDr3FM0e_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/89/d8/evvIqd0L_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ecbee21891af5d665e09ecce9f4c3e52/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">js实现两个大数的相加</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/38fef9185b8d56ef57c13c732e8b30f3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Repeater和Intruder的国产化平替Web Fuzzer</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>