<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>深拷贝和浅拷贝的理解及其实现方式 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="深拷贝和浅拷贝的理解及其实现方式" />
<meta property="og:description" content="深拷贝和浅拷贝 一、概念 浅拷贝：只拷贝最外面一层额数据；更深乘次的对象，只拷贝引用；
深拷贝：拷贝多层数据；每一层级别的数据都会拷贝；
拷贝引用的时候，是属于传址，而非传值；
深拷贝和浅拷贝主要针对的是对象的属性是对象（引⽤类型），浅拷贝只复制指向某个对象的指针，而不复制对象本身，新旧对象还是共享同一块内存。但深拷贝会另外创造一个一模一样的对象，新对象跟原对象不共享内存，修改新对象不会改变原对象。
二、 浅拷贝的实现方式 方式1：直接赋值
var c = { name:&#39;tom&#39;, age:20 } var d = c; c.name = &#39;jack&#39;; console.log(d); 方式2：使用 for in
var obj1 = { name: &#39;tom&#39;, age: 20, info: { msg: &#39;是一个中国人&#39; } } var obj2 = {}; //for in for (var k in obj1) { obj2[k] = obj1[k]; } console.log(obj2); obj1.info.msg = &#39;虽然是个外国人，但是很向往中国&#39;; console.log(obj2); 方式3：使用Object.assign(新数据,老数据)
var obj1 = { name:&#39;tom&#39;, age:20, info:{ msg:&#39;开心每一天&#39; } } var obj2 = {}; obj2=Object." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/4fdd7ebbc8bbba4b1f1bac3df53c0d16/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-17T17:02:24+08:00" />
<meta property="article:modified_time" content="2023-08-17T17:02:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">深拷贝和浅拷贝的理解及其实现方式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>深拷贝和浅拷贝</h3> 
<h4>一、概念</h4> 
<p>浅拷贝：只拷贝最外面一层额数据；更深乘次的对象，只拷贝引用；</p> 
<p>深拷贝：拷贝多层数据；每一层级别的数据都会拷贝；</p> 
<p>拷贝引用的时候，是属于<strong>传址</strong>，而非<strong>传值</strong>；</p> 
<p>深拷贝和浅拷贝主要针对的是对象的属性是对象（引⽤类型），浅拷贝只复制指向某个对象的指针，而不复制对象本身，<strong>新旧对象还是共享同一块内存</strong>。但深拷贝会另外创造一个一模一样的对象，<strong>新对象跟原对象不共享内存</strong>，修改新对象不会改变原对象。</p> 
<h4>二、 浅拷贝的实现方式</h4> 
<ul><li> <p>方式1：直接赋值</p> 
  <ul><li> <pre> var c = {
 name:'tom',
 age:20
 }
 var d = c;
 c.name = 'jack';
 console.log(d);</pre> </li></ul></li><li> <p>方式2：使用 for in</p> 
  <ul><li> <pre> var obj1 = {
     name: 'tom',
     age: 20,
     info: {
         msg: '是一个中国人'
     }
 }
 var obj2 = {};
 //for in
 for (var k in obj1) {
     obj2[k] = obj1[k];
 }
 console.log(obj2);
 obj1.info.msg = '虽然是个外国人，但是很向往中国';
 console.log(obj2);</pre> </li></ul></li><li> <p>方式3：使用<code>Object.assign(新数据,老数据)</code></p> 
  <ul><li> <pre> var obj1 = {
 name:'tom',
   age:20,
   info:{
     msg:'开心每一天'
   }
 }
 var obj2 = {};
 obj2=Object.assign(obj2,obj1);
 console.log(obj2);
 obj1.info.msg = '学习使你倍感快乐';
 console.log(obj2);</pre> </li></ul></li></ul> 
<ul><li> <p>方式4：函数库lodash的_.clone方法</p> <p>该函数库也有提供 _.clone 用来做 Shallow Copy，后面我们会再介绍利用这个库实现深拷贝。</p> 
  <ul><li> <pre> var _ = require('lodash');
 var obj1 = {
     a: 1,
     b: { f: { g: 1 } },
     c: [1, 2, 3]
 };
 var obj2 = _.clone(obj1);
 console.log(obj1.b.f === obj2.b.f);// true
 ​</pre> </li></ul></li><li> <p>方式5：spread运算符 ...</p> <p>spread运算符是一个 es6/es2015 特性，它提供了一种非常方便的方式来执行浅拷贝，这与 Object.assign() 的功能相同。它不复制继承的属性或类的属性，但是它会复制ES6的 symbols 属性。</p> 
  <ul><li> <pre> let obj1 = { name: 'luck', say:{x:100,y:100}}
 let obj2= {...obj1}
 obj1.say.x = 200;
 obj1.name = 'tom'
 console.log('obj2',obj2) // obj2 { name: 'luck', say: { x: 200, y: 100 } }</pre> </li></ul></li><li> <p>方式6：<code>Array.prototype.slice()</code></p> 
  <ul><li> <pre> let arr = [ 1, 3, {username: 'luck'} ];
 let arr3 = arr.slice();
 arr3[2].username = 'tom'
 console.log(arr); // [ 1, 3, { username: 'tom' } ]</pre> </li></ul></li><li> <p>方式7：<code>Array.prototype.concat()</code></p> 
  <ul><li> <pre> let arr = [ 1, 3, {username: 'luck'} ];
 let arr2 = arr.concat();    
 arr2[2].username = 'tom';
 console.log(arr); //[ 1, 3, { username: 'tom' } ]</pre> </li></ul></li></ul> 
<h4>三、深拷贝的实现</h4> 
<ul><li> <p>方式1：<code>递归函数</code></p> 
  <ul><li> <pre> //写一个递归函数，实现检车每一个数据，如果是基本数据类型，则直接添加，如果是引用数据 类型，则递归引用数据类型，把里面的数据变成基本数据类型添加进去；
 var obj1 = {
   name:'tom',
   age:20,
   info:{
     msg:'多看多练'
   },
   color:['red','green','blue']
 };
 var obj2 = {};
 deepCopy(obj2,obj1);
 console.log(obj2);
 obj1.info.msg ='不练就不会';
 console.log(obj2);
 ​
 function deepCopy(newObj,oldObj) {
 for(var k in oldObj) {
   //获取数据
   var item = oldObj[k];
    if(item instanceof Array) {
     //判断item是否为为对象
     newObj[k] = [];
     deepCopy(newObj[k],item);
   }else if(item instanceof Object){
     //判断item是否为为对象
     newObj[k]= {};
      deepCopy(newObj[k],item);
 }else{
   //简单数据类型，直接赋值
   newObj[k] = item;
 }
 }
 }</pre> </li></ul></li><li> <p>方式2：<code>JSON.parse()|JSON.stringify()</code>;</p> 
  <ul><li> <pre> let arr = [ 1, 3, {username: 'kobe'} ];
 let arr4 = JSON.parse(JSON.stringify(arr));
 arr4[2].username = 'duncan'; 
 console.log(arr, arr4)</pre> <p></p> </li><li> <p>这也是利用 JSON.stringify 将对象转成 JSON 字符串，再用 JSON.parse 把字符串解析成对象，一去一来，新的对象产生了，而且堆内存中会开辟出一个新的区域存放新对象，实现深拷贝。</p> </li><li> <p><strong>这种方法虽然可以实现数组或对象深拷贝，但不能处理函数和正则</strong>，因为这两者基于 JSON.stringify 和 JSON.parse 处理后，得到的正则就不再是正则（变为空对象），得到的函数就不再是函数（变为null）了。</p> </li><li> <p>例如下面的例子:</p> </li><li> <pre> let arr = [ 1, 3, {username: 'luck'}, function(){} ];
 let arr4 = JSON.parse(JSON.stringify(arr));
 arr4[2].username = 'tom'; 
 console.log(arr, arr4)</pre> </li></ul></li><li> <p>方式3：<code>函数库 lodash 的 _.cloneDeep 方法</code></p> 
  <ul><li> <pre> var _ = require('lodash');
 var obj1 = {
     a: 1,
     b: { f: { g: 1 } },
     c: [1, 2, 3]
 };
 var obj2 = _.cloneDeep(obj1);
 console.log(obj1.b.f === obj2.b.f);// false</pre> </li></ul></li><li> <p>方式4:<code>jQuery.extend() 方法</code></p> 
  <ul><li> <pre> $.extend(deepCopy, target, object1, [objectN])  //第一个参数为true,就是深拷贝
 ​
 var $ = require('jquery');
 var obj1 = {
     a: 1,
     b: { f: { g: 1 } },
     c: [1, 2, 3]
 };
 var obj2 = $.extend(true, {}, obj1);
 console.log(obj1.b.f === obj2.b.f); // false</pre> </li></ul></li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/11d2ccb5dcd047fe3860159894465b53/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【报错解决-Golang】go mod 替换第三方包提示：module declares its path as: ××× but was required as: ×××</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0e714cd4ac573bf6ece92374d777e2f1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于springboot的企业进销存管理系统/进销存管理系统/库存管理系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>