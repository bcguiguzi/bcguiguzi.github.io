<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>炼丹速度×7！你的Mac电脑也能在PyTorch训练中用GPU加速了 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="炼丹速度×7！你的Mac电脑也能在PyTorch训练中用GPU加速了" />
<meta property="og:description" content=" 点击上方“小白学视觉”，选择加&#34;星标&#34;或“置顶”
重磅干货，第一时间送达 来源 | 量子位（QbitAI）
编辑 | 丰色、发自、凹非寺
一直以来，Pytorch在Mac上仅支持使用CPU进行训练。
就在刚刚，Pytorch官方宣布，其最新版v1.12可以支持GPU加速了。
只要是搭载了M1系列芯片的Mac都行。
这也就意味着在Mac本机用Pytorch“炼丹”会更方便了！
训练速度可提升约7倍
此功能由Pytorch与Apple的Metal工程团队合作推出。
它使用Apple的Metal Performance Shaders(MPS) 作为PyTorch的后端来启用GPU加速训练。
为了优化计算性能，MPS还针对Metal GPU系列的独特特性对每个内核进行了微调。
Metal是一个类似OpenGL的框架，只不过OpenGL适用于各平台的移动端GPU渲染和计算，Metal专用于iOS/MacOS平台，不过也兼顾了性能和易用性。
MPS就是一套基于Metal框架的库，直接调用即可使用GPU的高性能进行图形处理、构建卷积神经网络等工作。
苹果官方在搭载了M1 Ultra、20核CPU、64核GPU、128GB RAM和2TB SSD的Mac Studio上进行了测试。
（这阵容差不多能算是豪华配置了）。
他们分别训练了batch size为128的ResNet50、batch size为64的HuggingFace BERT，以及batch size=64的VGG16。
从下图中我们可以发现，相比使用CPU加速，使用GPU可将模型训练速度提高约7倍，评估（evaluation）速度则最高能提约20倍。
看到这儿，有网友开始好奇它与搭载了Nvidia GPU的laptop相比性能如何。
有人表示，虽说目前M1的原始计算性能比不上英伟达的产品，但功耗方面还不错。未来苹果很有可能慢慢追上性能。
总的来说，Mac Studio现在看起来实在太香了。
他进一步解释道：
“毕竟它是你花4800美元就能买到的最便宜、包含128GB GPU内存的机器。现在有了基于GPU加速的PyTorch支持，完全可以用来训练大模型、配置大的batch size。
对于我所做的那种DL工作，数据加载比实际的原始计算能力更容易成为瓶颈。”
你心动了吗？
现在就试试？
只需保证你的macOS操作系统在12.3版本及以上，且安装了arm64原生Python，然后去官网下载最新的Pytorch预览版就可以了。
地址：
https://pytorch.org/blog/introducing-accelerated-pytorch-training-on-mac/
— 完 —
下载1：OpenCV-Contrib扩展模块中文版教程 在「小白学视觉」公众号后台回复：扩展模块中文教程，即可下载全网第一份OpenCV扩展模块教程中文版，涵盖扩展模块安装、SFM算法、立体视觉、目标跟踪、生物视觉、超分辨率处理等二十多章内容。 下载2：Python视觉实战项目52讲 在「小白学视觉」公众号后台回复：Python视觉实战项目，即可下载包括图像分割、口罩检测、车道线检测、车辆计数、添加眼线、车牌识别、字符识别、情绪检测、文本内容提取、面部识别等31个视觉实战项目，助力快速学校计算机视觉。 下载3：OpenCV实战项目20讲 在「小白学视觉」公众号后台回复：OpenCV实战项目20讲，即可下载含有20个基于OpenCV实现20个实战项目，实现OpenCV学习进阶。 交流群 欢迎加入公众号读者群一起和同行交流，目前有SLAM、三维视觉、传感器、自动驾驶、计算摄影、检测、分割、识别、医学影像、GAN、算法竞赛等微信群（以后会逐渐细分），请扫描下面微信号加群，备注：”昵称&#43;学校/公司&#43;研究方向“，例如：”张三 &#43; 上海交大 &#43; 视觉SLAM“。请按照格式备注，否则不予通过。添加成功后会根据研究方向邀请进入相关微信群。请勿在群内发送广告，否则会请出群，谢谢理解~ " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/d5094e8b8444598fc505368a04f47ac5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-15T10:39:42+08:00" />
<meta property="article:modified_time" content="2023-06-15T10:39:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">炼丹速度×7！你的Mac电脑也能在PyTorch训练中用GPU加速了</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <pre></pre> 
 <p style="text-align:center;">点击上方“<strong>小白学视觉</strong>”，选择加"<strong>星标</strong>"或“<strong>置顶</strong>”</p> 
 <pre class="has"><code class="language-go">重磅干货，第一时间送达</code></pre> 
 <p style="text-align:center;">来源 | 量子位（QbitAI）</p> 
 <p style="text-align:center;">编辑 | 丰色、发自、凹非寺</p> 
 <p style="text-align:left;">一直以来，Pytorch在Mac上仅支持使用CPU进行训练。</p> 
 <p style="text-align:left;">就在刚刚，Pytorch官方宣布，其最新版v1.12可以<strong>支持GPU加速</strong>了。</p> 
 <p style="text-align:left;">只要是搭载了<strong>M1系列芯片</strong>的Mac都行。</p> 
 <p style="text-align:center;"><img width="1200" src="https://images2.imgbox.com/d2/40/W2Ljgt79_o.png" alt="855b277f8e94e8586c0d3a23ec594cc5.png"></p> 
 <p style="text-align:left;">这也就意味着在Mac本机用Pytorch“炼丹”会更方便了！</p> 
 <p><strong>训练速度可提升约7倍</strong></p> 
 <p style="text-align:left;">此功能由Pytorch与Apple的Metal工程团队合作推出。</p> 
 <p style="text-align:left;">它使用Apple的<strong>Metal Performance Shaders</strong>(MPS) 作为PyTorch的后端来启用GPU加速训练。</p> 
 <p style="text-align:left;">为了优化计算性能，MPS还针对Metal GPU系列的独特特性对每个内核进行了微调。</p> 
 <blockquote> 
  <p>Metal是一个类似OpenGL的框架，只不过OpenGL适用于各平台的移动端GPU渲染和计算，Metal专用于iOS/MacOS平台，不过也兼顾了性能和易用性。</p> 
  <p>MPS就是一套基于Metal框架的库，直接调用即可使用GPU的高性能进行图形处理、构建卷积神经网络等工作。</p> 
 </blockquote> 
 <p style="text-align:center;"><img width="520" src="https://images2.imgbox.com/96/d9/Mia3dVvJ_o.png" alt="330be572549882091d4a79aaa6e2a5dc.png"></p> 
 <p style="text-align:left;">苹果官方在搭载了<strong>M1 Ultra、20核CPU、64核GPU、128GB RAM和2TB SSD的Mac Studio</strong>上进行了测试。</p> 
 <p style="text-align:left;">（这阵容差不多能算是豪华配置了）。</p> 
 <p style="text-align:left;">他们分别训练了batch size为128的<strong>ResNet50</strong>、batch size为64的<strong>HuggingFace BERT</strong>，以及batch size=64的<strong>VGG16</strong>。</p> 
 <p style="text-align:left;">从下图中我们可以发现，相比使用CPU加速，使用GPU可将模型训练速度提高约7倍，评估（evaluation）速度则最高能提约20倍。</p> 
 <p style="text-align:center;"><img width="1200" src="https://images2.imgbox.com/35/d0/IbAjmKVL_o.gif" alt="bdf2cb301683c15db8a5f987645a887d.gif"></p> 
 <p style="text-align:left;">看到这儿，有网友开始好奇它与搭载了Nvidia GPU的laptop相比性能如何。</p> 
 <p style="text-align:center;"><img width="1200" src="https://images2.imgbox.com/db/19/jMCV4Hq0_o.png" alt="15d53a77cd7d58a5609c9cd0c6dacd20.png"></p> 
 <p style="text-align:left;">有人表示，虽说目前M1的原始计算性能比不上英伟达的产品，但功耗方面还不错。未来苹果很有可能慢慢追上性能。</p> 
 <p style="text-align:left;">总的来说，<strong>Mac Studio现在看起来实在太香了</strong>。</p> 
 <p style="text-align:left;">他进一步解释道：</p> 
 <p style="text-align:left;">“毕竟它是你花4800美元就能买到的最便宜、包含<strong>128GB GPU内存</strong>的机器。现在有了基于GPU加速的PyTorch支持，完全可以用来训练大模型、配置大的batch size。</p> 
 <p style="text-align:left;">对于我所做的那种DL工作，数据加载比实际的原始计算能力更容易成为瓶颈。”</p> 
 <p style="text-align:center;"><img width="1200" src="https://images2.imgbox.com/54/0a/fvaWb5Ls_o.png" alt="3cdb4e333a62151bf270643b18e5178e.png"></p> 
 <p style="text-align:left;">你心动了吗？</p> 
 <p style="text-align:left;">现在就试试？</p> 
 <p style="text-align:left;">只需保证你的macOS操作系统在12.3版本及以上，且安装了arm64原生Python，然后去官网下载最新的Pytorch预览版就可以了。</p> 
 <p style="text-align:center;"><img width="1200" src="https://images2.imgbox.com/f0/72/bWu5Vvza_o.png" alt="efd0dfac23c19ccf4f0d23d65fed8f0a.png"></p> 
 <p style="text-align:left;">地址：<br>https://pytorch.org/blog/introducing-accelerated-pytorch-training-on-mac/<br></p> 
 <p>— <strong>完</strong> —</p> 
 <pre class="has"><code class="language-go">下载1：OpenCV-Contrib扩展模块中文版教程

在「小白学视觉」公众号后台回复：扩展模块中文教程，即可下载全网第一份OpenCV扩展模块教程中文版，涵盖扩展模块安装、SFM算法、立体视觉、目标跟踪、生物视觉、超分辨率处理等二十多章内容。


下载2：Python视觉实战项目52讲
在「小白学视觉」公众号后台回复：Python视觉实战项目，即可下载包括图像分割、口罩检测、车道线检测、车辆计数、添加眼线、车牌识别、字符识别、情绪检测、文本内容提取、面部识别等31个视觉实战项目，助力快速学校计算机视觉。


下载3：OpenCV实战项目20讲
在「小白学视觉」公众号后台回复：OpenCV实战项目20讲，即可下载含有20个基于OpenCV实现20个实战项目，实现OpenCV学习进阶。


交流群

欢迎加入公众号读者群一起和同行交流，目前有SLAM、三维视觉、传感器、自动驾驶、计算摄影、检测、分割、识别、医学影像、GAN、算法竞赛等微信群（以后会逐渐细分），请扫描下面微信号加群，备注：”昵称+学校/公司+研究方向“，例如：”张三 + 上海交大 + 视觉SLAM“。请按照格式备注，否则不予通过。添加成功后会根据研究方向邀请进入相关微信群。请勿在群内发送广告，否则会请出群，谢谢理解~</code></pre> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e08815f71bd0f1555b5e3f78f9dad793/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">网络工程和网络安全学哪个比较好？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f0a4d7c512fab22adef79952f38bac38/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于 vue2 后台管理系统构建 vue2&#43;mock.js 的经典案例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>