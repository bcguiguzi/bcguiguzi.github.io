<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【OpenCv3】 VS C&#43;&#43; （三）：图像识别 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【OpenCv3】 VS C&#43;&#43; （三）：图像识别" />
<meta property="og:description" content="OpenCv专栏：https://blog.csdn.net/qq_40515692/article/details/102885061
以下代码均在VS配置的OpenCv3上运行成功，不需要其他额外配置。
使用关键点对目标进行识别是常用的方法。一般需要经过核心关键点检测、关键点过滤、匹配方法、结果显示等步骤。
具体可以参考opencv的官方文档：
https://docs.opencv.org/3.0-beta/doc/tutorials/features2d/trackingmotion/harris_detector/harris_detector.html#harris-detector
和《学习OpenCv3》第十六章-关键点和描述子
（1）.首先是核心关键点检测：角点检测Shi-Tomasi算法，它是Harris算法的改进。实际使用时记得改下图片的读取路径。
#include &lt;opencv2/opencv.hpp&gt; #include &lt;opencv2/imgproc.hpp&gt; #include &lt;vector&gt; using namespace std; using namespace cv; Mat g_src, g_gray; int g_num; void fun(int, void*) { vector&lt;Point2f&gt; corners; Mat copy = g_src.clone(); //角点检测Shi-Tomasi算法，Harris算法的改进 goodFeaturesToTrack(g_gray, corners, g_num, 0.01, 10, Mat(), 3, false, 0.04); RNG rng(12345);//随机数产生器 for (unsigned int i = 0; i &lt; corners.size(); i&#43;&#43;) { //thickness = -1 // 如果是正数，表示组成圆的线条的粗细程度。 否则， 表示圆是否被填充 circle(copy, corners[i], 4, Scalar(rng.uniform(0, 255), rng." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/c2cff8c8902f9d7797e923d9fad61565/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-01-13T10:31:28+08:00" />
<meta property="article:modified_time" content="2019-01-13T10:31:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【OpenCv3】 VS C&#43;&#43; （三）：图像识别</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0cm;">OpenCv专栏：<a href="https://blog.csdn.net/qq_40515692/article/details/102885061">https://blog.csdn.net/qq_40515692/article/details/102885061</a></p> 
<p style="margin-left:0cm;">以下代码均在VS配置的OpenCv3上运行成功，不需要其他额外配置。</p> 
<p style="margin-left:0cm;">使用关键点对目标进行识别是常用的方法。一般需要经过核心关键点检测、关键点过滤、匹配方法、结果显示等步骤。</p> 
<p style="margin-left:0cm;">具体可以参考opencv的官方文档：</p> 
<p style="margin-left:0cm;"><u><span style="color:#0000ff;"><a href="https://docs.opencv.org/3.0-beta/doc/tutorials/features2d/trackingmotion/harris_detector/harris_detector.html#harris-detector" rel="nofollow"><span style="color:#0000ff;">https://docs.opencv.org/3.0-beta/doc/tutorials/features2d/trackingmotion/harris_detector/harris_detector.html#harris-detector</span></a></span></u></p> 
<p style="margin-left:0cm;">和《学习OpenCv3》第十六章-关键点和描述子</p> 
<p style="margin-left:0cm;">（1）.首先是核心关键点检测：角点检测Shi-Tomasi算法，它是Harris算法的改进。实际使用时记得改下图片的读取路径。</p> 
<pre class="has"><code class="language-cpp">#include &lt;opencv2/opencv.hpp&gt; 
#include &lt;opencv2/imgproc.hpp&gt;
#include &lt;vector&gt;

using namespace std;
using namespace cv;

Mat g_src, g_gray;
int g_num;

void fun(int, void*)
{
	vector&lt;Point2f&gt; corners;
	Mat copy = g_src.clone();

	//角点检测Shi-Tomasi算法，Harris算法的改进
	goodFeaturesToTrack(g_gray, corners, g_num, 0.01, 10, Mat(), 3, false, 0.04);
	RNG rng(12345);//随机数产生器

	for (unsigned int i = 0; i &lt; corners.size(); i++)
	{
		//thickness = -1
		//      如果是正数，表示组成圆的线条的粗细程度。 否则， 表示圆是否被填充
		circle(copy, corners[i], 4, Scalar(rng.uniform(0, 255), rng.uniform(0, 255), rng.uniform(0, 255)), -1);
	}
	imshow("角点检测", copy);
}

int main()
{
	// 注意更改图片位置
	g_src = imread("C:\\Users\\ttp\\Desktop\\5.jpg", 1);
	cvtColor(g_src, g_gray, COLOR_BGR2GRAY);
	namedWindow("角点检测", WINDOW_AUTOSIZE);
	createTrackbar("最大角点数", "角点检测", &amp;g_num, 500, fun);
	imshow("角点检测", g_src);
	waitKey(0);
	return 0;
}</code></pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"><img alt="" height="753" src="https://images2.imgbox.com/8a/c4/SIbnTBwB_o.png" width="1200"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">(2).OpenCv一般如何处理关键点和描述符的？</p> 
<p style="margin-left:0cm;">        cv::KeyPoint——关键点</p> 
<p style="margin-left:0cm;">        cv::Feature2D——找到关键点或计算描述符的抽象类，如下面的FastFeatureDetector即派生于Feature2D，定义了detect、compute、detectAndCompute等方法</p> 
<p style="margin-left:0cm;">然后这里给一个核心关键点检测：FAST算法的特征检测。实际使用时记得改下图片的读取路径。</p> 
<pre class="has"><code class="language-cpp">#include "opencv2/opencv.hpp"
#include&lt;opencv2/features2d.hpp&gt;

using namespace cv;

int thre = 40;
Mat src;

void trackBar(int, void*)
{
	std::vector&lt;KeyPoint&gt; keypoints;
	Mat dst = src.clone();
	//Ptr智能指针
	/*
		Ptr&lt;FILE&gt; f(fopen("myfile.txt", "w"), fclose);
		if(!f) throw ...;
		fprintf(f, ....);
		...
		// the file will be closed automatically by f's destructor.
	*/
	Ptr&lt;FastFeatureDetector&gt; detector = FastFeatureDetector::create(thre);
	detector-&gt;detect(src, keypoints);
	drawKeypoints(dst, keypoints, dst, Scalar::all(-1), DrawMatchesFlags::DRAW_OVER_OUTIMG);
	imshow("output", dst);
}

int main(int argc, char** argv)
{
	// 注意更改文件位置
	src = imread("C:\\Users\\ttp\\Desktop\\5.jpg");
	if (src.empty())
	{
		printf("can not load image \n");
		return -1;
	}
	namedWindow("input", WINDOW_AUTOSIZE);
	imshow("input", src);

	namedWindow("output", WINDOW_AUTOSIZE);
	createTrackbar("threshould", "output", &amp;thre, 255, trackBar);
	cvWaitKey(0);
	return 0;
}
</code></pre> 
<p> </p> 
<p><img alt="" height="696" src="https://images2.imgbox.com/48/3e/M5XLeKd4_o.png" width="1116"></p> 
<p> </p> 
<p>(3).OpenCv一般如何处理关键点和描述符的？</p> 
<p style="margin-left:0cm;">        cv::KeyPoint——关键点</p> 
<p style="margin-left:0cm;">        cv::Feature2D——找到关键点或计算描述符的抽象类，如上面的FastFeatureDetector即派生于Feature2D，定义了detect、compute、detectAndCompute等方法</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">上面介绍的主要是查找角点、关键点，除此之外我们还需要下面这些步骤。</p> 
<p style="margin-left:0cm;">        cv::DMatch——匹配器</p> 
<p style="margin-left:0cm;">        cv::DescriptorMatcher——关键点匹配的抽象类，在下一节我们将在代码中具体使用它们。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9b1dd8b10eebf644c891aee63f475aa4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">proteus 与 keil 的安装及联调</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6a816a17c0e8fec50b792751051c1477/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ubuntu16.04  caffe编译过程记录</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>