<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>TextBox控件只允许输入数字 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="TextBox控件只允许输入数字" />
<meta property="og:description" content="1.1、在Asp.Net TextBox 控件的 OnKeyPress 事件中指定输入键盘码必须为数字：
&lt;asp:TextBox ID=&#34;TextBox&#34; runat=&#34;server&#34; OnKeyPress=&#34;if(((event.keyCode&gt;=48)&amp;&amp;(event.keyCode &lt;=57))||(event.keyCode==46)) {event.returnValue=true;} else{event.returnValue=false;} &#34; MaxLength=&#34;15&#34;&gt; &lt;/asp:TextBox&gt;
注意：如果不允许输入小数点去掉“event.keyCode==46”这种情况
或者：&lt;asp:TextBox ID=&#34;TextBox&#34; runat=&#34;server&#34; οnkeyup=&#39;value=value.replace(/[^d]/g,&#39;&#39;) &#39; onbeforepaste=&#39;clipboardData.setData(&#39;text&#39;,clipboardData.getData(&#39;text&#39;).replace(/[^d]/g,&#39;&#39;))&#39; MaxLength=&#34;15&#34;&gt; &lt;/asp:TextBox&gt;
类似方法一:
if(e.KeyChar!=8!Char.IsDigit(e.KeyChar)e.KeyChar!=&#39;.&#39;){ e.Handled = true; }　类似方法二:
if ((e.KeyChar &lt; 48 || e.KeyChar &gt; 57) (e.KeyChar != 8) e.KeyChar!=&#39;.&#39;){ e.Handled = true; }
类似方法三:
if (!Char.IsNumber(e.KeyChar) !Char.IsPunctuation(e.KeyChar) !Char.IsControl(e.KeyChar)){ e.Handled = true;}
解释:其中e.KeyChar是键盘输入的键对应的字符，IsDigit函数可以判断是否为0到9的数字，Chr(8)
为退格键，当e.Handled为True时，程序认为该KeyPress事件已经被处理过了，文本框的内容也就不会发生变化
如果文本需要输入小数的话，就要能够输入小数点.，而且小数点只能输入一次
//IsNumber：指定字符串中位于指定位置的字符是否属于数字类别
//IsPunctuation：指定字符串中位于指定位置的字符是否属于标点符号类别
//IsControl：指定字符串中位于指定位置的字符是否属于控制字符类别
注意: 这里是在输入时便限制其他类型的字符被写入 TextBox；
就是说你不输入正确或你输入的不是数字我就不让你做其他任何工作!
霸道吧? 呵呵, 如果你不喜欢这种方式, 下面有几种允许用户先随便输入," />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/7e45b20ad89d3d5f215280bbb6e8fc9c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-03-14T17:02:00+08:00" />
<meta property="article:modified_time" content="2011-03-14T17:02:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">TextBox控件只允许输入数字</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>1.1、在Asp.Net TextBox 控件的 OnKeyPress 事件中指定输入键盘码必须为数字：<br> &lt;asp:TextBox ID="TextBox" runat="server" <span style="color: #ff0000;">OnKeyPress="if(((event.keyCode&gt;=48)&amp;&amp;(event.keyCode &lt;=57))||(event.keyCode==46)) {event.returnValue=true;} else{event.returnValue=false;}</span> " MaxLength="15"&gt; &lt;/asp:TextBox&gt;</p> 
<p>注意：如果不允许输入小数点去掉“event.keyCode==46”这种情况</p> 
<p>或者：&lt;asp:TextBox ID="TextBox" runat="server" <span style="color: #ff0000;">οnkeyup='value=value.replace(/[^d]/g,'') ' onbeforepaste='clipboardData.setData('text',clipboardData.getData('text').replace(/[^d]/g,''))'</span> MaxLength="15"&gt; &lt;/asp:TextBox&gt;</p> 
<p>　　类似方法一:<br> if(e.KeyChar!=8!Char.IsDigit(e.KeyChar)e.KeyChar!='.'){ e.Handled = true; }　<br> 　　类似方法二:<br> if ((e.KeyChar &lt; 48 || e.KeyChar &gt; 57) (e.KeyChar != 8) e.KeyChar!='.'){ e.Handled = true; }<br> 　　类似方法三:<br> if (!Char.IsNumber(e.KeyChar) !Char.IsPunctuation(e.KeyChar) !Char.IsControl(e.KeyChar)){ e.Handled = true;}<br> 　　解释:其中e.KeyChar是键盘输入的键对应的字符，IsDigit函数可以判断是否为0到9的数字，Chr(8)<br> 　　为退格键，当e.Handled为True时，程序认为该KeyPress事件已经被处理过了，文本框的内容也就不会发生变化<br> 　　如果文本需要输入小数的话，就要能够输入小数点.，而且小数点只能输入一次<br> 　　//IsNumber：指定字符串中位于指定位置的字符是否属于数字类别<br> 　　//IsPunctuation：指定字符串中位于指定位置的字符是否属于标点符号类别<br> 　　//IsControl：指定字符串中位于指定位置的字符是否属于控制字符类别<br> 　　注意: 这里是在输入时便限制其他类型的字符被写入 TextBox；<br> 　　就是说你不输入正确或你输入的不是数字我就不让你做其他任何工作!<br> 　　霸道吧? 呵呵, 如果你不喜欢这种方式, 下面有几种允许用户先随便输入,<br> 　　然后再判断, 如果不是整数, 我给你来个警告, 告诉你输入类型不正确, 请重新输入!<br> 　　---不过在我看来, 这种做法有些不道德, 等着你犯错.</p> 
<p>　　类似方法四: 正则表达式.<br> 　　string regExp 　= 　/^[1-9][0-9]*$/; 　<br> 　    if(!regExp.test( this.txtLogin.Text)) 　<br> 　    { 　<br> 　 　　alert(只能是数字！); 　<br> 　 　　this.txtLogin.clear(); 　<br> 　 　　return ;　<br> 　    }<br> 　　类似方法五: 最没有想象力的(原始)判断方法---一个一个一个一个字符判断还需要加上个for循环和n个if:<br> 　 function isInt(a) 　<br>      { var b = "0123456789"; 　　<br> 　    var i;<br>         for 　(i = 0; i &lt;a.length; i++) 　<br> 　 　{ 　　　　<br> 　 　　　var c = a.charAt(i); 　<br> 　 　　　if (b.indexOf(c) 　== 　-1) return false; 　<br> 　 　} 　<br> 　 　return true; 　<br> 　}</p> 
<p>1.2、使用规则表达式来验证：<br> &lt;asp:TextBox ID="UserQQ" runat="server" Columns="18" MaxLength="50" Width="130px"&gt; &lt;/asp:TextBox&gt; <br> &lt;asp:RegularExpressionValidator ID="RegularExpressionValidator1" runat="server" ControlToValidate="UserQQ" ErrorMessage="QQ号只能为数字" validationexpression="/d+"&gt; &lt;/asp:RegularExpressionValidator&gt;</p> 
<p>1.3、支持多数据类型验证的TextBox:<br> using System;<br> using System.Web.UI;<br> using System.Web.UI.WebControls;<br> using System.ComponentModel;<br> using System.Drawing;<br> using System.Text;<br> using System.Text.RegularExpressions;<br> namespace rungoo.WebCtrlLib<br> {<!-- --><br>     /// &lt;summary&gt;<br>     /// 重写的TextBox控件<br>     /// Author: nowind<br>     /// Date: 2006-5-9<br>     /// Email: <a href="mailto:hgh113@sina.com" rel="nofollow">hgh113@sina.com</a> <br>     /// QQ: 87505959<br>    /// Home:http://www.mofun.cc<br>     /// &lt;summary&gt;</p> 
<p>    #region 枚举数据<br>     /// &lt;summary&gt;<br>     /// 验证数据类型<br>     /// &lt;/summary&gt;<br>     public enum DataType<br>     {<!-- --><br>         Never,     //不验证<br>         String,     //字符串<br>         Int,     //整数<br>         IntPostive,    //大于0的整数<br>         IntZeroPostive,   //大于等于0的整数<br>         Float,     //数字<br>         FloatPostive,   //大于0的数字<br>         FloatZeroPostive, //大于等于0的数字<br>         Url,<br>         Mail,<br>         //ChineseChars,   //汉字<br>         EnglishChars,   //英文<br>         EngNum,     //英文和数字<br>         EngNumUnerline,   //英文、数字和下划线<br>         PhoneNumber,   //电话号码<br>         MobileNumber,   //手机号码<br>         PostalCode,    //邮政编码<br>         Custom<br>     }<br>     #endregion</p> 
<p>    /// Attribute DefaultProperty指定组件的默认属性，ToolboxData指定当从IDE工具中的工具箱中拖动自定义控件时为它生成的默认标记<br>     [DefaultProperty("AllowEmpty"), ToolboxData("&lt;{0}:WebTextBox runat=server&gt;&lt;/{0}:WebTextBox&gt;")]<br>     //类MyControl派生自WebControl<br>     public class WebTextBox : System.Web.UI.WebControls.TextBox<br>     {<!-- --><br>         #region 子控件<br>         //private System.Web.UI.WebControls.TextBox txtDataInput = new TextBox();<br>         private System.Web.UI.WebControls.RequiredFieldValidator rfvDataInput = new RequiredFieldValidator();<br>         private System.Web.UI.WebControls.RegularExpressionValidator revDataInput = new RegularExpressionValidator();<br>         private Panel pnlFrame = new Panel();    //承载其它控件的容器Panel控件<br>         #endregion</p> 
<p>        private string error = "";</p> 
<p>        #region 控件自定义属性</p> 
<p>        [Bindable(true)]<br>         [Category("自定义信息区")]<br>         [Browsable(true)]<br>         [Description("是否允许空值")]<br>         [DefaultValue("true")]<br>         public bool AllowEmpty<br>         {<!-- --><br>             get { return ViewState["AllowEmpty"] == null ? true : (bool) ViewState["AllowEmpty"]; }<br>             set { ViewState["AllowEmpty"] = value; }<br>         }<br>         [Bindable(true)]<br>         [Category("自定义信息区")]<br>         [Browsable(true)]<br>         [Description("验证数据类型，默认为不验证")]<br>         [DefaultValue("IntPostive")]<br>         public DataType ValidType<br>         {<!-- --><br>             get { return ViewState["ValidType"] == null ? DataType.Never : (DataType) ViewState["ValidType"]; }<br>             set { ViewState["ValidType"] = value; }<br>         }<br>         [Bindable(true)]<br>         [Browsable(true)]<br>         [Category("自定义信息区")]<br>         [Description("自定义验证错误信息")]<br>         [DefaultValue("")]<br>         public string ValidError<br>         {<!-- --><br>             get { return ViewState["ValidError"] == null ? "" : (string) ViewState["ValidError"]; }<br>             set { ViewState["ValidError"] = value; }<br>         }<br>         [Bindable(true)]<br>         [Browsable(true)]<br>         [Category("自定义信息区")]<br>         [Description("自定义用于验证的正则表达式，ValidType 为 Custom 时有效")]<br>         [DefaultValue("")]<br>         public string ValidExpressionCustom<br>         {<!-- --><br>             get { return ViewState["ValidExpressionCustom"] == null ? "" : (string) ViewState["ValidExpressionCustom"]; }<br>             set { ViewState["ValidExpressionCustom"] = value; }<br>         }<br>         [Bindable(true)]<br>         [Browsable(true)]<br>         [Category("自定义信息区")]<br>         [Description("错误信息提示的CSS类名")]<br>         [DefaultValue("")]<br>         public string CssError<br>         {<!-- --><br>             get { return ViewState["CssError"] == null ? "" : (string) ViewState["CssError"]; }<br>             set { ViewState["CssError"] = value; }<br>         }</p> 
<p>        #endregion</p> 
<p>        #region 构造函数<br>         public WebTextBox() { }<br>         #endregion</p> 
<p>        #region EnsureChildControls<br>         protected override void EnsureChildControls()<br>         {<!-- --><br>             this.rfvDataInput.CssClass = this.CssError;<br>             this.rfvDataInput.ErrorMessage = "*输入不能为空";<br>             this.rfvDataInput.Display = System.Web.UI.WebControls.ValidatorDisplay.Dynamic;<br>             this.rfvDataInput.EnableViewState = true;<br>             this.rfvDataInput.ControlToValidate = base.ID;<br>             this.revDataInput.CssClass = this.CssError;<br>             this.revDataInput.ErrorMessage = "*输入格式错误";<br>             this.revDataInput.Display = System.Web.UI.WebControls.ValidatorDisplay.Dynamic;<br>             this.revDataInput.EnableViewState = true;<br>             this.revDataInput.ControlToValidate = base.ID;<br>             //将子控件添加到此自定义控件中<br>             this.Controls.Add(rfvDataInput);<br>             this.Controls.Add(revDataInput);<br>             this.Controls.Add(pnlFrame);<br>         }<br>         #endregion</p> 
<p>        /// &lt;summary&gt;<br>         /// 根据设置的验证数据类型返回不同的正则表达式样<br>         /// &lt;/summary&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         #region GetRegex<br>         private string GetValidRegex()<br>         {<!-- --><br>             string regex = @"(/S)";<br>             switch (this.ValidType)<br>             {<!-- --><br>             case DataType.Never:<br>                 break;<br>             case DataType.Int:<br>                 error = "*必须为整数";<br>                 regex = @"(-)?(/d+)";<br>                 break;<br>             case DataType.IntPostive:<br>                 error = "*必须为大于0的整数";<br>                 regex = @"([1-9]{1}/d*)";<br>                 break;<br>             case DataType.IntZeroPostive:<br>                 error = "*必须为不小于0的整数";<br>                 regex = @"(/d+)";<br>                 break;<br>             case DataType.Float:<br>                 error = "*必须为数字";<br>                 regex = @"(-)?(/d+)(((/.)(/d)+))?";<br>                 break;<br>             case DataType.FloatPostive:<br>                 error = "*必须为大于0的数字";<br>                 regex = @"(/d+)(((/.)(/d)+))?";<br>                 break;<br>             case DataType.FloatZeroPostive:<br>                 error = "*必须为不小于0的数字";<br>                 regex = @"(/d+)(((/.)(/d)+))?";<br>                 break;<br>             case DataType.Url:<br>                 error = "*URL格式错误";<br>                 regex = @"(<a href="http://%29/?%28%5B%20w-%5D+%20.%29+%5B%20w-%5D+%28/%5B%20w" rel="nofollow">http://)?([/w-]+/.)+[/w-]+(/[/w</a> - ./?%&amp;=]*)?";<br>                 break;<br>             case DataType.Mail:<br>                 error = "*EMail格式错误";<br>                 regex = @"/w+([-+.]/w+)*@/w+([-.]/w+)*/./w+([-.]/w+)*";<br>                 break;<br>             //    case DataType.ChineseChars :<br>             //     error = "*包含中文字符";<br>             //     regex = @"[^/x00-/xff]";<br>             //     break;<br>             case DataType.EnglishChars:<br>                 error = "*只能输入英文字符";<br>                 regex = @"[a-zA-Z]*";<br>                 break;<br>             case DataType.EngNum:<br>                 error = "*只能输入英文字符和数字";<br>                 regex = @"[a-zA-Z0-9]*";<br>                 break;<br>             case DataType.EngNumUnerline:<br>                 error = "*只能输入英文字符、数字和下划线";<br>                 regex = @"[a-zA-Z0-9_]*";<br>                 break;<br>             case DataType.PhoneNumber:<br>                 error = "*电话号码格式错误";<br>                 regex = @"(86)?(-)?(0/d{2,3})?(-)?(/d{7,8})(-)?(/d{1,5})?";<br>                 break;<br>             case DataType.MobileNumber:<br>                 error = "*手机号码格式错误";<br>                 regex = @"(0)?(13)/d{9}";<br>                 break;<br>             case DataType.PostalCode:<br>                 error = "*邮编格式错误";<br>                 regex = @"/d{6}";<br>                 break;<br>             case DataType.Custom:<br>                 error = "*格式错误";<br>                 regex = this.ValidExpressionCustom;<br>                 break;<br>             default:<br>                 break;<br>             }<br>             if (this.ValidError.Trim() != "")<br>                 error = this.ValidError;<br>             return regex;<br>         }<br>         #endregion</p> 
<p>        #region 将此控件呈现给指定的输出参数<br>         /// &lt;summary&gt; <br>         /// 将此控件呈现给指定的输出参数。<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="output"&gt; 要写出到的 HTML 编写器 &lt;/param&gt;<br>         protected override void Render(HtmlTextWriter output)<br>         {<!-- --><br>             base.Render(output);<br>             output.Write("&amp;nbsp;");<br>             if (!this.AllowEmpty)<br>             {<!-- --><br>                 this.rfvDataInput.ID = "rfv" + base.ID;<br>                 this.rfvDataInput.ControlToValidate = base.ID;<br>                 this.rfvDataInput.RenderControl(output);<br>             }<br>             if (this.ValidType != DataType.Never &amp;&amp; this.ValidType != DataType.String)<br>             {<!-- --><br>                 this.revDataInput.ID = "rev" + base.ID;<br>                 this.revDataInput.ControlToValidate = base.ID;<br>                 this.revDataInput.ValidationExpression = this.GetValidRegex();<br>                 this.revDataInput.ErrorMessage = error;<br>                 this.revDataInput.RenderControl(output);<br>             }<br>         }<br>         #endregion</p> 
<p>    }<br> }</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0202e526e063573c408b1db43f56ce2c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">状态栏上放进度条&amp;纹理操作@MFC/OpenGL</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1973910482fc1a1a8ef4052f12ee3ca9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">google免费获取天气预报的信息的API</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>