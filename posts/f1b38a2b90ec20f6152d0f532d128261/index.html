<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>贝叶斯分析：抛硬币的概率真的是1/2吗 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="贝叶斯分析：抛硬币的概率真的是1/2吗" />
<meta property="og:description" content="前言
前面两文介绍了贝叶斯学派的思想和先验分布、后验分布的相关知识，古典频率学派认为抛硬币的概率是常数，本文从贝叶斯学派的角度看待抛硬币的概率问题。本文详细介绍了 β分布，重述贝叶斯思想，对于抛硬币的概率问题作各种情况的分析，最后总结本文。
目录
1、为什么选择β分布作为先验分布
2、重述贝叶斯思想
3、抛硬币问题的多情况分析
4、总结
1、为什么选择β分布作为先验分布
本节详细介绍β分布的定义及解释选择β分布作为先验分布的原因。
1、β分布
β函数的定义：
其中α，β &gt; 0，对等式两边各除以B(α,β)，字母p代替x，得：
选积分项作为β分布函数，由积分项可知β分布已完成标准化（总积分等于1）。
因此，β分布：
β分布的期望和方差：
2、β分布作为先验分布的原因
由β分布定义可知，β分布是概率分布的分布，β分布常作为先验分布的原因：
（1）、贝叶斯对参数的估计与先验分布的选择有很重要的关系，先验分布不同，贝叶斯对参数的估计也不同。先验分布往往是人们根据以往经验去设计，β分布是概率分布的分布，涵盖了所有参数空间出现的概率大小，并通过设置参数α和β，可以使先验分布与你的先验经验基本符合。
i) α=1，β=1
由上图可知，α=1，β=1，β分布符合均匀分布，即参数空间所有取值的概率相等。
因此，当你对参数没有任何的先验知识时，建议你假设先验参数符合均匀分布，参数的后验分布由你的实际观测数据决定。
ii) α=10，β=10
由上图可知，α=10，β=10时，β分布符合高斯分布，且在概率为0.5取得最大值，由β分布期望和方差的公式可知期望和方差分别等于0.5和0.01。
假设参数的先验分布是高斯分布，设置参数α和β相等（α&gt;1）使β分布成为高斯分布，α越大方差越小。
因此，设置α和β使参数的先验分布符合你对参数的先验认知。
（2）、上节已提到，参数的先验分布是β分布时，则先验分布和后验分布形式一样，且可以形成先验链，方便分析问题。
2、重述贝叶斯思想
因人而异，因阅历而异
关于频率学派和贝叶斯学派对频率的理解可以参考我前面的文章《浅谈频率学派和贝叶斯学派》。
贝叶斯思想是量化事件发生的不确定性，是主观评价。不同人评价同一事件发生的概率不同，因为不同人的生活经历不同，对某一事件的先验知识很可能不同，比如一个博士生和一个小学生对某一事件的看法可能不同；同一个人对同一事件发生的概率也随着自身阅历的增加而不同，例如某个人做了九件好事，你评估他是好人的概率为0.9，当他做了一件大逆不道的事情后，你评估他是好人的概率降到了0.1。贝叶斯评价事件发生的概率带有主观性，因人而异，因阅历而异。
凡事要讲数据
我们根据自己的阅历对某一事件作一个先验假设，先验假设是否正确需要经过时间的检验，即是否有足够多的观测数据符合先验假设。先验假设和观测数据是影响后验假设的两个因素，若观测数据不符合先验假设，则后验假设在先验假设的基础上开始向观测的数据偏斜，若观测的数据为无穷大时，则先验假设可以忽略不计，直接通过观测数据来估计后验假设。因此，贝叶斯思想评价事件发生概率的准则是凡事要讲数据。
PS：有点绕口，希望大家看完笔者介绍抛硬币的例子，再来悟一悟这几句话，若还有疑问请微信我
3、抛硬币问题的多情况分析
抛硬币问题的公式说明
由于《浅谈先验分布和后验分布》已经通过例子推导了抛硬币正面向上的后验概率，因此，本文不做推论，具体可参考上篇文章，若有疑问请微信我。本文只引用一些结论性的公式。
假设硬币正面向上的概率为u，正面向上记为1，反面向上记为0。
则硬币正面向上的先验分布如下：
硬币正面向上的期望：
其中a，b表示虚拟的硬币正面向上的次数和反面向上的次数，根据自己的先验知识来设置a，b值。
若后续的观测结果为m次正面向上，l次反面向上，共N次。
则硬币正面向上的后验分布如下：
硬币为正面向上的概率：
多情况的抛硬币问题
（1）第1次抛硬币为正面向上的概率；
（2）9次硬币正面向上，1次反面向上，第十一次硬币正面向上的概率；
（3）90次硬币正面向上，10次硬币反面向上，求101次正面向上的概率；
（4）900次硬币正面向上，100次硬币反面向上，求第1001次硬币正面向上的概率。
解：
贝叶斯的后验分布受先验分布的影响，不同的先验分布会有不同的后验分布。请参考第一节，假设硬币正面向上的分布符合高斯分布（a=10，b=10），高斯分布符合大部分人的思想，认为硬币为正面向上的概率在0.5达到最大，方差表示先验分布的确定程度，若你坚信硬币向上的概率肯定是0.5，那么可以调大a和b值。
作者就先验分布为高斯分布来解答抛硬币的四个问题。其他先验分布可通过调节a，b的值来实现，后面的计算过程一致。
正面向上的后验概率：
a，b，m，l分别表示先验分布的正面向上次数，反面向上次数，已观测数据的正面向上次数，反面向上次数。
先验分布为高斯分布：
（1）由于没有任何观测数据，因此第一次正面向上的分布为先验分布，先验分布在在参数为0.5时，概率最大，即正面向上的概率为0.5。
（2）正面向上的概率为：
（3）计算过程与（2）一样，正面向上的概率：0.83
（4）正面向上的概率：0.89
讨论：
频率学派认为硬币向上的概率是0.5，与观测数据无关。贝叶斯学派是通过数据来主观评价硬币向上的概率，由例子可知，即使先验分布符合高斯分布且正面向上的概率在0.5达到最大，但是如果观测数据倾向于正面向上，则最终的判断结果会倾向于正面向上，贝叶斯思想有点像是风往哪边吹树就往哪边倒的意思。当观测结果的正面向上次数远远大于正面向下次数，也远远大于先验分布的正面向下次数，则判断下次为正面向上的概率无限接近1（若不理解请参考公式）。
4、总结
本文首先详细介绍了β分布，通过调节参数a和b使β分布符合假设的先验分布，β分布使后验分布和先验分布为共轭分布，形成先验链，便于分析问题。后面讲的内容是贝叶斯思想，贝叶斯是主观评价事件发生的概率，根据先验知识来假设先验分布，若观测的数据符合先验分布，则后验分布与先验分布类似；若观测的数据不符合先验分布，则后验分布开始向观测数据倾斜，若观测数据为无穷大时，那么前验分布可以忽略不计，最大似然函数估计参数与后验分布估计参数相同，直接可以用最大似然函数来估计参数。
参考：
Christopher M." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/f1b38a2b90ec20f6152d0f532d128261/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-11-08T22:00:46+08:00" />
<meta property="article:modified_time" content="2018-11-08T22:00:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">贝叶斯分析：抛硬币的概率真的是1/2吗</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>前言</strong></p> 
<p>前面两文介绍了贝叶斯学派的思想和先验分布、后验分布的相关知识，古典频率学派认为抛硬币的概率是常数，本文从贝叶斯学派的角度看待抛硬币的概率问题。本文详细介绍了 β分布，重述贝叶斯思想，对于抛硬币的概率问题作各种情况的分析，最后总结本文。</p> 
<p><strong>目录</strong></p> 
<hr> 
<p>1、为什么选择β分布作为先验分布</p> 
<p>2、重述贝叶斯思想</p> 
<p>3、抛硬币问题的多情况分析</p> 
<p>4、总结</p> 
<p> </p> 
<p><strong>                                                                                1、为什么选择β分布作为先验分布</strong></p> 
<hr> 
<p>本节详细介绍β分布的定义及解释选择β分布作为先验分布的原因。</p> 
<p><strong>1、β分布</strong></p> 
<p>β函数的定义：</p> 
<p>               <img alt="" class="has" height="54" src="https://images2.imgbox.com/77/99/HFwefc4e_o.png" width="288"></p> 
<p>其中α，β &gt; 0，对等式两边各除以B(α,β)，字母p代替x，得：</p> 
<p><img alt="" class="has" height="67" src="https://images2.imgbox.com/ac/bb/ZaQrxTfr_o.png" width="231"></p> 
<p> </p> 
<p>选积分项作为β分布函数，由积分项可知β分布已完成标准化（总积分等于1）。</p> 
<p>因此，β分布：</p> 
<p><img alt="" class="has" height="74" src="https://images2.imgbox.com/b7/57/bSGmMCzo_o.png" width="215"></p> 
<p> </p> 
<p>β分布的期望和方差：</p> 
<p><img alt="" class="has" height="1" src="https://images2.imgbox.com/e9/ac/vQ2euL8h_o.gif" width="1"><img alt="" class="has" height="94" src="https://images2.imgbox.com/bb/92/Za1ngd2b_o.png" width="177"></p> 
<p><strong>2、β分布作为先验分布的原因</strong></p> 
<p>由β分布定义可知，β分布是概率分布的分布，β分布常作为先验分布的原因：</p> 
<p><strong>（1）</strong>、贝叶斯对参数的估计与先验分布的选择有很重要的关系，先验分布不同，贝叶斯对参数的估计也不同。先验分布往往是人们根据以往经验去设计，β分布是概率分布的分布，涵盖了所有参数空间出现的概率大小，并通过设置参数α和β，可以使先验分布与你的先验经验基本符合。</p> 
<p><strong>i) α=1，β=1</strong></p> 
<p>                                                          <img alt="" class="has" height="405" src="https://images2.imgbox.com/cc/86/bvLpSHEY_o.png" width="537"></p> 
<p>由上图可知，α=1，β=1，β分布符合均匀分布，即参数空间所有取值的概率相等。</p> 
<p>因此，<strong>当你对参数没有任何的先验知识时，建议你假设先验参数符合均匀分布，参数的后验分布由你的实际观测数据决定。</strong></p> 
<p><strong>ii) α=10，β=10</strong></p> 
<p>                                                             <img alt="" class="has" height="292" src="https://images2.imgbox.com/ab/c7/Akibvmw1_o.png" width="394"></p> 
<p>由上图可知，α=10，β=10时，β分布符合高斯分布，且在概率为0.5取得最大值，由β分布期望和方差的公式可知期望和方差分别等于0.5和0.01。</p> 
<p><strong>假设参数的先验分布是高斯分布，设置参数α和β相等（α&gt;1）使β分布成为高斯分布，α越大方差越小。</strong></p> 
<p><strong>因此，设置α和β使参数的先验分布符合你对参数的先验认知。</strong></p> 
<p><strong>（2）、</strong>上节已提到，参数的先验分布是β分布时，则先验分布和后验分布形式一样，且可以形成先验链，方便分析问题。</p> 
<p> </p> 
<p><strong>                                                                            2、重述贝叶斯思想</strong></p> 
<hr> 
<p><strong>因人而异，因阅历而异</strong></p> 
<p>关于频率学派和贝叶斯学派对频率的理解可以参考我前面的文章《浅谈频率学派和贝叶斯学派》。</p> 
<p>贝叶斯思想是量化事件发生的不确定性，是主观评价。不同人评价同一事件发生的概率不同，因为不同人的生活经历不同，对某一事件的先验知识很可能不同，比如一个博士生和一个小学生对某一事件的看法可能不同；同一个人对同一事件发生的概率也随着自身阅历的增加而不同，例如某个人做了九件好事，你评估他是好人的概率为0.9，当他做了一件大逆不道的事情后，你评估他是好人的概率降到了0.1。<strong>贝叶斯评价事件发生的概率带有主观性，因人而异，因阅历而异。</strong></p> 
<p><strong>凡事要讲数据</strong></p> 
<p>我们根据自己的阅历对某一事件作一个先验假设，先验假设是否正确需要经过时间的检验，即是否有足够多的观测数据符合先验假设。先验假设和观测数据是影响后验假设的两个因素，若观测数据不符合先验假设，则后验假设在先验假设的基础上开始向观测的数据偏斜，若观测的数据为无穷大时，则先验假设可以忽略不计，直接通过观测数据来估计后验假设。因此<strong>，贝叶斯思想评价事件发生概率的准则是凡事要讲数据</strong>。</p> 
<p><strong>PS：</strong>有点绕口，希望大家看完笔者介绍抛硬币的例子，再来悟一悟这几句话，若还有疑问请微信我</p> 
<p> </p> 
<p><strong>                                                                           3、抛硬币问题的多情况分析</strong></p> 
<hr> 
<p><strong>抛硬币问题的公式说明</strong></p> 
<p>由于《浅谈先验分布和后验分布》已经通过例子推导了抛硬币正面向上的后验概率，因此，本文不做推论，具体可参考上篇文章，<strong>若有疑问请微信我</strong>。本文只引用一些结论性的公式。</p> 
<p>假设硬币正面向上的概率为u，正面向上记为1，反面向上记为0。</p> 
<p>则硬币正面向上的先验分布如下：</p> 
<p><img alt="" class="has" height="75" src="https://images2.imgbox.com/c7/e8/C4rlMZb3_o.png" width="327"></p> 
<p> </p> 
<p>硬币正面向上的期望：</p> 
<p><img alt="" class="has" height="80" src="https://images2.imgbox.com/e6/7b/Aaf0ue4h_o.png" width="283"></p> 
<p> </p> 
<p>其中a，b表示虚拟的硬币正面向上的次数和反面向上的次数，根据自己的先验知识来设置a，b值。</p> 
<p> </p> 
<p>若后续的观测结果为<strong>m</strong>次正面向上，<strong>l</strong>次反面向上，共N次。</p> 
<p>则硬币正面向上的后验分布如下：</p> 
<p><img alt="" class="has" height="78" src="https://images2.imgbox.com/73/aa/IavPSJyC_o.png" width="517"></p> 
<p> </p> 
<p>硬币为正面向上的概率：</p> 
<p>    <img alt="" class="has" height="151" src="https://images2.imgbox.com/80/32/5lFlgNJR_o.png" width="615"></p> 
<p><strong>多情况的抛硬币问题</strong></p> 
<p>（1）第1次抛硬币为正面向上的概率；</p> 
<p>（2）9次硬币正面向上，1次反面向上，第十一次硬币正面向上的概率；</p> 
<p>（3）90次硬币正面向上，10次硬币反面向上，求101次正面向上的概率；</p> 
<p>（4）900次硬币正面向上，100次硬币反面向上，求第1001次硬币正面向上的概率。</p> 
<p><strong>解：</strong></p> 
<p>贝叶斯的后验分布受先验分布的影响，不同的先验分布会有不同的后验分布。<strong>请参考第一节</strong>，假设硬币正面向上的分布符合高斯分布（a=10，b=10），高斯分布符合大部分人的思想，认为硬币为正面向上的概率在0.5达到最大，方差表示先验分布的确定程度，若你坚信硬币向上的概率肯定是0.5，那么可以调大a和b值。</p> 
<p>作者就先验分布为高斯分布来解答抛硬币的四个问题。其他先验分布可通过调节a，b的值来实现，后面的计算过程一致。</p> 
<p>正面向上的后验概率：</p> 
<p><img alt="" class="has" height="58" src="https://images2.imgbox.com/2e/53/nUsz3ffX_o.png" width="294"></p> 
<p> </p> 
<p><strong>a，b，m，l分别表示先验分布的正面向上次数，反面向上次数，已观测数据的正面向上次数，反面向上次数。</strong></p> 
<p><strong>先验分布为高斯分布：</strong></p> 
<p><strong>（1）</strong>由于没有任何观测数据，因此第一次正面向上的分布为先验分布，先验分布在在参数为0.5时，概率最大，即正面向上的概率为0.5。</p> 
<p>（2）正面向上的概率为：</p> 
<p><img alt="" class="has" height="55" src="https://images2.imgbox.com/5d/65/IMYyPM6G_o.png" width="285"></p> 
<p> </p> 
<p>（3）计算过程与（2）一样，正面向上的概率：0.83</p> 
<p>（4）正面向上的概率：0.89</p> 
<p><strong>讨论：</strong></p> 
<p>频率学派认为硬币向上的概率是0.5，与观测数据无关。贝叶斯学派是通过数据来主观评价硬币向上的概率，由例子可知，即使先验分布符合高斯分布且正面向上的概率在0.5达到最大，但是如果观测数据倾向于正面向上，则最终的判断结果会倾向于正面向上，贝叶斯思想有点像是风往哪边吹树就往哪边倒的意思。<strong>当观测结果的正面向上次数远远大于正面向下次数，也远远大于先验分布的正面向下次数，则判断下次为正面向上的概率无限接近1</strong>（若不理解请参考公式）。</p> 
<p> </p> 
<p><strong>                                                                                       4、总结</strong></p> 
<hr> 
<p>本文首先详细介绍了β分布，通过调节参数a和b使β分布符合假设的先验分布，β分布使后验分布和先验分布为共轭分布，形成先验链，便于分析问题。后面讲的内容是贝叶斯思想，贝叶斯是主观评价事件发生的概率，根据先验知识来假设先验分布，若观测的数据符合先验分布，则后验分布与先验分布类似；若观测的数据不符合先验分布，则后验分布开始向观测数据倾斜，若观测数据为无穷大时，那么前验分布可以忽略不计，最大似然函数估计参数与后验分布估计参数相同，直接可以用最大似然函数来估计参数。</p> 
<p><strong>参考：</strong></p> 
<p><strong>Christopher M.Bishop &lt;&lt;Pattern Reconition and Machine Learning&gt;&gt;</strong></p> 
<p>                                                             <img alt="" class="has" height="208" src="https://images2.imgbox.com/48/7b/I9zFbJzI_o.png" width="297"></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cecf78fbe79c062a771ae109878ca32a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">浅谈先验分布和后验分布</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6e8f17623a2f08b886e5872cfb2dbc73/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">以太坊虚拟机EVM执行原理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>