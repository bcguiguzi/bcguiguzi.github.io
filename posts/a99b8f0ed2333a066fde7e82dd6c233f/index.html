<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java邮件发送附件_批量给指定收件人发送邮件和指定附件 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java邮件发送附件_批量给指定收件人发送邮件和指定附件" />
<meta property="og:description" content="之前有给大家分享过一篇关于批量将word转成pdf的文件，然后将pdf文件批量按照指定收件人进行邮件发送的文章。文章可以参照：
不同附件的邮件批量发给不同的指定人 批量发送带PDF附件的邮件 昨天一台湾的网友咨询了这个问题，同时他也给我分享了他在网上下载的另外一个版本，个人觉得很非常实用，这里给大家分享一下。文末会分享链接，大家可以下载保存，万一以后用得上呢。先来看看怎么用吧，因为中间确实有个设置需要说一下，不然只是拷贝代码的话，还是会出错。
首先打开Excel文件，其中有两个工作表，第一个是发送的清单，里面的内容很简单，如下：
工作表 - 发送清单
另外一个工作表就是邮件的标题和正文：
工作表 - 正文
写好相应的文本后，点击发送邮件按钮后，自动弹出邮箱客户端Outlook，界面是这个样子的：
Outlook发送邮件预览界面
回到Excel中，会返回一个对话框显示有多少封邮件要发送。(我这里只写了一个收件人，所以只显示了一封邮件)
Excel中弹出对话框
来看看Excel中的代码吧。(不懂没关系，主要明白你拿去之后需要改哪些地方就可以了，非常容易。)
Excel中的代码
代码很人性化，基本每一行都有注释。看看哪些地方值得关注以及后期如果拷贝代码后需要修改的。
代码中提到了这句：
代码中的设置
它这个其实是已经设置好了，如果你要拷贝代码进行使用的话，完成复制粘贴之后，运行之前需要进行一个设置，否则代码无法运行，会报错。设置如图所示：
点击工具下的引用：
工具 - 引用
调出引用-VBAProject对话框，如下：
引用对话框中的选项
一定要勾选这个：Microsoft Outlook 16.0 Object Library
这个根据你的outlook的版本来，之前那个朋友拷贝后无法运行，就是因为没有勾选此选项导致的。一定要看清楚，不要跟上面那个Microsoft Office 16.0 Object Library弄混了，各是各的。
接下来代码中：
代码中文字部分
这个发送清单，其实就是工作表的名称，对应就是Excel中的工作表这个：
对应工作表
再来就是这个“正文”：
代码中文字部分
对应的是Excel工作表中的这个：
对应工作表
如果你的工作表名称与代码中的不一致，需要进行更改。
其他的类似于Cells(1,2)，意思就是单元格第1行第2列。
我将后面的代码中进行了一下修改，因为如果不修改的话，邮件会直接发出去，而不是先预览一下。如果你的邮件相当多，最好先预览测试一下。没问题的话，再改回去就可以了。这个地方：
代码预览邮件
display就是预览的意思，如果你无需预览直接发送，改成下面这样就可以了：
代码 - 发送邮件
希望这个工具对大家有用，再次感谢来自宝岛台湾网友Kve的分享。
文中提到的链接如下：
链接：https://pan.baidu.com/s/173i3jpJGPy-rvqg3RydM4g 提取码：wasg
如果本文对你有帮助，请分享给有需要的朋友或你的朋友圈，让大家一起高效工作。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/a99b8f0ed2333a066fde7e82dd6c233f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-01T21:53:11+08:00" />
<meta property="article:modified_time" content="2020-12-01T21:53:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java邮件发送附件_批量给指定收件人发送邮件和指定附件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>之前有给大家分享过一篇关于批量将word转成pdf的文件，然后将pdf文件批量按照指定收件人进行邮件发送的文章。文章可以参照：</p> 
 <p>不同附件的邮件批量发给不同的指定人 </p> 
 <p>批量发送带PDF附件的邮件 </p> 
 <p> 昨天一台湾的网友咨询了这个问题，同时他也给我分享了他在网上下载的另外一个版本，个人觉得很非常实用，这里给大家分享一下。文末会分享链接，大家可以下载保存，万一以后用得上呢。先来看看怎么用吧，因为中间确实有个设置需要说一下，不然只是拷贝代码的话，还是会出错。</p> 
 <p> 首先打开Excel文件，其中有两个工作表，第一个是发送的清单，里面的内容很简单，如下：</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/2b/76/Do2FNnwS_o.png" alt="b4cdf8b496707c6379be24614aa45f31.png"> 
  <p class="pgc-img-caption">工作表 - 发送清单</p> 
 </div> 
 <p>另外一个工作表就是邮件的标题和正文：</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/07/16/5PpZSAXW_o.png" alt="6b5864f4941e1d21ea56659c7201555c.png"> 
  <p class="pgc-img-caption">工作表 - 正文</p> 
 </div> 
 <p>写好相应的文本后，点击发送邮件按钮后，自动弹出邮箱客户端Outlook，界面是这个样子的：</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/a7/57/svJg1ikI_o.png" alt="d1b26776c3753dc1ce3e6c8d0e0a9278.png"> 
  <p class="pgc-img-caption">Outlook发送邮件预览界面</p> 
 </div> 
 <p>回到Excel中，会返回一个对话框显示有多少封邮件要发送。(我这里只写了一个收件人，所以只显示了一封邮件)</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/29/18/u2Oki2ja_o.png" alt="d93517987609f29e95c788f416d2491c.png"> 
  <p class="pgc-img-caption">Excel中弹出对话框</p> 
 </div> 
 <p>来看看Excel中的代码吧。(不懂没关系，主要明白你拿去之后需要改哪些地方就可以了，非常容易。)</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/ac/8a/TF1XSlaq_o.png" alt="6973acff790eae2211d816395da1fdcc.png"> 
  <p class="pgc-img-caption">Excel中的代码</p> 
 </div> 
 <p>代码很人性化，基本每一行都有注释。看看哪些地方值得关注以及后期如果拷贝代码后需要修改的。</p> 
 <p> 代码中提到了这句：</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/04/42/veRP8rdX_o.png" alt="67b74ed12755b9406025061e124104f3.png"> 
  <p class="pgc-img-caption">代码中的设置</p> 
 </div> 
 <p>它这个其实是已经设置好了，如果你要拷贝代码进行使用的话，完成复制粘贴之后，运行之前需要进行一个设置，否则代码无法运行，会报错。设置如图所示：</p> 
 <p> 点击工具下的引用：</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/1a/2d/h2Z6KgA0_o.png" alt="617af0dc607313f77d9c36d5364619fd.png"> 
  <p class="pgc-img-caption">工具 - 引用</p> 
 </div> 
 <p>调出引用-VBAProject对话框，如下：</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/53/3a/N2QuJi69_o.png" alt="9a7658162e356e1b385abf66fd816d2a.png"> 
  <p class="pgc-img-caption">引用对话框中的选项</p> 
 </div> 
 <p>一定要勾选这个：Microsoft Outlook 16.0 Object Library</p> 
 <p> 这个根据你的outlook的版本来，之前那个朋友拷贝后无法运行，就是因为没有勾选此选项导致的。一定要看清楚，不要跟上面那个Microsoft Office 16.0 Object Library弄混了，各是各的。</p> 
 <p> 接下来代码中：</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/47/06/PZUErvss_o.png" alt="6c962a0bae4111ca5d8e22297c3ef6a7.png"> 
  <p class="pgc-img-caption">代码中文字部分</p> 
 </div> 
 <p>这个发送清单，其实就是工作表的名称，对应就是Excel中的工作表这个：</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/1e/f0/Swo4e2vO_o.png" alt="723b9864d59d45eadf609225bb1ab356.png"> 
  <p class="pgc-img-caption">对应工作表</p> 
 </div> 
 <p>再来就是这个“正文”：</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/ee/16/ANwxtH5O_o.png" alt="cbeae548865a3242f08f0c541d8b180f.png"> 
  <p class="pgc-img-caption">代码中文字部分</p> 
 </div> 
 <p>对应的是Excel工作表中的这个：</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/91/ff/GStqsYzk_o.png" alt="c14b5fc220e264a9ab8cc6d6e9dd7caa.png"> 
  <p class="pgc-img-caption">对应工作表</p> 
 </div> 
 <p>如果你的工作表名称与代码中的不一致，需要进行更改。</p> 
 <p>其他的类似于Cells(1,2)，意思就是单元格第1行第2列。</p> 
 <p> 我将后面的代码中进行了一下修改，因为如果不修改的话，邮件会直接发出去，而不是先预览一下。如果你的邮件相当多，最好先预览测试一下。没问题的话，再改回去就可以了。这个地方：</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/ae/77/8qc8lP4s_o.png" alt="e331233ca0025638380bfaa5019a53aa.png"> 
  <p class="pgc-img-caption">代码预览邮件</p> 
 </div> 
 <p>display就是预览的意思，如果你无需预览直接发送，改成下面这样就可以了：</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/3f/bc/RD3AehPI_o.png" alt="edbaf1337f23eb6c1522b283bca1fb03.png"> 
  <p class="pgc-img-caption">代码 - 发送邮件</p> 
 </div> 
 <p>希望这个工具对大家有用，再次感谢来自宝岛台湾网友Kve的分享。</p> 
 <p>文中提到的链接如下：</p> 
 <p>链接：https://pan.baidu.com/s/173i3jpJGPy-rvqg3RydM4g <br>提取码：wasg</p> 
 <hr> 
 <p>如果本文对你有帮助，请分享给有需要的朋友或你的朋友圈，让大家一起高效工作。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4f799058b470cdfbf74b83337fe51efc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">kotlin使用AOP要注意的点</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e6942eb3c90a9d2bf9cf14af4f616551/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java决策树算法_机器学习算法小公司社招面试5则</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>