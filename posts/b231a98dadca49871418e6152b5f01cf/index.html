<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>sklearn.model_selection.learning_curve的详细介绍（包含ShuffleSplit()介绍） - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="sklearn.model_selection.learning_curve的详细介绍（包含ShuffleSplit()介绍）" />
<meta property="og:description" content="提示：sklearn.model_selection.learning_curve的详细介绍
文章目录 1、需求分析2、learning_curve主要输出参数3、learning_curve主要参数4、learning_curve作用5、learning_curve代码6、ShuffleSplit（） 1、需求分析 通过参数train_size选取不同规模的数据集，再分别在不同规模的数据集上做交叉验证，通过参数cv选取交叉验证的类型；
例如：我们想选取含有1000个样本的数据集的10%，33%，55%，78%，100%的数据做实验，探究不同数据量下模型的预测准确度，选取不同规模的数据集后，我们又想分别在不同规模的数据集下做一下5折交叉验证。我们就可以设train_size=array([0.1, 0.33, 0.55, 0.78, 1.]), cv=5。
2、learning_curve主要输出参数 train_sizes_abs：返回生成的训练的样本数，如[ 80 , 260 , 620，800 ]，80=0.1×1000×[(5-1)/5]即train_sizes_abs[i]=train_size[i]×样本数×（cv对应每一次交叉验证的训练样本占总样本的百分比）
train_scores:返回训练集分数，该矩阵为（ len ( train_sizes_abs ) , cv分割数 ）即（5，5）维的分数，每行数据代表该样本数对应不同折的分数。
test_scores:同train_scores,只不过是这个对应的是测试集分数
3、learning_curve主要参数 X：特征矩阵，包含输入样本的特征。
y：目标变量，包含与输入样本对应的真实标签。
train_sizes：一个数组或可迭代对象，表示训练集的不同大小的比例。每个比例都将生成一个学习曲线点。
cv：用于交叉验证的折数或交叉验证迭代器。
scoring：用于评估模型性能的指标。常见的指标包括准确率（accuracy）、均方误差（mean_squared_error）、R平方（r2_score）等。
shuffle：是否在每次迭代前对数据进行洗牌，默认为False。
random_state：随机数种子，用于控制随机性。
estimator：用于拟合数据的机器学习模型，例如分类器或回归器。
4、learning_curve作用 引用出处
5、learning_curve代码 代码如下（示例）：
from sklearn.metrics import confusion_matrix as CM import numpy as np import matplotlib.pyplot as plt from sklearn.naive_bayes import GaussianNB from sklearn.svm import SVC from sklearn.ensemble import RandomForestClassifier as RFC from sklearn." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/b231a98dadca49871418e6152b5f01cf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-15T20:19:38+08:00" />
<meta property="article:modified_time" content="2024-03-15T20:19:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">sklearn.model_selection.learning_curve的详细介绍（包含ShuffleSplit()介绍）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>提示：sklearn.model_selection.learning_curve的详细介绍</p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1_8" rel="nofollow">1、需求分析</a></li><li><a href="#2learning_curve_12" rel="nofollow">2、learning_curve主要输出参数</a></li><li><a href="#3learning_curve_16" rel="nofollow">3、learning_curve主要参数</a></li><li><a href="#4learning_curve_26" rel="nofollow">4、learning_curve作用</a></li><li><a href="#5learning_curve_31" rel="nofollow">5、learning_curve代码</a></li><li><a href="#6ShuffleSplit_140" rel="nofollow">6、ShuffleSplit（）</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="1_8"></a>1、需求分析</h2> 
<p>通过参数train_size选取不同规模的数据集，再分别在不同规模的数据集上做交叉验证，通过参数cv选取交叉验证的类型；</p> 
<p>例如：我们想选取含有1000个样本的数据集的10%，33%，55%，78%，100%的数据做实验，探究不同数据量下模型的预测准确度，选取不同规模的数据集后，我们又想分别在不同规模的数据集下做一下5折交叉验证。我们就可以设train_size=array([0.1, 0.33, 0.55, 0.78, 1.]), cv=5。</p> 
<h2><a id="2learning_curve_12"></a>2、learning_curve主要输出参数</h2> 
<p>train_sizes_abs：返回生成的训练的样本数，如[ 80 , 260 , 620，800 ]，80=0.1×1000×[(5-1)/5]即train_sizes_abs[i]=train_size[i]×样本数×（cv对应每一次交叉验证的训练样本占总样本的百分比）<br> train_scores:返回训练集分数，该矩阵为（ len ( train_sizes_abs ) , cv分割数 ）即（5，5）维的分数，每行数据代表该样本数对应不同折的分数。<br> test_scores:同train_scores,只不过是这个对应的是测试集分数</p> 
<h2><a id="3learning_curve_16"></a>3、learning_curve主要参数</h2> 
<p>X：特征矩阵，包含输入样本的特征。<br> y：目标变量，包含与输入样本对应的真实标签。<br> train_sizes：一个数组或可迭代对象，表示训练集的不同大小的比例。每个比例都将生成一个学习曲线点。<br> cv：用于交叉验证的折数或交叉验证迭代器。<br> scoring：用于评估模型性能的指标。常见的指标包括准确率（accuracy）、均方误差（mean_squared_error）、R平方（r2_score）等。<br> shuffle：是否在每次迭代前对数据进行洗牌，默认为False。<br> random_state：随机数种子，用于控制随机性。<br> estimator：用于拟合数据的机器学习模型，例如分类器或回归器。</p> 
<h2><a id="4learning_curve_26"></a>4、learning_curve作用</h2> 
<p><img src="https://images2.imgbox.com/b6/32/5BB7PAlb_o.png" alt="在这里插入图片描述"><br> <a href="https://blog.csdn.net/weixin_48302334/article/details/131520180">引用出处</a></p> 
<h2><a id="5learning_curve_31"></a>5、learning_curve代码</h2> 
<p>代码如下（示例）：</p> 
<pre><code class="prism language-c">from sklearn<span class="token punctuation">.</span>metrics import confusion_matrix as CM
import numpy as np
import matplotlib<span class="token punctuation">.</span>pyplot as plt
from sklearn<span class="token punctuation">.</span>naive_bayes import GaussianNB
from sklearn<span class="token punctuation">.</span>svm import SVC
from sklearn<span class="token punctuation">.</span>ensemble import RandomForestClassifier as RFC
from sklearn<span class="token punctuation">.</span>tree import DecisionTreeClassifier as DTC
from sklearn<span class="token punctuation">.</span>linear_model import LogisticRegression as LR
from sklearn<span class="token punctuation">.</span>datasets import load_digits
from sklearn<span class="token punctuation">.</span>model_selection import learning_curve  # 画学习曲线的类
from sklearn<span class="token punctuation">.</span>model_selection import ShuffleSplit  # 设定交叉验证模式的类
from time import time
import datetime
from sklearn<span class="token punctuation">.</span>metrics import brier_score_loss as bsl
from sklearn<span class="token punctuation">.</span>svm import SVC
from sklearn<span class="token punctuation">.</span>linear_model import LogisticRegression as LR
from sklearn<span class="token punctuation">.</span>model_selection import train_test_split


def <span class="token function">plot_learning_curve</span><span class="token punctuation">(</span>estimator<span class="token punctuation">,</span> title<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span>
                        ax<span class="token punctuation">,</span>  # 选择子图
                        ylim<span class="token operator">=</span>None<span class="token punctuation">,</span>  # 设置纵坐标的取值范围
                        cv<span class="token operator">=</span>None<span class="token punctuation">,</span>  # 交叉验证
                        n_jobs<span class="token operator">=</span>None  # 设定索要使用的线程
                        <span class="token punctuation">)</span><span class="token operator">:</span>
    train_sizes<span class="token punctuation">,</span> train_scores<span class="token punctuation">,</span> test_scores <span class="token operator">=</span> <span class="token function">learning_curve</span><span class="token punctuation">(</span>estimator<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y
                                                            <span class="token punctuation">,</span> cv<span class="token operator">=</span>cv<span class="token punctuation">,</span> n_jobs<span class="token operator">=</span>n_jobs<span class="token punctuation">)</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">learning</span><span class="token expression"><span class="token function">_curve</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 是一个可视化工具，用于评估机器学习模型的性能和训练集大小之间的关系。它可以帮助我们理解模型在不同数据规模下的训练表现，</span></span>
    # 进而判断模型是否出现了欠拟合或过拟合的情况。该函数会生成一条曲线，横轴表示不同大小的训练集，纵轴表示训练集和交叉验证集上的评估指标（例如
    # 准确率、损失等）。通过观察曲线，我们可以得出以下结论：
    # <span class="token number">1</span>，训练集误差和交叉验证集误差之间的关系：当训练集规模较小时，模型可能过度拟合，训练集误差较低，交叉验证集误差较高；当训练集规模逐渐增大时，
    #    模型可能更好地泛化，两者的误差逐渐趋于稳定。
    # <span class="token number">2</span>，训练集误差和交叉验证集误差对训练集规模的响应：通过观察曲线的斜率，我们可以判断模型是否存在高方差（过拟合）或高偏差（欠拟合）的问题。如果
    #    训练集和交叉验证集的误差都很高，且二者之间的间隔较大，说明模型存在高偏差；如果训练集误差很低而交叉验证集误差较高，且二者的间隔也较大，说
    #    明模型存在高方差。
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">cv</span> <span class="token expression"><span class="token operator">:</span> <span class="token keyword">int</span>：交叉验证生成器或可迭代的可选项，确定交叉验证拆分策略。v的可能输入是：</span></span>
    #            <span class="token operator">-</span> 无，使用默认的<span class="token number">3</span>倍交叉验证，
    #            <span class="token operator">-</span> 整数，指定折叠数。
    #            <span class="token operator">-</span> 要用作交叉验证生成器的对象。
    #            <span class="token operator">-</span> 可迭代的yielding训练<span class="token operator">/</span>测试分裂。
    <span class="token macro property"><span class="token directive-hash">#</span>      <span class="token expression">ShuffleSplit：我们这里设置cv，交叉验证使用ShuffleSplit方法，一共取得<span class="token number">100</span>组训练集与测试集，</span></span>
    #      每次的测试集为<span class="token number">20</span><span class="token operator">%</span>，它返回的是每组训练集与测试集的下标索引，由此可以知道哪些是train，那些是test。
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">n</span><span class="token expression">_jobs <span class="token operator">:</span> 整数，可选并行运行的作业数（默认值为<span class="token number">1</span>）。windows开多线程需要</span></span>
    ax<span class="token punctuation">.</span><span class="token function">set_title</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>
    <span class="token keyword">if</span> ylim is not None<span class="token operator">:</span>
        ax<span class="token punctuation">.</span><span class="token function">set_ylim</span><span class="token punctuation">(</span><span class="token operator">*</span>ylim<span class="token punctuation">)</span>
    # <span class="token operator">*</span>是可以接受任意数量的参数
    # 而 <span class="token operator">*</span><span class="token operator">*</span> 可以接受任意数量的指定键值的参数
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">def</span> <span class="token expression"><span class="token function">m</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">*</span><span class="token operator">*</span>kwargs<span class="token punctuation">)</span><span class="token operator">:</span></span></span>
    <span class="token macro property"><span class="token directive-hash">#</span> 	<span class="token directive keyword">print</span><span class="token expression"><span class="token punctuation">(</span>args<span class="token punctuation">)</span></span></span>
    <span class="token macro property"><span class="token directive-hash">#</span>     <span class="token directive keyword">print</span><span class="token expression"><span class="token punctuation">(</span>kwargs<span class="token punctuation">)</span></span></span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">m</span><span class="token expression"><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>a<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>b<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></span></span>
    # #args<span class="token operator">:</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>kwargs<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token char">'b'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token char">'a'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span>
    ax<span class="token punctuation">.</span><span class="token function">set_xlabel</span><span class="token punctuation">(</span><span class="token string">"Training examples"</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span><span class="token function">set_ylabel</span><span class="token punctuation">(</span><span class="token string">"Score"</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span><span class="token function">grid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  # 显示网格作为背景，不是必须
    ax<span class="token punctuation">.</span><span class="token function">plot</span><span class="token punctuation">(</span>train_sizes<span class="token punctuation">,</span> np<span class="token punctuation">.</span><span class="token function">mean</span><span class="token punctuation">(</span>train_scores<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token char">'o-'</span>
            <span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"r"</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"Training score"</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span><span class="token function">plot</span><span class="token punctuation">(</span>train_sizes<span class="token punctuation">,</span> np<span class="token punctuation">.</span><span class="token function">mean</span><span class="token punctuation">(</span>test_scores<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token char">'o-'</span>
            <span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"g"</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"Test score"</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span><span class="token function">legend</span><span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"best"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> ax


digits <span class="token operator">=</span> <span class="token function">load_digits</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> digits<span class="token punctuation">.</span>data<span class="token punctuation">,</span> digits<span class="token punctuation">.</span>target
<span class="token function">print</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
title <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Naive Bayes"</span><span class="token punctuation">,</span> <span class="token string">"DecisionTree"</span><span class="token punctuation">,</span> <span class="token string">"SVM, RBF kernel"</span><span class="token punctuation">,</span> <span class="token string">"RandomForest"</span><span class="token punctuation">,</span> <span class="token string">"Logistic"</span><span class="token punctuation">]</span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">model</span> <span class="token expression"><span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">GaussianNB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">DTC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SVC</span><span class="token punctuation">(</span>gamma<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span></span></span>
#     <span class="token punctuation">,</span> <span class="token function">RFC</span><span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">LR</span><span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> solver<span class="token operator">=</span><span class="token string">"lbfgs"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
model <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">GaussianNB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">DTC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SVC</span><span class="token punctuation">(</span>gamma<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span>
    <span class="token punctuation">,</span> <span class="token function">RFC</span><span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">LR</span><span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> solver<span class="token operator">=</span><span class="token string">"liblinear"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
cv <span class="token operator">=</span> <span class="token function">ShuffleSplit</span><span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">n</span><span class="token expression">_splits<span class="token operator">:</span></span></span>
# 划分数据集的份数，类似于KFlod的折数，默认为<span class="token number">10</span>份
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">test</span><span class="token expression">_size：</span></span>
# 测试集所占总样本的比例，如test_size<span class="token operator">=</span><span class="token number">0.2</span>即将划分后的数据集中<span class="token number">20</span><span class="token operator">%</span>作为测试集
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">random</span><span class="token expression">_state：</span></span>
# 随机数种子，使每次划分的数据集不变
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">train</span><span class="token expression">_sizes<span class="token operator">:</span> 随着训练集的增大，选择在<span class="token number">10</span><span class="token operator">%</span>，<span class="token number">25</span><span class="token operator">%</span>，<span class="token number">50</span><span class="token operator">%</span>，<span class="token number">75</span><span class="token operator">%</span>，<span class="token number">100</span><span class="token operator">%</span>的训练集大小上进行采样。</span></span>
#              比如（CV<span class="token operator">=</span> <span class="token number">5</span>）<span class="token number">10</span><span class="token operator">%</span>的意思是先在训练集上选取<span class="token number">10</span><span class="token operator">%</span>的数据进行五折交叉验证。
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">train</span><span class="token expression">_sizes：数组类，形状（n_ticks），dtype <span class="token keyword">float</span>或<span class="token keyword">int</span></span></span>
# 训练示例的相对或绝对数量，将用于生成学习曲线。如果dtype为<span class="token keyword">float</span>，则视为训练集最大尺寸的一部分
# （由所选的验证方法确定），即，它必须在（<span class="token number">0</span>，<span class="token number">1</span><span class="token punctuation">]</span>之内，否则将被解释为绝对大小注意，为了进行分类，
# 样本的数量通常必须足够大，以包含每个类中的至少一个样本（默认值：np<span class="token punctuation">.</span>linspace（<span class="token number">0.1</span>，<span class="token number">1.0</span>，<span class="token number">5</span>））
# 输出：
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">train</span><span class="token expression">_sizes_abs：</span></span>
# 返回生成的训练的样本数，如<span class="token punctuation">[</span> <span class="token number">10</span> <span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token punctuation">]</span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">train</span><span class="token expression">_scores<span class="token operator">:</span></span></span>
# 返回训练集分数，该矩阵为（ <span class="token function">len</span> <span class="token punctuation">(</span> train_sizes_abs <span class="token punctuation">)</span> <span class="token punctuation">,</span> cv分割数 ）维的分数，
# 每行数据代表该样本数对应不同折的分数
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">test</span><span class="token expression">_scores<span class="token operator">:</span></span></span>
# 同train_scores<span class="token punctuation">,</span>只不过是这个对应的是测试集分数

fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span><span class="token function">subplots</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> ind<span class="token punctuation">,</span> title_<span class="token punctuation">,</span> estimator in <span class="token function">zip</span><span class="token punctuation">(</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> title<span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token operator">:</span>
    times <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">plot_learning_curve</span><span class="token punctuation">(</span>estimator<span class="token punctuation">,</span> title_<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span>
                        ax<span class="token operator">=</span>axes<span class="token punctuation">[</span>ind<span class="token punctuation">]</span><span class="token punctuation">,</span> ylim<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">1.05</span><span class="token punctuation">]</span><span class="token punctuation">,</span> n_jobs<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> cv<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{}:{}"</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>title_<span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span><span class="token function">fromtimestamp</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> times<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">strftime</span><span class="token punctuation">(</span><span class="token string">"%M:%S:%f"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="6ShuffleSplit_140"></a>6、ShuffleSplit（）</h2> 
<p>ShuffleSplit（） 随机排列交叉验证，生成一个用户给定数量的独立的训练/测试数据划分。样例首先被打散然后划分为一对训练测试集合。</p> 
<ul><li>n_splits:划分训练集、测试集的次数，默认为10</li><li>test_size: 测试集比例或样本数量</li><li>random_state:随机种子值，默认为None，可以通过设定明确的random_state，使得伪随机生成器的结果可以重复</li></ul> 
<pre><code class="prism language-c">from sklearn<span class="token punctuation">.</span>model_selection import ShuffleSplit
import numpy as np

X <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">arange</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"所有数据："</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span>
ss <span class="token operator">=</span> <span class="token function">ShuffleSplit</span><span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">)</span>
n_fold <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">for</span> train_indices<span class="token punctuation">,</span> test_indices in ss<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'...............................'</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"train_indices"</span><span class="token punctuation">,</span> train_indices<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"test_indices:"</span><span class="token punctuation">,</span> test_indices<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3e/49/UXMOZSRP_o.png" alt="在这里插入图片描述"><br> <a href="https://zhuanlan.zhihu.com/p/109137058" rel="nofollow">引用文献</a></p> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/54a9163c2da84c0618e4381c38b13d74/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数据结构（二）顺序表和链表</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8a36b1becd7a3da39b7f8f4d3ecd114c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">每日OJ题_简单多问题dp④_力扣LCR 091. 粉刷房子</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>