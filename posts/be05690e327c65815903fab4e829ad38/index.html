<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Lucene查询语法，适用于 ELk Kibana 查询 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Lucene查询语法，适用于 ELk Kibana 查询" />
<meta property="og:description" content="Lucene查询语法，适用于 ELk Kibana 查询 Elasticsearch 构建在 Lucene 之上，过滤器语法和 Lucene 相同。本语法可用于 Kibana 界面的检索和 Grafana 看板对接 ES 的检索规则。
Kibana 上的检索语法Grafana 上的检索语法 全文搜索 在搜索栏输入login，会返回所有字段值中包含 login 的文档
使用双引号包起来作为一个短语搜索 &#34;like Gecko&#34;
字段搜索 可以按页面左侧显示的字段搜索限定字段全文搜索：field:value精确搜索：关键字加上双引号 filed:&#34;value&#34;精确过滤不存在的：字段前加上减号，关键字加上双引号 -filed:&#34;value&#34;http.code:404 搜索 http 状态码为 404 的文档-traceId:null tranceId字段不为null字段本身是否存在
_exists_:http：返回结果中需要有 http 字段
_missing_:http：不能含有 http 字段判断某个字段不为空字符串
-corp.keyword:&#34;&#34; 通配符搜索 Lucene 支持单个术语内的单个和多个字符通配符搜索（不在短语查询中）。
? 匹配单个字符* 匹配0到多个字符kiba?a, el*search 注意：您不能使用_或？符号作为搜索的第一个字符。例如：?text _text
正则表达式搜索 Lucene 支持正向表达式搜索，性能较差
name:/joh?n(ath[oa]n)/ 模糊搜索 quikc~ brwn~ foks~~:在一个单词后面加上~启用模糊搜索，可以搜到一些拼写错误的单词first~ 这种也能匹配到 frist 还可以设置编辑距离（整数），指定需要多少相似度
cromm~1 会匹配到 from 和 chrome默认2，越大越接近搜索的原始值，设置为1基本能搜到80%拼写错误的单词 近似搜索 在短语后面加上~，可以搜到被隔开或顺序不同的单词，注意短语要使用双引号&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/be05690e327c65815903fab4e829ad38/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-14T10:20:51+08:00" />
<meta property="article:modified_time" content="2024-03-14T10:20:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Lucene查询语法，适用于 ELk Kibana 查询</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Lucene_ELk_Kibana__1"></a>Lucene查询语法，适用于 ELk Kibana 查询</h2> 
<p>Elasticsearch 构建在 Lucene 之上，过滤器语法和 Lucene 相同。本语法可用于 Kibana 界面的检索和 Grafana 看板对接 ES 的检索规则。</p> 
<ul><li>Kibana 上的检索语法</li><li>Grafana 上的检索语法</li></ul> 
<h3><a id="_6"></a>全文搜索</h3> 
<p>在搜索栏输入login，会返回所有字段值中包含 login 的文档</p> 
<p>使用双引号包起来作为一个短语搜索 <code>"like Gecko"</code></p> 
<h3><a id="_12"></a>字段搜索</h3> 
<ul><li>可以按页面左侧显示的字段搜索</li><li>限定字段全文搜索：<code>field:value</code></li><li>精确搜索：关键字加上双引号 <code>filed:"value"</code></li><li>精确过滤不存在的：字段前加上减号，关键字加上双引号 <code>-filed:"value"</code></li><li><code>http.code:404</code> 搜索 http 状态码为 404 的文档</li><li><code>-traceId:null</code> tranceId字段不为null</li><li>字段本身是否存在<br> <code>_exists_:http</code>：返回结果中需要有 http 字段<br> <code>_missing_:http</code>：不能含有 http 字段</li><li>判断某个字段不为空字符串<br> <code>-corp.keyword:""</code></li></ul> 
<h3><a id="_26"></a>通配符搜索</h3> 
<p>Lucene 支持单个术语内的单个和多个字符通配符搜索（不在短语查询中）。</p> 
<pre><code>? 匹配单个字符* 匹配0到多个字符kiba?a, el*search
</code></pre> 
<p>注意：您不能使用_或？符号作为搜索的第一个字符。例如：<code>?text</code> <code>_text</code></p> 
<h3><a id="_36"></a>正则表达式搜索</h3> 
<p>Lucene 支持正向表达式搜索，性能较差</p> 
<pre><code>name:/joh?n(ath[oa]n)/
</code></pre> 
<h3><a id="_44"></a>模糊搜索</h3> 
<pre><code>quikc~ brwn~ foks~~:在一个单词后面加上~启用模糊搜索，可以搜到一些拼写错误的单词first~ 这种也能匹配到 frist
</code></pre> 
<p>还可以设置编辑距离（整数），指定需要多少相似度</p> 
<pre><code>cromm~1 会匹配到 from 和 chrome默认2，越大越接近搜索的原始值，设置为1基本能搜到80%拼写错误的单词
</code></pre> 
<h3><a id="_56"></a>近似搜索</h3> 
<p>在短语后面加上<code>~</code>，可以搜到被隔开或顺序不同的单词，注意短语要使用双引号<code>""</code>包围</p> 
<pre><code>"where select"~5 表示 select 和 where 中间可以隔着5个单词，可以搜到 select password from users where id=1
</code></pre> 
<h3><a id="_64"></a>范围搜索</h3> 
<p>数值/时间/IP/字符串 类型的字段可以对某一范围进行查询</p> 
<pre><code>length:[100 TO 200]
sip:["172.24.20.110" TO "172.24.20.140"]
date:{"now-6h" TO "now"}
tag:{b TO e} 搜索b到e中间的字符
count:[10 TO *] * 表示一端不限制范围
count:[1 TO 5} [ ] 表示端点数值包含在范围内，{ } 表示端点数值不包含在范围内，可以混合使用，此语句为1到5，包括1，不包括5可以简化成以下写法：
age:&gt;10
age:&lt;=10
age:(&gt;=10 AND &lt;20)
# in 查询
siteId:("mmr-public-beijing4-1"|"mmr-public-beijing4-2"|"mmr-public-beijing4-3"|"mmr-public-beijing4-4"|"mmr-public-beijing4-5")

grade:{60,80] # 搜索成绩grade字段小于等于80分，大于60分的
</code></pre> 
<h3><a id="_84"></a>优先级</h3> 
<p>使用^使一个词语比另一个搜索优先级更高，默认为1，可以为0~1之间的浮点数，来降低优先级</p> 
<pre><code>quick^2 fox
</code></pre> 
<h3><a id="_92"></a>布尔运算符搜索</h3> 
<p>布尔运算符允许通过逻辑运算符组合术语。Lucene支持AND，“+”，OR，NOT和“ - ”作为布尔运算符（注意：布尔运算符必须是ALL CAPS）。</p> 
<p>OR</p> 
<pre><code>"jakarta apache" jakartaor"jakarta apache" OR jakarta
</code></pre> 
<p>AND</p> 
<pre><code>"jakarta apache" AND "Apache Lucene"
</code></pre> 
<p>+:搜索结果中必须包含此项</p> 
<pre><code>+jakarta lucene
</code></pre> 
<p>NOT</p> 
<pre><code>"jakarta apache" NOT "Apache Lucene"NOT "jakarta apache"
</code></pre> 
<p>-：不能含有此项</p> 
<pre><code>"jakarta apache" -"Apache Lucene"
</code></pre> 
<h3><a id="_126"></a>分组搜索</h3> 
<p>Lucene支持使用括号将子句分组以形成子查询。如果要控制查询的布尔逻辑，这可能非常有用。</p> 
<pre><code>(jakarta OR apache) AND jakarta
</code></pre> 
<h3><a id="_134"></a>字段分组搜索</h3> 
<p>Lucene支持使用括号将多个子句分组到单个字段。</p> 
<pre><code>title:(+return +"pink panther")host:(baidu OR qq OR google) AND host:(com OR cn)
</code></pre> 
<h3><a id="_142"></a>转义特殊字符搜索</h3> 
<p>Lucene支持转义属于查询语法的特殊字符。</p> 
<pre><code>+ - = &amp;&amp; || &gt; &lt; ! ( ) { } [ ] ^ " ~ * ? : \ /以上字符当作值搜索的时候需要用\转义\(1\+1\)\=2用来查询(1+1)=2
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cb8d10b304086e904325d97a7b73826f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">odoo中_name_search用法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/253f93967175a7722052bc000e8f26e2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Solidity Uniswap V2 Router contract addLiquidity</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>