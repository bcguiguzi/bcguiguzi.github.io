<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>什么是数据库索引？ - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="什么是数据库索引？" />
<meta property="og:description" content="索引的作用 数据库的索引：为了使得查询数据的效率变快。
数据库索引有哪些 （1）聚集索引（主键索引）:在数据库里面，所有的行数都会按照主键索引进行排序。
（2）非聚集索引：给普通的字段加上索引。
（3）联合索引（多属性索引）：给好几个字段加上索引。
联合索引的时候怎么走？
key &#39;idx_age_name_sex&#39; (&#39;age&#39;,&#39;name&#39;,&#39;sex&#39;) A:select * from student where age = 16 and name = &#39;小张&#39;
B:select * from student where name = &#39;小张&#39; and sex = &#39;男&#39;
C:select * from student where name = &#39;小张&#39; and sex = &#39;男&#39; and age = 18
D:select * from student where age &gt; 20 and name = &#39;小张&#39;
E:select * from student where age != 15 and name = &#39;小张&#39;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/521171726be491145a3086fb59410100/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-02T17:41:31+08:00" />
<meta property="article:modified_time" content="2022-06-02T17:41:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">什么是数据库索引？</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>索引的作用</h2> 
<p>数据库的索引：为了使得查询数据的效率变快。</p> 
<h2>数据库索引有哪些</h2> 
<p>（1）聚集索引（主键索引）:在数据库里面，所有的行数都会按照主键索引进行排序。</p> 
<p>（2）非聚集索引：给普通的字段加上索引。</p> 
<p>（3）联合索引（多属性索引）：给好几个字段加上索引。</p> 
<p>联合索引的时候怎么走？</p> 
<pre><code>key 'idx_age_name_sex' ('age','name','sex')</code></pre> 
<p><code>A:select * from student where age = </code><code>16</code> <code>and name = </code><code>'小张'</code></p> 
<p><code>B:select * from student where name = </code><code>'小张'</code> <code>and sex = </code><code>'男'</code></p> 
<p><code>C:select * from student where name = </code><code>'小张'</code> <code>and sex = </code><code>'男'</code> <code>and age = </code><code>18</code></p> 
<p><code>D:select * from student where age &gt; </code><code>20</code> <code>and name = </code><code>'小张'</code></p> 
<p><code>E:select * from student where age != </code><code>15</code> <code>and name = </code><code>'小张'</code></p> 
<p><code>F:select * from student where age = </code><code>15</code> <code>and name != </code><code>'小张'</code></p> 
<p><code>（1）对于A，遵循最左匹配，age在最左边，所以A走索引。</code></p> 
<p><code>（2）对于B，直接从name开始，不遵循最左匹配的原则，所以不走索引使得。</code></p> 
<p><code>（3）对于C，虽然是从name开始，但是又索引最左边的age，内部会转成 </code></p> 
<p>where age = '18' and name = '小张'  and sex = '男' </p> 
<p><font face="monospace">这种格式的，所以还是走索引，遵循最左匹配的原则。</font></p> 
<p><font face="monospace">（4）对于D，因为age&gt;20是范围，范围字段会结束索引对范围后面索引字段的使用，所以只走了age这个索引。</font></p> 
<p><font face="monospace">（5）对于E，虽然遵循最左匹配但是是！=，不走索引。！=不走索引。</font></p> 
<p><font face="monospace">（6）对于F，只走age索引，不走name索引，原因和（5）一样，！=不走索引。</font></p> 
<h2><strong><font face="monospace">什么样的情况不走索引</font></strong></h2> 
<p><font face="monospace">如果在表student中两个字段age，name加了索引</font></p> 
<pre><code>key 'idx_age' ('age'),
key 'idx_name' ('name')</code></pre> 
<p>1.Like这种就是%在前面的不走索引，在后面的走索引。</p> 
<pre><code>A:select * from student where 'name' like '王%'
B:select * from student where 'name' like '%小'</code></pre> 
<p>A走索引，B不走索引。</p> 
<p>2.用索引列进行计算的，不走索引。</p> 
<pre><code>A:select * from student where age = 10+8
B:select * from student where age + 8 = 18</code></pre> 
<p>A走索引，B不走索引。</p> 
<p>3.对索引列用函数的时候，不走索引。</p> 
<pre><code>A:select * from student where  concat('name','哈') ='王哈哈';
B:select * from student where name = concat('王哈','哈');</code></pre> 
<p>A不走索引，B走索引</p> 
<p>4.索引列用了！=的时候，不走索引：</p> 
<pre><code>select * from student where age != 18</code></pre> 
<h2>索引在磁盘上是怎么存储的？</h2> 
<p>聚类索引和非据类索引的存储是不同的。</p> 
<p>有一张学生表：</p> 
<pre><code>create table `student` (
`id` int(11) not null auto_increment comment '主键id',
`name` varchar(50) not null default '' comment '学生姓名',
`age` int(11) not null default 0 comment '学生年龄',
primary key (`id`),
key `idx_age` (`age`),
key `idx_name` (`name`)
) ENGINE=InnoDB default charset=utf8 comment ='学生信息';

</code></pre> 
<p>表中的内容如下：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/d0/b7/bTvEaxDz_o.png"></p> 
<p> id 为主键索引，name和age为非聚集索引。</p> 
<p>1.聚类索引在磁盘中的存储</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/49/47/HWH335JZ_o.png"></p> 
<p>聚类索引叶子节点存储的是表里面所有的行数据，每个数据页在不同的磁盘上。如果要查找id=5的数据，需要先把磁盘0读入内存，然后用二分法查找id=5的树在3和6之间，然后通过指针p1查找到磁盘2的地址，然后将磁盘2读入内存中，用二分查找方式查找到id=5的数据。 </p> 
<p>2.非聚集索引在磁盘中的存储</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/49/f9/5uizvrKx_o.png"></p> 
<p>叶子结点存储的是据集索引键，而不存储表里面所有的行数据，所以在查找的时候，只能找到聚集索引键，再通过据集索引去表里面查找到数据。</p> 
<p>如果要查找到name=小徐，首先将磁盘0加载到内存中，然后用二分查找的方法查找到在指针p1所指的地址上，然后通过指针p1所指的地址可以知道在磁盘2上面，然后通过二分查找法得知小徐的id=4。</p> 
<p>然后再继续根据id=4，将磁盘0加载到内存中，然后通过二分查找发查找到在指针p1所指的地址上，然后通过指针p1所指的地址可以知道在磁盘2上面，通过id=4查找到所在行数据，就能查找到name=小徐的数据了。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f45ab82f31c0cacd2a88773dd612d1f4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">git使用：将本地写好的代码上传到远程仓库的develop分支中的一个指定的文件夹中</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/247fcbb98cb11287761ac437bb948584/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CMake指令解析 set(CMAKE_CXX_FLAGS “$ENV{CXXFLAGS} -rdynamic -O3 -fPIC -ggdb -std=c&#43;&#43;11 -Wall -Wno-deprec</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>