<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Hadoop大数据应用：Yarn 节点实现扩容与缩容 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Hadoop大数据应用：Yarn 节点实现扩容与缩容" />
<meta property="og:description" content="目录
一、实验
1.环境
2.Yarn 节点扩容
3.Yarn 节点缩容
二、问题
1.yarn启动服务报错
一、实验 1.环境 （1）主机
表1 主机
主机架构软件版本IP备注hadoop NameNode （已部署）
SecondaryNameNode （已部署）
ResourceManager（已部署）
hadoop
2.7.7192.168.204.50 node01 DataNode（已部署）
NodeManager（已部署）
hadoop
2.7.7192.168.204.51node02 DataNode（已部署）
NodeManager（已部署）
hadoop
2.7.7192.168.204.52node03 DataNode（已部署）
NodeManager（已部署）
hadoop
2.7.7192.168.204.53node05NodeManager hadoop
2.7.7192.168.204.55 （2）查看jps
hadoop节点
[root@hadoop hadoop]# jps node01节点
node02节点
node03节点
（3） 查看节点
[root@hadoop hadoop]# ./bin/yarn node -list 24/03/14 13:40:21 INFO client.RMProxy: Connecting to ResourceManager at hadoop/192.168.204.50:8032 Total Nodes:3 Node-Id Node-State Node-Http-Address Number-of-Running-Containers node01:40551 RUNNING node01:8042 0 node02:46073 RUNNING node02:8042 0 node03:40601 RUNNING node03:8042 0 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/934b83fdf9cbcc1a48f26ef6dad8463e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-14T18:28:23+08:00" />
<meta property="article:modified_time" content="2024-03-14T18:28:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Hadoop大数据应用：Yarn 节点实现扩容与缩容</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%C2%A0%E4%B8%80%E3%80%81%E5%AE%9E%E9%AA%8C-toc" style="margin-left:0px;"><a href="#%C2%A0%E4%B8%80%E3%80%81%E5%AE%9E%E9%AA%8C" rel="nofollow">  一、实验</a></p> 
<p id="1.%E7%8E%AF%E5%A2%83-toc" style="margin-left:40px;"><a href="#1.%E7%8E%AF%E5%A2%83" rel="nofollow">1.环境</a></p> 
<p id="2.HDFS%20%E9%9B%86%E7%BE%A4%E8%8A%82%E7%82%B9%E6%89%A9%E5%AE%B9-toc" style="margin-left:40px;"><a href="#2.HDFS%20%E9%9B%86%E7%BE%A4%E8%8A%82%E7%82%B9%E6%89%A9%E5%AE%B9" rel="nofollow">2.Yarn 节点扩容</a></p> 
<p id="3.Yarn%20%E8%8A%82%E7%82%B9%E7%BC%A9%E5%AE%B9-toc" style="margin-left:40px;"><a href="#3.Yarn%20%E8%8A%82%E7%82%B9%E7%BC%A9%E5%AE%B9" rel="nofollow">3.Yarn 节点缩容</a></p> 
<p id="%E4%BA%8C%E3%80%81%E9%97%AE%E9%A2%98-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E9%97%AE%E9%A2%98" rel="nofollow">二、问题</a></p> 
<p id="1.yarn%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1%E6%8A%A5%E9%94%99-toc" style="margin-left:40px;"><a href="#1.yarn%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1%E6%8A%A5%E9%94%99" rel="nofollow">1.yarn启动服务报错</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p></p> 
<h2 id="%C2%A0%E4%B8%80%E3%80%81%E5%AE%9E%E9%AA%8C">  一、实验</h2> 
<h3 id="1.%E7%8E%AF%E5%A2%83">1.环境</h3> 
<p>（1）主机</p> 
<p style="text-align:center;">表1  主机</p> 
<table border="1" cellpadding="1" cellspacing="1"><tbody><tr><td style="text-align:center;">主机</td><td style="text-align:center;">架构</td><td style="text-align:center;">软件</td><td style="text-align:center;">版本</td><td style="text-align:center;">IP</td><td style="text-align:center;">备注</td></tr><tr><td style="text-align:center;">hadoop</td><td> <p style="text-align:center;">NameNode （已部署）</p> <p style="text-align:center;">SecondaryNameNode （已部署）</p> <p style="text-align:center;">ResourceManager（已部署）</p> </td><td> <p style="text-align:center;">hadoop</p> </td><td style="text-align:center;">2.7.7</td><td style="text-align:center;">192.168.204.50</td><td> <p style="text-align:center;"></p> </td></tr><tr><td style="text-align:center;">node01</td><td> <p style="text-align:center;">DataNode（已部署）</p> <p style="text-align:center;">NodeManager（已部署）</p> </td><td> <p style="text-align:center;">hadoop</p> </td><td style="text-align:center;">2.7.7</td><td style="text-align:center;">192.168.204.51</td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">node02</td><td> <p style="text-align:center;">DataNode（已部署）</p> <p style="text-align:center;">NodeManager（已部署）</p> </td><td> <p style="text-align:center;">hadoop</p> </td><td style="text-align:center;">2.7.7</td><td style="text-align:center;">192.168.204.52</td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">node03</td><td> <p style="text-align:center;">DataNode（已部署）</p> <p style="text-align:center;">NodeManager（已部署）</p> </td><td> <p style="text-align:center;">hadoop</p> </td><td style="text-align:center;">2.7.7</td><td style="text-align:center;">192.168.204.53</td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">node05</td><td style="text-align:center;">NodeManager</td><td> <p style="text-align:center;">hadoop</p> </td><td style="text-align:center;">2.7.7</td><td style="text-align:center;">192.168.204.55</td><td style="text-align:center;"></td></tr></tbody></table> 
<p>（2）查看jps</p> 
<p>hadoop节点</p> 
<pre><code class="language-bash">[root@hadoop hadoop]# jps
</code></pre> 
<p><img alt="" height="165" src="https://images2.imgbox.com/e6/84/A3gdseqA_o.png" width="474"></p> 
<p>node01节点</p> 
<p><img alt="" height="157" src="https://images2.imgbox.com/c1/6b/DTXHCWxB_o.png" width="491"></p> 
<p>node02节点</p> 
<p><img alt="" height="156" src="https://images2.imgbox.com/82/81/JGBA29Iv_o.png" width="551"></p> 
<p>node03节点</p> 
<p><img alt="" height="166" src="https://images2.imgbox.com/ff/d2/CeWQwzu2_o.png" width="488"></p> 
<p>（3） 查看节点</p> 
<pre><code class="language-bash">[root@hadoop hadoop]# ./bin/yarn node -list
24/03/14 13:40:21 INFO client.RMProxy: Connecting to ResourceManager at hadoop/192.168.204.50:8032
Total Nodes:3
         Node-Id             Node-State Node-Http-Address       Number-of-Running-Containers
    node01:40551                RUNNING       node01:8042                                  0
    node02:46073                RUNNING       node02:8042                                  0
    node03:40601                RUNNING       node03:8042                                  0
</code></pre> 
<p><img alt="" height="205" src="https://images2.imgbox.com/1b/21/oNO1pzPJ_o.png" width="1200"></p> 
<p></p> 
<h3 id="2.HDFS%20%E9%9B%86%E7%BE%A4%E8%8A%82%E7%82%B9%E6%89%A9%E5%AE%B9">2.Yarn 节点扩容</h3> 
<p>（1）查看IP</p> 
<p>地址为192.168.204.55</p> 
<pre><code class="language-bash">[root@localhost ~]# ip addr
</code></pre> 
<p></p> 
<p><img alt="" height="511" src="https://images2.imgbox.com/5e/91/cxBKtHyw_o.png" width="1200"></p> 
<p> （2）安全机制</p> 
<p>查看</p> 
<pre><code class="language-bash">[root@localhost ~]# sestatus
</code></pre> 
<p><img alt="" height="290" src="https://images2.imgbox.com/54/a5/7v6OX6RL_o.png" width="746"></p> 
<p>关闭</p> 
<pre><code class="language-bash">[root@localhost ~]# vim /etc/selinux/config
……
SELINUX=disabled
……</code></pre> 
<p><img alt="" height="64" src="https://images2.imgbox.com/02/3a/Jf73ZhLV_o.png" width="700"></p> 
<p><img alt="" height="61" src="https://images2.imgbox.com/29/3b/TgCNZQSs_o.png" width="501"></p> 
<p>再次查看（需要reboot重启）</p> 
<pre><code class="language-bash">[root@localhost ~]# sestatus
</code></pre> 
<p><img alt="" height="113" src="https://images2.imgbox.com/f7/0a/LwYWHTac_o.png" width="671"></p> 
<p>（3）防火墙</p> 
<p>关闭</p> 
<pre><code class="language-bash">[root@localhost ~]# systemctl stop firewalld
[root@localhost ~]# systemctl mask firewalld
</code></pre> 
<p><img alt="" height="149" src="https://images2.imgbox.com/2a/b8/wEi5zpkN_o.png" width="948"></p> 
<p>（4）安装java</p> 
<pre><code class="language-bash">[root@localhost ~]# yum install -y java-1.8.0-openjdk-devel.x86_64
</code></pre> 
<p><img alt="" height="84" src="https://images2.imgbox.com/03/5e/lXO4yqsH_o.png" width="1075"></p> 
<p>查看</p> 
<pre><code class="language-bash">[root@localhost ~]# jps
</code></pre> 
<p><img alt="" height="89" src="https://images2.imgbox.com/1e/5b/U3esXmjK_o.png" width="853"></p> 
<p> （5）修改主机名</p> 
<pre><code class="language-bash">[root@localhost ~]# hostnamectl set-hostname node05
[root@localhost ~]# bash
</code></pre> 
<p><img alt="" height="79" src="https://images2.imgbox.com/7f/6e/dhaQwQ15_o.png" width="769"></p> 
<p>（6）添加免密登录</p> 
<pre><code class="language-bash">[root@hadoop ~]# cd /root/.ssh/
[root@hadoop .ssh]# ls
authorized_keys  id_rsa  id_rsa.pub  known_hosts
[root@hadoop .ssh]# ssh-copy-id -i id_rsa.pub 192.168.204.55
</code></pre> 
<p><img alt="" height="312" src="https://images2.imgbox.com/c2/b3/MWDSuhnm_o.png" width="1200"></p> 
<p>验证：</p> 
<pre><code class="language-bash">[root@hadoop .ssh]# ssh 192.168.204.55
</code></pre> 
<p><img alt="" height="123" src="https://images2.imgbox.com/7b/cf/tptLTfCw_o.png" width="759"></p> 
<p> （7）域名主机名(hadoop节点)</p> 
<pre><code class="language-bash">[root@hadoop ~]# vim /etc/hosts
……
192.168.205.50 hadoop
192.168.205.51 node01
192.168.205.52 node02
192.168.205.53 node03
192.168.204.54 node04
192.168.204.55 node05</code></pre> 
<p></p> 
<p><img alt="" height="154" src="https://images2.imgbox.com/ab/56/T6ZKWPB2_o.png" width="494"></p> 
<p>（8）同步域名配置文件</p> 
<pre><code class="language-bash">
[root@hadoop ~]# rsync -av /etc/hosts node01:/etc/
sending incremental file list
hosts

sent 382 bytes  received 41 bytes  282.00 bytes/sec
total size is 291  speedup is 0.69
[root@hadoop ~]# rsync -av /etc/hosts node02:/etc/
sending incremental file list
hosts

sent 382 bytes  received 41 bytes  282.00 bytes/sec
total size is 291  speedup is 0.69
[root@hadoop ~]# rsync -av /etc/hosts node03:/etc/
sending incremental file list
hosts

sent 382 bytes  received 41 bytes  846.00 bytes/sec
total size is 291  speedup is 0.69
[root@hadoop ~]# rsync -av /etc/hosts node05:/etc/
Warning: Permanently added 'node05' (ECDSA) to the list of known hosts.
sending incremental file list
hosts

sent 382 bytes  received 41 bytes  846.00 bytes/sec
total size is 291  speedup is 0.69
</code></pre> 
<p><img alt="" height="506" src="https://images2.imgbox.com/9c/ff/gpTCRE42_o.png" width="900"></p> 
<p>（9）同步Hadoop文件</p> 
<pre><code class="language-bash">[root@hadoop ~]# rsync -aXSH --delete /usr/local/hadoop node05:/usr/local/
</code></pre> 
<p></p> 
<p><img alt="" height="63" src="https://images2.imgbox.com/ec/4e/8IA27JQx_o.png" width="1104"></p> 
<p>(10) 清除日志（node05节点）</p> 
<pre><code class="language-bash">[root@node05 ~]# cd /usr/local/hadoop/
[root@node05 hadoop]# ls
bin  etc  include  lib  libexec  LICENSE.txt  logs  NOTICE.txt  README.txt  sbin  share
[root@node05 hadoop]# cd logs/
[root@node05 logs]# ls
hadoop-root-balancer-hadoop.log  hadoop-root-namenode-hadoop.out           hadoop-root-secondarynamenode-hadoop.out    yarn-root-resourcemanager-hadoop.log
hadoop-root-balancer-hadoop.out  hadoop-root-namenode-hadoop.out.1         hadoop-root-secondarynamenode-hadoop.out.1  yarn-root-resourcemanager-hadoop.out
hadoop-root-namenode-hadoop.log  hadoop-root-secondarynamenode-hadoop.log  SecurityAuth-root.audit
[root@node05 logs]# rm -f *
[root@node05 logs]# ls
[root@node05 logs]#
</code></pre> 
<p><img alt="" height="275" src="https://images2.imgbox.com/9b/0f/p4OpLpyk_o.png" width="1200"></p> 
<p></p> 
<p>（11）启动服务 （node05节点）</p> 
<pre><code class="language-bash">[root@node05 hadoop]# ./sbin/yarn-daemon.sh start nodemanager
</code></pre> 
<p></p> 
<p><img alt="" height="64" src="https://images2.imgbox.com/cf/44/7oLK5WkI_o.png" width="1200"></p> 
<p>查看jps 出现新角色</p> 
<p><img alt="" height="111" src="https://images2.imgbox.com/58/0d/ll1EuZwx_o.png" width="465"></p> 
<p></p> 
<p>(15) 验证 （hadoop节点）</p> 
<p>服务已互通</p> 
<pre><code class="language-bash">[root@hadoop hadoop]#  ./bin/yarn node -list
24/03/14 18:07:06 INFO client.RMProxy: Connecting to ResourceManager at hadoop/192.168.204.50:8032
Total Nodes:4
         Node-Id             Node-State Node-Http-Address       Number-of-Running-Containers
    node01:40551                RUNNING       node01:8042                                  0
    node05:39920                RUNNING       node05:8042                                  0
    node02:46073                RUNNING       node02:8042                                  0
    node03:40601                RUNNING       node03:8042                                  0
</code></pre> 
<p><img alt="" height="183" src="https://images2.imgbox.com/f4/20/sWuFJ48C_o.png" width="1200"></p> 
<p></p> 
<h3 id="3.Yarn%20%E8%8A%82%E7%82%B9%E7%BC%A9%E5%AE%B9">3.Yarn 节点缩容</h3> 
<p>（1）删除节点 （node05节点）</p> 
<pre><code class="language-bash">[root@node05 hadoop]# ./sbin/yarn-daemon.sh stop nodemanager
</code></pre> 
<p><img alt="" height="66" src="https://images2.imgbox.com/d1/38/Tf2rlJnJ_o.png" width="937"></p> 
<p>查看jps</p> 
<p><img alt="" height="81" src="https://images2.imgbox.com/6d/11/a4fDruvR_o.png" width="607"></p> 
<p>（2）验证 （hadoop节点）</p> 
<p>这时node05节点还在(因为存在检测超时)</p> 
<pre><code class="language-bash">[root@hadoop hadoop]#  ./bin/yarn node -list
</code></pre> 
<p><img alt="" height="171" src="https://images2.imgbox.com/00/9e/69LJfjum_o.png" width="1200"></p> 
<p>(3) 停止服务（hadoop节点）</p> 
<pre><code class="language-bash">[root@hadoop hadoop]# ./sbin/yarn-daemon.sh stop resourcemanager
</code></pre> 
<p><img alt="" height="50" src="https://images2.imgbox.com/aa/b3/Le8U3x6Z_o.png" width="1200"></p> 
<p>（4）启动服务（hadoop节点）</p> 
<pre><code class="language-bash">[root@hadoop hadoop]# ./sbin/yarn-daemon.sh start resourcemanager
</code></pre> 
<p><img alt="" height="55" src="https://images2.imgbox.com/81/b4/ygX3OqSS_o.png" width="1147"></p> 
<p>（5）验证 （hadoop节点）</p> 
<p>这时暂无节点，需要等待30秒-1分钟</p> 
<pre><code class="language-bash">[root@hadoop hadoop]#  ./bin/yarn node -list
</code></pre> 
<p><img alt="" height="81" src="https://images2.imgbox.com/49/ae/iukAMyLo_o.png" width="1200"></p> 
<p>（6）再次验证 （hadoop节点）</p> 
<p>node05节点已移除</p> 
<pre><code class="language-bash">[root@hadoop hadoop]#  ./bin/yarn node -list
</code></pre> 
<p><img alt="" height="178" src="https://images2.imgbox.com/bf/50/cxpVcLwO_o.png" width="1091"></p> 
<p></p> 
<p></p> 
<h2 id="%E4%BA%8C%E3%80%81%E9%97%AE%E9%A2%98">二、问题</h2> 
<h3 id="1.yarn%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1%E6%8A%A5%E9%94%99">1.yarn启动服务报错</h3> 
<p>（1）报错</p> 
<pre><code class="language-bash">错误: 找不到或无法加载主类 nodemanager
</code></pre> 
<p><img alt="" height="84" src="https://images2.imgbox.com/42/e4/ibN2Y1L3_o.png" width="1200"></p> 
<p>（2）原因分析</p> 
<p>命令错误。</p> 
<p>（3）解决方法</p> 
<p>修改命令，hadoop-daemon.sh 改为 yarn-daemon.sh</p> 
<pre><code class="language-bash">[root@node05 hadoop]# ./sbin/yarn-daemon.sh start nodemanager
</code></pre> 
<p><img alt="" height="65" src="https://images2.imgbox.com/99/6e/aAcYN9m7_o.png" width="1200"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6f0f33ac4387b242cb48a65275785d31/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java垃圾回收-三色标记法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7670907ced3eb24bac8ad7b2f96d90f4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mysql 表的约束</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>