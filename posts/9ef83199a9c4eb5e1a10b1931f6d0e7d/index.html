<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql的sql语句练习题 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql的sql语句练习题" />
<meta property="og:description" content="表名和字段
–1.学生表
Student(s_id,s_name,s_birth,s_sex) --学生编号,学生姓名, 出生年月,学生性别
–2.课程表
Course(c_id,c_name,t_id) – --课程编号, 课程名称, 教师编号
–3.教师表
Teacher(t_id,t_name) --教师编号,教师姓名
–4.成绩表
Score(s_id,c_id,s_score) --学生编号,课程编号,分数
测试数据
--建表
--学生表
CREATE TABLE `Student`(
`s_id` VARCHAR(20),
`s_name` VARCHAR(20) NOT NULL DEFAULT &#39;&#39;,
`s_birth` VARCHAR(20) NOT NULL DEFAULT &#39;&#39;,
`s_sex` VARCHAR(10) NOT NULL DEFAULT &#39;&#39;,
PRIMARY KEY(`s_id`)
);
--课程表
CREATE TABLE `Course`(
`c_id` VARCHAR(20),
`c_name` VARCHAR(20) NOT NULL DEFAULT &#39;&#39;,
`t_id` VARCHAR(20) NOT NULL,
PRIMARY KEY(`c_id`)
);
--教师表
CREATE TABLE `Teacher`(" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/9ef83199a9c4eb5e1a10b1931f6d0e7d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-04-05T18:05:51+08:00" />
<meta property="article:modified_time" content="2020-04-05T18:05:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql的sql语句练习题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>表名和字段<br> –1.学生表<br> Student(s_id,s_name,s_birth,s_sex) --学生编号,学生姓名, 出生年月,学生性别<br> –2.课程表<br> Course(c_id,c_name,t_id) – --课程编号, 课程名称, 教师编号<br> –3.教师表<br> Teacher(t_id,t_name) --教师编号,教师姓名<br> –4.成绩表<br> Score(s_id,c_id,s_score) --学生编号,课程编号,分数</p> 
<p>测试数据<br> --建表<br> --学生表<br> CREATE TABLE `Student`(<br>     `s_id` VARCHAR(20),<br>     `s_name` VARCHAR(20) NOT NULL DEFAULT '',<br>     `s_birth` VARCHAR(20) NOT NULL DEFAULT '',<br>     `s_sex` VARCHAR(10) NOT NULL DEFAULT '',<br>     PRIMARY KEY(`s_id`)<br> );<br> --课程表<br> CREATE TABLE `Course`(<br>     `c_id`  VARCHAR(20),<br>     `c_name` VARCHAR(20) NOT NULL DEFAULT '',<br>     `t_id` VARCHAR(20) NOT NULL,<br>     PRIMARY KEY(`c_id`)<br> );<br> --教师表<br> CREATE TABLE `Teacher`(<br>     `t_id` VARCHAR(20),<br>     `t_name` VARCHAR(20) NOT NULL DEFAULT '',<br>     PRIMARY KEY(`t_id`)<br> );<br> --成绩表<br> CREATE TABLE `Score`(<br>     `s_id` VARCHAR(20),<br>     `c_id`  VARCHAR(20),<br>     `s_score` INT(3),<br>     PRIMARY KEY(`s_id`,`c_id`)<br> );<br> --插入学生表测试数据<br> insert into Student values('01' , '赵雷' , '1990-01-01' , '男');<br> insert into Student values('02' , '钱电' , '1990-12-21' , '男');<br> insert into Student values('03' , '孙风' , '1990-05-20' , '男');<br> insert into Student values('04' , '李云' , '1990-08-06' , '男');<br> insert into Student values('05' , '周梅' , '1991-12-01' , '女');<br> insert into Student values('06' , '吴兰' , '1992-03-01' , '女');<br> insert into Student values('07' , '郑竹' , '1989-07-01' , '女');<br> insert into Student values('08' , '王菊' , '1990-01-20' , '女');<br> --课程表测试数据<br> insert into Course values('01' , '语文' , '02');<br> insert into Course values('02' , '数学' , '01');<br> insert into Course values('03' , '英语' , '03');</p> 
<p>--教师表测试数据<br> insert into Teacher values('01' , '张三');<br> insert into Teacher values('02' , '李四');<br> insert into Teacher values('03' , '王五');</p> 
<p>--成绩表测试数据<br> insert into Score values('01' , '01' , 80);<br> insert into Score values('01' , '02' , 90);<br> insert into Score values('01' , '03' , 99);<br> insert into Score values('02' , '01' , 70);<br> insert into Score values('02' , '02' , 60);<br> insert into Score values('02' , '03' , 80);<br> insert into Score values('03' , '01' , 80);<br> insert into Score values('03' , '02' , 80);<br> insert into Score values('03' , '03' , 80);<br> insert into Score values('04' , '01' , 50);<br> insert into Score values('04' , '02' , 30);<br> insert into Score values('04' , '03' , 20);<br> insert into Score values('05' , '01' , 76);<br> insert into Score values('05' , '02' , 87);<br> insert into Score values('06' , '01' , 31);<br> insert into Score values('06' , '03' , 34);<br> insert into Score values('07' , '02' , 89);<br> insert into Score values('07' , '03' , 98);</p> 
<p><strong>1.练习题题目</strong></p> 
<p>1、查询"01"课程比"02"课程成绩高的学生的信息及课程分数</p> 
<p>2、查询"01"课程比"02"课程成绩低的学生的信息及课程分数</p> 
<p>3、查询平均成绩大于等于60分的同学的学生编号和学生姓名和平均成绩</p> 
<p>4、查询平均成绩小于60分的同学的学生编号和学生姓名和平均成绩(包括有成绩的和无成绩的)</p> 
<p>5、查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩</p> 
<p>6、查询"李"姓老师的数量 </p> 
<p>7、查询学过"张三"老师授课的同学的信息</p> 
<p>8、查询没学过"张三"老师授课的同学的信息</p> 
<p>9、查询学过编号为"01"并且也学过编号为"02"的课程的同学的信息</p> 
<p>10、查询学过编号为"01"但是没有学过编号为"02"的课程的同学的信息</p> 
<p>11、查询没有学全所有课程的同学的信息</p> 
<p>12、查询至少有一门课与学号为"01"的同学所学相同的同学的信息 </p> 
<p> 13、查询和"01"号的同学学习的课程完全相同的其他同学的信息 </p> 
<p>14、查询没学过"张三"老师讲授的任一门课程的学生姓名 </p> 
<p>15、查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩</p> 
<p>16、检索"01"课程分数小于60，按分数降序排列的学生信息</p> 
<p> 17、按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩</p> 
<p>18.查询各科成绩最高分、最低分和平均分：以如下形式显示：课程ID，课程name，最高分，最低分，平均分，及格率，中等率，优良率，优秀率<br> --及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90</p> 
<p>19、按各科成绩进行排序，并显示排名</p> 
<p>20、查询学生的总成绩并进行排名</p> 
<p>21、查询不同老师所教不同课程平均分从高到低显示</p> 
<p>22、查询所有课程的成绩第2名到第3名的学生信息及该课程成绩</p> 
<p>23、统计各科成绩各分数段人数：课程编号,课程名称,[100-85],[85-70],[70-60],[0-60]及所占百分比</p> 
<p>24、查询学生平均成绩及其名次 </p> 
<p> 25、查询各科成绩前三名的记录</p> 
<p>26、查询每门课程被选修的学生数 </p> 
<p>27、查询出只有两门课程的全部学生的学号和姓名</p> 
<p>28、查询男生、女生人数 </p> 
<p>29、查询名字中含有"风"字的学生信息</p> 
<p>30、查询同名同性学生名单，并统计同名人数 </p> 
<p>31、查询1990年出生的学生名单</p> 
<p>32、查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列</p> 
<p>33、查询平均成绩大于等于85的所有学生的学号、姓名和平均成绩 </p> 
<p>34、查询课程名称为"数学"，且分数低于60的学生姓名和分数 </p> 
<p>35、查询所有学生的课程及分数情况；</p> 
<p>36、查询任何一门课程成绩在70分以上的姓名、课程名称和分数；</p> 
<p>37、查询不及格的课程</p> 
<p>38、查询课程编号为01且课程成绩在80分以上的学生的学号和姓名；</p> 
<p>39、求每门课程的学生人数 <br> 40、查询选修"张三"老师所授课程的学生中，成绩最高的学生信息及其成绩</p> 
<p> 41、查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩 </p> 
<p>42、查询每门功成绩最好的前两名 </p> 
<p>43、统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列  </p> 
<p>44、检索至少选修两门课程的学生学号 </p> 
<p>45、查询选修了全部课程的学生信息</p> 
<p>46、查询各学生的年龄</p> 
<p>47、查询本周过生日的学生</p> 
<p>48、查询下周过生日的学生</p> 
<p>49、查询本月过生日的学生</p> 
<p>50、查询下月过生日的学生</p> 
<p><br><strong>2.练习题和对应的sql语句</strong><br> -- 1、查询"01"课程比"02"课程成绩高的学生的信息及课程分数    <br>     <br> select a.* ,b.s_score as 01_score,c.s_score as 02_score from <br> student a <br>     join score b on a.s_id=b.s_id and b.c_id='01'<br>     left join score c on a.s_id=c.s_id and c.c_id='02' or c.c_id = NULL where b.s_score&gt;c.s_score<br>     <br> --也可以这样写<br>     select a.*,b.s_score as 01_score,c.s_score as 02_score from student           a,score b,score c <br>             where a.s_id=b.s_id <br>             and a.s_id=c.s_id <br>             and b.c_id='01' <br>             and c.c_id='02' <br>             and b.s_score&gt;c.s_score<br> -- 2、查询"01"课程比"02"课程成绩低的学生的信息及课程分数<br>     <br> select a.* ,b.s_score as 01_score,c.s_score as 02_score from <br>     student a left join score b on a.s_id=b.s_id and b.c_id='01' or b.c_id=NULL <br>      join score c on a.s_id=c.s_id and c.c_id='02' where b.s_score&lt;c.s_score<br>             </p> 
<p>-- 3、查询平均成绩大于等于60分的同学的学生编号和学生姓名和平均成绩<br> select b.s_id,b.s_name,ROUND(AVG(a.s_score),2) as avg_score from <br>     student b <br>     join score a on b.s_id = a.s_id<br>     GROUP BY b.s_id,b.s_name HAVING avg_score &gt;=60;<br>     </p> 
<p>-- 4、查询平均成绩小于60分的同学的学生编号和学生姓名和平均成绩(包括有成绩的和无成绩的)</p> 
<p>sql语句解释备注 ：union前边为有成绩的数据，union后边为无成绩数据，先通过score表查出所有参加的学生，然后再查student表用not in排除有成绩的。<br>         <br> select b.s_id,b.s_name,ROUND(AVG(a.s_score),2) as avg_score from <br>     student b <br>     left join score a on b.s_id = a.s_id<br>     GROUP BY b.s_id,b.s_name HAVING avg_score &lt;60<br>     union<br> select a.s_id,a.s_name,0 as avg_score from <br>     student a <br>     where a.s_id not in (<br>                 select distinct s_id from score);</p> 
<p><br> -- 5、查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩<br> select a.s_id,a.s_name,count(b.c_id) as sum_course,sum(b.s_score) as sum_score from <br>     student a <br>     left join score b on a.s_id=b.s_id<br>     GROUP BY a.s_id,a.s_name;<br>             <br>             <br> -- 6、查询"李"姓老师的数量 <br> select count(t_id) from teacher where t_name like '李%';<br>     <br> -- 7、查询学过"张三"老师授课的同学的信息 <br> select a.* from <br>     student a <br>     join score b on a.s_id=b.s_id where b.c_id in(<br>         select c_id from course where t_id =(<br>             select t_id from teacher where t_name = '张三'));</p> 
<p>或者</p> 
<p>SELECT<br>     st.s_id,<br>     st.s_name<br> FROM<br>     student st<br> WHERE<br>     st.s_id IN (<br>         SELECT DISTINCT<br>             sc.s_id<br>         FROM<br>             score sc<br>         JOIN course co ON sc.c_id = co.c_id<br>         JOIN teacher te ON co.t_id = te.t_id<br>         WHERE<br>             t_name = '张三'<br>     );</p> 
<p>-- 8、查询没学过"张三"老师授课的同学的信息 <br> select * from <br>     student c <br>     where c.s_id not in(<br>         select a.s_id from student a join score b on a.s_id=b.s_id where b.c_id in(<br>         select a.c_id from course a join teacher b on a.t_id = b.t_id where t_name ='张三'));<br> -- 9、查询学过编号为"01"并且也学过编号为"02"的课程的同学的信息</p> 
<p>select a.* from <br>     student a,score b,score c <br>     where a.s_id = b.s_id  and a.s_id = c.s_id and b.c_id='01' and c.c_id='02';</p> 
<p>或者</p> 
<p>SELECT<br>     *<br> FROM<br>     student<br> WHERE<br>     s_id IN (<br>         SELECT<br>             a.s_id<br>         FROM<br>             score a,<br>             score b<br>         WHERE<br>             a.s_id = b.s_id<br>         AND a.c_id = '01'<br>         AND b.c_id = '02'<br>     );<br>     <br> -- 10、查询学过编号为"01"但是没有学过编号为"02"的课程的同学的信息<br>             <br> select a.* from <br>     student a <br>     where a.s_id in (select s_id from score where c_id='01' ) and a.s_id not in(select s_id from score where c_id='02')<br>             </p> 
<p>-- 11、查询没有学全所有课程的同学的信息 <br> SELECT<br>     st.*<br> FROM<br>     score sc<br> JOIN student st ON sc.s_id = st.s_id<br> GROUP BY<br>     sc.s_id<br> HAVING<br>     count(sc.s_id) &lt; (<br>         SELECT<br>             count(c_id)<br>         FROM<br>             course<br>     );<br><br> --@k1051785839的写法<br> select *<br> from student<br> where s_id not in(<br> select s_id from score t1  <br> group by s_id having count(*) =(select count(distinct c_id)  from course)) <br> -- 12、查询至少有一门课与学号为"01"的同学所学相同的同学的信息 </p> 
<p>select * from student where s_id in(<br>     select distinct a.s_id from score a where a.c_id in(select a.c_id from score a where a.s_id='01')<br>     );<br>             <br> -- 13、查询和"01"号的同学学习的课程完全相同的其他同学的信息 <br> --@ouyang_1993的写法<br> SELECT<br>  Student.*<br> FROM<br>  Student<br> WHERE<br>  s_id IN (SELECT s_id FROM Score GROUP BY s_id HAVING COUNT(s_id) = (<br>     #下面的语句是找到'01'同学学习的课程数<br>     SELECT COUNT(c_id) FROM Score WHERE s_id = '01'<br>    )<br>  )<br> AND s_id NOT IN (<br>  #下面的语句是找到学过‘01’同学没学过的课程，有哪些同学。并排除他们<br>  SELECT s_id FROM Score<br>  WHERE c_id IN(<br>    #下面的语句是找到‘01’同学没学过的课程<br>    SELECT DISTINCT c_id FROM Score<br>    WHERE c_id NOT IN (<br>      #下面的语句是找出‘01’同学学习的课程<br>      SELECT c_id FROM Score WHERE s_id = '01'<br>     )<br>   ) GROUP BY s_id<br> ) #下面的条件是排除01同学<br> AND s_id NOT IN ('01')<br> --@k1051785839的写法(学习了一个group_concat(）函数)<br> SELECT<br>  t3.*<br> FROM<br>  (<br>   SELECT<br>    s_id,<br>    group_concat(c_id ORDER BY c_id) group1<br>   FROM<br>    score<br>   WHERE<br>    s_id &gt; '01'<br>   GROUP BY<br>    s_id<br>  ) t1<br> INNER JOIN (<br>  SELECT<br>   group_concat(c_id ORDER BY c_id) group2<br>  FROM<br>   score<br>  WHERE<br>   s_id = '01'<br>  GROUP BY<br>   s_id<br> ) t2 ON t1.group1 = t2.group2<br> INNER JOIN student t3 ON t1.s_id = t3.s_id</p> 
<p>-- 14、查询没学过"张三"老师讲授的任一门课程的学生姓名 <br> select a.s_name from student a where a.s_id not in (<br>     select s_id from score where c_id = <br>                 (select c_id from course where t_id =(<br>                     select t_id from teacher where t_name = '张三')));</p> 
<p>-- 15、查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩 <br> select a.s_id,a.s_name,ROUND(AVG(b.s_score)) from <br>     student a <br>     left join score b on a.s_id = b.s_id<br>     where a.s_id in(<br>             select s_id from score where s_score&lt;60 GROUP BY  s_id having count(1)&gt;=2)<br>     GROUP BY a.s_id,a.s_name</p> 
<p>自己的</p> 
<p>SELECT  AVG(sc.s_score),sc.s_id,st.s_name from score sc  JOIN student st on sc.s_id = st.s_id <br> WHERE sc.s_score &lt; 60 group by s_id HAVING count(sc.s_score) &gt;= 2;</p> 
<p>-- 16、检索"01"课程分数小于60，按分数降序排列的学生信息<br> select a.*,b.c_id,b.s_score from <br>     student a,score b <br>     where a.s_id = b.s_id and b.c_id='01' and b.s_score&lt;60 ORDER BY b.s_score DESC;</p> 
<p>自己的</p> 
<p>SELECT st.* from score sc join student st on sc.s_id= st.s_id WHERE sc.c_id ='01' and sc.s_score &lt; 60 ORDER BY s_score Desc;<br>         <br> -- 17、按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩<br> select a.s_id,(select s_score from score where s_id=a.s_id and c_id='01') as 语文,<br>                 (select s_score from score where s_id=a.s_id and c_id='02') as 数学,<br>                 (select s_score from score where s_id=a.s_id and c_id='03') as 英语,<br>             round(avg(s_score),2) as 平均分 from score a  GROUP BY a.s_id ORDER BY 平均分 DESC;<br> 其他写法</p> 
<p>SELECT a.s_id,<br>               MAX(CASE a.c_id WHEN '01' THEN a.s_score END ) 语文, <br>                 MAX(CASE a.c_id WHEN '02' THEN a.s_score END ) 数学, <br>                 MAX(CASE a.c_id WHEN '03' THEN a.s_score END ) 英语, <br>                 ROUND(avg(a.s_score),2) avg,<br>                 b.s_name <br> FROM Score a JOIN Student b ON a.s_id=b.s_id <br> GROUP BY a.s_id ORDER BY 5 DESC; </p> 
<p>       <br> -- 18.查询各科成绩最高分、最低分和平均分：以如下形式显示：课程ID，课程name，最高分，最低分，平均分，及格率，中等率，优良率，优秀率<br> --及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90</p> 
<p><br> select a.c_id,b.c_name,MAX(s_score),MIN(s_score),ROUND(AVG(s_score),2),<br>     ROUND(100*(SUM(case when a.s_score&gt;=60 then 1 else 0 end)/SUM(case when a.s_score then 1 else 0 end)),2) as 及格率,<br>     ROUND(100*(SUM(case when a.s_score&gt;=70 and a.s_score&lt;=80 then 1 else 0 end)/SUM(case when a.s_score then 1 else 0 end)),2) as 中等率,<br>     ROUND(100*(SUM(case when a.s_score&gt;=80 and a.s_score&lt;=90 then 1 else 0 end)/SUM(case when a.s_score then 1 else 0 end)),2) as 优良率,<br>     ROUND(100*(SUM(case when a.s_score&gt;=90 then 1 else 0 end)/SUM(case when a.s_score then 1 else 0 end)),2) as 优秀率<br>     from score a left join course b on a.c_id = b.c_id GROUP BY a.c_id,b.c_name</p> 
<p>其他写法</p> 
<p> SELECT MAX(sc.s_score) '最高分',MIN(sc.s_score) '最低分',avg(sc.s_score) '平均分',sc.c_id,co.c_name,<br>               round((100*(sum(case when sc.s_score &gt;= 60 then 1 else 0 end)/count(sc.s_score))),2) as '及格率',<br>               round((100*(sum(case when sc.s_score &gt;= 70 and sc.s_score &lt;= 80 then 1 else 0 end)/count(sc.s_score))),2) as '中等率',<br>               round((100*(sum(case when sc.s_score &gt;= 80 and sc.s_score &lt;= 90 then 1 else 0 end)/count(sc.s_score))),2) as '优良率',<br>               round((100*(sum(case when sc.s_score &gt;= 90 then 1 else 0 end)/count(sc.s_score))),2) as '优秀率'<br>   from score sc  join course co on sc.c_id=co.c_id <br>   GROUP BY sc.c_id;<br>     <br> -- 19、按各科成绩进行排序，并显示排名<br> -- mysql没有rank函数<br>     select a.s_id,a.c_id,<br>         @i:=@i +1 as i保留排名,<br>         @k:=(case when @score=a.s_score then @k else @i end) as rank不保留排名,<br>         @score:=a.s_score as score<br>     from (<br>         select s_id,c_id,s_score from score GROUP BY s_id,c_id,s_score ORDER BY s_score DESC<br> )a,(select @k:=0,@i:=0,@score:=0)s<br> --@k1051785839的写法<br> (select * from (select <br> t1.c_id,<br> t1.s_score,<br> (select count(distinct t2.s_score) from score t2 where t2.s_score&gt;=t1.s_score and t2.c_id='01') rank<br> FROM score t1 where t1.c_id='01'<br> order by t1.s_score desc) t1)<br> union<br> (select * from (select <br> t1.c_id,<br> t1.s_score,<br> (select count(distinct t2.s_score) from score t2 where t2.s_score&gt;=t1.s_score and t2.c_id='02') rank<br> FROM score t1 where t1.c_id='02'<br> order by t1.s_score desc) t2)<br> union<br> (select * from (select <br> t1.c_id,<br> t1.s_score,<br> (select count(distinct t2.s_score) from score t2 where t2.s_score&gt;=t1.s_score and t2.c_id='03') rank<br> FROM score t1 where t1.c_id='03'<br> order by t1.s_score desc) t3)<br> -- 20、查询学生的总成绩并进行排名<br> select a.s_id,<br>     @i:=@i+1 as i,<br>     @k:=(case when @score=a.sum_score then @k else @i end) as rank,<br>     @score:=a.sum_score as score<br> from (select s_id,SUM(s_score) as sum_score from score GROUP BY s_id ORDER BY sum_score DESC)a,<br>     (select @k:=0,@i:=0,@score:=0)s</p> 
<p>简单版本（上边那个看不懂）</p> 
<p> SELECT sum(s_score) sum,s_id from score GROUP BY s_id ORDER BY sum DESC;<br>     <br> -- 21、查询不同老师所教不同课程平均分从高到低显示 <br>         <br>     select a.t_id,c.t_name,a.c_id,ROUND(avg(s_score),2) as avg_score from course a<br>         left join score b on a.c_id=b.c_id <br>         left join teacher c on a.t_id=c.t_id<br>         GROUP BY a.c_id,a.t_id,c.t_name ORDER BY avg_score DESC;<br> -- 22、查询所有课程的成绩第2名到第3名的学生信息及该课程成绩<br>             <br>             select d.*,c.排名,c.s_score,c.c_id from (<br>                 select a.s_id,a.s_score,a.c_id,@i:=@i+1 as 排名 from score a,(select @i:=0)s where a.c_id='01'  <br>                                 ORDER BY a.s_score DESC  <br>             )c<br>             left join student d on c.s_id=d.s_id<br>             where 排名 BETWEEN 2 AND 3<br>             UNION<br>             select d.*,c.排名,c.s_score,c.c_id from (<br>                 select a.s_id,a.s_score,a.c_id,@j:=@j+1 as 排名 from score a,(select @j:=0)s where a.c_id='02'  <br>                                 ORDER BY a.s_score DESC<br>             )c<br>             left join student d on c.s_id=d.s_id<br>             where 排名 BETWEEN 2 AND 3<br>             UNION<br>             select d.*,c.排名,c.s_score,c.c_id from (<br>                 select a.s_id,a.s_score,a.c_id,@k:=@k+1 as 排名 from score a,(select @k:=0)s where a.c_id='03' <br>                                 ORDER BY a.s_score DESC<br>             )c<br>             left join student d on c.s_id=d.s_id<br>             where 排名 BETWEEN 2 AND 3;<br>             <br> -- 23、统计各科成绩各分数段人数：课程编号,课程名称,[100-85],[85-70],[70-60],[0-60]及所占百分比</p> 
<p><br>         select distinct f.c_name,a.c_id,b.`85-100`,b.百分比,c.`70-85`,c.百分比,d.`60-70`,d.百分比,e.`0-60`,e.百分比 from score a<br>                 left join (select c_id,SUM(case when s_score &gt;85 and s_score &lt;=100 then 1 else 0 end) as `85-100`,<br>                                             ROUND(100*(SUM(case when s_score &gt;85 and s_score &lt;=100 then 1 else 0 end)/count(*)),2) as 百分比<br>                                 from score GROUP BY c_id)b on a.c_id=b.c_id<br>                 left join (select c_id,SUM(case when s_score &gt;70 and s_score &lt;=85 then 1 else 0 end) as `70-85`,<br>                                             ROUND(100*(SUM(case when s_score &gt;70 and s_score &lt;=85 then 1 else 0 end)/count(*)),2) as 百分比<br>                                 from score GROUP BY c_id)c on a.c_id=c.c_id<br>                 left join (select c_id,SUM(case when s_score &gt;60 and s_score &lt;=70 then 1 else 0 end) as `60-70`,<br>                                             ROUND(100*(SUM(case when s_score &gt;60 and s_score &lt;=70 then 1 else 0 end)/count(*)),2) as 百分比<br>                                 from score GROUP BY c_id)d on a.c_id=d.c_id<br>                 left join (select c_id,SUM(case when s_score &gt;=0 and s_score &lt;=60 then 1 else 0 end) as `0-60`,<br>                                             ROUND(100*(SUM(case when s_score &gt;=0 and s_score &lt;=60 then 1 else 0 end)/count(*)),2) as 百分比<br>                                 from score GROUP BY c_id)e on a.c_id=e.c_id<br>                 left join course f on a.c_id = f.c_id<br>                  <br> -- 24、查询学生平均成绩及其名次 </p> 
<p>        select a.s_id,<br>                 @i:=@i+1 as '不保留空缺排名',<br>                 @k:=(case when @avg_score=a.avg_s then @k else @i end) as '保留空缺排名',<br>                 @avg_score:=avg_s as '平均分'<br>         from (select s_id,ROUND(AVG(s_score),2) as avg_s from score GROUP BY s_id ORDER BY avg_s DESC)a,(select @avg_score:=0,@i:=0,@k:=0)b;<br> -- 25、查询各科成绩前三名的记录<br>             -- 1.选出b表比a表成绩大的所有组<br>             -- 2.选出比当前id成绩大的 小于三个的<br>         select a.s_id,a.c_id,a.s_score from score a <br>             left join score b on a.c_id = b.c_id and a.s_score&lt;b.s_score<br>             group by a.s_id,a.c_id,a.s_score HAVING COUNT(b.s_id)&lt;3<br>             ORDER BY a.c_id,a.s_score DESC</p> 
<p>-- 26、查询每门课程被选修的学生数 </p> 
<p>        select c_id,count(s_id) from score a GROUP BY c_id</p> 
<p>-- 27、查询出只有两门课程的全部学生的学号和姓名 <br>         select s_id,s_name from student where s_id in(<br>                 select s_id from score GROUP BY s_id HAVING COUNT(c_id)=2);</p> 
<p>-- 28、查询男生、女生人数 <br>         select s_sex,COUNT(s_sex) as 人数  from student GROUP BY s_sex</p> 
<p>-- 29、查询名字中含有"风"字的学生信息</p> 
<p>        select * from student where s_name like '%风%';</p> 
<p>-- 30、查询同名同性学生名单，并统计同名人数 <br>         <br>         select a.s_name,a.s_sex,count(*) from student a  JOIN <br>                     student b on a.s_id !=b.s_id and a.s_name = b.s_name and a.s_sex = b.s_sex<br>         GROUP BY a.s_name,a.s_sex</p> 
<p>自己的</p> 
<p>SELECT count(s_id),s_id,s_name from student GROUP BY s_sex,s_name HAVING count(s_id) &gt;= 2;</p> 
<p>-- 31、查询1990年出生的学生名单<br>         <br>         select s_name from student where s_birth like '1990%'</p> 
<p>-- 32、查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列 </p> 
<p>    select c_id,ROUND(AVG(s_score),2) as avg_score from score GROUP BY c_id ORDER BY avg_score DESC,c_id ASC</p> 
<p>-- 33、查询平均成绩大于等于85的所有学生的学号、姓名和平均成绩 </p> 
<p>    select a.s_id,b.s_name,ROUND(avg(a.s_score),2) as avg_score from score a<br>         left join student b on a.s_id=b.s_id GROUP BY s_id HAVING avg_score&gt;=85<br>     <br> -- 34、查询课程名称为"数学"，且分数低于60的学生姓名和分数 <br>     <br>         select a.s_name,b.s_score from score b join student a on a.s_id=b.s_id where b.c_id=(<br>                     select c_id from course where c_name ='数学') and b.s_score&lt;60</p> 
<p>-- 35、查询所有学生的课程及分数情况； <br>     <br>         <br>         select a.s_id,a.s_name,<br>                     SUM(case c.c_name when '语文' then b.s_score else 0 end) as '语文',<br>                     SUM(case c.c_name when '数学' then b.s_score else 0 end) as '数学',<br>                     SUM(case c.c_name when '英语' then b.s_score else 0 end) as '英语',<br>                     SUM(b.s_score) as  '总分'<br>         from student a left join score b on a.s_id = b.s_id <br>         left join course c on b.c_id = c.c_id <br>         GROUP BY a.s_id,a.s_name</p> 
<p><br>  -- 36、查询任何一门课程成绩在70分以上的姓名、课程名称和分数； <br>             select a.s_name,b.c_name,c.s_score from course b left join score c on b.c_id = c.c_id<br>                 left join student a on a.s_id=c.s_id where c.s_score&gt;=70</p> 
<p>        </p> 
<p>-- 37、查询不及格的课程<br>         select a.s_id,a.c_id,b.c_name,a.s_score from score a left join course b on a.c_id = b.c_id<br>             where a.s_score&lt;60 <br>         <br> --38、查询课程编号为01且课程成绩在80分以上的学生的学号和姓名； <br>         select a.s_id,b.s_name from score a LEFT JOIN student b on a.s_id = b.s_id<br>             where a.c_id = '01'    and a.s_score&gt;80</p> 
<p>-- 39、求每门课程的学生人数 <br>         select count(*) from score GROUP BY c_id;</p> 
<p>-- 40、查询选修"张三"老师所授课程的学生中，成绩最高的学生信息及其成绩</p> 
<p>        <br>         -- 查询老师id    <br>         select c_id from course c,teacher d where c.t_id=d.t_id and d.t_name='张三'<br>         -- 查询最高分（可能有相同分数）<br>         select MAX(s_score) from score where c_id='02'<br>         -- 查询信息<br>         select a.*,b.s_score,b.c_id,c.c_name from student a<br>             LEFT JOIN score b on a.s_id = b.s_id<br>             LEFT JOIN course c on b.c_id=c.c_id<br>             where b.c_id =(select c_id from course c,teacher d where c.t_id=d.t_id and d.t_name='张三')<br>             and b.s_score in (select MAX(s_score) from score where c_id='02')</p> 
<p>自己的</p> 
<p>SELECT<br>     st.*, sc.s_score<br> FROM<br>     score sc<br> JOIN course co ON sc.c_id = co.c_id<br> JOIN teacher te ON co.t_id = te.t_id<br> JOIN student st ON sc.s_id = st.s_id<br> WHERE<br>     te.t_name = '张三'<br> ORDER BY<br>     sc.s_score DESC<br> LIMIT 1;</p> 
<p><br> -- 41、查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩 <br>     select DISTINCT b.s_id,b.c_id,b.s_score from score a,score b where a.c_id != b.c_id and a.s_score = b.s_score<br>     </p> 
<p>-- 42、查询每门功成绩最好的前两名 <br>         -- 牛逼的写法<br>     select a.s_id,a.c_id,a.s_score from score a<br>         where (select COUNT(1) from score b where b.c_id=a.c_id and b.s_score&gt;=a.s_score)&lt;=2 ORDER BY a.c_id</p> 
<p><br> -- 43、统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列  <br>         select c_id,count(*) as total from score GROUP BY c_id HAVING total&gt;5 ORDER BY total,c_id ASC<br>         <br> -- 44、检索至少选修两门课程的学生学号 <br>         select s_id,count(*) as sel from score GROUP BY s_id HAVING sel&gt;=2</p> 
<p>-- 45、查询选修了全部课程的学生信息 <br>         select * from student where s_id in(        <br>             select s_id from score GROUP BY s_id HAVING count(*)=(select count(*) from course))</p> 
<p><br> --46、查询各学生的年龄<br>     -- 按照出生日期来算，当前月日 &lt; 出生年月的月日则，年龄减一</p> 
<p>    select s_birth,(DATE_FORMAT(NOW(),'%Y')-DATE_FORMAT(s_birth,'%Y') - <br>                 (case when DATE_FORMAT(NOW(),'%m%d')&gt;DATE_FORMAT(s_birth,'%m%d') then 0 else 1 end)) as age<br>         from student;</p> 
<p><br> -- 47、查询本周过生日的学生<br>     select * from student where WEEK(DATE_FORMAT(NOW(),'%Y%m%d'))=WEEK(s_birth)<br>     select * from student where YEARWEEK(s_birth)=YEARWEEK(DATE_FORMAT(NOW(),'%Y%m%d'))<br>     <br>     select WEEK(DATE_FORMAT(NOW(),'%Y%m%d'))</p> 
<p>-- 48、查询下周过生日的学生<br>     select * from student where WEEK(DATE_FORMAT(NOW(),'%Y%m%d'))+1 =WEEK(s_birth)</p> 
<p>-- 49、查询本月过生日的学生</p> 
<p>    select * from student where MONTH(DATE_FORMAT(NOW(),'%Y%m%d')) =MONTH(s_birth)</p> 
<p>自己的</p> 
<p>SELECT * FROM student WHERE DATE_FORMAT(now(),'%m') = DATE_FORMAT(s_birth,'%m');<br>     <br> -- 50、查询下月过生日的学生<br>     select * from student where MONTH(DATE_FORMAT(NOW(),'%Y%m%d'))+1 =MONTH(s_birth)</p> 
<p>自己的</p> 
<p>SELECT * FROM student WHERE (DATE_FORMAT(now(),'%m')+1) = DATE_FORMAT(s_birth,'%m');<br> ————————————————<br> 版权声明：本文为CSDN博主「启明星的指引」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。<br> 原文链接：https://blog.csdn.net/fashion2014/article/details/78826299/</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3154dd5ae80c7a954dbc6a722c916a84/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">那些你应该考虑卸载的 VSCode 扩展</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a2443a14ff80186ab7c9e46a61d1bb75/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">解决ssh无法远程连接到NAT模式的虚拟机的问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>