<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[Jsoi2016]位运算 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[Jsoi2016]位运算" />
<meta property="og:description" content="题面 &lt;center&gt; 5758: [Jsoi2016]位运算&lt;center&gt;
&lt;center&gt;时间限制:20秒 内存限制:512MB &lt;center&gt;
题目描述
JYY最近在研究位运算。他发现位运算中最有趣的就是异或（xor）运算。对于两个数的异或运算，JYY发现了一个结论：两个数的异或值为0当且仅当他们相等。于是JYY又开始思考，对于N个数的异或值会有什么性质呢？
【问题描述】
JYY想知道，如果在0到R-1的范围内，选出N个不同的整数，并使得这N个整数的异或值为0，那么一共有多少种选择的方法呢？（选择的不同次序并不作重复统计，请参见样例）JYY是一个计算机科学家，所以他脑海里的R非常非常大。为了能够方便的表达，如果我们将R写成一个0-1串，那么R是由一个较短的0-1串S重复K次得到的。比如，若S=“101”，K=2，那么R的2进制表示则为“101101”。由于计算的结果会非常大，JYY只需要你告诉他选择的总数对10^9&#43;7取模的结果即可。
输入
第一行包含两个正整数N和K。
接下来一行包含一个由0和1组成的字符串S
我们保证S的第一个字符一定为1。
3&lt;=N&lt;=7,1&lt;=k&lt;=10^5,1&lt;=|S|&lt;=50
输出
一行一个整数，表示选择的方案数对10^9&#43;7取模的值。
样例输入
3 1
100
样例输出
1
提示
对于第一个样例， 唯一的一种选择方法是选择 {1, 2, 3}。
题解 我推出了规律：所有N个数的第i位中‘1’的个数必须为偶数，才能使最终结果为0，但是接下来就没有思路了……
在网上搜了题解：题解链接，但是题解过于简单，代码也没啥注释，也许是wtcl并没有看明白，又研究了好久才搞懂，并把代码加上了注释。
大体思路是这样的：首先，定义了一个结构体用来定义矩阵，其中包括矩阵的初始化（类似于Java的构造方法）；然后定义了两个函数（方法）：矩阵的乘法和矩阵幂；以上都是辅助性质的。以下为主要内容：为实现N个数不相同，规定A~1~&lt;A~2~&lt;……&lt;A~N~，用trans函数（方法）实现，然后进行状态压缩用lim的二进制值来表示N个数每一位的取值（0 or 1），最后求出一个|s|的结果，再运用矩阵快速幂求出k个|s|的结果。
源码 #include &lt;iostream&gt; #include &lt;cstring&gt; using namespace std; const int mod=1e9&#43;7; int n,k,len,lim,f[55][130]; char s[55]; typedef unsigned long long ull; struct matrix {//矩阵结构体定义 ull a[130][130]; matrix(int t=0) {//初始化一个对角线为t,其他位置为0的矩阵 memset(a,0,sizeof(a)); for(int i=0;i&lt;=lim;i&#43;&#43;) a[i][i]=t; } }A; matrix fun(matrix a,matrix b) {//矩阵乘法 matrix c(0); for(int i=0;i&lt;=lim;i&#43;&#43;) for(int k=0;k&lt;=i;k&#43;&#43;) if(a." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/3855decf812f8a9ae98c7b4b617b8678/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-10-02T02:53:13+08:00" />
<meta property="article:modified_time" content="2019-10-02T02:53:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[Jsoi2016]位运算</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="entry-content l-h-2x" style="font-size: 16px;"> 
 <h3>题面</h3> 
 <p>&lt;center&gt; 5758: [Jsoi2016]位运算&lt;center&gt;<br>&lt;center&gt;时间限制:20秒 内存限制:512MB &lt;center&gt;</p> 
 <p><strong>题目描述</strong><br>　　JYY最近在研究位运算。他发现位运算中最有趣的就是异或（xor）运算。对于两个数的异或运算，JYY发现了一个结论：两个数的异或值为0当且仅当他们相等。于是JYY又开始思考，对于N个数的异或值会有什么性质呢？<br><strong>【问题描述】</strong><br>　　JYY想知道，如果在0到R-1的范围内，选出N个不同的整数，并使得这N个整数的异或值为0，那么一共有多少种选择的方法呢？（选择的不同次序并不作重复统计，请参见样例）JYY是一个计算机科学家，所以他脑海里的R非常非常大。为了能够方便的表达，如果我们将R写成一个0-1串，那么R是由一个较短的0-1串S重复K次得到的。比如，若S=“101”，K=2，那么R的2进制表示则为“101101”。由于计算的结果会非常大，JYY只需要你告诉他选择的总数对10^9+7取模的结果即可。<br><strong>输入</strong><br>第一行包含两个正整数N和K。<br>接下来一行包含一个由0和1组成的字符串S<br>我们保证S的第一个字符一定为1。<br>3&lt;=N&lt;=7,1&lt;=k&lt;=10^5,1&lt;=|S|&lt;=50<br><strong>输出</strong><br>一行一个整数，表示选择的方案数对10^9+7取模的值。<br><strong>样例输入</strong></p> 
 <blockquote> 
  <p>3 1<br>100</p> 
 </blockquote> 
 <p><strong>样例输出</strong></p> 
 <blockquote> 
  <p>1</p> 
 </blockquote> 
 <p>提示<br>对于第一个样例， 唯一的一种选择方法是选择 {1, 2, 3}。</p> 
 <h3>题解</h3> 
 <p>　　我推出了规律：所有N个数的第i位中‘1’的个数必须为偶数，才能使最终结果为0，但是接下来就没有思路了……<br>　　在网上搜了题解：<span class="external-link"><a href="https://blog.csdn.net/qq_35649707/article/details/79824015" target="_blank" rel="noopener noreferrer">题解链接<i></i></a></span>，但是题解过于简单，代码也没啥注释，<del>也许是wtcl</del>并没有看明白，又研究了好久才搞懂，并把代码加上了注释。<br>　　大体思路是这样的：首先，定义了一个结构体用来定义矩阵，其中包括矩阵的初始化（类似于Java的构造方法）；然后定义了两个函数（方法）：矩阵的乘法和矩阵幂；以上都是辅助性质的。以下为主要内容：为实现N个数不相同，规定A~1~&lt;A~2~&lt;……&lt;A~N~，用trans函数（方法）实现，然后进行状态压缩用lim的二进制值来表示N个数每一位的取值（0 or 1），最后求出一个|s|的结果，再运用矩阵快速幂求出k个|s|的结果。</p> 
 <h3>源码</h3> 
 <pre class="has"><code class="lang-javascript">#include &lt;iostream&gt;
#include &lt;cstring&gt;
using namespace std;
const int mod=1e9+7;
int n,k,len,lim,f[55][130];
char s[55];
typedef unsigned long long ull;
struct matrix {//矩阵结构体定义 
    ull a[130][130];
    matrix(int t=0) {//初始化一个对角线为t,其他位置为0的矩阵 
        memset(a,0,sizeof(a));
        for(int i=0;i&lt;=lim;i++) a[i][i]=t;
    } 
}A;
matrix fun(matrix a,matrix b) {//矩阵乘法 
        matrix c(0);
        for(int i=0;i&lt;=lim;i++)
            for(int k=0;k&lt;=i;k++) if(a.a[i][k])
                for(int j=0;j&lt;=k;j++)
                    ((c.a[i][j]+=(ull)a.a[i][k]*b.a[k][j]) &gt;= mod) ? c.a[i][j]%=mod : 0;
        for(int i=0;i&lt;=lim;i++)
            for(int j=0;j&lt;=i;j++)
                (c.a[i][j]&gt;=mod) &amp;&amp; (c.a[i][j]%=mod);
        return c;
    }
matrix power(matrix a,int b){//矩阵快速幂 
    matrix rs(1);
    for(;b;b&gt;&gt;=1, a=fun(a,a)) if(b&amp;1) rs=fun(rs,a);
    return rs;
}
int trans(int pre,int now,int pos) {//判断每一位的N个数是否按递增排序 
    int c=0;
    for(int j=n-1;j;j--)
        if((pre&gt;&gt;j)&amp;1) {
            int a=(now&gt;&gt;j)&amp;1, b=(now&gt;&gt;(j-1))&amp;1;
            if(a&gt;b) return -1;//此时~-1=0 
            if(a==b) c|=(1&lt;&lt;j);
        }   
    if(pre&amp;1) {
        int tl=0;
        while(tl&lt;n &amp;&amp; (pre&gt;&gt;tl)&amp;1) 
            if((now&gt;&gt;tl)&amp;1 &amp;&amp; s[pos]=='0') return -1;//此时~-1=0
            else ++tl;
        if((now&amp;1)==s[pos]-'0') c|=1;
    }
    return c;
} 
int main(int argc, char** argv) {
    cin&gt;&gt;n&gt;&gt;k&gt;&gt;(s+1);
    len=strlen(s+1);
    lim=(1&lt;&lt;n)-1;//状态压缩：用来表示n个数每一位的取值 
    for(int i=0;i&lt;=lim;i++) {
        memset(f,0,sizeof(f));
        f[0][i]=1;
        for(int j=1;j&lt;=len;++j)
            for(int pre=0;pre&lt;=lim;++pre) //之前的状态 
                for(int now=0;now&lt;=lim;++now) { //现在要放的状态 
                    if(__builtin_popcount(now)&amp;1) continue;
// __builtin_popcount获取now的二进制数中1的个数，只有1的个数为偶数时才可能取异或为0 
                    int t=trans(pre,now,j);//判断N个数的第j位是否递增 
                    if(~t) f[j][t]=(f[j][t]+f[j-1][pre])%mod;//t=-1时，~t=0,不进行 
                }      
        for(int j=0;j&lt;=lim;j++)//获取最终结果 
            A.a[i][j]=f[len][j]; 
    }
    matrix B=power(A,k);//进行矩阵快速幂 
    int ans=B.a[lim][0]%mod;//得出最后结果 
    cout&lt;&lt;ans;
    return 0; 
}</code></pre> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f56185a92773492710ba5f7d7923ccf3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">elasticsearch——Rest Client</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5795a8177e69568adcaf337e9bab1c8d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[HNOI2008]越狱</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>