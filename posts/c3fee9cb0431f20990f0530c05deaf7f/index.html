<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C&#43;&#43; day22 继承（二）基类指针数组通过虚方法实现智能的多态 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C&#43;&#43; day22 继承（二）基类指针数组通过虚方法实现智能的多态" />
<meta property="og:description" content="继承一共有三种：
公有继承私有继承保护继承 文章目录 公有继承基类和派生类的关系is-a（用公有继承表示“是一种”的关系）has-auses-ais-like-ais-implemented-as-a 多态公有继承示例出现的错误示例拓展：基类指针数组：多态，虚方法（好高级）本示例知识点总结 公有继承 基类和派生类的关系 is-a（用公有继承表示“是一种”的关系） 是一种（比如香蕉是一种水果，是水果大类的一个特例，所以水果的所有属性和方法都适用于香蕉，所以很适合使用公有继承来实现）
has-a 有一种（比如午餐中有火腿，但是不要从Lunch类派生出Meat类，而是应该把Meat类的对象作为Lunch类的数据成员，即has-a关系）
uses-a 使用一种（比如computer类使用printer类，但是从Computer类派生Printer类也是不合理的）
is-like-a 像一种（比如律师像鲨鱼，但是律师和鲨鱼是完全不一样的，这是人类习惯使用的一种明喻，所以不能从Shark类派生出Lawyer类）
is-implemented-as-a 被实现为一种（比如把栈实现为数组，但是数组的很多属性和栈不一样，比如数组有索引，所以从Array类派生出Stack类不合理，应该让Stack类包含一个私有的Array类的数据成员）
这些关系中is-a用公有继承的方式实现，其他的关系一般不使用公有继承实现，虽然也可以，但是不太合理，容易导致编程问题。
多态公有继承 前面说的简单的继承是直接使用基类方法，不改写基类方法。多态继承则要多态，表现在：
改写基类的同类方法，这里要用到虚函数。下方示例。基类方法有重载，这时候派生类如果要重写其中一个函数，就要重写基类的所有重载函数，否则会隐藏没被重写的那些。这一点在下一篇博文末尾有示例。当用类对象的引用或指针调用虚方法时，编译器动态联编，根据对象类型判断到底使用该方法的基类版本还是派生类版本。实现多态。这一点很高级。真的很智能。见下方示例拓展。还有什么多态呢？一时间想不起来 示例 //Brass.h #ifndef BRASS_H_ #define BRASS_H_ #include &lt;string&gt; class Brass{ private: std::string fullname; long account;//账户 double balance;//当前结余 public: Brass(const std::string &amp; fn = &#34;None None&#34;, long ac = -1, double ba = 0); virtual ~Brass(){}//虚析构函数 void Deposit(double amt); virtual void Withdraw(double amt); virtual void ViewAcct() const; double Balance() const {return balance;} }; #endif //Brass." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/c3fee9cb0431f20990f0530c05deaf7f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-07-31T23:16:44+08:00" />
<meta property="article:modified_time" content="2020-07-31T23:16:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C&#43;&#43; day22 继承（二）基类指针数组通过虚方法实现智能的多态</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>继承一共有三种：</p> 
<ul><li>公有继承</li><li>私有继承</li><li>保护继承</li></ul> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_7" rel="nofollow">公有继承</a></li><li><ul><li><a href="#_9" rel="nofollow">基类和派生类的关系</a></li><li><ul><li><a href="#isa_11" rel="nofollow">is-a（用公有继承表示“是一种”的关系）</a></li><li><a href="#hasa_13" rel="nofollow">has-a</a></li><li><a href="#usesa_15" rel="nofollow">uses-a</a></li><li><a href="#islikea_17" rel="nofollow">is-like-a</a></li><li><a href="#isimplementedasa_19" rel="nofollow">is-implemented-as-a</a></li></ul> 
   </li><li><a href="#_24" rel="nofollow">多态公有继承</a></li><li><ul><li><a href="#_31" rel="nofollow">示例</a></li><li><ul><li><a href="#_283" rel="nofollow">出现的错误</a></li><li><a href="#_414" rel="nofollow">示例拓展：基类指针数组：多态，虚方法（好高级）</a></li><li><a href="#_625" rel="nofollow">本示例知识点总结</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_7"></a>公有继承</h2> 
<h3><a id="_9"></a>基类和派生类的关系</h3> 
<h4><a id="isa_11"></a>is-a（用公有继承表示“是一种”的关系）</h4> 
<p>是一种（比如香蕉是一种水果，是水果大类的一个特例，所以水果的所有属性和方法都适用于香蕉，所以<strong>很适合使用公有继承来实现</strong>）</p> 
<h4><a id="hasa_13"></a>has-a</h4> 
<p>有一种（比如午餐中有火腿，但是<strong>不要从Lunch类派生出Meat类</strong>，而是应该把Meat类的对象作为Lunch类的数据成员，即has-a关系）</p> 
<h4><a id="usesa_15"></a>uses-a</h4> 
<p>使用一种（比如computer类使用printer类，但是<strong>从Computer类派生Printer类也是不合理</strong>的）</p> 
<h4><a id="islikea_17"></a>is-like-a</h4> 
<p>像一种（比如律师像鲨鱼，但是律师和鲨鱼是完全不一样的，这是人类习惯使用的一种明喻，所以<strong>不能从Shark类派生出Lawyer类</strong>）</p> 
<h4><a id="isimplementedasa_19"></a>is-implemented-as-a</h4> 
<p>被实现为一种（比如把栈实现为数组，但是数组的很多属性和栈不一样，比如数组有索引，所以<strong>从Array类派生出Stack类不合理</strong>，应该让Stack类包含一个私有的Array类的数据成员）</p> 
<p>这些关系中<strong>is-a用公有继承的方式实现</strong>，其他的关系一般不使用公有继承实现，虽然也可以，但是不太合理，容易导致编程问题。</p> 
<h3><a id="_24"></a>多态公有继承</h3> 
<p>前面说的简单的继承是直接使用基类方法，不改写基类方法。多态继承则要多态，表现在：</p> 
<ul><li>改写基类的同类方法，这里要用到虚函数。下方示例。</li><li>基类方法有重载，这时候派生类如果要重写其中一个函数，就要重写基类的所有重载函数，否则会隐藏没被重写的那些。这一点在下一篇博文末尾有示例。</li><li>当用类对象的引用或指针调用虚方法时，编译器动态联编，根据对象类型判断到底使用该方法的基类版本还是派生类版本。实现多态。这一点很高级。真的很智能。见下方示例拓展。</li><li>还有什么多态呢？一时间想不起来</li></ul> 
<h4><a id="_31"></a>示例</h4> 
<pre><code class="prism language-cpp"><span class="token comment">//Brass.h</span>
<span class="token macro property">#<span class="token directive keyword">ifndef</span> BRASS_H_</span>
<span class="token macro property">#<span class="token directive keyword">define</span> BRASS_H_</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

<span class="token keyword">class</span> <span class="token class-name">Brass</span><span class="token punctuation">{<!-- --></span>
<span class="token keyword">private</span><span class="token operator">:</span>
	std<span class="token operator">::</span>string fullname<span class="token punctuation">;</span>
	<span class="token keyword">long</span> account<span class="token punctuation">;</span><span class="token comment">//账户</span>
	<span class="token keyword">double</span> balance<span class="token punctuation">;</span><span class="token comment">//当前结余</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Brass</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span> fn <span class="token operator">=</span> <span class="token string">"None None"</span><span class="token punctuation">,</span> <span class="token keyword">long</span> ac <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">double</span> ba <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Brass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token comment">//虚析构函数</span>
	<span class="token keyword">void</span> <span class="token function">Deposit</span><span class="token punctuation">(</span><span class="token keyword">double</span> amt<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Withdraw</span><span class="token punctuation">(</span><span class="token keyword">double</span> amt<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> <span class="token function">Balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span><span class="token keyword">return</span> balance<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
</code></pre> 
<pre><code class="prism language-cpp"><span class="token comment">//Brass.cpp</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Brass.h"</span></span>

<span class="token keyword">typedef</span> std<span class="token operator">::</span>ios_base<span class="token operator">::</span>fmtflags format<span class="token punctuation">;</span><span class="token comment">//fmtflags,格式标志</span>
<span class="token keyword">typedef</span> std<span class="token operator">::</span>streamsize precis<span class="token punctuation">;</span><span class="token comment">//流的规模大小，即精度，位数</span>
format <span class="token function">setFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">restore</span><span class="token punctuation">(</span>format f<span class="token punctuation">,</span> precis p<span class="token punctuation">)</span><span class="token punctuation">;</span>

Brass<span class="token operator">::</span><span class="token function">Brass</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span> fn<span class="token punctuation">,</span> <span class="token keyword">long</span> ac<span class="token punctuation">,</span> <span class="token keyword">double</span> ba<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//std::cout &lt;&lt; "call Brass::Brass(const std::string &amp; fn, long ac, double ba)\n";</span>
	fullname <span class="token operator">=</span> fn<span class="token punctuation">;</span>
	account <span class="token operator">=</span> ac<span class="token punctuation">;</span>
	balance <span class="token operator">=</span> ba<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//Brass:Brass(std::string &amp; fn = "None None", long ac = -1, double ba = 0.0):fullname(fn),account(ac),balance(ba){}</span>

<span class="token keyword">void</span> Brass<span class="token operator">::</span><span class="token function">Deposit</span><span class="token punctuation">(</span><span class="token keyword">double</span> amt<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>amt <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Failure! Negative deposit not allowed!\n"</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		balance <span class="token operator">+</span><span class="token operator">=</span> amt<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Brass<span class="token operator">::</span><span class="token function">Withdraw</span><span class="token punctuation">(</span><span class="token keyword">double</span> amt<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	format initialState <span class="token operator">=</span> <span class="token function">setFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	precis prec <span class="token operator">=</span> std<span class="token operator">::</span>cout<span class="token punctuation">.</span><span class="token function">precision</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>amt <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Withdraw amount must be positive!\n"</span>
				  <span class="token operator">&lt;&lt;</span> <span class="token string">"Withdraw cancelled!\n"</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>amt <span class="token operator">&lt;=</span> balance<span class="token punctuation">)</span>
		balance <span class="token operator">-</span><span class="token operator">=</span> amt<span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Withdraw amount of $"</span> <span class="token operator">&lt;&lt;</span> amt
				  <span class="token operator">&lt;&lt;</span> <span class="token string">" exceeds your balance.\n"</span>
				  <span class="token operator">&lt;&lt;</span> <span class="token string">"Withdraw cancelled!\n"</span><span class="token punctuation">;</span>

	<span class="token function">restore</span><span class="token punctuation">(</span>initialState<span class="token punctuation">,</span> prec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Brass<span class="token operator">::</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	format initialState <span class="token operator">=</span> <span class="token function">setFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	precis prec <span class="token operator">=</span> std<span class="token operator">::</span>cout<span class="token punctuation">.</span><span class="token function">precision</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Client: "</span> <span class="token operator">&lt;&lt;</span> fullname <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span>
		      <span class="token operator">&lt;&lt;</span> <span class="token string">"Account number: "</span> <span class="token operator">&lt;&lt;</span> account <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span>
		      <span class="token operator">&lt;&lt;</span> <span class="token string">"Balance: $"</span> <span class="token operator">&lt;&lt;</span> balance <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
	<span class="token function">restore</span><span class="token punctuation">(</span>initialState<span class="token punctuation">,</span> prec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">//自定义格式辅助函数</span>
format <span class="token function">setFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//set up ###.## format</span>
	<span class="token comment">//设置为定点表示法，返回当前格式的标记</span>
	<span class="token keyword">return</span> std<span class="token operator">::</span>cout<span class="token punctuation">.</span><span class="token function">setf</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ios_base<span class="token operator">::</span>fixed<span class="token punctuation">,</span> std<span class="token operator">::</span>ios_base<span class="token operator">::</span>floatfield<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">restore</span><span class="token punctuation">(</span>format f<span class="token punctuation">,</span> precis p<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//重置输出格式和精度</span>
	<span class="token comment">//恢复格式</span>
	std<span class="token operator">::</span>cout<span class="token punctuation">.</span><span class="token function">setf</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> std<span class="token operator">::</span>ios_base<span class="token operator">::</span>floatfield<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//恢复精度</span>
	std<span class="token operator">::</span>cout<span class="token punctuation">.</span><span class="token function">precision</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-cpp"><span class="token comment">//BrassPlus.h</span>
<span class="token macro property">#<span class="token directive keyword">ifndef</span> BRASSPLUS_H_</span>
<span class="token macro property">#<span class="token directive keyword">define</span> BRASSPLUS_H_</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Brass.h"</span></span>

<span class="token keyword">class</span> <span class="token class-name">BrassPlus</span><span class="token operator">:</span> <span class="token keyword">public</span> Brass <span class="token comment">//is-a关系，公有继承</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">double</span> maxLoan<span class="token punctuation">;</span><span class="token comment">//透支上限</span>
	<span class="token keyword">double</span> rate<span class="token punctuation">;</span><span class="token comment">//透支利率</span>
	<span class="token keyword">double</span> owesBank<span class="token punctuation">;</span><span class="token comment">//透支总额,即透支数额加利息</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">BrassPlus</span><span class="token punctuation">(</span><span class="token keyword">const</span> Brass <span class="token operator">&amp;</span> ba<span class="token punctuation">,</span> <span class="token keyword">double</span> max <span class="token operator">=</span> <span class="token number">500.0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> r <span class="token operator">=</span> <span class="token number">0.11125</span><span class="token punctuation">,</span> <span class="token keyword">double</span> owe <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Brass</span><span class="token punctuation">(</span>ba<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">maxLoan</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">rate</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">owesBank</span><span class="token punctuation">(</span>owe<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	<span class="token comment">//把fn, ac, ba写在前面，和基类Brass(std::string fn = "None None", long ac = 0, double ba = 0);一样，防止出问题</span>
	<span class="token function">BrassPlus</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string fn <span class="token operator">=</span> <span class="token string">"None None"</span><span class="token punctuation">,</span> <span class="token keyword">long</span> ac <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">double</span> ba <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> max <span class="token operator">=</span> <span class="token number">500.0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> r <span class="token operator">=</span> <span class="token number">0.11125</span><span class="token punctuation">,</span> <span class="token keyword">double</span> owe <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Brass</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> ac<span class="token punctuation">,</span> ba<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">maxLoan</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">rate</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">owesBank</span><span class="token punctuation">(</span>owe<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">BrassPlus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token comment">//虚方法</span>
	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Withdraw</span><span class="token punctuation">(</span><span class="token keyword">double</span> amt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//虚方法</span>
	<span class="token keyword">void</span> <span class="token function">ResetMaxLoan</span><span class="token punctuation">(</span><span class="token keyword">double</span> max<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>maxLoan <span class="token operator">=</span> max<span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">ResetRate</span><span class="token punctuation">(</span><span class="token keyword">double</span> r<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>rate <span class="token operator">=</span> r<span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">ResetOwesBank</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>owesBank <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">//默认还款一次还清</span>
	<span class="token keyword">double</span> <span class="token function">OwesBank</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span><span class="token keyword">return</span> owesBank<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
</code></pre> 
<pre><code class="prism language-cpp"><span class="token comment">//BrassPlus.cpp</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BrassPlus.h"</span></span>
<span class="token keyword">typedef</span> std<span class="token operator">::</span>ios_base<span class="token operator">::</span>fmtflags format<span class="token punctuation">;</span><span class="token comment">//fmtflags,格式标志</span>
<span class="token keyword">typedef</span> std<span class="token operator">::</span>streamsize precis<span class="token punctuation">;</span><span class="token comment">//流的规模大小，即精度，位数</span>
format <span class="token function">setFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">restore</span><span class="token punctuation">(</span>format f<span class="token punctuation">,</span> precis p<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">void</span> BrassPlus<span class="token operator">::</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token comment">//虚方法</span>
<span class="token punctuation">{<!-- --></span>
	format initialState <span class="token operator">=</span> <span class="token function">setFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	precis prec <span class="token operator">=</span> std<span class="token operator">::</span>cout<span class="token punctuation">.</span><span class="token function">precision</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/*
		std::cout &lt;&lt; "Client: " &lt;&lt; fullname &lt;&lt; '\n'
		      &lt;&lt; "Account number: " &lt;&lt; account &lt;&lt; '\n'
		      &lt;&lt; "Balance: $" &lt;&lt; balance &lt;&lt; '\n';
	*/</span>
	Brass<span class="token operator">::</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//直接调用基类的viewacct方法即可，重用代码</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Maximum loan: $"</span> <span class="token operator">&lt;&lt;</span> maxLoan <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span>
		      <span class="token operator">&lt;&lt;</span> <span class="token string">"Owed to bank: $"</span> <span class="token operator">&lt;&lt;</span> owesBank <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
	std<span class="token operator">::</span>cout<span class="token punctuation">.</span><span class="token function">precision</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Loan rate: "</span> <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> rate <span class="token operator">&lt;&lt;</span> <span class="token string">"%\n"</span><span class="token punctuation">;</span>
	<span class="token function">restore</span><span class="token punctuation">(</span>initialState<span class="token punctuation">,</span> prec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> BrassPlus<span class="token operator">::</span><span class="token function">Withdraw</span><span class="token punctuation">(</span><span class="token keyword">double</span> amt<span class="token punctuation">)</span><span class="token comment">//虚方法</span>
<span class="token punctuation">{<!-- --></span>
	format initialState <span class="token operator">=</span> <span class="token function">setFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	precis prec <span class="token operator">=</span> std<span class="token operator">::</span>cout<span class="token punctuation">.</span><span class="token function">precision</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">double</span> bal <span class="token operator">=</span> <span class="token function">Balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>amt <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Withdraw amount must be positive!\n"</span>
				  <span class="token operator">&lt;&lt;</span> <span class="token string">"Withdraw cancelled!\n"</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>amt <span class="token operator">&lt;=</span> bal<span class="token punctuation">)</span><span class="token comment">//不可写amt &lt;= balance，因为不能直接访问基类数据成员</span>
		Brass<span class="token operator">::</span><span class="token function">Withdraw</span><span class="token punctuation">(</span>amt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//不可写balance -= amt;</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>amt <span class="token operator">-</span> bal <span class="token operator">+</span> owesBank <span class="token operator">&lt;=</span> maxLoan<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">double</span> advance <span class="token operator">=</span> amt <span class="token operator">-</span> bal<span class="token punctuation">;</span>
		owesBank <span class="token operator">+</span><span class="token operator">=</span> advance <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">+</span> rate<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//rate是BrassPlus类的私有成员</span>
		std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Bank advance: $"</span> <span class="token operator">&lt;&lt;</span> advance <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
		std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Finance charge: $"</span> <span class="token operator">&lt;&lt;</span> advance <span class="token operator">*</span> rate <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
		<span class="token comment">//分两步实现扣除账户全部余额（由于基类不允许取款金额超出余额，所以只能先存再取）</span>
		<span class="token function">Deposit</span><span class="token punctuation">(</span>advance<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//放贷</span>
		Brass<span class="token operator">::</span><span class="token function">Withdraw</span><span class="token punctuation">(</span>amt<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
		std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Credit limit exceeded. Transaction cancelled.\n"</span><span class="token punctuation">;</span>

	<span class="token function">restore</span><span class="token punctuation">(</span>initialState<span class="token punctuation">,</span> prec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-cpp"><span class="token comment">//main.cpp</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Brass.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BrassPlus.h"</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    Brass a<span class="token punctuation">;</span>
	Brass <span class="token function">Piggy</span><span class="token punctuation">(</span><span class="token string">"Porcelot Pigg"</span><span class="token punctuation">,</span> <span class="token number">381299</span><span class="token punctuation">,</span> <span class="token number">4000.00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	BrassPlus <span class="token function">Hoggy</span><span class="token punctuation">(</span><span class="token string">"Hoartio Hogg"</span><span class="token punctuation">,</span> <span class="token number">382288</span><span class="token punctuation">,</span> <span class="token number">3000.00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	Piggy<span class="token punctuation">.</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
	Hoggy<span class="token punctuation">.</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>

	Hoggy<span class="token punctuation">.</span><span class="token function">Deposit</span><span class="token punctuation">(</span><span class="token number">1000.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Hoggy<span class="token punctuation">.</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
	Piggy<span class="token punctuation">.</span><span class="token function">Withdraw</span><span class="token punctuation">(</span><span class="token number">4200.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Piggy<span class="token punctuation">.</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
	Hoggy<span class="token punctuation">.</span><span class="token function">Withdraw</span><span class="token punctuation">(</span><span class="token number">4200.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Hoggy<span class="token punctuation">.</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>输出</p> 
<pre><code class="prism language-cpp">Client<span class="token operator">:</span> Porcelot Pigg
Account number<span class="token operator">:</span> <span class="token number">381299</span>
Balance<span class="token operator">:</span> $<span class="token number">4000.00</span>

Client<span class="token operator">:</span> Hoartio Hogg
Account number<span class="token operator">:</span> <span class="token number">382288</span>
Balance<span class="token operator">:</span> $<span class="token number">3000.00</span>
Maximum loan<span class="token operator">:</span> $<span class="token number">500.00</span>
Owed to bank<span class="token operator">:</span> $<span class="token number">0.00</span>
Loan rate<span class="token operator">:</span> <span class="token number">11.125</span><span class="token operator">%</span>

Client<span class="token operator">:</span> Hoartio Hogg
Account number<span class="token operator">:</span> <span class="token number">382288</span>
Balance<span class="token operator">:</span> $<span class="token number">4000.00</span>
Maximum loan<span class="token operator">:</span> $<span class="token number">500.00</span>
Owed to bank<span class="token operator">:</span> $<span class="token number">0.00</span>
Loan rate<span class="token operator">:</span> <span class="token number">11.125</span><span class="token operator">%</span>

Withdraw amount of $<span class="token number">4200.00</span> exceeds your balance<span class="token punctuation">.</span>
Withdraw cancelled<span class="token operator">!</span>
Client<span class="token operator">:</span> Porcelot Pigg
Account number<span class="token operator">:</span> <span class="token number">381299</span>
Balance<span class="token operator">:</span> $<span class="token number">4000.00</span>

Bank advance<span class="token operator">:</span> $<span class="token number">200.00</span>
Finance charge<span class="token operator">:</span> $<span class="token number">22.25</span>
Client<span class="token operator">:</span> Hoartio Hogg
Account number<span class="token operator">:</span> <span class="token number">382288</span>
Balance<span class="token operator">:</span> $<span class="token number">0.00</span>
Maximum loan<span class="token operator">:</span> $<span class="token number">500.00</span>
Owed to bank<span class="token operator">:</span> $<span class="token number">222.25</span>
Loan rate<span class="token operator">:</span> <span class="token number">11.125</span><span class="token operator">%</span>
</code></pre> 
<h5><a id="_283"></a>出现的错误</h5> 
<ul><li>把字符串常量（右值）赋给string &amp;, 报错，既然这里默认参数是字符串右值，那这里就只能用string类型，而不能用string &amp;</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">Brass</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string <span class="token operator">&amp;</span> fn <span class="token operator">=</span> <span class="token string">"None None"</span><span class="token punctuation">,</span> <span class="token keyword">long</span> ac <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">double</span> ba <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>如果把string &amp; 改为const string &amp;，则也可以，我用了这个方法</p> 
<pre><code class="prism language-cpp"><span class="token function">Brass</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span> fn <span class="token operator">=</span> <span class="token string">"None None"</span><span class="token punctuation">,</span> <span class="token keyword">long</span> ac <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">double</span> ba <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>注意派生类构造函数的参数顺序，要<strong>把基类的参数放在前面</strong>，这样如果调用派生类构造函数但只传入基类所需要的的参数，则也不会报错。<br> 比如在下面示例中，应该把fn, ac, ba写在前面，和基类Brass(std::string fn = “None None”, long ac = 0, double ba = 0);一样，否则主程序中使用BrassPlus Hoggy(“Hoartio Hogg”, 382288, 3000.00);创建派生类对象就会出错，因为找不到匹配原型。</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">BrassPlus</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string fn <span class="token operator">=</span> <span class="token string">"None None"</span><span class="token punctuation">,</span> <span class="token keyword">long</span> ac <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">double</span> ba <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> max <span class="token operator">=</span> <span class="token number">500.0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> r <span class="token operator">=</span> <span class="token number">0.11125</span><span class="token punctuation">,</span> <span class="token keyword">double</span> owe <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Brass</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> ac<span class="token punctuation">,</span> ba<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">maxLoan</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">rate</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">owesBank</span><span class="token punctuation">(</span>owe<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
</code></pre> 
<ul><li>多文件程序的<mark>链接</mark>问题：我的四个文件竟然没有添加在项目中·········于是一直报这种错误：<br> <img src="https://images2.imgbox.com/4a/ab/1HSC4sJb_o.png" alt="在这里插入图片描述"></li></ul> 
<p>这些方法不能用，未定义引用等等</p> 
<p>我到处找问题，把代码又好好过目一遍，确实没问题，最后实在没辙了着急了，开始怀疑到是不是没加到项目里，终于解决了<br> 对文件右键，看到这个选项，说明根本不在项目里，于是编译就没有编译它，或者说链接没有把这个文件的机器码和程序其他部分链接在一起，所以主程序中调用这个文件中的方法出现undefine reference错误。说白了本质上，是<strong>没有把整个程序的所有翻译单元链接到一起。</strong><br> <img src="https://images2.imgbox.com/fb/6b/PM4WfTrm_o.png" alt="在这里插入图片描述"><br> 对文件名右键，出现这个remove选项就表示该文件被添加到项目里的，会被链接到一起<br> <img src="https://images2.imgbox.com/14/95/0yKF8RpF_o.png" alt="在这里插入图片描述"></p> 
<ul><li> <p>使用ios_base但忘记导入iostream头文件，即之前没写第一个红框，报错<br> <img src="https://images2.imgbox.com/ae/cd/z6Im6mFm_o.png" alt="在这里插入图片描述"></p> </li><li> <p>忘记在派生类BrassPlus的构造函数中给它的owesBank私有成员赋初始值。因为我当时想着欠银行多少钱要后面计算才知道，一时忘记了创建派生类对象时应该将其初始化为0，毕竟一开户总不能欠钱。由于我没初始化，后面主程序执行结果：</p> </li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">//正确版</span>
<span class="token function">BrassPlus</span><span class="token punctuation">(</span><span class="token keyword">const</span> Brass <span class="token operator">&amp;</span> ba<span class="token punctuation">,</span> <span class="token keyword">double</span> max <span class="token operator">=</span> <span class="token number">500.0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> r <span class="token operator">=</span> <span class="token number">0.11125</span><span class="token punctuation">,</span> <span class="token keyword">double</span> owe <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Brass</span><span class="token punctuation">(</span>ba<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">maxLoan</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">rate</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">owesBank</span><span class="token punctuation">(</span>owe<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token function">BrassPlus</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string fn <span class="token operator">=</span> <span class="token string">"None None"</span><span class="token punctuation">,</span> <span class="token keyword">long</span> ac <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">double</span> ba <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> max <span class="token operator">=</span> <span class="token number">500.0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> r <span class="token operator">=</span> <span class="token number">0.11125</span><span class="token punctuation">,</span> <span class="token keyword">double</span> owe <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Brass</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> ac<span class="token punctuation">,</span> ba<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">maxLoan</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">rate</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">owesBank</span><span class="token punctuation">(</span>owe<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

<span class="token comment">//错误版</span>
<span class="token function">BrassPlus</span><span class="token punctuation">(</span><span class="token keyword">const</span> Brass <span class="token operator">&amp;</span> ba<span class="token punctuation">,</span> <span class="token keyword">double</span> max <span class="token operator">=</span> <span class="token number">500.0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> r <span class="token operator">=</span> <span class="token number">0.11125</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Brass</span><span class="token punctuation">(</span>ba<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">maxLoan</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">rate</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token function">BrassPlus</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string fn <span class="token operator">=</span> <span class="token string">"None None"</span><span class="token punctuation">,</span> <span class="token keyword">long</span> ac <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">double</span> ba <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> max <span class="token operator">=</span> <span class="token number">500.0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> r <span class="token operator">=</span> <span class="token number">0.11125</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Brass</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> ac<span class="token punctuation">,</span> ba<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">maxLoan</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">rate</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
</code></pre> 
<p>后果，欠银行的钱成了那个8字节内存块的当前值，未知，对后面的计算则造成很大的错误</p> 
<pre><code class="prism language-cpp">Client<span class="token operator">:</span> Porcelot Pigg
Account number<span class="token operator">:</span> <span class="token number">381299</span>
Balance<span class="token operator">:</span> $<span class="token number">4000.00</span>

Client<span class="token operator">:</span> Hoartio Hogg
Account number<span class="token operator">:</span> <span class="token number">382288</span>
Balance<span class="token operator">:</span> $<span class="token number">3000.00</span>
Maximum loan<span class="token operator">:</span> $<span class="token number">500.00</span>
Owed to bank<span class="token operator">:</span> $<span class="token operator">-</span><span class="token number">29550982773929114482976296534016.00</span>
Loan rate<span class="token operator">:</span> <span class="token number">11.125</span><span class="token operator">%</span>

Client<span class="token operator">:</span> Hoartio Hogg
Account number<span class="token operator">:</span> <span class="token number">382288</span>
Balance<span class="token operator">:</span> $<span class="token number">4000.00</span>
Maximum loan<span class="token operator">:</span> $<span class="token number">500.00</span>
Owed to bank<span class="token operator">:</span> $<span class="token operator">-</span><span class="token number">29550982773929114482976296534016.00</span>
Loan rate<span class="token operator">:</span> <span class="token number">11.125</span><span class="token operator">%</span>

Withdraw amount of $<span class="token number">4200.00</span> exceeds your balance<span class="token punctuation">.</span>
Withdraw cancelled<span class="token operator">!</span>
Client<span class="token operator">:</span> Porcelot Pigg
Account number<span class="token operator">:</span> <span class="token number">381299</span>
Balance<span class="token operator">:</span> $<span class="token number">4000.00</span>

Bank advance<span class="token operator">:</span> $<span class="token number">200.00</span>
Finance charge<span class="token operator">:</span> $<span class="token number">22.25</span>
Client<span class="token operator">:</span> Hoartio Hogg
Account number<span class="token operator">:</span> <span class="token number">382288</span>
Balance<span class="token operator">:</span> $<span class="token number">0.00</span>
Maximum loan<span class="token operator">:</span> $<span class="token number">500.00</span>
Owed to bank<span class="token operator">:</span> $<span class="token operator">-</span><span class="token number">29550982773929114482976296534016.00</span>
Loan rate<span class="token operator">:</span> <span class="token number">11.125</span><span class="token operator">%</span>
</code></pre> 
<ul><li>函数和变量命名不够贴切，短小</li></ul> 
<p>这个不算是错误，但是还是要修炼</p> 
<p>我之前对透支上限的变量名是overdraftLimit, 利率是overdraftInterest, 欠款金额是overdraftAmount<br> 很长，不方便，也不好看<br> 例程用的是maxLoan, rate, owesBank,就很短小</p> 
<p>返回欠款金额的方法,以及显示账户的方法，我的命名是 overAmount，showAccount<br> 例程用的是OwesBank, ViewAcct<br> 感觉还是例程的更好，更简短</p> 
<p>另外我发现，例程喜欢把<strong>变量名</strong>的首字母小写，后面每个单词的首字母大写；<strong>方法名</strong>的所有首字母都大写。<br> 这样的好处是，如果类的一个私有成员是balance,那么用于返回这个私有数据成员的值的公有方法的名字就是Balance(),这样一看就知道这个方法干嘛的，也方便使用。</p> 
<ul><li>书写不规范，格式不好看</li></ul> 
<p>这个不算是错误，但是我通过这次写这个银行账户的类，发现我的ViewAcct()方法，一是没有设置输出格式，客户查询金额会格式乱七八糟；二是在输出多条消息时，我没有注意让代码工整好看，有多长写多长。</p> 
<p>我的</p> 
<pre><code class="prism language-cpp">std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Withdraw amount of $"</span> <span class="token operator">&lt;&lt;</span> amt <span class="token operator">&lt;&lt;</span> <span class="token string">" exceeds your balance.\n"</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"Withdraw cancelled!\n"</span><span class="token punctuation">;</span>
</code></pre> 
<p>例程</p> 
<pre><code class="prism language-cpp">std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Withdraw amount of $"</span> <span class="token operator">&lt;&lt;</span> amt
		  <span class="token operator">&lt;&lt;</span> <span class="token string">" exceeds your balance.\n"</span>
		  <span class="token operator">&lt;&lt;</span> <span class="token string">"Withdraw cancelled!\n"</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>没有时刻做到代码重用</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> BrassPlus<span class="token operator">::</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token comment">//虚方法</span>
<span class="token punctuation">{<!-- --></span>
	format initialState <span class="token operator">=</span> <span class="token function">setFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	precis prec <span class="token operator">=</span> std<span class="token operator">::</span>cout<span class="token punctuation">.</span><span class="token function">precision</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/*
	//没重用代码，写了三行重复代码，这很不好
		std::cout &lt;&lt; "Client: " &lt;&lt; fullname &lt;&lt; '\n'
		      &lt;&lt; "Account number: " &lt;&lt; account &lt;&lt; '\n'
		      &lt;&lt; "Balance: $" &lt;&lt; balance &lt;&lt; '\n';
	*/</span>
	Brass<span class="token operator">::</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//直接调用基类的viewacct方法即可，重用代码</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Maximum loan: $"</span> <span class="token operator">&lt;&lt;</span> maxLoan <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span>
		      <span class="token operator">&lt;&lt;</span> <span class="token string">"Owed to bank: $"</span> <span class="token operator">&lt;&lt;</span> owesBank <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
	std<span class="token operator">::</span>cout<span class="token punctuation">.</span><span class="token function">precision</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Loan rate: "</span> <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> rate <span class="token operator">&lt;&lt;</span> <span class="token string">"%\n"</span><span class="token punctuation">;</span>
	<span class="token function">restore</span><span class="token punctuation">(</span>initialState<span class="token punctuation">,</span> prec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="_414"></a>示例拓展：基类指针数组：多态，虚方法（好高级）</h5> 
<p>建立一个Brass指针数组，每个元素都是一个Brass指针，可以指向Brass对象，也可以指向BrassPlus类对象</p> 
<p>在用这些指针调用方法时，如果是虚方法，则方法会根据指针指向的<strong>对象的类型</strong>，<strong>而不是指针类型</strong>来判断到底调用Brass类的方法还是BrassPlus类的方法。</p> 
<p>这样子，在遍历数组元素，依次调用数组每一个元素时，代码都一样，却会调用不同的方法，从而实现了多态。很牛逼</p> 
<pre><code class="prism language-cpp"><span class="token comment">//基类</span>
<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> Brass<span class="token operator">::</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	format initialState <span class="token operator">=</span> <span class="token function">setFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	precis prec <span class="token operator">=</span> std<span class="token operator">::</span>cout<span class="token punctuation">.</span><span class="token function">precision</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Client: "</span> <span class="token operator">&lt;&lt;</span> fullname <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span>
		      <span class="token operator">&lt;&lt;</span> <span class="token string">"Account number: "</span> <span class="token operator">&lt;&lt;</span> account <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span>
		      <span class="token operator">&lt;&lt;</span> <span class="token string">"Balance: $"</span> <span class="token operator">&lt;&lt;</span> balance <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
	<span class="token function">restore</span><span class="token punctuation">(</span>initialState<span class="token punctuation">,</span> prec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//派生类</span>
<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> BrassPlus<span class="token operator">::</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	format initialState <span class="token operator">=</span> <span class="token function">setFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	precis prec <span class="token operator">=</span> std<span class="token operator">::</span>cout<span class="token punctuation">.</span><span class="token function">precision</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Brass<span class="token operator">::</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//直接调用基类的viewacct方法即可，重用代码</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Maximum loan: $"</span> <span class="token operator">&lt;&lt;</span> maxLoan <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span>
		      <span class="token operator">&lt;&lt;</span> <span class="token string">"Owed to bank: $"</span> <span class="token operator">&lt;&lt;</span> owesBank <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
	std<span class="token operator">::</span>cout<span class="token punctuation">.</span><span class="token function">precision</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Loan rate: "</span> <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> rate <span class="token operator">&lt;&lt;</span> <span class="token string">"%\n"</span><span class="token punctuation">;</span>
	<span class="token function">restore</span><span class="token punctuation">(</span>initialState<span class="token punctuation">,</span> prec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-cpp"><span class="token comment">//main.cpp</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Brass.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BrassPlus.h"</span></span>
<span class="token keyword">const</span> <span class="token keyword">int</span> NUM <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">eatline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span>
	<span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span>

    Brass <span class="token operator">*</span> p_clients<span class="token punctuation">[</span>NUM<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//基类指针数组</span>
    std<span class="token operator">::</span>string tempName<span class="token punctuation">;</span>
	<span class="token keyword">long</span> tempAcct<span class="token punctuation">;</span>
	<span class="token keyword">double</span> openBal<span class="token punctuation">;</span>
	<span class="token keyword">char</span> kind<span class="token punctuation">;</span><span class="token comment">//会员种类，普通会员或plus会员</span>

	<span class="token keyword">int</span> i<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> NUM<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter client's name: "</span><span class="token punctuation">;</span>
		<span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> tempName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//eatline();</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter client's accout number: "</span><span class="token punctuation">;</span>
        cin <span class="token operator">&gt;&gt;</span> tempAcct<span class="token punctuation">;</span>
		<span class="token function">eatline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter opening balance: $"</span><span class="token punctuation">;</span>
		cin <span class="token operator">&gt;&gt;</span> openBal<span class="token punctuation">;</span>
		<span class="token function">eatline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter 1 for Brass Account or 2 for BrassPlus Account："</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>kind <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'1'</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>kind <span class="token operator">!=</span> <span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token function">eatline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//否则换行符会被读取为下一个客户的名字</span>


		<span class="token keyword">if</span> <span class="token punctuation">(</span>kind <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            p_clients<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Brass</span><span class="token punctuation">(</span>tempName<span class="token punctuation">,</span> tempAcct<span class="token punctuation">,</span> openBal<span class="token punctuation">)</span><span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>kind <span class="token operator">==</span> <span class="token string">'2'</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter the overdraft limit: "</span><span class="token punctuation">;</span>
			<span class="token keyword">double</span> tempLimit<span class="token punctuation">;</span>
			cin <span class="token operator">&gt;&gt;</span> tempLimit<span class="token punctuation">;</span>
			<span class="token function">eatline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter the interest rate: "</span><span class="token punctuation">;</span>
			<span class="token keyword">double</span> tempRate<span class="token punctuation">;</span>
			cin <span class="token operator">&gt;&gt;</span> tempRate<span class="token punctuation">;</span>
			<span class="token function">eatline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			p_clients<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BrassPlus</span><span class="token punctuation">(</span>tempName<span class="token punctuation">,</span> tempAcct<span class="token punctuation">,</span> openBal<span class="token punctuation">,</span> tempLimit<span class="token punctuation">,</span> tempRate<span class="token punctuation">)</span><span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


	<span class="token punctuation">}</span>
	<span class="token comment">//显示四位顾客的信息</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> NUM<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	    cout <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
		p_clients<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">ViewAcct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//展示多态特性的核心代码</span>
		<span class="token keyword">delete</span> p_clients<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//总是记不住delete</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">eatline</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
        <span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>输出</p> 
<pre><code class="prism language-cpp">Enter client's name<span class="token operator">:</span> Mary Hellen
Enter client's accout number<span class="token operator">:</span> <span class="token number">123456</span>
Enter opening balance<span class="token operator">:</span> $<span class="token number">4815</span>
Enter <span class="token number">1</span> <span class="token keyword">for</span> Brass Account <span class="token operator">or</span> <span class="token number">2</span> <span class="token keyword">for</span> BrassPlus Account：<span class="token number">1</span>

Enter client's name<span class="token operator">:</span> Julie Rechard
Enter client's accout number<span class="token operator">:</span> <span class="token number">465565</span>
Enter opening balance<span class="token operator">:</span> $<span class="token number">1235</span>
Enter <span class="token number">1</span> <span class="token keyword">for</span> Brass Account <span class="token operator">or</span> <span class="token number">2</span> <span class="token keyword">for</span> BrassPlus Account：<span class="token number">2</span>
Enter the overdraft limit<span class="token operator">:</span> <span class="token number">400</span>
Enter the interest rate<span class="token operator">:</span> <span class="token number">0.15</span>

Enter client's name<span class="token operator">:</span> Debbie Gallager
Enter client's accout number<span class="token operator">:</span> <span class="token number">128796</span>
Enter opening balance<span class="token operator">:</span> $<span class="token number">4865</span>
Enter <span class="token number">1</span> <span class="token keyword">for</span> Brass Account <span class="token operator">or</span> <span class="token number">2</span> <span class="token keyword">for</span> BrassPlus Account：<span class="token number">2</span>
Enter the overdraft limit<span class="token operator">:</span> <span class="token number">89745</span>
Enter the interest rate<span class="token operator">:</span> <span class="token number">0.25</span>

Enter client's name<span class="token operator">:</span> Steeve Green
Enter client's accout number<span class="token operator">:</span> <span class="token number">782169</span>
Enter opening balance<span class="token operator">:</span> $<span class="token number">458664</span>
Enter <span class="token number">1</span> <span class="token keyword">for</span> Brass Account <span class="token operator">or</span> <span class="token number">2</span> <span class="token keyword">for</span> BrassPlus Account：<span class="token number">1</span>


Client<span class="token operator">:</span> Mary Hellen
Account number<span class="token operator">:</span> <span class="token number">123456</span>
Balance<span class="token operator">:</span> $<span class="token number">4815.00</span>

Client<span class="token operator">:</span> Julie Rechard
Account number<span class="token operator">:</span> <span class="token number">465565</span>
Balance<span class="token operator">:</span> $<span class="token number">1235.00</span>
Maximum loan<span class="token operator">:</span> $<span class="token number">400.00</span>
Owed to bank<span class="token operator">:</span> $<span class="token number">0.00</span>
Loan rate<span class="token operator">:</span> <span class="token number">15.000</span><span class="token operator">%</span>

Client<span class="token operator">:</span> Debbie Gallager
Account number<span class="token operator">:</span> <span class="token number">128796</span>
Balance<span class="token operator">:</span> $<span class="token number">4865.00</span>
Maximum loan<span class="token operator">:</span> $<span class="token number">89745.00</span>
Owed to bank<span class="token operator">:</span> $<span class="token number">0.00</span>
Loan rate<span class="token operator">:</span> <span class="token number">25.000</span><span class="token operator">%</span>

Client<span class="token operator">:</span> Steeve Green
Account number<span class="token operator">:</span> <span class="token number">782169</span>
Balance<span class="token operator">:</span> $<span class="token number">458664.00</span>
</code></pre> 
<p>如果把Brass类的ViewAcct方法的virtual关键字（这其实就默认BrassPlus类的ViewAcct方法的virtual关键字也去掉了，就算你不去掉（virtual void ViewAcct() const;）也相当于去掉了，因为<strong>只有基类的方法前面的virtual关键字才说了算，起作用</strong>）</p> 
<p>那么不管对象是什么类型，<strong>都只会调用基类的ViewAcct方法</strong></p> 
<pre><code class="prism language-bash">Enter client<span class="token string">'s name: gf
Enter client'</span>s accout number: 4564
Enter opening balance: <span class="token variable">$465</span>
Enter 1 <span class="token keyword">for</span> Brass Account or 2 <span class="token keyword">for</span> BrassPlus Account：1

Enter client<span class="token string">'s name: fadfa
Enter client'</span>s accout number: 4646
Enter opening balance: <span class="token variable">$464</span>
Enter 1 <span class="token keyword">for</span> Brass Account or 2 <span class="token keyword">for</span> BrassPlus Account：2
Enter the overdraft limit: 565456
Enter the interest rate: 0.25

Enter client<span class="token string">'s name: fasdfa
Enter client'</span>s accout number: 6456
Enter opening balance: <span class="token variable">$4564</span>
Enter 1 <span class="token keyword">for</span> Brass Account or 2 <span class="token keyword">for</span> BrassPlus Account：2
Enter the overdraft limit: 456
Enter the interest rate: 0.1

Enter client<span class="token string">'s name: fasfa
Enter client'</span>s accout number: 465465
Enter opening balance: <span class="token variable">$464</span>
Enter 1 <span class="token keyword">for</span> Brass Account or 2 <span class="token keyword">for</span> BrassPlus Account：1


Client: gf
Account number: 4564
Balance: <span class="token variable">$465</span>.00

Client: fadfa
Account number: 4646
Balance: <span class="token variable">$464</span>.00

Client: fasdfa
Account number: 6456
Balance: <span class="token variable">$4564</span>.00

Client: fasfa
Account number: 465465
Balance: <span class="token variable">$464</span>.00
</code></pre> 
<h5><a id="_625"></a>本示例知识点总结</h5> 
<ul><li> <p>派生类不能直接访问基类数据，要用基类公有方法间接访问</p> </li><li> <p>虚成员函数：把<strong>基类</strong>中会在派生类中重新定义的方法声明为虚函数</p> </li></ul> 
<p>在<strong>基类</strong>的方法原型前面加个virtual关键字即可，和友元函数关键字friend一样，只出现在原型中，无需在定义中再写</p> 
<p>基类中被声明为虚方法的方法，在派生类中<strong>自动成为</strong>虚方法，但是最好还是把带virtual的原型再在派生类的类声明中写一遍，这是个好习惯（但是如果基类某方法不是虚方法，那么即使派生类的该方法的原型前面有virtual关键字，也跟没有一样）。</p> 
<ul><li>虚析构函数：确保释放派生类对象时，按正确顺序调用析构函数</li></ul> 
<p>如果基类的析构函数声明为虚函数，那么<strong>派生类BrassPlus类对象会调用自己的析构函数，在其中会自动调用基类的析构函数</strong>，下面用示例说明，让两个析构函数打印一条消息</p> 
<pre><code class="prism language-bash">virtual ~Brass<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>std::cout <span class="token operator">&lt;&lt;</span> <span class="token string">"In virtual ~Brass()\n"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>//虚析构函数
~BrassPlus<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>std::cout <span class="token operator">&lt;&lt;</span> <span class="token string">"In ~BrassPlus()\n"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-bash">Enter client<span class="token string">'s name: hfjka
Enter client'</span>s accout number: 456
Enter opening balance: <span class="token variable">$456</span>
Enter 1 <span class="token keyword">for</span> Brass Account or 2 <span class="token keyword">for</span> BrassPlus Account：1

Enter client<span class="token string">'s name: dasf
Enter client'</span>s accout number: 465456
Enter opening balance: <span class="token variable">$456456</span>
Enter 1 <span class="token keyword">for</span> Brass Account or 2 <span class="token keyword">for</span> BrassPlus Account：2
Enter the overdraft limit: 465
Enter the interest rate: 0.1


Client: hfjka
Account number: 456
Balance: <span class="token variable">$456</span>.00
In virtual ~Brass<span class="token punctuation">(</span><span class="token punctuation">)</span>

Client: dasf
Account number: 465456
Balance: <span class="token variable">$456456</span>.00
In ~BrassPlus<span class="token punctuation">(</span><span class="token punctuation">)</span>
In virtual ~Brass<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>如果不把基类析构函数声明为虚函数</p> 
<pre><code class="prism language-bash">~Brass<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>std::cout <span class="token operator">&lt;&lt;</span> <span class="token string">"In ~Brass()\n"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>//非虚析构函数
~BrassPlus<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>std::cout <span class="token operator">&lt;&lt;</span> <span class="token string">"In ~BrassPlus()\n"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> 
<p>则报警<br> <img src="https://images2.imgbox.com/37/3d/qP1ODGGI_o.png" alt="在这里插入图片描述"><br> 警告内容：Brass基类拥有非虚析构函数，可能造成未知后果。</p> 
<p>对应输出，Brass类对象和BrassPlus类对象<strong>都只调用基类Brass类的析构函数</strong></p> 
<pre><code class="prism language-bash">Enter client<span class="token string">'s name: afd
Enter client'</span>s accout number: 4566
Enter opening balance: <span class="token variable">$456</span>
Enter 1 <span class="token keyword">for</span> Brass Account or 2 <span class="token keyword">for</span> BrassPlus Account：1

Enter client<span class="token string">'s name: faffad
Enter client'</span>s accout number: 464655
Enter opening balance: <span class="token variable">$456456</span>
Enter 1 <span class="token keyword">for</span> Brass Account or 2 <span class="token keyword">for</span> BrassPlus Account：2
Enter the overdraft limit: 456456
Enter the interest rate: 0.1


Client: afd
Account number: 4566
Balance: <span class="token variable">$456</span>.00
In ~Brass<span class="token punctuation">(</span><span class="token punctuation">)</span>

Client: faffad
Account number: 464655
Balance: <span class="token variable">$456456</span>.00
In ~Brass<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>所以说，结论很简单：<mark>只要涉及继承，就把基类的析构函数声明为虚函数</mark>，保证<strong>派生类对象可以正确调用他自己的析构函数</strong>，不然如果派生类析构函数要做点什么却又无法被调用的话，就会出错</p> 
<ul><li>在派生类的方法定义中调用基类方法的标准办法：使用基类类名限定符</li></ul> 
<p>但是如果派生类没有重新定义某个基类方法，那就直接调用，无需用基类类名限定</p> 
<p>只是针对那些在派生类中被重新定义的基类方法，由于有两个同名方法，所以必须使用基类类名限定说清楚要调用基类的那个方法。否则编译器又不知所措了。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0e2b265bacbf5160cfd2dd7d94b8b527/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数字图像处理与Python实现笔记之图像小波变换与多分辨率</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/587c6a834b1e1160e5464d9da85f67c4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基本页表和二级页表的思路和比较</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>