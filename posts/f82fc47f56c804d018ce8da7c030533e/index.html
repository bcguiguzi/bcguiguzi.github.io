<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>HDU 6432 Problem G. Cyclic (容斥&#43;线性求组合数) - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="HDU 6432 Problem G. Cyclic (容斥&#43;线性求组合数)" />
<meta property="og:description" content="Problem G. Cyclic Time Limit: 2000/1000 MS (Java/Others) Memory Limit: 524288/524288 K (Java/Others)
Total Submission(s): 322 Accepted Submission(s): 225
Problem Description
Count the number of cyclic permutations of length n with no continuous subsequence [i, i &#43; 1 mod n].
Output the answer modulo 998244353.
Input
The first line of the input contains an integer T , denoting the number of test cases.
In each test case, there is a single integer n in one line, denoting the length of cyclic permutations." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/f82fc47f56c804d018ce8da7c030533e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-08-24T15:03:10+08:00" />
<meta property="article:modified_time" content="2018-08-24T15:03:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">HDU 6432 Problem G. Cyclic (容斥&#43;线性求组合数)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2><span style="color:#1a5cc8;">Problem G. Cyclic</span></h2> 
<p><strong><strong><span style="color:#008000;">Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 524288/524288 K (Java/Others)<br> Total Submission(s): 322    Accepted Submission(s): 225</span></strong></strong><br><br>  </p> 
<p><span style="color:#7ca9ed;"><strong>Problem Description</strong></span></p> 
<p><span style="color:#000000;">Count the number of cyclic permutations of length n with no continuous subsequence [i, i + 1 mod n].<br> Output the answer modulo 998244353.</span></p> 
<p><span style="color:#000000;"> </span></p> 
<p> </p> 
<p><span style="color:#7ca9ed;"><strong>Input</strong></span></p> 
<p><span style="color:#000000;">The first line of the input contains an integer T , denoting the number of test cases.<br> In each test case, there is a single integer n in one line, denoting the length of cyclic permutations.<br> 1 ≤ T ≤ 20, 1 ≤ n ≤ 100000</span></p> 
<p><span style="color:#000000;"> </span></p> 
<p> </p> 
<p><span style="color:#7ca9ed;"><strong>Output</strong></span></p> 
<p><span style="color:#000000;">For each test case, output one line contains a single integer, denoting the answer modulo 998244353.</span></p> 
<p><span style="color:#000000;"> </span></p> 
<p> </p> 
<p><span style="color:#7ca9ed;"><strong>Sample Input</strong></span></p> 
<pre style="margin-left:0px;"> </pre> 
<p><span style="color:#000000;">3 </span></p> 
<p><span style="color:#000000;">4 </span></p> 
<p><span style="color:#000000;">5 </span></p> 
<p><span style="color:#000000;">6</span></p> 
<p><span style="color:#000000;"> </span></p> 
<p> </p> 
<p><span style="color:#7ca9ed;"><strong>Sample Output</strong></span></p> 
<pre style="margin-left:0px;"> </pre> 
<p><span style="color:#000000;">1 </span></p> 
<p><span style="color:#000000;">8 </span></p> 
<p><span style="color:#000000;">36</span></p> 
<p><span style="color:#000000;"> </span></p> 
<p>题意:</p> 
<p>给你一个t</p> 
<p>然后t组数据，每组数据一个n，让你给出长度为n的循环排列满足条件的方案数%<span style="color:#000000;">998244353</span></p> 
<p><span style="color:#000000;">条件，队列中前一个数+1≠后一个数，并且n后面不能放1</span></p> 
<p><span style="color:#000000;">例如n=4,只有1 4 3 2满足</span></p> 
<p><span style="color:#000000;">解析:</span></p> 
<p>官方题解:</p> 
<p><span style="color:#000000;">考虑使用容斥原理进行计数.</span></p> 
<p>包含至少一个形如 <img alt="$[i, i + 1]$" class="mathcode" src="https://images2.imgbox.com/55/83/Srsl0hap_o.png"> 或 <img alt="$[n, 1]$" class="mathcode" src="https://images2.imgbox.com/7a/cd/Eku36hok_o.png"> 这样的子串的环排列个数是 <img alt="\binom{n}{1} (n - 2)!" class="mathcode" src="https://images2.imgbox.com/6d/48/H4sUOv2I_o.gif"> 个;</p> 
<p>可以推广为包含至少 <img alt="k (0 \leq k &lt; n)" class="mathcode" src="https://images2.imgbox.com/19/ce/A6iNDXPc_o.gif"> 个的环排列个数是 <img alt="\binom{n}{k} (n - k - 1)!" class="mathcode" src="https://images2.imgbox.com/bf/d7/0f6MhEVU_o.gif">,<br> 同时注意到包含 n个的环排列个数一定是 1 个.</p> 
<p>所以最终答案就是<br><img alt="(-1)^n + \sum_{k = 0}^{n - 1} (-1)^k \binom{n}{k} (n - k - 1)!" class="mathcode" src="https://images2.imgbox.com/7e/97/BpMFFcML_o.gif"></p> 
<p>这里长度为n的循环排列的方案数是(n-1)!</p> 
<p>所以当k=4时，就是<img alt="\binom{n}{k}" class="mathcode" src="https://images2.imgbox.com/5b/dc/M3WvKBkT_o.gif">，然后再把取出来的数合并之后放回去，组成n-k个数求方案数(n-k-1)!</p> 
<p>例如取[2,3,4,5,6] n-5+1=n-4</p> 
<p>取[2,3,4],[6,7,8] n-6+2=n-4</p> 
<p>取[2,3],[5,6],[8,9],[11,12] n-8+4=n-4</p> 
<p>然后就是上面的容斥了，</p> 
<p>最后那个包含n个的时候我具体搞不懂为什么，下面是我根据容斥猜的。</p> 
<p>最后k=n时，因为(n-k-1)&lt;0,但是k=n时确实是存在一种方案的，所以还要继续容斥，容斥系数就是(-1)^n</p> 
<pre class="has"><code class="language-cpp">#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;algorithm&gt;
#include &lt;iostream&gt;
using namespace std;
typedef long long ll;
const int MAXN = 1e5+10;

const ll MOD = 998244353;

ll jc[MAXN];

ll inv[MAXN];

void init()

{

	ll p=1;

	jc[0]=1;

	jc[1]=1;

	inv[0]=1;

	inv[1]=1;

	for(int i=2;i&lt;MAXN;i++)

	{

		p=(p*i)%MOD;

		jc[i]=p;

		//inv[i]=inv[MOD%i]*(MOD-MOD/i)%MOD;

	}

	

	for(int i=2;i&lt;MAXN;i++) inv[i]=inv[MOD%i]*(MOD-MOD/i)%MOD;   //O(n)求逆元

	for(int i=2;i&lt;MAXN;i++) inv[i]=inv[i-1]*inv[i]%MOD;   //扩展到i!的逆元

}

inline ll C(int a, int b)    //计算C(a, b),a下，b上
{

	if(b&gt;a) return 0;

    return jc[a] * inv[b] % MOD

        * inv[a-b]%MOD;

}

int main()
{
	int t;
	cin&gt;&gt;t;
	init();
	while(t--)
	{
		int n;
		cin&gt;&gt;n;
		ll ans=0;
		for(int i=0;i&lt;n;i++)
		{
			ans=(i&amp;1)?(ans-(C(n,i)*jc[n-i-1]%MOD)+MOD)%MOD:(ans+(C(n,i)*jc[n-i-1]%MOD))%MOD;
		}
		if((n&amp;1)==0) ans++;
		else ans--;
		ans=(ans+MOD)%MOD;
		printf("%lld\n",ans);
	}
	return 0;
	

}</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/777cf65ca66d0d43c0c967984826b8d2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">程序员命名网站 codelf， 使用技巧</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d3ac57698180f7c1950ff05ca1866dd0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vs 生成事件,将dll复制到目录</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>