<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>电力系统网架规划MATLAB程序分享 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="电力系统网架规划MATLAB程序分享" />
<meta property="og:description" content="资源地址：
电力系统网架规划MATLAB程序_网架规划matlab程序-电子商务文档类资源-CSDN文库
网架数据展示： 完整程序： close all;
clear all;
clc;
warning off; % 去除警告 tic; % tic用来保存当前时间，而后使用toc来记录程序完成时间
%% 基本参数
T=12; % 典型日 8-19h % 8-19h 负荷各时段负荷总量
total_P_LOAD=[828,1001,1105,1105,994,1105,1105,1049,1012,810,699,626];
% 8-19h 光伏各时段出力标幺(by)值
by_P_PVG_timeline=[0.29,0.03,0.51,0.55,0.47,0.46,0.55,0.64,0.22,0.20,0.38,0.03];
Node=23; % 节点
Line=34; % 线路
o1 = 1.1198; % 负荷功率因数角 0.9
o2 = 1.2532; % DG功率因素角 0.95
% 网损成本
Line_closs=0.6; % 最大弃(abandon,a)光率
a_max_PVG=0.05;
% 单位弃光成本
ca_PVG=0.6; % 主网(zw)购电分时单价
zw_buy1_TR=[0.6 0.57 0.45 0.43 0.43 0.58 0.65 0.67 0.68 0.64 0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/c8db4a9a639dd90b573fcc0847293ee6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-20T19:03:44+08:00" />
<meta property="article:modified_time" content="2023-03-20T19:03:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">电力系统网架规划MATLAB程序分享</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <p style="">资源地址：</p> 
 <p style=""><a class="kdocs-link" style="color:#0A6CFF;" href="https://download.csdn.net/download/weixin_56691527/87447609" target="_blank" rel="noopener noreferrer">电力系统网架规划MATLAB程序_网架规划matlab程序-电子商务文档类资源-CSDN文库</a></p> 
 <h2 style=""><span class="kdocs-bold" style="font-weight:bold;">网架数据展示：</span></h2> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1445px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:41.52249%;height:0;"> 
    <img src="https://images2.imgbox.com/6b/43/tXUPOcfv_o.png" style="margin-left:;display:block;width:1445px;margin-top:-41.52249%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <h2 style=""><span class="kdocs-bold" style="font-weight:bold;">完整程序：</span></h2> 
 <p style="">close all;</p> 
 <p style="">clear all;</p> 
 <p style="">clc;</p> 
 <p style="">warning off; % 去除警告 </p> 
 <p style="">tic; % tic用来保存当前时间，而后使用toc来记录程序完成时间</p> 
 <p style="">%% 基本参数</p> 
 <p style="">T=12; % 典型日 8-19h </p> 
 <p style="">% 8-19h 负荷各时段负荷总量</p> 
 <p style="">total_P_LOAD=[828,1001,1105,1105,994,1105,1105,1049,1012,810,699,626];</p> 
 <p style="">% 8-19h 光伏各时段出力标幺(by)值</p> 
 <p style="">by_P_PVG_timeline=[0.29,0.03,0.51,0.55,0.47,0.46,0.55,0.64,0.22,0.20,0.38,0.03];</p> 
 <p style="">Node=23; % 节点</p> 
 <p style="">Line=34; % 线路</p> 
 <p style="">o1 = 1.1198; % 负荷功率因数角 0.9</p> 
 <p style="">o2 = 1.2532; % DG功率因素角 0.95</p> 
 <p style="">% 网损成本</p> 
 <p style="">Line_closs=0.6; </p> 
 <p style="">% 最大弃(abandon,a)光率</p> 
 <p style="">a_max_PVG=0.05;</p> 
 <p style="">% 单位弃光成本</p> 
 <p style="">ca_PVG=0.6; </p> 
 <p style="">% 主网(zw)购电分时单价</p> 
 <p style="">zw_buy1_TR=[0.6 0.57 0.45 0.43 0.43 0.58 0.65 0.67 0.68 0.64 0.69 0.63 0.63 0.63 0.62 0.61 0.615 0.635 0.63 0.63 0.615 0.615 0.59 0.505 ];</p> 
 <p style="">zw_buy_TR=zw_buy1_TR(8:19);</p> 
 <p style="">SLmax=5300; % KVA</p> 
 <p style="">Umin=0.95*0.95*(12.66)^2; % 20KV</p> 
 <p style="">Umax=1.05*1.05*(12.66)^2; % 20KV</p> 
 <p style="">% P_TRmax=7500; </p> 
 <p style="">P_TRmax=4500; </p> 
 <p style="">P_TRmin=0; </p> 
 <p style="">M=99999; % 大M法处理非线性项</p> 
 <p style="">%% 线路节点相关信息</p> 
 <p style="">% 从excel中读取</p> 
 <p style="">% Line_cs中各项含义 1线路编号 2起、3止节点 4不允许建线路 5允许建线路 6线路长度 km</p> 
 <p style="">Line_cs=xlsread('Lines_Nodes_canshu.xlsx','B5:H38');</p> 
 <p style="">%% 为节点（jd）关联(gl)矩阵</p> 
 <p style="">% 若不为0，则单元格数值表示为线路编号，横、纵坐标分别表示为起、止节点。</p> 
 <p style="">JD_gl=zeros(Node);</p> 
 <p style="">for i=1:Line</p> 
 <p style=""> JD_gl(Line_cs(i,2),Line_cs(i,3))=i;</p> 
 <p style="">end</p> 
 <p style="">%% 如果线路不允许建，线路编号加入到E0当中，允许建则加入到E1当中</p> 
 <p style="">E0=[]; % 不允许建线路集合</p> 
 <p style="">E1=[]; % 允许建线路集合</p> 
 <p style="">for i=1:Line</p> 
 <p style=""> if Line_cs(i,4)==1</p> 
 <p style=""> E0=[E0,Line_cs(i,1)];</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">for i=1:Line</p> 
 <p style=""> if Line_cs(i,5)==1</p> 
 <p style=""> E1=[E1,Line_cs(i,1)];</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">Num_Line=length(E1);</p> 
 <p style="">x_E1_line=binvar(1,Num_Line); % 待建线路建设集合</p> 
 <p style="">%% 每条线路长度</p> 
 <p style="">% A_cs中不仅仅包含了线路关联矩阵，而且保留有线路长度 横、纵坐标分别表示为起、止节点</p> 
 <p style="">Long_line_cs=zeros(Node,Node)</p> 
 <p style="">for i=1:Node</p> 
 <p style=""> for j=1:Node</p> 
 <p style=""> if JD_gl(i,j)~=0</p> 
 <p style=""> Long_line_cs(i,j)=Line_cs(JD_gl(i,j),6) % 线路长度</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">%% 线路投资成本矩阵 长度 * 单位造价</p> 
 <p style="">% 线路建设成本 20万元/km</p> 
 <p style="">cline=Long_line_cs*200000;</p> 
 <p style="">Cline=[];</p> 
 <p style="">for i=1:Node</p> 
 <p style=""> for j=1:Node</p> 
 <p style=""> if JD_gl(i,j)~=0</p> 
 <p style=""> Cline=[Cline,cline(i,j)];</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">%% 电阻电抗化简</p> 
 <p style="">% 电阻</p> 
 <p style="">rline=Long_line_cs*0.17;</p> 
 <p style="">% 电抗</p> 
 <p style="">xline=Long_line_cs*0.402;</p> 
 <p style="">Rline=[]; %%%%%%%%线路阻抗化简</p> 
 <p style="">Xline=[];</p> 
 <p style="">for i=1:Node</p> 
 <p style=""> for j=1:Node</p> 
 <p style=""> if JD_gl(i,j)~=0</p> 
 <p style=""> Rline=[Rline,rline(i,j)];</p> 
 <p style=""> Xline=[Xline,xline(i,j)];</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">%% 主网、光电接入(jr)节点 </p> 
 <p style="">% 光伏接入节点</p> 
 <p style="">PVG_jr=[4,8,11,12,16,20]; </p> 
 <p style="">% 各光伏节点接入容量</p> 
 <p style="">int_pvg=[435,465,345,489,564,349];</p> 
 <p style="">Num_PVG=length(PVG_jr);</p> 
 <p style="">P_PVG_yc=sdpvar(Num_PVG,T,'full'); % 光伏预测（yc）出力</p> 
 <p style="">P_PVG=sdpvar(Num_PVG,T,'full');</p> 
 <p style="">x_pvg=binvar(1,Num_PVG); % 0-1变量，是否建设光伏</p> 
 <p style="">TR_jr=[1]; % 变压器接入节点 也就是与主网相连节点</p> 
 <p style="">Num_TR=length(TR_jr);</p> 
 <p style="">P_TR=sdpvar(Num_TR,T,'full');</p> 
 <p style="">Q_TR=sdpvar(Num_TR,T,'full');</p> 
 <p style="">%% 负荷相关定义</p> 
 <p style="">% 各个节点基准(jz)负荷</p> 
 <p style="">P_load_jz=[0,188,180,136,184,160,172,164,244,252,180,204,248,160,196,144,172,188,223,145,135,268,193]/4136;</p> 
 <p style="">% 负荷曲线 0-24 求8:19</p> 
 <p style="">Load_timeine1=[0.78,0.75,0.7,0.68,0.65,0.63,0.7,0.75,0.79,0.90,0.90,0.90,0.90,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.85,0.83,0.80,0.78];</p> 
 <p style="">Load_timeine=Load_timeine1(8:19);</p> 
 <p style="">for t=1:T</p> 
 <p style=""> for j=1:Node</p> 
 <p style=""> P_LOAD(j,t)=total_P_LOAD(t)*P_load_jz(j)*Load_timeine(t);</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">%% 光伏预测出力</p> 
 <p style="">% for t=1:T</p> 
 <p style="">% for j=1:Node</p> 
 <p style="">% if ismember(j,PVG_jr)==1</p> 
 <p style="">% for k=1:Num_PVG</p> 
 <p style="">% P_PVG_yc(find(PVG_jr==j),t)=int_pvg(k)*by_P_PVG_timeline(t);</p> 
 <p style="">% end</p> 
 <p style="">% end</p> 
 <p style="">% end</p> 
 <p style="">% end</p> 
 <p style="">for t=1:T</p> 
 <p style=""> for j=1:Num_PVG</p> 
 <p style=""> P_PVG_yc(j,t)=int_pvg(j)*by_P_PVG_timeline(t);</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">%% 设决策变量</p> 
 <p style="">P_ij=sdpvar(Line,T);</p> 
 <p style="">Q_ij=sdpvar(Line,T);</p> 
 <p style="">I_ij=sdpvar(Line,T); % 电流的平方</p> 
 <p style="">U_j=sdpvar(Node,T); % 电压的平方</p> 
 <p style="">%% 约束</p> 
 <p style="">C=[]; % 总约束</p> 
 <p style="">%% 建线路 、光电 数量约束</p> 
 <p style="">C_1=[];</p> 
 <p style="">C_1=[C_1,sum(x_E1_line)==34];</p> 
 <p style="">% 各光伏接入节点均可正常运行</p> 
 <p style="">C_1=[C_1,sum(x_pvg)==Num_PVG];</p> 
 <p style="">C=[C,C_1];</p> 
 <p style="">%% sd：首节点，md：末节点</p> 
 <p style="">SJD=zeros(Node,5);</p> 
 <p style="">MJD=zeros(Node,5);</p> 
 <p style="">for j=1:Node</p> 
 <p style=""> sjdmjd=1;</p> 
 <p style=""> for i=1:Node</p> 
 <p style=""> if JD_gl(j,i)~=0</p> 
 <p style=""> SJD(j,sjdmjd)=i;</p> 
 <p style=""> sjdmjd=sjdmjd+1;</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">for j=1:Node</p> 
 <p style=""> sjdmjd=1;</p> 
 <p style=""> for i=1:Node</p> 
 <p style=""> if JD_gl(i,j)~=0</p> 
 <p style=""> MJD(j,sjdmjd)=i;</p> 
 <p style=""> sjdmjd=sjdmjd+1;</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">%% 有功无功集合 RIGHT1 有功 RIGHT2 无功</p> 
 <p style="">C_2=[];</p> 
 <p style="">LINE1=zeros(1,Node); % 以该节点为起始节点线路有几条</p> 
 <p style="">LINE2=zeros(1,Node); % 以该节点为终止节点线路有几条</p> 
 <p style="">for j=1:Node</p> 
 <p style=""> % 以该节点为起始节点线路有几条</p> 
 <p style=""> LINE1(j)=sum(SJD(j,:)~=0,2);</p> 
 <p style=""> % 以该节点为终止节点线路有几条</p> 
 <p style=""> LINE2(j)=sum(MJD(j,:)~=0,2);</p> 
 <p style="">end</p> 
 <p style="">for t=1:T</p> 
 <p style=""> for j=1:Node</p> 
 <p style=""> P_ALL=0;</p> 
 <p style=""> Q_ALL=0;</p> 
 <p style=""> </p> 
 <p style=""> P_ALL=-P_LOAD(j,t);</p> 
 <p style=""> Q_ALL=-P_LOAD(j,t)/tan(o1);</p> 
 <p style=""> </p> 
 <p style=""> if ismember(j,PVG_jr)==1</p> 
 <p style=""> P_ALL=P_ALL+P_PVG(find(PVG_jr==j),t);</p> 
 <p style=""> Q_ALL=Q_ALL+P_PVG(PVG_jr==j,t)/tan(o2);</p> 
 <p style=""> end</p> 
 <p style=""> </p> 
 <p style=""> if ismember(j,TR_jr)==1</p> 
 <p style=""> P_ALL=P_ALL+P_TR(find(TR_jr==j),t);</p> 
 <p style=""> Q_ALL=Q_ALL+Q_TR(find(TR_jr==j),t);</p> 
 <p style=""> end</p> 
 <p style=""> </p> 
 <p style=""> if LINE1(j)==0</p> 
 <p style=""> </p> 
 <p style=""> if LINE2(j) ==0</p> 
 <p style=""> % 没有建设线路</p> 
 <p style=""> </p> 
 <p style=""> C_2=[C_2,P_ALL==0];</p> 
 <p style=""> C_2=[C_2,Q_ALL==0];</p> 
 <p style=""> </p> 
 <p style=""> else</p> 
 <p style=""> % 首节点功率分布</p> 
 <p style=""> C_2=[C_2,-sum(P_ij(JD_gl(MJD(j,1:LINE2(j)),j),t))+sum(I_ij(JD_gl(MJD(j,1:LINE2(j)),j),t).*rline(MJD(j,1:LINE2(j)),j))/1000==P_ALL]; % KVA为单位进行换算</p> 
 <p style=""> C_2=[C_2,-sum(Q_ij(JD_gl(MJD(j,1:LINE2(j)),j),t))+sum(I_ij(JD_gl(MJD(j,1:LINE2(j)),j),t).*xline(MJD(j,1:LINE2(j)),j))/1000==Q_ALL]; % KVA为单位进行换算</p> 
 <p style=""> </p> 
 <p style=""> end</p> 
 <p style=""> </p> 
 <p style=""> else</p> 
 <p style=""> </p> 
 <p style=""> if LINE2(j) ==0</p> 
 <p style=""> % 末节点功率分布</p> 
 <p style=""> C_2=[C_2,sum(P_ij(JD_gl(j,SJD(j,1:LINE1(j))),t))==P_ALL]; % KVA为单位进行换算</p> 
 <p style=""> C_2=[C_2,sum(Q_ij(JD_gl(j,SJD(j,1:LINE1(j))),t))==Q_ALL]; % KVA为单位进行换算</p> 
 <p style=""> </p> 
 <p style=""> else</p> 
 <p style=""> % 正常线路功率分布</p> 
 <p style=""> C_2=[C_2,-sum(P_ij(JD_gl(MJD(j,1:LINE2(j)),j),t))+sum(I_ij(JD_gl(MJD(j,1:LINE2(j)),j),t).*rline(MJD(j,1:LINE2(j)),j))/1000+sum(P_ij(JD_gl(j,SJD(j,1:LINE1(j))),t))==P_ALL]; % KVA为单位进行换算</p> 
 <p style=""> C_2=[C_2,-sum(Q_ij(JD_gl(MJD(j,1:LINE2(j)),j),t))+sum(I_ij(JD_gl(MJD(j,1:LINE2(j)),j),t).*xline(MJD(j,1:LINE2(j)),j))/1000+sum(Q_ij(JD_gl(j,SJD(j,1:LINE1(j))),t))==Q_ALL]; % KVA为单位进行换算</p> 
 <p style=""> </p> 
 <p style=""> end</p> 
 <p style=""> </p> 
 <p style=""> end </p> 
 <p style=""> end </p> 
 <p style="">end</p> 
 <p style="">C=[C,C_2];</p> 
 <p style="">%% 线路电压平衡约束</p> 
 <p style="">C_3=[];</p> 
 <p style="">for t=1:T</p> 
 <p style=""> for j=1:Node</p> 
 <p style=""> for i=1:Node</p> 
 <p style=""> if (JD_gl(i,j)~=0)</p> 
 <p style=""> if(ismember(JD_gl(i,j),E0)==1)</p> 
 <p style=""> C_3=[C_3,U_j(j,t)*1000==U_j(i,t)*1000-2*(P_ij(JD_gl(i,j),t)*rline(i,j)+Q_ij(JD_gl(i,j),t)*xline(i,j))+I_ij(JD_gl(i,j),t)*(rline(i,j)^2+xline(i,j)^2)/1000]; </p> 
 <p style=""> else</p> 
 <p style=""> C_3=[C_3,U_j(i,t)*1000-U_j(j,t)*1000-2*(P_ij(JD_gl(i,j),t)*rline(i,j)+Q_ij(JD_gl(i,j),t)*xline(i,j))+I_ij(JD_gl(i,j),t)*(rline(i,j)^2+xline(i,j)^2)/1000&lt;= M*(1-x_E1_line(find(E1==JD_gl(i,j))))]</p> 
 <p style=""> C_3=[C_3,U_j(i,t)*1000-U_j(j,t)*1000-2*(P_ij(JD_gl(i,j),t)*rline(i,j)+Q_ij(JD_gl(i,j),t)*xline(i,j))+I_ij(JD_gl(i,j),t)*(rline(i,j)^2+xline(i,j)^2)/1000&gt;=-M*(1-x_E1_line(find(E1==JD_gl(i,j))))]</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">C=[C,C_3];</p> 
 <p style="">%% 二阶锥约束</p> 
 <p style="">C_4=[];</p> 
 <p style="">for t=1:T</p> 
 <p style=""> for j=1:Node</p> 
 <p style=""> for i=1:Node</p> 
 <p style=""> if (JD_gl(i,j)~=0)</p> 
 <p style=""> C_4=[C_4,norm([2*P_ij(JD_gl(i,j),t),2*Q_ij(JD_gl(i,j),t),I_ij(JD_gl(i,j),t)-U_j(j,t)],2)&lt;=I_ij(JD_gl(i,j),t)+U_j(j,t)]</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">C=[C,C_4];</p> 
 <p style="">%% 节点电压、线路电流约束</p> 
 <p style="">C_5=[];</p> 
 <p style="">C_5=[C_5,Umin&lt;=U_j&lt;=Umax]</p> 
 <p style="">for i=1:Node</p> 
 <p style=""> for j=1:Node</p> 
 <p style=""> if JD_gl(i,j)~=0</p> 
 <p style=""> if ismember(JD_gl(i,j),E0)==1</p> 
 <p style=""> C_5=[C_5,0&lt;=I_ij(JD_gl(i,j),:)&lt;=(SLmax/12.66)^2]</p> 
 <p style=""> else</p> 
 <p style=""> C_5=[C_5,0&lt;=I_ij(JD_gl(i,j),:)&lt;=(SLmax/12.66)^2*x_E1_line(find(E1==JD_gl(i,j)))]</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">C=[C,C_5];</p> 
 <p style="">%% 变压器节点功率约束 </p> 
 <p style="">C_6=[];</p> 
 <p style="">C_6=[C_6,P_TRmin&lt;=P_TR&lt;=P_TRmax];</p> 
 <p style="">C_6=[C_6,P_TRmin&lt;=Q_TR&lt;=P_TRmax];</p> 
 <p style="">C=[C,C_6];</p> 
 <p style="">%% 风光功率约束 考虑是否建设</p> 
 <p style="">C_7=[];</p> 
 <p style="">% for t=1:T</p> 
 <p style="">% for j=1:Node</p> 
 <p style="">% if ismember(j,PVG_jr)==1</p> 
 <p style="">% C_7=[C_7,(1-a_max_PVG)*x_pvg(find(PVG_jr==j))*P_PVG_yc(find(PVG_jr==j),t)&lt;=P_PVG(find(PVG_jr==j),t)&lt;=x_pvg(find(PVG_jr==j))*P_PVG_yc(find(PVG_jr==j),t)];</p> 
 <p style="">% end</p> 
 <p style="">% end</p> 
 <p style="">% end</p> 
 <p style="">for t=1:T</p> 
 <p style=""> for j=1:Num_PVG</p> 
 <p style=""> C_7=[C_7,(1-a_max_PVG)*P_PVG_yc(j,t)&lt;=P_PVG(find(PVG_jr==j),t)&lt;=P_PVG_yc(j,t)];</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">C=[C,C_7];</p> 
 <p style="">%% 线路功率约束</p> 
 <p style="">C_8=[];</p> 
 <p style="">for i=1:Node</p> 
 <p style=""> for j=1:Node</p> 
 <p style=""> if JD_gl(i,j)~=0</p> 
 <p style=""> if ismember(JD_gl(i,j),E0)==1</p> 
 <p style=""> C_8=[C_8,-SLmax&lt;=P_ij(JD_gl(i,j),:)&lt;=SLmax];</p> 
 <p style=""> C_8=[C_8,-SLmax&lt;=Q_ij(JD_gl(i,j),:)&lt;=SLmax];</p> 
 <p style=""> else</p> 
 <p style=""> C_8=[C_8,x_E1_line(find(E1==JD_gl(i,j)))*(-SLmax)&lt;=P_ij(JD_gl(i,j),:)&lt;=x_E1_line(find(E1==JD_gl(i,j)))*SLmax];</p> 
 <p style=""> C_8=[C_8,x_E1_line(find(E1==JD_gl(i,j)))*(-SLmax)&lt;=Q_ij(JD_gl(i,j),:)&lt;=x_E1_line(find(E1==JD_gl(i,j)))*SLmax];</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style="">C=[C,C_8];</p> 
 <p style="">%% 目标函数及求解</p> 
 <p style="">obj_OPE1=0;</p> 
 <p style="">obj_OPE2=0;</p> 
 <p style="">obj_OPE3=0;</p> 
 <p style="">obj_OPE4=0;</p> 
 <p style="">for i=1:Num_Line</p> 
 <p style=""> obj_OPE1=obj_OPE1+x_E1_line(i)*Cline(E1(i));</p> 
 <p style="">end</p> 
 <p style="">for t=1:T</p> 
 <p style=""> </p> 
 <p style=""> % 线路损耗</p> 
 <p style=""> obj_OPE2=obj_OPE2+Line_closs*(Rline*I_ij(:,t)/1000);</p> 
 <p style=""> </p> 
 <p style=""> for i=1:Node</p> 
 <p style=""> </p> 
 <p style=""> % 从主网成本</p> 
 <p style=""> if ismember(i,TR_jr)==1</p> 
 <p style=""> obj_OPE3= obj_OPE3+zw_buy_TR(t)*P_TR(find(TR_jr==i),t);</p> 
 <p style=""> end</p> 
 <p style=""> </p> 
 <p style="">% if ismember(i,PVG_jr)==1</p> 
 <p style="">% obj_OPE4= obj_OPE4+ca_PVG*(P_PVG_yc(find(PVG_jr==i),t)-P_PVG(find(PVG_jr==i),t));</p> 
 <p style="">% end</p> 
 <p style=""> end</p> 
 <p style=""> </p> 
 <p style="">end</p> 
 <p style="">for t=1:T</p> 
 <p style=""> for j=1:Num_PVG</p> 
 <p style=""> obj_OPE4= obj_OPE4+ca_PVG*(P_PVG_yc(j,t)-P_PVG(j,t));</p> 
 <p style=""> end</p> 
 <p style="">end</p> 
 <p style=""> </p> 
 <p style="">% obj=obj_OPE1+obj_OPE2+obj_OPE3;</p> 
 <p style="">obj=obj_OPE2+obj_OPE3+obj_OPE4;</p> 
 <p style="">ops =sdpsettings('solver','Gurobi','verbose', 2, 'debug', 1);</p> 
 <p style="">% ops =sdpsettings('solver','Cplex');</p> 
 <p style="">result = optimize(C,obj,ops);</p> 
 <p style="">%% 以 m_ 开头保存计算结果</p> 
 <p style="">m_x_E1_line=value(x_E1_line);</p> 
 <p style="">m_x_pvg=value(x_pvg);</p> 
 <p style="">m_P_TR=value(P_TR);</p> 
 <p style="">m_Q_TR=value(Q_TR);</p> 
 <p style="">m_P_LOAD=value(P_LOAD);</p> 
 <p style="">m_P_PVG_yc=value(P_PVG_yc);</p> 
 <p style="">m_P_PVG=value(P_PVG);</p> 
 <p style="">%% 运行时间</p> 
 <p style="">toc; %tic用来保存当前时间，而后使用toc来记录程序完成时间</p> 
 <p style=""></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bd7c6bf3d1906e554bf05f5dcc1eacc7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Html5新增了什么</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/771e57e378c04762ebb21d139b074156/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">神经网络中的注意力机制与外部记忆</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>