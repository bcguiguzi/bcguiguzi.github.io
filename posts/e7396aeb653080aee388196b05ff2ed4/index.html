<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>记一些Python(Pymysql)建表、增删改查等基础操作(小白适用) - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="记一些Python(Pymysql)建表、增删改查等基础操作(小白适用)" />
<meta property="og:description" content="1、读取sql文件创建数据表 有一个形如下图的sql文件，使用python读取文件并在数据库中创建所有的表。
很多人学习python，不知道从何学起。
很多人学习python，掌握了基本语法过后，不知道在哪里寻找案例上手。
很多已经做案例的人，却不知道如何去学习更加高深的知识。
那么针对这三类人，我给大家提供一个好的学习平台，免费领取视频教程，电子书籍，以及课程的源代码！
QQ群：101677771
代码是很久以前搬的，忘了出处了&gt; &lt;，输入sql文件名称和数据库名称即可创建，执行成功或失败时都会有打印哪条sql语句执行成功或失败
import pymysql def CreateTables(document,database): try: db = pymysql.connect(host=&#39;localhost&#39;, user=&#39;root&#39;, password=&#39;123&#39;, database=database, charset=&#39;utf8&#39;) cursor = db.cursor() with open(document,encoding=&#39;utf-8&#39;,mode = &#39;r&#39;) as f: sql_list = f.read().split(&#39;;&#39;)[:-1] for x in sql_list: if &#39;\n&#39; in x: x= x.replace(&#39;\n&#39;,&#39; &#39;) if &#39; &#39; in x: x= x.replace(&#39; &#39;,&#39; &#39;) sql_item = x&#43;&#39;;&#39; cursor.execute(sql_item) print(&#34;执行成功sql:%s&#34;%sql_item) except Exception as e: print(e) print(&#39;执行失败sql：%s&#39;%sql_item) finally: cursor.close() db.commit() db.close() 2、增删改查 假设如上面sql文件里的table_1，想在数据库中创建一个这样的表" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/e7396aeb653080aee388196b05ff2ed4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-27T20:33:43+08:00" />
<meta property="article:modified_time" content="2020-08-27T20:33:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">记一些Python(Pymysql)建表、增删改查等基础操作(小白适用)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>1、读取sql文件创建数据表</h3> 
<p>有一个形如下图的sql文件，使用python读取文件并在数据库中创建所有的表。</p> 
<p><strong>很多人学习python，不知道从何学起。<br> 很多人学习python，掌握了基本语法过后，不知道在哪里寻找案例上手。<br> 很多已经做案例的人，却不知道如何去学习更加高深的知识。<br> 那么针对这三类人，我给大家提供一个好的学习平台，免费领取视频教程，电子书籍，以及课程的源代码！<br> QQ群：101677771</strong><img alt="在这里插入图片描述" src="https://images2.imgbox.com/18/e6/nGA4JCJx_o.png"><br> 代码是很久以前搬的，忘了出处了&gt; &lt;，输入sql文件名称和数据库名称即可创建，执行成功或失败时都会有打印哪条sql语句执行成功或失败</p> 
<pre><code>import pymysql

def CreateTables(document,database):
    try:
        db = pymysql.connect(host='localhost', user='root', password='123', database=database, charset='utf8')
        cursor = db.cursor()
        with open(document,encoding='utf-8',mode = 'r') as f:
            sql_list = f.read().split(';')[:-1]
            for x in sql_list:
                if '\n' in x:
                    x= x.replace('\n',' ')
                if '   ' in x:
                    x= x.replace('   ',' ')
                sql_item = x+';'
                cursor.execute(sql_item)
                print("执行成功sql:%s"%sql_item)
    except Exception as e:
        print(e)
        print('执行失败sql：%s'%sql_item)
    finally:
        cursor.close()
        db.commit()
        db.close()</code></pre> 
<h3><a name="t1"></a><a id="2_30"></a>2、增删改查</h3> 
<p>假设如上面sql文件里的table_1，想在数据库中创建一个这样的表</p> 
<table><thead><tr><th>Id</th><th>Name</th><th>Type</th></tr></thead><tbody><tr><td>213</td><td>亚索</td><td>中单</td></tr><tr><td>443</td><td>薇恩</td><td>ADC</td></tr><tr><td>4396</td><td>李青</td><td>打野</td></tr></tbody></table> 
<p>则在python中创建一个形如<code>dict = {"Id":213,"Name":亚索,"Type":"中单"}</code>的字典，并将每列数据放入一个list中，即<code>list = [{"Id":213,"Name":亚索,"Type":"中单"},{"Id":443,"Name":薇恩,"Type":"ADC"},{"Id":4396,"Name":李青,"Type":"打野"}]</code>,遍历该字典插入数据</p> 
<pre><code>import pymysql
lists = [{"Id":213,"Name":亚索,"Type":"中单"},{"Id":443,"Name":薇恩,"Type":"ADC"},{"Id":4396,"Name":李青,"Type":"打野"}]
table = 'table_1'
name = '亚索'
db = pymysql.connect(host='localhost', user='root', password='123', database='test', charset='utf8')
cursor = db.cursor()
#增
for lis in lists:
	keys = ','.join(lis.keys())
	values = ','.join(['%s'] * len(lis))
	sql = 'INSERT INTO {table} ({keys}) VALUES ({values})'.format(table=table, keys=keys, values=values)
	cursor.execute(sql, tuple(lis.values()))
#删
sql = "DELETE FROM talbe_1 WHERE Name = '%s'"%name
cursor.execute(sql)
#改
sql = "UPDATE table_1 SET id = 666 WHERE Name = '%s'"%name
cursor.execute(sql)
#查
sql = "SELECT * FROM table_1"
cursor.execute(sql)
res = cursor.fetchall()

cursor.close()
db.commit()
db.close()
</code></pre> 
<h3><a name="t2"></a><a id="3_69"></a>3、自增序号从当前最大值开始连续</h3> 
<p>如table_3的nId为自增序号，假设表中有1,2,3…48条数据，再删除了45,46,47,48后，新增数据依旧会从49开始编号造成不连续，为了让它连续的继续从45开始编号，应添加下列代码</p> 
<pre><code>sql = 'ALTER TABLE table_3 auto_increment = 1'
cursor.execute(sql)</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/87a2748b9505b19ac92cc69793a64b12/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Servlet使用注解访问不到页面地址404解决</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a5f657adf5b4c1939cb0c6a500e147bd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python给excel文件加密码，并重新生成文件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>