<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>z3 guide - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="z3 guide" />
<meta property="og:description" content="Z3是微软研究院开发的高性能定理证明程序。Z3有许多应用场合，如:软件/硬件验证和测试，约束求解，混合系统的分析，安全，生物(硅分析)，几何问题。 Z3发行版还包含C、C&#43;&#43;、.Net、Java和OCaml 的api。Z3Py的源代码可以在GitHub上的Z3发行版中获得.
导入z3 !pip install &#34;z3-solver&#34; from z3 import * 从一个简单例子开始 x = Int(&#39;x&#39;) y = Int(&#39;y&#39;) solve(x &gt; 2, y &lt; 10, x &#43; 2*y == 7) &#39;&#39;&#39; [y = 0, x = 7] &#39;&#39;&#39; 在Z3中函数Int(&#39;x&#39;)创建了一个整数变量x，solve函数求解一个约束系统。上面的例子使用了两个变量x和y以及3个约束.
公式/表达式的化简 x = Int(&#39;x&#39;) y = Int(&#39;y&#39;) print(simplify(x &#43; y &#43; 2*x &#43; 3)) print(simplify(x &lt; y &#43; x &#43; 2)) print(simplify(And(x &#43; 1 &gt;= 3, x**2 &#43; x**2 &#43; y**2 &#43; 2 &gt;= 5))) &#39;&#39;&#39; 3 &#43; 3*x &#43; y Not(y &lt;= -2) And(x &gt;= 2, 2*x**2 &#43; y**2 &gt;= 3) &#39;&#39;&#39; 设置显示方法 默认情况下，Z3Py(用于web)使用数学符号显示公式和表达式。通常，∧是逻辑的和，∨是逻辑的或，等等。命令set_option(html_mode=False)使所有公式和表达式以Z3Py表示法显示。这也是Z3发行版附带的Z3Py脱机版本的默认模式" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/45843edbb009998535a86fd0b551c859/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-27T10:02:18+08:00" />
<meta property="article:modified_time" content="2021-01-27T10:02:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">z3 guide</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>Z3是微软研究院开发的高性能定理证明程序。Z3有许多应用场合，如:软件/硬件验证和测试，约束求解，混合系统的分析，安全，生物(硅分析)，几何问题。 Z3发行版还包含C、C++、.Net、Java和OCaml 的api。Z3Py的源代码可以在<a href="https://github.com/z3prover/z3.git">GitHub</a>上的Z3发行版中获得.</p> 
<h2><a id="z3_2"></a>导入z3</h2> 
<pre><code class="prism language-python">!pip install <span class="token string">"z3-solver"</span>
<span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>
</code></pre> 
<h2><a id="_9"></a>从一个简单例子开始</h2> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">,</span> y <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">,</span> x <span class="token operator">+</span> <span class="token number">2</span><span class="token operator">*</span>y <span class="token operator">==</span> <span class="token number">7</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[y = 0, x = 7]
'''</span>
</code></pre> 
<p>在Z3中函数<code>Int('x')</code>创建了一个整数变量<code>x</code>，<code>solve</code>函数求解一个约束系统。上面的例子使用了两个变量<code>x</code>和<code>y</code>以及3个约束.</p> 
<h3><a id="_21"></a>公式/表达式的化简</h3> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>simplify<span class="token punctuation">(</span>x <span class="token operator">+</span> y <span class="token operator">+</span> <span class="token number">2</span><span class="token operator">*</span>x <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>simplify<span class="token punctuation">(</span>x <span class="token operator">&lt;</span> y <span class="token operator">+</span> x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>simplify<span class="token punctuation">(</span>And<span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">,</span> x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> y<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">&gt;=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
3 + 3*x + y
Not(y &lt;= -2)
And(x &gt;= 2, 2*x**2 + y**2 &gt;= 3)
'''</span>
</code></pre> 
<h3><a id="_35"></a>设置显示方法</h3> 
<p>默认情况下，Z3Py(用于web)使用数学符号显示公式和表达式。通常，∧是逻辑的和，∨是逻辑的或，等等。命令<code>set_option(html_mode=False)</code>使所有公式和表达式以Z3Py表示法显示。这也是Z3发行版附带的Z3Py脱机版本的默认模式</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> y<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span>
set_option<span class="token punctuation">(</span>html_mode<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> y<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
x**2 + y**2 &gt;= 1
x**2 + y**2 &gt;= 1
'''</span>
set_option<span class="token punctuation">(</span>html_mode<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> y<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
x&lt;sup&gt;2&lt;/sup&gt; + y&lt;sup&gt;2&lt;/sup&gt; &amp;ge; 1
'''</span>
</code></pre> 
<p>将打印的结果拷贝到markdown-cell中，显示如下</p> 
<p>x<sup>2</sup> + y<sup>2</sup> ≥ 1</p> 
<h3><a id="_60"></a>遍历表达式</h3> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> x <span class="token operator">+</span> y <span class="token operator">&gt;=</span> <span class="token number">3</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"num args: "</span><span class="token punctuation">,</span> n<span class="token punctuation">.</span>num_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"children: "</span><span class="token punctuation">,</span> n<span class="token punctuation">.</span>children<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"1st child:"</span><span class="token punctuation">,</span> n<span class="token punctuation">.</span>arg<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"2nd child:"</span><span class="token punctuation">,</span> n<span class="token punctuation">.</span>arg<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"operator: "</span><span class="token punctuation">,</span> n<span class="token punctuation">.</span>decl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"op name:  "</span><span class="token punctuation">,</span> n<span class="token punctuation">.</span>decl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
num args:  2
children:  [x + y, 3]
1st child: x + y
2nd child: 3
operator:  &amp;ge;
op name:   &gt;=
'''</span>
</code></pre> 
<h3><a id="_82"></a>求解非线性多项式约束</h3> 
<p>Z3提供了所有基本的数学运算。Z3Py使用与Python语言相同的操作符优先级。和Python一样，<code>**</code>是幂运算符。Z3可以求解非线性多项式约束。</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">0.12</span> <span class="token operator">*</span> y<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">,</span> x<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">+</span> y <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[x = 1/8, y = 639/128]
'''</span>
</code></pre> 
<h3><a id="_95"></a>实数表示</h3> 
<p>上面的程序<code>Real('x')</code>创建了实数变量<code>x</code>。Z3Py可以表示任意大的整数、有理数(如上面的例子)和无理数代数数。无理数是系数为整数的多项式的根。在内部，Z3精确地表示了所有这些数字。无理数以十进制表示，以便于阅读结果。</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> y<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">,</span> x<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>

set_option<span class="token punctuation">(</span>precision<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Solving, and displaying result with 30 decimal places"</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> y<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">,</span> x<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[x = 1.2599210498?, y = -1.1885280594?]
Solving, and displaying result with 30 decimal places
[x = 1.259921049894873164767210607278?,
 y = -1.188528059421316533710369365015?]
'''</span>
</code></pre> 
<p><code>set_option</code>用于配置Z3环境。它用于设置全局配置选项，例如如何显示结果,<code>set_option(precision=30)</code>设置显示结果时使用的小数位数。1.259921049894873164767210607278?中的 <strong>?</strong> 表示截断输出。</p> 
<h3><a id="_117"></a>常见错误</h3> 
<p>表达式3/2是一个Python整数，而不是Z3有理数。下面示例展示了在Z3Py中创建有理数的不同方法。程序<code>Q(num, den)</code>创建一个Z3有理数，其中<code>num</code>是分子，<code>den</code>是分母。<code>RealVal(1)</code>创建一个Z3实数表示数字1。</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>RealVal<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span>

x <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token string">"1/3"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">0.25</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
0.3333333333333333
1/3
x + 3333333333333333/10000000000000000
x + 1/3
x + 1/4
'''</span>
</code></pre> 
<h3><a id="_138"></a>用十进制数表示有理数</h3> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>x<span class="token operator">*</span>x <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[x = -0.816496580927726032732428024901?]
'''</span>
set_option<span class="token punctuation">(</span>rational_to_decimal<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>x <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>

set_option<span class="token punctuation">(</span>precision<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>x <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
set_option<span class="token punctuation">(</span>rational_to_decimal<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span><span class="token number">6</span><span class="token operator">*</span>x <span class="token operator">==</span> <span class="token number">37</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[x = 0.3333333333?]
[x = 0.33333333333333333333?]
[x = 37/6]
'''</span>
</code></pre> 
<p>约束系统可能没有解。在这种情况下，我们说这个系统是不可满足的。</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token number">4</span><span class="token punctuation">,</span> x <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
no solution
'''</span>
</code></pre> 
<h2><a id="_170"></a>布尔逻辑</h2> 
<p>Z3支持布尔运算符:<code>And</code>,<code>Or</code>, <code>Not</code>, <code>Implies</code>(implication)，<code>If</code> (If -then-else)。 Bi-implications 用 == 表示。下面的例子展示了如何求解一个简单的布尔约束集。</p> 
<pre><code class="prism language-python">p <span class="token operator">=</span> Bool<span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> Bool<span class="token punctuation">(</span><span class="token string">'q'</span><span class="token punctuation">)</span>
r <span class="token operator">=</span> Bool<span class="token punctuation">(</span><span class="token string">'r'</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>Implies<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">,</span> r <span class="token operator">==</span> Not<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">,</span> Or<span class="token punctuation">(</span>Not<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[q = True, p = False, r = False]
'''</span>
</code></pre> 
<p>Python的布尔常量<code>True</code>和<code>False</code>可用于构建Z3布尔表达式。</p> 
<pre><code class="prism language-python">p <span class="token operator">=</span> Bool<span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> Bool<span class="token punctuation">(</span><span class="token string">'q'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>And<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>simplify<span class="token punctuation">(</span>And<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>simplify<span class="token punctuation">(</span>And<span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
And(p, q, True)
And(p, q)
False
'''</span>
</code></pre> 
<p>下面的例子使用了多项式和布尔约束的组合。</p> 
<pre><code class="prism language-python">p <span class="token operator">=</span> Bool<span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>Or<span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">,</span> x <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Or<span class="token punctuation">(</span>p<span class="token punctuation">,</span> x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Not<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[x = -1.4142135623?, p = False]
'''</span>
</code></pre> 
<h2><a id="Solvers_210"></a>Solvers</h2> 
<p>Z3提供不同的求解器。在前面的示例中使用的<code>solve</code>命令是使用Z3求解器API实现的。该实现可以在Z3发行版中的Z3 .py文件中找到。下面的示例演示了基本的<code>Solver</code>API</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>

s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>

s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">,</span> y <span class="token operator">==</span> x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Solving constraints in the solver s ..."</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Create a new scope..."</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>push<span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>y <span class="token operator">&lt;</span> <span class="token number">11</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Solving updated set of constraints..."</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Restoring state..."</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Solving restored set of constraints..."</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[]
[x &gt; 10, y == x + 2]
Solving constraints in the solver s ...
sat
Create a new scope...
[x &gt; 10, y == x + 2, y &lt; 11]
Solving updated set of constraints...
unsat
Restoring state...
[x &gt; 10, y == x + 2]
Solving restored set of constraints...
sat
'''</span>
</code></pre> 
<p>命令<code>Solver()</code>创建一个通用求解器。可以使用<code>add</code>方法添加约束。我们说约束已在求解器中断言。<code>check()</code>方法求解断言的约束。如果找到了一个解，那么结果就是<code>sat</code>(satisfiable)可满足的。如果不存在解，结果就是<code>unsat</code>(unsatisfiable)(不可满足)。也可以说所断言的约束系统是不可行的。最后，求解器可能无法求解约束系统而返回未知数。</p> 
<p>在一些应用中，我们想探讨几个类似的问题，共享几个约束条件。我们可以使用<code>push</code>和<code>pop</code>命令来实现这一点。每个求解器维护一个断言栈。命令<code>push</code>通过保存当前堆栈大小来创建一个新的范围。命令<code>pop</code>将删除与匹配<code>push</code>之间的任何断言。<code>check</code>方法总是对求解器断言堆栈的内容进行操作。</p> 
<p>下面的例子显示了一个Z3无法解决的例子。在这种情况下，求解器返回<code>unknown</code>。回想一下，Z3可以解非线性多项式约束，但<code>2**x</code>不是多项式。</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span>x <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
unknown
'''</span>
</code></pre> 
<p>下面的示例演示如何遍历在求解器中断言的约束，以及如何为<code>check</code>方法收集性能统计信息。</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span> Or<span class="token punctuation">(</span>x <span class="token operator">+</span> y <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">,</span> x <span class="token operator">-</span> y <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"asserted constraints..."</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> c <span class="token keyword">in</span> s<span class="token punctuation">.</span>assertions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"statistics for the last check method..."</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>statistics<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># Traversing statistics</span>
<span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> s<span class="token punctuation">.</span>statistics<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%s : %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
<span class="token triple-quoted-string string">'''
asserted constraints...
x &gt; 1
y &gt; 1
Or(x + y &gt; 3, x - y &lt; 2)
sat
statistics for the last check method...
(:arith-make-feasible 3
 :arith-max-columns   8
 :arith-max-rows      2
 :arith-upper         4
 :decisions           2
 :final-checks        1
 :max-memory          2.90
 :memory              2.59
 :mk-bool-var         6
 :num-allocs          63585276
 :num-checks          1
 :rlimit-count        2013
 :time                0.01)
mk bool var : 1
decisions : 2
final checks : 1
num checks : 1
mk bool var : 5
arith-upper : 4
arith-make-feasible : 3
arith-max-columns : 8
arith-max-rows : 2
num allocs : 63585276
rlimit count : 2013
max memory : 2.9
memory : 2.59
time : 0.006
'''</span>
</code></pre> 
<p>当Z3为断言的约束集找到一个解时,<code>check</code>返回<code>sat</code>。我们说Z3满足这个约束集。我们说<strong>解</strong>是一组<strong>断言的约束</strong>的<strong>模型</strong>。<strong>模型</strong>是使<strong>每个断言的约束</strong>为真的<strong>解释</strong>。 We say the solution is a model for the set of asserted constraints. A model is an interpretation that makes each asserted constraint true.</p> 
<p>下面的例子展示了检查模型的基本方法</p> 
<pre><code class="prism language-python">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z <span class="token operator">=</span> Reals<span class="token punctuation">(</span><span class="token string">'x y z'</span><span class="token punctuation">)</span>
s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span> x <span class="token operator">+</span> y <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">,</span> z <span class="token operator">-</span> x <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

m <span class="token operator">=</span> s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"x = %s"</span> <span class="token operator">%</span> m<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"traversing model..."</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> d <span class="token keyword">in</span> m<span class="token punctuation">.</span>decls<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%s = %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span>name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
sat
x = 3/2
traversing model...
z = 0
y = 2
x = 3/2
'''</span>
</code></pre> 
<p>在上面的例子中，函数<code>Reals('x y z')</code>创建了变量x, y和z，是下面示例的简写</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
z <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_359"></a>算数</h2> 
<p>Z3支持实数和整数变量。它们可以混合在一个问题中。像大多数编程语言一样，Z3Py会在需要时会自动强制转换。下面的例子演示了声明整数和实变量的不同方法。</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Real<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token operator">=</span> Reals<span class="token punctuation">(</span><span class="token string">'a b c'</span><span class="token punctuation">)</span>
s<span class="token punctuation">,</span> r <span class="token operator">=</span> Ints<span class="token punctuation">(</span><span class="token string">'s r'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x <span class="token operator">+</span> y <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ToReal<span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">+</span> c<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
x + ToReal(y) + 1 + a + ToReal(s)
ToReal(y) + c
'''</span>
</code></pre> 
<p>Z3Py支持所有基本的算术操作。</p> 
<pre><code class="prism language-python">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token operator">=</span> Ints<span class="token punctuation">(</span><span class="token string">'a b c'</span><span class="token punctuation">)</span>
d<span class="token punctuation">,</span> e <span class="token operator">=</span> Reals<span class="token punctuation">(</span><span class="token string">'d e'</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>a <span class="token operator">&gt;</span> b <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span>
      a <span class="token operator">==</span> <span class="token number">2</span><span class="token operator">*</span>c <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">,</span>
      c <span class="token operator">+</span> b <span class="token operator">&lt;=</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      d <span class="token operator">&gt;=</span> e<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[c = 0, b = 0, e = 0, d = 0, a = 10]
'''</span>
</code></pre> 
<p>命令<code>simplify</code>对Z3表达式进行化简。</p> 
<pre><code class="prism language-python">x<span class="token punctuation">,</span> y <span class="token operator">=</span> Reals<span class="token punctuation">(</span><span class="token string">'x y'</span><span class="token punctuation">)</span>
<span class="token comment"># 把表达式转换成多项式和的形式</span>
t <span class="token operator">=</span> simplify<span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">,</span> som<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
<span class="token comment"># 使用指数操作</span>
t <span class="token operator">=</span> simplify<span class="token punctuation">(</span>t<span class="token punctuation">,</span> mul_to_power<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
x*x*x + 3*x*x*y + 3*x*y*y + y*y*y
x**3 + 3*x**2*y + 3*x*y**2 + y**3
'''</span>
</code></pre> 
<p>命令<code>help_simplify()</code>打印所有可用的 options 。Z3Py允许用户以两种方式使用option。</p> 
<ul><li><strong>:</strong> option names，单词之间用 <strong>-</strong> 分隔</li><li>Z3Py也支持类似python的名称，其中不用 <strong>:</strong> ， <strong>-</strong> 被替换为 <strong>_</strong> 。</li></ul> 
<p>下面的例子演示了如何使用这两种方式</p> 
<pre><code class="prism language-python">x<span class="token punctuation">,</span> y <span class="token operator">=</span> Reals<span class="token punctuation">(</span><span class="token string">'x y'</span><span class="token punctuation">)</span>
<span class="token comment"># Using Z3 native option names</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>simplify<span class="token punctuation">(</span>x <span class="token operator">==</span> y <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">':arith-lhs'</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># Using Z3Py option names</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>simplify<span class="token punctuation">(</span>x <span class="token operator">==</span> y <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> arith_lhs<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nAll available options:"</span><span class="token punctuation">)</span>
help_simplify<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#内容较多，没有显示</span>
<span class="token triple-quoted-string string">'''
x + -1*y == 2
x + -1*y == 2

All available options:
'''</span>
</code></pre> 
<h2><a id="_430"></a>大数字</h2> 
<p>Z3Py支持任意大的数字。下面的例子演示如何使用较大的整数、有理数和无理数执行基本算术。Z3Py只支持代数无理数。代数无理数对于给出多项式约束系统的解是足够的。Z3Py将总是以十进制表示无理数，因为这样更便于阅读。内部表示可以使用方法<code>sexpr()</code>提取。它以<code>s-expression</code>(类似<code>Lisp</code>)表示法来显示数学公式和表达式的Z3内部表示形式。</p> 
<pre><code class="prism language-python">x<span class="token punctuation">,</span> y <span class="token operator">=</span> Reals<span class="token punctuation">(</span><span class="token string">'x y'</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">10000000000000000000000</span> <span class="token operator">==</span> y<span class="token punctuation">,</span> y <span class="token operator">&gt;</span> <span class="token number">20000000000000000</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>Sqrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> Sqrt<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>simplify<span class="token punctuation">(</span>Sqrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> Sqrt<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>simplify<span class="token punctuation">(</span>Sqrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> Sqrt<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sexpr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># The sexpr() method is available for any Z3 expression</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">+</span> Sqrt<span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sexpr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[y = 20000000000000001, x = -9999979999999999999999]
2&lt;sup&gt;1/2&lt;/sup&gt; + 3&lt;sup&gt;1/2&lt;/sup&gt;
3.146264369941972342329135065715?
(root-obj (+ (^ x 4) (* (- 10) (^ x 2)) 1) 4)
(+ x (* (^ y (/ 1.0 2.0)) 2.0))
'''</span>
</code></pre> 
<h2><a id="_452"></a>机器运算</h2> 
<p>现代cpu和主流编程语言在固定大小的位向量上使用算术。Z3Py也可以使用位向量上的机器运算。它实现了无符号和有符号双补码算术的精确语义。<br> 下面的例子演示了如何创建位向量变量和常量。函数<code>BitVec('x',16)</code>在Z3中创建了一个名为x的16位位向量变量。为了方便起见，在Z3Py中可以使用整数常量来创建位向量表达式。函数<code>BitVecVal(10,32)</code>创建一个32位的位向量，其值为10。</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> BitVec<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> BitVec<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 内部表示</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sexpr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># -1和65535在16bit的时候相等</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>simplify<span class="token punctuation">(</span>x <span class="token operator">+</span> y <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 创建位向量常量</span>
a <span class="token operator">=</span> BitVecVal<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> BitVecVal<span class="token punctuation">(</span><span class="token number">65535</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>simplify<span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>

a <span class="token operator">=</span> BitVecVal<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> BitVecVal<span class="token punctuation">(</span><span class="token number">65535</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>
<span class="token comment"># -1和65535在32bit的时候不相等</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>simplify<span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
x + 2
(bvadd x #x0002)
65535 + x + y
True
False
'''</span>
</code></pre> 
<p>与编程语言相反，例如在C, C++，C#，Java中，有符号和无符号的位向量作为数字没有区别。相反，Z3提供了特殊的有符号版本的算术操作，其中位向量是有符号还是无符号处理是不同的。在Z3Py中，操作符<code>&lt;</code>，<code>&lt;=</code>，<code>&gt;</code>，<code>&gt;=</code>，<code>/</code>，<code>%</code>和<code>&gt;&gt;</code>对应有符号的版本。对应的无符号操作符是:<code>ULT</code>、<code>ULE</code>、<code>UGT</code>、<code>UGE</code>、<code>UDiv</code>、<code>URem</code>和<code>LShR</code>(logical shift right)。</p> 
<pre><code class="prism language-python"><span class="token comment">#创建32bit的位向量</span>
x<span class="token punctuation">,</span> y <span class="token operator">=</span> BitVecs<span class="token punctuation">(</span><span class="token string">'x y'</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>

solve<span class="token punctuation">(</span>x <span class="token operator">+</span> y <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span> x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[y = 1, x = 1]
'''</span>
solve<span class="token punctuation">(</span>x <span class="token operator">&amp;</span> y <span class="token operator">==</span> <span class="token operator">~</span>y<span class="token punctuation">)</span>

solve<span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># 使用无符号小于</span>
solve<span class="token punctuation">(</span>ULT<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[y = 4294967295, x = 0]
[x = 4294967295]
no solution
'''</span>
</code></pre> 
<pre><code class="prism language-python">x<span class="token punctuation">,</span> y <span class="token operator">=</span> BitVecs<span class="token punctuation">(</span><span class="token string">'x y'</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>

solve<span class="token punctuation">(</span>x <span class="token operator">&gt;&gt;</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>x <span class="token operator">&lt;&lt;</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>x <span class="token operator">&lt;&lt;</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">24</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[x = 12]
no solution
[x = 6]
'''</span>
</code></pre> 
<h2><a id="_521"></a>函数</h2> 
<p>在编程语言中，函数有副作用，可以抛出异常，或者永远不会返回，而Z3中的函数没有副作用，而且是完备的。也就是说，它定义在所有输入值上，包括像除法这样的函数。Z3是基于一阶逻辑的。</p> 
<p>给定一个约束条件，例如<code>x+y &gt; 3</code>,我们已经说过x和y是变量。在许多教科书中，x和y被称为未解释常数。也就是说，它们允许任何与约束<code>x+y &gt; 3</code>一致的解释.</p> 
<p>更准确地说，纯一阶逻辑中的函数符号和常数符号是未解释的或自由的，这意味着没有附加任何先验解释。这与属于理论特征的函数相反，例如算术函数 <code>+</code>有一个固定的标准解释(它加两个数)。未解释的函数和常量是最灵活的;它们允许任何与函数或常数约束一致的解释。</p> 
<p>为了说明未解释的函数和常量，让我们来看看未解释的整数常量(也就是变量)<code>x</code>,<code>y</code>。最后，让<code>f</code>是一个未解释的函数，它接受一个整型参数(也就是<code>sort</code>)并得到一个整数值。这个例子说明了如何强制解释 f 对 x 应用两次会得到x，但 f 对 x 应用一次会不同于x。</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
f <span class="token operator">=</span> Function<span class="token punctuation">(</span><span class="token string">'f'</span><span class="token punctuation">,</span> IntSort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> IntSort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>f<span class="token punctuation">(</span>f<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> x<span class="token punctuation">,</span> f<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> y<span class="token punctuation">,</span> x <span class="token operator">!=</span> y<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[x = 0, y = 1, f = [1 -&gt; 0, else -&gt; 1]]
'''</span>
</code></pre> 
<p><code>f</code>的解(解释)应该是<code>f(0) = 1</code> <code>f(1) = 0</code>，<code>f(a)=1</code>(<code>a≠0</code>，<code>a≠1</code>)</p> 
<p>在Z3中，我们也可以对约束系统的模型表达式求值。下面的示例演示如何使用<code>evaluate</code>方法。</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
f <span class="token operator">=</span> Function<span class="token punctuation">(</span><span class="token string">'f'</span><span class="token punctuation">,</span> IntSort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> IntSort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">(</span>f<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> x<span class="token punctuation">,</span> f<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> y<span class="token punctuation">,</span> x <span class="token operator">!=</span> y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
m <span class="token operator">=</span> s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"f(f(x)) ="</span><span class="token punctuation">,</span> m<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>f<span class="token punctuation">(</span>f<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"f(x)    ="</span><span class="token punctuation">,</span> m<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>f<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
sat
f(f(x)) = 0
f(x)    = 1
'''</span>
</code></pre> 
<h2><a id="_562"></a>可满足性和有效性</h2> 
<p><strong>validity</strong>:逻辑公式总是为真</p> 
<p><strong>satisfiable</strong>:逻辑公式有时候为真，有时候为假</p> 
<p><strong>unsatisfiable</strong>:逻辑公式永远为假</p> 
<p>下面的例子证明了德摩根定律。下面的示例重新定义了Z3Py函数，它接收一个公式作为参数。这个函数创建一个<code>Solver</code>，添加/断言公式的否定，并检查否定是否不可满足。这个函数的实现是Z3Py命令prove的一个简单版本。</p> 
<pre><code class="prism language-python">p<span class="token punctuation">,</span> q <span class="token operator">=</span> Bools<span class="token punctuation">(</span><span class="token string">'p q'</span><span class="token punctuation">)</span>
demorgan <span class="token operator">=</span> And<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span> <span class="token operator">==</span> Not<span class="token punctuation">(</span>Or<span class="token punctuation">(</span>Not<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> Not<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>demorgan<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">prove</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">:</span>
    s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Not<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> unsat<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"proved"</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"failed to prove"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Proving demorgan..."</span><span class="token punctuation">)</span>
prove<span class="token punctuation">(</span>demorgan<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
And(p, q) == Not(Or(Not(p), Not(q)))
Proving demorgan...
proved
'''</span>
</code></pre> 
<h2><a id="_594"></a>列表推导</h2> 
<p>Python支持列表推导式。列表推导式提供了一种简洁的创建列表的方式。它们可以在Z3Py中创建Z3表达式和问题。下面的例子演示了如何在Z3Py中使用Python列表推导式。</p> 
<pre><code class="prism language-python"><span class="token comment"># 创建列表 [1, ..., 5] </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">[</span> x <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 创建两个包含5个整数变量的列表</span>
X <span class="token operator">=</span> <span class="token punctuation">[</span> Int<span class="token punctuation">(</span><span class="token string">'x%s'</span> <span class="token operator">%</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
Y <span class="token operator">=</span> <span class="token punctuation">[</span> Int<span class="token punctuation">(</span><span class="token string">'y%s'</span> <span class="token operator">%</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>

<span class="token comment"># 创建一个包含 X[i]+Y[i] 的列表</span>
X_plus_Y <span class="token operator">=</span> <span class="token punctuation">[</span> X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> Y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>X_plus_Y<span class="token punctuation">)</span>

<span class="token comment"># 创建一个包含 X[i] &gt; Y[i]的列表</span>
X_gt_Y <span class="token operator">=</span> <span class="token punctuation">[</span> X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> Y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>X_gt_Y<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>And<span class="token punctuation">(</span>X_gt_Y<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#创建一个3*3的整数变量的矩阵</span>
X <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span> Int<span class="token punctuation">(</span><span class="token string">"x_%s_%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
      <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
pp<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[1, 2, 3, 4, 5]
[x0, x1, x2, x3, x4]
[x0 + y0, x1 + y1, x2 + y2, x3 + y3, x4 + y4]
[x0 &gt; y0, x1 &gt; y1, x2 &gt; y2, x3 &gt; y3, x4 &gt; y4]
And(x0 &gt; y0, x1 &gt; y1, x2 &gt; y2, x3 &gt; y3, x4 &gt; y4)
[[x_1_1, x_1_2, x_1_3],
 [x_2_1, x_2_2, x_2_3],
 [x_3_1, x_3_2, x_3_3]]
'''</span>
</code></pre> 
<p><code>pp</code>命令类似于<code>print</code>，但它使用Z3Py格式化器来格式化列表和元组，而不是Python的格式化器。<br> Z3Py还提供了创建布尔值、整数和实变量的向量的函数。这些函数是使用列表推导式实现的。</p> 
<pre><code class="prism language-python">X <span class="token operator">=</span> IntVector<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
Y <span class="token operator">=</span> RealVector<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
P <span class="token operator">=</span> BoolVector<span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">[</span> y<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> y <span class="token keyword">in</span> Y <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Sum<span class="token punctuation">(</span><span class="token punctuation">[</span> y<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> y <span class="token keyword">in</span> Y <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[x__0, x__1, x__2, x__3, x__4]
[y__0, y__1, y__2, y__3, y__4]
[p__0, p__1, p__2, p__3, p__4]
[y__0**2, y__1**2, y__2**2, y__3**2, y__4**2]
y__0**2 + y__1**2 + y__2**2 + y__3**2 + y__4**2
'''</span>
</code></pre> 
<h2><a id="_654"></a>应用</h2> 
<h3><a id="_656"></a>运动学方程</h3> 
<p>在高中，学生学习运动学方程。这些方程描述了位移(d)、时间(t)、加速度(a)、初速度(v_i)和最终速度(v_f)之间的数学关系。在Z3Py表示法中，我们可以把这些方程写成:</p> 
<pre><code class="prism language-python">a<span class="token punctuation">,</span> t <span class="token punctuation">,</span>v_i<span class="token punctuation">,</span> v_f <span class="token operator">=</span> Reals<span class="token punctuation">(</span><span class="token string">'a t v__i v__f'</span><span class="token punctuation">)</span> <span class="token comment">#missing in HTML?</span>
d <span class="token operator">==</span> v_i <span class="token operator">*</span> t <span class="token operator">+</span> <span class="token punctuation">(</span>a<span class="token operator">*</span>t<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>
v_f <span class="token operator">==</span> v_i <span class="token operator">+</span> a<span class="token operator">*</span>t
</code></pre> 
<p>v<sub>f</sub> =v<sub>i</sub>+a*t</p> 
<pre><code class="prism language-python">v_f
</code></pre> 
<p>v<sub>f</sub></p> 
<p>问题1</p> 
<p>小明正以30.0米/秒的速度接近红绿灯。红灯变成黄色，小明踩下刹车，刹了下来。如果小明的加速度为-8.00 m/s<sup>2</sup>，则确定汽车在打滑过程中的位移。</p> 
<pre><code class="prism language-python">d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> t<span class="token punctuation">,</span> v_i<span class="token punctuation">,</span> v_f <span class="token operator">=</span> Reals<span class="token punctuation">(</span><span class="token string">'d a t v__i v__f'</span><span class="token punctuation">)</span>

equations <span class="token operator">=</span> <span class="token punctuation">[</span>
   d <span class="token operator">==</span> v_i <span class="token operator">*</span> t <span class="token operator">+</span> <span class="token punctuation">(</span>a<span class="token operator">*</span>t<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>
   v_f <span class="token operator">==</span> v_i <span class="token operator">+</span> a<span class="token operator">*</span>t<span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Kinematic equations:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>equations<span class="token punctuation">)</span>

<span class="token comment"># Given v_i, v_f and a, find d</span>
problem <span class="token operator">=</span> <span class="token punctuation">[</span>
    v_i <span class="token operator">==</span> <span class="token number">30</span><span class="token punctuation">,</span>
    v_f <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span>
    a   <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">8</span>
<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Problem:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>problem<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Solution:"</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>equations <span class="token operator">+</span> problem<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
Kinematic equations:
[d == v__i*t + (a*t**2)/2, v__f == v__i + a*t]
Problem:
[v__i == 30, v__f == 0, a == -8]
Solution:
[a = -8, v__f = 0, v__i = 30, t = 15/4, d = 225/4]
'''</span>
</code></pre> 
<p>问题2</p> 
<p>小明在等红灯。当最终变绿时，小明从静止开始加速，速度为6.00 m/s<sup>2</sup>，持续时间为4.10秒。确定小明在这段时间的位移。</p> 
<pre><code class="prism language-python">d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> t<span class="token punctuation">,</span> v_i<span class="token punctuation">,</span> v_f <span class="token operator">=</span> Reals<span class="token punctuation">(</span><span class="token string">'d a t v__i v__f'</span><span class="token punctuation">)</span>

equations <span class="token operator">=</span> <span class="token punctuation">[</span>
   d <span class="token operator">==</span> v_i <span class="token operator">*</span> t <span class="token operator">+</span> <span class="token punctuation">(</span>a<span class="token operator">*</span>t<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>
   v_f <span class="token operator">==</span> v_i <span class="token operator">+</span> a<span class="token operator">*</span>t<span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment"># Given v_i, t and a, find d</span>
problem <span class="token operator">=</span> <span class="token punctuation">[</span>
    v_i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span>
    t   <span class="token operator">==</span> <span class="token number">4.10</span><span class="token punctuation">,</span>
    a   <span class="token operator">==</span> <span class="token number">6</span>
<span class="token punctuation">]</span>

solve<span class="token punctuation">(</span>equations <span class="token operator">+</span> problem<span class="token punctuation">)</span>

<span class="token comment"># Display rationals in decimal notation</span>
set_option<span class="token punctuation">(</span>rational_to_decimal<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

solve<span class="token punctuation">(</span>equations <span class="token operator">+</span> problem<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[a = 6, t = 41/10, v__i = 0, v__f = 123/5, d = 5043/100]
[a = 6, t = 4.1, v__i = 0, v__f = 24.6, d = 50.43]
'''</span>
</code></pre> 
<h3><a id="_740"></a>比特陷阱</h3> 
<p>经常在C程序(包括Z3)中测试一个机器整数是否为2的幂。我们可以用Z3来证明。当且仅当x是2的幂时，<code>x != 0 &amp;&amp; !(x &amp; (x - 1))</code>为真</p> 
<pre><code class="prism language-python">x      <span class="token operator">=</span> BitVec<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>
powers <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">2</span><span class="token operator">**</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
fast   <span class="token operator">=</span> And<span class="token punctuation">(</span>x <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">,</span> x <span class="token operator">&amp;</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
slow   <span class="token operator">=</span> Or<span class="token punctuation">(</span><span class="token punctuation">[</span> x <span class="token operator">==</span> p <span class="token keyword">for</span> p <span class="token keyword">in</span> powers <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>fast<span class="token punctuation">)</span>
prove<span class="token punctuation">(</span>fast <span class="token operator">==</span> slow<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"trying to prove buggy version..."</span><span class="token punctuation">)</span>
fast   <span class="token operator">=</span> x <span class="token operator">&amp;</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>
prove<span class="token punctuation">(</span>fast <span class="token operator">==</span> slow<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
And(x != 0, x &amp; x - 1 == 0)
proved
trying to prove buggy version...
failed to prove
'''</span>
</code></pre> 
<p>测试两个机器整数是否有相反的符号。</p> 
<pre><code class="prism language-python">x      <span class="token operator">=</span> BitVec<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>
y      <span class="token operator">=</span> BitVec<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>

<span class="token comment"># Claim: (x ^ y) &lt; 0 iff x and y have opposite signs</span>
trick  <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">^</span> y<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span>

<span class="token comment"># Naive way to check if x and y have opposite signs</span>
opposite <span class="token operator">=</span> Or<span class="token punctuation">(</span>And<span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              And<span class="token punctuation">(</span>x <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

prove<span class="token punctuation">(</span>trick <span class="token operator">==</span> opposite<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
proved
'''</span>
</code></pre> 
<h3><a id="_782"></a>谜题</h3> 
<p>考虑一下下面的难题。花100美元买100只动物。狗要15美元，猫要1美元，老鼠每只25美分。你必须至少买一种。每种你应该买多少?</p> 
<pre><code class="prism language-python"><span class="token comment"># Create 3 integer variables</span>
dog<span class="token punctuation">,</span> cat<span class="token punctuation">,</span> mouse <span class="token operator">=</span> Ints<span class="token punctuation">(</span><span class="token string">'dog cat mouse'</span><span class="token punctuation">)</span>
solve<span class="token punctuation">(</span>dog <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">,</span>   <span class="token comment"># at least one dog</span>
      cat <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">,</span>   <span class="token comment"># at least one cat</span>
      mouse <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment"># at least one mouse</span>
      <span class="token comment"># we want to buy 100 animals</span>
      dog <span class="token operator">+</span> cat <span class="token operator">+</span> mouse <span class="token operator">==</span> <span class="token number">100</span><span class="token punctuation">,</span>
      <span class="token comment"># We have 100 dollars (10000 cents):</span>
      <span class="token comment">#   dogs cost 15 dollars (1500 cents), </span>
      <span class="token comment">#   cats cost 1 dollar (100 cents), and </span>
      <span class="token comment">#   mice cost 25 cents </span>
      <span class="token number">1500</span> <span class="token operator">*</span> dog <span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">*</span> cat <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> mouse <span class="token operator">==</span> <span class="token number">10000</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[cat = 41, mouse = 56, dog = 3]
'''</span>
</code></pre> 
<h3><a id="_804"></a>数独</h3> 
<p>数独是一种非常流行的益智游戏。目标是在方框中插入数字，只满足一个条件:每一行、每一列和3x3的方框必须恰好包含1到9的数字一次。<br> <img src="https://images2.imgbox.com/40/e1/CIujJRmz_o.png" alt="在这里插入图片描述"><br> 下面的例子对Z3中的数独问题进行了编码。不同的数独实例可以通过修改矩阵实例来解决。这个例子大量使用了Python编程语言中的列表推导式。</p> 
<pre><code class="prism language-python">
 <span class="token comment"># 9x9 matrix of integer variables</span>
X <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span> Int<span class="token punctuation">(</span><span class="token string">"x_%s_%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
      <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>

<span class="token comment"># each cell contains a value in {1, ..., 9}</span>
cells_c  <span class="token operator">=</span> <span class="token punctuation">[</span> And<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;=</span> X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">9</span><span class="token punctuation">)</span>
             <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>

<span class="token comment"># each row contains a digit at most once</span>
rows_c   <span class="token operator">=</span> <span class="token punctuation">[</span> Distinct<span class="token punctuation">(</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>

<span class="token comment"># each column contains a digit at most once</span>
cols_c   <span class="token operator">=</span> <span class="token punctuation">[</span> Distinct<span class="token punctuation">(</span><span class="token punctuation">[</span> X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>
             <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>

<span class="token comment"># each 3x3 square contains a digit at most once</span>
sq_c     <span class="token operator">=</span> <span class="token punctuation">[</span> Distinct<span class="token punctuation">(</span><span class="token punctuation">[</span> X<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>i0 <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>j0 <span class="token operator">+</span> j<span class="token punctuation">]</span>
                        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>
             <span class="token keyword">for</span> i0 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j0 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>

sudoku_c <span class="token operator">=</span> cells_c <span class="token operator">+</span> rows_c <span class="token operator">+</span> cols_c <span class="token operator">+</span> sq_c

<span class="token comment"># sudoku instance, we use '0' for empty cells</span>
instance <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

instance_c <span class="token operator">=</span> <span class="token punctuation">[</span> If<span class="token punctuation">(</span>instance<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span>
                  <span class="token boolean">True</span><span class="token punctuation">,</span>
                  X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> instance<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
               <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>

s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>sudoku_c <span class="token operator">+</span> instance_c<span class="token punctuation">)</span>
<span class="token keyword">if</span> s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat<span class="token punctuation">:</span>
    m <span class="token operator">=</span> s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
    r <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span> m<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
          <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
    print_matrix<span class="token punctuation">(</span>r<span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"failed to solve"</span><span class="token punctuation">)</span>
    

<span class="token comment"># Let us remove 9 from the first row and see if there is more than one solution</span>

instance <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

instance_c <span class="token operator">=</span> <span class="token punctuation">[</span> If<span class="token punctuation">(</span>instance<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span>
                  <span class="token boolean">True</span><span class="token punctuation">,</span>
                  X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> instance<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
               <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>    
    
<span class="token keyword">def</span> <span class="token function">n_solutions</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>sudoku_c <span class="token operator">+</span> instance_c<span class="token punctuation">)</span>
    i <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat <span class="token operator">and</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">:</span>
        m <span class="token operator">=</span> s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> m<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        fml <span class="token operator">=</span> And<span class="token punctuation">(</span><span class="token punctuation">[</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> m<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Not<span class="token punctuation">(</span>fml<span class="token punctuation">)</span><span class="token punctuation">)</span>
        i <span class="token operator">+=</span> <span class="token number">1</span>
        
n_solutions<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[7, 1, 5, 8, 9, 4, 6, 3, 2],
 [2, 3, 4, 5, 1, 6, 8, 9, 7],
 [6, 8, 9, 7, 2, 3, 1, 4, 5],
 [4, 9, 3, 6, 5, 7, 2, 1, 8],
 [8, 6, 7, 2, 3, 1, 9, 5, 4],
 [1, 5, 2, 4, 8, 9, 7, 6, 3],
 [3, 7, 6, 1, 4, 8, 5, 2, 9],
 [9, 2, 8, 3, 6, 5, 4, 7, 1],
 [5, 4, 1, 9, 7, 2, 3, 8, 6]]
[[5, 1, 6, 7, 8, 4, 9, 3, 2], [2, 3, 4, 5, 1, 9, 6, 8, 7], [7, 8, 9, 6, 2, 3, 1, 4, 5], [3, 9, 7, 4, 5, 6, 2, 1, 8], [4, 6, 8, 2, 9, 1, 7, 5, 3], [1, 5, 2, 8, 3, 7, 4, 9, 6], [6, 7, 3, 1, 4, 8, 5, 2, 9], [9, 2, 1, 3, 6, 5, 8, 7, 4], [8, 4, 5, 9, 7, 2, 3, 6, 1]]
[[7, 1, 6, 8, 2, 4, 9, 3, 5], [2, 3, 4, 5, 1, 9, 8, 6, 7], [5, 8, 9, 6, 3, 7, 1, 4, 2], [4, 9, 7, 3, 5, 6, 2, 1, 8], [8, 6, 3, 2, 9, 1, 7, 5, 4], [1, 5, 2, 7, 4, 8, 3, 9, 6], [6, 7, 1, 4, 8, 3, 5, 2, 9], [9, 2, 8, 1, 6, 5, 4, 7, 3], [3, 4, 5, 9, 7, 2, 6, 8, 1]]
[[7, 1, 6, 8, 2, 4, 9, 3, 5], [2, 3, 4, 5, 1, 9, 8, 6, 7], [5, 8, 9, 6, 3, 7, 1, 4, 2], [4, 9, 3, 7, 5, 6, 2, 1, 8], [8, 6, 7, 2, 9, 1, 3, 5, 4], [1, 5, 2, 3, 4, 8, 7, 9, 6], [6, 7, 1, 4, 8, 3, 5, 2, 9], [9, 2, 8, 1, 6, 5, 4, 7, 3], [3, 4, 5, 9, 7, 2, 6, 8, 1]]
[[7, 1, 6, 8, 2, 4, 9, 3, 5], [2, 3, 4, 5, 1, 9, 8, 6, 7], [5, 8, 9, 6, 3, 7, 1, 4, 2], [4, 9, 3, 7, 5, 6, 2, 1, 8], [8, 6, 7, 2, 9, 1, 4, 5, 3], [1, 5, 2, 3, 4, 8, 7, 9, 6], [6, 7, 1, 4, 8, 3, 5, 2, 9], [9, 2, 8, 1, 6, 5, 3, 7, 4], [3, 4, 5, 9, 7, 2, 6, 8, 1]]
[[7, 1, 6, 8, 2, 4, 9, 3, 5], [2, 3, 4, 5, 1, 9, 6, 8, 7], [5, 8, 9, 6, 3, 7, 1, 4, 2], [4, 9, 3, 7, 5, 6, 2, 1, 8], [8, 6, 7, 2, 9, 1, 4, 5, 3], [1, 5, 2, 3, 4, 8, 7, 9, 6], [6, 7, 1, 4, 8, 3, 5, 2, 9], [9, 2, 8, 1, 6, 5, 3, 7, 4], [3, 4, 5, 9, 7, 2, 8, 6, 1]]
[[7, 1, 6, 8, 2, 4, 9, 3, 5], [2, 3, 4, 5, 1, 9, 6, 8, 7], [5, 8, 9, 6, 3, 7, 1, 4, 2], [4, 9, 3, 7, 5, 6, 2, 1, 8], [8, 6, 7, 2, 9, 1, 3, 5, 4], [1, 5, 2, 3, 4, 8, 7, 9, 6], [6, 7, 1, 4, 8, 3, 5, 2, 9], [9, 2, 8, 1, 6, 5, 4, 7, 3], [3, 4, 5, 9, 7, 2, 8, 6, 1]]
[[7, 1, 6, 8, 2, 4, 9, 3, 5], [2, 3, 4, 5, 1, 9, 6, 8, 7], [5, 8, 9, 6, 3, 7, 1, 4, 2], [4, 9, 7, 3, 5, 6, 2, 1, 8], [8, 6, 3, 2, 9, 1, 7, 5, 4], [1, 5, 2, 7, 4, 8, 3, 9, 6], [6, 7, 1, 4, 8, 3, 5, 2, 9], [9, 2, 8, 1, 6, 5, 4, 7, 3], [3, 4, 5, 9, 7, 2, 8, 6, 1]]
[[7, 1, 6, 8, 2, 4, 9, 3, 5], [2, 3, 4, 5, 1, 9, 6, 8, 7], [5, 8, 9, 7, 3, 6, 1, 4, 2], [4, 9, 3, 6, 5, 7, 2, 1, 8], [8, 6, 7, 2, 9, 1, 3, 5, 4], [1, 5, 2, 3, 4, 8, 7, 9, 6], [6, 7, 1, 4, 8, 3, 5, 2, 9], [9, 2, 8, 1, 6, 5, 4, 7, 3], [3, 4, 5, 9, 7, 2, 8, 6, 1]]
[[7, 1, 6, 8, 2, 4, 9, 3, 5], [2, 3, 4, 5, 1, 9, 6, 8, 7], [5, 8, 9, 7, 3, 6, 1, 4, 2], [4, 9, 3, 6, 5, 7, 2, 1, 8], [8, 6, 7, 2, 9, 1, 4, 5, 3], [1, 5, 2, 3, 4, 8, 7, 9, 6], [6, 7, 1, 4, 8, 3, 5, 2, 9], [9, 2, 8, 1, 6, 5, 3, 7, 4], [3, 4, 5, 9, 7, 2, 8, 6, 1]]
[[7, 1, 6, 8, 2, 4, 9, 3, 5], [2, 3, 4, 5, 1, 9, 8, 6, 7], [5, 8, 9, 7, 3, 6, 1, 4, 2], [4, 9, 3, 6, 5, 7, 2, 1, 8], [8, 6, 7, 2, 9, 1, 4, 5, 3], [1, 5, 2, 3, 4, 8, 7, 9, 6], [6, 7, 1, 4, 8, 3, 5, 2, 9], [9, 2, 8, 1, 6, 5, 3, 7, 4], [3, 4, 5, 9, 7, 2, 6, 8, 1]]

'''</span>
</code></pre> 
<h3><a id="_914"></a>八皇后问题</h3> 
<p>8个皇后谜题是将8个皇后放在一个8x8的棋盘上，这样就不会有两个皇后互相攻击。因此，一个解决方案要求没有两个皇后共享同一行、列或对角线。<br> <img src="https://images2.imgbox.com/2a/b4/se5jnuIu_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># We know each queen must be in a different row.</span>
<span class="token comment"># So, we represent each queen by a single integer: the column position</span>
Queens <span class="token operator">=</span> <span class="token punctuation">[</span> Int<span class="token punctuation">(</span><span class="token string">'Q_%i'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>

<span class="token comment"># Each queen is in a column {1, ... 8 }</span>
val_c <span class="token operator">=</span> <span class="token punctuation">[</span> And<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;=</span> Queens<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> Queens<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>

<span class="token comment"># At most one queen per column</span>
col_c <span class="token operator">=</span> <span class="token punctuation">[</span> Distinct<span class="token punctuation">(</span>Queens<span class="token punctuation">)</span> <span class="token punctuation">]</span>

<span class="token comment"># Diagonal constraint</span>
diag_c <span class="token operator">=</span> <span class="token punctuation">[</span> If<span class="token punctuation">(</span>i <span class="token operator">==</span> j<span class="token punctuation">,</span>
              <span class="token boolean">True</span><span class="token punctuation">,</span>
              And<span class="token punctuation">(</span>Queens<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> Queens<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> i <span class="token operator">-</span> j<span class="token punctuation">,</span> Queens<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> Queens<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> j <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
           <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">]</span>

solve<span class="token punctuation">(</span>val_c <span class="token operator">+</span> col_c <span class="token operator">+</span> diag_c<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[Q_5 = 6,
 Q_8 = 5,
 Q_3 = 7,
 Q_2 = 2,
 Q_6 = 8,
 Q_4 = 3,
 Q_7 = 1,
 Q_1 = 4]
'''</span>
</code></pre> 
<h3><a id="_948"></a>程序安装</h3> 
<p>安装问题包括确定是否可以在系统中安装一组新的包。这个应用程序是基于文章 OPIUM: Optimal Package Install/Uninstall Manager. 。许多包依赖于其他包来提供某些功能。每个发行版都包含一个元数据文件，它解释了发行版每个包的需求。元数据包含名称、版本等细节。更重要的是，它包含了依赖和冲突条款，规定了哪些包应该在系统上。依情况而定的条款规定了还必须附加哪些包。冲突条款规定其他包不得出现。</p> 
<p>使用Z3可以很容易地解决安装问题。其思想是为每个包定义一个布尔变量。如果包必须在系统中，则此变量为true。如果包a依赖于包b、包c和包z，</p> 
<pre><code class="prism language-python">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e<span class="token punctuation">,</span> f<span class="token punctuation">,</span> g<span class="token punctuation">,</span> z <span class="token operator">=</span> Bools<span class="token punctuation">(</span><span class="token string">'a b c d e f g z'</span><span class="token punctuation">)</span>

<span class="token comment">#DependsOn(a, [b, c, z])</span>
<span class="token comment">#DependsOn is a simple Python function that creates Z3 constraints that capture the depends clause semantics.</span>

<span class="token keyword">def</span> <span class="token function">DependsOn</span><span class="token punctuation">(</span>pack<span class="token punctuation">,</span> deps<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token keyword">return</span> And<span class="token punctuation">(</span><span class="token punctuation">[</span> Implies<span class="token punctuation">(</span>pack<span class="token punctuation">,</span> dep<span class="token punctuation">)</span> <span class="token keyword">for</span> dep <span class="token keyword">in</span> deps <span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">#Thus, DependsOn(a, [b, c, z]) generates the constraint</span>
<span class="token comment"># And(Implies(a, b), Implies(a, c), Implies(a, z))</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>DependsOn<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> z<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#That is, if users install package a, they must also install packages b, c and z.</span>

<span class="token comment">#If package d conflicts with package e, we write Conflict(d, e). Conflict is also a simple Python function.</span>

<span class="token keyword">def</span> <span class="token function">Conflict</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> Or<span class="token punctuation">(</span>Not<span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">,</span> Not<span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Conflict(d, e) generates the constraint Or(Not(d), Not(e)). </span>
<span class="token comment"># With these two functions, we can easily encode the example </span>
<span class="token comment"># in the Opium article (Section 2) in Z3Py as:</span>

<span class="token keyword">def</span> <span class="token function">DependsOn</span><span class="token punctuation">(</span>pack<span class="token punctuation">,</span> deps<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> And<span class="token punctuation">(</span><span class="token punctuation">[</span> Implies<span class="token punctuation">(</span>pack<span class="token punctuation">,</span> dep<span class="token punctuation">)</span> <span class="token keyword">for</span> dep <span class="token keyword">in</span> deps <span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">Conflict</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> Or<span class="token punctuation">(</span>Not<span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">,</span> Not<span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">)</span>


solve<span class="token punctuation">(</span>DependsOn<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> z<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      DependsOn<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      DependsOn<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">[</span>Or<span class="token punctuation">(</span>d<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span> Or<span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      Conflict<span class="token punctuation">(</span>d<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span>
      a<span class="token punctuation">,</span> z<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">install_check</span><span class="token punctuation">(</span><span class="token operator">*</span>problem<span class="token punctuation">)</span><span class="token punctuation">:</span>
    s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token operator">*</span>problem<span class="token punctuation">)</span>
    <span class="token keyword">if</span> s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat<span class="token punctuation">:</span>
        m <span class="token operator">=</span> s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
        r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> x <span class="token keyword">in</span> m<span class="token punctuation">:</span>
            <span class="token keyword">if</span> is_true<span class="token punctuation">(</span>m<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># x is a Z3 declaration</span>
                <span class="token comment"># x() returns the Z3 expression</span>
                <span class="token comment"># x.name() returns a string</span>
                r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"invalid installation profile"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Check 1"</span><span class="token punctuation">)</span>
install_check<span class="token punctuation">(</span>DependsOn<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> z<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              DependsOn<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              DependsOn<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">[</span>Or<span class="token punctuation">(</span>d<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span> Or<span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              Conflict<span class="token punctuation">(</span>d<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span>
              Conflict<span class="token punctuation">(</span>d<span class="token punctuation">,</span> g<span class="token punctuation">)</span><span class="token punctuation">,</span>
              a<span class="token punctuation">,</span> z<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Check 2"</span><span class="token punctuation">)</span>
install_check<span class="token punctuation">(</span>DependsOn<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> z<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token comment">#DependsOn(b, d),</span>
              DependsOn<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              DependsOn<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">[</span>Or<span class="token punctuation">(</span>d<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span> Or<span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              Conflict<span class="token punctuation">(</span>d<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span>
              Conflict<span class="token punctuation">(</span>d<span class="token punctuation">,</span> g<span class="token punctuation">)</span><span class="token punctuation">,</span>
              a<span class="token punctuation">,</span> z<span class="token punctuation">,</span> g<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
And(Implies(a, b), Implies(a, c), Implies(a, z))
[f = False,
 b = True,
 a = True,
 d = True,
 g = True,
 z = True,
 c = True,
 e = False]
 Check 1
[f, b, a, d, z, c]
Check 2
invalid installation profile
'''</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/092f65234b1ecc62d8078c3515c0325a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于Redo Log和Undo Log的MySQL崩溃恢复流程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/eda2f1028c0616c82dc0e5cd54bb8128/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Excel设置下拉选项</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>