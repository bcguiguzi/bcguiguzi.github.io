<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>neo4j 程序连接端口_使用Neo4j向PHP应用程序添加社交网络功能 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="neo4j 程序连接端口_使用Neo4j向PHP应用程序添加社交网络功能" />
<meta property="og:description" content="neo4j 程序连接端口
In the last part, we learned about Neo4j and how to use it with PHP. In this post, we’ll be using that knowledge to build a real Silex-powered social network application with a graph database.
在最后一部分中，我们了解了Neo4j以及如何在PHP中使用它。 在本文中，我们将利用这些知识来构建一个真正的由Silex支持的带有图形数据库的社交网络应用程序。 引导应用程序 (Bootstrapping the application) I’ll use Silex, Twig, Bootstrap and NeoClient to build the application.
我将使用Silex ， Twig ， Bootstrap和NeoClient来构建应用程序。 Create a directory for the app. I named mine spsocial." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/e8efa3d7d8eabe33b11ab7f19f1d7fad/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-28T09:10:15+08:00" />
<meta property="article:modified_time" content="2020-08-28T09:10:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">neo4j 程序连接端口_使用Neo4j向PHP应用程序添加社交网络功能</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <section> 
 <p>neo4j 程序连接端口</p> 
 <p>In the last part, we learned about Neo4j and how to use it with PHP. In this post, we’ll be using that knowledge to build a real Silex-powered social network application with a graph database.</p> 
 <p> 在最后一部分中，我们了解了Neo4j以及如何在PHP中使用它。 在本文中，我们将利用这些知识来构建一个真正的由Silex支持的带有图形数据库的社交网络应用程序。 </p> 
 <h3 id="bootstrapping-the-application"> 引导应用程序 <span style="font-weight: bold;">(</span>Bootstrapping the application<span style="font-weight: bold;">)</span></h3> 
 <p>I’ll use <a href="http://silex.sensiolabs.org/" rel="nofollow">Silex</a>, <a href="http://twig.sensiolabs.org" rel="nofollow">Twig</a>, <a href="http://getbootstrap.com" rel="nofollow">Bootstrap</a> and <a href="https://github.com/neoxygen/neo4j-neoclient">NeoClient</a> to build the application.</p> 
 <p> 我将使用<a href="http://silex.sensiolabs.org/" rel="nofollow">Silex</a> ， <a href="http://twig.sensiolabs.org" rel="nofollow">Twig</a> ， <a href="http://getbootstrap.com" rel="nofollow">Bootstrap</a>和<a href="https://github.com/neoxygen/neo4j-neoclient">NeoClient</a>来构建应用程序。 </p> 
 <p>Create a directory for the app. I named mine <code>spsocial</code>.</p> 
 <p> 为应用创建目录。 我把我的名字叫做<code>spsocial</code> 。 </p> 
 <p>Add these lines to your <code>composer.json</code> and run <code>composer install</code> to install the dependencies :</p> 
 <p> 将这些行添加到您的<code>composer.json</code>并运行<code>composer install</code>来安装依赖项： </p> 
 <pre tabindex="0" class="has"><code class="language-javascript">{
  "require": {
    "silex/silex": "~1.1",
    "twig/twig": "&gt;=1.8,&lt;2.0-dev",
    "symfony/twig-bridge": "~2.3",
    "neoxygen/neoclient": "~2.1"

  },
  "autoload": {
    "psr-4": {
      "Ikwattro\\SocialNetwork\\": "src"
    }
  }
}</code></pre> 
 <p>You can download and install Bootstrap to the <code>web/assets</code> folder of your project.</p> 
 <p> 您可以将Bootstrap下载并安装到项目的<code>web/assets</code>文件夹中。 </p> 
 <p>You can find the bootstrap demo app here as well: <a href="https://github.com/sitepoint-editors/social-network">https://github.com/sitepoint-editors/social-network</a></p> 
 <p> 您也可以在这里找到引导演示应用程序： <a href="https://github.com/sitepoint-editors/social-network">https</a> : <a href="https://github.com/sitepoint-editors/social-network">//github.com/sitepoint-editors/social-network</a> </p> 
 <h3 id="set-up-the-silex-application"> 设置Silex应用程序 <span style="font-weight: bold;">(</span>Set up the Silex application<span style="font-weight: bold;">)</span></h3> 
 <p>We need to configure Silex and declare Neo4jClient so it will be available in the Silex Application. Create an <code>index.php</code> file in the <code>web/</code> folder of your project :</p> 
 <p> 我们需要配置Silex并声明Neo4jClient，以便它将在Silex应用程序中可用。 在项目的<code>web/</code>文件夹中创建一个<code>index.php</code>文件： </p> 
 <pre tabindex="0" class="has"><code class="language-php">&lt;?php

require_once __DIR__.'/../vendor/autoload.php';

use Neoxygen\NeoClient\ClientBuilder;

$app = new Silex\Application();

$app['neo'] = $app-&gt;share(function(){
    $client = ClientBuilder::create()
        -&gt;addDefaultLocalConnection()
        -&gt;setAutoFormatResponse(true)
        -&gt;build();

    return $client;
});

$app-&gt;register(new Silex\Provider\TwigServiceProvider(), array(
    'twig.path' =&gt; __DIR__.'/../src/views',
));
$app-&gt;register(new Silex\Provider\MonologServiceProvider(), array(
    'monolog.logfile' =&gt; __DIR__.'/../logs/social.log'
));
$app-&gt;register(new Silex\Provider\UrlGeneratorServiceProvider());

$app-&gt;get('/', 'Ikwattro\\SocialNetwork\\Controller\\WebController::home')
    -&gt;bind('home');

$app-&gt;run();</code></pre> 
 <p>Twig is configured to have its template files located in the <code>src/views</code> folder. A home route pointing to <code>/</code> is registered and configured to use the <code>WebController</code> we will create later. The application structure should look like this :</p> 
 <p> Twig配置为使其模板文件位于<code>src/views</code>文件夹中。 已注册指向<code>/</code>本地路由并将其配置为使用我们稍后将创建的<code>WebController</code> 。 应用程序结构应如下所示： </p> 
 <div style="text-align: center;"> 
  <img src="https://images2.imgbox.com/2f/11/Sy5ZDyby_o.png" alt="Imgur" title="title" style="outline: none;"> 
 </div> 
 <p>Note that here I used bower to install bootstrap, but it is up to you what you want to use.</p> 
 <p> 请注意，这里我使用Bower来安装引导程序，但是要由您决定使用什么。 </p> 
 <p>The next step is to create our base layout with a content block that our child Twig templates will override with their own content. I’ll take the default bootstrap theme with a navbar on top:</p> 
 <p> 下一步是使用内容块创建基本布局，我们的子级Twig模板将使用其自身的内容覆盖该内容块。 我将使用默认的引导主题，并在顶部带有导航栏： </p> 
 <pre tabindex="0" class="has"><code class="language-php">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
    &lt;meta name="description" content=""&gt;
    &lt;meta name="author" content=""&gt;

    &lt;title&gt;My first Neo4j application&lt;/title&gt;

    &lt;!-- Bootstrap core CSS --&gt;
    &lt;link href="{<!-- -->{ app.request.basepath }}/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
    &lt;!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries --&gt;
    &lt;!--[if lt IE 9]&gt;
    &lt;script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"&gt;&lt;/script&gt;
    &lt;![endif]--&gt;

    &lt;style&gt;
        body { padding-top: 70px; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;div class="navbar navbar-inverse navbar-fixed-top" role="navigation"&gt;
    &lt;div class="container"&gt;
        &lt;div class="navbar-header"&gt;
            &lt;button type="button" id="collbut" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse"&gt;
                &lt;span class="sr-only"&gt;Toggle navigation&lt;/span&gt;
                &lt;span class="icon-bar"&gt;&lt;/span&gt;
                &lt;span class="icon-bar"&gt;&lt;/span&gt;
                &lt;span class="icon-bar"&gt;&lt;/span&gt;
            &lt;/button&gt;
            &lt;a class="navbar-brand" href="#"&gt;My first Neo4j application&lt;/a&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;div class="container-fluid"&gt;

    {% block content %}

    {% endblock content %}

&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
 <h4 id="the-home-page-retrieving-all-users"> 主页(检索所有用户) <span style="font-weight: bold;">(</span>The home page (retrieving all users)<span style="font-weight: bold;">)</span></h4> 
 <p>So far, we have Neo4j available in the application, our base template is created and we want to list all users on the home page.</p> 
 <p> 到目前为止，我们在应用程序中提供了Neo4j，已经创建了基本模板，并且希望在主页上列出所有用户。 </p> 
 <p>We can achieve this in two steps : </p> 
 <p> 我们可以分两步实现： </p> 
 <ul><li><p>Create our <code>home</code> controller action and retrieve users from Neo4j</p><p> 创建我们的<code>home</code>控制器操作并从Neo4j检索用户 </p></li><li>Pass the list of users to the template and list them<p class="nodelete"></p> 将用户列表传递给模板并列出他们 </li></ul> 
 <h5 id="the-controller-action"> 控制器动作 <span style="font-weight: bold;">(</span>The Controller action<span style="font-weight: bold;">)</span></h5> 
 <pre tabindex="0" class="has"><code class="language-php">&lt;?php

namespace Ikwattro\SocialNetwork\Controller;

use Silex\Application;
use Symfony\Component\HttpFoundation\Request;

class WebController
{

    public function home(Application $application, Request $request)
    {
        $neo = $application['neo'];
        $q = 'MATCH (user:User) RETURN user';
        $result = $neo-&gt;sendCypherQuery($q)-&gt;getResult();

        $users = $result-&gt;get('user');

        return $application['twig']-&gt;render('index.html.twig', array(
            'users' =&gt; $users
        ));
    }
}</code></pre> 
 <p>The controller shows the process, we retrieve the <code>neo</code> service and issue a Cypher query to retrieve all the users. The users collection is then passed to the <code>index.html.twig</code> template.</p> 
 <p> 控制器显示了该过程，我们检索了<code>neo</code>服务并发出Cypher查询以检索所有用户。 然后将用户集合传递到<code>index.html.twig</code>模板。 </p> 
 <h5 id="the-index-template"> 索引模板 <span style="font-weight: bold;">(</span>The index template<span style="font-weight: bold;">)</span></h5> 
 <pre tabindex="0" class="has"><code class="language-markup">{% extends "layout.html.twig" %}

{% block content %}
    &lt;ul class="list-unstyled"&gt;
        {% for user in users %}
            &lt;li&gt;{<!-- -->{ user.property('firstname') }} {<!-- -->{ user.property('lastname') }}&lt;/li&gt;
        {% endfor %}
    &lt;/ul&gt;
{% endblock %}</code></pre> 
 <p>The template is very light, it extends our base layout and add an unsorted list with the user’s firstnames and lastnames in the <code>content</code> inherited block.</p> 
 <p> 该模板非常轻巧，它扩展了我们的基本布局，并在<code>content</code>继承块中添加了带有用户的名字和姓氏的未排序列表。 </p> 
 <p>Start the built-in php server and admire your work :</p> 
 <p> 启动内置的php服务器并欣赏您的工作： </p> 
 <pre tabindex="0" class="has"><code class="language-bash">cd spsocial/web
php -S localhost:8000
open localhost:8000</code></pre> 
 <div style="text-align: center;"> 
  <img src="https://images2.imgbox.com/f3/d6/S2MzTlFg_o.png" alt="Imgur" title="title" style="outline: none;"> 
 </div> 
 <h5 id="showing-whom-a-user-follows"> 社交网络功能：显示用户关注的人 <span style="font-weight: bold;">(</span>Social Network Features: Showing whom a user follows<span style="font-weight: bold;">)</span></h5> 
 <p>Let’s say now that we want to click on a user, and be presented his detail information and the users he follows.</p> 
 <p> 现在假设我们要单击一个用户，并向其显示他的详细信息和他所关注的用户。 </p> 
 <p>Step 1 : Create a route in <code>index.php</code></p> 
 <p> 步骤1：在<code>index.php</code>创建一条路由 </p> 
 <pre tabindex="0" class="has"><code class="language-php">$app-&gt;get('/user/{login}', 'Ikwattro\\SocialNetwork\\Controller\\WebController::showUser')
    -&gt;bind('show_user');</code></pre> 
 <p>Step 2: Create the <code>showUser</code> controller action</p> 
 <p> 步骤2：创建<code>showUser</code>控制器操作 </p> 
 <pre tabindex="0" class="has"><code class="language-php">public function showUser(Application $application, Request $request, $login)
    {
        $neo = $application['neo'];
        $q = 'MATCH (user:User) WHERE user.login = {login}
         OPTIONAL MATCH (user)-[:FOLLOWS]-&gt;(f)
         RETURN user, collect(f) as followed';
        $p = ['login' =&gt; $login];
        $result = $neo-&gt;sendCypherQuery($q, $p)-&gt;getResult();

        $user = $result-&gt;get('user');
        $followed = $result-&gt;get('followed');

        if (null === $user) {
            $application-&gt;abort(404, 'The user $login was not found');
        }

        return $application['twig']-&gt;render('show_user.html.twig', array(
            'user' =&gt; $user,
            'followed' =&gt; $followed
        ));
    }</code></pre> 
 <p>The workflow is similar to any other applications, you try to find the user based on the login. If it does not exist you show a 404 error page, otherwise you pass the user data to the template.</p> 
 <p> 该工作流程类似于任何其他应用程序，您尝试根据登录名查找用户。 如果不存在，则显示404错误页面，否则将用户数据传递给模板。 </p> 
 <p>Step 3 : Create the <code>show_user</code> template file</p> 
 <p> 步骤3：建立<code>show_user</code>范本档案 </p> 
 <pre tabindex="0" class="has"><code class="language-markup">{% extends "layout.html.twig" %}

{% block content %}
    &lt;h1&gt;User informations&lt;/h1&gt;

    &lt;h2&gt;{<!-- -->{ user.property('firstname') }} {<!-- -->{ user.property('lastname') }}&lt;/h2&gt;
    &lt;h3&gt;{<!-- -->{ user.property('login') }}&lt;/h3&gt;
    &lt;hr/&gt;

    &lt;div class="row"&gt;
        &lt;div class="col-sm-6"&gt;
            &lt;h4&gt;User &lt;span class="label label-info"&gt;{<!-- -->{ user.property('login') }}&lt;/span&gt; follows :&lt;/h4&gt;
            &lt;ul class="list-unstyled"&gt;
                {% for follow in followed %}
                    &lt;li&gt;{<!-- -->{ follow.property('login') }} ( {<!-- -->{ follow.property('firstname') }} {<!-- -->{ follow.property('lastname') }} )&lt;/li&gt;
                {% endfor %}
            &lt;/ul&gt;
        &lt;/div&gt;
    &lt;/div&gt;

{% endblock %}</code></pre> 
 <p>Step 4 : Refactor the list of users in the homepage to show links to their profile</p> 
 <p> 步骤4：重构首页中的用户列表，以显示指向其个人资料的链接 </p> 
 <pre tabindex="0" class="has"><code class="language-markup">{% for user in users %}
    &lt;li&gt;
        &lt;a href="{<!-- -->{ path('show_user', { login: user.property('login') }) }}"&gt;
           {<!-- -->{ user.property('firstname') }} {<!-- -->{ user.property('lastname') }}
        &lt;/a&gt;
    &lt;/li&gt;
{% endfor %}</code></pre> 
 <p>Refresh the homepage and click on any user for showing his profile and the list of followed users</p> 
 <p> 刷新主页，然后单击任何用户以显示其个人资料和关注的用户列表 </p> 
 <div style="text-align: center;"> 
  <img src="https://images2.imgbox.com/a0/d3/yXAfEF7Q_o.png" alt="Imgur" title="title" style="outline: none;"> 
 </div> 
 <h4 id="adding-suggestions"> 添加建议 <span style="font-weight: bold;">(</span>Adding suggestions<span style="font-weight: bold;">)</span></h4> 
 <p>The next step is to provide suggestions to the profile. We need to slightly extend our cypher query in the controller by adding an <code>OPTIONAL MATCH</code> to find suggestions based on the second degree network.</p> 
 <p> 下一步是为个人资料提供建议。 我们需要通过添加<code>OPTIONAL MATCH</code>以基于二级网络查找建议来稍微扩展控制器中的密码查询。 </p> 
 <p>The optional prefix causes a <code>MATCH</code> to return a row even if there were no matches but with the non-resolved parts set to <code>null</code> (much like an outer JOIN). As we potentially get multiple paths for each friend-of-a-friend (fof), we need to distinct the results in order to avoid duplicates in our list (collect is an aggregation operation that collects values into an array):</p> 
 <p> 即使没有匹配项，但未解析的部分设置为<code>null</code> (类似于外部JOIN)，可选的前缀也会使<code>MATCH</code>返回一行。 由于我们可能为每个“朋友”(fof)获得多个路径，因此我们需要区分结果以避免在列表中出现重复(collect是将值收集到数组中的聚合操作)： </p> 
 <p>The updated controller : </p> 
 <p> 更新的控制器： </p> 
 <pre tabindex="0" class="has"><code class="language-php">public function showUser(Application $application, Request $request, $login)
    {
        $neo = $application['neo'];
        $q = 'MATCH (user:User) WHERE user.login = {login}
         OPTIONAL MATCH (user)-[:FOLLOWS]-&gt;(f)
         OPTIONAL MATCH (f)-[:FOLLOWS]-&gt;(fof)
         WHERE user &lt;&gt; fof
           AND NOT (user)-[:FOLLOWS]-&gt;(fof)
         RETURN user, collect(f) as followed, collect(distinct fof) as suggestions';
        $p = ['login' =&gt; $login];
        $result = $neo-&gt;sendCypherQuery($q, $p)-&gt;getResult();

        $user = $result-&gt;get('user');
        $followed = $result-&gt;get('followed');
        $suggestions = $result-&gt;get('suggestions');

        if (null === $user) {
            $application-&gt;abort(404, 'The user $login was not found');
        }

        return $application['twig']-&gt;render('show_user.html.twig', array(
            'user' =&gt; $user,
            'followed' =&gt; $followed,
            'suggestions' =&gt; $suggestions
        ));
    }</code></pre> 
 <p>The updated template : </p> 
 <p> 更新的模板： </p> 
 <pre tabindex="0" class="has"><code class="language-markup">{% extends "layout.html.twig" %}

{% block content %}
    &lt;h1&gt;User informations&lt;/h1&gt;

    &lt;h2&gt;{<!-- -->{ user.property('firstname') }} {<!-- -->{ user.property('lastname') }}&lt;/h2&gt;
    &lt;h3&gt;{<!-- -->{ user.property('login') }}&lt;/h3&gt;
    &lt;hr/&gt;

    &lt;div class="row"&gt;
        &lt;div class="col-sm-6"&gt;
            &lt;h4&gt;User &lt;span class="label label-info"&gt;{<!-- -->{ user.property('login') }}&lt;/span&gt; follows :&lt;/h4&gt;
            &lt;ul class="list-unstyled"&gt;
                {% for follow in followed %}
                    &lt;li&gt;{<!-- -->{ follow.property('login') }} ( {<!-- -->{ follow.property('firstname') }} {<!-- -->{ follow.property('lastname') }} )&lt;/li&gt;
                {% endfor %}
            &lt;/ul&gt;
        &lt;/div&gt;

        &lt;div class="col-sm-6"&gt;
            &lt;h4&gt;Suggestions for user &lt;span class="label label-info"&gt;{<!-- -->{ user.property('login') }}&lt;/span&gt; &lt;/h4&gt;
            &lt;ul class="list-unstyled"&gt;
                {% for suggested in suggestions %}
                    &lt;li&gt;{<!-- -->{ suggested.property('login') }} ( {<!-- -->{ suggested.property('firstname') }} {<!-- -->{ suggested.property('lastname') }} )&lt;/li&gt;
                {% endfor %}
            &lt;/ul&gt;
        &lt;/div&gt;

    &lt;/div&gt;

{% endblock %}</code></pre> 
 <p>You can immediately explore the suggestions in your application :</p> 
 <p> 您可以立即探索应用程序中的建议： </p> 
 <div style="text-align: center;"> 
  <img src="https://images2.imgbox.com/c3/69/E7hcJRuB_o.png" alt="Imgur" title="title" style="outline: none;"> 
 </div> 
 <h4 id="connecting-to-a-user-adding-relationship"> 连接到用户(添加关系) <span style="font-weight: bold;">(</span>Connecting to a user (adding relationship)<span style="font-weight: bold;">)</span></h4> 
 <p>In order to connect to a suggested user, we’ll add a post form link to each suggested user containing both users as hidden fields. We’ll also create the corresponding route and controller action.</p> 
 <p> 为了连接到建议的用户，我们将向每个建议的用户添加一个帖子表单链接，其中包含两个用户均为隐藏字段。 我们还将创建相应的路由和控制器操作。 </p> 
 <p>Creating the route : </p> 
 <p> 创建路线： </p> 
 <pre tabindex="0" class="has"><code class="language-php">#web/index.php

$app-&gt;post('/relationship/create', 'Ikwattro\\SocialNetwork\\Controller\\WebController::createRelationship')
    -&gt;bind('relationship_create');</code></pre> 
 <p>The controller action :</p> 
 <p> 控制器动作： </p> 
 <pre tabindex="0" class="has"><code class="language-php">public function createRelationship(Application $application, Request $request)
    {
        $neo = $application['neo'];
        $user = $request-&gt;get('user');
        $toFollow = $request-&gt;get('to_follow');

        $q = 'MATCH (user:User {login: {login}}), (target:User {login:{target}})
        MERGE (user)-[:FOLLOWS]-&gt;(target)';
        $p = ['login' =&gt; $user, 'target' =&gt; $toFollow];
        $neo-&gt;sendCypherQuery($q, $p);

        $redirectRoute = $application['url_generator']-&gt;generate('show_user', array('login' =&gt; $user));

        return $application-&gt;redirect($redirectRoute);
    }</code></pre> 
 <p>Nothing unusual here, we <code>MATCH</code> for the start user node and the target user node and then we <code>MERGE</code> the corresponding <code>FOLLOWS</code> relationship. We use MERGE on the relationship to avoid duplicate entries.</p> 
 <p> 这里没有什么异常，我们<code>MATCH</code>起始用户节点和目标用户节点，然后<code>MERGE</code>对应的<code>FOLLOWS</code>关系。 我们在关系上使用MERGE以避免重复输入。 </p> 
 <p>The template: </p> 
 <p> 模板： </p> 
 <pre tabindex="0" class="has"><code class="language-markup">&lt;div class="col-sm-6"&gt;
            &lt;h4&gt;Suggestions for user &lt;span class="label label-info"&gt;{<!-- -->{ user.property('login') }}&lt;/span&gt; &lt;/h4&gt;
            &lt;ul class="list-unstyled"&gt;
                {% for suggested in suggestions %}
                    &lt;li&gt;
                        {<!-- -->{ suggested.property('login') }} ( {<!-- -->{ suggested.property('firstname') }} {<!-- -->{ suggested.property('lastname') }} )
                        &lt;form method="POST" action="{<!-- -->{ path('relationship_create') }}"&gt;
                            &lt;input type="hidden" name="user" value="{<!-- -->{ user.property('login') }}"/&gt;
                            &lt;input type="hidden" name="to_follow" value="{<!-- -->{ suggested.property('login') }}"/&gt;
                            &lt;button type="submit" class="btn btn-success btn-sm"&gt;Follow&lt;/button&gt;
                        &lt;/form&gt;
                        &lt;hr/&gt;
                    &lt;/li&gt;
                {% endfor %}
            &lt;/ul&gt;
        &lt;/div&gt;</code></pre> 
 <p>You can now click on the <code>FOLLOW</code> button of the suggested user you want to follow :</p> 
 <p> 现在，您可以点击<code>FOLLOW</code>要遵循建议的用户的按钮： </p> 
 <div style="text-align: center;"> 
  <img src="https://images2.imgbox.com/80/46/aUC2SVGs_o.png" alt="Imgur" title="title" style="outline: none;"> 
 </div> 
 <p>Removing relationships :</p> 
 <p> 删除关系： </p> 
 <p>The workflow for removing relationships is pretty much the same as for adding new relationships, create a route, a controller action and adapt the layout :</p> 
 <p> 删除关系的工作流程与添加新关系，创建路线，控制器动作和调整布局的工作流程几乎相同： </p> 
 <p>The route :</p> 
 <p> 路线 ： </p> 
 <pre tabindex="0" class="has"><code class="language-php">#web/index.php
$app-&gt;post('/relationship/remove', 'Ikwattro\\SocialNetwork\\Controller\\WebController::removeRelationship')
    -&gt;bind('relationship_remove');</code></pre> 
 <p>The controller action :</p> 
 <p> 控制器动作： </p> 
 <pre tabindex="0" class="has"><code class="language-php">public function removeRelationship(Application $application, Request $request)
    {
        $neo = $application['neo'];
        $user = $request-&gt;get('login');
        $toRemove = $request-&gt;get('to_remove');

        $q = 'MATCH (user:User {login: {login}} ), (badfriend:User {login: {target}} )
        MATCH (user)-[follows:FOLLOWS]-&gt;(badfriend)
        DELETE follows';
        $p = ['login' =&gt; $user, 'target' =&gt; $toRemove];
        $neo-&gt;sendCypherQuery($q, $p);

        $redirectRoute = $application['url_generator']-&gt;generate('show_user', array('login' =&gt; $user));

        return $application-&gt;redirect($redirectRoute);
    }</code></pre> 
 <p>You can see here that I used <code>MATCH</code> to find the relationship between the two users, and I added an identifier <code>follows</code> to the relationship to be able to <code>DELETE</code> it.</p> 
 <p> 你可以在这里看到我用<code>MATCH</code>找到两个用户之间的关系，我添加了一个标识<code>follows</code>的关系，以便能够<code>DELETE</code>它。 </p> 
 <p>The template :</p> 
 <p> 模板： </p> 
 <pre tabindex="0" class="has"><code class="language-markup">&lt;h4&gt;User &lt;span class="label label-info"&gt;{<!-- -->{ user.property('login') }}&lt;/span&gt; follows :&lt;/h4&gt;
            &lt;ul class="list-unstyled"&gt;
                {% for follow in followed %}
                    &lt;li&gt;
                        {<!-- -->{ follow.property('login') }} ( {<!-- -->{ follow.property('firstname') }} {<!-- -->{ follow.property('lastname') }} )
                        &lt;form method="POST" action="{<!-- -->{ path('relationship_remove') }}"&gt;
                            &lt;input type="hidden" name="login" value="{<!-- -->{ user.property('login') }}"/&gt;
                            &lt;input type="hidden" name="to_remove" value="{<!-- -->{ follow.property('login') }}"/&gt;
                            &lt;button type="submit" class="btn btn-sm btn-warning"&gt;Remove relationship&lt;/button&gt;
                        &lt;/form&gt;
                        &lt;hr/&gt;
                    &lt;/li&gt;
                {% endfor %}
            &lt;/ul&gt;</code></pre> 
 <p>You can now click the <strong>Remove relationship</strong> button under each followed user : </p> 
 <p> 现在，您可以单击每个关注用户下的“ <strong>删除关系”</strong>按钮： </p> 
 <div style="text-align: center;"> 
  <img src="https://images2.imgbox.com/b4/68/ToKaId5r_o.png" alt="Imgur" title="title" style="outline: none;"> 
 </div> 
 <h3 id="conclusion"> 结论 <span style="font-weight: bold;">(</span>Conclusion<span style="font-weight: bold;">)</span></h3> 
 <p>Graph databases are the perfect fit for relational data, and using it with PHP and NeoClient is easy. Cypher is a convenient query language you will quickly love, because it makes possible to query your graph in a natural way.</p> 
 <p> 图形数据库非常适合关系数据，并且与PHP和NeoClient一起使用非常容易。 Cypher是一种您很快就会喜欢的便捷查询语言，因为它可以自然地查询图形。 </p> 
 <p>There is so much benefit from using <a href="http://graphdatabases.com" rel="nofollow">Graph Databases</a> for real world data, I invite you to discover more by reading the manual <a href="http://neo4j.com/docs/stable/" rel="nofollow">http://neo4j.com/docs/stable/</a> , having a look at <a href="http://neo4j.com/use-cases" rel="nofollow">use cases</a> and <a href="http://gist.neo4j.org/" rel="nofollow">examples supplied by Neo4j users</a> and following <a href="https://twitter.com/neo4j" rel="nofollow">@Neo4j on Twitter</a>.</p> 
 <p> 使用<a href="http://graphdatabases.com" rel="nofollow">Graph数据库</a>获取现实数据有很多好处，我邀请您阅读手册<a href="http://neo4j.com/docs/stable/" rel="nofollow">http://neo4j.com/docs/stable/</a> ，以了解<a href="http://gist.neo4j.org/" rel="nofollow">Neo4j用户提供的</a> <a href="http://neo4j.com/use-cases" rel="nofollow">用例</a>和<a href="http://gist.neo4j.org/" rel="nofollow">示例</a> ，并从中找到更多信息。 <a href="https://twitter.com/neo4j" rel="nofollow">在Twitter上</a>关注<a href="https://twitter.com/neo4j" rel="nofollow">@ Neo4j</a> 。 </p> 
 <blockquote> 
  <p>翻译自: <a href="https://www.sitepoint.com/adding-social-network-features-php-app-neo4j/" rel="nofollow">https://www.sitepoint.com/adding-social-network-features-php-app-neo4j/</a></p> 
 </blockquote> 
 <p>neo4j 程序连接端口</p> 
</section>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ed75775addd587f61c4cec5bf98e9b43/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数据结构与算法_栈和队列</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/23d03e975160383d23477bda89d3a5f6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">koa2接收post请求参数formdata和json</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>