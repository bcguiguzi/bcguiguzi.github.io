<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Suervisor http://localhost:9001 refused connection - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Suervisor http://localhost:9001 refused connection" />
<meta property="og:description" content="(desk_env) root@vdi:/opt/pyenv/desk_env/bin# supervisorctl http://localhost:9001 refused connection 当后台启动supervisord后，使用supervisorctl命令进行任务管理时，
一、报错原因：
http://localhost:9001 refused connection
显示拒绝连接
二、问题原因分析：
因为supervisor通常有以下两种方式通信：
1、本地socket
2、http连接
在supervisor.conf配置文件中，启用socket连接，注释http方式，supervisorctl配置项也使用unix socket
[unix_http_server]
file=/var/run/supervisor.sock ; the path to the socket file
;chmod=0700 ; socket file mode (default 0700)
;chown=nobody:nogroup ; socket file uid:gid owner
;username=user ; default is no username (open server)
;password=123 ; default is no password (open server)
;[inet_http_server] ; inet (TCP) server disabled by default
;port=127.0.0.1:9001 ; ip_address:port specifier, *:port for all iface" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/7b4fbadfa3a16b2ef03bf46968fe9d46/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-11T19:56:26+08:00" />
<meta property="article:modified_time" content="2024-03-11T19:56:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Suervisor http://localhost:9001 refused connection</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code class="prism language-python"><span class="token punctuation">(</span>desk_env<span class="token punctuation">)</span> root@vdi<span class="token punctuation">:</span><span class="token operator">/</span>opt<span class="token operator">/</span>pyenv<span class="token operator">/</span>desk_env<span class="token operator">/</span><span class="token builtin">bin</span><span class="token comment"># supervisorctl</span>
http<span class="token punctuation">:</span><span class="token operator">//</span>localhost<span class="token punctuation">:</span><span class="token number">9001</span> refused connection
</code></pre> 
<div id="article_content" class="article_content clearfix"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <svg xmlns="http://www.w3.org/2000/svg"> 
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block"></path> 
  </svg> 
  <p>当后台启动supervisord后，使用supervisorctl命令进行任务管理时，<br> <strong>一、报错原因：</strong><br> http://localhost:9001 refused connection<br> 显示拒绝连接</p> 
  <p><strong>二、问题原因分析：</strong><br> 因为<a href="https://so.csdn.net/so/search?q=supervisor&amp;spm=1001.2101.3001.7020" target="_blank" class="hl hl-1" rel="noopener noreferrer">supervisor</a>通常有以下两种方式通信：<br> 1、本地<a href="https://so.csdn.net/so/search?q=socket&amp;spm=1001.2101.3001.7020" target="_blank" class="hl hl-1" rel="noopener noreferrer">socket</a><br> 2、http连接</p> 
  <p>在supervisor.conf配置文件中，启用socket连接，注释http方式，supervisorctl配置项也使用unix socket<br> [unix_http_server]<br> file=/var/run/supervisor.sock ; the path to the socket file<br> ;chmod=0700 ; socket file mode (default 0700)<br> ;chown=nobody:nogroup ; socket file uid:gid owner<br> ;username=user ; default is no username (open server)<br> ;password=123 ; default is no password (open server)</p> 
  <p>;[inet_http_server] ; inet (TCP) server disabled by default<br> ;port=127.0.0.1:9001 ; ip_address:port specifier, *:port for all iface<br> ;username=user ; default is no username (open server)<br> ;password=123 ; default is no password (open server)</p> 
  <p>[supervisorctl]<br> serverurl=unix:///var/run/supervisor.sock ; use a unix:// URL for a unix socket<br> ;serverurl=http://127.0.0.1:9001 ; use an http:// url to specify an inet socket<br> ;username=chris ; should be same as in [<em>_http_server] if set<br> ;password=123 ; should be same as in [</em>_http_server] if set<br> ;prompt=mysupervisor ; cmd line prompt (default “supervisor”)<br> ;history_file=~/.sc_history ; use readline history if available</p> 
  <p>但是在启动supervisorctl时，未指定配置文件，因此会使用默认的http方式连接supervisord，最终导致报错</p> 
  <p><strong>三、解决方案：</strong><br> 1、首先需要进入到对应的supervisor目录下</p> 
  <pre class="set-code-show prettyprint"><code class="prism language-python has-numbering">cd <span class="token operator">/</span>opt<span class="token operator">/</span>typhoonae<span class="token operator">/</span>
source appenv3<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>activate  <span class="token comment"># 激活supervosor服务环境</span>
<span class="token punctuation">.</span><span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>supervisord     <span class="token comment"># 启动supervosrd</span>
</code>
   
   <div class="hljs-button {2}"></div></pre> 
  <p>2、可通过./bin/supervisorctl status 查询服务进程状态<br> 3、如果启动 ./bin/supervisorctl -c etc/supervisord_core.conf 显示连接错误，<br> 报错如下：<br> http://localhost:9002 refused connection<br> <img src="https://images2.imgbox.com/ba/7b/hcjimPgz_o.png" alt="在这里插入图片描述"><br> 4、就需要通过指定配置文件来执行了，命令如下：</p> 
  <pre class="set-code-show prettyprint"><code class="prism language-python has-numbering"><span class="token punctuation">.</span><span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>supervisord <span class="token operator">-</span>c etc<span class="token operator">/</span>supervisord_core<span class="token punctuation">.</span>conf
然后便可启动了
<span class="token punctuation">.</span><span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>supervisorctl <span class="token operator">-</span>c etc<span class="token operator">/</span>supervisord_core<span class="token punctuation">.</span>conf status  <span class="token comment"># 可通过如下查询状态</span>
</code>
   
   <div class="hljs-button {2}"></div>
                </pre> 
 </div> 
 <div> 
  <div></div> 
 </div> 
</div> 
<p><img src="https://images2.imgbox.com/24/11/tmAesDzY_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token punctuation">(</span>desk_env<span class="token punctuation">)</span> root@vdi<span class="token punctuation">:</span><span class="token operator">/</span>opt<span class="token operator">/</span>pyenv<span class="token operator">/</span>desk_env<span class="token operator">/</span><span class="token builtin">bin</span><span class="token comment"># ./supervisorctl -c /opt/desk/vdi-server/supervisord.conf</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/75b7f5eee437ef6fbdbaf31e6cfa7829/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">郭炜老师mooc第十一章数据分析和展示(numpy,pandas, matplotlib)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cc446de26738396da1de0fefc3b3a735/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SQL 优化实践：关于增强 OceanBase本地索引性能的案例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>