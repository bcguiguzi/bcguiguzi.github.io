<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习_实战框架 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习_实战框架" />
<meta property="og:description" content="文章目录 介绍机器学习的实战框架1.定义问题2.收集数据和预处理(1).收集数据(2).数据可视化(3).数据清洗(4).特征工程(5).构建特征集和标签集(6).拆分训练集、验证集和测试集。 3.选择算法并建立模型4.训练模型5.模型的评估和优化 介绍机器学习的实战框架 一个机器学习项目从开始到结束大致分为 5 步，分别是定义问题、收集数据和预处理、选择算法和确定模型、训练拟合模型、评估并优化模型性能。这 5 步是一个循环迭代的过程，你可以参考下面的图片：
1.定义问题 我们项目的目标就是，建立一个机器学习模型，根据点赞数和转发数等指标，估计一篇文章能实现多大的浏览量。
因为要估计浏览量，所以在这个数据集中：点赞数、转发数、热度指数、文章评级，这 4 个字段都是特征，浏览量就是标签。这里我们已经有要估计的标签了，所以这是一个监督学习问题。再加上我们的标签是连续性的数值，因此它是一个回归问题。
2.收集数据和预处理 (1).收集数据 首先是收集数据，这一步又叫采集数据。
在现实中，收集数据通常很辛苦，要在运营环节做很多数据埋点、获取用户消费等行为信息和兴趣偏好信息，有时候还需要上网爬取数据。
收集数据的方法有很多，这里推荐之前写过的相关文章：
数据爬虫（JSON格式）&amp;数据地图可视化（pyecharts）【步骤清晰，一看就懂】：https://blog.csdn.net/weixin_42504788/article/details/134588642
数据爬取&#43;数据可视化实战_哪里只得我共你(Dear Jane)_词云展示----网易云：https://blog.csdn.net/weixin_42504788/article/details/134622850
数据爬取&#43;可视化实战_告白气球_词云展示----酷狗音乐：https://blog.csdn.net/weixin_42504788/article/details/134622575
处理Json格式的数据，如何用Python将数据存放入Excel中（步骤清晰，一看就懂）：https://blog.csdn.net/weixin_42504788/article/details/134543733
(2).数据可视化 数据可视化是个万金油技能，能做的事非常多。比如说，可以看一看特征和标签之间可能存在的关系，也可以看看数据里有没有“脏数据”和“离群点”等。
常用的工具包有：
import matplotlib.pyplot as plt # Matplotlib – Python画图工具库 import seaborn as sns # Seaborn – 统计学数据可视化工具库 (3).数据清洗 处理缺失的数据：用均值填充、众数填充或0。如果建模用树模型，也可以不填充，树模型算法自身可以处理缺失值。
处理重复的数据：完全相同，删去即可。
处理错误的数据：部门人数、销量、销售金额小于0，遇到这类情况删去即可。
处理不可用的数据：建模的时候，数据必须是数字，不能是中英文等情况。比如性别出现男女字样，需要转化后再进行建模
查看空缺值NaN出现的次数：df.isna().sum()
把出现了NaN的数据行删掉：df = df.dropna()
(4).特征工程 特征贴合业务实际，特征越丰富，模型效果会更好
(5).构建特征集和标签集 特征是输入机器学习模型的变量。
X = df.drop([&#39;浏览量&#39;],axis=1) X.head() 标签是结果或目标。
y = df.浏览量 y.head() (6).拆分训练集、验证集和测试集。 一般为了简化，验证集会省略，这里展示如何从数据中切分出训练集跟测试集
#将数据集进行80%（训练集）和20%（验证集）的分割 from sklearn." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/2e9fad9ba8845127fd3ffad167ebb002/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-22T00:06:44+08:00" />
<meta property="article:modified_time" content="2024-01-22T00:06:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习_实战框架</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_3" rel="nofollow">介绍机器学习的实战框架</a></li><li><ul><li><a href="#1_8" rel="nofollow">1.定义问题</a></li><li><a href="#2_13" rel="nofollow">2.收集数据和预处理</a></li><li><ul><li><a href="#1_14" rel="nofollow">(1).收集数据</a></li><li><a href="#2_27" rel="nofollow">(2).数据可视化</a></li><li><a href="#3_38" rel="nofollow">(3).数据清洗</a></li><li><a href="#4_49" rel="nofollow">(4).特征工程</a></li><li><a href="#5_52" rel="nofollow">(5).构建特征集和标签集</a></li><li><a href="#6_70" rel="nofollow">(6).拆分训练集、验证集和测试集。</a></li></ul> 
   </li><li><a href="#3_85" rel="nofollow">3.选择算法并建立模型</a></li><li><a href="#4_99" rel="nofollow">4.训练模型</a></li><li><a href="#5_132" rel="nofollow">5.模型的评估和优化</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_3"></a>介绍机器学习的实战框架</h2> 
<p>一个机器学习项目从开始到结束大致分为 5 步，分别是<strong>定义问题、收集数据和预处理、选择算法和确定模型、训练拟合模型、评估并优化模型性能</strong>。这 5 步是一个循环迭代的过程，你可以参考下面的图片：<br> <img src="https://images2.imgbox.com/2d/bd/r4wZW8hu_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="1_8"></a>1.定义问题</h3> 
<p>我们项目的目标就是，建立一个机器学习模型，<strong>根据点赞数和转发数等指标，估计一篇文章能实现多大的浏览量</strong>。</p> 
<p>因为要估计浏览量，所以在这个数据集中：点赞数、转发数、热度指数、文章评级，这 4 个字段都是<strong>特征</strong>，浏览量就是<strong>标签</strong>。这里我们已经有要估计的标签了，所以这是一个<strong>监督学习</strong>问题。再加上我们的标签是<strong>连续性的数值</strong>，因此它是一个<strong>回归问题</strong>。</p> 
<h3><a id="2_13"></a>2.收集数据和预处理</h3> 
<h4><a id="1_14"></a>(1).收集数据</h4> 
<p>首先是收集数据，这一步又叫采集数据。</p> 
<p>在现实中，收集数据通常很辛苦，要在运营环节做很多数据埋点、获取用户消费等行为信息和兴趣偏好信息，有时候还需要上网爬取数据。</p> 
<p>收集数据的方法有很多，这里推荐之前写过的相关文章：<br> <strong>数据爬虫（JSON格式）&amp;数据地图可视化（pyecharts）【步骤清晰，一看就懂】</strong>：https://blog.csdn.net/weixin_42504788/article/details/134588642</p> 
<p><strong>数据爬取+数据可视化实战_哪里只得我共你(Dear Jane)_词云展示----网易云</strong>：https://blog.csdn.net/weixin_42504788/article/details/134622850</p> 
<p><strong>数据爬取+可视化实战_告白气球_词云展示----酷狗音乐</strong>：https://blog.csdn.net/weixin_42504788/article/details/134622575</p> 
<p><strong>处理Json格式的数据，如何用Python将数据存放入Excel中（步骤清晰，一看就懂）</strong>：https://blog.csdn.net/weixin_42504788/article/details/134543733</p> 
<h4><a id="2_27"></a>(2).数据可视化</h4> 
<p>数据可视化是个万金油技能，能做的事非常多。比如说，可以看一看特征和标签之间可能存在的关系，也可以看看数据里有没有“脏数据”和“离群点”等。</p> 
<p>常用的工具包有：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt <span class="token comment"># Matplotlib – Python画图工具库</span>
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns <span class="token comment"># Seaborn – 统计学数据可视化工具库</span>
</code></pre> 
<h4><a id="3_38"></a>(3).数据清洗</h4> 
<p><strong>处理缺失</strong>的数据：用均值填充、众数填充或0。如果建模用树模型，也可以不填充，树模型算法自身可以处理缺失值。<br> <strong>处理重复</strong>的数据：完全相同，删去即可。<br> <strong>处理错误</strong>的数据：部门人数、销量、销售金额小于0，遇到这类情况删去即可。<br> <strong>处理不可用</strong>的数据：建模的时候，数据必须是数字，不能是中英文等情况。比如性别出现男女字样，需要转化后再进行建模<br> <img src="https://images2.imgbox.com/e4/8a/kPZRarQe_o.png" alt="在这里插入图片描述"></p> 
<p>查看空缺值NaN出现的次数：<code>df.isna().sum()</code><br> 把出现了NaN的数据行删掉：<code>df = df.dropna()</code></p> 
<h4><a id="4_49"></a>(4).特征工程</h4> 
<p>特征贴合业务实际，特征越丰富，模型效果会更好</p> 
<h4><a id="5_52"></a>(5).构建特征集和标签集</h4> 
<p>特征是输入机器学习模型的变量。</p> 
<pre><code class="prism language-python">X <span class="token operator">=</span> df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'浏览量'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
X<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/27/c2/cPgvQbFO_o.png" alt="在这里插入图片描述"></p> 
<p>标签是结果或目标。</p> 
<pre><code class="prism language-python">y <span class="token operator">=</span> df<span class="token punctuation">.</span>浏览量
y<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/65/54/FxZOyik9_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="6_70"></a>(6).拆分训练集、验证集和测试集。</h4> 
<p>一般为了简化，验证集会省略，这里展示如何从数据中切分出训练集跟测试集</p> 
<pre><code class="prism language-python"><span class="token comment">#将数据集进行80%（训练集）和20%（验证集）的分割</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split <span class="token comment">#导入train_test_split工具</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> 
                                   test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<p>random_state设置一个值，保证每次切分的数据都一致，再次运行建模的效果也出现一致性。</p> 
<p>X_train：训练集的特征<br> X_test：测试集的特征<br> y_train：训练集的标签<br> y_test：测试集的标签</p> 
<h3><a id="3_85"></a>3.选择算法并建立模型</h3> 
<p>进行多个机器学习算法进行比较，将最优的算法作为baseline<br> 这里举个经典的逻辑回归例子，</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression <span class="token comment"># 导入线性回归算法模型</span>
linereg_model <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 使用线性回归算法创建模型</span>
</code></pre> 
<p>对于 LinearRegression 模型来讲，它的外部参数主要包括两个布尔值：</p> 
<ul><li>fit_intercept ，默认值为 True，代表是否计算模型的截距。</li><li>normalize，默认值为 False，代表是否对特征 X 在回归之前做规范化。</li></ul> 
<h3><a id="4_99"></a>4.训练模型</h3> 
<p>训练模型就是用训练集中的特征变量和已知标签，根据当前样本的损失大小来逐渐拟合函数，确定最优的内部参数，最后完成模型</p> 
<p>fit 方法是机器学习的核心环节，里面封装了很多具体的机器学习核心算法，我们只需要把特征训练数据集和标签训练数据集，同时作为参数传进 fit 方法就行了。</p> 
<pre><code class="prism language-python">linereg_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment"># 用训练集数据，训练机器，拟合函数，确定内部参数</span>
</code></pre> 
<p>不要小看上面那个简单的 fit 语句，这是模型进行自我学习的关键过程。</p> 
<p>fit 的核心就是减少损失，使函数对特征到标签的模拟越来越贴切。<br> <img src="https://images2.imgbox.com/0e/36/JEFccDfi_o.png" alt="在这里插入图片描述"></p> 
<p>这个拟合的过程，同时也是机器学习算法优化其内部参数的过程。而优化参数的关键就是减小损失。</p> 
<p>那什么是损失呢？它其实是对糟糕预测的惩罚，同时也是对模型好坏的度量。如果模型的预测完全准确，则损失为 0；如果不准确，就有损失。</p> 
<p>在机器学习中，我们追求的当然是比较小的损失。不过，模型好不好，还不能仅看单个样本，还要针对所有数据样本，找到一组平均损失“较小”的函数模型。样本的损失大小，从几何意义上基本可以理解为预测值和真值之间的几何距离。平均距离越大，说明误差越大，模型越离谱。在下面这个图中，左边是平均损失较大的模型，右边是平均损失较小的模型，模型所有数据点的平均损失很明显大过右边模型。</p> 
<p><img src="https://images2.imgbox.com/2b/41/t6funHyJ_o.png" alt="在这里插入图片描述"></p> 
<p>回归模型的拟合，它的关键环节就是<strong>通过梯度下降，逐步优化模型的参数，使训练集误差值达到最小</strong>。这也就是我们刚才讲的那个 fit 语句所要实现的最优化过程。</p> 
<p><img src="https://images2.imgbox.com/5c/ea/6NAZBj0U_o.png" alt="在这里插入图片描述"></p> 
<p>就像图里这样，梯度下降其实就和下山一样。你可以想象一下，当你站在高处，你的目标就是找到一系列的参数，让训练数据集上的损失值最小。那么你该往哪走才能保证损失值最小呢？关键就是通过求导的方法，找到每一步的方向，确保总是往更小的损失方向前进。</p> 
<h3><a id="5_132"></a>5.模型的评估和优化</h3> 
<p>梯度下降是在用训练集拟合模型时最小化误差，这时候算法调整的是模型的内部参数。而<strong>在验证集或者测试集进行模型效果评估的过程中，我们则是通过最小化误差来实现超参数（模型外部参数）的优化。</strong></p> 
<p>机器学习工具包（如 scikit-learn）中都会提供常用的工具和指标，对验证集和测试集进行评估，进而计算当前的误差。比如 R2 或者 MSE 均方误差指标，就可以用于评估回归分析模型的优劣。</p> 
<p>当我们预测完测试集的浏览量后，我们要再拿这个预测结果去和测试集已有的真值去比较，这样才能够求出模型的性能。而这整个过程也同样是一个循环迭代的过程</p> 
<p><img src="https://images2.imgbox.com/cf/9a/XZlq7D6I_o.png" alt="在这里插入图片描述"></p> 
<p>预测测试集的浏览量，只需要用训练好的模型 linereg_model 中的 predict 方法，在 X_test（特征测试集）上进行预测，这个方法就会返回对测试集的预测结果。</p> 
<pre><code class="prism language-python">y_pred <span class="token operator">=</span> linereg_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span> <span class="token comment">#预测测试集的Y值</span>
</code></pre> 
<p>拿到预测结果后，我们再通过下面的代码，把测试数据集的原始特征数据、原始标签真值，以及模型对标签的预测值组合在一起进行显示、比较。</p> 
<pre><code class="prism language-python">df_ads_pred <span class="token operator">=</span> X_test<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 测试集特征数据</span>
df_ads_pred<span class="token punctuation">[</span><span class="token string">'浏览量真值'</span><span class="token punctuation">]</span> <span class="token operator">=</span> y_test <span class="token comment"># 测试集标签真值</span>
df_ads_pred<span class="token punctuation">[</span><span class="token string">'浏览量预测值'</span><span class="token punctuation">]</span> <span class="token operator">=</span> y_pred <span class="token comment"># 测试集标签预测值</span>
df_ads_pred <span class="token comment">#显示数据</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4d/21/2jbwusOp_o.png" alt="在这里插入图片描述"></p> 
<p>如果你想看看现在的模型长得什么样？你可以通过 LinearRegression 的 coef_ 和 intercept_ 属性打印出各个特征的权重和模型的偏置来。它们也就是模型的内部参数。</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'当前模型的4个特征的权重分别是: '</span><span class="token punctuation">,</span> linereg_model<span class="token punctuation">.</span>coef_<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'当前模型的截距（偏置）是: '</span><span class="token punctuation">,</span> linereg_model<span class="token punctuation">.</span>intercept_<span class="token punctuation">)</span>

<span class="token comment"># 输出结果：</span>
<span class="token comment"># 当前模型的4个特征的权重分别是:  [   48.08395224    34.73062229 29730.13312489  2949.62196343]</span>
<span class="token comment"># 当前模型的截距（偏置）是:  -127493.90606857178</span>
</code></pre> 
<p>这也就是说，我们现在的模型的线性回归公式是：<br> yy=48.08x1​（点赞）+34.73x2​（转发）+29730.13x3​（热度）+2949.62x4​（评级）−127493.91</p> 
<p>对当前这个模型，给出评估分数：</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"线性回归预测评分："</span><span class="token punctuation">,</span> linereg_model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 评估模型</span>

<span class="token comment"># 输出结果：</span>
<span class="token comment"># 线性回归预测评分： 0.7085754407718876</span>
</code></pre> 
<p>在机器学习中，常用于评估回归分析模型的指标有两种：R2 分数和 MSE 指标，并且大多数机器学习工具包中都会提供相关的工具。对此，你无需做过多了解，只需要知道我们这里的 score 这个 API 中，选用的是 R2 分数来评估模型的就可以了。</p> 
<p>一般来说，R2 的取值在 0 到 1 之间，R2 越大，说明所拟合的回归模型越优。现在我们得到的 R2 值约为 0.708，在没有与其它模型进行比较之前，我们实际上也没法确定它是否能令人满意。</p> 
<p>如果模型的评估分数不理想，我们就需要回到第 3 步，调整模型的外部参数，重新训练模型。要是得到的结果依旧不理想，那我们就要考虑选择其他算法，创建全新的模型了。如果很不幸，新模型的效果还是不好的话，我们就得回到第 2 步，看看是不是数据出了问题。<br> <img src="https://images2.imgbox.com/f2/d4/Cxku5QJ1_o.png" alt="在这里插入图片描述"></p> 
<p>当模型通过了评估，就可以去解决实际问题了，机器学习项目也算是基本结束。</p> 
<hr> 
<p>学习机器学习的参考资料：<br> （1）书籍<br> 利用Python进行数据分析<br> 西瓜书<br> 百面机器学习<br> 机器学习实战<br> 阿里云天池大赛赛题解析(机器学习篇)<br> 白话机器学习中的数学<br> 零基础学机器学习<br> 图解机器学习算法<br> …</p> 
<p>（2）机构<br> 光环大数据<br> 开课吧<br> 极客时间<br> 七月在线<br> 深度之眼<br> 贪心学院<br> 拉勾教育<br> 博学谷<br> …</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e205326b3dd4871bc9409e6b4bf35ea7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SQL Server修改数据字段名的方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0fdd2a552c04ff26f0ab57f5fbde37cc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">一文搞懂 Python 3 中的 import</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>