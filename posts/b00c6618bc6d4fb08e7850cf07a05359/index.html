<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Gitlab部署CI并使用.gitlab-ci.yml配置您的作业(中文翻译) - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Gitlab部署CI并使用.gitlab-ci.yml配置您的作业(中文翻译)" />
<meta property="og:description" content="本文档描述了.gitlab-ci.ymlGitLab Runner用于管理项目作业的文件的用法。
如果您想快速介绍GitLab CI，请按照我们的 快速入门指南。
.gitlab-ci.yml 从版本7.12，GitLab CI使用YAML 文件（.gitlab-ci.yml）进行项目配置。它放置在存储库的根目录中，并包含如何构建项目的定义。
YAML文件定义了一组具有约束的作业，说明何时应该运行它们。作业被定义为具有名称的顶级元素，并且必须至少包含script子句：
job1: script: &#34;execute-script-for-job1&#34; job2: script: &#34;execute-script-for-job2&#34; 上述示例是具有两个单独作业的最简单的CI配置，其中每个作业执行不同的命令。
当然，命令可以直接（./configure;make;make install）执行代码，也可以test.sh在存储库中运行一个script（）。
工作由跑步者拾起并在跑步者的环境中执行。重要的是每项工作都是独立运作的。
YAML语法允许使用比上述示例中更复杂的作业规范：
image: ruby:2.1 services: - postgres before_script: - bundle install after_script: - rm secrets stages: - build - test - deploy job1: stage: build script: - execute-script-for-job1 only: - master tags: - docker 有一些保留keywords是不能被用作作业名：
关键词 需要 描述图片没有使用泊坞窗图像，满身是使用泊坞窗服务没有使用泊坞窗服务，覆盖在使用泊坞窗阶段没有定义构建阶段类型没有别名stages（已弃用）before_script没有定义在每个作业的脚本之前运行的命令after_script没有定义在每个作业的脚本之后运行的命令变量没有定义构建变量缓存没有定义应该在后续运行之间缓存的文件列表 形象和服务 这允许指定一个自定义的Docker映像和一个可以用于作业时间的服务列表。此功能的配置在 单独的文档中介绍。
before_script before_script用于定义在所有作业（包括部署作业）之前但在恢复工件之后应运行的命令。这可以是数组或多行字符串。
after_script 在GitLab 8.7中引入，需要Gitlab Runner v1.2
after_script用于定义将在所有作业之后运行的命令。这必须是一个数组或多行字符串。
阶段 stages用于定义作业可以使用的阶段。的说明书stages允许具有灵活的多阶段流水线。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/b00c6618bc6d4fb08e7850cf07a05359/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-04-12T13:23:12+08:00" />
<meta property="article:modified_time" content="2017-04-12T13:23:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Gitlab部署CI并使用.gitlab-ci.yml配置您的作业(中文翻译)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">本文档描述了</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.gitlab-ci.yml</code><span style=""><span style="">GitLab Runner用于管理项目作业的文件</span><span style="">的用法</span><span style="">。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">如果您想快速介绍GitLab CI，请按照我们的 </span><a target="_blank" href="https://docs.gitlab.com/ce/ci/quick_start/README.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">快速入门指南</a><span style="">。</span></p> 
<h3 id="gitlab-ci-yml" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:30px'> <span style="">.gitlab-ci.yml </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#gitlab-ci-yml" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h3> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">从版本7.12，GitLab CI使用</span><a target="_blank" href="https://en.wikipedia.org/wiki/YAML" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">YAML</a><span style=""> 文件（</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.gitlab-ci.yml</code><span style=""><span style="">）进行项目配置。</span><span style="">它放置在存储库的根目录中，并包含如何构建项目的定义。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">YAML文件定义了一组具有约束的作业，说明何时应该运行它们。</span><span style="">作业被定义为具有名称的顶级元素，并且必须至少包含</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>script</code><span style="">子句：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job1</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">execute-script-for-job1"</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">job2</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">execute-script-for-job2"</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">上述示例是具有两个单独作业的最简单的CI配置，其中每个作业执行不同的命令。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">当然，命令可以直接（</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>./configure;make;make install</code><span style=""><span style="">）</span><span style="">执行代码，也可以</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>test.sh</code><span style=""><span style="">在存储库中</span><span style="">运行一个script（</span><span style="">）。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">工作由</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/runners/README.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">跑步</a><span style=""><span style="">者拾起</span><span style="">并在跑步者的环境中执行。</span><span style="">重要的是每项工作都是独立运作的。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">YAML语法允许使用比上述示例中更复杂的作业规范：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">image</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">ruby:2.1</span>
<span class="na" style="font-size:14px; color:teal">services</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">postgres</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">before_script</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">bundle install</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">after_script</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">rm secrets</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">stages</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">build</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">deploy</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">job1</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">build</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">execute-script-for-job1</span>
  <span class="na" style="font-size:14px; color:teal">only</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">master</span>
  <span class="na" style="font-size:14px; color:teal">tags</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">docker</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">有一些保留</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>keywords</code><span style="">是</span><span style="font-weight:700">不能</span><span style="">被用作作业名：</span></p> 
<table style='border-spacing:0px; border-collapse:collapse; background-color:transparent; width:820px; overflow-x:scroll; border:1px solid rgb(229,229,229); font-family:"Source Sans Pro",sans-serif; font-size:14px'><thead style=""><tr style=""><th style="padding:5px 10px; text-align:left; border:1px solid rgb(229,229,229)"> <span style="">关键词</span></th><th style="padding:5px 10px; text-align:left; border:1px solid rgb(229,229,229)"> <span style="">需要</span></th><th style="padding:5px 10px; text-align:left; border:1px solid rgb(229,229,229)"> <span style="">描述</span></th></tr></thead><tbody style=""><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">图片</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">使用泊坞窗图像，满身是</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/docker/README.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">使用泊坞窗</a></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">服务</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">使用泊坞窗服务，覆盖在</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/docker/README.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">使用泊坞窗</a></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">阶段</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义构建阶段</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">类型</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">别名</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stages</code><span style="">（已弃用）</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">before_script</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义在每个作业的脚本之前运行的命令</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">after_script</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义在每个作业的脚本之后运行的命令</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">变量</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义构建变量</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">缓存</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义应该在后续运行之间缓存的文件列表</span></td></tr></tbody></table> 
<h4 id="image-and-services" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">形象和服务 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#image-and-services" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">这允许指定一个自定义的Docker映像和一个可以用于作业时间的服务列表。</span><span style="">此功能的配置在 </span></span><a target="_blank" href="https://docs.gitlab.com/ce/ci/docker/README.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">单独的文档中介绍</a><span style="">。</span></p> 
<h4 id="before_script" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">before_script </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#before_script" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>before_script</code><span style=""><span style="">用于定义在所有作业（包括部署作业）之前但在恢复工件之后应运行的命令。</span><span style="">这可以是数组或多行字符串。</span></span></p> 
<h4 id="after_script" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">after_script </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#after_script" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">在GitLab 8.7中引入，需要Gitlab Runner v1.2</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>after_script</code><span style=""><span style="">用于定义将在所有作业之后运行的命令。</span><span style="">这必须是一个数组或多行字符串。</span></span></p> 
<h4 id="stages" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">阶段 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#stages" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stages</code><span style=""><span style="">用于定义作业可以使用的阶段。</span><span style="">的说明书</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stages</code><span style="">允许具有灵活的多阶段流水线。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">元素</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stages</code><span style="">的排序定义作业的执行顺序：</span></p> 
<ol style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><span style="">相同阶段的工作并行运行。</span></li><li style="font-size:16px; line-height:22px"><span style="">上一阶段的工作成功完成后，下一阶段的工作就会运行。</span></li></ol> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">我们考虑下面的例子，它定义了3个阶段：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">stages</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">build</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">deploy</span>
</code></pre> 
<ol style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><span style="">首先，所有工作</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>build</code><span style="">都是并行执行的。</span></li><li style="font-size:16px; line-height:22px"><span style="">如果所有作业</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>build</code><span style="">成功，则</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>test</code><span style="">并行执行作业。</span></li><li style="font-size:16px; line-height:22px"><span style="">如果所有作业</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>test</code><span style="">成功，则</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>deploy</code><span style="">并行执行作业。</span></li><li style="font-size:16px; line-height:22px"><span style="">如果所有作业</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>deploy</code><span style="">成功，则提交将被标记为</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>success</code><span style="">。</span></li><li style="font-size:16px; line-height:22px"><span style="">如果以前任何一个作业失败，则提交将被标记为</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>failed</code><span style="">并且不执行进一步的作业。</span></li></ol> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">还有两个值得一提的边缘案例：</span></p> 
<ol style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><span style="">如果没有</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stages</code><span style="">被定义</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.gitlab-ci.yml</code><span style="">，那么</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>build</code><span style="">， </span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>test</code><span style="">和</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>deploy</code><span style="">允许被用作默认作业的阶段。</span></li><li style="font-size:16px; line-height:22px"><span style="">如果作业未指定</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stage</code><span style="">作业，则将作业分配给</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>test</code><span style="">舞台。</span></li></ol> 
<h4 id="types" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">类型 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#types" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style=""><span style="">已弃用，并将在10.0中删除。</span><span style="">使用</span></span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#stages" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">阶段</a><span style="">来代替。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">别名为</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#stages" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">阶段</a><span style="">。</span></p> 
<h4 id="variables" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">变量 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#variables" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">在GitLab Runner v0.5.0中引入。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">GitLab CI允许您添加</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.gitlab-ci.yml</code><span style=""><span style="">在作业环境中设置的变量。</span><span style="">变量存储在Git存储库中，旨在存储非敏感项目配置，例如：</span></span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">variables</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">DATABASE_URL</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">postgres://postgres@postgres/my_database"</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">这些变量可以在以后在所有执行的命令和脚本中使用。</span><span style="">YAML定义的变量也设置为所有创建的服务容器，从而允许对其进行微调。</span><span style="">也可以在</span></span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#job-variables" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">作业层面</a><span style=""><span style="">定义变量 </span><span style="">。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">除了用户定义的变量，还有由Runner本身设置的变量。</span><span style="">一个例子是</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>CI_COMMIT_REF_NAME</code><span style=""><span style="">具有构建项目的分支或标签名称的值。</span><span style="">除了可以设置的变量之外</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.gitlab-ci.yml</code><span style="">，还有所谓的秘密变量，可以在GitLab的UI中设置。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <a target="_blank" href="https://docs.gitlab.com/ce/ci/variables/README.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">了解有关变量的更多信息。</a></p> 
<h4 id="cache" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">缓存 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#cache" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">在GitLab Runner v0.7.0中引入。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>cache</code><span style=""><span style="">用于指定应该在作业之间缓存的文件和目录的列表。</span><span style="">您只能使用项目工作区内的路径。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="font-weight:700">默认情况下，从GitLab 9.0开始，管道和作业之间启用缓存并共享</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">如果</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>cache</code><span style="">被定义在作业范围之外，则意味着它在全局设置，并且所有作业将使用该定义。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">缓存的所有文件</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>binaries</code><span style="">和</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.config</code><span style="">：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">rspec</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test</span>
  <span class="na" style="font-size:14px; color:teal">cache</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">paths</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">binaries/</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">.config</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">缓存所有Git未跟踪的文件：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">rspec</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test</span>
  <span class="na" style="font-size:14px; color:teal">cache</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">untracked</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">缓存所有Git未跟踪的文件和文件</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>binaries</code><span style="">：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">rspec</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test</span>
  <span class="na" style="font-size:14px; color:teal">cache</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">untracked</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
    <span class="na" style="font-size:14px; color:teal">paths</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">binaries/</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">本地定义的高速缓存覆盖全局定义的选项。</span><span style="">以下</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>rspec</code><span style=""> 作业将仅缓存</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>binaries/</code><span style="">：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">cache</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">paths</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">my/files</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">rspec</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test</span>
  <span class="na" style="font-size:14px; color:teal">cache</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">key</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">rspec</span>
    <span class="na" style="font-size:14px; color:teal">paths</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">binaries/</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">请注意，由于缓存在作业之间共享，如果您为不同作业使用不同的路径，那么还应该设置不同的</span><span style="font-weight:700">缓存：key</span><span style=""> 否则缓存内容可以被覆盖。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">缓存是尽力而为的，所以不要指望缓存将始终存在。</span><span style="">有关实施细节，请查看GitLab Runner。</span></span></p> 
<h5 id="cache-key" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:10px; margin-bottom:10px; font-size:18px'> <span style="">缓存：键 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#cache-key" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h5> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">在GitLab Runner v1.0.0中引入。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">该</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>key</code><span style="">指令允许您定义作业之间缓存的亲和度，允许为所有作业，每个作业缓存，每个分支缓存或任何其他您认为正确的方式拥有单个缓存。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">这允许您微调缓存，允许您在不同的作业甚至不同的分支之间缓存数据。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">该</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>cache:key</code><span style="">变量可以使用任何</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/variables/README.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">预定义的变量</a><span style="">。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">项目默认的默认键是</span><span style="font-weight:700">默认</span><span style="">的，因此默认情况下，每个管道和作业之间共享一切，从GitLab 9.0开始。</span></p> 
<hr style='height:0px; margin-top:20px; margin-bottom:20px; border-right:0px; border-bottom:0px; border-left:0px; border-top-style:solid; border-top-color:rgb(229,229,229); font-family:"Source Sans Pro",sans-serif; font-size:14px'> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="font-weight:700">示例配置</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">启用每个作业的缓存：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">cache</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">key</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">$CI_JOB_NAME"</span>
  <span class="na" style="font-size:14px; color:teal">untracked</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">启用每分支缓存：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">cache</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">key</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">$CI_COMMIT_REF_NAME"</span>
  <span class="na" style="font-size:14px; color:teal">untracked</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">启用每个作业和每个分支缓存：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">cache</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">key</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">$CI_JOB_NAME/$CI_COMMIT_REF_NAME"</span>
  <span class="na" style="font-size:14px; color:teal">untracked</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">启用每个分支和每个阶段的缓存：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">cache</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">key</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">$CI_JOB_STAGE/$CI_COMMIT_REF_NAME"</span>
  <span class="na" style="font-size:14px; color:teal">untracked</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">如果您使用</span><span style="font-weight:700">Windows Batch</span><span style="">来运行您的shell脚本，则需要替换 </span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>$</code><span style="">为</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>%</code><span style="">：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">cache</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">key</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">%CI_JOB_STAGE%/%CI_COMMIT_REF_NAME%"</span>
  <span class="na" style="font-size:14px; color:teal">untracked</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
</code></pre> 
<h3 id="jobs" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:30px'> <span style="">工作 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#jobs" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h3> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.gitlab-ci.yml</code><span style=""><span style="">允许您指定无限数量的作业。</span><span style="">每个作业必须有一个唯一的名称，这不是上述关键字之一。</span><span style="">作业由定义作业行为的参数列表定义。</span></span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job_name</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">rake spec</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">coverage</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test</span>
  <span class="na" style="font-size:14px; color:teal">only</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">master</span>
  <span class="na" style="font-size:14px; color:teal">except</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">develop</span>
  <span class="na" style="font-size:14px; color:teal">tags</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">ruby</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">postgres</span>
  <span class="na" style="font-size:14px; color:teal">allow_failure</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
</code></pre> 
<table style='border-spacing:0px; border-collapse:collapse; background-color:transparent; width:820px; overflow-x:scroll; border:1px solid rgb(229,229,229); font-family:"Source Sans Pro",sans-serif; font-size:14px'><thead style=""><tr style=""><th style="padding:5px 10px; text-align:left; border:1px solid rgb(229,229,229)"> <span style="">关键词</span></th><th style="padding:5px 10px; text-align:left; border:1px solid rgb(229,229,229)"> <span style="">需要</span></th><th style="padding:5px 10px; text-align:left; border:1px solid rgb(229,229,229)"> <span style="">描述</span></th></tr></thead><tbody style=""><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">脚本</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">是</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义由Runner执行的shell脚本</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">图片</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">使用Docker图像，</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/docker/using_docker_images.html#define-image-and-services-from-gitlab-ciyml" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">使用Docker图像</a></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">服务</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style=""><span style="">使用Docker </span><a target="_blank" href="https://docs.gitlab.com/ce/ci/docker/using_docker_images.html#define-image-and-services-from-gitlab-ciyml" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)"><span style="">Images</span></a><span style="">使用码头服务</span></span><a target="_blank" href="https://docs.gitlab.com/ce/ci/docker/using_docker_images.html#define-image-and-services-from-gitlab-ciyml" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)"><span style=""></span></a></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">阶段</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义一个工作阶段（默认：</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>test</code><span style="">）</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">类型</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">别名为 </span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stage</code></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">变量</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">在作业级别定义作业变量</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">只要</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义创建作业的git参考列表</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">除</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义未创建作业的git参考列表</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">标签</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义用于选择Runner的标签列表</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">allow_failure</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style=""><span style="">允许作业失败。</span><span style="">失败的作业无助于提交状态</span></span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">什么时候</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style=""><span style="">定义何时运行作业。</span><span style="">可以是</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>on_success</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>on_failure</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>always</code><span style="">或者</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>manual</code></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">依赖关系</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义作业所依赖的其他作业，以便您可以在它们之间传递工件</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">文物</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style=""><span style="">定义</span><a target="_blank" href="https://docs.gitlab.com/ce/user/project/pipelines/job_artifacts.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)"><span style="">作业文件</span></a><span style="">列表</span></span><a target="_blank" href="https://docs.gitlab.com/ce/user/project/pipelines/job_artifacts.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)"><span style=""></span></a></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">缓存</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义应该在后续运行之间缓存的文件列表</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">before_script</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">覆盖在作业之前执行的一组命令</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">after_script</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">覆盖在作业后执行的一组命令</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">环境</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义此作业完成部署的环境名称</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">覆盖面</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">没有</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">定义给定作业的代码覆盖率设置</span></td></tr></tbody></table> 
<h4 id="script" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">脚本 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#script" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>script</code><span style=""><span style="">是由Runner执行的shell脚本。</span><span style="">例如：</span></span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">bundle</span><span class="nv" style="font-size:14px; color:teal"> </span><span class="s" style="font-size:14px; color:rgb(221,17,68)">exec</span><span class="nv" style="font-size:14px; color:teal"> </span><span class="s" style="font-size:14px; color:rgb(221,17,68)">rspec"</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">此参数还可以包含使用数组的多个命令：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">uname -a</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">bundle exec rspec</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">有时，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>script</code><span style=""><span style="">命令需要用单引号或双引号括起来。</span><span style="">例如，包含冒号（</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>:</code><span style=""><span style="">）的</span><span style="">命令</span><span style="">需要用引号括起来，以便YAML解析器知道将整个事物解释为字符串而不是“key：value”对。</span><span style="">使用特殊字符时要小心：</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>:</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>{<!-- --></code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>}</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>[</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>]</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>,</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>&amp;</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>*</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>#</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>?</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>|</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>-</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>&lt;</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>&gt;</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>=</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>!</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>%</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>@</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>`</code><span style="">。</span></p> 
<h4 id="stage" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">阶段 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#stage" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stage</code><span style="">允许将作业分组到不同的阶段。</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stage</code><span style=""><span style=""> 执行</span><span style="">相同的作业</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>parallel</code><span style=""><span style="">。</span><span style="">有关使用</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stage</code><span style="">请查看 </span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#stages" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">阶段的</a><span style=""><span style="">更多信息</span><span style="">。</span></span></p> 
<h4 id="only-and-except" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">只有和除外 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#only-and-except" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>only</code><span style="">并且</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>except</code><span style="">是设置参考策略限制作业构建时的两个参数：</span></p> 
<ol style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>only</code><span style=""> 定义作业将要运行的分支和标签的名称。</span></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>except</code><span style="">定义作业</span><span style="font-weight:700">不能</span><span style=""><span style="">运行</span><span style="">的分支和标签的名称 </span><span style="">。</span></span></li></ol> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">有一些适用于参考资料政策使用的规则：</span></p> 
<ul style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>only</code><span style="">并且</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>except</code><span style=""><span style="">是包容性的 </span><span style="">如果同时</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>only</code><span style="">并</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>except</code><span style="">在作业规范中定义，裁判通过过滤</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>only</code><span style="">和</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>except</code><span style="">。</span></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>only</code><span style="">并</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>except</code><span style="">允许使用正则表达式。</span></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>only</code><span style="">并</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>except</code><span style="">允许使用特殊的关键字：</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>branches</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>tags</code><span style="">，和</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>triggers</code><span style="">。</span></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>only</code><span style="">并</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>except</code><span style="">允许指定一个存储库路径来过滤叉子的作业。</span></li></ul> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">在下面的示例中，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>job</code><span style="">将只针对以开头的参数运行</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>issue-</code><span style="">，而所有分支将被跳过。</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="c1" style="font-size:14px; color:rgb(153,153,136); font-style:italic"># use regexp</span>
  <span class="na" style="font-size:14px; color:teal">only</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">/^issue-.*$/</span>
  <span class="c1" style="font-size:14px; color:rgb(153,153,136); font-style:italic"># use special keyword</span>
  <span class="na" style="font-size:14px; color:teal">except</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">branches</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">在这个例子中，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>job</code><span style="">将仅对标记的引用运行，或者通过API触发器明确地请求构建。</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="c1" style="font-size:14px; color:rgb(153,153,136); font-style:italic"># use special keywords</span>
  <span class="na" style="font-size:14px; color:teal">only</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">tags</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">triggers</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">存储库路径可用于仅为父存储库执行作业，而不是叉：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">only</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">branches@gitlab-org/gitlab-ce</span>
  <span class="na" style="font-size:14px; color:teal">except</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">master@gitlab-org/gitlab-ce</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">上述示例将运行</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>job</code><span style="">于</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>gitlab-org/gitlab-ce</code><span style=""><span style="">除master之外</span><span style="">的所有分支</span><span style="">。</span></span></p> 
<h4 id="job-variables" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">工作变量 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#job-variables" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">可以使用</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>variables</code><span style=""><span style="">作业级别</span><span style="">的</span><span style="">关键字</span><span style="">来定义作业变量</span><span style="">。</span><span style="">它的工作原理与其</span></span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#variables" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">全局级别的方法基本相同</a><span style="">，但允许您定义作业特定的变量。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">当在</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>variables</code><span style=""><span style="">作业级使用关键字时，它将覆盖全局YAML作业变量和预定义作业变量。</span><span style="">要关闭作业中的全局定义变量，请定义一个空数组：</span></span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job_name</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">variables</span><span class="pi" style="font-size:14px">:</span> <span class="pi" style="font-size:14px">[]</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">作业变量优先级在</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/variables/README.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">变量文档</a><span style=""><span style="">中定义</span><span style="">。</span></span></p> 
<h4 id="tags" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">标签 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#tags" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>tags</code><span style=""> 用于从允许运行此项目的所有跑步者列表中选择特定的赛跑者。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">在一个亚军的注册，您可以指定亚军的标签，例如</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>ruby</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>postgres</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>development</code><span style="">。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>tags</code><span style=""> 允许您运行具有分配给它们的指定标签的运行器的作业：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">tags</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">ruby</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">postgres</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">上面的规范将确保</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>job</code><span style="">由一个具有两个</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>ruby</code><span style="">AND </span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>postgres</code><span style=""><span style="">标签</span><span style="">的Runner构建</span><span style="">。</span></span></p> 
<h4 id="allow_failure" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">allow_failure </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#allow_failure" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>allow_failure</code><span style=""><span style="">当您要允许作业失败而不影响其余的CI套件时使用。</span><span style="">失败的作业无助于提交状态。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">启用并且作业失败时，对于所有意图和目的，流水线将成功/绿色，但是在合并请求或提交或作业页面上将显示“通过警告的CI构建”消息。</span><span style="">这被允许失败的作业使用，但是如果失败表示其他地方应采取其他（手动）步骤。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">在下面的示例中，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>job1</code><span style="">并且</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>job2</code><span style="">将并行运行，但是如果</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>job1</code><span style=""> 失败，则不会停止运行的下一个阶段，因为它标记为</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>allow_failure: true</code><span style="">：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job1</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">execute_script_that_will_fail</span>
  <span class="na" style="font-size:14px; color:teal">allow_failure</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">job2</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">execute_script_that_will_succeed</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">job3</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">deploy</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">deploy_to_staging</span>
</code></pre> 
<h4 id="when" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">什么时候 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#when" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>when</code><span style=""> 用于实现在出现故障或运行失败时运行的作业。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>when</code><span style=""> 可以设置为以下值之一：</span></p> 
<ol style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>on_success</code><span style=""><span style=""> - 只有当前一个阶段的所有工作成功时才​​执行工作。</span><span style="">这是默认值。</span></span></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>on_failure</code><span style=""> - 仅当前一个阶段的至少一个作业发生故障时才执行作业。</span></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>always</code><span style=""> - 无论前一阶段的工作状况如何，执行工作。</span></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>manual</code><span style=""><span style=""> - 手动执行作业（在GitLab 8.10中添加）。</span><span style="">阅读 </span><span style="">下面的</span></span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#manual-actions" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">手动操作</a><span style="">。</span></li></ol> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">例如：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">stages</span><span class="pi" style="font-size:14px">:</span>
<span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">build</span>
<span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">cleanup_build</span>
<span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test</span>
<span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">deploy</span>
<span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">cleanup</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">build_job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">build</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">make build</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">cleanup_build_job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">cleanup_build</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">cleanup build when failed</span>
  <span class="na" style="font-size:14px; color:teal">when</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">on_failure</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">test_job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">make test</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">deploy_job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">deploy</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">make deploy</span>
  <span class="na" style="font-size:14px; color:teal">when</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">manual</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">cleanup_job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">cleanup</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">cleanup after jobs</span>
  <span class="na" style="font-size:14px; color:teal">when</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">always</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">以上脚本将：</span></p> 
<ol style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><span style=""></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>cleanup_build_job</code><span style="">仅在</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>build_job</code><span style=""><span style="">失败</span><span style="">时</span><span style="">执行</span><span style="">。</span></span></li><li style="font-size:16px; line-height:22px"><span style="">始终执行</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>cleanup_job</code><span style="">作为流水线的最后一步，无论成功或失败。</span></li><li style="font-size:16px; line-height:22px"><span style="">允许您</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>deploy_job</code><span style=""><span style="">从GitLab的UI </span><span style="">手动执行</span><span style="">。</span></span></li></ol> 
<h5 id="manual-actions" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:10px; margin-bottom:10px; font-size:18px'> <span style="">手动操作 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#manual-actions" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h5> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">在GitLab 8.10中介绍。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">手动操作是不自动执行的特殊类型的作业; </span><span style="">他们需要由用户明确地启动。</span><span style="">可以从管道，构建，环境和部署视图启动手动操作。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">手动操作的示例使用是部署到生产。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">阅读更多在</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/environments.html#manually-deploying-to-environments" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">环境文档</a><span style="">。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">手动操作可以是可选的或阻止的。</span><span style="">阻止手动操作将在此操作定义的阶段阻止流水线的执行。当有人通过单击</span></span><span style="">播放</span><span style=""><span style="">按钮</span><span style="">执行阻止手动操作时，可以恢复管道的执行</span><span style="">。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">当管道被阻止时，如果管道成功设置时合并，则不会合并管道。</span><span style="">封闭的管道也有一个特殊的状态，称为</span></span><span style="">手动</span><span style="">。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">默认情况下，手动操作不阻止。</span><span style="">如果要进行手动操作阻止，则需要添加</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>allow_failure: false</code><span style="">到作业的定义中</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.gitlab-ci.yml</code><span style="">。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>allow_failure: true</code><span style=""><span style="">默认情况下，</span><span style="">可选手动操作已</span><span style="">设置。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="font-weight:700">可选操作的状态对总体管道状态无贡献。</span></p> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">GitLab 9.0中引入了禁止手动操作</span></p> 
</blockquote> 
<h4 id="environment" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">环境 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#environment" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px"> <span style="font-weight:700">笔记：</span></p> 
 <ul style="margin:inherit"><li style="font-size:16px; line-height:22px"><span style="">在GitLab 8.9中引入。</span></li><li style="font-size:16px; line-height:22px"><span style="">你可以阅读更多有关的环境，并找到更多的例子 </span><a target="_blank" href="https://docs.gitlab.com/ce/ci/environments.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">有关环境的文档</a><span style="">。</span></li></ul> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>environment</code><span style=""><span style="">用于定义作业部署到特定环境。</span><span style="">如果</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>environment</code><span style="">被指定，并且没有该名称下的环境，则将自动创建一个新的名称。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">在最简单的形式中，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>environment</code><span style="">关键字可以定义如下：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">deploy to production</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">deploy</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">git push production HEAD:master</span>
  <span class="na" style="font-size:14px; color:teal">environment</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">name</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">production</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">在上述示例中，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>deploy to production</code><span style="">作业将被标记为对环境进行</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>production</code><span style="">部署。</span></p> 
<h5 id="environment-name" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:10px; margin-bottom:10px; font-size:18px'> <span style="">环境：名称 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#environment-name" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h5> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px"> <span style="font-weight:700">笔记：</span></p> 
 <ul style="margin:inherit"><li style="font-size:16px; line-height:22px"><span style="">在GitLab 8.11中引入。</span></li><li style="font-size:16px; line-height:22px"><span style="">在GitLab 8.11之前，环境的名称可以被定义为一个字符串 </span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>environment: production</code><span style=""><span style="">。</span><span style="">现在推荐的方法是在</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>name</code><span style=""><span style="">关键字</span><span style="">下定义它 </span><span style="">。</span></span></li></ul> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">该</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>environment</code><span style="">名称可以包含以下内容：</span></p> 
<ul style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><span style="">信件</span></li><li style="font-size:16px; line-height:22px"><span style="">数字</span></li><li style="font-size:16px; line-height:22px"><span style="">空格</span></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>-</code></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>_</code></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>/</code></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>$</code></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>{<!-- --></code></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>}</code></li></ul> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">通用名称是</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>qa</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>staging</code><span style="">和</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>production</code><span style="">，但您可以使用与工作流程相匹配的任何名称。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">除了在</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>environment</code><span style=""><span style=""> 关键字</span><span style="">之后定义环境的名称之外</span><span style="">，还可以将其定义为单独的值。</span><span style="">为此，请使用以下</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>name</code><span style="">关键字</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>environment</code><span style="">：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">deploy to production</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">deploy</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">git push production HEAD:master</span>
  <span class="na" style="font-size:14px; color:teal">environment</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">name</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">production</span>
</code></pre> 
<h5 id="environment-url" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:10px; margin-bottom:10px; font-size:18px'> <span style="">环境：url </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#environment-url" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h5> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px"> <span style="font-weight:700">笔记：</span></p> 
 <ul style="margin:inherit"><li style="font-size:16px; line-height:22px"><span style="">在GitLab 8.11中引入。</span></li><li style="font-size:16px; line-height:22px"><span style=""><span style="">在GitLab 8.11之前，该URL只能在GitLab的UI中添加。</span><span style="">现在推荐的方法是定义它</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.gitlab-ci.yml</code><span style="">。</span></li></ul> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">这是一个可选的值，当设置时，它会暴露GitLab中各个位置的按钮，当单击时，您可以访问定义的URL。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">在下面的示例中，如果作业成功完成，它将在合并请求和将指向的环境/部署页面中创建按钮</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>https://prod.example.com</code><span style="">。</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">deploy to production</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">deploy</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">git push production HEAD:master</span>
  <span class="na" style="font-size:14px; color:teal">environment</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">name</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">production</span>
    <span class="na" style="font-size:14px; color:teal">url</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">https://prod.example.com</span>
</code></pre> 
<h5 id="environment-on_stop" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:10px; margin-bottom:10px; font-size:18px'> <span style="">environment：on_stop </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#environment-on_stop" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h5> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px"> <span style="font-weight:700">笔记：</span></p> 
 <ul style="margin:inherit"><li style="font-size:16px; line-height:22px"><a target="_blank" href="https://gitlab.com/gitlab-org/gitlab-ce/merge_requests/6669" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">介绍</a><span style="">在GitLab 8.13。</span></li><li style="font-size:16px; line-height:22px"><span style="">从GitLab 8.14开始，当您有一个定义了停止动作的环境时，GitLab会在关联的分支被删除时自动触发停止动作。</span></li></ul> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">关闭（stoping）环境可以通过下面</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>on_stop</code><span style=""><span style="">定义</span><span style="">的</span><span style="">关键字 </span><span style="">来实现</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>environment</code><span style=""><span style="">。</span><span style="">它宣布了一个不同的工作，以便关闭环境。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">阅读本</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>environment:action</code><span style="">节为例。</span></p> 
<h5 id="environment-action" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:10px; margin-bottom:10px; font-size:18px'> <span style="">环境：行动 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#environment-action" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h5> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><a target="_blank" href="https://gitlab.com/gitlab-org/gitlab-ce/merge_requests/6669" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">介绍</a><span style="">在GitLab 8.13。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">该</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>action</code><span style="">关键字与</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>on_stop</code><span style=""><span style="">被称为关闭环境的作业</span><span style="">结合使用</span><span style="">并定义。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">例如：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">review_app</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">deploy</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">make deploy-app</span>
  <span class="na" style="font-size:14px; color:teal">environment</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">name</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">review</span>
    <span class="na" style="font-size:14px; color:teal">on_stop</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">stop_review_app</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">stop_review_app</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">deploy</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">make delete-app</span>
  <span class="na" style="font-size:14px; color:teal">when</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">manual</span>
  <span class="na" style="font-size:14px; color:teal">environment</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">name</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">review</span>
    <span class="na" style="font-size:14px; color:teal">action</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">stop</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">在上面的例子中，我们设置了</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>review_app</code><span style="">部署到环境中的</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>review</code><span style=""> 工作，我们也定义了一个新的</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stop_review_app</code><span style="">工作</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>on_stop</code><span style=""><span style="">。</span><span style="">一旦</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>review_app</code><span style="">作业成功完成，它将</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stop_review_app</code><span style=""><span style="">根据下面的定义</span><span style="">触发 </span><span style="">作业</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>when</code><span style=""><span style="">。</span><span style="">在这种情况下，我们设置它，</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>manual</code><span style=""><span style="">因此需要</span><span style="">通过GitLab的Web界面进行</span></span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#manual-actions" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">手动操作</a><span style="">才能运行。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">该</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stop_review_app</code><span style="">作业</span><span style="font-weight:700">需要</span><span style="">定义以下关键字：</span></p> 
<ul style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>when</code><span style="">- </span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#when" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">参考</a></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>environment:name</code></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>environment:action</code></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>stage</code><span style="">应该是相同的</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>review_app</code><span style="">，以便环境在分支被删除时自动停止</span></li></ul> 
<h5 id="dynamic-environments" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:10px; margin-bottom:10px; font-size:18px'> <span style="">动态环境 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#dynamic-environments" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h5> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px"> <span style="font-weight:700">笔记：</span></p> 
 <ul style="margin:inherit"><li style="font-size:16px; line-height:22px"><a target="_blank" href="https://gitlab.com/gitlab-org/gitlab-ce/merge_requests/6323" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">介绍</a><span style="">在GitLab 8.12和GitLab亚军1.6。</span></li><li style="font-size:16px; line-height:22px"><span style="">在</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>$CI_ENVIRONMENT_SLUG</code><span style="">被</span><a target="_blank" href="https://gitlab.com/gitlab-org/gitlab-ce/merge_requests/7983" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">介绍</a><span style="">在GitLab 8.15。</span></li></ul> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>environment</code><span style="">也可以用</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>name</code><span style=""><span style="">和</span><span style="">表示一个配置哈希</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>url</code><span style=""><span style="">。</span><span style="">这些参数可以使用任何定义的</span></span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#variables" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">CI变量</a><span style=""> （包括预定义的安全变量和</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.gitlab-ci.yml</code><span style="">变量）。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">例如：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">deploy as review app</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">deploy</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">make deploy</span>
  <span class="na" style="font-size:14px; color:teal">environment</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">name</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">review/$CI_COMMIT_REF_NAME</span>
    <span class="na" style="font-size:14px; color:teal">url</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">https://$CI_ENVIRONMENT_SLUG.example.com/</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">该</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>deploy as review app</code><span style="">作业将被标记为部署以动态创建</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>review/$CI_COMMIT_REF_NAME</code><span style=""><span style="">环境，其中</span><span style="">由Runner设置</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>$CI_COMMIT_REF_NAME</code><span style=""> 的</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/variables/README.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">环境变量</a><span style=""><span style="">在哪里</span><span style="">。</span><span style="">该 </span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>$CI_ENVIRONMENT_SLUG</code><span style=""><span style="">变量基于环境名称，但适合包含在URL中。</span><span style="">在这种情况下，如果</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>deploy as review app</code><span style="">作业是在命名的分支中运行的</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>pow</code><span style="">，那么这个环境将可以通过一个URL访问 </span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>https://review-pow.example.com/</code><span style="">。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">这当然意味着承载应用程序的底层服务器被正确配置。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">常见的用例是为分支创建动态环境，并将其用作Review Apps。</span><span style="">您可以在</span></span><a target="_blank" href="https://gitlab.com/gitlab-examples/review-apps-nginx/" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">https://gitlab.com/gitlab-examples/review-apps-nginx/</a><span style=""><span style="">上查看使用Review Apps的简单示例 </span><span style="">。</span></span></p> 
<h4 id="artifacts" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">文物 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#artifacts" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px"> <span style="font-weight:700">笔记：</span></p> 
 <ul style="margin:inherit"><li style="font-size:16px; line-height:22px"><span style="">在非Windows平台的GitLab Runner v0.7.0中引入。</span></li><li style="font-size:16px; line-height:22px"><span style="">GitLab Runner v.1.0.0中添加了Windows支持。</span></li><li style="font-size:16px; line-height:22px"><span style="">目前并不是所有的执行者都被支持。</span></li><li style="font-size:16px; line-height:22px"><span style="">默认情况下，作业工件仅针对成功的作业进行收集。</span></li></ul> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>artifacts</code><span style=""><span style="">用于指定成功后应附加到作业的文件和目录的列表。</span><span style="">您只能使用项目工作区内的路径。</span><span style="">要在不同的作业之间传递工件，请参阅</span></span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#dependencies" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">依赖关系</a><span style=""><span style="">。</span><span style="">以下是一些例子。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">发送所有文件</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>binaries</code><span style="">和</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.config</code><span style="">：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">artifacts</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">paths</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">binaries/</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">.config</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">发送所有Git未跟踪的文件：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">artifacts</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">untracked</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">发送所有Git未跟踪的文件和文件</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>binaries</code><span style="">：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">artifacts</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">untracked</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
  <span class="na" style="font-size:14px; color:teal">paths</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">binaries/</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">要禁用工件传递，请使用空的</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#dependencies" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">依赖关系</a><span style=""><span style="">定义作业</span><span style="">：</span></span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">build</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">make build</span>
  <span class="na" style="font-size:14px; color:teal">dependencies</span><span class="pi" style="font-size:14px">:</span> <span class="pi" style="font-size:14px">[]</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">您可能只想为标记的版本创建工件，以避免使用临时构建工件填充构建服务器存储。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">仅为标签创建工件（</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>default-job</code><span style="">不会创建工件）：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">default-job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">mvn test -U</span>
  <span class="na" style="font-size:14px; color:teal">except</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">tags</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">release-job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">mvn package -U</span>
  <span class="na" style="font-size:14px; color:teal">artifacts</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">paths</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">target/*.war</span>
  <span class="na" style="font-size:14px; color:teal">only</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">tags</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">工作完成后，工件将发送到GitLab，并可在GitLab UI中下载。</span></p> 
<h5 id="artifacts-name" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:10px; margin-bottom:10px; font-size:18px'> <span style="">文物：名称 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#artifacts-name" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h5> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">在GitLab 8.6和GitLab Runner v1.1.0中引入。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">该</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>name</code><span style=""><span style="">指令允许您定义创建的工件存档的名称。</span><span style="">这样，您可以为每个存档提供一个唯一的名称，当您希望从GitLab下载存档时，这可能会很有用。</span><span style="">该</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>artifacts:name</code><span style=""> 变量可以使用任何</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/variables/README.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">预定义的变量</a><span style=""><span style="">。</span><span style="">默认名称为</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>artifacts</code><span style="">，成为</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>artifacts.zip</code><span style="">下载的时候。</span></p> 
<hr style='height:0px; margin-top:20px; margin-bottom:20px; border-right:0px; border-bottom:0px; border-left:0px; border-top-style:solid; border-top-color:rgb(229,229,229); font-family:"Source Sans Pro",sans-serif; font-size:14px'> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="font-weight:700">示例配置</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">要创建具有当前作业名称的归档文件：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">artifacts</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">name</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">$CI_JOB_NAME"</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">要创建具有当前分支或标记的名称的归档文件，仅包含由Git未跟踪的文件：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
   <span class="na" style="font-size:14px; color:teal">artifacts</span><span class="pi" style="font-size:14px">:</span>
     <span class="na" style="font-size:14px; color:teal">name</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">$CI_COMMIT_REF_NAME"</span>
     <span class="na" style="font-size:14px; color:teal">untracked</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">要使用当前作业的名称创建一个存档，并且当前的分支或标记仅包含Git未跟踪的文件：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">artifacts</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">name</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">${CI_JOB_NAME}_${CI_COMMIT_REF_NAME}"</span>
    <span class="na" style="font-size:14px; color:teal">untracked</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">要创建具有当前</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#stages" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">阶段</a><span style=""><span style="">和分支名称</span><span style="">的存档</span><span style="">：</span></span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">artifacts</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">name</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">${CI_JOB_STAGE}_${CI_COMMIT_REF_NAME}"</span>
    <span class="na" style="font-size:14px; color:teal">untracked</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
</code></pre> 
<hr style='height:0px; margin-top:20px; margin-bottom:20px; border-right:0px; border-bottom:0px; border-left:0px; border-top-style:solid; border-top-color:rgb(229,229,229); font-family:"Source Sans Pro",sans-serif; font-size:14px'> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">如果您使用</span><span style="font-weight:700">Windows Batch</span><span style="">来运行您的shell脚本，则需要替换 </span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>$</code><span style="">为</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>%</code><span style="">：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">artifacts</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">name</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">%CI_JOB_STAGE%_%CI_COMMIT_REF_NAME%"</span>
    <span class="na" style="font-size:14px; color:teal">untracked</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">true</span>
</code></pre> 
<h5 id="artifacts-when" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:10px; margin-bottom:10px; font-size:18px'> <span style="">文物：何时 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#artifacts-when" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h5> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">在GitLab 8.9和GitLab Runner v1.3.0中引入。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>artifacts:when</code><span style=""> 用于在作业失败或尽管发生故障时上传工件。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>artifacts:when</code><span style=""> 可以设置为以下值之一：</span></p> 
<ol style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>on_success</code><span style=""><span style=""> - 仅当作业成功时上传工件。</span><span style="">这是默认值。</span></span></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>on_failure</code><span style=""> - 仅当作业失败时才上传工件。</span></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>always</code><span style=""> - 无论工作状态如何，都会上传工件。</span></li></ol> 
<hr style='height:0px; margin-top:20px; margin-bottom:20px; border-right:0px; border-bottom:0px; border-left:0px; border-top-style:solid; border-top-color:rgb(229,229,229); font-family:"Source Sans Pro",sans-serif; font-size:14px'> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="font-weight:700">示例配置</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">仅在作业失败时上传工件。</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">artifacts</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">when</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">on_failure</span>
</code></pre> 
<h5 id="artifacts-expire_in" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:10px; margin-bottom:10px; font-size:18px'> <span style="">文物：expire_in </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#artifacts-expire_in" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h5> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">在GitLab 8.9和GitLab Runner v1.3.0中引入。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>artifacts:expire_in</code><span style=""><span style="">用于在指定时间后删除上传的工件。</span><span style="">默认情况下，工件永远存储在GitLab上。</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>expire_in</code><span style="">允许您指定制品在其过期之前应存在多长时间，从上传和存储在GitLab上的时间开始计算。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">您可以使用</span><span style="">作业页面上的</span><span style="">“ </span></span><span style="font-weight:700">保留</span><span style=""> ”按钮来覆盖过期并永久保存工件。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">到期后，默认情况下实际上会删除工件（通过cron作业），但在到期后不可访问。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">值</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>expire_in</code><span style=""><span style="">是经过的时间。</span><span style="">可分析值的示例：</span></span></p> 
<ul style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><span style="">'3分4秒'</span></li><li style="font-size:16px; line-height:22px"><span style="">'2小时20分钟'</span></li><li style="font-size:16px; line-height:22px"><span style="">'2h20min'</span></li><li style="font-size:16px; line-height:22px"><span style="">'6 mos 1天'</span></li><li style="font-size:16px; line-height:22px"><span style="">'47年6 mos和4d'</span></li><li style="font-size:16px; line-height:22px"><span style="">'3周2天'</span></li></ul> 
<hr style='height:0px; margin-top:20px; margin-bottom:20px; border-right:0px; border-bottom:0px; border-left:0px; border-top-style:solid; border-top-color:rgb(229,229,229); font-family:"Source Sans Pro",sans-serif; font-size:14px'> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="font-weight:700">示例配置</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">上传后1周过期文物：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">artifacts</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">expire_in</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">1 week</span>
</code></pre> 
<h4 id="dependencies" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">依赖关系 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#dependencies" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">在GitLab 8.6和GitLab Runner v1.1.1中引入。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">此功能应与之结合使用，</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#artifacts" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(55,119,176); background-color:rgb(249,242,244)'>artifacts</code></a><span style="">并允许您定义在不同作业之间传递的工件。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">请注意，</span><span style="">默认情况下</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>artifacts</code><span style="">，所有以前的</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#stages" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">阶段</a><span style="">都将被传递。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">要使用此功能，请</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>dependencies</code><span style=""><span style="">在作业的上下文中</span><span style="">定义</span><span style="">，并传递所有以前作业的列表，从中下载工件。</span><span style="">您只能从在当前执行的阶段定义作业。</span><span style="">如果从当前阶段或下一个阶段定义作业，将会显示错误。</span><span style="">定义空数组将跳过下载该作业的任何工件。</span></span></p> 
<hr style='height:0px; margin-top:20px; margin-bottom:20px; border-right:0px; border-bottom:0px; border-left:0px; border-top-style:solid; border-top-color:rgb(229,229,229); font-family:"Source Sans Pro",sans-serif; font-size:14px'> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">在下面的例子中，我们定义了两个就业机会，文物，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>build:osx</code><span style="">和 </span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>build:linux</code><span style=""><span style="">。</span><span style="">当</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>test:osx</code><span style="">被执行时，从所述工件</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>build:osx</code><span style=""><span style=""> 将被下载和在构建的上下文中提取。</span><span style="">同样的事情</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>test:linux</code><span style="">和文物从</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>build:linux</code><span style="">。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>deploy</code><span style="">由于</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#stages" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">阶段</a><span style=""><span style="">优先</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#stages" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)"><span style="">级，</span></a><span style="">该作业</span><span style="">将从以前所有</span><span style="">作业</span><span style="">中下载</span><span style="">工件：</span></span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="s" style="font-size:14px; color:rgb(221,17,68)">build:osx</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">build</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">make build:osx</span>
  <span class="na" style="font-size:14px; color:teal">artifacts</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">paths</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">binaries/</span><span style=""></span>
<span style=""></span>
<span class="s" style="font-size:14px; color:rgb(221,17,68)">build:linux</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">build</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">make build:linux</span>
  <span class="na" style="font-size:14px; color:teal">artifacts</span><span class="pi" style="font-size:14px">:</span>
    <span class="na" style="font-size:14px; color:teal">paths</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">binaries/</span><span style=""></span>
<span style=""></span>
<span class="s" style="font-size:14px; color:rgb(221,17,68)">test:osx</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">make test:osx</span>
  <span class="na" style="font-size:14px; color:teal">dependencies</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">build:osx</span><span style=""></span>
<span style=""></span>
<span class="s" style="font-size:14px; color:rgb(221,17,68)">test:linux</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">make test:linux</span>
  <span class="na" style="font-size:14px; color:teal">dependencies</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">build:linux</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">deploy</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">stage</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">deploy</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">make deploy</span>
</code></pre> 
<h4 id="before_script-and-after_script" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">before_script和after_script </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#before_script-and-after_script" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">可以覆盖全局定义的</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>before_script</code><span style="">和</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>after_script</code><span style="">：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">before_script</span><span class="pi" style="font-size:14px">:</span>
<span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">global before script</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">job</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">before_script</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">execute this instead of global before script</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">my command</span>
  <span class="na" style="font-size:14px; color:teal">after_script</span><span class="pi" style="font-size:14px">:</span>
  <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">execute this after my script</span>
</code></pre> 
<h4 id="coverage" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">覆盖面 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#coverage" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="font-weight:700">笔记：</span></p> 
<ul style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><a target="_blank" href="https://gitlab.com/gitlab-org/gitlab-ce/merge_requests/7447" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">介绍</a><span style="">在GitLab 8.17。</span></li></ul> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>coverage</code><span style=""> 允许您配置如何从作业输出中提取代码覆盖率。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">正则表达式是这里唯一有效的值。</span><span style="">所以，使用周边</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>/</code><span style=""><span style="">是强制性的，以便一致地和明确地表示正则表达式字符串。</span><span style="">如果你想从字面上匹配，你必须逃脱特殊字符。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">一个简单的例子：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">job1</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">coverage</span><span class="pi" style="font-size:14px">:</span> <span class="s1" style="font-size:14px; color:rgb(221,17,68)">'</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">/Code</span><span class="nv" style="font-size:14px; color:teal"> </span><span class="s" style="font-size:14px; color:rgb(221,17,68)">coverage:</span><span class="nv" style="font-size:14px; color:teal"> </span><span class="s" style="font-size:14px; color:rgb(221,17,68)">\d+\.\d+/'</span>
</code></pre> 
<h3 id="git-strategy" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:30px'> <span style="">Git策略 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#git-strategy" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h3> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style=""><span style="">作为实验功能在GitLab 8.9中引入。</span><span style="">在未来版本中可能会更改或完全删除。</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>GIT_STRATEGY=none</code><span style="">需要GitLab Runner v1.7 +。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">您可以</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>GIT_STRATEGY</code><span style="">在全局</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#variables" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(55,119,176); background-color:rgb(249,242,244)'>variables</code></a><span style="">部分或</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#job-variables" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(55,119,176); background-color:rgb(249,242,244)'>variables</code></a><span style=""><span style=""> 单个作业</span><span style="">的</span><span style="">部分中</span><span style="">设置</span><span style="">用于获取最近的应用程序代码</span><span style="">。</span><span style="">如果未指定，将使用项目设置的默认值。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">有三种可能的值：</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>clone</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>fetch</code><span style="">，和</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>none</code><span style="">。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>clone</code><span style=""><span style="">是最慢的选择。</span><span style="">它为每个作业从头开始克隆资源库，确保项目工作区始终是原始的。</span></span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">variables</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">GIT_STRATEGY</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">clone</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>fetch</code><span style="">更快，因为它重新使用项目工作区（</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>clone</code><span style=""><span style=""> 如果它不存在则</span><span style="">回退</span><span style="">）。</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>git clean</code><span style="">用于撤消上一个作业所做的更改，并</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>git fetch</code><span style="">用于检索自上次作业运行以来所做的提交。</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">variables</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">GIT_STRATEGY</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">fetch</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>none</code><span style=""><span style="">也重新使用项目工作区，但是跳过所有Git操作（包括GitLab Runner的pre-clone脚本（如果存在））。</span><span style="">它主要用于仅对工件（例如</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>deploy</code><span style=""><span style="">）</span><span style="">进行操作的作业</span><span style="">。</span><span style="">Git存储库数据可能存在，但它肯定是过期的，因此您只应该依赖从缓存或工件引入项目工作空间的文件。</span></span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">variables</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">GIT_STRATEGY</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">none</span>
</code></pre> 
<h3 id="git-submodule-strategy" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:30px'> <span style="">Git子模块策略 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#git-submodule-strategy" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h3> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">需要GitLab Runner v1.10 +。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">该</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>GIT_SUBMODULE_STRATEGY</code><span style=""><span style="">变量用于在构建之前获取代码时控制是否/如何包含Git子模块。</span><span style="">喜欢 </span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>GIT_STRATEGY</code><span style="">，可以在全局</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#variables" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(55,119,176); background-color:rgb(249,242,244)'>variables</code></a><span style=""> 部分或</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#job-variables" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(55,119,176); background-color:rgb(249,242,244)'>variables</code></a><span style=""><span style="">单个作业</span><span style="">的</span><span style="">部分中设置。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">有三种可能的值：</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>none</code><span style="">，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>normal</code><span style="">和</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>recursive</code><span style="">：</span></p> 
<ul style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"> <p style="margin-top:20px; margin-bottom:20px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>none</code><span style=""><span style="">意味着在获取项目代码时不会包含子模块。</span><span style="">这是默认值，它与v1.10之前的行为相匹配。</span></span></p> </li><li style="font-size:16px; line-height:22px"> <p style="margin-top:20px; margin-bottom:20px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>normal</code><span style=""><span style="">意味着只包括顶级子模块。</span><span style="">相当于：</span></span></p> <pre><code class="language-plain"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:2px 4px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'>git submodule sync<span style=""></span>
git submodule update --init<span style=""></span>
</code></code></pre> </li><li style="font-size:16px; line-height:22px"> <p style="margin-top:20px; margin-bottom:20px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>recursive</code><span style=""><span style="">意味着将包括所有子模块（包括子模块子模块）。</span><span style="">相当于：</span></span></p> <pre><code class="language-plain"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:2px 4px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'>git submodule sync --recursive<span style=""></span>
git submodule update --init --recursive<span style=""></span>
</code></code></pre> </li></ul> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">请注意，要使此功能正常工作，子模块必须</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.gitmodules</code><span style="">配置为：</span></p> 
<ul style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><span style="">可公开访问的存储库的HTTP（S）URL</span></li><li style="font-size:16px; line-height:22px"><span style=""><span style="">在同一个GitLab服务器上的另一个存储库的相对路径。</span><span style="">请参阅 </span></span><a target="_blank" href="https://docs.gitlab.com/ce/ci/git_submodules.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">Git子</a><span style="">模块文档。</span></li></ul> 
<h3 id="job-stages-attempts" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:30px'> <span style="">作业阶段尝试 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#job-stages-attempts" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h3> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">在GitLab中引入，它需要GitLab Runner v1.9 +。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">您可以设置运行作业将尝试执行以下每个阶段的尝试次数：</span></p> 
<table style='border-spacing:0px; border-collapse:collapse; background-color:transparent; width:820px; overflow-x:scroll; border:1px solid rgb(229,229,229); font-family:"Source Sans Pro",sans-serif; font-size:14px'><thead style=""><tr style=""><th style="padding:5px 10px; text-align:left; border:1px solid rgb(229,229,229)"> <span style="">变量</span></th><th style="padding:5px 10px; text-align:left; border:1px solid rgb(229,229,229)"> <span style="">描述</span></th></tr></thead><tbody style=""><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="font-weight:700">GET_SOURCES_ATTEMPTS</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">尝试获取运行作业的源的次数</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="font-weight:700">ARTIFACT_DOWNLOAD_ATTEMPTS</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">尝试下载运行作业的工件的次数</span></td></tr><tr style=""><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="font-weight:700">RESTORE_CACHE_ATTEMPTS</span></td><td style="padding:5px 10px; border:1px solid rgb(229,229,229)"><span style="">尝试恢复运行作业的缓存的次数</span></td></tr></tbody></table> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">默认是一次尝试。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">例：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">variables</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">GET_SOURCES_ATTEMPTS</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">3"</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">您可以在全局</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#variables" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(55,119,176); background-color:rgb(249,242,244)'>variables</code></a><span style="">部分或</span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#job-variables" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(55,119,176); background-color:rgb(249,242,244)'>variables</code></a><span style=""><span style="">单个作业</span><span style="">的 </span><span style="">部分中进行设置。</span></span></p> 
<h3 id="shallow-cloning" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:30px'> <span style="">浅克隆 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#shallow-cloning" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h3> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style=""><span style="">作为实验功能在GitLab 8.9中引入。</span><span style="">可能会在未来版本中更改或完全删除。</span></span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">您可以使用指定抓取和克隆的深度</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>GIT_DEPTH</code><span style=""><span style="">。</span><span style="">这允许浅层克隆存储库，这可以显着加速具有大量提交或旧的大型二进制文件的存储库的克隆。</span><span style="">该值传递给</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>git fetch</code><span style="">和</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>git clone</code><span style="">。</span></p> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="font-weight:700">注意：</span><span style=""> 如果深度为1，并且具有作业队列或重试作业，作业可能会失败。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">由于Git获取和克隆是基于一个引用（如分支名称），所以Runners不能克隆特定的提交SHA。</span><span style="">如果队列中有多个作业，或者您正在重试旧作业，则要测试的提交需要在克隆的Git历史记录中。</span><span style="">设置太小的值</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>GIT_DEPTH</code><span style=""><span style="">可能导致无法运行这些旧的提交。</span><span style="">您将</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>unresolved reference</code><span style=""><span style="">在作业日志中</span><span style="">看到</span><span style="">。</span><span style="">然后，您应该重新考虑更改</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>GIT_DEPTH</code><span style="">为更高的值。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">由于只有Git历史的一部分存在</span><span style="">，依赖的作业</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>git describe</code><span style="">可能无法正常工作</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>GIT_DEPTH</code><span style="">。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">仅获取或克隆最近3次提交：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="na" style="font-size:14px; color:teal">variables</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">GIT_DEPTH</span><span class="pi" style="font-size:14px">:</span> <span class="s2" style="font-size:14px; color:rgb(221,17,68)">"</span><span class="s" style="font-size:14px; color:rgb(221,17,68)">3"</span>
</code></pre> 
<h3 id="hidden-keys" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:30px'> <span style="">隐藏键 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#hidden-keys" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h3> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">在GitLab 8.6和GitLab Runner v1.1.1中引入。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">以点（</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.</code><span style=""><span style="">）</span><span style="">开头的键</span><span style="">不会被GitLab CI处理。</span><span style="">您可以使用此功能忽略作业，或使用 </span></span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#special-yaml-features" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">特殊的YAML功能</a><span style="">，并将隐藏的键转换为模板。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">在以下示例中，</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.key_name</code><span style="">将被忽略：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="s" style="font-size:14px; color:rgb(221,17,68)">.key_name</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">rake spec</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">隐藏的键可以像普通CI作业一样散列，但是您也可以使用不同类型的结构来利用特殊的YAML功能。</span></p> 
<h3 id="special-yaml-features" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:30px'> <span style="">特殊YAML功能 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#special-yaml-features" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h3> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">可以使用特殊的YAML功能，如anchor（</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>&amp;</code><span style="">），别名（</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>*</code><span style="">）和map merging（</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>&lt;&lt;</code><span style="">），这将大大降低复杂度</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.gitlab-ci.yml</code><span style="">。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">详细了解各种</span><a target="_blank" href="https://learnxinyminutes.com/docs/yaml/" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">YAML功能</a><span style="">。</span></p> 
<h4 id="anchors" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">锚点 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#anchors" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<blockquote style='padding:10px 20px; margin:20px 0px; font-size:17.5px; border-width:0px 0px 0px 5px; border-left-style:solid; border-left-color:rgb(0,188,242); background-color:rgb(239,246,251); font-family:"Source Sans Pro",sans-serif'> 
 <p style="margin:inherit; font-size:16px; line-height:22px"><span style="">在GitLab 8.6和GitLab Runner v1.1.1中引入。</span></p> 
</blockquote> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">YAML有一个方便的功能，称为“锚”，可以让您轻松地在文档中复制内容。</span><span style="">锚可用于复制/继承属性，并且是使用</span></span><a target="_blank" href="https://docs.gitlab.com/ce/ci/yaml/#hidden-keys" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">隐藏键</a><span style=""><span style=""> 来为您的作业提供模板</span><span style="">的完美示例</span><span style="">。</span></span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">以下示例使用锚点和地图合并。</span><span style="">它会创建两个就业机会， </span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>test1</code><span style="">并</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>test2</code><span style="">，将继承的参数</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.job_template</code><span style="">，每一个自己定制其</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>script</code><span style="">定义为：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="s" style="font-size:14px; color:rgb(221,17,68)">.job_template</span><span class="pi" style="font-size:14px">:</span> <span class="nl" style="font-size:14px">&amp;job_definition</span>  <span class="c1" style="font-size:14px; color:rgb(153,153,136); font-style:italic"># Hidden key that defines an anchor named 'job_definition'</span>
  <span class="na" style="font-size:14px; color:teal">image</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">ruby:2.1</span>
  <span class="na" style="font-size:14px; color:teal">services</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">postgres</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">redis</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">test1</span><span class="pi" style="font-size:14px">:</span>
  <span class="s" style="font-size:14px; color:rgb(221,17,68)">&lt;&lt;</span><span class="pi" style="font-size:14px">:</span> <span class="nv" style="font-size:14px; color:teal">*job_definition</span>           <span class="c1" style="font-size:14px; color:rgb(153,153,136); font-style:italic"># Merge the contents of the 'job_definition' alias</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test1 project</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">test2</span><span class="pi" style="font-size:14px">:</span>
  <span class="s" style="font-size:14px; color:rgb(221,17,68)">&lt;&lt;</span><span class="pi" style="font-size:14px">:</span> <span class="nv" style="font-size:14px; color:teal">*job_definition</span>           <span class="c1" style="font-size:14px; color:rgb(153,153,136); font-style:italic"># Merge the contents of the 'job_definition' alias</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test2 project</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>&amp;</code><span style="">设置anchor（</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>job_definition</code><span style=""><span style="">）</span><span style="">的名称</span><span style="">，</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>&lt;&lt;</code><span style="">表示“将给定的哈希合并到当前的哈希”，并</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>*</code><span style="">包括命名的锚（</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>job_definition</code><span style=""><span style="">再次）。</span><span style="">扩展版本如下所示：</span></span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="s" style="font-size:14px; color:rgb(221,17,68)">.job_template</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">image</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">ruby:2.1</span>
  <span class="na" style="font-size:14px; color:teal">services</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">postgres</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">redis</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">test1</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">image</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">ruby:2.1</span>
  <span class="na" style="font-size:14px; color:teal">services</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">postgres</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">redis</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test1 project</span><span style=""></span>
<span style=""></span>
<span class="na" style="font-size:14px; color:teal">test2</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">image</span><span class="pi" style="font-size:14px">:</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">ruby:2.1</span>
  <span class="na" style="font-size:14px; color:teal">services</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">postgres</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">redis</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test2 project</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">我们来看另一个例子。</span><span style="">这一次我们将使用anchor来定义两组服务。</span><span style="">这将创建两个作业，</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>test:postgres</code><span style="">并且</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>test:mysql</code><span style="">，将共享</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>script</code><span style="">中定义的指令</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.job_template</code><span style="">，并</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>services</code><span style=""> 指令定义</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.postgres_services</code><span style="">和</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.mysql_services</code><span style="">分别为：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="s" style="font-size:14px; color:rgb(221,17,68)">.job_template</span><span class="pi" style="font-size:14px">:</span> <span class="nl" style="font-size:14px">&amp;job_definition</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test project</span><span style=""></span>
<span style=""></span>
<span class="s" style="font-size:14px; color:rgb(221,17,68)">.postgres_services</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">services</span><span class="pi" style="font-size:14px">:</span> <span class="nl" style="font-size:14px">&amp;postgres_definition</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">postgres</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">ruby</span><span style=""></span>
<span style=""></span>
<span class="s" style="font-size:14px; color:rgb(221,17,68)">.mysql_services</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">services</span><span class="pi" style="font-size:14px">:</span> <span class="nl" style="font-size:14px">&amp;mysql_definition</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">mysql</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">ruby</span><span style=""></span>
<span style=""></span>
<span class="s" style="font-size:14px; color:rgb(221,17,68)">test:postgres</span><span class="pi" style="font-size:14px">:</span>
  <span class="s" style="font-size:14px; color:rgb(221,17,68)">&lt;&lt;</span><span class="pi" style="font-size:14px">:</span> <span class="nv" style="font-size:14px; color:teal">*job_definition</span>
  <span class="na" style="font-size:14px; color:teal">services</span><span class="pi" style="font-size:14px">:</span> <span class="nv" style="font-size:14px; color:teal">*postgres_definition</span><span style=""></span>
<span style=""></span>
<span class="s" style="font-size:14px; color:rgb(221,17,68)">test:mysql</span><span class="pi" style="font-size:14px">:</span>
  <span class="s" style="font-size:14px; color:rgb(221,17,68)">&lt;&lt;</span><span class="pi" style="font-size:14px">:</span> <span class="nv" style="font-size:14px; color:teal">*job_definition</span>
  <span class="na" style="font-size:14px; color:teal">services</span><span class="pi" style="font-size:14px">:</span> <span class="nv" style="font-size:14px; color:teal">*mysql_definition</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">扩展版本如下所示：</span></p> 
<pre class="highlight yaml" style='overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:10px 15px; margin-top:20px; margin-bottom:20px; line-height:1.42857; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word'><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'><span class="s" style="font-size:14px; color:rgb(221,17,68)">.job_template</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test project</span><span style=""></span>
<span style=""></span>
<span class="s" style="font-size:14px; color:rgb(221,17,68)">.postgres_services</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">services</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">postgres</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">ruby</span><span style=""></span>
<span style=""></span>
<span class="s" style="font-size:14px; color:rgb(221,17,68)">.mysql_services</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">services</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">mysql</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">ruby</span><span style=""></span>
<span style=""></span>
<span class="s" style="font-size:14px; color:rgb(221,17,68)">test:postgres</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test project</span>
  <span class="na" style="font-size:14px; color:teal">services</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">postgres</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">ruby</span><span style=""></span>
<span style=""></span>
<span class="s" style="font-size:14px; color:rgb(221,17,68)">test:mysql</span><span class="pi" style="font-size:14px">:</span>
  <span class="na" style="font-size:14px; color:teal">script</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">test project</span>
  <span class="na" style="font-size:14px; color:teal">services</span><span class="pi" style="font-size:14px">:</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">mysql</span>
    <span class="pi" style="font-size:14px">-</span> <span class="s" style="font-size:14px; color:rgb(221,17,68)">ruby</span>
</code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">您可以看到隐藏的键被方便地用作模板。</span></p> 
<h3 id="triggers" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:30px'> <span style="">触发器 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#triggers" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h3> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">触发器可用于强制使用API​​调用重建特定分支，标记或提交。</span></p> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <a target="_blank" href="https://docs.gitlab.com/ce/ci/triggers/README.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">在触发器文档中阅读更多内容。</a></p> 
<h4 id="pages" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:24px'> <span style="">页面 </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#pages" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h4> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>pages</code><span style=""><span style="">是一个特殊的工作，用于将静态内容上传到GitLab，可用于为您的网站提供服务。</span><span style="">它具有特殊的语法，因此必须满足以下两个要求：</span></span></p> 
<ol style='margin:20px 0px; font-family:"Source Sans Pro",sans-serif; font-size:14px'><li style="font-size:16px; line-height:22px"><span style="">任何静态内容必须放在</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>public/</code><span style="">目录下</span></li><li style="font-size:16px; line-height:22px"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>artifacts</code><span style=""></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>public/</code><span style=""><span style="">必须定义</span><span style="">到</span><span style="">目录</span><span style="">的路径</span></span></li></ol> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">下面的示例将所有文件从项目的根移动到 </span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>public/</code><span style=""><span style="">目录。</span><span style="">该</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>.public</code><span style="">解决方法是这样</span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>cp</code><span style="">不也复制 </span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>public/</code><span style="">到自身无限循环：</span></p> 
<pre><code class="language-plain"><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:undefined; padding:0px; color:inherit; background-color:transparent; white-space:pre-wrap; border-color:transparent'>pages:<span style=""></span>
  stage: deploy<span style=""></span>
  script:<span style=""></span>
  - mkdir .public<span style=""></span>
  - cp -r * .public<span style=""></span>
  - mv .public public<span style=""></span>
  artifacts:<span style=""></span>
    paths:<span style=""></span>
    - public<span style=""></span>
  only:<span style=""></span>
  - master<span style=""></span>
</code></code></pre> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style="">阅读更多关于</span><a target="_blank" href="https://docs.gitlab.com/ce/user/project/pages/index.html" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(48,132,187)">GitLab Pages用户文档</a><span style="">。</span></p> 
<h3 id="validate-the-gitlab-ci-yml" style='font-family:"Source Sans Pro",sans-serif; font-weight:500; line-height:1.1; margin-top:20px; margin-bottom:10px; font-size:30px'> <span style="">验证.gitlab-ci.yml </span><a target="_blank" class="anchor" href="https://docs.gitlab.com/ce/ci/yaml/#validate-the-gitlab-ci-yml" rel="nofollow noopener noreferrer" title="固定链接" style="color:rgb(48,132,187); display:inline-block; width:1em; height:1em; max-height:25px; vertical-align:middle"></a></h3> 
<p style='margin-top:20px; margin-bottom:20px; font-size:16px; line-height:22px; font-family:"Source Sans Pro",sans-serif'> <span style=""><span style="">GitLab CI的每个实例都有一个名为Lint的嵌入式调试工具。</span><span style="">您可以在</span></span><code style='font-family:Menlo,"Liberation Mono",Consolas,"DejaVu Sans Mono","Ubuntu Mono","Courier New","Andale Mono","Lucida Console",monospace; font-size:14px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>/ci/lint</code><span style=""><span style="">gitlab实例</span><span style="">下找到链接</span><span style="">。</span></span></p> 
<div> 
 <span style=""><span style=""><br> </span></span> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/09d19577a7a019d415292640823c85e1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">文件系统层次结构标准(FHS)(for Linux)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c471bbc412c8a1dffa27c8497bd751fa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Retrofit2使用详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>