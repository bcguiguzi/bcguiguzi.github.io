<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Gatewaywork &#43; laravel5.5 &#43; Layim实现聊天系统 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Gatewaywork &#43; laravel5.5 &#43; Layim实现聊天系统" />
<meta property="og:description" content="概述 基于workerman的GatewayWorker框架开发的一款高性能支持分布式部署的聊天接口。
基于laravel的TLS版本5.5实现http请求
基于layim实现前端数据渲染
GatewayWorker框架文档：http://www.workerman.net/gatewaydoc/
laravel5.5框架文档：https://laravelacademy.org/laravel-docs-5_5
Layim框架文档：https://www.layui.com/doc/modules/layim.html
演示地址：http://love.1314zyh.cn
github地址：https://github.com/cuigeg/workman
测试账号：
账号：admin01 密码：123456
账号：admin02 密码：123456
账号：admin03 密码：123456
账号：admin04 密码：123456
账号：admin05 密码：123456
账号：admin06 密码：123456
账号：admin07 密码：123456
账号：admin08 密码：123456
版本支持 PHP &gt;=7.1
GatewayWorker 3.0.12
layui 2.4.5
功能列表 功能描述登录用户登陆注册注册过程中为用户分配了一个默认分组，并将用户添加到所有人都在的一个群（用于日后推送公告信息）查找-好友可以根据用户名、昵称、id来查找，不输入内容不允许查找数据，点击发起好友申请，每页6人查找-群聊可根据群昵称、群id查找群聊，点击加入，每页6人创建群聊创建一个新群聊修改群聊名称修改指定群聊名称解散群聊解散指定群聊分组面板内快速查找查找已加的好友（好友列）、群聊（群聊列）消息盒子用来接受好友请求和同意或拒绝好友请求的系统消息个性签名如果客服系统可显示客户访问商品ID和商品，如果聊天可以显示发表心情一对一聊天可发送文字、表情、图片、文件、音乐链接、视频链接、代码等群聊新成员加入群聊时，如果此刻你正开启着该群对话框，将收到新人入群通知查看群成员查看群聊中所有成员临时会话在群成员中，点击群成员头像即可发起临时会话历史记录聊天面板只显示20条记录，更多记录点击聊天记录查看离线消息对方不在线的时候，向对方发起好友请求或者消息，将在对方上线后第一时间推送换肤这个是layim自带的东西删除好友好友列表右击删除好友查看聊天记录好友列表右击查看聊天记录或者打开聊天窗口点击聊天记录删除好友分组右击好友分组可将好友分组删除新增好友分组右击好友分组可新增好友分组重命名好友分组右击好友分组可重命名改分组 安装 下载项目 git clone https://github.com/cuigeg/workman.git 2.运行sql文件
项目根目录im.sql文件为本项目所需数据库字段与数据 3.项目根目录复制.env文件
cp .env.example .env 4.composer安装依赖
composer insatll 5.生成独立的Key
php artisan key:generate 6.配置数据库
6.1 .env文件
DB_CONNECTION=mysql DB_HOST=127.0.0.1 DB_PORT=3306 DB_DATABASE=im DB_USERNAME=homestead DB_PASSWORD=secret DB_PREFIX=im_ 6.2 /Applications/YourApp/Config/Db.php
&lt;?php namespace Config; /** * mysql配置 * @author walkor */ class Db { /** * 数据库配置 */ public static $homestead = array( &#39;host&#39; =&gt; &#39;192." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/f562374c6059e183458c89fbc674ad50/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-06-14T17:21:01+08:00" />
<meta property="article:modified_time" content="2019-06-14T17:21:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Gatewaywork &#43; laravel5.5 &#43; Layim实现聊天系统</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_1"></a>概述</h3> 
<p>基于workerman的GatewayWorker框架开发的一款高性能支持分布式部署的聊天接口。<br> 基于laravel的TLS版本5.5实现http请求<br> 基于layim实现前端数据渲染</p> 
<p>GatewayWorker框架文档：<a href="http://www.workerman.net/gatewaydoc/%5D" rel="nofollow">http://www.workerman.net/gatewaydoc/</a><br> laravel5.5框架文档：<a href="https://laravelacademy.org/laravel-docs-5_5%5D" rel="nofollow">https://laravelacademy.org/laravel-docs-5_5</a><br> Layim框架文档：<a href="https://www.layui.com/doc/modules/layim.html" rel="nofollow">https://www.layui.com/doc/modules/layim.html</a></p> 
<p>演示地址：<a href="http://love.1314zyh.cn/" rel="nofollow">http://love.1314zyh.cn</a><br> github地址：<a href="https://github.com/cuigeg/workman">https://github.com/cuigeg/workman</a></p> 
<p>测试账号：<br> 账号：admin01 密码：123456<br> 账号：admin02 密码：123456<br> 账号：admin03 密码：123456<br> 账号：admin04 密码：123456<br> 账号：admin05 密码：123456<br> 账号：admin06 密码：123456<br> 账号：admin07 密码：123456<br> 账号：admin08 密码：123456</p> 
<h3><a id="_22"></a>版本支持</h3> 
<blockquote> 
 <p>PHP &gt;=7.1<br> GatewayWorker 3.0.12<br> layui 2.4.5</p> 
</blockquote> 
<h3><a id="_28"></a>功能列表</h3> 
<table><thead><tr><th>功能</th><th>描述</th></tr></thead><tbody><tr><td>登录</td><td>用户登陆</td></tr><tr><td>注册</td><td>注册过程中为用户分配了一个默认分组，并将用户添加到所有人都在的一个群（用于日后推送公告信息）</td></tr><tr><td>查找-好友</td><td>可以根据用户名、昵称、id来查找，不输入内容不允许查找数据，点击发起好友申请，每页6人</td></tr><tr><td>查找-群聊</td><td>可根据群昵称、群id查找群聊，点击加入，每页6人</td></tr><tr><td>创建群聊</td><td>创建一个新群聊</td></tr><tr><td>修改群聊名称</td><td>修改指定群聊名称</td></tr><tr><td>解散群聊</td><td>解散指定群聊分组</td></tr><tr><td>面板内快速查找</td><td>查找已加的好友（好友列）、群聊（群聊列）</td></tr><tr><td>消息盒子</td><td>用来接受好友请求和同意或拒绝好友请求的系统消息</td></tr><tr><td>个性签名</td><td>如果客服系统可显示客户访问商品ID和商品，如果聊天可以显示发表心情</td></tr><tr><td>一对一聊天</td><td>可发送文字、表情、图片、文件、音乐链接、视频链接、代码等</td></tr><tr><td>群聊</td><td>新成员加入群聊时，如果此刻你正开启着该群对话框，将收到新人入群通知</td></tr><tr><td>查看群成员</td><td>查看群聊中所有成员</td></tr><tr><td>临时会话</td><td>在群成员中，点击群成员头像即可发起临时会话</td></tr><tr><td>历史记录</td><td>聊天面板只显示20条记录，更多记录点击聊天记录查看</td></tr><tr><td>离线消息</td><td>对方不在线的时候，向对方发起好友请求或者消息，将在对方上线后第一时间推送</td></tr><tr><td>换肤</td><td>这个是layim自带的东西</td></tr><tr><td>删除好友</td><td>好友列表右击删除好友</td></tr><tr><td>查看聊天记录</td><td>好友列表右击查看聊天记录或者打开聊天窗口点击聊天记录</td></tr><tr><td>删除好友分组</td><td>右击好友分组可将好友分组删除</td></tr><tr><td>新增好友分组</td><td>右击好友分组可新增好友分组</td></tr><tr><td>重命名好友分组</td><td>右击好友分组可重命名改分组</td></tr></tbody></table> 
<h3><a id="_54"></a>安装</h3> 
<ol><li>下载项目</li></ol> 
<pre><code>git clone https://github.com/cuigeg/workman.git
</code></pre> 
<p>2.运行sql文件</p> 
<pre><code>项目根目录im.sql文件为本项目所需数据库字段与数据
</code></pre> 
<p>3.项目根目录复制.env文件</p> 
<pre><code>cp .env.example .env
</code></pre> 
<p>4.composer安装依赖</p> 
<pre><code>composer insatll
</code></pre> 
<p>5.生成独立的Key</p> 
<pre><code>php artisan key:generate
</code></pre> 
<p>6.配置数据库<br><br> 6.1 .env文件</p> 
<pre><code>DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=im
DB_USERNAME=homestead
DB_PASSWORD=secret
DB_PREFIX=im_
</code></pre> 
<p>6.2 /Applications/YourApp/Config/Db.php</p> 
<pre><code>&lt;?php
namespace Config;
/**
 * mysql配置
 * @author walkor
 */
class Db
{
    /**
     * 数据库配置
     */
    public static $homestead = array(
        'host' =&gt; '192.168.10.10',
        'port' =&gt; '3306',
        'dbname' =&gt; 'im',
        'user' =&gt; 'homestead',
        'password' =&gt; 'secret',
        'charset'  =&gt; 'utf8',
    );
}
</code></pre> 
<p>7.项目根目录运行Gateway(-d 守护进程开启服务)</p> 
<pre><code>php start.php start -d
</code></pre> 
<p>8.更改前端webscoket访问地址（/resources/views/index.blade.php）78行</p> 
<pre><code>    socket = new WebSocket('ws://192.168.10.10:8282');
</code></pre> 
<p>9.访问laravel项目，查看是否运行正常</p> 
<h3><a id="Layim_119"></a>更改源码Layim</h3> 
<p>1.好友列表右击事件（删除好友，聊天记录）<br> 2.好友分组右击事件（重命名分组，删除分组，新增分组）<br> 3.群聊右击事件（创建群聊，修改群聊名称，删除群聊）</p> 
<pre><code>//好友列表右击事件（好友分组雷同）
x.find(".layim-list-friend  .layui-layim-list").on("contextmenu", "li",
    function(a) {
        var n = e(this),
        l = '&lt;ul data-id="' + n.attr('class').split(' ').shift() + '" data-index="' + n.data("index") + '" data-name="'+ n.find('span')[0].innerText +'"  data-type="'+ n.data('type') +'"&gt;&lt;li layim-event="menuList" data-type="one"&gt;删除好友&lt;/li&gt;&lt;li layim-event="chatLog1" data-type="all"&gt;聊天记录&lt;/li&gt;&lt;/ul&gt;';
        n.hasClass("layim-null") || (t.tips(l, this, {
            tips: 1,
            time: 0,
            anim: 5,
            fixed: !0,
            skin: "layui-box layui-layim-contextmenu",
            success: function(i) {
                var a = function(i) {
                    ii(i)
                };
                i.off("mousedown", a).on("mousedown", a);
                let top = n.offset().top;
                let left = n.offset().left;
                top -=  i[0].offsetHeight;
                i.css({'left':left + 'px','top':top + 'px'});
            }
        }), e(document).off("mousedown", i).on("mousedown", i), e(window).off("resize", i).on("resize", i))
        //防止冒泡事件
        return false;
    })
    
    //删除好友
    menuList:function(){
        ...
    }
    
    //查看聊天记录
    chatLog1:function(){
        ...
    }
</code></pre> 
<h3><a id="_160"></a>页面展示</h3> 
<p>1.好友聊天<br><br> <img src="https://images2.imgbox.com/8a/63/gMvkdghO_o.png" alt="在这里插入图片描述"><br> 2.群聊<br><br> <img src="https://images2.imgbox.com/a3/77/3TdZaRQl_o.png" alt="在这里插入图片描述"><br> 3.查找好友<br><br> <img src="https://images2.imgbox.com/8f/5e/Pdq9dM0z_o.png" alt="在这里插入图片描述"><br> 4.查找群聊<br><br> <img src="https://images2.imgbox.com/3c/fc/d9Wky5mK_o.png" alt="在这里插入图片描述"><br> 5.消息盒子<br><br> <img src="https://images2.imgbox.com/74/e9/kDk1BbDF_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_171"></a>声明</h3> 
<ol><li>前端部分是采用layui,在此郑重说明，layui中的im部分layim并不开源，仅供交流学习，请勿将此项目中的layim用作商业用途</li><li>此项目持续开发中，欢迎有兴趣的朋友共同维护</li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/08c9b4905af47f2ccbe5475f9d0ffba1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">__import__详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9f9b0e15dc90b79304b1f07c1166e100/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">lead to 和 result in区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>