<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【OpenCV实战】车牌识别（OCR）中字符分割的两种方法Python实现（总结） - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【OpenCV实战】车牌识别（OCR）中字符分割的两种方法Python实现（总结）" />
<meta property="og:description" content="【OpenCV实战】车牌识别（OCR）中字符分割的两种方法Python实现 总的来说1、基于连通域（边缘特征）的字符分割2、基于像素直方图的字符分割2.1代码一：2.2代码二： 车牌识别是一个经典项目了，车牌的字符分割是很重要的一部分，字符分割的思想在其他项目中同样有很重要的作用。有必要针对字符分割的思路和实现过程做一个记录。
本篇博客的对象是
目的是实现车牌的字符分割。
总的来说 车牌识别的字符分割可以有两种思路：
（1）基于连通域（边缘特征）的字符分割：通过形态学处理是的各个字符成为一个整体（主要针对汉字），通过边缘检测获取每一个字符的轮廓，即可实现字符分割。
（2）基于像素直方图的字符分割：对图片进行二值化处理，统计水平方向和竖直方向上各行各列的黑色像素的个数，根据像素的特点确定分割位置，完成字符分割。
1、基于连通域（边缘特征）的字符分割 思路比较简单，根据轮廓特征分割。话不多说，直接上代码
import cv2 from matplotlib import pyplot as plt img_ = cv2.imread(&#39;Resources/test1.png&#39;) # 读取图片 img_gray = cv2.cvtColor(img_, cv2.COLOR_BGR2GRAY) # 转换了灰度化 # 形态学操作 kernel = cv2.getStructuringElement(cv2.MORPH_RECT, (2, 2)) image = cv2.dilate(image, kernel) # 查找轮廓 contours, hierarchy = cv2.findContours(image, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE) words = [] word_images = [] for item in contours: word = [] rect = cv2.boundingRect(item) x = rect[0] y = rect[1] weight = rect[2] height = rect[3] word." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/d76b0e0193c587ea75edafea1204a4d0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-26T19:28:52+08:00" />
<meta property="article:modified_time" content="2020-05-26T19:28:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【OpenCV实战】车牌识别（OCR）中字符分割的两种方法Python实现（总结）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>【OpenCV实战】车牌识别（OCR）中字符分割的两种方法Python实现</h4> 
 <ul><li><a href="#_6" rel="nofollow">总的来说</a></li><li><a href="#1_10" rel="nofollow">1、基于连通域（边缘特征）的字符分割</a></li><li><a href="#2_56" rel="nofollow">2、基于像素直方图的字符分割</a></li><li><ul><li><a href="#21_63" rel="nofollow">2.1代码一：</a></li><li><a href="#22_173" rel="nofollow">2.2代码二：</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p>车牌识别是一个经典项目了，车牌的字符分割是很重要的一部分，字符分割的思想在其他项目中同样有很重要的作用。有必要针对字符分割的思路和实现过程做一个记录。<br> 本篇博客的对象是<br> <img src="https://images2.imgbox.com/61/8e/3ze18l0u_o.png" alt="在这里插入图片描述"><br> <strong>目的是实现车牌的字符分割</strong>。</p> 
<h2><a id="_6"></a>总的来说</h2> 
<p>车牌识别的字符分割可以有两种思路：<br> （<strong>1</strong>）<strong>基于连通域（边缘特征）的字符分割</strong>：通过形态学处理是的各个字符成为一个整体（主要针对汉字），通过边缘检测获取每一个字符的轮廓，即可实现字符分割。<br> （<strong>2</strong>）<strong>基于像素直方图的字符分割</strong>：对图片进行二值化处理，统计水平方向和竖直方向上各行各列的黑色像素的个数，根据像素的特点确定分割位置，完成字符分割。</p> 
<h2><a id="1_10"></a>1、基于连通域（边缘特征）的字符分割</h2> 
<p>思路比较简单，根据轮廓特征分割。话不多说，直接上代码</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt

img_ <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'Resources/test1.png'</span><span class="token punctuation">)</span>  <span class="token comment"># 读取图片</span>
img_gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img_<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>  <span class="token comment"># 转换了灰度化</span>
<span class="token comment"># 形态学操作</span>
kernel <span class="token operator">=</span> cv2<span class="token punctuation">.</span>getStructuringElement<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>MORPH_RECT<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>dilate<span class="token punctuation">(</span>image<span class="token punctuation">,</span> kernel<span class="token punctuation">)</span>
<span class="token comment"># 查找轮廓</span>
contours<span class="token punctuation">,</span> hierarchy <span class="token operator">=</span> cv2<span class="token punctuation">.</span>findContours<span class="token punctuation">(</span>image<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>RETR_EXTERNAL<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>CHAIN_APPROX_SIMPLE<span class="token punctuation">)</span>
words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
word_images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> item <span class="token keyword">in</span> contours<span class="token punctuation">:</span>
    word <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    rect <span class="token operator">=</span> cv2<span class="token punctuation">.</span>boundingRect<span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    x <span class="token operator">=</span> rect<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    y <span class="token operator">=</span> rect<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    weight <span class="token operator">=</span> rect<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    height <span class="token operator">=</span> rect<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
    word<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    word<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
    word<span class="token punctuation">.</span>append<span class="token punctuation">(</span>weight<span class="token punctuation">)</span>
    word<span class="token punctuation">.</span>append<span class="token punctuation">(</span>height<span class="token punctuation">)</span>
    words<span class="token punctuation">.</span>append<span class="token punctuation">(</span>word<span class="token punctuation">)</span>
words <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span>key<span class="token operator">=</span><span class="token keyword">lambda</span> s<span class="token punctuation">:</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>reverse<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> word <span class="token keyword">in</span> words<span class="token punctuation">:</span>
    <span class="token comment"># 根据轮廓的外接矩形筛选轮廓</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>word<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token punctuation">(</span>word<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span>word<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>word<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span>word<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        i <span class="token operator">=</span> i<span class="token operator">+</span><span class="token number">1</span>
        splite_image <span class="token operator">=</span> image_<span class="token punctuation">[</span>word<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>word<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> word<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> word<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>word<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> word<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
        splite_image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>splite_image<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        word_images<span class="token punctuation">.</span>append<span class="token punctuation">(</span>splite_image<span class="token punctuation">)</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span>j <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>word_images<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>word_images<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码效果：<br> <img src="https://images2.imgbox.com/73/2e/C4nPZWZw_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="2_56"></a>2、基于像素直方图的字符分割</h2> 
<p><strong>思路</strong>：<br> （1）对图像进行二值化操作，得到效果图如图<br> <img src="https://images2.imgbox.com/55/91/mpnXE50K_o.png" alt="在这里插入图片描述"><br> （2）水平方向：统计每一行黑色像素数量n，并记录。可以根据每一行黑色像素的数目来确定分割的起始和终止；由图可知，当 n减小到一定阈值时，为字符的边缘；<br> （3）竖直方向：同理，统计每一列的黑色像素数量v，并记录。可以可以根据每一列黑色像素的数目的变化来确定分割的起始和终止。<br> <strong>这里提供两套代码，可以根据自己的选择使用，思路是一致的</strong>。</p> 
<h3><a id="21_63"></a>2.1代码一：</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

img_ <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'Resources/test1.png'</span><span class="token punctuation">)</span>  <span class="token comment"># 读取图片</span>
img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img_<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>  <span class="token comment"># 转换了灰度化</span>

<span class="token comment"># 图像阈值化操作——获得二值化图</span>
ret<span class="token punctuation">,</span> img_thre <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>THRESH_BINARY_INV<span class="token punctuation">)</span>
kernel <span class="token operator">=</span> cv2<span class="token punctuation">.</span>getStructuringElement<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>MORPH_RECT<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 形态学处理:定义矩形结构</span>
closed <span class="token operator">=</span> cv2<span class="token punctuation">.</span>dilate<span class="token punctuation">(</span>img_thre<span class="token punctuation">,</span> kernel<span class="token punctuation">,</span> iterations<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 闭运算：迭代5次</span>

height<span class="token punctuation">,</span> width <span class="token operator">=</span> closed<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token comment"># 储存每一列的黑色像素数</span>
v <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> width
<span class="token comment"># 储存每一行的黑色像素数</span>
z <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> height
hfg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">]</span>
lfg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">]</span>
box <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token comment">######水平投影  #统计每一行的黑点数，行分割#######</span>
a <span class="token operator">=</span> <span class="token number">0</span>
emptyImage1 <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>height<span class="token punctuation">,</span> width<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
<span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> closed<span class="token punctuation">[</span>y<span class="token punctuation">,</span> x<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            a <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
    z<span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> a
    a <span class="token operator">=</span> <span class="token number">0</span>

<span class="token comment"># 绘制水平投影图</span>
l <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span>
<span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> z<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>
        emptyImage1<span class="token punctuation">[</span>y<span class="token punctuation">,</span> x<span class="token punctuation">]</span> <span class="token operator">=</span> b

<span class="token comment">#根据水平投影值选定行分割点</span>
inline <span class="token operator">=</span> <span class="token number">1</span>
start <span class="token operator">=</span> <span class="token number">0</span>
j <span class="token operator">=</span> <span class="token number">0</span>
<span class="token comment"># print(height,width)</span>
<span class="token comment"># print(z)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>height<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># inline 为起始位置标识，0.95 * width可自行调节，为判断字符位置的条件</span>
    <span class="token keyword">if</span> inline <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">and</span> z<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0.95</span> <span class="token operator">*</span> width<span class="token punctuation">:</span>  <span class="token comment">#从空白区进入文字区</span>
        start <span class="token operator">=</span> i  <span class="token comment">#记录起始行分割点</span>
        <span class="token comment">#print i</span>
        inline <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token comment"># i - start &gt; 3字符分割长度不小于3，inline为分割终止位置标识，0.95 * width可自行调节，为判断字符位置的条件</span>
    <span class="token keyword">elif</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">and</span> z<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token number">0.95</span> <span class="token operator">*</span> width <span class="token operator">and</span> inline <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">:</span>  <span class="token comment">#从文字区进入空白区</span>
        inline <span class="token operator">=</span> <span class="token number">1</span>
        hfg<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> start <span class="token operator">-</span> <span class="token number">2</span>  <span class="token comment">#保存行分割位置</span>
        hfg<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">2</span>
        j <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span>
<span class="token comment">####################### 至此完成行的分割 #################</span>

<span class="token comment">#####对每一行垂直投影、分割#####</span>
a <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> p <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 垂直投影  #统计每一列的黑点数</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>hfg<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> hfg<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            cp1 <span class="token operator">=</span> closed<span class="token punctuation">[</span>y<span class="token punctuation">,</span>x<span class="token punctuation">]</span>
            <span class="token keyword">if</span> cp1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                a <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token keyword">else</span> <span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
        v<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> a  <span class="token comment">#保存每一列像素值</span>
        a <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token comment"># 创建空白图片，绘制垂直投影图</span>
    l <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    emptyImage <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>height<span class="token punctuation">,</span> width<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>
            emptyImage<span class="token punctuation">[</span>y<span class="token punctuation">,</span> x<span class="token punctuation">]</span> <span class="token operator">=</span> b
    <span class="token comment">#垂直分割点</span>
    incol <span class="token operator">=</span> <span class="token number">1</span>
    start1 <span class="token operator">=</span> <span class="token number">0</span>
    j1 <span class="token operator">=</span> <span class="token number">0</span>
    z1 <span class="token operator">=</span> hfg<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    z2 <span class="token operator">=</span> hfg<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    word <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>width<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> incol <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">and</span> v<span class="token punctuation">[</span>i1<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">34</span> <span class="token punctuation">:</span>  <span class="token comment">#从空白区进入文字区</span>
            start1 <span class="token operator">=</span> i1  <span class="token comment">#记录起始列分割点</span>
            incol <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">elif</span> <span class="token punctuation">(</span>i1 <span class="token operator">-</span> start1 <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">and</span> v<span class="token punctuation">[</span>i1<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">34</span> <span class="token operator">and</span> incol <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">:</span>  <span class="token comment">#从文字区进入空白区</span>
            incol <span class="token operator">=</span> <span class="token number">1</span>
            lfg<span class="token punctuation">[</span>j1<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> start1 <span class="token operator">-</span> <span class="token number">2</span>   <span class="token comment">#保存列分割位置</span>
            lfg<span class="token punctuation">[</span>j1<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> i1 <span class="token operator">+</span> <span class="token number">2</span>
            l1 <span class="token operator">=</span> start1 <span class="token operator">-</span> <span class="token number">2</span>
            l2 <span class="token operator">=</span> i1 <span class="token operator">+</span> <span class="token number">2</span>
            j1 <span class="token operator">=</span> j1 <span class="token operator">+</span> <span class="token number">1</span>
            cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>img_<span class="token punctuation">,</span> <span class="token punctuation">(</span>l1<span class="token punctuation">,</span> z1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>l2<span class="token punctuation">,</span> z2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'original_img'</span><span class="token punctuation">,</span> img_<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'erode'</span><span class="token punctuation">,</span> closed<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'chuizhi'</span><span class="token punctuation">,</span> emptyImage<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'shuipin'</span><span class="token punctuation">,</span> emptyImage1<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码效果：<br> <img src="https://images2.imgbox.com/34/e0/X7Mwoz7p_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="22_173"></a>2.2代码二：</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
<span class="token comment">## 根据每行和每列的黑色和白色像素数进行图片分割。</span>

<span class="token comment"># 1、读取图像，并把图像转换为灰度图像并显示</span>
img_ <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'Resources/test1.png'</span><span class="token punctuation">)</span>  <span class="token comment"># 读取图片</span>
img_gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img_<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>  <span class="token comment"># 转换了灰度化</span>
<span class="token comment"># cv2.imshow('gray', img_gray)  # 显示图片</span>
<span class="token comment"># cv2.waitKey(0)</span>

<span class="token comment"># 2、将灰度图像二值化，设定阈值是100</span>
ret<span class="token punctuation">,</span> img_thre <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>img_gray<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>THRESH_BINARY_INV<span class="token punctuation">)</span>

<span class="token comment"># 4、分割字符</span>
white <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># 记录每一列的白色像素总和</span>
black <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># ..........黑色.......</span>
height <span class="token operator">=</span> img_thre<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
width <span class="token operator">=</span> img_thre<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
white_max <span class="token operator">=</span> <span class="token number">0</span>
black_max <span class="token operator">=</span> <span class="token number">0</span>
<span class="token comment"># 计算每一列的黑白色像素总和</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">:</span>
    s <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># 这一列白色总数</span>
    t <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># 这一列黑色总数</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> img_thre<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">:</span>
            s <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">if</span> img_thre<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            t <span class="token operator">+=</span> <span class="token number">1</span>
    white_max <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>white_max<span class="token punctuation">,</span> s<span class="token punctuation">)</span>
    black_max <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>black_max<span class="token punctuation">,</span> t<span class="token punctuation">)</span>
    white<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
    black<span class="token punctuation">.</span>append<span class="token punctuation">(</span>t<span class="token punctuation">)</span>
    <span class="token comment"># print(s)</span>
    <span class="token comment"># print(t)</span>

arg <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># False表示白底黑字；True表示黑底白字</span>
<span class="token keyword">if</span> black_max <span class="token operator">&gt;</span> white_max<span class="token punctuation">:</span>
    arg <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token comment"># 分割图像</span>
<span class="token keyword">def</span> <span class="token function">find_end</span><span class="token punctuation">(</span>start_<span class="token punctuation">)</span><span class="token punctuation">:</span>
    end_ <span class="token operator">=</span> start_ <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">for</span> m <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>start_ <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>black<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token keyword">if</span> arg <span class="token keyword">else</span> white<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token number">0.95</span> <span class="token operator">*</span> black_max <span class="token keyword">if</span> arg <span class="token keyword">else</span> <span class="token number">0.95</span> <span class="token operator">*</span> white_max<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 0.95这个参数请多调整，对应下面的0.05（针对像素分布调节）</span>
            end_ <span class="token operator">=</span> m
            <span class="token keyword">break</span>
    <span class="token keyword">return</span> end_

n <span class="token operator">=</span> <span class="token number">1</span>
start <span class="token operator">=</span> <span class="token number">1</span>
end <span class="token operator">=</span> <span class="token number">2</span>
word <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">while</span> n <span class="token operator">&lt;</span> width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">:</span>
    n <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>white<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token keyword">if</span> arg <span class="token keyword">else</span> black<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token number">0.05</span> <span class="token operator">*</span> white_max <span class="token keyword">if</span> arg <span class="token keyword">else</span> <span class="token number">0.05</span> <span class="token operator">*</span> black_max<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 上面这些判断用来辨别是白底黑字还是黑底白字</span>
        <span class="token comment"># 0.05这个参数请多调整，对应上面的0.95</span>
        start <span class="token operator">=</span> n
        end <span class="token operator">=</span> find_end<span class="token punctuation">(</span>start<span class="token punctuation">)</span>
        n <span class="token operator">=</span> end
        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">:</span>
            cj <span class="token operator">=</span> img_<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span>height<span class="token punctuation">,</span> start<span class="token punctuation">:</span>end<span class="token punctuation">]</span>
            cj <span class="token operator">=</span> cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>cj<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            word<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cj<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>j <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>word<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码效果：<br> <img src="https://images2.imgbox.com/60/ef/IrovBxEK_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/67b6859115af2e465364eb1ae5c84537/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JDK 8 转成 JDK 11 时会出现‘(程序包r 已在模块 xxx中声明, 但该模块未导出它)’</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bbca40bdae428611890980f1bdc9cf50/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Docker Swarm实现跨宿主机容器间访问</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>