<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Presto日期函数 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Presto日期函数" />
<meta property="og:description" content="1、当前时间
select current_date,current_time;
多种类型转时间戳
字符串转时间戳 string -&gt; timestamp select cast(&#39;2022-03-22&#39; as timestamp);
select date_parse(&#39;2022-04-06 00:03:55&#39;,&#39;%Y-%m-%d %H:%i:%S&#39;) 时间戳格式化 format_datetime(timestamp,‘yyyy-MM-dd HH:mm:ss’)
Bigint转时间戳
Create_time是一个bigint类型的数值
Select from_unixtine(create_time) from db;
时间转bigint
Select to_unixtime(current_date) ;
转年月日/取年月日
select date_format(current_date,&#39;%Y-%m-%d&#39;); //字符串格式化成日期的样子 select date(current_date); select cast(current_date as date); //这是一个字符串可以转日期的函数 字符串转年月日
select date(cast(&#39;2022-02-22 10:28:00&#39; as TIMESTAMP)); select date(&#39;2019-02-28&#39;); select date_format(cast(&#39;2019-02-28 10:28:00&#39; as TIMESTAMP),&#39;%Y-%m-%d&#39;); select to_date(&#39;2019-02-28&#39;,&#39;yyyy-mm-dd&#39;); Bigint转年月日 date(from_unixtime(1556380800)) select date_format(from_unixtime(1556380800),&#39;%Y-%m-%d&#39;); 重点： 日期间隔 date_diff(unit, timestamp1, timestamp2) //bigint select date_diff(&#39;day&#39;,cast(&#39;2019-04-24&#39; as TIMESTAMP),cast(&#39;2019-04-26&#39; as TIMESTAMP)) ; 注意：presto的date_diff是后-前，hive和mysql的date_diff是前-后" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/e7c543ff3fc6a65123fee6bb145402b0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-22T12:51:50+08:00" />
<meta property="article:modified_time" content="2022-03-22T12:51:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Presto日期函数</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:justify;">1、当前时间</p> 
<blockquote> 
 <p style="text-align:justify;">select current_date,current_time;</p> 
</blockquote> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="129" src="https://images2.imgbox.com/13/78/oMfBdspw_o.png" width="466"></p> 
<p style="margin-left:0;text-align:justify;"><strong>多种类型转时间戳</strong></p> 
<ol><li style="text-align:justify;">字符串转时间戳  string -&gt; timestamp</li></ol> 
<blockquote> 
 <p style="margin-left:0;text-align:left;">select cast('2022-03-22' as timestamp);</p> 
</blockquote> 
<pre style="margin-left:.0001pt;"><code>select date_parse('2022-04-06 00:03:55','%Y-%m-%d %H:%i:%S') </code></pre> 
<p style="margin-left:0;text-align:left;"><img alt="" height="240" src="https://images2.imgbox.com/cb/34/EVtrrgGh_o.png" width="717"></p> 
<p style="margin-left:0;text-align:left;"></p> 
<p style="margin-left:0;text-align:left;">时间戳格式化 format_datetime(timestamp,‘yyyy-MM-dd HH:mm:ss’)</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">Bigint转时间戳</p> 
<p style="margin-left:0;text-align:justify;">Create_time是一个bigint类型的数值</p> 
<p style="margin-left:0;text-align:justify;">Select from_unixtine(create_time)  from db;</p> 
<p style="margin-left:0;text-align:justify;">时间转bigint</p> 
<p style="margin-left:0;text-align:justify;">Select to_unixtime(current_date) ;</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="126" src="https://images2.imgbox.com/e1/f0/1kdowwVN_o.png" width="474"></p> 
<p style="margin-left:0;text-align:justify;"><strong>转年月日/取年月日</strong></p> 
<pre style="margin-left:.0001pt;"><code>select date_format(current_date,'%Y-%m-%d');   //字符串格式化成日期的样子</code></pre> 
<pre style="margin-left:.0001pt;"><code>select date(current_date);   </code></pre> 
<pre style="margin-left:.0001pt;"><code>select cast(current_date as date);    //这是一个字符串可以转日期的函数</code></pre> 
<pre style="margin-left:.0001pt;"></pre> 
<p style="margin-left:0;text-align:left;"><strong>字符串转年月日</strong></p> 
<pre style="margin-left:.0001pt;">select date(cast('2022-02-22 10:28:00' as TIMESTAMP));</pre> 
<pre style="margin-left:.0001pt;"></pre> 
<pre style="margin-left:.0001pt;">select date('2019-02-28');</pre> 
<pre style="margin-left:.0001pt;"></pre> 
<pre style="margin-left:.0001pt;">select date_format(cast('2019-02-28 10:28:00' as TIMESTAMP),'%Y-%m-%d');</pre> 
<pre style="margin-left:.0001pt;"></pre> 
<pre style="margin-left:.0001pt;"></pre> 
<pre style="margin-left:.0001pt;">select to_date('2019-02-28','yyyy-mm-dd');</pre> 
<pre style="margin-left:.0001pt;"></pre> 
<pre style="margin-left:.0001pt;">Bigint转年月日</pre> 
<pre style="margin-left:.0001pt;"><code>date(from_unixtime(1556380800))</code></pre> 
<pre style="margin-left:.0001pt;"><code>select date_format(from_unixtime(1556380800),'%Y-%m-%d');</code></pre> 
<pre style="margin-left:.0001pt;">重点：</pre> 
<pre style="margin-left:.0001pt;">日期间隔</pre> 
<pre style="margin-left:.0001pt;"><code>date_diff(unit, timestamp1, timestamp2)    //bigint</code></pre> 
<pre style="margin-left:.0001pt;"><code>select date_diff('day',cast('2019-04-24' as TIMESTAMP),cast('2019-04-26' as TIMESTAMP))  ;</code></pre> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="268" src="https://images2.imgbox.com/ee/fd/HGcia03u_o.png" width="801"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">注意：presto的date_diff是后-前，hive和mysql的date_diff是前-后</p> 
<p>求几天前，几天后 interval、date_add</p> 
<pre style="margin-left:.0001pt;"><code>select current_date,(current_date - interval '7' day),date_add('day', 7, current_date);</code></pre> 
<p><img alt="" height="232" src="https://images2.imgbox.com/af/4c/ePbIxv68_o.png" width="817"></p> 
<p>时间截取函数 date_trunc(unit, x)</p> 
<p>--截取月初</p> 
<pre style="margin-left:.0001pt;"><code>select date_trunc('month',current_date);</code></pre> 
<pre style="margin-left:.0001pt;"><code>--截取年初</code></pre> 
<pre style="margin-left:.0001pt;"><code>select date_trunc('year',current_date);</code></pre> 
<pre style="margin-left:.0001pt;"></pre> 
<p>时间提取函数 extract、year、month、day</p> 
<blockquote> 
 <p>select</p> 
 <p>    extract(year from current_date),</p> 
 <p>    year(current_date),</p> 
 <p>    extract(month from current_date),</p> 
 <p>    month(current_date),</p> 
 <p>    extract(day from current_date),</p> 
 <p>    day(current_date);</p> 
 <pre style="margin-left:.0001pt;"></pre> 
</blockquote> 
<p><img alt="" height="265" src="https://images2.imgbox.com/cc/c1/xhERNlES_o.png" width="568"></p> 
<pre style="margin-left:.0001pt;">转int</pre> 
<pre style="margin-left:.0001pt;">-&gt;timestamp-&gt;to_unixtime-&gt;int</pre> 
<pre style="margin-left:.0001pt;"><code>to_unixtime(timestamp_col)</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f2977e31bbc9b19674cf31fb57fbb43d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">docker入门（启用容器）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4576e92486bb5a8f93818938425dcfe0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">问题小结（3.22）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>