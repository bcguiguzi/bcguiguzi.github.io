<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ffmpeg命令基本语法和常见命令 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ffmpeg命令基本语法和常见命令" />
<meta property="og:description" content="1）常用命令 1、最简单转换命令
ffmpeg -i input.mp4 output.mkv
2、更加精准的控制转换命令
ffmpeg -i input.mp4 -c:v vp9 -c:a libvorbis output.mkv
（-c:v 控制视频格式， -c:a 控制音频格式）
3、调节比特率
ffmpeg -i GVG-981.mp4 -c:v libx264 -b:v 2M -maxrate 2M -bufsize 1M GVG-981-out.mp4
ffmpeg -i input.webm -c:a copy -c:v vp9 -b:v 1M output.mkv
（-b:v 1M 代表着视频的比特率变成1Mb
This will copy the audio (-c:a copy) from input.webm and convert the video to a VP9 codec (-c:v vp9) with a bit rate of 1M/s (-b:v), all bundled up in a Matroska container (output." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/5f7592c9b5ba56891bf9d63f0c21ab70/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-03T09:47:38+08:00" />
<meta property="article:modified_time" content="2024-01-03T09:47:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ffmpeg命令基本语法和常见命令</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>1）常用命令</h4> 
<p>1、最简单转换命令</p> 
<p>ffmpeg -i input.mp4 output.mkv</p> 
<p>2、更加精准的控制转换命令</p> 
<p>ffmpeg -i input.mp4 -c:v vp9 -c:a libvorbis output.mkv</p> 
<p>（-c:v  控制视频格式， -c:a  控制音频格式）</p> 
<p> 3、调节比特率</p> 
<p>ffmpeg -i  GVG-981.mp4 -c:v libx264 -b:v 2M -maxrate 2M -bufsize 1M GVG-981-out.mp4</p> 
<p>ffmpeg -i input.webm -c:a copy -c:v vp9 -b:v 1M output.mkv</p> 
<p>（-b:v 1M 代表着视频的比特率变成1Mb</p> 
<p>This will copy the audio (<strong>-c:a copy</strong>) from <strong>input.webm</strong> and convert the video to a VP9 codec (<strong>-c:v vp9</strong>) with a bit rate of 1M/s (<strong>-b:v</strong>), all bundled up in a Matroska container (<strong>output.mkv</strong>).）</p> 
<p>4、调节帧率</p> 
<p>ffmpeg -i 002.mp4 -filter:v fps=fps=29.97  002-out.mp4</p> 
<p>ffmpeg -i input.webm -c:a copy -c:v vp9 -r 30 output.mkv</p> 
<p>（This creates a new Matroska with the audio stream copied over and the video stream's frame rate forced to 30 frames per second, instead of using the frame rate from the input (<strong>-r 30</strong>).）</p> 
<p>5、调节视频尺寸（分辨率）</p> 
<p>ffmpeg -i  FC2PPV-402422-1.mp4 -c:a copy -s 854x480 FC2PPV-402422-1-out.mp4</p> 
<p>ffmpeg -i input.mkv -c:a copy -s 1280x720 output.mkv</p> 
<p>（声音原封不动拷贝过去，视频编码格式不变，只是尺寸调整到1280x720）</p> 
<p>6、截取部分视频(时长)</p> 
<p>ffmpeg -i input.mkv -c:a  copy  -c:v copy  -ss 00:01:00  -t 10  output.mkv</p> 
<p>（音视频格式不变， 从00:01:00开始拷贝10s过去）</p> 
<p>7、 提取关键帧</p> 
<p>ffmpeg -skip_frame nokey -i 480P_2000K_204282351.mp4 -vsync 0 -r 30 -f image2 480P_2000K_204282351\%02d.png</p> 
<p>8,<span style="color:#e3e3e3;"><span style="background-color:#1e1f20;">使用 ffmpeg 命令将 raw.mp4 的音频替换为 out.wav 的音频</span></span></p> 
<pre><code>ffmpeg -i raw.mp4 -i out.wav -map 0:v -map 1:a -c:v copy -c:a copy replaced_audio.mp4
</code></pre> 
<p>8、对视频进行帧提取</p> 
<p>您可以使用以下命令将视频分解成图片序列：</p> 
<pre><code>ffmpeg -i input.mp4 -vf fps=1 frame_%04d.png
</code></pre> 
<p>这条命令将 <code>input.mp4</code> 视频分解成图片序列，每秒保存一帧。输出的文件名为 <code>frame_0001.png</code>、<code>frame_0002.png</code> 等。您可以根据需要更改输入文件名、帧率和输出文件名模式。</p> 
<p>ffmpeg -i .\input.mp4 -vf 'select=gte(n\,1),setpts=PTS-STARTPTS' 'input/%05d.png'</p> 
<p>ffmpeg -i .\input.mp4 -vf 'select=gte(n\,1),setpts=0.5*PTS' 'input/%05d.png'</p> 
<p>ffmpeg -i .\input.mp4 -vf 'select=between(n\,{START_FRAME}\,{END_FRAME}),setpts=0.5*PTS' 'input/%05d.png'</p> 
<p>setpts的具体参数含义如下：</p> 
<ul><li>Start counting PTS from zero <pre>setpts=PTS-STARTPTS
</pre> </li><li>Apply fast motion effect: <pre>setpts=0.5*PTS
</pre> </li><li>Apply slow motion effect: <pre>setpts=2.0*PTS
</pre> </li><li>Set fixed rate of 25 frames per second: <pre>setpts=N/(25*TB)
</pre> </li><li>Set fixed rate 25 fps with some jitter: <pre>setpts='1/(25*TB) * (N + 0.05 * sin(N*2*PI/25))'
</pre> </li><li>Apply an offset of 10 seconds to the input PTS: <pre>setpts=PTS+10/TB
</pre> </li><li>Generate timestamps from a "live source" and rebase onto the current timebase: <pre>setpts='(RTCTIME - RTCSTART) / (TB * 1000000)'
</pre> </li><li>Generate timestamps by counting samples: <pre>asetpts=N/SR/TB</pre> </li></ul> 
<p>9、从png序列生成视频文件</p> 
<p>ffmpeg -y -r {TARGET_FPS} -f image2 -pattern_type glob -i '*.png' '/content/gdrive/My Drive/{OUTPUT_FILE_PATH}'</p> 
<h4>2）命令基本语法</h4> 
<p><img alt="" height="597" src="https://images2.imgbox.com/7b/82/0Cqlb0KO_o.png" width="728"></p> 
<p>注意：这里面的非方括号部分（蓝字）都是必须得有的。</p> 
<p><strong>全局选项：</strong></p> 
<p><strong>Global options (affect whole program instead of just one file:</strong><br> -loglevel loglevel  set libav* logging level<br> -v loglevel         set libav* logging level<br> -report             generate a report<br> -max_alloc bytes    set maximum size of a single allocated block<br> -y                  overwrite output files<br> -n                  do not overwrite output files<br> -stats              print progress report during encoding<br> -bits_per_raw_sample number  set the number of bits per raw sample<br> -vol volume         change audio volume (256=normal)</p> 
<p><strong>输入输出选项：</strong></p> 
<p>Per-file main options:<br> -f fmt              force format<br> -c codec            codec name<br> -codec codec        codec name<br> -pre preset         preset name<br> -map_metadata outfile[,metadata]:infile[,metadata]  set metadata information of outfile from infile<br> -t duration         record or transcode "duration" seconds of audio/video<br> -to time_stop       record or transcode stop time<br> -fs limit_size      set the limit file size in bytes<br> -ss time_off        set the start time offset<br> -timestamp time     set the recording timestamp ('now' to set the current time)<br> -metadata string=string  add metadata<br> -target type        specify target file type ("vcd", "svcd", "dvd", "dv", "dv50", "pal-vcd", "ntsc-svcd", ...)<br> -frames number      set the number of frames to record<br> -filter filter_graph  set stream filtergraph<br> -reinit_filter      reinit filtergraph on input parameter changes</p> 
<p>Video options:<br> -vframes number     set the number of video frames to record<br> -r rate             set frame rate (Hz value, fraction or abbreviation)<br> -s size             set frame size (WxH or abbreviation)<br> -aspect aspect      set aspect ratio (4:3, 16:9 or 1.3333, 1.7777)<br> -bits_per_raw_sample number  set the number of bits per raw sample<br> -vn                 disable video<br> -vcodec codec       force video codec ('copy' to copy stream)<br> -timecode hh:mm:ss[:;.]ff  set initial TimeCode value.<br> -pass n             select the pass number (1 to 3)<br> -vf filter_graph    set video filters<br> -b bitrate          video bitrate (please use -b:v)<br> -dn                 disable data</p> 
<p>Audio options:<br> -aframes number     set the number of audio frames to record<br> -aq quality         set audio quality (codec-specific)<br> -ar rate            set audio sampling rate (in Hz)<br> -ac channels        set number of audio channels<br> -an                 disable audio<br> -acodec codec       force audio codec ('copy' to copy stream)<br> -vol volume         change audio volume (256=normal)<br> -af filter_graph    set audio filters</p> 
<p>Subtitle options:<br> -s size             set frame size (WxH or abbreviation)<br> -sn                 disable subtitle<br> -scodec codec       force subtitle codec ('copy' to copy stream)<br> -stag fourcc/tag    force subtitle tag/fourcc<br> -fix_sub_duration   fix subtitles duration<br> -canvas_size size   set canvas size (WxH or abbreviation)<br> -spre preset        set the subtitle options to the indicated preset</p> 
<h4>3）ffmpeg背后的多媒体基础知识</h4> 
<p><a href="https://blog.csdn.net/u010087338/article/details/117284829" title="看这里">看这里</a></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9da882ac731fcb5aebf34734327f5eeb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Flutter android及ios屏幕调整</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1732c4dd47fd30891bd4f18437d4612e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">天线的相关概念</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>