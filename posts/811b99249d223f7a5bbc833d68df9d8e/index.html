<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【贝叶斯分析②】抛硬币问题 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【贝叶斯分析②】抛硬币问题" />
<meta property="og:description" content="抛硬币问题可能是贝叶斯推断中最基础的一个入门问题，该问题简单来说就是对一枚硬币出现正面朝上的概率θ进行估计。不同于MLE, MAP等估计方法求出的是一个估计值，贝叶斯分析求出的是一个后验分布（用贝叶斯公式）。
θ的先验通常选用beta分布，n次观测正面朝上次数y的似然则可以用参数为n和θ二项分布来描述。用数学表达式描述如下θ ~ Beta(α, β)，y~ Bin(n, p = θ).
这里顺便多说一下为什么先验用beta分布的原因：One of them is that the beta distribution is restricted to be between 0 and 1, in the same way our parameter θ is. Another reason is its versatility. As we can see in the preceding figure, the distribution adopts several shapes, including a uniform distribution, Gaussian-like distributions, U-like distributions, and so on. A third reason is that the beta distribution is the conjugate prior of the binomial distribution (which we are using as the likelihood)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/811b99249d223f7a5bbc833d68df9d8e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-07-30T23:58:09+08:00" />
<meta property="article:modified_time" content="2018-07-30T23:58:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【贝叶斯分析②】抛硬币问题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>抛硬币问题可能是贝叶斯推断中最基础的一个入门问题，该问题简单来说就是对一枚硬币出现正面朝上的概率θ进行估计。不同于MLE, MAP等估计方法求出的是一个估计值，贝叶斯分析求出的是一个后验分布（用贝叶斯公式）。</p> 
<p>θ的先验通常选用beta分布，n次观测正面朝上次数y的似然则可以用参数为n和θ二项分布来描述。用数学表达式描述如下θ ~ Beta(α, β)，y~ Bin(n, p = θ).</p> 
<p>这里顺便多说一下为什么先验用beta分布的原因：One of them is that the beta distribution is restricted to be between 0 and 1, in the same way our parameter θ is. Another reason is its versatility. As we can see in the preceding figure, the distribution adopts several shapes, including a uniform distribution, Gaussian-like distributions, U-like distributions, and so on. A third reason is that the beta distribution is the conjugate prior of the binomial distribution (which we are using as the likelihood). A conjugate prior of a likelihood is a prior that, when used in combination with the given likelihood, returns a posterior with the same functional form as the prior. Untwisting the tongue, every time we use a beta distribution as prior and a binomial distribution as likelihood, we will get a beta as a posterior. 也就是说在这里，后验分布可以直接求出解析解 θ|y ~ Beta(α_prior + α，β_prior + N -y). 当然，使用现代计算方法（如MCMC采样），我们进行贝叶斯推断时无需考虑是否使用共轭先验。（we can use modern computational methods to solve Bayesian problems whether we choose conjugate priors or not.）</p> 
<p>代码如下：</p> 
<pre class="has"><code class="language-python"># -*- coding: utf-8 -*-
import pymc3 as pm
import numpy as np
import scipy.stats as stats
import matplotlib.pyplot as plt
if __name__ == "__main__":
    
    np.random.seed(123)
    n_experiments = 100
    theta_real = 0.35  # unkwon value in a real experiment
    alpha_prior = 1
    beta_prior = 1
    data = stats.bernoulli.rvs(p=theta_real, size=n_experiments)
    data_sum = data.sum()
    
    with pm.Model() as our_first_model:
        # a priori
        theta = pm.Beta('theta', alpha=1, beta=1)
        # likelihood
        y = pm.Bernoulli('y', p=theta, observed=data)
        #y = pm.Binomial('theta',n=n_experimentos, p=theta, observed=sum(datos))
        start = pm.find_MAP()
        step = pm.Metropolis()
        trace = pm.sample(2000, step=step, start=start,  nchains = 1)
        burnin = 0  # no burnin
        chain = trace[burnin:]
        pm.traceplot(chain, lines={'theta':theta_real});
        
    plt.figure()    
    x = np.linspace(.2, .6, 1000)
    func = stats.beta(a =alpha_prior+data_sum, b=beta_prior+n_experiments-data_sum)
    y = func.pdf(x)
    
    plt.plot(x, y, 'r-', lw=3, label='True distribution')
    plt.hist(chain['theta'], bins=30, normed=True, label='Estimated posterior distribution')


</code></pre> 
<p>输出（采样轨迹和推断出的后验分布直方图）：</p> 
<p><img alt="" class="has" height="197" src="https://images2.imgbox.com/fc/e3/nPuAr54X_o.png" width="1200"></p> 
<p><img alt="" class="has" height="476" src="https://images2.imgbox.com/49/5a/PBdpHUx2_o.png" width="640"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d0b9c80d4952942255cc0ac2810d95ac/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">带灯LED按钮开关接线方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b8c247f10a2fe0b28ba73b33f9cda6b5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">opencv-Mat数据类型及位数总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>