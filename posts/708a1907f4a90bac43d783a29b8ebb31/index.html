<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>0基础学MySQL数据库—从小白到大牛(24)存储引擎 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="0基础学MySQL数据库—从小白到大牛(24)存储引擎" />
<meta property="og:description" content="文章目录 前言一、查看存储引擎二、设置系统默认的存储引擎三、设置表的存储引擎创建表时指定存储引擎修改表的存储引擎 四、引擎介绍InnoDB 引擎：具备外键支持功能的事务存储引擎MyISAM 引擎：主要的非事务处理存储引擎MyISAM和InnoDBArchive 引擎：用于数据存档Blackhole 引擎：丢弃写操作，读操作会返回空内容CSV 引擎：存储数据时，以逗号分隔各个数据项Memory 引擎：置于内存的表 补充InnoDB表的优势InnoDB和ACID模型InnoDB架构 前言 本章开始使用的测试数据库为GreatSQL8.0.25版本
(Wed Aug 3 16:17:03 2022)[root@GreatSQL][(none)]&gt;select version(); &#43;-----------&#43; | version() | &#43;-----------&#43; | 8.0.25-16 | &#43;-----------&#43; 1 row in set (0.00 sec) 为了管理方便，人们把连接管理、查询缓存、语法解析、查询优化这些并不涉及真实数据存储的功能划分为MySQL server的功能，把真实存取数据的功能划分为存储引擎的功能。所以在MySQL server完成了查询优化后，只需按照生成的执行计划调用底层存储引擎提供的API,获取到数据后返回给客户端就好了。
MySQL中提到了存储引擎的概念。简而言之，存储引擎就是指表的类型。其实存储引擎以前叫做表处理器，后来改名为存储引擎，它的功能就是接收上层传下来的指令，然后对表中的数据进行提取或写入操作。
一、查看存储引擎 查看mysql提供什么存储引擎：
(Fri Aug 5 11:28:25 2022)[root@GreatSQL][(none)]&gt;show engines; &#43;--------------------&#43;---------&#43;----------------------------------------------------------------------------&#43;--------------&#43;------&#43;------------&#43; | Engine | Support | Comment | Transactions | XA | Savepoints | &#43;--------------------&#43;---------&#43;----------------------------------------------------------------------------&#43;--------------&#43;------&#43;------------&#43; | FEDERATED | NO | Federated MySQL storage engine | NULL | NULL | NULL | | PERFORMANCE_SCHEMA | YES | Performance Schema | NO | NO | NO | | InnoDB | DEFAULT | Percona-XtraDB, Supports transactions, row-level locking, and foreign keys | YES | YES | YES | | MEMORY | YES | Hash based, stored in memory, useful for temporary tables | NO | NO | NO | | MyISAM | YES | MyISAM storage engine | NO | NO | NO | | MRG_MYISAM | YES | Collection of identical MyISAM tables | NO | NO | NO | | BLACKHOLE | YES | /dev/null storage engine (anything you write to it disappears) | NO | NO | NO | | CSV | YES | CSV storage engine | NO | NO | NO | | ARCHIVE | YES | Archive storage engine | NO | NO | NO | &#43;--------------------&#43;---------&#43;----------------------------------------------------------------------------&#43;--------------&#43;------&#43;------------&#43; 9 rows in set (0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/708a1907f4a90bac43d783a29b8ebb31/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-05T14:40:59+08:00" />
<meta property="article:modified_time" content="2022-08-05T14:40:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">0基础学MySQL数据库—从小白到大牛(24)存储引擎</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_6" rel="nofollow">前言</a></li><li><a href="#_22" rel="nofollow">一、查看存储引擎</a></li><li><a href="#_55" rel="nofollow">二、设置系统默认的存储引擎</a></li><li><a href="#_98" rel="nofollow">三、设置表的存储引擎</a></li><li><ul><li><a href="#_100" rel="nofollow">创建表时指定存储引擎</a></li><li><a href="#_107" rel="nofollow">修改表的存储引擎</a></li></ul> 
  </li><li><a href="#_112" rel="nofollow">四、引擎介绍</a></li><li><ul><li><a href="#InnoDB__113" rel="nofollow">InnoDB 引擎：具备外键支持功能的事务存储引擎</a></li><li><a href="#MyISAM__135" rel="nofollow">MyISAM 引擎：主要的非事务处理存储引擎</a></li><li><a href="#MyISAMInnoDB_153" rel="nofollow">MyISAM和InnoDB</a></li><li><a href="#Archive__175" rel="nofollow">Archive 引擎：用于数据存档</a></li><li><a href="#Blackhole__189" rel="nofollow">Blackhole 引擎：丢弃写操作，读操作会返回空内容</a></li><li><a href="#CSV__192" rel="nofollow">CSV 引擎：存储数据时，以逗号分隔各个数据项</a></li><li><a href="#Memory__200" rel="nofollow">Memory 引擎：置于内存的表</a></li></ul> 
  </li><li><a href="#_225" rel="nofollow">补充</a></li><li><ul><li><a href="#InnoDB_226" rel="nofollow">InnoDB表的优势</a></li><li><a href="#InnoDBACID_235" rel="nofollow">InnoDB和ACID模型</a></li><li><a href="#InnoDB_267" rel="nofollow">InnoDB架构</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_6"></a>前言</h2> 
<p>本章开始使用的测试数据库为GreatSQL8.0.25版本</p> 
<pre><code class="prism language-sql"><span class="token punctuation">(</span>Wed Aug  <span class="token number">3</span> <span class="token number">16</span>:<span class="token number">17</span>:<span class="token number">03</span> <span class="token number">2022</span><span class="token punctuation">)</span><span class="token punctuation">[</span>root<span class="token variable">@GreatSQL</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token keyword">select</span> version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------+</span>
<span class="token operator">|</span> version<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+</span>
<span class="token operator">|</span> <span class="token number">8.0</span><span class="token number">.25</span><span class="token operator">-</span><span class="token number">16</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p>为了管理方便，人们把<code>连接管理</code>、<code>查询缓存</code>、<code>语法解析</code>、<code>查询优化</code>这些并不涉及真实数据存储的功能划分为<code>MySQL server的功能</code>，把真实存取数据的功能划分为<code>存储引擎</code>的功能。所以在<code>MySQL server</code>完成了查询优化后，只需按照生成的执行计划调用底层存储引擎提供的API,获取到数据后返回给客户端就好了。</p> 
<p>MySQL中提到了存储引擎的概念。简而言之，<code>存储引擎就是指表的类型</code>。其实存储引擎以前叫做表处理器，后来改名为存储引擎，它的功能就是接收上层传下来的指令，然后对表中的数据进行提取或写入操作。</p> 
<h2><a id="_22"></a>一、查看存储引擎</h2> 
<p>查看mysql提供什么存储引擎：</p> 
<pre><code class="prism language-sql"><span class="token punctuation">(</span>Fri Aug  <span class="token number">5</span> <span class="token number">11</span>:<span class="token number">28</span>:<span class="token number">25</span> <span class="token number">2022</span><span class="token punctuation">)</span><span class="token punctuation">[</span>root<span class="token variable">@GreatSQL</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token keyword">show</span> engines<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+</span>
<span class="token operator">|</span> <span class="token keyword">Engine</span>             <span class="token operator">|</span> Support <span class="token operator">|</span> <span class="token keyword">Comment</span>                                                                    <span class="token operator">|</span> <span class="token keyword">Transactions</span> <span class="token operator">|</span> XA   <span class="token operator">|</span> Savepoints <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+</span>
<span class="token operator">|</span> FEDERATED          <span class="token operator">|</span> <span class="token keyword">NO</span>      <span class="token operator">|</span> Federated MySQL storage <span class="token keyword">engine</span>                                             <span class="token operator">|</span> <span class="token boolean">NULL</span>         <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>       <span class="token operator">|</span>
<span class="token operator">|</span> PERFORMANCE_SCHEMA <span class="token operator">|</span> YES     <span class="token operator">|</span> Performance <span class="token keyword">Schema</span>                                                         <span class="token operator">|</span> <span class="token keyword">NO</span>           <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> <span class="token keyword">NO</span>         <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">InnoDB</span>             <span class="token operator">|</span> <span class="token keyword">DEFAULT</span> <span class="token operator">|</span> Percona<span class="token operator">-</span>XtraDB<span class="token punctuation">,</span> Supports <span class="token keyword">transactions</span><span class="token punctuation">,</span> <span class="token keyword">row</span><span class="token operator">-</span><span class="token keyword">level</span> locking<span class="token punctuation">,</span> <span class="token operator">and</span> <span class="token keyword">foreign</span> <span class="token keyword">keys</span> <span class="token operator">|</span> YES          <span class="token operator">|</span> YES  <span class="token operator">|</span> YES        <span class="token operator">|</span>
<span class="token operator">|</span> MEMORY             <span class="token operator">|</span> YES     <span class="token operator">|</span> <span class="token keyword">Hash</span> based<span class="token punctuation">,</span> stored <span class="token operator">in</span> memory<span class="token punctuation">,</span> useful <span class="token keyword">for</span> <span class="token keyword">temporary</span> <span class="token keyword">tables</span>                  <span class="token operator">|</span> <span class="token keyword">NO</span>           <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> <span class="token keyword">NO</span>         <span class="token operator">|</span>
<span class="token operator">|</span> MyISAM             <span class="token operator">|</span> YES     <span class="token operator">|</span> MyISAM storage <span class="token keyword">engine</span>                                                      <span class="token operator">|</span> <span class="token keyword">NO</span>           <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> <span class="token keyword">NO</span>         <span class="token operator">|</span>
<span class="token operator">|</span> MRG_MYISAM         <span class="token operator">|</span> YES     <span class="token operator">|</span> Collection <span class="token keyword">of</span> identical MyISAM <span class="token keyword">tables</span>                                      <span class="token operator">|</span> <span class="token keyword">NO</span>           <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> <span class="token keyword">NO</span>         <span class="token operator">|</span>
<span class="token operator">|</span> BLACKHOLE          <span class="token operator">|</span> YES     <span class="token operator">|</span> <span class="token operator">/</span>dev<span class="token operator">/</span><span class="token boolean">null</span> storage <span class="token keyword">engine</span> <span class="token punctuation">(</span>anything you <span class="token keyword">write</span> <span class="token keyword">to</span> it disappears<span class="token punctuation">)</span>             <span class="token operator">|</span> <span class="token keyword">NO</span>           <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> <span class="token keyword">NO</span>         <span class="token operator">|</span>
<span class="token operator">|</span> CSV                <span class="token operator">|</span> YES     <span class="token operator">|</span> CSV storage <span class="token keyword">engine</span>                                                         <span class="token operator">|</span> <span class="token keyword">NO</span>           <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> <span class="token keyword">NO</span>         <span class="token operator">|</span>
<span class="token operator">|</span> ARCHIVE            <span class="token operator">|</span> YES     <span class="token operator">|</span> Archive storage <span class="token keyword">engine</span>                                                     <span class="token operator">|</span> <span class="token keyword">NO</span>           <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> <span class="token keyword">NO</span>         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+</span>
<span class="token number">9</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p>查询结果显示，MySQL8支持9种存储引擎，分别为<code>MEMORY</code>、<code>MRG_MYISAM</code>、<code>CSV</code>、<code>FEDERATED</code>、<code>PERFORMANCE_SCHEMA</code>、<code>MyISAM</code>、<code>InnoDB</code>、<code>BLACKHOLE和ARCHIVE</code>。</p> 
<ul><li><code>Engine</code>参数表示存储引擎名称。</li><li><code>Support</code>参数表示MySQL数据库管理系统是否支持该存储引擎：YES表示支持，NO表示不支持。</li><li><code>DEFAULT</code>表示系统默认支持的存储引擎。</li><li><code>Comment</code>参数表示对存储引擎的评论。</li><li><code>Transactions</code>参数表示存储引擎是否支持事务：YES表示支持，NO表示不支持。</li><li><code>XA</code>参数表示存储引擎所支持的分布式是否符合XA规范：YES表示支持，NO表示不支持。代表着该存储引擎是<br> 否支持分布式事务。</li><li><code>Savepoints</code>参数表示存储引擎是否支持事务处理的保存点：YES表示支持，NO表示不支持。也就是说，该存<br> 储引擎是否支持部分事务回滚。</li></ul> 
<h2><a id="_55"></a>二、设置系统默认的存储引擎</h2> 
<pre><code class="prism language-sql"><span class="token punctuation">(</span>Fri Aug  <span class="token number">5</span> <span class="token number">14</span>:<span class="token number">02</span>:<span class="token number">53</span> <span class="token number">2022</span><span class="token punctuation">)</span><span class="token punctuation">[</span>root<span class="token variable">@GreatSQL</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%storage_engine%'</span><span class="token punctuation">;</span> 
<span class="token operator">+</span><span class="token comment">---------------------------------+-----------+</span>
<span class="token operator">|</span> Variable_name                   <span class="token operator">|</span> <span class="token keyword">Value</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------+-----------+</span>
<span class="token operator">|</span> default_storage_engine          <span class="token operator">|</span> <span class="token keyword">InnoDB</span>    <span class="token operator">|</span>
<span class="token operator">|</span> default_tmp_storage_engine      <span class="token operator">|</span> <span class="token keyword">InnoDB</span>    <span class="token operator">|</span>
<span class="token operator">|</span> disabled_storage_engines        <span class="token operator">|</span>           <span class="token operator">|</span>
<span class="token operator">|</span> enforce_storage_engine          <span class="token operator">|</span>           <span class="token operator">|</span>
<span class="token operator">|</span> internal_tmp_mem_storage_engine <span class="token operator">|</span> <span class="token keyword">TempTable</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------+-----------+</span>
<span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

或者

<span class="token punctuation">(</span>Fri Aug  <span class="token number">5</span> <span class="token number">14</span>:<span class="token number">02</span>:<span class="token number">55</span> <span class="token number">2022</span><span class="token punctuation">)</span><span class="token punctuation">[</span>root<span class="token variable">@GreatSQL</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token keyword">SELECT</span> @<span class="token variable">@default_storage_engine</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------------------+</span>
<span class="token operator">|</span> @<span class="token variable">@default_storage_engine</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">InnoDB</span>                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p><strong>修改默认的存储引擎</strong><br> 如果在创建表的语句中没有显式指定表的存储引擎的话，那就会默认使用 InnoDB 作为表的存储引擎。</p> 
<p>如果我们想改变表的默认存储引擎的话，可以这样写启动服务器的命令行：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SET</span> DEFAULT_STORAGE_ENGINE<span class="token operator">=</span>MyISAM<span class="token punctuation">;</span> 
</code></pre> 
<p>或者修改 my.cnf 文件：</p> 
<pre><code class="prism language-sql"><span class="token punctuation">[</span>root<span class="token variable">@localhost</span> <span class="token operator">~</span><span class="token punctuation">]</span>$ vim <span class="token operator">/</span>etc<span class="token operator">/</span>my<span class="token punctuation">.</span>cnf
<span class="token keyword">default</span><span class="token operator">-</span>storage<span class="token operator">-</span><span class="token keyword">engine</span><span class="token operator">=</span>MyISAM 

<span class="token comment"># 重启服务 </span>
systemctl restart mysqld<span class="token punctuation">.</span>service 
</code></pre> 
<h2><a id="_98"></a>三、设置表的存储引擎</h2> 
<p>存储引擎是负责对表中的数据进行提取和写入工作的，我们可以为<code>不同的表设置不同的存储引擎</code>，也就是说不同的表可以有不同的物理存储结构，不同的提取和写入方式。</p> 
<h3><a id="_100"></a>创建表时指定存储引擎</h3> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名<span class="token punctuation">(</span> 
	建表语句<span class="token punctuation">;</span> 
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> 存储引擎名称<span class="token punctuation">;</span> 
</code></pre> 
<h3><a id="_107"></a>修改表的存储引擎</h3> 
<pre><code class="prism language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名 <span class="token keyword">ENGINE</span> <span class="token operator">=</span> 存储引擎名称<span class="token punctuation">;</span>
</code></pre> 
<h2><a id="_112"></a>四、引擎介绍</h2> 
<h3><a id="InnoDB__113"></a>InnoDB 引擎：具备外键支持功能的事务存储引擎</h3> 
<p>MySQL从3.23.34a开始就包含InnoDB存储引擎。 <code>大于等于5.5之后，默认采用InnoDB引擎</code>。</p> 
<p>InnoDB是MySQL的<code>默认事务型引擎</code>，它被设计用来处理大量的短期(short-lived)事务。可以确保事务的完整提交(Commit)和回滚(Rollback)。</p> 
<p>除了增加和查询外，还需要更新、删除操作，那么，应优先选择InnoDB存储引擎。</p> 
<p><code>除非有非常特别的原因需要使用其他的存储引擎，否则应该优先考虑InnoDB引擎</code>。</p> 
<p>数据文件结构：（在《第02章_MySQL数据目录》已说明）</p> 
<ul><li> <p>表名.frm 存储表结构（MySQL8.0时，合并在表名.ibd中）</p> </li><li> <p>表名.ibd 存储数据和索引</p> </li></ul> 
<p>InnoDB是<code>为处理巨大数据量的最大性能设计</code>。</p> 
<ul><li>在以前的版本中，字典数据以元数据文件、非事务表等来存储。现在这些元数据文件被删除了。比如：<code> .frm ， .par ， .trn ， .isl ， .db.opt</code> 等都在MySQL8.0中不存在了。</li></ul> 
<p><strong>缺点</strong> 对比MyISAM的存储引擎，<code>InnoDB写的处理效率差一些</code>，并且会占用更多的磁盘空间以保存数据和索引。</p> 
<p><strong>缺点</strong> MyISAM只缓存索引，不缓存真实数据；InnoDB不仅缓存索引还要缓存真实数据，<code>对内存要求较高</code>，而且内存大小对性能有决定性的影响。</p> 
<h3><a id="MyISAM__135"></a>MyISAM 引擎：主要的非事务处理存储引擎</h3> 
<p>MyISAM提供了大量的特性，包括全文索引、压缩、空间函数(GIS)等，<code>但MyISAM 不支持事务、行级 锁、外键 </code>，有一个毫无疑问的缺陷就是<code>崩溃后无法安全恢复</code> 。</p> 
<p>5.5之前默认的存储引擎</p> 
<p>优势是访问的<code>速度快</code>，对事务完整性没有要求或者以SELECT、INSERT为主的应用</p> 
<p>针对数据统计有额外的常数存储。故而 count(*) 的查询效率很高</p> 
<p>数据文件结构：（在《第02章_MySQL数据目录》已说明）</p> 
<ul><li> <p>表名.frm 存储表结构</p> </li><li> <p>表名.MYD 存储数据 (MYData)</p> </li><li> <p>表名.MYI 存储索引 (MYIndex)</p> </li></ul> 
<p>应用场景：只读应用或者以读为主的业务</p> 
<h3><a id="MyISAMInnoDB_153"></a>MyISAM和InnoDB</h3> 
<p><strong>很多人对 InnoDB 和 MyISAM 的取舍存在疑问，到底选择哪个比较好呢？</strong></p> 
<p>MySQL5.5之前的默认存储引擎是MyISAM，5.5之后改为了InnoDB。</p> 
<p>首先对于InnoDB存储引擎，提供了良好的事务管理、崩溃修复能力和并发控制。因为InnoDB存储引擎<code>支持事务</code>，所以对于要求事务完整性的场合需要选择InnoDB,比如数据操作除了插入和查询以外还包含有很多更新、删除操作，像财务系统等对数据准确性要求较高的系统。缺点是<code>其读写效率稍差，占用的数据空间相对比较大</code>。</p> 
<p>其次对于MyISAM存储引擎，如果是<code>小型应用</code>，系统<code>以读操作和插入操作为主</code>，只有很少的更新、删除操作，并且对事务的要求没有那么高，则可以选择这个存储引擎。MyISAM存储引擎的优势在于<code>占用空间小，处理速度快</code>；缺点是<code>不支持事务的完整性和并发性</code>。</p> 
<p>这两种引擎各有特点，可以在MySQL中，针对不同的数据表，可以选择不同的存储引擎。</p> 
<table><thead><tr><th>对比项</th><th>MyISAM</th><th>InnoDB</th></tr></thead><tbody><tr><td>外键</td><td>不支持</td><td>支持</td></tr><tr><td>事务</td><td>不支持</td><td>支持</td></tr><tr><td>行表锁</td><td>表锁，即使操作一条记录也会锁住整个表，不适合高并发的操作</td><td>行锁，操作时只锁某一行，不对其它行有影响，<code>适合高并发的操作</code></td></tr><tr><td>缓存</td><td>只缓存索引，不缓存真实数据</td><td>不仅缓存索引还要缓存真实数据，对内存要求较高，而且内存大小对性能有决定性的影响</td></tr><tr><td>自带系统表使用</td><td>Y</td><td>N</td></tr><tr><td>关注点</td><td>性能：节省资源、消耗少、简单业务</td><td>事务：并发写、事务、更大资源</td></tr><tr><td>默认安装</td><td>Y</td><td>Y</td></tr><tr><td>默认使用</td><td>N</td><td>Y</td></tr></tbody></table> 
<h3><a id="Archive__175"></a>Archive 引擎：用于数据存档</h3> 
<p>archive是归档的意思，<code>仅仅支持插入和查询两种功能</code>（行被插入后不能再修改）</p> 
<p>在MySQL5.5以后支持索引功能。</p> 
<p>拥有很好的压缩机制，使用zlib压缩库，在记录请求的时候实时的进行压缩，经常被用来作为仓库使用。</p> 
<p>创建ARCHIVE表时，存储引擎会创建名称以表名开头的文件。数据文件的扩展名为.ARZ。</p> 
<p>根据英文的测试结论来看，同样数据量下，Archive表比MyISAM表要小大约75%,比支持事务处理的InnoDB表小大约83%。</p> 
<p>ARCHIVE存储引擎采用了行级锁。该ARCHIVE引擎支持AUTO_INCREMENT列属性。AUTO_INCREMENT列可以具有唯一索引或非唯一索引。尝试在任何其他列上创建索引会导致错误。</p> 
<p>Archive表适合日志和数据采集（档案）类应用；适合存储大量的独立的作为历史记录的数据。<code>拥有很高的插入速度</code>，但是对查询的支持较差。</p> 
<h3><a id="Blackhole__189"></a>Blackhole 引擎：丢弃写操作，读操作会返回空内容</h3> 
<p>Blackhole引擎没有实现任何存储机制，它会<code>丢弃所有插入的数据</code>，不做任何保存。<br> 但服务器会记录Blackhole表的日志，所以可以用于复制数据到备库，或者简单地记录到日志。但这种应用方式会碰到很多问题，因此并不推荐。</p> 
<h3><a id="CSV__192"></a>CSV 引擎：存储数据时，以逗号分隔各个数据项</h3> 
<p>CSV引擎可以将普通的<code>CSV文件作为MySQL的表来处理</code>，但不支持索引。<br> CSV引擎可以作为一种<code>数据交换的机制</code>，非常有用。<br> CSV存储的数据直接可以在操作系统里，用文本编辑器，或者excel读取。<br> 对于数据的快速导入、导出是有明显优势的。</p> 
<p>创建CSV表时，服务器会创建一个纯文本数据文件，其名称以表名开头并带有.CSV扩展名。当你将数据存储到表中时，存储引掌将其以逗号分隔值格式保存到数据文件中。</p> 
<h3><a id="Memory__200"></a>Memory 引擎：置于内存的表</h3> 
<p><strong>概述：</strong><br> Memory采用的逻辑介质是<code>内存 </code>， <code>响应速度很快</code> ，但是当mysqld守护进程崩溃的时候 <code>数据会丢失 </code>。另外，要求存储的数据是数据长度不变的格式，比如，Blob和Text类型的数据不可用(长度不固定的)。</p> 
<p><strong>主要特征：</strong></p> 
<p>Memory同时 支持哈希（HASH）索引 和 B+树索引 。</p> 
<ul><li>哈希索引相等的比较快，但是对于范围的比较慢很多。</li><li>默认使用哈希（HASH)索引，其速度要比使用B型树（BTREE)索引快。</li><li>如果希望使用B树索引，可以在创建索引时选择使用。</li></ul> 
<p>Memory表至少比MyISAM表要 快一个数量级 。</p> 
<p>MEMORY 表的<code>大小是受到限制</code>的。表的大小主要取决于两个参数，分别是<code>max_rows 和 max_heap_table_size</code>。其中，max_rows可以在创建时指定；max_heap_table_size的大小默认为16MB，可以按需要进行扩大。</p> 
<p>数据文件与索引文件分开存储。</p> 
<ul><li>每个基于MEMORY存储引擎的表实际对应一个磁盘文件，该文件的文件名与表名相同，类型为frm类型，该文件中只存储表的结构，而其数据文件都是存储在内存中的。</li><li>这样有利于数据的快速处理，提供整个表的处理效率。<br> 缺点：其数据易丢失，生命周期短。基于这个缺陷，选择MEMORY存储引擎时需要特别小心。</li></ul> 
<p><strong>使用Memory存储引擎的场景：</strong></p> 
<p><code>目标数据比较小 </code>，而且非常 <code>频繁的进行访问</code> ，在内存中存放数据，如果太大的数据会造成 内存溢出 。可以通过参数 max_heap_table_size 控制Memory表的大小，限制Memory表的最大的大小。<br> 如果 <code>数据是临时的 ，而且 必须立即可用</code> 得到，那么就可以放在内存中。<br> 存储在Memory表中的数据如果突然间 丢失的话也没有太大的关系 。</p> 
<h2><a id="_225"></a>补充</h2> 
<h3><a id="InnoDB_226"></a>InnoDB表的优势</h3> 
<p>InnoDB存储引擎在实际应用中拥有诸多优势，比如操作便利、提高了数据库的性能、维护成本低等。如果由于硬件或软件的原因导致服务器崩溃，那么在重启服务器之后不需要进行额外的操作。InnoDB崩溃恢复功能自动将之前提交的内容定型，然后撤销没有提交的进程，重启之后继续从崩溃点开始执行。</p> 
<p>InnoDB存储引擎在主内存中维护缓冲池，高频率使用的数据将在内存中直接被处理。这种缓存方式应用于多种信息，加速了处理进程。</p> 
<p>在专用服务器上，物理内存中高达80%的部分被应用于缓冲池。如果需要将数据插入不同的表中，可以设置外键加强数据的完整性。更新或者删除数据，关联数据将会被自动更新或删除。如果试图将数据插入从表，但在主表中没有对应的数据，插入的数据将被自动移除。如果磁盘或内存中的数据出现崩溃，在使用脏数据之前，校验和机制会发出警告。当每个表的主键都设置合理时，与这些列有关的操作会被自动优化。插入、更新和删除操作通过做改变缓冲自动机制进行优化。 <code>InnoDB不仅支持当前读写，也会 缓冲改变的数据到数据流磁盘</code> 。</p> 
<p>InnoDB的性能优势不只存在于长时运行查询的大型表。在同一列多次被查询时，自适应哈希索引会提高查询的速度。使用InnoDB可以压缩表和相关的索引，可以 <code>在不影响性能和可用性的情况下创建或删除索引</code> 。对于大型文本和BLOB数据，使用动态行形式，这种存储布局更高效。通过查询INFORMATION_SCHEMA库中的表可以监控存储引擎的内部工作。在同一个语句中，InnoDB表可以与其他存储引擎表混用。即使有些操作系统限制文件大小为2GB，InnoDB仍然可以处理。 <code>当处理大数据量时， InnoDB兼顾CPU，以达到最大性能 </code>。</p> 
<h3><a id="InnoDBACID_235"></a>InnoDB和ACID模型</h3> 
<p>ACID模型是一系列数据库设计规则，这些规则着重强调可靠性，而可靠性对于商业数据和任务关键型应用非常重要。MySQL包含类似InnoDB存储引擎的组件，与ACID模型紧密相连，这样出现意外时，数据不会崩溃，结果不会失真。如果依赖ACID模型，可以不使用一致性检查和崩溃恢复机制。如果拥有额外的软件保护，极可靠的硬件或者应用可以容忍一小部分的数据丢失和不一致，可以将MySQL设置调整为只依赖部分ACID特性，以达到更高的性能。下面讲解InnoDB存储引擎与ACID模型相同作用的四个方面。</p> 
<ol><li>原子方面 ACID的原子方面主要涉及InnoDB事务，与MySQL相关的特性主要包括：</li></ol> 
<ul><li>自动提交设置。</li><li>COMMIT语句。</li><li>ROLLBACK语句。</li><li>操作INFORMATION_SCHEMA库中的表数据。</li></ul> 
<ol start="2"><li>一致性方面 ACID模型的一致性主要涉及保护数据不崩溃的内部InnoDB处理过程，与MySQL相关的特性<br> 主要包括：</li></ol> 
<ul><li>InnoDB双写缓存。</li><li>InnoDB崩溃恢复。</li></ul> 
<ol start="3"><li>隔离方面 隔离是应用于事务的级别，与MySQL相关的特性主要包括：</li></ol> 
<ul><li>自动提交设置。</li><li>SET ISOLATION LEVEL语句。</li><li>InnoDB锁的低级别信息。</li></ul> 
<ol start="4"><li>耐久性方面 ACID模型的耐久性主要涉及与硬件配置相互影响的MySQL软件特性。由于硬件复杂多样化，耐久性方面没有具体的规则可循。与MySQL相关的特性有：</li></ol> 
<ul><li>InnoDB双写缓存，通过innodb_doublewrite配置项配置。</li><li>配置项innodb_flush_log_at_trx_commit。</li><li>配置项sync_binlog。</li><li>配置项innodb_file_per_table。</li><li>存储设备的写入缓存。</li><li>存储设备的备用电池缓存。</li><li>运行MySQL的操作系统。</li><li>持续的电力供应。</li><li>备份策略。</li><li>对分布式或托管的应用，最主要的在于硬件设备的地点以及网络情况。</li></ul> 
<h3><a id="InnoDB_267"></a>InnoDB架构</h3> 
<ol><li> <p>缓冲池 缓冲池是主内存中的一部分空间，用来缓存已使用的表和索引数据。缓冲池使得经常被使用的数据能够直接在内存中获得，从而提高速度。</p> </li><li> <p>更改缓存 更改缓存是一个特殊的数据结构，当受影响的索引页不在缓存中时，更改缓存会缓存辅助索引页的更改。索引页被其他读取操作时会加载到缓存池，缓存的更改内容就会被合并。不同于集群索引，辅助索引并非独一无二的。当系统大部分闲置时，清除操作会定期运行，将更新的索引页刷入磁盘。更新缓存合并期间，可能会大大降低查询的性能。在内存中，更新缓存占用一部分InnoDB缓冲池。在磁盘中，更新缓存是系统表空间的一部分。更新缓存的数据类型由innodb_change_buffering配置项管理。</p> </li><li> <p>自适应哈希索引 自适应哈希索引将负载和足够的内存结合起来，使得InnoDB像内存数据库一样运行，不需要降低事务上的性能或可靠性。这个特性通过innodb_adaptive_hash_index选项配置，或者通过-- skip-innodb_adaptive_hash_index命令行在服务启动时关闭。</p> </li><li> <p>重做日志缓存 重做日志缓存存放要放入重做日志的数据。重做日志缓存大小通过innodb_log_buffer_size配置项配置。重做日志缓存会定期地将日志文件刷入磁盘。大型的重做日志缓存使得大型事务能够正常运行而不需要写入磁盘。</p> </li><li> <p>系统表空间 系统表空间包括InnoDB数据字典、双写缓存、更新缓存和撤销日志，同时也包括表和索引数据。多表共享，系统表空间被视为共享表空间。</p> </li><li> <p>双写缓存 双写缓存位于系统表空间中，用于写入从缓存池刷新的数据页。只有在刷新并写入双写缓存后，InnoDB才会将数据页写入合适的位置。</p> </li><li> <p>撤销日志 撤销日志是一系列与事务相关的撤销记录的集合，包含如何撤销事务最近的更改。如果其他事务要查询原始数据，可以从撤销日志记录中追溯未更改的数据。撤销日志存在于撤销日志片段中，这<br> 些片段包含于回滚片段中。</p> </li><li> <p>每个表一个文件的表空间 每个表一个文件的表空间是指每个单独的表空间创建在自身的数据文件中，而不是系统表空间中。这个功能通过innodb_file_per_table配置项开启。每个表空间由一个单独的.ibd数<br> 据文件代表，该文件默认被创建在数据库目录中。</p> </li><li> <p>通用表空间 使用CREATE TABLESPACE语法创建共享的InnoDB表空间。通用表空间可以创建在MySQL数据目录之外能够管理多个表并支持所有行格式的表。</p> </li><li> <p>撤销表空间 撤销表空间由一个或多个包含撤销日志的文件组成。撤销表空间的数量由innodb_undo_tablespaces配置项配置。</p> </li><li> <p>临时表空间 用户创建的临时表空间和基于磁盘的内部临时表都创建于临时表空间。innodb_temp_data_file_path配置项定义了相关的路径、名称、大小和属性。如果该值为空，默认会在innodb_data_home_dir变量指定的目录下创建一个自动扩展的数据文件。</p> </li><li> <p>重做日志 重做日志是基于磁盘的数据结构，在崩溃恢复期间使用，用来纠正数据。正常操作期间，重做日志会将请求数据进行编码，这些请求会改变InnoDB表数据。遇到意外崩溃后，未完成的更改会自动在初始化期间重新进行。</p> </li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/38a184a27528b2fe17f1a60eb0d52292/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">遥遥领先一键导出微信小程序、UNIAPP低代码源码使用介绍</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e04b37ea197bc9e5a479ab967d2e38ae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">浅谈四种线程池</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>