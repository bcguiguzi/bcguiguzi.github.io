<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql存储引擎 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql存储引擎" />
<meta property="og:description" content="1.存储引擎 1.1 mysql体系结构 连接层 最上层是一些客户端和链接服务，包含本地sock通信和大多数基于客户端/服务端工具实现的类似于TCP/IP的通信，主要完成一些类似于连接处理，授权认证，及相关的安全方案。在该层上引入了线程池的概念，为通过认证安全接入的客户端提供线程。同样在该层上可以实现基于SSL的安全链接。服务器也会为安全接入的每个客户端验证它所具有的操作权限。
服务层 第二层架构主要完成大多数的核心服务功能，如SQL接口，并完成缓存的查询，SQL的分析和优化，部分内置函数的执行。所有跨存储引擎的功能也在这一层实现，如
过程，函数等，在该层，服务器会解析查询并创建相应的内部解析树，并对其完成相应的优化如确定表的查询的顺序，是否利用索引等，最后生成相应的执行操作。如果是select语句，服务器还会查询内部的缓存，如果缓存空间足够大，这样在解决大量读操作的环境中能够很好的提升系统性能
引擎层
存储引擎层，存储引擎真正的负责了Mysql中数据的存储和提取，服务器通过API和存储引擎进行通信，不同的存储引擎具有不同的功能，这样我们可以根据自己的需要，来选取合适的存储引擎。数据库中的索引是在存储引擎层实现的。
存储层
数据存储层，主要是将数据（如：redolog,undolog,数据，索引，二进制日志，错误日志，查询日志，慢查询日志等）存储在文件系统上，并完成与存储引擎的交互
和其它数据库相比，Mysql有点与众不同，它的架构可以在多种不同场景中应用并发挥良好作用。主要体现在存储引擎上，插件式的存储引擎架构，将查询处理和其它的系统任务以及数据的存储提取分离。这种架构可以根据业务的需求和实际需要选择合适的存储引擎。
1.2 存储引擎介绍 存储引擎就是存储数据，建立索引，更新/查询数据等技术的实现方式。存储引擎是基于表的，而不是基于库的，所以存储引擎也可被称为表类型。我们可以在创建表的时候，来指定选择的存储引擎，如果没有指定将自动选择默认的存储引擎
1）建表时指定存储引擎
CREATE TABLE 表名( 字段1 字段1类型 [ COMMENT 字段1注释 ] , ...... 字段n 字段n类型 [COMMENT 字段n注释 ] ) ENGINE = INNODB [ COMMENT 表注释 ] ; 查询当前数据库支持的存储引擎 show engines;
示例演示：
A.查询建表语句 ------ 默认存储引擎：InnoDB
show create table accout;
我们可以看到，创建表时，即使我们没有指定存储引擎，数据库也会自动选择默认存储引擎
B.查询数据库支持的存储引擎
show engines;
C. 创建表 my_myisam，并指定MyISAM存储引擎
create table my_myisam( id int, name varchar(10) ) engine = MyISAM ; D." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/f264f59d823bd78e05aa22679f4940c6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-13T17:21:10+08:00" />
<meta property="article:modified_time" content="2024-03-13T17:21:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql存储引擎</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1_0"></a>1.存储引擎</h2> 
<h3><a id="11_mysql_1"></a>1.1 mysql体系结构</h3> 
<p><img src="https://images2.imgbox.com/20/3f/Ypb6NGVB_o.png" alt="在这里插入图片描述"></p> 
<ol><li>连接层</li></ol> 
<blockquote> 
 <p>最上层是一些客户端和链接服务，包含本地sock通信和大多数基于客户端/服务端工具实现的类似于TCP/IP的通信，主要完成一些类似于连接处理，授权认证，及相关的安全方案。在该层上引入了线程池的概念，为通过认证安全接入的客户端提供线程。同样在该层上可以实现基于SSL的安全链接。服务器也会为安全接入的每个客户端验证它所具有的操作权限。</p> 
</blockquote> 
<ol start="2"><li>服务层</li></ol> 
<blockquote> 
 <p>第二层架构主要完成大多数的核心服务功能，如SQL接口，并完成缓存的查询，SQL的分析和优化，部分内置函数的执行。所有跨存储引擎的功能也在这一层实现，如<br> 过程，函数等，在该层，服务器会解析查询并创建相应的内部解析树，并对其完成相应的优化如确定表的查询的顺序，是否利用索引等，最后生成相应的执行操作。如果是select语句，服务器还会查询内部的缓存，如果缓存空间足够大，这样在解决大量读操作的环境中能够很好的提升系统性能</p> 
</blockquote> 
<ol start="3"><li> <p>引擎层<br> 存储引擎层，存储引擎真正的负责了Mysql中数据的存储和提取，服务器通过API和存储引擎进行通信，不同的存储引擎具有不同的功能，这样我们可以根据自己的需要，来选取合适的存储引擎。数据库中的索引是在存储引擎层实现的。</p> </li><li> <p>存储层</p> </li></ol> 
<blockquote> 
 <p>数据存储层，主要是将数据（如：redolog,undolog,数据，索引，二进制日志，错误日志，查询日志，慢查询日志等）存储在文件系统上，并完成与存储引擎的交互</p> 
</blockquote> 
<p>和其它数据库相比，Mysql有点与众不同，它的架构可以在多种不同场景中应用并发挥良好作用。主要体现在存储引擎上，插件式的存储引擎架构，将查询处理和其它的系统任务以及数据的存储提取分离。这种架构可以根据业务的需求和实际需要选择合适的存储引擎。</p> 
<h3><a id="12__19"></a>1.2 存储引擎介绍</h3> 
<blockquote> 
 <p>存储引擎就是存储数据，建立索引，更新/查询数据等技术的实现方式。存储引擎是基于表的，而不是基于库的，所以存储引擎也可被称为表类型。我们可以在创建表的时候，来指定选择的存储引擎，如果没有指定将自动选择默认的存储引擎</p> 
</blockquote> 
<p>1）建表时指定存储引擎</p> 
<pre><code class="prism language-java"><span class="token constant">CREATE</span> <span class="token constant">TABLE</span> 表名<span class="token punctuation">(</span>
字段<span class="token number">1</span> 字段<span class="token number">1</span>类型 <span class="token punctuation">[</span> <span class="token constant">COMMENT</span> 字段<span class="token number">1</span>注释 <span class="token punctuation">]</span> <span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
字段n 字段n类型 <span class="token punctuation">[</span><span class="token constant">COMMENT</span> 字段n注释 <span class="token punctuation">]</span>
<span class="token punctuation">)</span> <span class="token constant">ENGINE</span> <span class="token operator">=</span> <span class="token constant">INNODB</span> <span class="token punctuation">[</span> <span class="token constant">COMMENT</span> 表注释 <span class="token punctuation">]</span> <span class="token punctuation">;</span>
</code></pre> 
<ol start="2"><li>查询当前数据库支持的存储引擎</li></ol> 
<blockquote> 
 <p>show engines;</p> 
</blockquote> 
<p>示例演示：<br> A.查询建表语句 ------ 默认存储引擎：InnoDB</p> 
<blockquote> 
 <p>show create table accout;</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/0f/a8/xBhLf0Yj_o.png" alt="在这里插入图片描述"><br> 我们可以看到，创建表时，即使我们没有指定存储引擎，数据库也会自动选择默认存储引擎</p> 
<p>B.查询数据库支持的存储引擎</p> 
<blockquote> 
 <p>show engines;</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/54/bc/1Ag1KpzB_o.png" alt="在这里插入图片描述"></p> 
<p>C. 创建表 my_myisam，并指定MyISAM存储引擎</p> 
<pre><code class="prism language-java">create table <span class="token function">my_myisam</span><span class="token punctuation">(</span>
id <span class="token keyword">int</span><span class="token punctuation">,</span>
name <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> engine <span class="token operator">=</span> <span class="token class-name">MyISAM</span> <span class="token punctuation">;</span>
</code></pre> 
<p>D. 创建表 my_memory，指定Memory存储引擎</p> 
<pre><code class="prism language-java">create table <span class="token function">my_memory</span><span class="token punctuation">(</span>
id <span class="token keyword">int</span><span class="token punctuation">,</span>
name <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> engine <span class="token operator">=</span> <span class="token class-name">Memory</span> <span class="token punctuation">;</span>
</code></pre> 
<h3><a id="13__68"></a>1.3 存储引擎特点</h3> 
<h4><a id="131_InnoDB_70"></a>1.3.1 InnoDB</h4> 
<p>1）介绍<br> InnoDB是一种兼顾高可靠性和高性能的通用引擎，在MySQL 5.5之后，InnoDB是默认的Mysql存储引擎</p> 
<p>2）特点</p> 
<ul><li>DML操作遵循ACID模型，支持事务</li><li>行级锁，提高并发访问性能</li><li>支持外键FOREIGN KEY约束，保证数据的完整性和正确性</li></ul> 
<p>3）文件<br> xxx.ibd: xxx代表的是表名，innoDB引擎的每张表都会对应这样一个表空间文件，存储该表的表结构（frm-早期的，sdi-新版的），数据和索引<br> 参数：innodb_file_per_table</p> 
<blockquote> 
 <p>show variables like ‘innodb_file_per_table’;<br> <img src="https://images2.imgbox.com/1e/c3/7qq11JMk_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>如果该参数开启，代表对于InnoDB引擎的表，每一张表都对应一个ibd文件。我们直接打开mysql的数据存放目录：C:\ProgramData\MySQL\MySQL Server 8.0\Data ，这个目录下有很多文件夹，不同的文件夹代表不同的数据库，我们直接打开itcast文件夹</p> 
<p><img src="https://images2.imgbox.com/4d/df/67tDJdpZ_o.png" alt="在这里插入图片描述"><br> 可以看到里面有很多ibd文件，每一个ibd文件都对应一张表，比如：我们有一张表account，就有这样的一个account.ibd文件，而在这个ibd文件种不仅存放表结构，数据，还会存放该表对应的索引信息。而该文件是基于二进制存储的，不能直接基于记事本打开，我们可以使用mysql提供一个指令ibd2sdi，通过该指令就可以从ibd文件种提取sdi信息，而sdi数据字典信息种就包含该表的表结构</p> 
<p><img src="https://images2.imgbox.com/28/c6/Vyc1KYtG_o.png" alt="在这里插入图片描述"></p> 
<p>4）逻辑存储结构<br> <img src="https://images2.imgbox.com/5a/54/e6yI1WTm_o.png" alt="在这里插入图片描述"></p> 
<ul><li>表空间： InnoDB存储引擎逻辑结构的最高层，ibd文件其实就是表空间文件，在表空间种可以包含多个Segment段</li><li>段 : 表空间是由各个段组成的， 常见的段有数据段、索引段、回滚段等。InnoDB中对于段的管<br> 理，都是引擎自身完成，不需要人为对其控制，一个段中包含多个区。</li><li>区 : 区是表空间的单元结构，每个区的大小为1M。 默认情况下， InnoDB存储引擎页大小为<br> 16K， 即一个区中一共有64个连续的页。</li><li>页 : 页是组成区的最小单元，页也是InnoDB 存储引擎磁盘管理的最小单元，每个页的大小默<br> 认为 16KB。为了保证页的连续性，InnoDB 存储引擎每次从磁盘申请 4-5 个区。</li><li>行 : InnoDB 存储引擎是面向行的，也就是说数据是按行进行存放的，在每一行中除了定义表时<br> 所指定的字段以外，还包含两个隐藏字段(后面会详细介绍)。</li></ul> 
<h4><a id="132_MyISAM_109"></a>1.3.2 MyISAM</h4> 
<ol><li>介绍</li></ol> 
<blockquote> 
 <p>MyISAM是Mysql早期的默认存储引擎。</p> 
</blockquote> 
<p>2）特点</p> 
<blockquote> 
 <p>不支持事务，不支持外键<br> 支持表锁，不支持行锁<br> 访问速度快</p> 
</blockquote> 
<p>3）文件</p> 
<blockquote> 
 <p>xxx.sdi：存储表结构信息<br> xxx.MYD: 存储数据<br> xxx.MYI: 存储索引<br> <img src="https://images2.imgbox.com/93/96/95OImQJv_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<h4><a id="133_Memory_127"></a>1.3.3 Memory</h4> 
<p>1） 介绍</p> 
<blockquote> 
 <p>Memory 引擎的表数据时在存储种的，由于收到硬件问题，或断电问题的影响，只能将这些表作为临时表或缓存使用</p> 
</blockquote> 
<p>2）特点<br> 内存存放<br> hash索引（默认）</p> 
<p>3）文件</p> 
<blockquote> 
 <p>xxx.sdi：存储表结构信息</p> 
</blockquote> 
<h4><a id="134__141"></a>1.3.4 区别及特点</h4> 
<p><img src="https://images2.imgbox.com/98/39/ndajkqtn_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_144"></a>面试题:</h4> 
<p>InnoDB引擎与MyISAM引擎的区别 ?<br> ①. InnoDB引擎, 支持事务, 而MyISAM不支持。<br> ②. InnoDB引擎, 支持行锁和表锁, 而MyISAM仅支持表锁, 不支持行锁。<br> ③. InnoDB引擎, 支持外键, 而MyISAM是不支持的。</p> 
<h3><a id="14__150"></a>1.4 存储引擎选择</h3> 
<p>在选择存储引擎时，应该根据应用系统的特点选择合适的存储引擎。对于复杂的应用系统，还可以根据<br> 实际情况选择多种存储引擎进行组合。</p> 
<ul><li>InnoDB: 是Mysql的默认存储引擎，支持事务、外键。如果应用对事务的完整性有比较高的要<br> 求，在并发条件下要求数据的一致性，数据操作除了插入和查询之外，还包含很多的更新、删除操<br> 作，那么InnoDB存储引擎是比较合适的选择。</li><li>MyISAM ： 如果应用是以读操作和插入操作为主，只有很少的更新和删除操作，并且对事务的完<br> 整性、并发性要求不是很高，那么选择这个存储引擎是非常合适的。</li><li>MEMORY：将所有数据保存在内存中，访问速度快，通常用于临时表及缓存。MEMORY的缺陷就是<br> 对表的大小有限制，太大的表无法缓存在内存中，而且无法保障数据的安全性。</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/512b0a4cc8155cbb8c82a149795a663d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Jtti：如何在CentOS中安装和配置Tomcat应用服务器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7ae00729b859a231f4611c9d3e9539ce/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">分享 | 计算机组成与设计学习资料&#43;CPU设计源码&#43;实验报告</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>