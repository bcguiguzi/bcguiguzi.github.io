<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>离线安装samba与配置（.tar方式安装） - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="离线安装samba与配置（.tar方式安装）" />
<meta property="og:description" content="一、samba离线安装
【安装并设置成功后，相关文件及其位置：
①smbd：/usr/local/samba/sbin/smbd
②nmdb：/usr/local/samba/sbin/nmbd
③配置文件 smb.conf：/usr/local/samba/lib/smb.conf
④添加用户的 smbpasswd 文件：/usr/local/samba/bin/smbpasswd
⑤测试文件 testparm：/usr/local/samba/bin/testparm】
1、下载安装包：samba-3.2.0.tar.gz
百度云方式：链接：https://pan.baidu.com/s/19QnUcdLbxdTyqEkDB3C80g
提取码：kmh4
2、将下载好的 samba-3.2.0.tar.gz 压缩包传到服务器上
3、在压缩包所在路径下依次执行以下命令：
tar zxvf samba-3.2.0.tar.gz cd samba-3.2.0/source # 进入解压后目录的子目录source,因为代码在里面 ./configure # 我们不使用--prefix参数,因为它默认安装到/usr/local/samba make make install 运行完后就可以见到在 /usr/local/samba 目录下生成的文件：
4、将原来解压的目录的子目录 examples 中的 smb.conf.default 配置文件复制到上面的lib目录中去（记得把.default去掉）
cp /home/cqf/samba-3.2.0/examples/smb.conf.default /usr/local/samba/lib/smb.conf 在 /etc/ld.so.conf 的文件中加入一行 /usr/local/samba/lib
因为：tar安装时没有在系统的库文件中指定刚才安装的samba服务器的库路径
6、运行 ldconfig 命令更新库文件：
ldconfig 7、启动samba：（.tar安装方式，启动不能使用命令：systemctl status smbd / systemctl status nmbd / systemctl restart smbd）
/usr/local/samba/sbin/smbd -D /usr/local/samba/sbin/nmbd -D 正常情况，启动命令之后不会有任何提示。
如图：
8、运行以下命令测试是否安装成功：testparm" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/54086d21892c37a623c78d4d31ee765e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-02T11:02:24+08:00" />
<meta property="article:modified_time" content="2023-03-02T11:02:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">离线安装samba与配置（.tar方式安装）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <p style="">一、samba离线安装</p> 
 <p style="">【安装并设置成功后，相关文件及其位置：</p> 
 <p style="">  ①smbd：/usr/local/samba/sbin/smbd</p> 
 <p style="">  ②nmdb：/usr/local/samba/sbin/nmbd</p> 
 <p style="">  ③配置文件 smb.conf：/usr/local/samba/lib/smb.conf</p> 
 <p style="">  ④添加用户的 smbpasswd 文件：/usr/local/samba/bin/smbpasswd</p> 
 <p style="">  ⑤测试文件 testparm：/usr/local/samba/bin/testparm】</p> 
 <p style="">1、下载安装包：samba-3.2.0.tar.gz</p> 
 <p style="">  百度云方式：链接：<a class="kdocs-link" style="color:#0A6CFF;" href="https://pan.baidu.com/s/19QnUcdLbxdTyqEkDB3C80g" rel="nofollow noopener noreferrer" target="_blank">https://pan.baidu.com/s/19QnUcdLbxdTyqEkDB3C80g</a></p> 
 <p style="">        提取码：kmh4</p> 
 <p style="">2、将下载好的 samba-3.2.0.tar.gz 压缩包传到服务器上</p> 
 <p style="">3、在压缩包所在路径下依次执行以下命令：</p> 
 <pre class="kdocs-bash"><code class="language-bash">tar zxvf     samba-3.2.0.tar.gz
cd samba-3.2.0/source     # 进入解压后目录的子目录source,因为代码在里面
./configure       # 我们不使用--prefix参数,因为它默认安装到/usr/local/samba
make
make install
</code></pre> 
 <p style="">运行完后就可以见到在 /usr/local/samba 目录下生成的文件：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:414px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:50.966183%;height:0;"> 
    <img src="https://images2.imgbox.com/70/52/EGS3mG4U_o.png" style="margin-left:;display:block;width:414px;margin-top:-50.966183%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">4、将原来解压的目录的子目录 examples 中的 smb.conf.default 配置文件复制到上面的lib目录中去（记得把.default去掉）</p> 
 <pre class="kdocs-bash"><code class="language-bash">cp /home/cqf/samba-3.2.0/examples/smb.conf.default /usr/local/samba/lib/smb.conf</code></pre> 
 <ol start="1"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>在 /etc/ld.so.conf 的文件中加入一行 /usr/local/samba/lib</p></li></ol> 
 <p style=""></p> 
 <p style="">因为：tar安装时没有在系统的库文件中指定刚才安装的samba服务器的库路径</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:318px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:45.28302%;height:0;"> 
    <img src="https://images2.imgbox.com/75/86/IRzPtaku_o.png" style="margin-left:;display:block;width:318px;margin-top:-45.28302%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">6、运行 ldconfig 命令更新库文件：</p> 
 <pre class="kdocs-bash"><code class="language-bash">ldconfig</code></pre> 
 <p style="text-align:null;">7、启动samba：（.tar安装方式，启动不能使用命令：systemctl status smbd / systemctl status nmbd / systemctl restart smbd）</p> 
 <pre class="kdocs-bash"><code class="language-bash">/usr/local/samba/sbin/smbd -D
/usr/local/samba/sbin/nmbd -D</code></pre> 
 <p style="">正常情况，启动命令之后不会有任何提示。</p> 
 <p style="">如图：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:25.0%;height:0;"> 
    <img src="https://images2.imgbox.com/f8/03/HqKsAO5U_o.png" style="margin-left:;display:block;width:740px;margin-top:-25.0%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">8、运行以下命令测试是否安装成功：testparm</p> 
 <pre class="kdocs-bash"><code class="language-bash">(base) root@152server:/home/cqf# /usr/local/samba/bin/testparm
Load smb config files from /usr/local/samba/lib/smb.conf
Processing section "[homes]"
Processing section "[printers]"
Processing section "[myshare]"
Loaded services file OK.
Server role: ROLE_STANDALONE
Press enter to see a dump of your service definitions

[global]
        server string = Samba Server
        log file = /usr/local/samba/var/log.%m
        max log size = 50
        dns proxy = No

[homes]
        comment = Home Directories
        read only = No
        browseable = No

[printers]
        comment = All Printers
        path = /usr/spool/samba
        printable = Yes
        browseable = No

[myshare]
        comment = partment share
        path = /share
        valid users = share_user
        read only = No

</code></pre> 
 <p style="">9、使用ps命令查看smbd和nmbd进行是否存在</p> 
 <pre class="kdocs-bash"><code class="language-bash">ps auxf | grep smbd
ps auxf | grep nmbd</code></pre> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:31.756756%;height:0;"> 
    <img src="https://images2.imgbox.com/c5/b5/pFyed1HI_o.png" style="margin-left:;display:block;width:740px;margin-top:-31.756756%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">9、可以通过杀死进程以停止服务，如</p> 
 <pre class="kdocs-bash"><code class="language-bash">kill -9 4157399 4157400</code></pre> 
 <h2 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">二、配置 samba，进行</span><a class="kdocs-link" style="color:#0A6CFF;" href="https://so.csdn.net/so/search?q=%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer"><span class="kdocs-bold" style="font-weight:bold;">共享文件夹</span></a><span class="kdocs-bold" style="font-weight:bold;">访问</span></h2> 
 <p style="text-align:null;">1、添加Ubuntu用户：默认情况下，Samba将用户设置为安全模式，这意味着客户端必须输入共享文件夹的用户名和密码（添加的samba用户，必须首先是linux(Ubuntu)下面的用户）</p> 
 <pre class="kdocs-bash"><code class="language-bash">sudo adduser share_user</code></pre> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:451px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:56.984478%;height:0;"> 
    <img src="https://images2.imgbox.com/d8/7d/xStsn5sQ_o.png" style="margin-left:;display:block;width:451px;margin-top:-56.984478%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">2将Ubuntu用户添加到samba用户，并设置该用户 samba 密码</p> 
 <pre class="kdocs-bash"><code class="language-bash">(base) root@152server:/home/cqf# /usr/local/samba/bin/smbpasswd -a share_user
New SMB password:
Retype new SMB password:
Added user share_user.
(base) root@152server:/home/cqf# 
</code></pre> 
 <p style="">3、修改samba配置文件</p> 
 <pre class="kdocs-bash"><code class="language-bash">vi /usr/local/samba/lib/smb.conf</code></pre> 
 <p style="">确保工作组的值与Windows计算机的工作组设置相同；</p> 
 <p style=""><span class="kdocs-italic" style="font-style:italic;">部分重要配置文件解释：</span></p> 
 <pre class="kdocs-bash"><code class="language-bash">myshare] # 是将在Windows网络上显示的文件夹名称
   comment = partment share
   path = /share # 是该 myshare 文件夹在Ubuntu上实际存储路径
   browseable = yes
   writable = yes
   # guest ok = yes   # guest ok = yes表示任何用户都有权限  无需用户名密码
   valid users = share_user  # users只能取系统adduser的用户  否则会创建失败
</code></pre> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:584px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:26.369864%;height:0;"> 
    <img src="https://images2.imgbox.com/df/5d/Saz2hQye_o.png" style="margin-left:;display:block;width:584px;margin-top:-26.369864%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:355px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:93.23944%;height:0;"> 
    <img src="https://images2.imgbox.com/34/00/eOPuXkao_o.png" style="margin-left:;display:block;width:355px;margin-top:-93.23944%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
 <p style=""></p> 
 <p style="">注意：</p> 
 <p style="">【配置文件中 path 指定的路径不存在时需要手动创建，</p> 
 <p style=""> 否则windows访问 myshare 文件夹时会提示 192.168.00.111”存在，但 Windows 无法找到“my_share”】</p> 
 <p style="">【windows连接时，Ubuntu的防火墙开启的话，需要开放 445 端口，并为windows用户开启445访问权限。</p> 
 <p style=""> 具体操作参考<a class="kdocs-link" style="color:#0A6CFF;" href="https://blog.csdn.net/lucky_chaichai/article/details/117323715" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/lucky_chaichai/article/details/117323715</a>】</p> 
 <p style="">安装参考博客：<a class="kdocs-link" style="color:#0A6CFF;" href="https://blog.csdn.net/zhongguoren666/article/details/7027211" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/zhongguoren666/article/details/7027211</a></p> 
 <p style="">相关配置参考：<a class="kdocs-link" style="color:#0A6CFF;" href="https://www.linuxidc.com/Linux/2017-11/148194.htm" rel="nofollow noopener noreferrer" target="_blank">https://www.linuxidc.com/Linux/2017-11/148194.htm</a></p> 
 <p style=""></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b34863db804f8684d2a56a20cf974045/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">计算机网络常用命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4c8af06601dcf0a42688674417006c81/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">scipy.misc包中的toimage和fromimage</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>