<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>自定义MVC应用（通用增删改查） - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="自定义MVC应用（通用增删改查）" />
<meta property="og:description" content="前言：上一次与大家分享了自定义MVC框架的创造过程，今天紧接要对自己创造的自定义MVC应用。 一、优化web.xml文件： 1、我们自己创造的自定义MVC框架最终目的归根结底是要导出变成jar包，以后自己使用，方便代码，节约时间。那么将自己创造的自定义MVC框架导出后，其中的.xml文件内容就看不到了，而在这里就要对.xml文件进行优化。 2、思路： 2.1、在中央控制器中注释与浏览器联系的语句。 2.2、新建一个source folder文件夹（注意此文件与src资源文件夹是并列关系，其中千万要注意不要建成package包，如下图所示，如果不按上述建并列资源文件夹，就会报空指针异常）图中整个web项目报错是因为我把其中一个没用的jar包给删除了，所以报错，但是对整个项目毫无影响，可以运行出结果。 2.3、新建资源文件夹ZJ.xml中写好之前config.xml文件中内容， 2.4、在中央控制器中写好建模的代码： public void init() throws ServletException { // actions.put(&#34;/book&#34;, new BookAction()); // actions.put(&#34;/goods&#34;, new GoodsAction()); try { String configurationLocation = this.getInitParameter(&#34;configurationLocation&#34;); if (StringUtils.isNotBlank(configurationLocation)) { configModel = ConfigModelFactory.build(configurationLocation); } else { configModel = ConfigModelFactory.build(); } } catch (Exception e) { e.printStackTrace(); } } 运行效果（隐藏之前的config.xml文件之后的运行效果）：其中book中的属性为null值，是因为没有在视图层加数据 由上述结果得出：优化.xml文件配置成功。 二：通用的增删改查： 思路：1、首先在basedao中写好增删改的通用方法（查询要进行分页) public void excuteUpdate(String sql, T t,String[] attrs) throws Exception { Connection con = DBAccess.getConnection(); PreparedStatement ps = con." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/8415ecf0dd0cd2eac6681062451de889/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-06T11:16:08+08:00" />
<meta property="article:modified_time" content="2023-04-06T11:16:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">自定义MVC应用（通用增删改查）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>前言：上一次与大家分享了自定义MVC框架的创造过程，今天紧接要对自己创造的自定义MVC应用。</h2> 
<h3>一、优化web.xml文件：</h3> 
<h4>          1、我们自己创造的自定义MVC框架最终目的归根结底是要导出变成jar包，以后自己使用，方便代码，节约时间。那么将自己创造的自定义MVC框架导出后，其中的.xml文件内容就看不到了，而在这里就要对.xml文件进行优化。</h4> 
<h4>          2、思路：</h4> 
<h4>                        2.1、在中央控制器中注释与浏览器联系的语句。</h4> 
<h4>                        2.2、新建一个source folder文件夹（注意此文件与src资源文件夹是并列关系，其中千万要注意不要建成package包，如下图所示，如果不按上述建并列资源文件夹，就会报<span style="color:#fe2c24;">空指针异常</span><span style="color:#0d0016;">）图中整个web项目报错是因为我把其中一个没用的jar包给删除了，所以报错，但是对整个项目毫无影响，可以运行出结果。</span></h4> 
<h4><img alt="" height="528" src="https://images2.imgbox.com/5e/a5/lTNXfqM3_o.png" width="1200">                         <strong>2.3、新建资源文件夹ZJ.xml中写好之前config.xml文件中内容，</strong></h4> 
<p><img alt="" height="596" src="https://images2.imgbox.com/2a/d9/qL9pCVKI_o.png" width="1200"></p> 
<h4>                          2.4、在中央控制器中写好建模的代码：</h4> 
<pre><code>public void init() throws ServletException {
		// actions.put("/book", new BookAction());
		// actions.put("/goods", new GoodsAction());
		try {
			String configurationLocation = this.getInitParameter("configurationLocation");
			if (StringUtils.isNotBlank(configurationLocation)) {
				configModel = ConfigModelFactory.build(configurationLocation);
			} else {
				configModel = ConfigModelFactory.build();
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
		
	}</code></pre> 
<h4>      运行效果（隐藏之前的config.xml文件之后的运行效果）：其中book中的属性为null值，是因为没有在视图层加数据 </h4> 
<p><img alt="" height="570" src="https://images2.imgbox.com/07/2e/atsS25KQ_o.png" width="1200"></p> 
<h4>由上述结果得出：优化.xml文件配置成功。</h4> 
<h3>二：通用的增删改查：</h3> 
<h4>         思路：1、首先在basedao中写好增删改的通用方法（查询要进行分页)</h4> 
<pre><code>public void excuteUpdate(String sql, T t,String[] attrs) throws Exception {
		Connection con = DBAccess.getConnection();
		PreparedStatement ps = con.prepareStatement(sql);
		for (int i = 0; i &lt; attrs.length; i++) {
			Field f = t.getClass().getDeclaredField(attrs[i]);
			f.setAccessible(true);
			ps.setObject(i+1, f.get(t));
		}
		ps.executeUpdate();
	}</code></pre> 
<h4>                    2、之后在bookdao继承了basedao包，写好增删改查的方法。</h4> 
<pre><code>public class BookDao extends BaseDao&lt;Book&gt; {

	// 增加方法
	public void add(Book book) throws Exception {
		String sql = "insert into t_mvc_book values(?,?,?)";
		super.excuteUpdate(sql, book, new String[] {"bid", "bname", "price"});
	}
	
//	public void add(Book book) throws Exception {
//		String sql = "insert into t_mvc_book values(3333,'xxx',121)";
//		super.excuteUpdate(sql, book, new String[] { });
//	}

	// 删除方法
	public void delete(Book book) throws Exception {
		String sql = "delete from t_mvc_book where bid=?";
		super.excuteUpdate(sql, book, new String[] { "bid" });
	}

	// 修改方法
	public void edit(Book book) throws Exception {
		String sql = "update t_mvc_book set bname=?,price=? where bid=? ";
		super.excuteUpdate(sql, book, new String[] { "bname", "price", "bid", });
	}

	// 查询方法
	public List&lt;Book&gt; list(Book book, PageBean pagebean) throws Exception {
		String sql = "select * from t_mvc_book where 1=1";
		String bname = book.getBname();
		if (StringUtils.isNotBlank(bname)) {
			sql += "and bname like '%" + bname + "%'";
		}
		return super.excuteQuery(sql, Book.class, pagebean);
	}</code></pre> 
<h4>             3、然后在bookaction中写好对应的方法：</h4> 
<pre><code>public class BookAction extends ActionSupport implements ModelDriver&lt;Book&gt;{
	Book book=new Book();
	BookDao bd=new BookDao();
	
	@Override
	public Book getModel() {
		// TODO Auto-generated method stub
		return book;
	}
	
	
	
	
	/**
	 * 增删改查最终都要跳回查询界面
	 * 查询：bookList.jsp  返回值：list
	 * 增删改确定：book.action？methodName=list  返回值：toList
	 * 增加修改跳转对应的界面：bookEdit.jsp  返回值是toEdit
	 * @throws Exception 
	 */
	public String add(HttpServletRequest req,HttpServletResponse resp)  {
		try {
			bd.add(book);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return "toList";
	}
	
	public String delete(HttpServletRequest req,HttpServletResponse resp)  {
		try {
			bd.delete(book);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return "toList";
	}
	
	
	public String edit(HttpServletRequest req,HttpServletResponse resp)  {
		try {
			bd.edit(book);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return "toList";
	}
	
	
	public String list(HttpServletRequest req,HttpServletResponse resp)  {
		try {
			PageBean pageBean=new PageBean();
			pageBean.setRequest(req);
			List&lt;Book&gt; list=bd.list(book, pageBean);
			req.setAttribute("books", list);
			req.setAttribute("pageBean", pageBean);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return "list";
	}
	
	public String toEdit(HttpServletRequest req,HttpServletResponse resp)  {
		try {
			if(book.getBid()!=0) {
				List&lt;Book&gt; list=bd.list(book, null);
				req.setAttribute("b", list.get(0));
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
		return "toEdit";
	}
	</code></pre> 
<h4>                4、 测试代码：</h4> 
<pre><code>public static void main(String[] args) throws Exception {
		Book b = new Book();
		b.setBid(5555);
		b.setBname("test");
		b.setPrice(111f);
		BookDao bd = new BookDao();
		bd.add(b);
	}</code></pre> 
<h4>                5、测试结果：（有数据说明增删改查方法正确）</h4> 
<h4>                             增加： </h4> 
<p><img alt="" height="588" src="https://images2.imgbox.com/c0/50/TMuqDD5m_o.png" width="1186"></p> 
<h4>                              修改： </h4> 
<pre><code>	public static void main(String[] args) throws Exception {
		Book b = new Book();
		b.setBid(5555);
		b.setBname("test222");
		b.setPrice(111f);
		BookDao bd = new BookDao();
		bd.edit(b);
	}</code></pre> 
<h4>                           运行结果：</h4> 
<p><img alt="" height="568" src="https://images2.imgbox.com/2f/6c/p96VTli7_o.png" width="1200"></p> 
<h3> 三：自定义MVC框架具体体现：</h3> 
<h4>          1、使用自定义MVC的步骤：</h4> 
<h4>                 1.1、导入自己导出的自定义MVC.jar包</h4> 
<h4>                 1.2、做好框架的相应配置(导入之前MVC.jar包依赖的jar包)</h4> 
<h4>                 1.3 、一切照旧 （jsp界面，bookaction、dao层、entity）</h4> 
<h4>          2、通用增删改查的区别与相同：<br>                  2.1共同点：增删改查最终都要跳回查询界面<br>                  2.2不同点：2.2.1:查询：bookList.jsp  返回值：list<br>                                     2.2.2:增删改确定：book.action？methodName=list  返回值：toList<br>                                     2.2.3增加修改跳转对应的界面：bookEdit.jsp  返回值是toEdit</h4> 
<h4>          3、展示效果：</h4> 
<h4>               整体项目包展览： </h4> 
<p><img alt="" height="606" src="https://images2.imgbox.com/91/5e/VZ8sxODt_o.png" width="1200"></p> 
<h4>          3.1界面展示： jsp界面：</h4> 
<h4>                   1、bookList界面：</h4> 
<pre><code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%&gt;
&lt;%@ taglib uri="http://jsp.veryedu.cn" prefix="z"%&gt;
&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
&lt;link
	href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.css"
	rel="stylesheet"&gt;
&lt;script
	src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.js"&gt;&lt;/script&gt;
&lt;title&gt;书籍列表&lt;/title&gt;
&lt;style type="text/css"&gt;
.page-item input {
	padding: 0;
	width: 40px;
	height: 100%;
	text-align: center;
	margin: 0 6px;
}

.page-item input, .page-item b {
	line-height: 38px;
	float: left;
	font-weight: 400;
}

.page-item.go-input {
	margin: 0 10px;
}
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;form class="form-inline"
		action="${pageContext.request.contextPath }/book.action?methodName=list"
		method="post"&gt;
		&lt;div class="form-group mb-2"&gt;
			&lt;input type="text" class="form-control-plaintext" name="bname"
				placeholder="请输入书籍名称"&gt;
			&lt;!-- 			&lt;input name="rows" value="20" type="hidden"&gt; --&gt;
			&lt;!-- 不想分页 --&gt;
			&lt;input name="pagination" value="false" type="hidden"&gt;
		&lt;/div&gt;
		&lt;button type="submit" class="btn btn-primary mb-2"&gt;查询&lt;/button&gt;
		&lt;a class="btn btn-primary mb-2"
			href="${pageContext.request.contextPath }/book.action?methodName=toEdit"&gt;新增&lt;/a&gt;
	&lt;/form&gt;

	&lt;table class="table table-striped bg-success"&gt;
		&lt;thead&gt;
			&lt;tr&gt;
				&lt;th scope="col"&gt;书籍ID&lt;/th&gt;
				&lt;th scope="col"&gt;书籍名&lt;/th&gt;
				&lt;th scope="col"&gt;价格&lt;/th&gt;
				&lt;th scope="col"&gt;操作&lt;/th&gt;
			&lt;/tr&gt;
		&lt;/thead&gt;
		&lt;tbody&gt;
			&lt;c:forEach var="b" items="${books }"&gt;
				&lt;tr&gt;
					&lt;td&gt;${b.bid }&lt;/td&gt;
					&lt;td&gt;${b.bname }&lt;/td&gt;
					&lt;td&gt;${b.price }&lt;/td&gt;
					&lt;td&gt;&lt;a
						href="${pageContext.request.contextPath }/book.action?methodName=toEdit&amp;bid=${b.bid}"&gt;修改&lt;/a&gt;
						&lt;a
						href="${pageContext.request.contextPath }/book.action?methodName=delete&amp;bid=${b.bid}"&gt;删除&lt;/a&gt;
					&lt;/td&gt;
				&lt;/tr&gt;
			&lt;/c:forEach&gt;
		&lt;/tbody&gt;
	&lt;/table&gt;
	&lt;!-- 这一行代码就相当于前面分页需求前端的几十行了 --&gt;
	&lt;z:page pageBean="${ pageBean}"&gt;&lt;/z:page&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<h4>                   效果展示： </h4> 
<p><img alt="" height="521" src="https://images2.imgbox.com/57/1d/Cuwn8oIj_o.png" width="1200"></p> 
<h4>                  bookEdit界面（增加和修改界面）：</h4> 
<pre><code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%&gt;
&lt;%@ taglib uri="http://jsp.veryedu.cn" prefix="z"%&gt;	
&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%&gt;	
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
&lt;link
	href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.css"
	rel="stylesheet"&gt;
&lt;script
	src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.js"&gt;&lt;/script&gt;
&lt;title&gt;书籍新增/修改&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;form class="form-inline"
		action="${pageContext.request.contextPath }/book.action?methodName=${empty b ? 'add' : 'edit'}" method="post"&gt;
		书籍ID：&lt;input type="text" name="bid" value="${b.bid }"&gt;&lt;br&gt;
		书籍名称：&lt;input type="text" name="bname" value="${b.bname }"&gt;&lt;br&gt;
		书籍价格：&lt;input type="text" name="price" value="${b.price }"&gt;&lt;br&gt;
		&lt;input type="submit"&gt;
	&lt;/form&gt;


&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<h4>                   效果展示：</h4> 
<p><img alt="" height="160" src="https://images2.imgbox.com/76/26/8Jmo8HSl_o.png" width="681"></p> 
<h4>        3.2方法展示效果：</h4> 
<h4>                  3.2.1:增加：</h4> 
<p><img alt="" height="160" src="https://images2.imgbox.com/0b/b7/qtskrZR5_o.png" width="681"></p> 
<h4>                    效果展示：</h4> 
<p><img alt="" height="225" src="https://images2.imgbox.com/6c/d7/q9whRrYS_o.png" width="1200"></p> 
<h4>                  3.2.2:删除：（删除了书籍id为28的书）</h4> 
<p><img alt="" height="518" src="https://images2.imgbox.com/3a/53/C7Enlvh7_o.png" width="1200"></p> 
<h4>                     效果展示： </h4> 
<p><img alt="" height="525" src="https://images2.imgbox.com/e9/f1/dNQFdm3r_o.png" width="1200"></p> 
<h4>                     3.3.3修改：</h4> 
<h4>                             没修改之前的效果： </h4> 
<p><img alt="" height="179" src="https://images2.imgbox.com/0e/b5/pCiNVQjh_o.png" width="1200"></p> 
<h4>                               修改时的操作：</h4> 
<p><img alt="" height="155" src="https://images2.imgbox.com/b8/db/Uwobvj26_o.png" width="790"></p> 
<p> <img alt="" height="160" src="https://images2.imgbox.com/36/a9/Ec8BI9UO_o.png" width="626"></p> 
<h4>                              修改之后的效果：</h4> 
<p><img alt="" height="235" src="https://images2.imgbox.com/0d/51/lNvmVaNw_o.png" width="1200"></p> 
<h4>                      3.3.4:查询和分页：</h4> 
<h4>                                   之前效果：</h4> 
<p><img alt="" height="518" src="https://images2.imgbox.com/82/d4/JPFGYStN_o.png" width="1200"></p> 
<h4>                                     之后效果：在分页栏中，写好要查询的数字，之后按下确定就直接跳转到输入框中的数字的页数。</h4> 
<p><img alt="" height="561" src="https://images2.imgbox.com/56/5b/FJSFmJtx_o.png" width="1200"></p> 
<h3>四：在实践中遇到的两个问题：</h3> 
<h4>         1、第一个是运行项目时没有出现界面，问题出于在编码过滤器中：当时是写了第二行代码（应该只要在编码过滤器写第一行代码），报错，显示不了界面。</h4> 
<pre><code>@WebFilter("*.action")
@WebServlet("*.action")</code></pre> 
<h4>        2、跳转时出现问题：当时引用了之前项目的.xml文件，后来在新项目中，新建了一个包，直接显示找不到此类的问题：</h4> 
<p><img alt="" height="526" src="https://images2.imgbox.com/51/b5/tmRvoR8Q_o.png" width="1200"></p> 
<h3>五：思维导图：</h3> 
<p><img alt="" height="620" src="https://images2.imgbox.com/fc/80/w3X90Dzk_o.png" width="1200"></p> 
<h2>总结： 自定义MVC框架应用中最为关键的是要把自定义MVC框架打造好，其中在应用是也要注意细节，比如：改造.xml文件时要跳转的目的类。</h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/67526e6bcc15d8657224df9cd0bd7493/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">CentOS7设置阿里源</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/780b1e1bd49ebd36a9ab50a60f198643/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">flink任务处理下线流水数据，数据遗漏不全（一）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>