<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ContentProvider&amp;ContentResolver - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ContentProvider&amp;ContentResolver" />
<meta property="og:description" content="什么是ContentProvider 1.ContentProvider是android四大组件之一； 2.ContentProvider是一种数据包装器/发布者，它提供统一的接口对数据进行操作，调用者不用关心数据到底是如何存储的； 3.ContentProvider主要用于不同应用程序间和不同进程间的数据共享。
什么是ContentResolver 1.ContentResolver是数据调用者，ContentProvider将数据发布出来后，通过ContentResolver对象结合Uri进行调用 2.通过ContentResolver可以调用ContentProvider的增，删，改，查操作。
什么是Uri 1.通用资源标识符 2.Uri代表要操作数据的地址。每个ContentProvider发布数据时都有一个唯一的地址。
创建自定义ContentProvider的步骤 1.使用SQLite技术，创建好数据库和数据表； 2.新建类继承ContentProvider； 3.创建UriMatcher，定义Uri规则； 4.重写6个抽象方法（onCreate,insert,delect,getType,update,query）； 5.在AndroidManifest中注册provider； 6.ContentResolver对ContentProvider共享的数据进行增删改查。
代码实例 在之前创建的项目StudentTest基础上进行操作，这个项目里已经创建好数据库student_db和数据表student，StudentTest里只包含一个表格student，所以不需要使用UriMatcher，若项目里不止一张表，那么就需要用到UriMatcher来进行判定了，下面会分别就这两种情况进行讲解。 首先是只有一张student表： 需要创建子类StudentContentProvider继承ContentProvider，一般情况下有两种创建方法： 1.new——&gt;Java class，继承ContentProvider方法，重写6个抽象方法，还需要在AndroidManifest中注册provider； 2.new——&gt;others——&gt;Content Provider，这是创建Content Provider的快捷方法，系统会自动生成继承ContentProvider方法和在AndroidManifest中注册provider。
public class StudentContentProvider extends ContentProvider { public StudentContentProvider() { } @Override public int delete(Uri uri, String selection, String[] selectionArgs) { return 0; } @Override public String getType(Uri uri) { return null; } @Override public Uri insert(Uri uri, ContentValues values) { return null; } @Override public boolean onCreate() { return true; } @Override public Cursor query(Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder) { return null; } @Override public int update(Uri uri, ContentValues values, String selection, String[] selectionArgs) { return 0; } } 发布者ContentProvider已就绪，需要数据调用者ContentResolver，所以新建project(TeacherTest)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/440c3ee459ee30b8dcc5ded8f6605824/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-03-29T20:07:37+08:00" />
<meta property="article:modified_time" content="2018-03-29T20:07:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ContentProvider&amp;ContentResolver</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3 id="什么是contentprovider">什么是ContentProvider</h3> 
<p>1.ContentProvider是android四大组件之一； <br> 2.ContentProvider是一种数据包装器/发布者，它提供统一的接口对数据进行操作，调用者不用关心数据到底是如何存储的； <br> 3.ContentProvider主要用于不同应用程序间和不同进程间的数据共享。</p> 
<h3 id="什么是contentresolver">什么是ContentResolver</h3> 
<p>1.ContentResolver是数据调用者，ContentProvider将数据发布出来后，通过ContentResolver对象结合Uri进行调用 <br> 2.通过ContentResolver可以调用ContentProvider的增，删，改，查操作。</p> 
<h3 id="什么是uri">什么是Uri</h3> 
<p>1.通用资源标识符 <br> 2.Uri代表要操作数据的地址。每个ContentProvider发布数据时都有一个唯一的地址。</p> 
<h3 id="创建自定义contentprovider的步骤">创建自定义ContentProvider的步骤</h3> 
<p>1.使用SQLite技术，创建好数据库和数据表； <br> 2.新建类继承ContentProvider； <br> 3.创建UriMatcher，定义Uri规则； <br> 4.重写6个抽象方法（onCreate,insert,delect,getType,update,query）； <br> 5.在AndroidManifest中注册provider； <br> 6.ContentResolver对ContentProvider共享的数据进行增删改查。</p> 
<h3 id="代码实例">代码实例</h3> 
<p>在之前创建的项目StudentTest基础上进行操作，这个项目里已经创建好数据库student_db和数据表student，StudentTest里只包含一个表格student，所以不需要使用UriMatcher，若项目里不止一张表，那么就需要用到UriMatcher来进行判定了，下面会分别就这两种情况进行讲解。 <br> 首先是只有一张student表： <br> 需要创建子类StudentContentProvider继承ContentProvider，一般情况下有两种创建方法： <br> 1.new——&gt;Java class，继承ContentProvider方法，重写6个抽象方法，还需要在AndroidManifest中注册provider； <br> 2.new——&gt;others——&gt;Content Provider，这是创建Content Provider的快捷方法，系统会自动生成继承ContentProvider方法和在AndroidManifest中注册provider。</p> 
<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StudentContentProvider</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ContentProvider</span> {<!-- --></span>

    <span class="hljs-keyword">public</span> <span class="hljs-title">StudentContentProvider</span>() {
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">delete</span>(Uri uri, String selection, String[] selectionArgs) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title">getType</span>(Uri uri) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> Uri <span class="hljs-title">insert</span>(Uri uri, ContentValues values) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">onCreate</span>() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> Cursor <span class="hljs-title">query</span>(Uri uri, String[] projection, String selection,
                        String[] selectionArgs, String sortOrder) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">update</span>(Uri uri, ContentValues values, String selection,
                      String[] selectionArgs) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
}
</code></pre> 
<p>发布者ContentProvider已就绪，需要数据调用者ContentResolver，所以新建project(TeacherTest). <br> 在activity_main中定义输入框和按钮，举例天际数据和删除数据，直接上代码</p> 
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">LinearLayout</span> <span class="hljs-attribute">xmlns:android</span>=<span class="hljs-value">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
    <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"match_parent"</span>
    <span class="hljs-attribute">android:orientation</span>=<span class="hljs-value">"vertical"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">EditText
</span>        <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/insert_name_edit"</span>
        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"50dp"</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">Button
</span>        <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/teacher_insert_btn"</span>
        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"50dp"</span>
        <span class="hljs-attribute">android:text</span>=<span class="hljs-value">"添加"</span>/&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">EditText
</span>        <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/delect_name_edit"</span>
        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"50dp"</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">Button
</span>        <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/teacher_delect_btn"</span>
        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"50dp"</span>
        <span class="hljs-attribute">android:text</span>=<span class="hljs-value">"删除"</span>/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">LinearLayout</span>&gt;</span></code></pre> 
<p>先上MainActivity全部代码</p> 
<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> comt.lenovo.teachertest;

<span class="hljs-keyword">import</span> android.content.ContentResolver;
<span class="hljs-keyword">import</span> android.content.ContentValues;
<span class="hljs-keyword">import</span> android.net.Uri;
<span class="hljs-keyword">import</span> android.support.v7.app.AppCompatActivity;
<span class="hljs-keyword">import</span> android.os.Bundle;
<span class="hljs-keyword">import</span> android.view.View;
<span class="hljs-keyword">import</span> android.widget.Button;
<span class="hljs-keyword">import</span> android.widget.EditText;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AppCompatActivity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">View</span>.<span class="hljs-title">OnClickListener</span>{<!-- --></span>

    <span class="hljs-keyword">private</span> Button insertBtn,delectBtn;
    <span class="hljs-keyword">private</span> EditText nameEdit,delectEdit;

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span>(Bundle savedInstanceState) {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        bindID();

    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">bindID</span>() {
        insertBtn = findViewById(R.id.teacher_insert_btn);
        nameEdit = findViewById(R.id.insert_name_edit);
        delectBtn = findViewById(R.id.teacher_delect_btn);
        delectEdit = findViewById(R.id.delect_name_edit);
        insertBtn.setOnClickListener(<span class="hljs-keyword">this</span>);
        delectBtn.setOnClickListener(<span class="hljs-keyword">this</span>);
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span>(View view) {
        <span class="hljs-keyword">switch</span> (view.getId()){
            <span class="hljs-keyword">case</span> R.id.teacher_insert_btn:<span class="hljs-comment">//添加数据</span>
                String name = nameEdit.getText().toString();
                Uri uri = Uri.parse(<span class="hljs-string">"content://comt.lenovo.studenttest"</span>);
                ContentResolver resolver = getContentResolver();
                ContentValues values = <span class="hljs-keyword">new</span> ContentValues();
                values.put(<span class="hljs-string">"name"</span>,name);
                resolver.insert(uri,values);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.teacher_delect_btn:<span class="hljs-comment">//删除数据</span>
                String delectName = delectEdit.getText().toString();
                Uri uri2 = Uri.parse(<span class="hljs-string">"content://comt.lenovo.studenttest"</span>);
                ContentResolver resolver2 = getContentResolver();
                ContentValues values2 = <span class="hljs-keyword">new</span> ContentValues();
                values2.put(<span class="hljs-string">"name"</span>,delectName);
                resolver2.delete(uri2,<span class="hljs-string">"name=?"</span>,<span class="hljs-keyword">new</span> String[]{delectName});
                <span class="hljs-keyword">break</span>;
        }
    }
}</code></pre> 
<p>主要代码只有一部分</p> 
<pre class="prettyprint"><code class=" hljs avrasm">@Override
    public void onClick(View view) {
        switch (view<span class="hljs-preprocessor">.getId</span>()){
            case R<span class="hljs-preprocessor">.id</span><span class="hljs-preprocessor">.teacher</span>_insert_btn://添加数据
                String name = nameEdit<span class="hljs-preprocessor">.getText</span>()<span class="hljs-preprocessor">.toString</span>()<span class="hljs-comment">;</span>
                Uri uri = Uri<span class="hljs-preprocessor">.parse</span>(<span class="hljs-string">"content://comt.lenovo.studenttest"</span>)<span class="hljs-comment">;</span>
                ContentResolver resolver = getContentResolver()<span class="hljs-comment">;</span>
                ContentValues values = new ContentValues()<span class="hljs-comment">;</span>
                values<span class="hljs-preprocessor">.put</span>(<span class="hljs-string">"name"</span>,name)<span class="hljs-comment">;</span>
                resolver<span class="hljs-preprocessor">.insert</span>(uri,values)<span class="hljs-comment">;</span>
                <span class="hljs-keyword">break</span><span class="hljs-comment">;</span>
            case R<span class="hljs-preprocessor">.id</span><span class="hljs-preprocessor">.teacher</span>_delect_btn://删除数据
                String delectName = delectEdit<span class="hljs-preprocessor">.getText</span>()<span class="hljs-preprocessor">.toString</span>()<span class="hljs-comment">;</span>
                Uri uri2 = Uri<span class="hljs-preprocessor">.parse</span>(<span class="hljs-string">"content://comt.lenovo.studenttest"</span>)<span class="hljs-comment">;</span>
                ContentResolver resolver2 = getContentResolver()<span class="hljs-comment">;</span>
                ContentValues values2 = new ContentValues()<span class="hljs-comment">;</span>
                values2<span class="hljs-preprocessor">.put</span>(<span class="hljs-string">"name"</span>,delectName)<span class="hljs-comment">;</span>
                resolver2<span class="hljs-preprocessor">.delete</span>(uri2,<span class="hljs-string">"name=?"</span>,new String[]{delectName})<span class="hljs-comment">;</span>
                <span class="hljs-keyword">break</span><span class="hljs-comment">;</span>
        }
    }</code></pre> 
<p>在发布者ContentProvider中StudentContentProvider.java文件中需要作出相应设置，代码如下：</p> 
<pre class="prettyprint"><code class=" hljs java"><span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> Uri <span class="hljs-title">insert</span>(Uri uri, ContentValues values) {
        Log.e(TAG,<span class="hljs-string">"insert"</span>+<span class="hljs-string">"###########################"</span>);
        DBHelper2 dbHelper2 = <span class="hljs-keyword">new</span> DBHelper2(getContext(),<span class="hljs-string">"student_db"</span>,<span class="hljs-keyword">null</span>,<span class="hljs-number">1</span>);
        SQLiteDatabase database = dbHelper2.getWritableDatabase();
        database.insert(<span class="hljs-string">"student"</span>,<span class="hljs-keyword">null</span>,values);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }
<span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">delete</span>(Uri uri, String selection, String[] selectionArgs) {
        Log.e(TAG,<span class="hljs-string">"delect"</span>+<span class="hljs-string">"###########################"</span>);
        DBHelper2 dbHelper2 = <span class="hljs-keyword">new</span> DBHelper2(getContext(),<span class="hljs-string">"student_db"</span>,<span class="hljs-keyword">null</span>,<span class="hljs-number">1</span>);
        SQLiteDatabase database = dbHelper2.getWritableDatabase();
        database.delete(<span class="hljs-string">"student"</span>,selection,selectionArgs);
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e18b5d867400f4e934d7cabf31f52a8d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">最新Android基础入门教程目录(完结版)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a8d3b2194017939c4a96683b216a607f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java byte数据转换和处理总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>