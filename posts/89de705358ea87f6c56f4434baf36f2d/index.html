<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>面向对象pygame2048小游戏&#43;源码 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="面向对象pygame2048小游戏&#43;源码" />
<meta property="og:description" content="1.2048介绍 2048是一款数字拼图游戏，游戏的目标是通过在方格中滑动相同数字的方块，使它们合并成更大的数字方块，最终达到2048这个数字。每次滑动都会导致所有的方块朝滑动的方向移动，没有空间移动或合并时游戏结束。这款游戏简单而富有挑战性，需要智力和策略来达到更高的分数。
游戏规则：
1. 在4乘4的方格上，每移动一步会随机在空位出现2或4；
2. 相同的数字碰撞可以合成两倍的数字；
3. 游戏的最终目的是合成2048这个数字。
话不多说直接上源码。（注意同级文件夹需要自己添加图片和字体然后才可以运行）
2.python源码 import sys import pygame import random colors = { 2: (238, 228, 218), 4: (237, 224, 200), 8: (242, 177, 121), 16: (245, 149, 99), 32: (246, 124, 95), 64: (246, 94, 59), 128: (237, 207, 114), 256: (237, 204, 97), 512: (237, 200, 80), 1024: (237, 197, 63), 2048: (237, 194, 46), } class Util: &#34;&#34;&#34; 工具类 &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/89de705358ea87f6c56f4434baf36f2d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-13T20:50:02+08:00" />
<meta property="article:modified_time" content="2023-08-13T20:50:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">面向对象pygame2048小游戏&#43;源码</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>1.2048介绍</h3> 
<p>2048是一款数字拼图游戏，游戏的目标是通过在方格中滑动相同数字的方块，使它们合并成更大的数字方块，最终达到2048这个数字。每次滑动都会导致所有的方块朝滑动的方向移动，没有空间移动或合并时游戏结束。这款游戏简单而富有挑战性，需要智力和策略来达到更高的分数。</p> 
<p>游戏规则：</p> 
<p>1. 在4乘4的方格上，每移动一步会随机在空位出现2或4；</p> 
<p>2. 相同的数字碰撞可以合成两倍的数字；</p> 
<p>3. 游戏的最终目的是合成2048这个数字。</p> 
<p>话不多说直接上源码。（注意同级文件夹需要自己添加图片和字体然后才可以运行）</p> 
<h3>2.python源码</h3> 
<div> 
 <pre><code class="hljs language-python"><span class="hljs-keyword">import</span> sys

<span class="hljs-keyword">import</span> pygame

<span class="hljs-keyword">import</span> random

colors = {
    <span class="hljs-number">2</span>: (<span class="hljs-number">238</span>, <span class="hljs-number">228</span>, <span class="hljs-number">218</span>),
    <span class="hljs-number">4</span>: (<span class="hljs-number">237</span>, <span class="hljs-number">224</span>, <span class="hljs-number">200</span>),
    <span class="hljs-number">8</span>: (<span class="hljs-number">242</span>, <span class="hljs-number">177</span>, <span class="hljs-number">121</span>),
    <span class="hljs-number">16</span>: (<span class="hljs-number">245</span>, <span class="hljs-number">149</span>, <span class="hljs-number">99</span>),
    <span class="hljs-number">32</span>: (<span class="hljs-number">246</span>, <span class="hljs-number">124</span>, <span class="hljs-number">95</span>),
    <span class="hljs-number">64</span>: (<span class="hljs-number">246</span>, <span class="hljs-number">94</span>, <span class="hljs-number">59</span>),
    <span class="hljs-number">128</span>: (<span class="hljs-number">237</span>, <span class="hljs-number">207</span>, <span class="hljs-number">114</span>),
    <span class="hljs-number">256</span>: (<span class="hljs-number">237</span>, <span class="hljs-number">204</span>, <span class="hljs-number">97</span>),
    <span class="hljs-number">512</span>: (<span class="hljs-number">237</span>, <span class="hljs-number">200</span>, <span class="hljs-number">80</span>),
    <span class="hljs-number">1024</span>: (<span class="hljs-number">237</span>, <span class="hljs-number">197</span>, <span class="hljs-number">63</span>),
    <span class="hljs-number">2048</span>: (<span class="hljs-number">237</span>, <span class="hljs-number">194</span>, <span class="hljs-number">46</span>),
}


<span class="hljs-keyword">class</span> <span class="class_ hljs-title">Util</span>:
    <span class="hljs-string">"""
    工具类
    """</span>

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-comment"># 检测鼠标点击与精灵的碰撞，碰撞返回真，反之返回假</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">click_check</span>(<span class="hljs-params">sprite</span>):
        <span class="hljs-comment"># 获得鼠标点击左键按下事件</span>
        <span class="hljs-keyword">if</span> pygame.mouse.get_pressed()[<span class="hljs-number">0</span>]:
            <span class="hljs-comment"># 判断精灵是否和鼠标左键碰撞</span>
            <span class="hljs-keyword">if</span> sprite.rect.collidepoint(pygame.mouse.get_pos()):
                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>


<span class="hljs-keyword">class</span> <span class="class_ hljs-title">BaseSprite</span>(pygame.sprite.Sprite):
    <span class="hljs-string">"""
    精灵父类
    """</span>

    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):
        <span class="hljs-string">"""
        初始化精灵
        """</span>
        <span class="hljs-built_in">super</span>().__init__()
        self.image = pygame.image.load(name)
        self.rect = self.image.get_rect()


<span class="hljs-keyword">class</span> <span class="class_ hljs-title">NumSprite</span>(pygame.sprite.Sprite):
    <span class="hljs-string">"""
    数字精灵
    """</span>

    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">__init__</span>(<span class="hljs-params">self, center</span>):
        <span class="hljs-built_in">super</span>().__init__()
        <span class="hljs-comment"># 字体</span>
        self.font = pygame.font.Font(<span class="hljs-string">"font/simkai.ttf"</span>, <span class="hljs-number">64</span>)
        <span class="hljs-comment"># 在字体随机显示2或4</span>
        self.font_num = self.font.render(<span class="hljs-string">f"<span class="hljs-subst">{random.choice([<span class="hljs-number">2</span>, <span class="hljs-number">4</span>])}</span>"</span>, <span class="hljs-literal">True</span>, (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>))
        <span class="hljs-comment"># surface类型获得一个矩形面</span>
        self.image = pygame.Surface((<span class="hljs-number">80</span>, <span class="hljs-number">80</span>))
        <span class="hljs-comment"># 填充颜色</span>
        self.image.fill((<span class="hljs-number">205</span>, <span class="hljs-number">193</span>, <span class="hljs-number">180</span>))
        <span class="hljs-comment"># 在矩形上绘制字体</span>
        self.image.blit(self.font_num, (<span class="hljs-number">22</span>, <span class="hljs-number">10</span>))
        <span class="hljs-comment"># 获得矩形坐标</span>
        self.rect = self.image.get_rect()
        self.rect.center = center


<span class="hljs-keyword">class</span> <span class="class_ hljs-title">NumManage</span>:
    <span class="hljs-string">"""
    数字管理类
    """</span>

    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">__init__</span>(<span class="hljs-params">self, gm</span>):
        self.gm = gm
        <span class="hljs-comment"># 定义数字组</span>
        self.num_group = pygame.sprite.Group()
        <span class="hljs-comment"># 开始状态为空</span>
        self.state = <span class="hljs-literal">None</span>
        <span class="hljs-comment"># 字体</span>
        self.font = pygame.font.SysFont(<span class="hljs-literal">None</span>, <span class="hljs-number">40</span>)

    <span class="hljs-comment"># 绘制方块</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">draw_tile</span>(<span class="hljs-params">self, x, y, value</span>):
        color = colors.get(value, (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>))
        coordinate_x = x + <span class="hljs-number">15</span>
        coordinate_y = y + <span class="hljs-number">140</span>
        pygame.draw.rect(self.gm.screen, color, (coordinate_x, coordinate_y, <span class="hljs-number">80</span>, <span class="hljs-number">80</span>))
        <span class="hljs-keyword">if</span> value:
            text_surface = self.font.render(<span class="hljs-built_in">str</span>(value), <span class="hljs-literal">True</span>, (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))
            text_rect = text_surface.get_rect(center=(coordinate_x + <span class="hljs-number">80</span> / <span class="hljs-number">2</span>, coordinate_y + <span class="hljs-number">80</span> / <span class="hljs-number">2</span>))
            self.gm.screen.blit(text_surface, text_rect)

    <span class="hljs-comment"># 绘制游戏界面</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">draw_board</span>(<span class="hljs-params">self, board</span>):
        <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board)):
            <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board[<span class="hljs-number">0</span>])):
                self.draw_tile(x * (<span class="hljs-number">80</span> + <span class="hljs-number">10</span>), y * (<span class="hljs-number">80</span> + <span class="hljs-number">10</span>), board[y][x])

    <span class="hljs-comment"># 在空白位置生成一个新方块</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">spawn_tile</span>(<span class="hljs-params">self, board</span>):
        empty_tiles = []
        <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board)):
            <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board[<span class="hljs-number">0</span>])):
                <span class="hljs-keyword">if</span> board[y][x] == <span class="hljs-number">0</span>:
                    empty_tiles.append((y, x))
        <span class="hljs-keyword">if</span> empty_tiles:
            y, x = random.choice(empty_tiles)
            board[y][x] = random.choice([<span class="hljs-number">2</span>, <span class="hljs-number">4</span>])

    <span class="hljs-comment"># 合并相同数字的方块</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">merge_tiles</span>(<span class="hljs-params">self, board, direction</span>):
        <span class="hljs-keyword">if</span> direction == <span class="hljs-string">'up'</span>:
            <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board[<span class="hljs-number">0</span>])):
                <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board) - <span class="hljs-number">1</span>):
                    <span class="hljs-keyword">if</span> board[y][x] == board[y + <span class="hljs-number">1</span>][x]:
                        board[y][x] *= <span class="hljs-number">2</span>
                        board[y + <span class="hljs-number">1</span>][x] = <span class="hljs-number">0</span>

        <span class="hljs-keyword">elif</span> direction == <span class="hljs-string">'down'</span>:
            <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board[<span class="hljs-number">0</span>])):
                <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board) - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):
                    <span class="hljs-keyword">if</span> board[y][x] == board[y - <span class="hljs-number">1</span>][x]:
                        board[y][x] *= <span class="hljs-number">2</span>
                        board[y - <span class="hljs-number">1</span>][x] = <span class="hljs-number">0</span>

        <span class="hljs-keyword">elif</span> direction == <span class="hljs-string">'left'</span>:
            <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board)):
                <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board[<span class="hljs-number">0</span>]) - <span class="hljs-number">1</span>):
                    <span class="hljs-keyword">if</span> board[y][x] == board[y][x + <span class="hljs-number">1</span>]:
                        board[y][x] *= <span class="hljs-number">2</span>
                        board[y][x + <span class="hljs-number">1</span>] = <span class="hljs-number">0</span>

        <span class="hljs-keyword">elif</span> direction == <span class="hljs-string">'right'</span>:
            <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board)):
                <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board[<span class="hljs-number">0</span>]) - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):
                    <span class="hljs-keyword">if</span> board[y][x] == board[y][x - <span class="hljs-number">1</span>]:
                        board[y][x] *= <span class="hljs-number">2</span>
                        board[y][x - <span class="hljs-number">1</span>] = <span class="hljs-number">0</span>

    <span class="hljs-comment"># 移动方块</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">move_tiles</span>(<span class="hljs-params">self, board, direction</span>):
        <span class="hljs-keyword">if</span> direction == <span class="hljs-string">'down'</span>:
            <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board[<span class="hljs-number">0</span>])):
                <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board) - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):
                    <span class="hljs-keyword">if</span> board[y][x] == <span class="hljs-number">0</span>:
                        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(y - <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):
                            <span class="hljs-keyword">if</span> board[k][x] != <span class="hljs-number">0</span>:
                                board[y][x] = board[k][x]
                                board[k][x] = <span class="hljs-number">0</span>
                                <span class="hljs-keyword">break</span>



        <span class="hljs-keyword">elif</span> direction == <span class="hljs-string">'up'</span>:
            <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board[<span class="hljs-number">0</span>])):
                <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board) - <span class="hljs-number">1</span>):
                    <span class="hljs-keyword">if</span> board[y][x] == <span class="hljs-number">0</span>:
                        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(y + <span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(board)):
                            <span class="hljs-keyword">if</span> board[k][x] != <span class="hljs-number">0</span>:
                                board[y][x] = board[k][x]
                                board[k][x] = <span class="hljs-number">0</span>
                                <span class="hljs-keyword">break</span>

        <span class="hljs-keyword">elif</span> direction == <span class="hljs-string">'right'</span>:
            <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board)):
                <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board[<span class="hljs-number">0</span>]) - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):
                    <span class="hljs-keyword">if</span> board[y][x] == <span class="hljs-number">0</span>:
                        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(x - <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):
                            <span class="hljs-keyword">if</span> board[y][k] != <span class="hljs-number">0</span>:
                                board[y][x] = board[y][k]
                                board[y][k] = <span class="hljs-number">0</span>
                                <span class="hljs-keyword">break</span>

        <span class="hljs-keyword">elif</span> direction == <span class="hljs-string">'left'</span>:
            <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board)):
                <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board[<span class="hljs-number">0</span>]) - <span class="hljs-number">1</span>):
                    <span class="hljs-keyword">if</span> board[y][x] == <span class="hljs-number">0</span>:
                        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(x + <span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(board[<span class="hljs-number">0</span>])):
                            <span class="hljs-keyword">if</span> board[y][k] != <span class="hljs-number">0</span>:
                                board[y][x] = board[y][k]
                                board[y][k] = <span class="hljs-number">0</span>
                                <span class="hljs-keyword">break</span>

    <span class="hljs-comment"># 判断游戏是否结束</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">game_over</span>(<span class="hljs-params">self, board</span>):
        <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board)):
            <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(board[<span class="hljs-number">0</span>])):
                <span class="hljs-keyword">if</span> board[y][x] == <span class="hljs-number">0</span>:
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
                <span class="hljs-keyword">if</span> x &lt; <span class="hljs-built_in">len</span>(board[<span class="hljs-number">0</span>]) - <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> board[y][x] == board[y][x + <span class="hljs-number">1</span>]:
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
                <span class="hljs-keyword">if</span> y &lt; <span class="hljs-built_in">len</span>(board) - <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> board[y][x] == board[y + <span class="hljs-number">1</span>][x]:
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>


<span class="hljs-keyword">class</span> <span class="class_ hljs-title">UISprite</span>(<span class="class_ hljs-title inherited__">BaseSprite</span>):
    <span class="hljs-string">"""
    界面精灵类
    """</span>

    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">__init__</span>(<span class="hljs-params">self, name, center</span>):
        <span class="hljs-built_in">super</span>().__init__(name)
        self.rect.center = center


<span class="hljs-keyword">class</span> <span class="class_ hljs-title">UIManage</span>:
    <span class="hljs-string">"""
    界面管理类
    """</span>

    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">__init__</span>(<span class="hljs-params">self, gm</span>):
        self.gm = gm
        <span class="hljs-comment"># UI字体</span>
        self.font1 = pygame.font.Font(<span class="hljs-string">"font/font.ttf"</span>, <span class="hljs-number">25</span>)
        self.font2 = pygame.font.Font(<span class="hljs-string">"font/simkai.ttf"</span>, <span class="hljs-number">70</span>)
        self.font3 = pygame.font.Font(<span class="hljs-string">"font/simkai.ttf"</span>, <span class="hljs-number">14</span>)
        self.font4 = pygame.font.Font(<span class="hljs-string">"font/font.ttf"</span>, <span class="hljs-number">20</span>)
        self.font5 = pygame.font.Font(<span class="hljs-string">"font/simkai.ttf"</span>, <span class="hljs-number">70</span>)

        <span class="hljs-comment"># 开始前UI元素，一个ready_group精灵组</span>
        self.ready_group = pygame.sprite.Group()
        <span class="hljs-comment"># 开始按钮</span>
        self.begin_btn = UISprite(<span class="hljs-string">"start.jpg"</span>, (<span class="hljs-number">190</span>, <span class="hljs-number">250</span>))
        self.begin_btn.add(self.ready_group)

        <span class="hljs-comment"># 游戏结束UI元素</span>
        self.end_group = pygame.sprite.Group()
        <span class="hljs-comment"># 重新开始按钮</span>
        self.replay_btn = UISprite(<span class="hljs-string">"button3.jpg"</span>, (<span class="hljs-number">190</span>, <span class="hljs-number">250</span>))
        self.replay_btn.add(self.end_group)

        <span class="hljs-comment"># new_game按钮</span>
        self.new_game_group = pygame.sprite.Group()
        self.new_game_btn = UISprite(<span class="hljs-string">"button31.jpg"</span>, (<span class="hljs-number">315</span>, <span class="hljs-number">100</span>))
        self.new_game_btn.add(self.new_game_group)

        <span class="hljs-comment"># 分数</span>
        self.score_surface1 = self.font4.render(<span class="hljs-string">f"Score:<span class="hljs-subst">{<!-- --><span class="hljs-number">0</span>}</span>"</span>, <span class="hljs-literal">True</span>, (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))
        self.score_surface2 = self.font1.render(<span class="hljs-string">f"Score:<span class="hljs-subst">{<!-- --><span class="hljs-number">0</span>}</span>"</span>, <span class="hljs-literal">True</span>, (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))
        <span class="hljs-comment"># 2048文字</span>
        self.num_surface = self.font2.render(<span class="hljs-string">"2048"</span>, <span class="hljs-literal">True</span>, (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))
        self.num_surface1 = self.font3.render(<span class="hljs-string">"合并数字到达2048！"</span>, <span class="hljs-literal">True</span>, (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))
        <span class="hljs-comment"># 结束显示文字</span>
        self.over_surface = self.font5.render(<span class="hljs-string">"GAME OVER!"</span>, <span class="hljs-literal">True</span>, (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>))

    <span class="hljs-comment"># 游戏状态gaming视图</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">gaming_view</span>(<span class="hljs-params">self</span>):
        self.gm.num_manage.draw_board(self.gm.board)
        <span class="hljs-comment"># 绘制分数</span>
        self.score_surface1 = self.font4.render(<span class="hljs-string">f"Score:<span class="hljs-subst">{self.gm.score}</span>"</span>, <span class="hljs-literal">True</span>, (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))
        self.gm.screen.blit(self.score_surface1, (<span class="hljs-number">150</span>, <span class="hljs-number">85</span>))
        <span class="hljs-comment"># 绘制最大分数</span>
        self.score_surface2 = self.font1.render(<span class="hljs-string">f"MaxScore:<span class="hljs-subst">{self.gm.high_score}</span>"</span>, <span class="hljs-literal">True</span>, (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))
        self.gm.screen.blit(self.score_surface2, (<span class="hljs-number">200</span>, <span class="hljs-number">30</span>))
        <span class="hljs-comment"># 绘制2048</span>
        self.gm.screen.blit(self.num_surface, (<span class="hljs-number">10</span>, <span class="hljs-number">0</span>))
        self.gm.screen.blit(self.num_surface1, (<span class="hljs-number">5</span>, <span class="hljs-number">80</span>))

        <span class="hljs-comment"># new_game按钮绘制</span>
        self.new_game_group.draw(self.gm.screen)
        <span class="hljs-keyword">if</span> Util.click_check(self.new_game_btn):
            self.gm.count_score()
            self.check_score()
            self.gm.board = [[<span class="hljs-number">0</span>] * <span class="hljs-number">4</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]
            self.gm.state = <span class="hljs-string">"gaming"</span>

    <span class="hljs-comment"># 游戏状态的判定</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">update</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">if</span> self.gm.state == <span class="hljs-string">"ready"</span>:
            self.gm.board = [[<span class="hljs-number">0</span>] * <span class="hljs-number">4</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]
            self.ready_group.draw(self.gm.screen)
            <span class="hljs-keyword">if</span> Util.click_check(self.begin_btn):
                self.gm.state = <span class="hljs-string">"gaming"</span>

        <span class="hljs-keyword">elif</span> self.gm.state == <span class="hljs-string">"gaming"</span>:
            self.gaming_view()

        <span class="hljs-keyword">elif</span> self.gm.state == <span class="hljs-string">"end"</span>:
            self.check_score()
            self.end_group.draw(self.gm.screen)

            self.gm.screen.blit(self.over_surface, (<span class="hljs-number">20</span>, <span class="hljs-number">100</span>))

            self.gm.board = [[<span class="hljs-number">0</span>] * <span class="hljs-number">4</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]
            self.gm.score = <span class="hljs-number">0</span>
            <span class="hljs-keyword">if</span> Util.click_check(self.replay_btn):
                self.gm.state = <span class="hljs-string">"gaming"</span>

    <span class="hljs-comment"># 检查分数，最大值返回给high_score</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">check_score</span>(<span class="hljs-params">self</span>):
        temp_score = self.gm.score
        <span class="hljs-keyword">if</span> temp_score &gt; self.gm.high_score:
            self.gm.high_score = temp_score


<span class="hljs-keyword">class</span> <span class="class_ hljs-title">GameManage</span>:
    <span class="hljs-string">"""
    游戏管理类
    """</span>

    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):
        pygame.init()
        img_load = pygame.image.load(<span class="hljs-string">"head.jpg"</span>)
        pygame.display.set_icon(img_load)
        <span class="hljs-comment"># 初始化游戏状态</span>
        self.state = <span class="hljs-string">"ready"</span>
        <span class="hljs-comment"># 初始化帧率</span>
        self.clock = pygame.time.Clock()
        <span class="hljs-comment"># 初始化屏幕</span>
        self.screen = pygame.display.set_mode((<span class="hljs-number">380</span>, <span class="hljs-number">500</span>))
        pygame.display.set_caption(name)
        <span class="hljs-comment"># 实例调用类UIManage传入gm</span>
        self.ui_manage = UIManage(self)
        <span class="hljs-comment"># 实例调用类NumManage传入gm</span>
        self.num_manage = NumManage(self)
        <span class="hljs-comment"># 4*4都为零的列表</span>
        self.board = [[<span class="hljs-number">0</span>] * <span class="hljs-number">4</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]
        self.score = <span class="hljs-number">0</span>
        self.high_score = <span class="hljs-number">0</span>

    <span class="hljs-comment"># 统计显示所有数字的和作为分数</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">count_score</span>(<span class="hljs-params">self</span>):
        score = <span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> self.board:
            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> i:
                score += j
        self.score = score

    <span class="hljs-comment"># 读取文件获得最大值</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">read_data</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">"high_score.txt"</span>, <span class="hljs-string">"r"</span>) <span class="hljs-keyword">as</span> f:
            high = <span class="hljs-built_in">int</span>(f.read())
            <span class="hljs-keyword">return</span> high

    <span class="hljs-comment"># 写入文件，写入最大值</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">write_data</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">"high_score.txt"</span>, <span class="hljs-string">"w"</span>) <span class="hljs-keyword">as</span> f:
            f.write(<span class="hljs-built_in">str</span>(self.high_score))

    <span class="hljs-comment"># 事件检测</span>
    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">check_event</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():
            <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:
                pygame.quit()
                sys.exit()
            <span class="hljs-comment"># 空格一键结束</span>
            <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.KEYUP:
                <span class="hljs-comment"># 一键结束游戏</span>
                <span class="hljs-keyword">if</span> event.key == pygame.K_SPACE:
                    self.state = <span class="hljs-string">"end"</span>
                self.count_score()

            <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.KEYUP:
                <span class="hljs-comment"># 捕捉左建事件</span>
                <span class="hljs-keyword">if</span> event.key == pygame.K_LEFT:
                    self.num_manage.move_tiles(self.board, <span class="hljs-string">"left"</span>)
                    self.num_manage.merge_tiles(self.board, <span class="hljs-string">"left"</span>)
                    self.num_manage.move_tiles(self.board, <span class="hljs-string">"left"</span>)
                    self.num_manage.spawn_tile(self.board)

                <span class="hljs-comment"># 捕捉上建事件</span>
                <span class="hljs-keyword">elif</span> event.key == pygame.K_UP:
                    self.num_manage.move_tiles(self.board, <span class="hljs-string">"up"</span>)
                    self.num_manage.merge_tiles(self.board, <span class="hljs-string">"up"</span>)
                    self.num_manage.move_tiles(self.board, <span class="hljs-string">"up"</span>)
                    self.num_manage.spawn_tile(self.board)

                <span class="hljs-comment"># 捕捉右建事件</span>
                <span class="hljs-keyword">elif</span> event.key == pygame.K_RIGHT:
                    self.num_manage.move_tiles(self.board, <span class="hljs-string">"right"</span>)
                    self.num_manage.merge_tiles(self.board, <span class="hljs-string">"right"</span>)
                    self.num_manage.move_tiles(self.board, <span class="hljs-string">"right"</span>)
                    self.num_manage.spawn_tile(self.board)

                <span class="hljs-comment"># # 捕捉下建事件</span>
                <span class="hljs-keyword">elif</span> event.key == pygame.K_DOWN:
                    self.num_manage.move_tiles(self.board, <span class="hljs-string">"down"</span>)
                    self.num_manage.merge_tiles(self.board, <span class="hljs-string">"down"</span>)
                    self.num_manage.move_tiles(self.board, <span class="hljs-string">"down"</span>)
                    self.num_manage.spawn_tile(self.board)
                <span class="hljs-comment"># 判断游戏是否结束</span>
                <span class="hljs-keyword">if</span> self.num_manage.game_over(self.board):
                    self.state = <span class="hljs-string">"end"</span>

    <span class="hljs-keyword">def</span> <span class="function_ hljs-title">run</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            <span class="hljs-comment"># 修改帧率</span>
            self.clock.tick(<span class="hljs-number">24</span>)
            self.check_event()
            <span class="hljs-comment"># 屏幕填充颜色</span>
            self.screen.fill((<span class="hljs-number">127</span>, <span class="hljs-number">127</span>, <span class="hljs-number">127</span>))
            self.ui_manage.update()
            <span class="hljs-comment"># 判断游戏状态</span>
            <span class="hljs-keyword">if</span> self.state == <span class="hljs-string">"gaming"</span>:
                self.num_manage.num_group.draw(self.screen)
                self.num_manage.num_group.update()
            <span class="hljs-comment"># 一直刷新屏幕</span>
            pygame.display.flip()


gm = GameManage(<span class="hljs-string">"2048"</span>)
gm.run()
</code></pre> 
</div> 
<h3>3.编码思路</h3> 
<p>1、先来个游戏管理类GameManage用来管理其他类，先创建一个举行窗口。</p> 
<p>2、精灵父类，创建ui精灵类继承父类和ui管理类，设置游戏的三种状态，replay，gaming，end。根据游戏的不同状态在屏幕上显示不同的界面</p> 
<p>3、一个工具静态类，用来检测鼠标点击事件。</p> 
<p>4、数字类，需要在屏幕上绘制方格，在每个格子上绘制数字。4乘4的列表中默认都是零，在屏幕上不显示，当获得键盘事事件（上下左右），在新建临时列表追加原来表中的零，再重临时列表中随机一个零进行2或4的显示，并绘制到屏幕上。每次获得键盘事件都对原有的表格进行遍历，位置移动，相同数字碰撞叠加。</p> 
<p>效果图：</p> 
<p><img alt="" height="261" src="https://images2.imgbox.com/e7/95/DPGdNTqm_o.png" width="187"><img alt="" height="258" src="https://images2.imgbox.com/ae/7e/IRXX7tVp_o.png" width="185"></p> 
<p>感谢观看点个赞呗！！！！</p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4a52f3b9faba1c9289edd75a0d29bb16/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ubuntu搭建telnet服务</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b03b8d68de34d3c03ba5b7ea1dbc30e6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">群辉nas看剧设置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>