<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Andriod P DNS解析不了问题解决 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Andriod P DNS解析不了问题解决" />
<meta property="og:description" content="1.目前在AndriodP 上 WIFI连接外部热点，可以ping IP 地址，但是不能ping baidu, 初步判断是dns解析出了问题
2.getprop | grep dns后，发现 也已经设置了dns
msmnile_gvmq:/ # getprop | grep dns
[init.svc.mdnsd]: [running]
[net.dns1]: [192.168.43.1]
[net.dns2]: [114.114.114.114]
[net.dns3]: [8.8.8.8]
[ro.boottime.mdnsd]: [8268090830]
ping -I waln0 www.baidu.com 还是 报错“ping: unknown host www.baidu.com”
添加：
[net.wlan0.dns1]: [114.114.114.114]
[net.wlan0.dns2]: [8.8.8.8]
[net.wlan0.dns3]: [192.168.43.1]
结果还是一样ping 不同baidu.
3.ping -I wlan0 www.baidu.com 的时候logcat 输出log 发现：
05-28 15:35:41.194 801 23746 D NetworkMonitor/NetworkAgentInfo [WIFI () - 103]: PROBE_DNS connectivitycheck.gstatic.com 66ms OK 203.208.40.127
05-28 15:35:41." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/4e33a9eb9f4662b3642dcc8fa0d94095/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-31T15:11:08+08:00" />
<meta property="article:modified_time" content="2020-05-31T15:11:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Andriod P DNS解析不了问题解决</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>1.目前在AndriodP 上 WIFI连接外部热点，可以ping IP 地址，但是不能ping baidu, 初步判断是dns解析出了问题</p> 
<p>2.getprop | grep dns后，发现 也已经设置了dns<br> msmnile_gvmq:/ # getprop | grep dns<br> [init.svc.mdnsd]: [running]<br> [net.dns1]: [192.168.43.1]<br> [net.dns2]: [114.114.114.114]<br> [net.dns3]: [8.8.8.8]<br> [ro.boottime.mdnsd]: [8268090830]</p> 
<p>ping -I waln0 www.baidu.com 还是 报错“ping: unknown host www.baidu.com”<br> 添加：<br> [net.wlan0.dns1]: [114.114.114.114]<br> [net.wlan0.dns2]: [8.8.8.8]<br> [net.wlan0.dns3]: [192.168.43.1]<br> 结果还是一样ping 不同baidu.</p> 
<p>3.ping -I wlan0 www.baidu.com 的时候logcat 输出log 发现：<br> 05-28 15:35:41.194 801 23746 D NetworkMonitor/NetworkAgentInfo [WIFI () - 103]: PROBE_DNS connectivitycheck.gstatic.com 66ms OK 203.208.40.127<br> 05-28 15:35:41.202 801 1028 W IpClient.eth0: [IpReachabilityMonitor] WARN ALERT neighbor went from: NeighborEvent{@7725840,RTM_NEWNEIGH,if=4,192.168.1.10,NUD_FAILED,[null]} to: NeighborEvent{@7730882,RTM_NEWNEIGH,if=4,192.168.1.10,NUD_FAILED,[null]}<br> 05-28 15:35:41.202 801 1028 W IpReachabilityMonitor: FAILURE: LOST_PROVISIONING, NeighborEvent{@7730882,RTM_NEWNEIGH,if=4,192.168.1.10,NUD_FAILED,[null]}<br> 05-28 15:35:41.230 801 23746 D NetworkMonitor/NetworkAgentInfo [WIFI () - 103]: PROBE_HTTP http://connectivitycheck.gstatic.com/generate_204 time=34ms ret=204 request={User-Agent=[Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.32 Safari/537.36]} headers={null=[HTTP/1.1 204 No Content], Content-Length=[0], Date=[Fri, 29 May 2020 09:21:28 GMT], X-Android-Received-Millis=[1590680141229], X-Android-Response-Source=[NETWORK 204], X-Android-Selected-Protocol=[http/1.1], X-Android-Sent-Millis=[1590680141195]}<br> 05-28 15:35:41.234 801 23745 D NetworkMonitor/NetworkAgentInfo [WIFI () - 103]: PROBE_DNS www.google.com 106ms OK 31.13.84.1</p> 
<p>直接把log 百度：<br> “NetworkMonitor/NetworkAgentInfo [WIFI () - 103]: PROBE_DNS www.google.com 106ms OK 31.13.84.1”</p> 
<p>有收获：<br> https://blog.csdn.net/weixin_34291004/article/details/85981898<br> 。。。。。<br> 大概意思<br> 将上面的DEFAULT_HTTPS_URL更改为可以访问的网站即可，例如"https//www.google.cn/generate_204"<br> 提示不能访问的代码网络的代码：<br> frameworks/base/services/core/java/com/android/server/connectivity/NetworkMoniter.java<br> private static final String DEFAULT_HTTPS_URL = “https://www.google.com/generate_204”; ===》“https://www.google.cn/generate_204”;</p> 
<p>或者<br> https://blog.csdn.net/drageon_j/article/details/77336257?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase</p> 
<p>Android 7及之后的版本输入如下两个命令:<br> adb shell “settings put global captive_portal_http_url http://www.google.cn/generate_204”<br> adb shell “settings put global captive_portal_https_url https://www.google.cn/generate_204”</p> 
<p>Andriod 7之前的版本运行如下的命令:<br> adb shell “settings put global captive_portal_serverhttp://www.google.cn/generate_204”</p> 
<p>可以输入如下命令, 禁止检测网络连接状态.<br> adb shell settings put global captive_portal_detection_enabled 0</p> 
<p>可以输入如下命令, 打开检测网络连接状态.<br> adb shell settings put global captive_portal_detection_enabled 1</p> 
<p>可以输入如下的命令查看所支持的所有选项:<br> adb shell settings list global<br> https://blog.csdn.net/drageon_j/article/details/77336257</p> 
<p>按照上述修改即可，ping -I wlan0 www.baidu.com 可以ping 通baidu</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/be1651a42c88254ecd6f630282e9f746/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Macbook Pro 外接显卡实现Tensorflow GPU运行之环境配置（重点）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dc5e75176d589a043b229a3b1e2c6c4c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Servlet中写了注解@WebServlet但访问servlet报404错误</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>