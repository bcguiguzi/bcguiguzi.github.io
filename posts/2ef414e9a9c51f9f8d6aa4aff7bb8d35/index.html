<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>❤️2万字带你走进python爬虫requests库，史上最全！！❤️ - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="❤️2万字带你走进python爬虫requests库，史上最全！！❤️" />
<meta property="og:description" content="一、 requests 库简介 Requests 是一个为人类设计的简单而优雅的 HTTP 库。 requests 库是一个原生的 HTTP 库，比 urllib3 库更为容易使用。 requests 库发送原生的 HTTP 1.1 请求，无需手动为 URL 添加查询串， 也不需要对 POST 数据进行表单编码。相对于 urllib3 库， requests 库拥有完全自动化 Keep-alive 和 HTTP 连接池的功能。 requests 库包含的特性如下。 ❖ 1Keep-Alive &amp; 连接池 ❖ 国际化域名和 URL ❖ 带持久 Cookie 的会话 ❖ 浏览器式的 SSL 认证 ❖ 自动内容解码 ❖ 基本 / 摘要式的身份认证 ❖ 优雅的 key/value Cookie ❖ 自动解压 ❖ Unicode 响应体 ❖ HTTP(S) 代理支持 ❖ 文件分块上传 ❖ 流下载 ❖ 连接超时 ❖ 分块请求 ❖ 支持 ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/2ef414e9a9c51f9f8d6aa4aff7bb8d35/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-23T23:25:30+08:00" />
<meta property="article:modified_time" content="2021-10-23T23:25:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">❤️2万字带你走进python爬虫requests库，史上最全！！❤️</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2><span style="color:#1fbabe;"><strong>一、 requests </strong></span><span style="color:#1fbabe;">库简介 </span></h2> 
<div style="text-align:justify;"> 
 <span style="color:#000000;">        Requests </span> 
 <span style="color:#000000;">是一个为人类设计的简单而优雅的 </span> 
 <span style="color:#000000;">HTTP </span> 
 <span style="color:#000000;">库。</span> 
 <span style="color:#000000;">requests </span> 
 <span style="color:#000000;">库是一个原生的 </span> 
 <span style="color:#000000;">HTTP </span> 
 <span style="color:#000000;">库，比 urllib3 库更为容易使用。</span> 
 <span style="color:#000000;">requests </span> 
 <span style="color:#000000;">库发送原生的 </span> 
 <span style="color:#000000;">HTTP 1.1 </span> 
 <span style="color:#000000;">请求，无需手动为 </span> 
 <span style="color:#000000;">URL </span> 
 <span style="color:#000000;">添加查询串， 也不需要对 POST </span> 
 <span style="color:#000000;">数据进行表单编码。相对于 </span> 
 <span style="color:#000000;">urllib3 </span> 
 <span style="color:#000000;">库，</span> 
 <span style="color:#000000;">requests </span> 
 <span style="color:#000000;">库拥有完全自动化</span> 
 <span style="color:#000000;">Keep-alive </span> 
 <span style="color:#000000;">和 HTTP 连接池的功能。</span> 
 <span style="color:#000000;">requests </span> 
 <span style="color:#000000;">库包含的特性如下。 </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">1Keep-Alive &amp; </span> 
 <span style="color:#000000;">连接池 </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">国际化域名和 </span> 
 <span style="color:#000000;">URL </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">带持久 </span> 
 <span style="color:#000000;">Cookie </span> 
 <span style="color:#000000;">的会话 </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">浏览器式的 </span> 
 <span style="color:#000000;">SSL </span> 
 <span style="color:#000000;">认证 </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">自动内容解码 </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">基本</span> 
 <span style="color:#000000;">/</span> 
 <span style="color:#000000;">摘要式的身份认证 </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">优雅的 </span> 
 <span style="color:#000000;">key/value Cookie </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">自动解压 </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">Unicode </span> 
 <span style="color:#000000;">响应体 </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">HTTP(S) </span> 
 <span style="color:#000000;">代理支持 </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">文件分块上传 </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">流下载 </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">连接超时 </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">分块请求 </span> 
</div> 
<div> 
 <span style="color:#000000;">❖ </span> 
 <span style="color:#000000;">支持</span> 
 <span style="color:#000000;">.netrc </span> 
</div> 
<div></div> 
<h3><span style="color:#1fbabe;"><strong>1.1 Requests </strong></span><span style="color:#1fbabe;">的安装</span></h3> 
<div> 
 <div> 
  <pre><code class="language-python">pip install requests</code></pre> 
 </div> 
 <div> 
  <h3><span style="color:#1fbabe;"><strong>1.2 Requests </strong></span><span style="color:#1fbabe;">基本使用 </span></h3> 
  <div style="text-align:center;"> 
   <span style="color:#000000;">     代码 </span> 
   <span style="color:#000000;">1-1: </span> 
   <span style="color:#000000;">发送一个 </span> 
   <span style="color:#000000;">get </span> 
   <span style="color:#000000;">请求并查看返回结果</span> 
  </div> 
  <div> 
   <pre><code class="language-python">import requests
url = 'http://www.tipdm.com/tipdm/index.html' # 生成get请求
rqg = requests.get(url)
# 查看结果类型
print('查看结果类型：', type(rqg))
# 查看状态码
print('状态码：',rqg.status_code)
# 查看编码
print('编码 ：',rqg.encoding)
# 查看响应头
print('响应头： ',rqg.headers)
# 打印查看网页内容
print('查看网页内容：',rqg.text)</code></pre> 
   <pre><code>查看结果类型： &lt;class ’requests.models.Response’&gt;
状态码： 200
编码 ： ISO-8859-1
响应头： {’Date’: ’Mon, 18 Nov 2019 04:45:49 GMT’, ’Server’: ’Apache-Coyote/1.1’, ’
Accept-Ranges’: ’bytes’, ’ETag’: ’W/"15693-1562553126764"’, ’Last-Modified’: ’
Mon, 08 Jul 2019 02:32:06 GMT’, ’Content-Type’: ’text/html’, ’Content-Length’: ’
15693’, ’Keep-Alive’: ’timeout=5, max=100’, ’Connection’: ’Keep-Alive’}</code></pre> 
   <h3><span style="color:#1fbabe;"><strong>1.3 Request </strong></span><span style="color:#1fbabe;">基本请求方式 </span></h3> 
   <div> 
    <span style="color:#000000;">你可以通过 </span> 
    <span style="color:#000000;">requests </span> 
    <span style="color:#000000;">库发送所有的 </span> 
    <span style="color:#000000;">http </span> 
    <span style="color:#000000;">请求： </span> 
   </div> 
   <div> 
    <pre><code class="language-python">requests.get("http://httpbin.org/get") #GET请求
requests.post("http://httpbin.org/post") #POST请求
requests.put("http://httpbin.org/put") #PUT请求
requests.delete("http://httpbin.org/delete") #DELETE请求
requests.head("http://httpbin.org/get") #HEAD请求
requests.options("http://httpbin.org/get") #OPTIONS请求</code></pre> 
    <div> 
     <span style="color:#000000;">你可以通过 </span> 
     <span style="color:#000000;">requests </span> 
     <span style="color:#000000;">库发送所有的 </span> 
     <span style="color:#000000;">http </span> 
     <span style="color:#000000;">请求： </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">requests.get("http://httpbin.org/get") #GET请求
requests.post("http://httpbin.org/post") #POST请求
requests.put("http://httpbin.org/put") #PUT请求
requests.delete("http://httpbin.org/delete") #DELETE请求
requests.head("http://httpbin.org/get") #HEAD请求
requests.options("http://httpbin.org/get") #OPTIONS请求</code></pre> 
    </div> 
    <h2><span style="color:#1fbabe;"><strong>二、 </strong></span><span style="color:#1fbabe;">使用 </span><span style="color:#1fbabe;"><strong>Request </strong></span><span style="color:#1fbabe;">发送 </span><span style="color:#1fbabe;"><strong>GET </strong></span><span style="color:#1fbabe;">请求 </span></h2> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">HTTP </span> 
     <span style="color:#000000;">中最常见的请求之一就是 </span> 
     <span style="color:#000000;">GET </span> 
     <span style="color:#000000;">请求，下面首先来详细了解一下利用 </span> 
     <span style="color:#000000;">requests </span> 
     <span style="color:#000000;">构建 </span> 
     <span style="color:#000000;">GET </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">请求的方法。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#dc3545;"> </span> 
     <span style="color:#000000;"><strong>GET </strong></span> 
     <span style="color:#000000;">参数说明： </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">get(url, params=None, **kwargs): </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">URL: </span> 
     <span style="color:#000000;">待请求的网址 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">params </span> 
     <span style="color:#000000;">：（可选）字典，列表为请求的查询字符串发送的元组或字节 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">**kwargs: </span> 
     <span style="color:#000000;">可变长关键字参数 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">首先，构建一个最简单的 </span> 
     <span style="color:#000000;">GET </span> 
     <span style="color:#000000;">请求，请求的链接为 </span> 
     <span style="color:#000000;">http://httpbin.org/get</span> 
     <span style="color:#000000;">，该网站会判断如果客户端发起的是 GET </span> 
     <span style="color:#000000;">请求的话，它返回相应的请求信息，如下就是利用 </span> 
     <span style="color:#000000;">requests </span> 
     <span style="color:#000000;">构建一个 </span> 
     <span style="color:#000000;">GET请求 </span> 
    </div> 
    <div> 
     <pre><code class="language-python">import requests
r = requests.get('http://httpbin.org/get')
print(r.text)
{
"args": {},
"headers": {
"Accept": "*/*",
"Accept-Encoding": "gzip, deflate",
"Host": "httpbin.org",
"User-Agent": "python-requests/2.24.0",
"X-Amzn-Trace-Id": "Root=1-5fb5b166-571d31047bda880d1ec6c311"
},
"origin": "36.44.144.134",
"url": "http://httpbin.org/get"
}</code></pre> 
     <p style="text-align:justify;"><span style="color:#000000;">可以发现，我们成功发起了 GET </span><span style="color:#000000;">请求，返回结果中包含请求头、</span><span style="color:#000000;">URL </span><span style="color:#000000;">、</span><span style="color:#000000;">IP </span><span style="color:#000000;">等信息。那么，对于 GET </span><span style="color:#000000;">请求，如果要附加额外的信息，一般怎样添加呢？ </span></p> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>2.1 </strong></span><span style="color:#1fbabe;">发送带 </span><span style="color:#1fbabe;"><strong>headers </strong></span><span style="color:#1fbabe;">的请求 </span></h3> 
    <div> 
     <span style="color:#000000;">首先我们尝试请求知乎的首页信息</span> 
    </div> 
    <div> 
     <pre><code class="language-python">import requests
response = requests.get(’https://www.zhihu.com/explore’)
print(f"当前请求的响应状态码为：{response.status_code}")
print(response.text)</code></pre> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">当前请求的响应状态码为：</span> 
     <span style="color:#000000;">400 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">&lt;html&gt; </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">&lt;head&gt;&lt;title&gt;400 Bad Request&lt;/title&gt;&lt;/head&gt; </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">&lt;body bgcolor=</span> 
     <span style="color:#ed028c;">"white"</span> 
     <span style="color:#000000;">&gt; </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">&lt;center&gt;&lt;h1&gt;400 Bad Request&lt;/h1&gt;&lt;/center&gt; </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">&lt;hr&gt;&lt;center&gt;openresty&lt;/center&gt; </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">&lt;/body&gt; </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">&lt;/html&gt; </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">这里发现响应的状态码为 </span> 
     <span style="color:#000000;">400</span> 
     <span style="color:#000000;">，说明我们请求失败了，因为知乎已经发现了我们是一个爬虫， </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">因此需要对浏览器进行伪装，添加对应的 </span> 
     <span style="color:#000000;">UA </span> 
     <span style="color:#000000;">信息。 </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import requests
headers = {"user-agent": ’Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36’}
response = requests.get(’https://www.zhihu.com/explore’, headers=headers)
print(f"当前请求的响应状态码为：{response.status_code}")
# print(response.text)</code></pre> 
     <p><span style="color:#000000;">---------------------------------------- </span></p> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">当前请求的响应状态码为：</span> 
     <span style="color:#000000;">200 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">&lt;!doctype html&gt; </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">....... </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">这里我们加入了 </span> 
     <span style="color:#000000;">headers </span> 
     <span style="color:#000000;">信息，其中包含了 </span> 
     <span style="color:#000000;">User-Agent </span> 
     <span style="color:#000000;">字段信息，也就是浏览器标识信息。很明显我们伪装成功了！这种伪装浏览器的方法是最简单的反反爬措施之一。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#dc3545;"> </span> 
     <span style="color:#000000;"><strong>GET </strong></span> 
     <span style="color:#000000;">参数说明： </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">携带请求头发送请求的方法 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">requests.get(url, headers=headers) </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">- headers </span> 
     <span style="color:#000000;">参数接收字典形式的请求头 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">- </span> 
     <span style="color:#000000;">请求头字段名作为 </span> 
     <span style="color:#000000;">key</span> 
     <span style="color:#000000;">，字段对应的值作为 </span> 
     <span style="color:#000000;">value </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#3bb405;">练习 </span> 
     <span style="color:#000000;">请求百度的首页 </span> 
     <span style="color:#000000;">https://www.baidu.com</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#000000;">要求携带 </span> 
     <span style="color:#000000;">headers, </span> 
     <span style="color:#000000;">并打印请求的头信息</span> 
     <span style="color:#000000;">! </span> 
    </div> 
    <div> 
     <p style="text-align:justify;"><span style="color:#3bb405;">解</span></p> 
     <pre><code class="language-python">import requests
url = 'https://www.baidu.com'
headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36"}
# 在请求头中带上User-Agent，模拟浏览器发送请求
response = requests.get(url, headers=headers)
print(response.content)
# 打印请求头信息
print(response.request.headers)</code></pre> 
     <h3><span style="color:#1fbabe;"><strong>2.2 </strong></span><span style="color:#1fbabe;">发送带参数的请求 </span></h3> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        我们在使用百度搜索的时候经常发现 </span> 
     <span style="color:#000000;">url </span> 
     <span style="color:#000000;">地址中会有一个 </span> 
     <span style="color:#000000;">‘?‘</span> 
     <span style="color:#000000;">，那么该问号后边的就是请求参 数，又叫做查询字符串! </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        通常情况下我们不会只访问基础网页，特别是爬取动态网页时我们需要传递不同的参数获取 不同的内容；GET </span> 
     <span style="color:#000000;">传递参数有两种方法，可以直接在链接中添加参数或者利用 </span> 
     <span style="color:#000000;">params </span> 
     <span style="color:#000000;">添加参数</span> 
     <span style="color:#000000;">. </span> 
    </div> 
    <h4><span style="color:#1fbabe;"><strong>2.2.1 </strong></span><span style="color:#1fbabe;">在 </span><span style="color:#1fbabe;"><strong>url </strong></span><span style="color:#1fbabe;">携带参数 </span></h4> 
    <div> 
     <span style="color:#000000;">直接对含有参数的 </span> 
     <span style="color:#000000;">url </span> 
     <span style="color:#000000;">发起请求 </span> 
     <pre><code class="language-python">import requests
headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36"}
url = ’https://www.baidu.com/s?wd=python’
response = requests.get(url, headers=headers)</code></pre> 
     <h4><span style="color:#1fbabe;"><strong>2.2.2 </strong></span><span style="color:#1fbabe;">通过 </span><span style="color:#1fbabe;"><strong>params </strong></span><span style="color:#1fbabe;">携带参数字典 </span></h4> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">1. </span> 
     <span style="color:#000000;">构建请求参数字典 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">2. </span> 
     <span style="color:#000000;">向接口发送请求的时候带上参数字典，参数字典设置给 </span> 
     <span style="color:#000000;">params </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import requests
headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36"}
# 这是目标url
# url = ’https://www.baidu.com/s?wd=python’
# 最后有没有问号结果都一样
url = ’https://www.baidu.com/s?’
# 请求参数是一个字典 即wd=python
kw = {’wd’: ’python’}
# 带上请求参数发起请求，获取响应
response = requests.get(url, headers=headers, params=kw)
print(response.content)</code></pre> 
     <p style="text-align:justify;"><span style="color:#000000;">通过运行结果可以判断，请求的链接自动被构造成了： </span></p> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">http://httpbin.org/get?key2=value2&amp;key1=value1</span> 
     <span style="color:#000000;">。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">另外，网页的返回类型实际上是 </span> 
     <span style="color:#000000;">str </span> 
     <span style="color:#000000;">类型，但是它很特殊，是 </span> 
     <span style="color:#000000;">JSON </span> 
     <span style="color:#000000;">格式的。所以，如果想直接解析返回结果，得到一个字典格式的话，可以直接调用 json() </span> 
     <span style="color:#000000;">方法。示例如下： </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import requests
r = requests.get("http://httpbin.org/get")
print( type(r.text))
print(r.json())
print( type(r. json()))</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">--------------------------------------------------------------- </span> 
    </div> 
    <div> 
     <span style="color:#000000;">&lt;</span> 
     <span style="color:#ff0000;">class </span> 
     <span style="color:#ed028c;">’str’</span> 
     <span style="color:#000000;">&gt; </span> 
    </div> 
    <div> 
     <span style="color:#000000;">{<!-- --></span> 
     <span style="color:#ed028c;">’args’</span> 
     <span style="color:#000000;">: {}, </span> 
     <span style="color:#ed028c;">’headers’</span> 
     <span style="color:#000000;">: {<!-- --></span> 
     <span style="color:#ed028c;">’Accept’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’*/*’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’Accept-Encoding’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’gzip, deflate’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’Host’ </span> 
    </div> 
    <div> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’httpbin.org’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’User-Agent’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’python-requests/2.24.0’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’X-Amzn-Trace-Id’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’ </span> 
    </div> 
    <div> 
     <span style="color:#ed028c;">Root=1-5fb5b3f9-13f7c2192936ec541bf97841’</span> 
     <span style="color:#000000;">}, </span> 
     <span style="color:#ed028c;">’origin’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’36.44.144.134’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’url’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’ </span> 
    </div> 
    <div> 
     <span style="color:#ed028c;">http://httpbin.org/get’</span> 
     <span style="color:#000000;">} </span> 
    </div> 
    <div> 
     <span style="color:#000000;">&lt;</span> 
     <span style="color:#ff0000;">class </span> 
     <span style="color:#ed028c;">’dict’</span> 
     <span style="color:#000000;">&gt; </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">可以发现，调用 </span> 
     <span style="color:#000000;">json() </span> 
     <span style="color:#000000;">方法，就可以将返回结果是 </span> 
     <span style="color:#000000;">JSON </span> 
     <span style="color:#000000;">格式的字符串转化为字典。但需要注意的是，如果返回结果不是 JSON </span> 
     <span style="color:#000000;">格式，便会出现解析错误，抛出 </span> 
     <span style="color:#000000;">json.decoder.JSONDecodeError </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">异常。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">补充内容，接收字典字符串都会被自动编码发送到 </span> 
     <span style="color:#000000;">url</span> 
     <span style="color:#000000;">，如下 </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import requests
headers = {’User-Agent’: ’Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36’}
wd = ’张三同学’
pn = 1
response = requests.get(’https://www.baidu.com/s’, params={’wd’: wd, ’pn’: pn},
headers=headers)
print(response.url)</code></pre> 
    </div> 
    <div> 
     <span style="color:#808080;"># </span> 
     <span style="color:#808080;">输出为：</span> 
     <span style="color:#808080;">https://www.baidu.com/s?wd=%E9%9B%A8%E9%9C%93%E5%90%8 </span> 
    </div> 
    <div> 
     <span style="color:#808080;">C%E5%AD%A6&amp;pn=1 </span> 
    </div> 
    <div> 
     <span style="color:#808080;"># </span> 
     <span style="color:#808080;">可见</span> 
     <span style="color:#808080;">url</span> 
     <span style="color:#808080;">已被自动编码 </span> 
    </div> 
    <div></div> 
    <div> 
     <span style="color:#000000;">上面代码相当于如下代码，</span> 
     <span style="color:#000000;">params </span> 
     <span style="color:#000000;">编码转换本质上是用 </span> 
     <span style="color:#000000;">urlencode </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import requests
from urllib.parse import urlencode
headers = {’User-Agent’: ’Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko)
wd = ’张三同学’
encode_res = urlencode({’k’: wd}, encoding=’utf-8’)
keyword = encode_res.split(’=’)[1]
print(keyword)
# 然后拼接成url
url = ’https://www.baidu.com/s?wd=%s&amp;pn=1’ % keyword
response = requests.get(url, headers=headers)
print(response.url)</code></pre> 
    </div> 
    <div> 
     <span style="color:#ed028c;"># </span> 
     <span style="color:#ed028c;">输出为：</span> 
     <span style="color:#ed028c;">https://www.baidu.com/s?wd=%E9%9B%A8%E9%9C%93%E5 </span> 
    </div> 
    <div> 
     <span style="color:#ed028c;">%90%8C%E5%AD%A6&amp;pn=1 </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>2.3 </strong></span><span style="color:#1fbabe;">使用 </span><span style="color:#1fbabe;"><strong>GET </strong></span><span style="color:#1fbabe;">请求抓取网页 </span></h3> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">上面的请求链接返回的是 </span> 
     <span style="color:#000000;">JSON </span> 
     <span style="color:#000000;">形式的字符串，那么如果请求普通的网页，则肯定能获得相应的内容了! </span> 
    </div> 
    <div> 
     <pre><code class="language-python">
import requests
import re
headers = {"user-agent": ’Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36’}
response = requests.get(’https://www.zhihu.com/explore’, headers=headers)
result = re.findall("(ExploreSpecialCard-contentTitle|ExploreRoundtableCard
questionTitle).*?&gt;(.*?)&lt;/a&gt;", response.text)
print([i[1] for i in result])</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">----------------------- </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">[</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">西安回民街有什么好吃的？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">西安有哪些值得逛的宝藏店铺？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">西安哪些商圈承载着你的青春？’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">你有哪些好的驾驶习惯可以分享？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">有哪些只有经验丰富的司机才知道的驾驶技巧？’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">有车的注意了，这些开车知识每个人都要掌握，关键时刻能救命</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">欢迎着陆！知乎宇宙成员招募通告’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">星球登陆问题：给你十块钱穿越到未来，怎样才能混得风生水起？’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">星球登陆问题：知乎宇宙中的「超能量」你最希望拥有哪一种？你会如何使用它？’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">挪威三文鱼，原产地至关重要</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">挪威最吸引人的地方有哪些？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">生活在挪威是一种 什么体验？’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">如何看待京东方 </span> 
     <span style="color:#ed028c;">AMOLED </span> 
     <span style="color:#ed028c;">柔性屏量产？未来前景如何？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">柔性屏能不能给手机行业带来革命性的影响？’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">什么是超薄可弯曲柔性电池？会对智能手机的续航产生重大影响吗？’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">美术零基础怎样才能学好美术，在艺考中取得高分？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">清华美院被鄙视吗 ?’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">艺术生真的很差吗？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">人应该怎样过这一生？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">人的一生到底该追求什么？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’ 人类知道世界的终极真理后会疯掉吗?’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">焦虑是因为自己能力不够吗？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">社交恐惧症是怎样的一种体验？’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">“忙起来你就没时间抑郁了”这句话有理么？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">] </span> 
    </div> 
    <div></div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        这里我们加入了 </span> 
     <span style="color:#000000;">headers </span> 
     <span style="color:#000000;">信息，其中包含了 </span> 
     <span style="color:#000000;">User-Agent </span> 
     <span style="color:#000000;">字段信息，也就是浏览器标识信息。如果不加这个，知乎会禁止抓取。 抓取二进制数据在上面的例子中，我们抓取的是知乎的一个页面，实际上它返回的是一个 HTML 文档。如果想抓去图片、音频、视频等文件，应该怎么办呢？图片、音频、视频这些文件本质上都是由二进制码组成的，由于有特定的保存格式和对应的解析方式，我们才可以看到这些形形色色的多媒体。所以，想要抓取它们，就要拿到它们的二进制码。下面以 GitHub </span> 
     <span style="color:#000000;">的站点图标为例来看一下： </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import requests
response = requests.get("https://github.com/favicon.ico")
with
open(’github.ico’, ’wb’) as f:
f.write(response.content)</code></pre> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">Response </span> 
     <span style="color:#000000;">对象的两个属性，一个是 </span> 
     <span style="color:#000000;">text, </span> 
     <span style="color:#000000;">另一个是 </span> 
     <span style="color:#000000;">content. </span> 
     <span style="color:#000000;">其中前者表示字符串类型文本，后者表示 bytes </span> 
     <span style="color:#000000;">类型数据</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#000000;">同样地，音频和视频文件也可以用这种方法获取。 </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>2.4 </strong></span><span style="color:#1fbabe;">在 </span><span style="color:#1fbabe;"><strong>Headers </strong></span><span style="color:#1fbabe;">参数中携带 </span><span style="color:#1fbabe;"><strong>cookie </strong></span></h3> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">网站经常利用请求头中的 </span> 
     <span style="color:#000000;">Cookie </span> 
     <span style="color:#000000;">字段来做用户访问状态的保持，那么我们可以在 </span> 
     <span style="color:#000000;">headers </span> 
     <span style="color:#000000;">参数中添加 Cookie</span> 
     <span style="color:#000000;">，模拟普通用户的请求。 </span> 
    </div> 
    <h4><span style="color:#1fbabe;"><strong>2.4.1 Cookies </strong></span><span style="color:#1fbabe;">的获取 </span></h4> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">为了能够通过爬虫获取到登录后的页面，或者是解决通过 </span> 
     <span style="color:#000000;">cookie </span> 
     <span style="color:#000000;">的反爬，需要使用 </span> 
     <span style="color:#000000;">request 来处理 cookie </span> 
     <span style="color:#000000;">相关的请求 </span> 
    </div> 
    <div> 
     <pre><code class="language-python">import requests
url = ’https://www.baidu.com’
req = requests.get(url)
print(req.cookies)
# 响应的cookies
for key, value in req.cookies.items():
print(f"{key} = {value}") </code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">&lt;RequestsCookieJar[&lt;Cookie BDORZ=27315 </span> 
     <span style="color:#ff0000;">for </span> 
     <span style="color:#000000;">.baidu.com/&gt;]&gt; </span> 
    </div> 
    <div> 
     <span style="color:#000000;">BDORZ = 27315 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">这里我们首先调用 </span> 
     <span style="color:#000000;">cookies </span> 
     <span style="color:#000000;">属性即可成功得到 </span> 
     <span style="color:#000000;">Cookies </span> 
     <span style="color:#000000;">，可以发现它是 </span> 
     <span style="color:#000000;">RequestCookieJar </span> 
     <span style="color:#000000;">类型。然后用 items() </span> 
     <span style="color:#000000;">方法将其转化为元组组成的列表，遍历输出每一个 </span> 
     <span style="color:#000000;">Cookie </span> 
     <span style="color:#000000;">的名称和值，实现 Cookie 的遍历解析。 </span> 
    </div> 
    <h4><span style="color:#1fbabe;"><strong>2.4.2 </strong></span><span style="color:#1fbabe;">携带 </span><span style="color:#1fbabe;"><strong>Cookies </strong></span><span style="color:#1fbabe;">登录 </span></h4> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">带上 </span> 
     <span style="color:#000000;"><strong>cookie</strong></span> 
     <span style="color:#000000;">、</span> 
     <span style="color:#000000;"><strong>session </strong></span> 
     <span style="color:#000000;">的好处</span> 
     <span style="color:#000000;">：能够请求到登录之后的页面 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">带上 </span> 
     <span style="color:#000000;"><strong>cookie</strong></span> 
     <span style="color:#000000;">、</span> 
     <span style="color:#000000;"><strong>session </strong></span> 
     <span style="color:#000000;">的弊端： 一套 cookie </span> 
     <span style="color:#000000;">和 </span> 
     <span style="color:#000000;">session </span> 
     <span style="color:#000000;">往往和一个用户对应请求太快，请求次数太多，容易被服务器识别为爬虫</span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">不需要 cookie </span> 
     <span style="color:#000000;">的时候尽量不去使用 </span> 
     <span style="color:#000000;">cookie 但是为了获取登录之后的页面, </span> 
     <span style="color:#000000;">我们必须发送带有 </span> 
     <span style="color:#000000;">cookies </span> 
     <span style="color:#000000;">的请求 我们可以直接用 Cookie </span> 
     <span style="color:#000000;">来维持登录状态</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#000000;">下面以知乎为例来说明。首先登录知乎，将 </span> 
     <span style="color:#000000;">Headers 中的 Cookie </span> 
     <span style="color:#000000;">内容复制下来</span> 
     <span style="color:#000000;">. </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">➢ </span> 
     <span style="color:#000000;">从浏览器中复制 </span> 
     <span style="color:#000000;">User-Agent </span> 
     <span style="color:#000000;">和 </span> 
     <span style="color:#000000;">Cookie </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">➢ </span> 
     <span style="color:#000000;">浏览器中的请求头字段和值与 </span> 
     <span style="color:#000000;">headers </span> 
     <span style="color:#000000;">参数中必须一致 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">➢ </span> 
     <span style="color:#000000;">headers </span> 
     <span style="color:#000000;">请求参数字典中的 </span> 
     <span style="color:#000000;">Cookie </span> 
     <span style="color:#000000;">键对应的值是字符串 </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import requests
import re
# 构造请求头字典
headers = {
# 从浏览器中复制过来的User-Agent
"user-agent": ’Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (
KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36’,
# 从浏览器中复制过来的Cookie
"cookie": ’xxx这里是复制过来的cookie字符串’}
# 请求头参数字典中携带cookie字符串
response = requests.get(’https://www.zhihu.com/creator’, headers=headers)
data = re.findall(’CreatorHomeAnalyticsDataItem-title.*?&gt;(.*?)&lt;/div&gt;’,response.text)
print(response.status_code)
print(data)</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">当我们不携带 </span> 
     <span style="color:#000000;">Cookies </span> 
     <span style="color:#000000;">进行请求时： </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import requests
import re
headers = {"user-agent": ’Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36’}
response = requests.get(’https://www.zhihu.com/creator’, headers=headers)
data = re.findall(’CreatorHomeAnalyticsDataItem-title.*?&gt;(.*?)&lt;/div&gt;’,response.text)
print(response.status_code)
print(data)</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">------------------------------------ </span> 
    </div> 
    <div> 
     <span style="color:#000000;">200 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">[] </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">在打印的输出结果中为空</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#000000;">两者对比</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#000000;">则成功利用 </span> 
     <span style="color:#000000;">headers </span> 
     <span style="color:#000000;">参数携带 </span> 
     <span style="color:#000000;">cookie</span> 
     <span style="color:#000000;">，获取登陆后才能访问的页面! </span> 
    </div> 
    <h4><span style="color:#1fbabe;"><strong>2.4.3 cookies </strong>参数的使用 </span></h4> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">上一小节我们在 </span> 
     <span style="color:#000000;">headers </span> 
     <span style="color:#000000;">参数中携带 </span> 
     <span style="color:#000000;">cookie</span> 
     <span style="color:#000000;">，也可以使用专门的 </span> 
     <span style="color:#000000;">cookies </span> 
     <span style="color:#000000;">参数 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">1. cookies </span> 
     <span style="color:#000000;">参数的形式：字典 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">cookies = "cookie </span> 
     <span style="color:#000000;">的 </span> 
     <span style="color:#000000;">name":"cookie </span> 
     <span style="color:#000000;">的 </span> 
     <span style="color:#000000;">value" </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">➢ </span> 
     <span style="color:#000000;">该字典对应请求头中 </span> 
     <span style="color:#000000;">Cookie </span> 
     <span style="color:#000000;">字符串，以分号、空格分割每一对字典键值对 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">➢ </span> 
     <span style="color:#000000;">等号左边的是一个 </span> 
     <span style="color:#000000;">cookie </span> 
     <span style="color:#000000;">的 </span> 
     <span style="color:#000000;">name</span> 
     <span style="color:#000000;">，对应 </span> 
     <span style="color:#000000;">cookies </span> 
     <span style="color:#000000;">字典的 </span> 
     <span style="color:#000000;">key </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">➢ </span> 
     <span style="color:#000000;">等号右边对应 </span> 
     <span style="color:#000000;">cookies </span> 
     <span style="color:#000000;">字典的 </span> 
     <span style="color:#000000;">value </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">2.cookies </span> 
     <span style="color:#000000;">参数的使用方法 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">response = requests.get(url, cookies) </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">3. </span> 
     <span style="color:#000000;">将 </span> 
     <span style="color:#000000;">cookie </span> 
     <span style="color:#000000;">字符串转换为 </span> 
     <span style="color:#000000;">cookies </span> 
     <span style="color:#000000;">参数所需的字典： </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">cookies_dict </span> 
     <span style="color:#d73188;">= { </span> 
     <span style="color:#000000;">cookie . split (</span> 
     <span style="color:#990000;">’=’</span> 
     <span style="color:#000000;">)</span> 
     <span style="color:#d73188;">[</span> 
     <span style="color:#000000;">0</span> 
     <span style="color:#d73188;">]: </span> 
     <span style="color:#000000;">cookie . split (</span> 
     <span style="color:#990000;">’=’</span> 
     <span style="color:#000000;">)</span> 
     <span style="color:#d73188;">[-</span> 
     <span style="color:#000000;">1</span> 
     <span style="color:#d73188;">] for </span> 
     <span style="color:#000000;">cookie </span> 
     <span style="color:#d73188;">in </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">cookies_str . split (</span> 
     <span style="color:#990000;">’; ’</span> 
     <span style="color:#000000;">)</span> 
     <span style="color:#d73188;">} </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">4. </span> 
     <span style="color:#000000;">注意：</span> 
     <span style="color:#000000;">cookie </span> 
     <span style="color:#000000;">一般是有过期时间的，一旦过期需要重新获取 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">response = requests.get(url, cookies) </span> 
    </div> 
    <div> 
     <pre><code class="language-python">import requests
import re
url = ’https://www.zhihu.com/creator’
cookies_str = ’复制的cookies’
headers = {"user-agent": ’Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36’}
cookies_dict = {cookie.split(’=’, 1)[0]:cookie.split(’=’, 1)[-1] for cookie in
cookies_str.split(’; ’)}
# 请求头参数字典中携带cookie字符串
resp = requests.get(url, headers=headers, cookies=cookies_dict)
data = re.findall(’CreatorHomeAnalyticsDataItem-title.*?&gt;(.*?)&lt;/div&gt;’,resp.text)
print(resp.status_code)
print(data)</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">-------------------------------------- </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">200 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">[</span> 
     <span style="color:#ed028c;">’python</span> 
     <span style="color:#ed028c;">中该怎么把这种</span> 
     <span style="color:#ed028c;">id</span> 
     <span style="color:#ed028c;">不同但是</span> 
     <span style="color:#ed028c;">class</span> 
     <span style="color:#ed028c;">相同的方法写成一个整合呀？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">父母没有能力给我买电脑的钱，我该怎么办？’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">一句话形容一下你现在的生活状态？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">] </span> 
    </div> 
    <h4><span style="color:#1fbabe;"><strong>2.4.4 </strong></span><span style="color:#1fbabe;">构造 </span><span style="color:#1fbabe;"><strong>RequestsCookieJar </strong></span><span style="color:#1fbabe;">对象进行 </span><span style="color:#1fbabe;"><strong>cookies </strong></span><span style="color:#1fbabe;">设置 </span></h4> 
    <div> 
     <span style="color:#000000;">在这里我们还可以通过构造 </span> 
     <span style="color:#000000;">RequestsCookieJar </span> 
     <span style="color:#000000;">对象进行 </span> 
     <span style="color:#000000;">cookies </span> 
     <span style="color:#000000;">设置</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#000000;">示例代码如下</span> 
     <span style="color:#000000;">: </span> 
    </div> 
    <div> 
     <pre><code class="language-python">import requests
import re
url = ’https://www.zhihu.com/creator’
cookies_str = ’复制的cookies’
headers = {"user-agent": ’Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36’}
jar = requests.cookies.RequestsCookieJar()
for cookie in cookies_str.split(’;’):
key,value = cookie.split(’=’,1)
jar. set(key,value)
# 请求头参数字典中携带cookie字符串
resp = requests.get(url, headers=headers, cookies=jar)
data = re.findall(’CreatorHomeAnalyticsDataItem-title.*?&gt;(.*?)&lt;/div&gt;’,resp.text)
print(resp.status_code)
print(data)</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">-------------------------------------- </span> 
    </div> 
    <div> 
     <span style="color:#000000;">200 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">[</span> 
     <span style="color:#ed028c;">’python</span> 
     <span style="color:#ed028c;">中该怎么把这种</span> 
     <span style="color:#ed028c;">id</span> 
     <span style="color:#ed028c;">不同但是</span> 
     <span style="color:#ed028c;">class</span> 
     <span style="color:#ed028c;">相同的方法写成一个整合呀？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">父母没有能力给我买电脑的钱，我该怎么办？’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#ed028c;">一句话形容一下你现在的生活状态？</span> 
     <span style="color:#ed028c;">’</span> 
     <span style="color:#000000;">] </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">这里我们首先新建了一个 </span> 
     <span style="color:#000000;">RequestCookieJar </span> 
     <span style="color:#000000;">对象，然后将复制下来的 </span> 
     <span style="color:#000000;">cookies </span> 
     <span style="color:#000000;">利用 </span> 
     <span style="color:#000000;">split() </span> 
     <span style="color:#000000;">方法分剖，接着利用 set() </span> 
     <span style="color:#000000;">方法设置好每个 </span> 
     <span style="color:#000000;">Cookie </span> 
     <span style="color:#000000;">的 </span> 
     <span style="color:#000000;">key </span> 
     <span style="color:#000000;">和 </span> 
     <span style="color:#000000;">value </span> 
     <span style="color:#000000;">，然后通过调用 </span> 
     <span style="color:#000000;">requests </span> 
     <span style="color:#000000;">的 </span> 
     <span style="color:#000000;">get() </span> 
     <span style="color:#000000;">方 法并传递给 cookies </span> 
     <span style="color:#000000;">参数即可。当然，由于知乎本身的限制，</span> 
     <span style="color:#000000;">headers </span> 
     <span style="color:#000000;">参数也不能少，只不过不需 要在原来的 headers </span> 
     <span style="color:#000000;">参数里面设置 </span> 
     <span style="color:#000000;">cookie </span> 
     <span style="color:#000000;">字段了。测试后，发现同样可以正常登录知乎。</span> 
    </div> 
    <h4><span style="color:#1fbabe;"><strong>2.4.5 cookieJar </strong></span><span style="color:#1fbabe;">对象转换为 </span><span style="color:#1fbabe;"><strong>cookies </strong></span><span style="color:#1fbabe;">字典的方法 </span></h4> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">使用 </span> 
     <span style="color:#000000;">requests </span> 
     <span style="color:#000000;">获取的 </span> 
     <span style="color:#000000;">resposne </span> 
     <span style="color:#000000;">对象，具有 </span> 
     <span style="color:#000000;">cookies </span> 
     <span style="color:#000000;">属性。该属性值是一个 </span> 
     <span style="color:#000000;">cookieJar </span> 
     <span style="color:#000000;">类型，包含了对方服务器设置在本地的 cookie</span> 
     <span style="color:#000000;">。我们如何将其转换为 </span> 
     <span style="color:#000000;">cookies </span> 
     <span style="color:#000000;">字典呢？ </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">1. </span> 
     <span style="color:#000000;">转换方法 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">cookies_dict = requests.utils.dict_from_cookiejar(response.cookies) </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">2. </span> 
     <span style="color:#000000;">其中 </span> 
     <span style="color:#000000;">response.cookies </span> 
     <span style="color:#000000;">返回的就是 </span> 
     <span style="color:#000000;">cookieJar </span> 
     <span style="color:#000000;">类型的对象 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">3. </span> 
     <span style="color:#000000;">requests.utils.dict_from_cookiejar </span> 
     <span style="color:#000000;">函数返回 </span> 
     <span style="color:#000000;">cookies </span> 
     <span style="color:#000000;">字典 </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import requests
import re
url = 'https://www.zhihu.com/creator'
cookies_str = '复制的cookies'
headers = {"user-agent": 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36'}
cookie_dict = {cookie.split('=', 1)[0]:cookie.split('=', 1)[-1] for cookie in
cookies_str.split('; ')}
# 请求头参数字典中携带cookie字符串
resp = requests.get(url, headers=headers, cookies=cookies_dict)
data = re.findall('CreatorHomeAnalyticsDataItem-title.*?&gt;(.*?)&lt;/div&gt;',resp.text)
print(resp.status_code)
print(data)
# 可以把一个字典转化为一个requests.cookies.RequestsCookieJar对象
cookiejar = requests.utils.cookiejar_from_dict(cookie_dict, cookiejar=None,
overwrite=True)
type(cookiejar) # requests.cookies.RequestsCookieJar
type(resp.cookies) # requests.cookies.RequestsCookieJar
#构造RequestsCookieJar对象进行cookies设置其中jar的类型也是 requests.cookies.
RequestsCookieJar
#cookiejar转字典
requests.utils.dict_from_cookiejar(cookiejar)</code></pre> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>2.5 Timeout </strong></span><span style="color:#1fbabe;">设置 </span></h3> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        在平时网上冲浪的过程中，我们经常会遇到网络波动，这个时候，一个请求等了很久可能任 然没有结果。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        在爬虫中，一个请求很久没有结果，就会让整个项目的效率变得非常低，这个时候我们就需 要对请求进行强制要求，让他必须在特定的时间内返回结果，否则就报错。</span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">1. </span> 
     <span style="color:#000000;">超时参数 </span> 
     <span style="color:#000000;">timeout </span> 
     <span style="color:#000000;">的使用方法 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">response = requests.get(url, timeout=3) </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">2. timeout=3 </span> 
     <span style="color:#000000;">表示：发送请求后，</span> 
     <span style="color:#000000;">3 </span> 
     <span style="color:#000000;">秒钟内返回响应，否则就抛出异常 </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">url = 'http://www.tipdm.com/tipdm/index.html'
#设置超时时间为2
print('超时时间为2:',requests.get(url,timeout=2))
# 超时时间过短将会报错
requests.get(url,timeout = 0.1) #备注时间为0.001</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">超时时间为</span> 
     <span style="color:#000000;">2: &lt;Response [200]&gt; </span> 
    </div> 
    <h2><span style="color:#1fbabe;"><strong>三、</strong></span><span style="color:#1fbabe;">使用 </span><span style="color:#1fbabe;"><strong>Request </strong></span><span style="color:#1fbabe;">发送 </span><span style="color:#1fbabe;"><strong>POST </strong></span><span style="color:#1fbabe;">请求 </span></h2> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">思考：哪些地方我们会用到 </span> 
     <span style="color:#000000;">POST </span> 
     <span style="color:#000000;">请求？ </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">1. </span> 
     <span style="color:#000000;">登录注册（在 </span> 
     <span style="color:#000000;">web </span> 
     <span style="color:#000000;">工程师看来 </span> 
     <span style="color:#000000;">POST </span> 
     <span style="color:#000000;">比 </span> 
     <span style="color:#000000;">GET </span> 
     <span style="color:#000000;">更安全，</span> 
     <span style="color:#000000;">url </span> 
     <span style="color:#000000;">地址中不会暴露用户的账号密码等信息）</span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">2. </span> 
     <span style="color:#000000;">需要传输大文本内容的时候（</span> 
     <span style="color:#000000;">POST </span> 
     <span style="color:#000000;">请求对数据长度没有要求） </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">所以同样的，我们的爬虫也需要在这两个地方回去模拟浏览器发送 </span> 
     <span style="color:#000000;">post </span> 
     <span style="color:#000000;">请求其实发送 POST </span> 
     <span style="color:#000000;">请求与 </span> 
     <span style="color:#000000;">GET </span> 
     <span style="color:#000000;">方式很相似，只是参数的传递我们需要定义在 </span> 
     <span style="color:#000000;">data </span> 
     <span style="color:#000000;">中即可： </span> 
    </div> 
    <div> 
     <span style="color:#dc3545;"> </span> 
     <span style="color:#000000;"><strong>POST </strong></span> 
     <span style="color:#000000;">参数说明： </span> 
    </div> 
    <div> 
     <span style="color:#000000;">post(url, data=None, json=None, **kwargs): </span> 
    </div> 
    <div> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">URL: </span> 
     <span style="color:#000000;">待请求的网址 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">data </span> 
     <span style="color:#000000;">：</span> 
     <span style="color:#000000;">(</span> 
     <span style="color:#000000;">可选</span> 
     <span style="color:#000000;">) </span> 
     <span style="color:#000000;">字典，元组列表，字节或类似文件的对象，以在 </span> 
     <span style="color:#000000;">Request </span> 
     <span style="color:#000000;">的正文中发送 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">json: (</span> 
     <span style="color:#000000;">可选</span> 
     <span style="color:#000000;">)JSON </span> 
     <span style="color:#000000;">数据，发送到 </span> 
     <span style="color:#000000;">Request </span> 
     <span style="color:#000000;">类的主体中。 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">**kwargs: </span> 
     <span style="color:#000000;">可变长关键字参数 </span> 
    </div> 
    <div> 
     <pre><code class="language-python">import requests
payload = {’key1’: ’value1’, ’key2’: ’value2’}
req = requests.post("http://httpbin.org/post", data=payload)
print(req.text)</code></pre> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>3.1 POST </strong></span><span style="color:#1fbabe;">发送 </span><span style="color:#1fbabe;"><strong>JSON </strong></span><span style="color:#1fbabe;">数据 </span></h3> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">很多时候你想要发送的数据并非编码为表单形式的</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#000000;">发现特别在爬取很多 </span> 
     <span style="color:#000000;">java </span> 
     <span style="color:#000000;">网址中出现这个问题。如果你传递一个 string </span> 
     <span style="color:#000000;">而不是一个 </span> 
     <span style="color:#000000;">dict</span> 
     <span style="color:#000000;">，那么数据会被直接发布出去。我们可以使用json.dumps() 是将 </span> 
     <span style="color:#000000;">dict </span> 
     <span style="color:#000000;">转化成 </span> 
     <span style="color:#000000;">str </span> 
     <span style="color:#000000;">格式</span> 
     <span style="color:#000000;">; </span> 
     <span style="color:#000000;">此处除了可以自行对 </span> 
     <span style="color:#000000;">dict </span> 
     <span style="color:#000000;">进行编码，你还可以使用 </span> 
     <span style="color:#000000;">json </span> 
     <span style="color:#000000;">参 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">数直接传递，然后它就会被自动编码。</span> 
    </div> 
    <div> 
     <pre><code class="language-python">import json
import requests
url = ’http://httpbin.org/post’
payload = {’some’: ’data’}
req1 = requests.post(url, data=json.dumps(payload))
req2 = requests.post(url, json=payload)
print(req1.text)
print(req2.text)</code></pre> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">可以发现，我们成功获得了返回结果，其中 </span> 
     <span style="color:#000000;">form </span> 
     <span style="color:#000000;">部分就是提交的数据，这就证明 </span> 
     <span style="color:#000000;">POST </span> 
     <span style="color:#000000;">请求</span> 
     <span style="color:#000000;">成功发送了。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#ff8618;">笔记 </span> 
     <span style="color:#000000;"><strong>requests </strong>模块发送请求有 </span> 
     <span style="color:#000000;"><strong>data</strong></span> 
     <span style="color:#000000;">、</span> 
     <span style="color:#000000;"><strong>json</strong></span> 
     <span style="color:#000000;">、</span> 
     <span style="color:#000000;"><strong>params </strong></span> 
     <span style="color:#000000;">三种携带参数的方法 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">params </span> 
     <span style="color:#000000;">在 </span> 
     <span style="color:#000000;">get </span> 
     <span style="color:#000000;">请求中使用，</span> 
     <span style="color:#000000;">data</span> 
     <span style="color:#000000;">、</span> 
     <span style="color:#000000;">json </span> 
     <span style="color:#000000;">在 </span> 
     <span style="color:#000000;">post </span> 
     <span style="color:#000000;">请求中使用。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">data </span> 
     <span style="color:#000000;">可以接收的参数为：字典，字符串，字节，文件对象， </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">使用 </span> 
     <span style="color:#000000;">json </span> 
     <span style="color:#000000;">参数，不管报文是 </span> 
     <span style="color:#000000;">str </span> 
     <span style="color:#000000;">类型，还是 </span> 
     <span style="color:#000000;">dict </span> 
     <span style="color:#000000;">类型，如果不指定 </span> 
     <span style="color:#000000;">headers </span> 
     <span style="color:#000000;">中 </span> 
     <span style="color:#000000;">content-type </span> 
     <span style="color:#000000;">的 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">类型，默认是：</span> 
     <span style="color:#000000;">application/json</span> 
     <span style="color:#000000;">。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">使用</span> 
     <span style="color:#000000;">data</span> 
     <span style="color:#000000;">参数，报文是</span> 
     <span style="color:#000000;">dict</span> 
     <span style="color:#000000;">类型，如果不指定</span> 
     <span style="color:#000000;">headers</span> 
     <span style="color:#000000;">中</span> 
     <span style="color:#000000;">content-type</span> 
     <span style="color:#000000;">的类型，默认</span> 
     <span style="color:#000000;">application/x</span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">www-form-urlencoded</span> 
     <span style="color:#000000;">，相当于普通 </span> 
     <span style="color:#000000;">form </span> 
     <span style="color:#000000;">表单提交的形式，会将表单内的数据转换成键值对，此时数据可以从 request.POST </span> 
     <span style="color:#000000;">里面获取，而 </span> 
     <span style="color:#000000;">request.body </span> 
     <span style="color:#000000;">的内容则为 </span> 
     <span style="color:#000000;">a=1&amp;b=2 </span> 
     <span style="color:#000000;">的这种键值对形式。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">使用 </span> 
     <span style="color:#000000;">data </span> 
     <span style="color:#000000;">参数，报文是 </span> 
     <span style="color:#000000;">str </span> 
     <span style="color:#000000;">类型，如果不指定 </span> 
     <span style="color:#000000;">headers </span> 
     <span style="color:#000000;">中 </span> 
     <span style="color:#000000;">content-type </span> 
     <span style="color:#000000;">的类型，默认 </span> 
     <span style="color:#000000;">applica</span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">tion/json</span> 
     <span style="color:#000000;">。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">用 </span> 
     <span style="color:#000000;">data </span> 
     <span style="color:#000000;">参数提交数据时，</span> 
     <span style="color:#000000;">request.body </span> 
     <span style="color:#000000;">的内容则为 </span> 
     <span style="color:#000000;">a=1&amp;b=2 </span> 
     <span style="color:#000000;">的这种形式， </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">用 </span> 
     <span style="color:#000000;">json </span> 
     <span style="color:#000000;">参数提交数据时，</span> 
     <span style="color:#000000;">request.body </span> 
     <span style="color:#000000;">的内容则为</span> 
     <span style="color:#000000;">’"a": 1, "b": 2’ </span> 
     <span style="color:#000000;">的这种形式 </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>3.2 POST </strong></span><span style="color:#1fbabe;">上传文件 </span></h3> 
    <div> 
     <span style="color:#000000;">如果我们要使用爬虫上传文件，可以使用 </span> 
     <span style="color:#000000;">fifile </span> 
     <span style="color:#000000;">参数： </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">url = 'http://httpbin.org/post'
files = {'file': open('test.xlsx', 'rb')}
req = requests.post(url, files=files)
req.text</code></pre> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">如果有熟悉 </span> 
     <span style="color:#000000;">WEB </span> 
     <span style="color:#000000;">开发的伙伴应该知道，如果你发送一个非常大的文件作为 </span> 
     <span style="color:#000000;">multipart/form data 请求，你可能希望将请求做成数据流。默认下 </span> 
     <span style="color:#000000;">requests </span> 
     <span style="color:#000000;">不支持</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#000000;">你可以使用 </span> 
     <span style="color:#000000;">requests-toolbelt </span> 
     <span style="color:#000000;">三方库。 </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>3.3 </strong></span><span style="color:#1fbabe;">使用 </span><span style="color:#1fbabe;"><strong>POST </strong></span><span style="color:#1fbabe;">请求抓取网页 </span></h3> 
    <div> 
     <span style="color:#000000;">主要是找到待解析的网页</span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import requests
# 准备翻译的数据
kw =
input("请输入要翻译的词语：")
ps = {"kw": kw}
# 准备伪造请求
headers = {
# User-Agent：首字母大写，表示请求的身份信息；一般直接使用浏览器的身份信息，伪造
爬虫请求
# 让浏览器认为这个请求是由浏览器发起的[隐藏爬虫的信息]
"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (
KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36 Edg/85.0.564.41"
}
# 发送POST请求，附带要翻译的表单数据--以字典的方式进行传递
response = requests.post("https://fanyi.baidu.com/sug", data=ps)
# 打印返回的数据
# print(response.content)
print(response.content.decode("unicode_escape"))</code></pre> 
    </div> 
    <h2><span style="color:#1fbabe;"><strong>四、Requests </strong></span><span style="color:#1fbabe;">进阶 </span><span style="color:#1fbabe;"><strong>(1) * Session </strong></span><span style="color:#1fbabe;">会话维持 </span></h2> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        在这一部分主要介绍关于 </span> 
     <span style="color:#000000;">Session </span> 
     <span style="color:#000000;">会话维持，以及代理 </span> 
     <span style="color:#000000;">IP </span> 
     <span style="color:#000000;">的使用 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        在 </span> 
     <span style="color:#000000;">requests </span> 
     <span style="color:#000000;">中，如果直接利用 </span> 
     <span style="color:#000000;">get() </span> 
     <span style="color:#000000;">或 </span> 
     <span style="color:#000000;">post() </span> 
     <span style="color:#000000;">等方法的确可以做到模拟网页的请求，但是这实际上是相当于不同的会话，也就是说相当于你用了两个浏览器打开了不同的页面。设想这样一个 场景，第一个请求利用 post() </span> 
     <span style="color:#000000;">方法登录了某个网站，第二次想获取成功登录后的自己的个人信息， 你又用了一次 get() </span> 
     <span style="color:#000000;">方法去请求个人信息页面。实际上，这相当于打开了两个浏览器，这是两个完全不相关的会话，能成功获取个人信息吗？那当然不能。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        有小伙伴可能说了，我在两次请求时设置一样的 </span> 
     <span style="color:#000000;">cookies </span> 
     <span style="color:#000000;">不就行了？可以，但这样做起来显 得很烦琐，我们有更简单的解决方法。 其实解决这个问题的主要方法就是维持同一个会话，也就是相当于打开一个新的浏览器选项 卡而不是新开一个浏览器。但是我又不想每次设置 cookies</span> 
     <span style="color:#000000;">，那该怎么办呢？这时候就有了新的 利器一 Session </span> 
     <span style="color:#000000;">对象。利用它，我们可以方便地维护一个会话，而且不用担心 </span> 
     <span style="color:#000000;">cookies </span> 
     <span style="color:#000000;">的问题，它 会帮我们自动处理好。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        requests </span> 
     <span style="color:#000000;">模块中的 </span> 
     <span style="color:#000000;">Session </span> 
     <span style="color:#000000;">类能够自动处理发送请求获取响应过程中产生的 </span> 
     <span style="color:#000000;">cookie</span> 
     <span style="color:#000000;">，进而达到 状态保持的目的。接下来我们就来学习它 </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>4.1 requests.session </strong></span><span style="color:#1fbabe;">的作用以及应用场景 </span></h3> 
    <div> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">requests.session </span> 
     <span style="color:#000000;">的作用 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">自动处理 </span> 
     <span style="color:#000000;">cookie</span> 
     <span style="color:#000000;">，</span> 
     <span style="color:#000000;">即下一次请求会带上前一次的 </span> 
     <span style="color:#000000;"><strong>cookie </strong></span> 
    </div> 
    <div> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">requests.session </span> 
     <span style="color:#000000;">的应用场景</span> 
    </div> 
    <div> 
     <span style="color:#000000;">自动处理连续的多次请求过程中产生的 cookie </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>4.2 requests.session </strong></span><span style="color:#1fbabe;">使用方法 </span></h3> 
    <div> 
     <span style="color:#000000;">        session </span> 
     <span style="color:#000000;">实例在请求了一个网站后，对方服务器设置在本地的 </span> 
     <span style="color:#000000;">cookie </span> 
     <span style="color:#000000;">会保存在 </span> 
     <span style="color:#000000;">session </span> 
     <span style="color:#000000;">中，下 一次再使用 session </span> 
     <span style="color:#000000;">请求对方服务器的时候，会带上前一次的 </span> 
     <span style="color:#000000;">cookie </span> 
    </div> 
    <div> 
     <span style="color:#000000;">session </span> 
     <span style="color:#d73188;">= </span> 
     <span style="color:#000000;">requests . session () </span> 
     <span style="color:#008000;"><em># </em></span> 
     <span style="color:#008000;">实 例 化 </span> 
     <span style="color:#008000;"><em>session </em></span> 
     <span style="color:#008000;">对 象 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">response </span> 
     <span style="color:#d73188;">= </span> 
     <span style="color:#000000;">session . get ( url , headers , ...) </span> 
    </div> 
    <div> 
     <span style="color:#000000;">response </span> 
     <span style="color:#d73188;">= </span> 
     <span style="color:#000000;">session . post ( url , data , ...) </span> 
    </div> 
    <div> 
     <span style="color:#000000;">session </span> 
     <span style="color:#000000;">对象发送 </span> 
     <span style="color:#000000;">get </span> 
     <span style="color:#000000;">或 </span> 
     <span style="color:#000000;">post </span> 
     <span style="color:#000000;">请求的参数，与 </span> 
     <span style="color:#000000;">requests </span> 
     <span style="color:#000000;">模块发送请求的参数完全一致 </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>4.3 </strong></span><span style="color:#1fbabe;">使用 </span><span style="color:#1fbabe;"><strong>Session </strong></span><span style="color:#1fbabe;">维持 </span><span style="color:#1fbabe;"><strong>github </strong></span><span style="color:#1fbabe;">登录信息 </span></h3> 
    <div> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">对 </span> 
     <span style="color:#000000;">github </span> 
     <span style="color:#000000;">登陆以及访问登陆后才能访问的页面的整个完成过程进行抓包 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">确定登陆请求的 </span> 
     <span style="color:#000000;">url </span> 
     <span style="color:#000000;">地址、请求方法和所需的请求参数 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">- </span> 
     <span style="color:#000000;">部分请求参数在别的 </span> 
     <span style="color:#000000;">url </span> 
     <span style="color:#000000;">对应的响应内容中，可以使用 </span> 
     <span style="color:#000000;">re </span> 
     <span style="color:#000000;">模块获取 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">确定登陆后才能访问的页面的的 </span> 
     <span style="color:#000000;">url </span> 
     <span style="color:#000000;">地址和请求方法 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">利用 </span> 
     <span style="color:#000000;">requests.session </span> 
     <span style="color:#000000;">完成代码 </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import requests
import re
# 构造请求头字典
headers = {
'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (
KHTML, like Gecko) Chrome/67.0.3396.87 Safari/537.36',}
# 实例化session对象
session = requests.session()
# 访问登陆页获取登陆请求所需参数
response = session.get('https://github.com/login', headers=headers)
authenticity_token = re.search('name="authenticity_token" value="(.*?)" /&gt;',
response.text).group(1) # 使用正则获取登陆请求所需参数
# 构造登陆请求参数字典
data = {
'commit': 'Sign in', # 固定值
'utf8': ' ', # 固定值
'authenticity_token': authenticity_token, # 该参数在登陆页的响应内容中
'login':
input('输入github账号：'),
'password':
input('输入github账号：')}
# 发送登陆请求（无需关注本次请求的响应）
session.post('https://github.com/session', headers=headers, data=data)
# 打印需要登陆后才能访问的页面
response = session.get('https://github.com/settings/profile', headers=headers)
print(response.text)</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">可以使用文本对比工具进行校对</span> 
     <span style="color:#000000;">! </span> 
    </div> 
    <h2><span style="color:#1fbabe;"><strong>五、 Requests </strong></span><span style="color:#1fbabe;">进阶 </span><span style="color:#1fbabe;"><strong>(2) * </strong></span><span style="color:#1fbabe;">代理的使用 </span></h2> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        对于某些网站，在测试的时候请求几次，能正常获取内容。但是一旦开始大规模爬取，对于 大规模且频繁的请求，网站可能会弹出验证码，或者跳转到登录认证页面，更甚者可能会直接封禁客户端的 IP </span> 
     <span style="color:#000000;">，导致一定时间段内无法访问。那么，为了防止这种情况发生，我们需要设置代理来解决这个问题，这就需要用到 proxies </span> 
     <span style="color:#000000;">参数。可以用这样的方式设置： </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        proxy </span> 
     <span style="color:#000000;">代理参数通过指定代理 </span> 
     <span style="color:#000000;">ip</span> 
     <span style="color:#000000;">，让代理 </span> 
     <span style="color:#000000;">ip </span> 
     <span style="color:#000000;">对应的正向代理服务器转发我们发送的请求，那 么我们首先来了解一下代理 ip </span> 
     <span style="color:#000000;">以及代理服务器 </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>5.1 </strong></span><span style="color:#1fbabe;">使用代理的过程 </span></h3> 
    <div> 
     <span style="color:#000000;">1. </span> 
     <span style="color:#000000;">代理 </span> 
     <span style="color:#000000;">ip </span> 
     <span style="color:#000000;">是一个 </span> 
     <span style="color:#000000;">ip</span> 
     <span style="color:#000000;">，指向的是一个代理服务器 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">2. </span> 
     <span style="color:#000000;">代理服务器能够帮我们向目标服务器转发请求 </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>5.2 </strong></span><span style="color:#1fbabe;">正向代理和反向代理 </span></h3> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        前边提到 </span> 
     <span style="color:#000000;">proxy </span> 
     <span style="color:#000000;">参数指定的代理 </span> 
     <span style="color:#000000;">ip </span> 
     <span style="color:#000000;">指向的是正向的代理服务器，那么相应的就有反向服务器；现在来了解一下正向代理服务器和反向代理服务器的区别 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">从发送请求的一方的角度，来区分正向或反向代理 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">为浏览器或客户端（发送请求的一方）转发请求的，叫做正向代理 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">- </span> 
     <span style="color:#000000;">浏览器知道最终处理请求的服务器的真实 </span> 
     <span style="color:#000000;">ip </span> 
     <span style="color:#000000;">地址，例如 </span> 
     <span style="color:#000000;">VPN </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ 不为浏览器或客户端（发送请求的一方）转发请求、而是为最终处理请求的服务器转发请求的，叫做反向代理 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">- </span> 
     <span style="color:#000000;">浏览器不知道服务器的真实地址，例如 </span> 
     <span style="color:#000000;">nginx </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>5.3 </strong></span><span style="color:#1fbabe;">代理 </span><span style="color:#1fbabe;"><strong>ip(</strong></span><span style="color:#1fbabe;">代理服务器）的分类 </span></h3> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">根据代理 </span> 
     <span style="color:#000000;">ip </span> 
     <span style="color:#000000;">的匿名程度，代理 </span> 
     <span style="color:#000000;">IP </span> 
     <span style="color:#000000;">可以分为下面三类：</span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">➢ </span> 
     <span style="color:#000000;">透明代理 </span> 
     <span style="color:#000000;">(Transparent Proxy)</span> 
     <span style="color:#000000;">：透明代理虽然可以直接“隐藏”你的 </span> 
     <span style="color:#000000;">IP </span> 
     <span style="color:#000000;">地址，但是还是可以查到你是谁。目标服务器接收到的请求头如下： </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">REMOTE_ADDR </span> 
     <span style="color:#d73188;">= </span> 
     <span style="color:#000000;">Proxy IP </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">HTTP_VIA </span> 
     <span style="color:#d73188;">= </span> 
     <span style="color:#000000;">Proxy IP </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">HTTP_X_FORWARDED_FOR </span> 
     <span style="color:#d73188;">= </span> 
     <span style="color:#000000;">Your IP </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">➢ </span> 
     <span style="color:#000000;">匿名代理 </span> 
     <span style="color:#000000;">(Anonymous Proxy)</span> 
     <span style="color:#000000;">：使用匿名代理，别人只能知道你用了代理，无法知道你是谁。目标服务器接收到的请求头如下： </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">REMOTE_ADDR </span> 
     <span style="color:#d73188;">= </span> 
     <span style="color:#000000;">proxy IP </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">HTTP_VIA </span> 
     <span style="color:#d73188;">= </span> 
     <span style="color:#000000;">proxy IP </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">HTTP_X_FORWARDED_FOR </span> 
     <span style="color:#d73188;">= </span> 
     <span style="color:#000000;">proxy IP </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">➢ </span> 
     <span style="color:#000000;">高匿代理 </span> 
     <span style="color:#000000;">(Elite proxy </span> 
     <span style="color:#000000;">或 </span> 
     <span style="color:#000000;">High Anonymity Proxy)</span> 
     <span style="color:#000000;">：高匿代理让别人根本无法发现你是在用代理，所以是最好的选择。** </span> 
     <span style="color:#000000;">毫无疑问使用高匿代理效果最好 </span> 
     <span style="color:#000000;">**</span> 
     <span style="color:#000000;">。目标服务器接收到的请求头如下： </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">REMOTE_ADDR </span> 
     <span style="color:#d73188;">= </span> 
     <span style="color:#000000;">Proxy IP </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">HTTP_VIA </span> 
     <span style="color:#d73188;">= not </span> 
     <span style="color:#000000;">determined </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">HTTP_X_FORWARDED_FOR </span> 
     <span style="color:#d73188;">= not </span> 
     <span style="color:#000000;">determined </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">❖ </span> 
     <span style="color:#000000;">根据网站所使用的协议不同，需要使用相应协议的代理服务。从代理服务请求使用的协议可以分为： </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">➢ </span> 
     <span style="color:#000000;">http </span> 
     <span style="color:#000000;">代理：目标 </span> 
     <span style="color:#000000;">url </span> 
     <span style="color:#000000;">为 </span> 
     <span style="color:#000000;">http </span> 
     <span style="color:#000000;">协议 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">➢ </span> 
     <span style="color:#000000;">https </span> 
     <span style="color:#000000;">代理：目标 </span> 
     <span style="color:#000000;">url </span> 
     <span style="color:#000000;">为 </span> 
     <span style="color:#000000;">https </span> 
     <span style="color:#000000;">协议 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">➢ </span> 
     <span style="color:#000000;">socks </span> 
     <span style="color:#000000;">隧道代理（例如 </span> 
     <span style="color:#000000;">socks5 </span> 
     <span style="color:#000000;">代理）等： </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">✾ </span> 
     <span style="color:#000000;">1. socks </span> 
     <span style="color:#000000;">代理只是简单地传递数据包，不关心是何种应用协议（</span> 
     <span style="color:#000000;">FTP</span> 
     <span style="color:#000000;">、</span> 
     <span style="color:#000000;">HTTP </span> 
     <span style="color:#000000;">和HTTPS 等）。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">✾ </span> 
     <span style="color:#000000;">2. socks </span> 
     <span style="color:#000000;">代理比 </span> 
     <span style="color:#000000;">http</span> 
     <span style="color:#000000;">、</span> 
     <span style="color:#000000;">https </span> 
     <span style="color:#000000;">代理耗时少。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">✾ </span> 
     <span style="color:#000000;">3. socks </span> 
     <span style="color:#000000;">代理可以转发 </span> 
     <span style="color:#000000;">http </span> 
     <span style="color:#000000;">和 </span> 
     <span style="color:#000000;">https </span> 
     <span style="color:#000000;">的请求 </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>5.4 proxies </strong></span><span style="color:#1fbabe;">代理参数的使用 </span></h3> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        为了让服务器以为不是同一个客户端在请求；为了防止频繁向一个域名发送请求被封 </span> 
     <span style="color:#000000;">ip</span> 
     <span style="color:#000000;">，所以我们需要使用代理 ip</span> 
     <span style="color:#000000;">；那么我们接下来要学习 </span> 
     <span style="color:#000000;">requests </span> 
     <span style="color:#000000;">模块是如何使用代理 </span> 
     <span style="color:#000000;">ip </span> 
     <span style="color:#000000;">的基本用法 </span> 
    </div> 
    <div> 
     <pre><code class="language-python">response = requests . get ( url , proxies = proxies )
proxies 的形式：字典
proxies = {
" http ": " http :// 12.34.56.79: 9527 ",
" https ": " https :// 12.34.56.79: 9527 ",
}</code></pre> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">注意：如果 </span> 
     <span style="color:#000000;"><strong>proxies </strong></span> 
     <span style="color:#000000;">字典中包含有多个键值对，发送请求时将按照 </span> 
     <span style="color:#000000;"><strong>url </strong></span> 
     <span style="color:#000000;">地址的协议来选择使用相应的代理 <strong>ip</strong></span> 
    </div> 
    <div> 
     <pre><code class="language-python">import requests
proxies = {
"http": "http://124.236.111.11:80",
"https": "https:183.220.145.3:8080"}
req = requests.get(’http://www.baidu.com’,proxies =proxies)
req.status_code</code></pre> 
    </div> 
    <h2><span style="color:#1fbabe;"><strong>六、 Requests </strong></span><span style="color:#1fbabe;">进阶 </span><span style="color:#1fbabe;"><strong>(3) * SSL </strong></span><span style="color:#1fbabe;">证书验证 </span></h2> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">         此外，</span> 
     <span style="color:#000000;">requests </span> 
     <span style="color:#000000;">还提供了证书验证的功能。当发送 </span> 
     <span style="color:#000000;">HTTP </span> 
     <span style="color:#000000;">请求的时候，它会检查 </span> 
     <span style="color:#000000;">SSL </span> 
     <span style="color:#000000;">证书，我 们可以使用 verify </span> 
     <span style="color:#000000;">参数控制是否检查此证书。其实如果不加 </span> 
     <span style="color:#000000;">verify </span> 
     <span style="color:#000000;">参数的话，默认是 </span> 
     <span style="color:#000000;">True </span> 
     <span style="color:#000000;">，会向 动验证。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        现在我们用 </span> 
     <span style="color:#000000;">requests </span> 
     <span style="color:#000000;">来测试一下： </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import requests
url = 'https://cas.xijing.edu.cn/xjtyrz/login'
headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36'}
req = requests.get(url,headers=headers)</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">------------------------------------------------ </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">SSLError: HTTPSConnectionPool(host=</span> 
     <span style="color:#ed028c;">’cas.xijing.edu.cn’</span> 
     <span style="color:#000000;">, port=443): Max retries </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">exceeded with url: /xjtyrz/login (Caused by SSLError(SSLCertVerificationError(1, </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#ed028c;">’[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get</span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#ed028c;">local issuer certificate (_ssl.c:1123)’</span> 
     <span style="color:#000000;">))) </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">这里提示一个错误 </span> 
     <span style="color:#000000;">SSL Error </span> 
     <span style="color:#000000;">，表示证书验证错误。所以，如果请求一个 </span> 
     <span style="color:#000000;">HTTPS </span> 
     <span style="color:#000000;">站点，但是证书验证错误的页面时，就会报这样的错误，那么如何避免这个错误呢？很简单，把 verify </span> 
     <span style="color:#000000;">参数设置为 False </span> 
     <span style="color:#000000;">即可。相关代码如下： </span> 
    </div> 
    <div> 
     <pre><code class="language-python">import requests
url = 'https://www.jci.edu.cn/'
headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36'}
req = requests.get(url,headers=headers,verify=False)
req.status_code</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">------------------------------------------------ </span> 
    </div> 
    <div> 
     <span style="color:#000000;">200 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">找不到需要做 </span> 
     <span style="color:#000000;">SSL </span> 
     <span style="color:#000000;">验证的网页了，好气哦</span> 
     <span style="color:#000000;">! </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">不过我们发现报了一个警告它建议我们给它指定证书。我们可以通过设置忽略警告的方式来屏蔽这个警告： </span> 
    </div> 
    <div> 
     <pre><code class="language-python">import requests
from requests.packages import urllib3
urllib3.disable_warnings()
url = 'https://www.jci.edu.cn/'
headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36'}
req = requests.get(url,headers=headers,verify=False)
req.status_code</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">------------------------------------------------ </span> 
    </div> 
    <div> 
     <span style="color:#000000;">200 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">或者通过捕获警告到日志的方式忽略警告： </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import logging
import requests
logging.captureWarnings(True)
url = 'https://www.jci.edu.cn/'
headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36'}
req = requests.get(url,headers=headers,verify=False)
req.status_code</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">------------------------------------------------ </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">200 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">当然，我们也可以指定一个本地证书用作客户端证书，这可以是单个文件（包含密钥和证书）或一个包含两个文件路径的元组： </span> 
    </div> 
    <div> 
     <pre><code class="language-python">import requests
response = requests.get('https://www.12306.cn’,cert=(’./path/server.crt’,’/path/key'
))
print(response.status_code)</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">------------------------------------------------ </span> 
    </div> 
    <div> 
     <span style="color:#000000;">200 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">当然，上面的代码是演示实例，我们需要有 </span> 
     <span style="color:#000000;">crt </span> 
     <span style="color:#000000;">和 </span> 
     <span style="color:#000000;">ke y </span> 
     <span style="color:#000000;">文件，并且指定它们的路径。注意，本地私有证书的 key </span> 
     <span style="color:#000000;">必须是解密状态，加密状态的 </span> 
     <span style="color:#000000;">key </span> 
     <span style="color:#000000;">是不支持的。现在都很少有这种了网址了</span> 
     <span style="color:#000000;">! </span> 
    </div> 
    <h2><span style="color:#1fbabe;"><strong>七、Requests </strong></span><span style="color:#1fbabe;">库其他内容 </span></h2> 
    <h3><span style="color:#1fbabe;"><strong>7.1 </strong></span><span style="color:#1fbabe;">查看响应内容 </span></h3> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        发送请求后，得到的自然就是响应。在上面的实例中，我们使用 </span> 
     <span style="color:#000000;">text </span> 
     <span style="color:#000000;">和 </span> 
     <span style="color:#000000;">content </span> 
     <span style="color:#000000;">获取了响应的内容。此外，还有很多属性和方法可以用来获取其他信息，比如状态码、响应头、Cookies </span> 
     <span style="color:#000000;">等。 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">示例如下： </span> 
    </div> 
    <div> 
     <pre><code class="language-python">
import requests
url = 'https://www.baidu.com'
req = requests.get(url)
print(req.status_code)
# 响应状态码
print(req.text)
# 响应的文本内容
print(req.content)
# 响应的二进制内容
print(req.cookies)
# 响应的cookies
print(req.encoding)
# 响应的编码
print(req.headers)
# 响应的头部信息
print(req.url)
# 响应的网址
print(req.history)
# 响应的历史</code></pre> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>7.2 </strong></span><span style="color:#1fbabe;">查看状态码与编码 </span></h3> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">        使用 </span> 
     <span style="color:#000000;">rqg.status_code </span> 
     <span style="color:#000000;">的形式可查看服务器返回的状态码，而使用 </span> 
     <span style="color:#000000;">rqg.encoding </span> 
     <span style="color:#000000;">的形式可通过 服务器返回的 HTTP </span> 
     <span style="color:#000000;">头部信息进行网页编码。需要注意的是，当 </span> 
     <span style="color:#000000;">Requests </span> 
     <span style="color:#000000;">库猜测错误的时候，需 要手动指定 encoding </span> 
     <span style="color:#000000;">编码，避免返回的网页内容出现乱码 </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>7.3 </strong></span><span style="color:#1fbabe;">发送 </span><span style="color:#1fbabe;"><strong>get </strong></span><span style="color:#1fbabe;">请求，并手动指定编码 </span></h3> 
    <div> 
     <span style="color:#000000;">代码 </span> 
     <span style="color:#000000;">1-2: </span> 
     <span style="color:#000000;">发送 </span> 
     <span style="color:#000000;">get </span> 
     <span style="color:#000000;">请求，并手动指定编码</span> 
    </div> 
    <div></div> 
    <div> 
     <pre><code class="language-python">url = 'http://www.tipdm.com/tipdm/index.html'
rqg = requests.get(url)
print('状态码 ',rqg.status_code)
print('编码 ',rqg.encoding)
rqg.encoding = 'utf-8' #手动指定编码
print('修改后的编码 ',rqg.encoding)
# print(rqg.text)</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">状态码 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">200 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">编码 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">ISO-8859-1 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">修改后的编码 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">utf-8 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#ff8618;">笔记 </span> 
     <span style="color:#000000;">手动指定的方法并不灵活，无法自适应爬取过程中的不同的网页编码，而使用 </span> 
     <span style="color:#000000;">chardet </span> 
     <span style="color:#000000;">库的 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">方法比较简便灵活。</span> 
     <span style="color:#000000;">chardet </span> 
     <span style="color:#000000;">库是一个非常优秀的字符串</span> 
     <span style="color:#000000;">/</span> 
     <span style="color:#000000;">文件编码检测模块 </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>7.4 chardet </strong></span><span style="color:#1fbabe;">库的使用 </span></h3> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">chartdet </span> 
     <span style="color:#000000;">库的 </span> 
     <span style="color:#000000;">detect </span> 
     <span style="color:#000000;">方法可以检测给定字符串的编码，其语法格式如下。 </span> 
    </div> 
    <div style="text-align:justify;"></div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">chartdet.detect(byte_str) </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">detect</span> 
     <span style="color:#000000;">方法常用参数及其说明 </span> 
    </div> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">byte_str</span> 
     <span style="color:#000000;">： 接收</span> 
     <span style="color:#000000;">string</span> 
     <span style="color:#000000;">。表示需要检测编码的字符串。无默认值 </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>7.5 </strong></span><span style="color:#1fbabe;">使用 </span><span style="color:#1fbabe;"><strong>detect </strong></span><span style="color:#1fbabe;">方法检测编码并指定 </span></h3> 
    <div> 
     <span style="color:#000000;">代码 </span> 
     <span style="color:#000000;">1-3: </span> 
     <span style="color:#000000;">使用 </span> 
     <span style="color:#000000;">detect </span> 
     <span style="color:#000000;">方法检测编码并指定编码 </span> 
    </div> 
    <div>
        
     <pre><code class="language-python">import chardet
url = 'http://www.tipdm.com/tipdm/index.html'
rqg = requests.get(url)
print(rqg.encoding)
print(chardet.detect(rqg.content))
rqg.encoding = chardet.detect(rqg.content)['encoding']
# 访问字典元素
print(rqg.encoding)</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">ISO-8859-1 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">{<!-- --></span> 
     <span style="color:#ed028c;">’encoding’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’utf-8’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’confidence’</span> 
     <span style="color:#000000;">: 0.99, </span> 
     <span style="color:#ed028c;">’language’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’’</span> 
     <span style="color:#000000;">} </span> 
    </div> 
    <div> 
     <span style="color:#000000;">utf-8 </span> 
    </div> 
    <h3><span style="color:#1fbabe;"><strong>7.6 requests </strong></span><span style="color:#1fbabe;">库综合测试 </span></h3> 
    <div style="text-align:justify;"> 
     <span style="color:#000000;">         向网站</span> 
     <span style="color:#000000;">’http://www.tipdm.com/tipdm/index.html’ </span> 
     <span style="color:#000000;">发送一个完整 </span> 
     <span style="color:#000000;">GET </span> 
     <span style="color:#000000;">的请求</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#000000;">该请求包含链接、 请求头、响应头、超时时间和状态码, </span> 
     <span style="color:#000000;">并且编码正确设置。 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">                                    代码 </span> 
     <span style="color:#000000;">1-6: </span> 
     <span style="color:#000000;">生成完整的 </span> 
     <span style="color:#000000;">HTTP </span> 
     <span style="color:#000000;">请求 </span> 
    </div> 
    <div>
        
     <pre><code class="language-python"># 导入相关的库
import requests
import chardet
# 设置url
url = 'http://www.tipdm.com/tipdm/index.html'
# 设置请求头
headers = {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit
/537.36 (KHTML, like Gecko) Chrome/78.0.3904.97 Safari/537.36"}
# 生成GET请求，并设置延时为2
rqg = requests.get(url,headers=headers,timeout = 2)
# 查看状态码
print("状态码 ",rqg.status_code)
# 检测编码(查看编码)
print('编码 ',rqg.encoding)
# 使用chardet库的detect方法修正编码
rqg.encoding = chardet.detect(rqg.content)['encoding']
# 检测修正后的编码
print('修正后的编码: ',rqg.encoding)
#查看响应头
print('响应头： ',rqg.headers)
# 查看网页内容
#print(rqg.text)</code></pre> 
    </div> 
    <div> 
     <span style="color:#000000;">状态码 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">200 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">编码 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">ISO-8859-1 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">修正后的编码</span> 
     <span style="color:#000000;">: utf-8 </span> 
    </div> 
    <div> 
     <span style="color:#000000;">响应头： </span> 
     <span style="color:#000000;">{<!-- --></span> 
     <span style="color:#ed028c;">’Date’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’Mon, 18 Nov 2019 06:28:56 GMT’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’Server’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’Apache-Coyote/1.1’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’ </span> 
    </div> 
    <div> 
     <span style="color:#ed028c;">Accept-Ranges’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’bytes’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’ETag’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’W/"15693-1562553126764"’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’Last-Modified’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’ </span> 
    </div> 
    <div> 
     <span style="color:#ed028c;">Mon, 08 Jul 2019 02:32:06 GMT’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’Content-Type’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’text/html’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’Content-Length’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’ </span> 
    </div> 
    <div> 
     <span style="color:#ed028c;">15693’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’Keep-Alive’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’timeout=5, max=100’</span> 
     <span style="color:#000000;">, </span> 
     <span style="color:#ed028c;">’Connection’</span> 
     <span style="color:#000000;">: </span> 
     <span style="color:#ed028c;">’Keep-Alive’</span> 
     <span style="color:#000000;">}</span> 
    </div> 
    <div></div> 
    <div> 
     <h2>相关资源：</h2> 
     <h2><a href="https://download.csdn.net/download/dwf1354046363/20818468" title="Python网络爬虫教程详解.pdf">Python网络爬虫教程详解.pdf</a></h2> 
     <h2><a href="https://download.csdn.net/download/dwf1354046363/20818516" title="Python网络爬虫进阶教程.pdf">Python网络爬虫进阶教程.pdf</a></h2> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/84051bca4968f04626a4477e02050566/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在Android studio上开发APP之后，连接模拟器或者是打包APK发送给手机之后，找不到应用图标，但是手机里已经显示安装了。</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/534aab6005fa7be9d34308225a0f2ef2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">空心五角星python</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>