<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Hadoop集群搭建 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Hadoop集群搭建" />
<meta property="og:description" content="目录
一、引言
二、简介
三、下载&amp;解压及java环境搭建（三台服务器都需要）
四、修改hosts文件添加hadoop用户及免密登陆（三台服务器都需要）
五、hadoop配置（先配置一台然后复制）
六、启动hadoop并验证
官网：Apache Hadoop
一、引言 适用人群：了解hadoop的程序猿。
文章目的：记录hadoop集群安装，提供参考。
二、简介 Hadoop是一个由Apache基金会所开发的分布式系统基础架构。
用户可以在不了解分布式底层细节的情况下，开发分布式程序。充分利用集群的威力进行高速运算和存储。
Hadoop实现了一个分布式文件系统（Hadoop Distributed File System），简称HDFS。HDFS有高容错性的特点，并且设计用来部署在低廉的（low-cost）硬件上；而且它提供高吞吐量（high throughput）来访问应用程序的数据，适合那些有着超大数据集（large data set）的应用程序。HDFS放宽了（relax）POSIX的要求，可以以流的形式访问（streaming access）文件系统中的数据。
Hadoop的框架最核心的设计就是：HDFS和MapReduce。HDFS为海量的数据提供了存储，则MapReduce为海量的数据提供了计算。
三、下载&amp;解压及java环境搭建（三台服务器都需要） hadoop安装包可到http://mirrors.tuna.tsinghua.edu.cn/apache/ 网址下载安装包，文中所用版本包为hadoop-2.7.3.tar.gz。将安装包解压缩到/opt/tpapp/文件加下面。
hadoop会使用到java环境,需要早三台机器上分别安装上java环境：此处不做安装说明。
配置hadoop环境变量：
cd /etc/profile 添加以下内容
export HADOOP_HOME=/opt/tpapp/hadoop
export PATH=$PATH:$HADOOP_HOME/sbin
export PATH=$PATH:$HADOOP_HOME/bin
编辑保存后，执行source /etc/profile 使其生效。
四、修改hosts文件添加hadoop用户及免密登陆（三台服务器都需要） 修改hosts文件，添加hadoop集群的三台服务器域名配置，假设有A、B、C三台服务器，A为master主机。添加配置到hosts 10.100.40.70 master 10.100.40.80 node1 10.100.40.90 node2 添加专门操作hadoop集群的用户和用户组
添加hadoop 用户组，命令： groupadd hadoop 添加haddop用户名称，命令： useradd hadoop 将用户添加到用户组，命令： usermod -G hadoop hadoop 添加用户权限，命令： vi /etc/sudoers 在配置文件中添加hadoop ALL=(ALL) ALL 测试连通性，用hadoop用户执行连通性测试，命令：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/bd323074b4142038254b85519ced2097/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-14T09:00:00+08:00" />
<meta property="article:modified_time" content="2024-03-14T09:00:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Hadoop集群搭建</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80-toc" style="margin-left:80px;"><a href="#%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80" rel="nofollow">一、引言</a></p> 
<p id="%E4%BA%8C%E3%80%81%E7%AE%80%E4%BB%8B-toc" style="margin-left:80px;"><a href="#%E4%BA%8C%E3%80%81%E7%AE%80%E4%BB%8B" rel="nofollow">二、简介</a></p> 
<p id="%E4%B8%89%E3%80%81%E4%B8%8B%E8%BD%BD%26%E8%A7%A3%E5%8E%8B%E5%8F%8Ajava%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%EF%BC%88%E4%B8%89%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%BD%E9%9C%80%E8%A6%81%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E4%B8%89%E3%80%81%E4%B8%8B%E8%BD%BD%26%E8%A7%A3%E5%8E%8B%E5%8F%8Ajava%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%EF%BC%88%E4%B8%89%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%BD%E9%9C%80%E8%A6%81%EF%BC%89" rel="nofollow">三、下载&amp;解压及java环境搭建（三台服务器都需要）</a></p> 
<p id="%E5%9B%9B%E3%80%81%E4%BF%AE%E6%94%B9hosts%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0hadoop%E7%94%A8%E6%88%B7%E5%8F%8A%E5%85%8D%E5%AF%86%E7%99%BB%E9%99%86%EF%BC%88%E4%B8%89%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%BD%E9%9C%80%E8%A6%81%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E5%9B%9B%E3%80%81%E4%BF%AE%E6%94%B9hosts%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0hadoop%E7%94%A8%E6%88%B7%E5%8F%8A%E5%85%8D%E5%AF%86%E7%99%BB%E9%99%86%EF%BC%88%E4%B8%89%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%BD%E9%9C%80%E8%A6%81%EF%BC%89" rel="nofollow">四、修改hosts文件添加hadoop用户及免密登陆（三台服务器都需要）</a></p> 
<p id="%E4%BA%94%E3%80%81hadoop%E9%85%8D%E7%BD%AE%EF%BC%88%E5%85%88%E9%85%8D%E7%BD%AE%E4%B8%80%E5%8F%B0%E7%84%B6%E5%90%8E%E5%A4%8D%E5%88%B6%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E4%BA%94%E3%80%81hadoop%E9%85%8D%E7%BD%AE%EF%BC%88%E5%85%88%E9%85%8D%E7%BD%AE%E4%B8%80%E5%8F%B0%E7%84%B6%E5%90%8E%E5%A4%8D%E5%88%B6%EF%BC%89" rel="nofollow">五、hadoop配置（先配置一台然后复制）</a></p> 
<p id="%E5%85%AD%E3%80%81%E5%90%AF%E5%8A%A8hadoop%E5%B9%B6%E9%AA%8C%E8%AF%81-toc" style="margin-left:80px;"><a href="#%E5%85%AD%E3%80%81%E5%90%AF%E5%8A%A8hadoop%E5%B9%B6%E9%AA%8C%E8%AF%81" rel="nofollow">六、启动hadoop并验证</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p>官网：<a href="https://hadoop.apache.org/" rel="nofollow" title="Apache Hadoop">Apache Hadoop</a></p> 
<h4 id="%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80">一、引言</h4> 
<p>适用人群：了解hadoop的程序猿。</p> 
<p>文章目的：记录hadoop集群安装，提供参考。</p> 
<h4 id="%E4%BA%8C%E3%80%81%E7%AE%80%E4%BB%8B">二、简介</h4> 
<p>Hadoop是一个由Apache基金会所开发的分布式系统基础架构。</p> 
<p>用户可以在不了解分布式底层细节的情况下，开发分布式程序。充分利用集群的威力进行高速运算和存储。</p> 
<p>Hadoop实现了一个分布式文件系统（Hadoop Distributed File System），简称HDFS。HDFS有高容错性的特点，并且设计用来部署在低廉的（low-cost）硬件上；而且它提供高吞吐量（high throughput）来访问应用程序的数据，适合那些有着超大数据集（large data set）的应用程序。HDFS放宽了（relax）POSIX的要求，可以以流的形式访问（streaming access）文件系统中的数据。</p> 
<p>Hadoop的框架最核心的设计就是：HDFS和MapReduce。HDFS为海量的数据提供了存储，则MapReduce为海量的数据提供了计算。</p> 
<h4 id="%E4%B8%89%E3%80%81%E4%B8%8B%E8%BD%BD%26%E8%A7%A3%E5%8E%8B%E5%8F%8Ajava%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%EF%BC%88%E4%B8%89%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%BD%E9%9C%80%E8%A6%81%EF%BC%89">三、下载&amp;解压及java环境搭建（三台服务器都需要）</h4> 
<p>hadoop安装包可到http://mirrors.tuna.tsinghua.edu.cn/apache/ 网址下载安装包，文中所用版本包为hadoop-2.7.3.tar.gz。将安装包解压缩到/opt/tpapp/文件加下面。</p> 
<p>hadoop会使用到java环境,需要早三台机器上分别安装上java环境：此处不做安装说明。</p> 
<p>配置hadoop环境变量：</p> 
<p>cd /etc/profile 添加以下内容</p> 
<p>export HADOOP_HOME=/opt/tpapp/hadoop</p> 
<p>export PATH=$PATH:$HADOOP_HOME/sbin</p> 
<p>export PATH=$PATH:$HADOOP_HOME/bin</p> 
<p>编辑保存后，执行source /etc/profile 使其生效。</p> 
<h4 id="%E5%9B%9B%E3%80%81%E4%BF%AE%E6%94%B9hosts%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0hadoop%E7%94%A8%E6%88%B7%E5%8F%8A%E5%85%8D%E5%AF%86%E7%99%BB%E9%99%86%EF%BC%88%E4%B8%89%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%BD%E9%9C%80%E8%A6%81%EF%BC%89">四、修改hosts文件添加hadoop用户及免密登陆（三台服务器都需要）</h4> 
<ol><li>修改hosts文件，添加hadoop集群的三台服务器域名配置，假设有A、B、C三台服务器，A为master主机。添加配置到hosts <pre>10.100.40.70    master
10.100.40.80    node1
10.100.40.90    node2</pre> </li><li> <p>添加专门操作hadoop集群的用户和用户组</p> 
  <ul><li>添加hadoop 用户组，命令： <pre>groupadd hadoop</pre> </li><li>添加haddop用户名称，命令： <pre>useradd hadoop
</pre> </li><li>将用户添加到用户组，命令： <pre>usermod  -G hadoop hadoop</pre> </li><li>添加用户权限，命令： <pre>vi /etc/sudoers 
在配置文件中添加hadoop   ALL=(ALL)    ALL</pre> </li><li> <p>测试连通性，用hadoop用户执行连通性测试，命令：</p> <pre>ping + 配置的域名
</pre> </li></ul></li><li> <p>配置免密ssh登陆并验证连通性(A相对B、C免密登陆)<br> ssh免密登陆hadoop功能上需要用到所以这个需要配置，详情请见hadoop模块的免密登陆：<br> http://gw-publish.tpis.tpaic.com/ATS/index.do#/web/article/detail/web/ARTICLE/1e3e6313-eea7-4a50-affc-2fae1c799c57</p> </li></ol> 
<h4 id="%E4%BA%94%E3%80%81hadoop%E9%85%8D%E7%BD%AE%EF%BC%88%E5%85%88%E9%85%8D%E7%BD%AE%E4%B8%80%E5%8F%B0%E7%84%B6%E5%90%8E%E5%A4%8D%E5%88%B6%EF%BC%89">五、hadoop配置（先配置一台然后复制）</h4> 
<ol><li>创建data文件夹，命令： <pre>cd /opt/tpapp/hadoop/
mkdir -p dfs/name
mkdir -p dfs/data</pre> </li><li>修改配置文件，core-site.xml 添加以下内容： <pre><code class="language-XML">&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;fs.defaultFS&lt;/name&gt;
        &lt;value&gt;hdfs://master:9000&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;io.file.buffer.size&lt;/name&gt;
        &lt;value&gt;131072&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;
        &lt;value&gt;/usr/hadoop/tmp&lt;/value&gt;
        &lt;description&gt;Abase for other temporary   directories.&lt;/description&gt;
    &lt;/property&gt;
&lt;/configuration&gt;</code></pre> <p></p> </li><li>修改配置文件，hadoop-env.sh 添加以下内容： <pre>export JAVA_HOME=/opt/tpapp/jdk1.7.0_25
#JAVA_HOME 为机器上的JDK位置</pre> </li><li>修改配置文件，hdfs-site.xml 添加以下内容： <pre><code class="language-XML">&lt;configuration&gt;
	&lt;property&gt;
		&lt;name&gt;dfs.permissions&lt;/name&gt;
		&lt;value&gt;false&lt;/value&gt;
	&lt;/property&gt;

       &lt;property&gt;
                &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt;
               &lt;value&gt;master:9001&lt;/value&gt;
       &lt;/property&gt;
     &lt;property&gt;
             &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;
             &lt;value&gt;/usr/hadoop/dfs/name&lt;/value&gt;
       &lt;/property&gt;
      &lt;property&gt;
              &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;
              &lt;value&gt;/usr/hadoop/dfs/data&lt;/value&gt;
       &lt;/property&gt;
       &lt;property&gt;
               &lt;name&gt;dfs.replication&lt;/name&gt;
               &lt;value&gt;2&lt;/value&gt;
        &lt;/property&gt;
        &lt;property&gt;
                 &lt;name&gt;dfs.webhdfs.enabled&lt;/name&gt;
                  &lt;value&gt;true&lt;/value&gt;
         &lt;/property&gt;
&lt;/configuration&gt;</code></pre> <p></p> </li><li>修改配置文件，mapred-site.xml 添加以下内容： <pre><code class="language-XML">&lt;configuration&gt;
&lt;property&gt;
&lt;name&gt;mapreduce.framework.name&lt;/name&gt;
&lt;value&gt;yarn&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
&lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;
&lt;value&gt;master:10020&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
&lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;
&lt;value&gt;master:19888&lt;/value&gt;
&lt;/property&gt;
&lt;/configuration&gt;</code></pre> <p></p> </li><li>修改配置文件，slaves 添加以下内容： <pre>node1
node2</pre> </li><li>修改配置文件，yarn-site.xml 添加以下内容： <pre><code class="language-XML">&lt;configuration&gt;
        &lt;property&gt;
               &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;
               &lt;value&gt;mapreduce_shuffle&lt;/value&gt;
        &lt;/property&gt;
        &lt;property&gt;
&lt;name&gt;yarn.nodemanager.aux-services.mapreduce.shuffle.class&lt;/name&gt;
               &lt;value&gt;org.apache.hadoop.mapred.ShuffleHandler&lt;/value&gt;
        &lt;/property&gt;
        &lt;property&gt;
               &lt;name&gt;yarn.resourcemanager.address&lt;/name&gt;
               &lt;value&gt;master:8032&lt;/value&gt;
       &lt;/property&gt;
       &lt;property&gt;
               &lt;name&gt;yarn.resourcemanager.scheduler.address&lt;/name&gt;
               &lt;value&gt;master:8030&lt;/value&gt;
       &lt;/property&gt;
       &lt;property&gt;
            &lt;name&gt;yarn.resourcemanager.resource-tracker.address&lt;/name&gt;
             &lt;value&gt;master:8031&lt;/value&gt;
      &lt;/property&gt;
      &lt;property&gt;
              &lt;name&gt;yarn.resourcemanager.admin.address&lt;/name&gt;
               &lt;value&gt;master:8033&lt;/value&gt;
       &lt;/property&gt;
       &lt;property&gt;
               &lt;name&gt;yarn.resourcemanager.webapp.address&lt;/name&gt;
               &lt;value&gt;master:8088&lt;/value&gt;
       &lt;/property&gt;
&lt;/configuration&gt;</code></pre> <p></p> </li><li>修改完上文件后，将修改好的hadoop文件传给node1、node2服务器： <pre>scp -r /opt/tpapp/hadoop hadoop@node1:/opt/tpapp/
scp -r /opt/tpapp/hadoop hadoop@node2:/opt/tpapp/</pre> </li><li>使用root用户对文件夹opt/tpapp/hadoop进行归属操作 <pre>chown -R hadoop:hadoop opt/tpapp/hadoop</pre> </li></ol> 
<h4 id="%E5%85%AD%E3%80%81%E5%90%AF%E5%8A%A8hadoop%E5%B9%B6%E9%AA%8C%E8%AF%81">六、启动hadoop并验证</h4> 
<p>使用hadoop用户进入A服务器hadoop目录，（因为是集群部署，只需要在A master机器上启动即可）执行以下命令：</p> 
<pre>    bin/hdfs namenode -format
    sbin/start-all.sh</pre> 
<p>注：第一次初始化Hadoop集群式需要执行bin/hdfs namenode -format初始化文件系统设置相关参数清除多余文件，在正常使用过程中不需要执行这个命令，直接启停即可；否则文件系统会格式化掉已经存在的数据。</p> 
<p>启动后在master和node1、node2服务器执行命令：</p> 
<p>jps</p> 
<p>如果出现以下界面中红框内容则安装成功：</p> 
<p>master :</p> 
<p><img alt="" height="142" src="https://images2.imgbox.com/04/0a/3VPVzinf_o.png" width="184"></p> 
<p>node1、node2:</p> 
<p><img alt="" height="141" src="https://images2.imgbox.com/9d/38/z1xDLbcJ_o.png" width="245"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5937067468469c383ee82ede9eee486b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">尚硅谷SpringBoot3笔记 (一) 快速入门</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0dfc011b70f3731e4994695a3d053651/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">VsCode免密登录</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>