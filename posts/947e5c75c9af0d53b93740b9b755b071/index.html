<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Unity Socket网络编程(TCP) 简单例子-1 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Unity Socket网络编程(TCP) 简单例子-1" />
<meta property="og:description" content="开发工具：Visual Studio、Unity
开发语言：C#
【服务器端】
在VS创建一个C#空项目
代码如下：
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Net.Sockets;
using System.Net;
namespace NetworkServer
{
class Program
{
static void Main(string[] args)
{
/*创建一个socket对象*/
//寻址方式 套接字类型 协议方式
Socket tcpSocket = new Socket(AddressFamily.InterNetwork,SocketType.Stream,ProtocolType.Tcp);
/*绑定监听消息IP和端口号*/
IPAddress ip = IPAddress.Parse(&#34;127.0.0.1&#34;);
EndPoint endPoint = new IPEndPoint(ip, 6000);
tcpSocket.Bind(endPoint);//向操作系统申请一个ip和端口号
Console.WriteLine(&#34;服务器端启动完成&#34;);
/*开始监听客户端的连接请求*/
tcpSocket.Listen(100);//最多可以接收100个客户端请求
Socket socket = tcpSocket.Accept();//暂停当前线程，知道接收到客户端发来的连接请求；当接收到客户端的连接请求后，在本地服务器创建一个socket与客户端连接，并返回出来
Console.WriteLine(&#34;有个客户端连接进来&#34;);
/*向客户端发送消息*/
string messge;
messge=&#34;你好,我有什么可以帮助到你吗&#34;;
var date=ASCIIEncoding.UTF8.GetBytes(messge);
socket.Send(date);
/*从客户端接收消息*/
byte[] bt=new byte[1024];//设置一个消息接收缓冲区" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/947e5c75c9af0d53b93740b9b755b071/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-09-11T12:54:17+08:00" />
<meta property="article:modified_time" content="2018-09-11T12:54:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Unity Socket网络编程(TCP) 简单例子-1</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>开发工具：Visual Studio、Unity</p> 
<p>开发语言：C#</p> 
<p>【服务器端】</p> 
<p>在VS创建一个C#空项目</p> 
<p>代码如下：</p> 
<p> </p> 
<pre> </pre> 
<ol><li> <p><code>using System;</code></p> </li><li> <p><code>using System.Collections.Generic;</code></p> </li><li> <p><code>using System.Linq;</code></p> </li><li> <p><code>using System.Text;</code></p> </li><li> <p><code>using System.Threading.Tasks;</code></p> </li><li> <p><code>using System.Net.Sockets;</code></p> </li><li> <p><code>using System.Net;</code></p> </li><li> </li><li> <p><code>namespace NetworkServer</code></p> </li><li> <p><code>{<!-- --></code></p> </li><li> <p><code>class Program</code></p> </li><li> <p><code>{<!-- --></code></p> </li><li> <p><code>static void Main(string[] args)</code></p> </li><li> <p><code>{<!-- --></code></p> </li><li> <p><code>/*创建一个socket对象*/</code></p> </li><li> <p><code>//寻址方式 套接字类型 协议方式</code></p> </li><li> <p><code>Socket tcpSocket = new Socket(AddressFamily.InterNetwork,SocketType.Stream,ProtocolType.Tcp);</code></p> </li><li> </li><li> </li><li> <p><code>/*绑定监听消息IP和端口号*/</code></p> </li><li> <p><code>IPAddress ip = IPAddress.Parse("127.0.0.1");</code></p> </li><li> <p><code>EndPoint endPoint = new IPEndPoint(ip, 6000);</code></p> </li><li> <p><code>tcpSocket.Bind(endPoint);//向操作系统申请一个ip和端口号</code></p> </li><li> <p><code>Console.WriteLine("服务器端启动完成");</code></p> </li><li> </li><li> </li><li> <p><code>/*开始监听客户端的连接请求*/</code></p> </li><li> <p><code>tcpSocket.Listen(100);//最多可以接收100个客户端请求</code></p> </li><li> <p><code>Socket socket = tcpSocket.Accept();//暂停当前线程，知道接收到客户端发来的连接请求；当接收到客户端的连接请求后，在本地服务器创建一个socket与客户端连接，并返回出来</code></p> </li><li> <p><code>Console.WriteLine("有个客户端连接进来");</code></p> </li><li> </li><li> </li><li> <p><code>/*向客户端发送消息*/</code></p> </li><li> <p><code>string messge;</code></p> </li><li> <p><code>messge="你好,我有什么可以帮助到你吗";</code></p> </li><li> <p><code>var date=ASCIIEncoding.UTF8.GetBytes(messge);</code></p> </li><li> <p><code>socket.Send(date);</code></p> </li><li> </li><li> </li><li> <p><code>/*从客户端接收消息*/</code></p> </li><li> <p><code>byte[] bt=new byte[1024];//设置一个消息接收缓冲区</code></p> </li><li> <p><code>int message=socket.Receive(bt);//该状态处于一个暂停状态，知道接收到消息，并返回字节数</code></p> </li><li> <p><code>Console.WriteLine("接收到从客户端发来的消息:"+ASCIIEncoding.UTF8.GetString(bt));</code></p> </li><li> </li><li> </li><li> <p><code>Console.ReadLine();</code></p> </li><li> <p><code>}</code></p> </li><li> <p><code>}</code></p> </li><li> <p><code>}</code></p> </li></ol> 
<p><br> 【客户端】</p> 
<p>在unity下创建一个C#脚本，将其挂载在main camera上，用一个按钮触发函数</p> 
<p>代码如下：</p> 
<p> </p> 
<pre> </pre> 
<ol><li> <p><code>using UnityEngine;</code></p> </li><li> <p><code>using System.Collections;</code></p> </li><li> <p><code>using System.Net.Sockets;</code></p> </li><li> <p><code>using System.Net;</code></p> </li><li> <p><code>using System.Text;</code></p> </li><li> </li><li> <p><code>public class NetworkClient : MonoBehaviour </code></p> </li><li> <p><code>{<!-- --></code></p> </li><li> </li><li> <p><code>private Socket tcpSocket;</code></p> </li><li> </li><li> <p><code>public void OnBtnConnect()</code></p> </li><li> <p><code>{<!-- --></code></p> </li><li> <p><code>//创建socket</code></p> </li><li> <p><code>tcpSocket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);</code></p> </li><li> </li><li> <p><code>//连接服务器</code></p> </li><li> <p><code>tcpSocket.Connect(IPAddress.Parse("127.0.0.1"), 6000);</code></p> </li><li> <p><code>Debug.Log("连接服务器");</code></p> </li><li> </li><li> <p><code>//接收消息</code></p> </li><li> <p><code>byte[] bt = new byte[1024];</code></p> </li><li> <p><code>int messgeLength = tcpSocket.Receive(bt);</code></p> </li><li> <p><code>Debug.Log(ASCIIEncoding.UTF8.GetString(bt));</code></p> </li><li> </li><li> <p><code>//发送消息</code></p> </li><li> <p><code>tcpSocket.Send(ASCIIEncoding.UTF8.GetBytes("我有个问题"));</code></p> </li><li> <p><code>}</code></p> </li><li> <p><code>}</code></p> </li></ol> 
<p> </p> 
<p>点击按钮</p> 
<p>效果图如下，表明已经连接成功</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/2c/f2/k832kqgy_o.png"></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/f7/19/NKMdDTW7_o.png"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0de3007bb65bc67f1e39ce7c83111444/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">上拉和下拉的解释</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2c4d1db4704973c6ff6f262ab7f0eaef/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">分屏状态下分出的屏幕提示超出显示范围</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>