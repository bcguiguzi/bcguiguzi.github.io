<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Arcengine查询翻页 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Arcengine查询翻页" />
<meta property="og:description" content="*** Arcengine提供了IQueryFilterDefinition3的方法进行查询分页，但是这个方法是有版本要求的，我知道10.1和10.2版本没有这个接口，10.3和10.4版本没了解过，10.5版本以上是有的。但是用10.1版本怎么做翻页呢？我这里提供了两个思路：***
方法一：
//调转事件 /// &lt;summary&gt; /// 跳转到第一页 /// &lt;/summary&gt; private void ToFirstPage() { _currentPageIndex = 1; GetAttribute(FirstDataOID, FirstDataOID &#43; PageMaxSize, PageMaxSize, FirstDataOID, LastDataOID, false, true); } /// &lt;summary&gt; /// 上一页 /// &lt;/summary&gt; private void ToPreviousPage() { if (_currentPageIndex &gt; 1) { _currentPageIndex--; } GetAttribute(_pageFirstOID, _pageLastOID, PageMaxSize, FirstDataOID, LastDataOID, false, false); } /// &lt;summary&gt; /// 下一页 /// &lt;/summary&gt; private void ToNextPage() { if (_currentPageIndex &lt; _pageCount) { _currentPageIndex&#43;&#43;; GetAttribute(_pageFirstOID, _pageLastOID, PageMaxSize, FirstDataOID, LastDataOID, true, false); } } /// &lt;summary&gt; /// 跳转到最后一页 /// &lt;/summary&gt; private void ToLastPage() { _currentPageIndex = _pageCount; GetPageFirstDataOID(_featureLayer." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/0e23c201f6346e3d94c45d5be53beb8b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-24T10:55:20+08:00" />
<meta property="article:modified_time" content="2020-12-24T10:55:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Arcengine查询翻页</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>*** Arcengine提供了IQueryFilterDefinition3的方法进行查询分页，但是这个方法是有版本要求的，我知道10.1和10.2版本没有这个接口，10.3和10.4版本没了解过，10.5版本以上是有的。但是用10.1版本怎么做翻页呢？我这里提供了两个思路：***<br> 方法一：</p> 
<pre><code class="prism language-csharp"><span class="token comment">//调转事件</span>
  <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 跳转到第一页</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ToFirstPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _currentPageIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token function">GetAttribute</span><span class="token punctuation">(</span>FirstDataOID<span class="token punctuation">,</span> FirstDataOID <span class="token operator">+</span> PageMaxSize<span class="token punctuation">,</span> PageMaxSize<span class="token punctuation">,</span> FirstDataOID<span class="token punctuation">,</span> LastDataOID<span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 上一页</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ToPreviousPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>_currentPageIndex <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                _currentPageIndex<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token function">GetAttribute</span><span class="token punctuation">(</span>_pageFirstOID<span class="token punctuation">,</span> _pageLastOID<span class="token punctuation">,</span> PageMaxSize<span class="token punctuation">,</span> FirstDataOID<span class="token punctuation">,</span> LastDataOID<span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 下一页</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ToNextPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>_currentPageIndex <span class="token operator">&lt;</span> _pageCount<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                _currentPageIndex<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token function">GetAttribute</span><span class="token punctuation">(</span>_pageFirstOID<span class="token punctuation">,</span> _pageLastOID<span class="token punctuation">,</span> PageMaxSize<span class="token punctuation">,</span> FirstDataOID<span class="token punctuation">,</span> LastDataOID<span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 跳转到最后一页</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ToLastPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _currentPageIndex <span class="token operator">=</span> _pageCount<span class="token punctuation">;</span>
            <span class="token function">GetPageFirstDataOID</span><span class="token punctuation">(</span>_featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">,</span> _currentPageIndex<span class="token punctuation">,</span> PageMaxSize<span class="token punctuation">,</span> FirstDataOID<span class="token punctuation">,</span> LastDataOID<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">GetAttribute</span><span class="token punctuation">(</span>_pageFirstOID<span class="token punctuation">,</span> _pageFirstOID <span class="token operator">+</span> PageMaxSize<span class="token punctuation">,</span> PageMaxSize<span class="token punctuation">,</span> FirstDataOID<span class="token punctuation">,</span> LastDataOID<span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-csharp">  <span class="token comment">//二分法获取每一页的第一个OID，测试了10w+的数据，大概需要10s</span>
  <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 获取跳转页的PageFirstOID</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="featureClass"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="pageIndex"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="pageMaxSize"&gt;&lt;/param&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">GetPageFirstDataOID</span><span class="token punctuation">(</span><span class="token class-name">IFeatureClass</span> featureClass<span class="token punctuation">,</span> <span class="token keyword">int</span> pageIndex<span class="token punctuation">,</span> <span class="token keyword">int</span> pageMaxSize<span class="token punctuation">,</span> <span class="token keyword">int</span> firstDataOID<span class="token punctuation">,</span> <span class="token keyword">int</span> lastDataOID<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> featureClass<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>

                    <span class="token comment">//二分法获取翻页的pageFirstOID</span>
                    <span class="token keyword">int</span> previousDataCount <span class="token operator">=</span> <span class="token punctuation">(</span>pageIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> pageMaxSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token keyword">int</span> thisPageFirstDataOID <span class="token operator">=</span> <span class="token punctuation">(</span>pageIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> pageMaxSize<span class="token punctuation">;</span>
                    <span class="token keyword">int</span> thisPageLastDataOID <span class="token operator">=</span> lastDataOID<span class="token punctuation">;</span>
                    <span class="token keyword">int</span> thisMiddleDataOID <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>Math<span class="token punctuation">.</span><span class="token function">Floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>thisPageFirstDataOID <span class="token operator">+</span> thisPageLastDataOID<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.0</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token class-name">IQueryFilter</span> queryFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">IDataset</span> dataset <span class="token operator">=</span> _featureLayer<span class="token punctuation">.</span><span class="token class-name">FeatureClass</span> <span class="token keyword">as</span> IDataset<span class="token punctuation">;</span>
                    <span class="token class-name">IWorkspaceName</span> workSpaceName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>IDatasetName<span class="token punctuation">)</span>dataset<span class="token punctuation">.</span>FullName<span class="token punctuation">)</span><span class="token punctuation">.</span>WorkspaceName<span class="token punctuation">;</span>
                    <span class="token keyword">int</span> _thisPageDataCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

                    <span class="token comment">//对GDB和shape文件分别处理</span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span>_thisPageDataCount <span class="token operator">!=</span> previousDataCount<span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>workSpaceName<span class="token punctuation">.</span>WorkspaceFactoryProgID<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">"FileGDBWorkspaceFactory"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            queryFilter<span class="token punctuation">.</span>WhereClause <span class="token operator">=</span> $<span class="token string">" {featureClass.OIDFieldName} between {firstDataOID} and {thisMiddleDataOID} ORDER BY {featureClass.OIDFieldName} "</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>workSpaceName<span class="token punctuation">.</span>WorkspaceFactoryProgID<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">"ShapefileWorkspaceFactory"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            queryFilter<span class="token punctuation">.</span>WhereClause <span class="token operator">=</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{featureClass.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">" &gt;= {firstDataOID} AND "</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{featureClass.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">" &lt;= {thisMiddleDataOID} ORDER BY "</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{featureClass.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        _thisPageDataCount <span class="token operator">=</span> _featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span><span class="token function">FeatureCount</span><span class="token punctuation">(</span>queryFilter<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>_thisPageDataCount <span class="token operator">&gt;</span> previousDataCount<span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>

                            <span class="token keyword">if</span> <span class="token punctuation">(</span>thisPageLastDataOID <span class="token operator">-</span> thisPageFirstDataOID <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
                            <span class="token punctuation">{<!-- --></span>
                                thisPageLastDataOID <span class="token operator">=</span> thisPageFirstDataOID<span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            <span class="token keyword">else</span>
                            <span class="token punctuation">{<!-- --></span>
                                thisPageLastDataOID <span class="token operator">=</span> thisMiddleDataOID<span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_thisPageDataCount <span class="token operator">&lt;</span> previousDataCount<span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>thisPageLastDataOID <span class="token operator">-</span> thisPageFirstDataOID <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
                            <span class="token punctuation">{<!-- --></span>
                                thisPageFirstDataOID <span class="token operator">=</span> thisPageLastDataOID<span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            <span class="token keyword">else</span>
                            <span class="token punctuation">{<!-- --></span>
                                thisPageFirstDataOID <span class="token operator">=</span> thisMiddleDataOID<span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span>
                        <span class="token punctuation">{<!-- --></span>
                            _pageFirstOID <span class="token operator">=</span> thisMiddleDataOID<span class="token punctuation">;</span><span class="token comment">//_pageFirstOID 是全局变量</span>
                        <span class="token punctuation">}</span>
                        thisMiddleDataOID <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>Math<span class="token punctuation">.</span><span class="token function">Floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>thisPageFirstDataOID <span class="token operator">+</span> thisPageLastDataOID<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.0</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"翻页失败"</span><span class="token punctuation">,</span> <span class="token string">"错误提示："</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-csharp"><span class="token comment">//根据每一页第一个OID遍历数据，每次OID加上pageMaxSize，直到两个OID之间数据大于pageMaxSize时，遍历只取其中pageMaxSize个数据，记录pageLastOID</span>
   <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 获取属性表数据</span>
        <span class="token comment">/// &lt;param name="pageFirstOID"&gt;当前页最小OID&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="pageLastOID"&gt;当前页最大OID&lt;/param&gt; </span>
        <span class="token comment">/// &lt;param name="pageMaxSize"&gt;页面大小&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="firstDataOID"&gt;所有数据最小OID&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="lastDataOID"&gt;所有数据最大OID&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="downFlag"&gt;是否向下查询&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="firstOrLastFlag"&gt;是否是第一页或者最后一页&lt;/param&gt;</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">GetAttribute</span><span class="token punctuation">(</span><span class="token keyword">int</span> pageFirstOID<span class="token punctuation">,</span> <span class="token keyword">int</span> pageLastOID<span class="token punctuation">,</span> <span class="token keyword">int</span> pageMaxSize<span class="token punctuation">,</span> <span class="token keyword">int</span> firstDataOID<span class="token punctuation">,</span> <span class="token keyword">int</span> lastDataOID<span class="token punctuation">,</span> <span class="token keyword">bool</span> downFlag<span class="token punctuation">,</span> <span class="token keyword">bool</span> firstOrLastFlag<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">DataTable</span> dataTable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> _featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">ITable</span> lyrtable <span class="token operator">=</span> <span class="token punctuation">(</span>ITable<span class="token punctuation">)</span>_featureLayer<span class="token punctuation">;</span>
                <span class="token class-name">IQueryFilter</span> queryFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">IDataset</span> dataset <span class="token operator">=</span> _featureLayer<span class="token punctuation">.</span><span class="token class-name">FeatureClass</span> <span class="token keyword">as</span> IDataset<span class="token punctuation">;</span>
                <span class="token class-name">IWorkspaceName</span> workSpaceName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>IDatasetName<span class="token punctuation">)</span>dataset<span class="token punctuation">.</span>FullName<span class="token punctuation">)</span><span class="token punctuation">.</span>WorkspaceName<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>downFlag<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">int</span> _thisPageDataCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>firstOrLastFlag <span class="token operator">&amp;&amp;</span> pageLastOID <span class="token operator">&lt;</span> lastDataOID<span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        pageFirstOID <span class="token operator">=</span> pageLastOID <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>workSpaceName<span class="token punctuation">.</span>WorkspaceFactoryProgID<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">"FileGDBWorkspaceFactory"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">while</span> <span class="token punctuation">(</span>_thisPageDataCount <span class="token operator">&lt;</span> pageMaxSize <span class="token operator">&amp;&amp;</span> pageLastOID <span class="token operator">&lt;</span> lastDataOID<span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            queryFilter<span class="token punctuation">.</span>WhereClause <span class="token operator">=</span> $<span class="token string">"{lyrtable.OIDFieldName} between {pageFirstOID} and {pageLastOID + pageMaxSize} ORDER BY {lyrtable.OIDFieldName}"</span><span class="token punctuation">;</span>
                            _thisPageDataCount <span class="token operator">=</span> _featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span><span class="token function">FeatureCount</span><span class="token punctuation">(</span>queryFilter<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            pageLastOID <span class="token operator">=</span> pageLastOID <span class="token operator">+</span> pageMaxSize<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>workSpaceName<span class="token punctuation">.</span>WorkspaceFactoryProgID<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">"ShapefileWorkspaceFactory"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">while</span> <span class="token punctuation">(</span>_thisPageDataCount <span class="token operator">&lt;</span> pageMaxSize <span class="token operator">&amp;&amp;</span> pageLastOID <span class="token operator">&lt;</span> lastDataOID<span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            queryFilter<span class="token punctuation">.</span>WhereClause <span class="token operator">=</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{lyrtable.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">" &gt;= {pageFirstOID} AND "</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{lyrtable.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">" &lt;= { pageLastOID + pageMaxSize} ORDER BY "</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{lyrtable.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span><span class="token punctuation">;</span>
                            _thisPageDataCount <span class="token operator">=</span> _featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span><span class="token function">FeatureCount</span><span class="token punctuation">(</span>queryFilter<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            pageLastOID <span class="token operator">=</span> pageLastOID <span class="token operator">+</span> pageMaxSize<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">int</span> _thisPageDataCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>firstOrLastFlag <span class="token operator">&amp;&amp;</span> pageFirstOID <span class="token operator">&gt;</span> firstDataOID<span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        pageLastOID <span class="token operator">=</span> pageFirstOID <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>workSpaceName<span class="token punctuation">.</span>WorkspaceFactoryProgID<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">"FileGDBWorkspaceFactory"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">while</span> <span class="token punctuation">(</span>_thisPageDataCount <span class="token operator">&lt;</span> pageMaxSize <span class="token operator">&amp;&amp;</span> pageFirstOID <span class="token operator">&gt;</span> firstDataOID<span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            queryFilter<span class="token punctuation">.</span>WhereClause <span class="token operator">=</span> $<span class="token string">" {lyrtable.OIDFieldName} between {pageFirstOID - pageMaxSize} and {pageLastOID} ORDER BY {lyrtable.OIDFieldName} "</span><span class="token punctuation">;</span>
                            _thisPageDataCount <span class="token operator">=</span> _featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span><span class="token function">FeatureCount</span><span class="token punctuation">(</span>queryFilter<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            pageFirstOID <span class="token operator">=</span> pageFirstOID <span class="token operator">-</span> pageMaxSize<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>workSpaceName<span class="token punctuation">.</span>WorkspaceFactoryProgID<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">"ShapefileWorkspaceFactory"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">while</span> <span class="token punctuation">(</span>_thisPageDataCount <span class="token operator">&lt;</span> pageMaxSize <span class="token operator">&amp;&amp;</span> pageLastOID <span class="token operator">&lt;</span> lastDataOID<span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            queryFilter<span class="token punctuation">.</span>WhereClause <span class="token operator">=</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{lyrtable.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">" &gt;= {pageFirstOID - pageMaxSize} AND "</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{lyrtable.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">" &lt;= {pageLastOID} ORDER BY "</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{lyrtable.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span><span class="token punctuation">;</span>
                            _thisPageDataCount <span class="token operator">=</span> _featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span><span class="token function">FeatureCount</span><span class="token punctuation">(</span>queryFilter<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            pageFirstOID <span class="token operator">=</span> pageFirstOID <span class="token operator">-</span> pageMaxSize<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                dataTable <span class="token operator">=</span> <span class="token function">ToDataTable</span><span class="token punctuation">(</span>lyrtable<span class="token punctuation">,</span> _featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span>Fields<span class="token punctuation">,</span> _dataCount<span class="token punctuation">,</span> pageFirstOID<span class="token punctuation">,</span> pageLastOID<span class="token punctuation">,</span> pageMaxSize<span class="token punctuation">,</span> firstDataOID<span class="token punctuation">,</span> lastDataOID<span class="token punctuation">,</span> downFlag<span class="token punctuation">,</span> firstOrLastFlag<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取数据</span>
                _attributeTableData <span class="token operator">=</span> dataTable<span class="token punctuation">;</span>
                <span class="token function">RaisePropertyChanged</span><span class="token punctuation">(</span><span class="token function">nameof</span><span class="token punctuation">(</span>AttributeTableData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">/// &lt;summary&gt;  </span>
        <span class="token comment">/// 将ITable转换为DataTable  </span>
        <span class="token comment">/// &lt;/summary&gt;  </span>
        <span class="token comment">/// &lt;param name="mTable"&gt;数据&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="fields"&gt;字段&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="pageDataCount"&gt;总数据个数&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="pageFirstOID"&gt;当前一页最小OID&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="pageLastOID"&gt;当前页最大OID&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="pageMaxSize"&gt;页面大小&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="firstDataOID"&gt;所有数据最小OID&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="lastDataOID"&gt;所有数据最大OID&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="downFlag"&gt;是否向下查询&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;param name="firstOrLastFlag"&gt;是否是第一页或者最后一页&lt;/param&gt;  </span>
        <span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;  </span>
        <span class="token keyword">public</span> <span class="token class-name">DataTable</span> <span class="token function">ToDataTable</span><span class="token punctuation">(</span><span class="token class-name">ITable</span> lyrtable<span class="token punctuation">,</span> <span class="token class-name">IFields</span> fields<span class="token punctuation">,</span> <span class="token keyword">int</span> pageDataCount<span class="token punctuation">,</span> <span class="token keyword">int</span> pageFirstOID<span class="token punctuation">,</span> <span class="token keyword">int</span> pageLastOID<span class="token punctuation">,</span> <span class="token keyword">int</span> pageMaxSize<span class="token punctuation">,</span> <span class="token keyword">int</span> firstDataOID<span class="token punctuation">,</span> <span class="token keyword">int</span> lastDataOID<span class="token punctuation">,</span> <span class="token keyword">bool</span> downFlag<span class="token punctuation">,</span> <span class="token keyword">bool</span> firstOrLastFlag<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">DataTable</span> pTable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">string</span> queryFilterSubFilds <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            <span class="token keyword">string</span> geometryType <span class="token operator">=</span> <span class="token function">GetEsriGeometryType</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>IFeatureLayer<span class="token punctuation">)</span>lyrtable<span class="token punctuation">)</span><span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span>ShapeType<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fields<span class="token punctuation">.</span>FieldCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                pTable<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>fields<span class="token punctuation">.</span><span class="token function">get_Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>fields<span class="token punctuation">.</span><span class="token function">get_Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>IFeatureLayer<span class="token punctuation">)</span>lyrtable<span class="token punctuation">)</span><span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span>ShapeFieldName<span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    queryFilterSubFilds <span class="token operator">+</span><span class="token operator">=</span> fields<span class="token punctuation">.</span><span class="token function">get_Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">","</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>queryFilterSubFilds<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                queryFilterSubFilds <span class="token operator">=</span> queryFilterSubFilds<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> queryFilterSubFilds<span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">IQueryFilter</span> queryFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                queryFilter<span class="token punctuation">.</span>SubFields <span class="token operator">=</span> queryFilterSubFilds<span class="token punctuation">;</span>
                <span class="token class-name">IDataset</span> dataset <span class="token operator">=</span> lyrtable <span class="token keyword">as</span> IDataset<span class="token punctuation">;</span>
                <span class="token class-name">IWorkspaceName</span> workSpaceName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>IDatasetName<span class="token punctuation">)</span>dataset<span class="token punctuation">.</span>FullName<span class="token punctuation">)</span><span class="token punctuation">.</span>WorkspaceName<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>workSpaceName<span class="token punctuation">.</span>WorkspaceFactoryProgID<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">"FileGDBWorkspaceFactory"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    queryFilter<span class="token punctuation">.</span>WhereClause <span class="token operator">=</span> $<span class="token string">" {lyrtable.OIDFieldName} between {pageFirstOID} and {pageLastOID} ORDER BY {lyrtable.OIDFieldName} "</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>workSpaceName<span class="token punctuation">.</span>WorkspaceFactoryProgID<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">"ShapefileWorkspaceFactory"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    queryFilter<span class="token punctuation">.</span>WhereClause <span class="token operator">=</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{lyrtable.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">" &gt;= {pageFirstOID} AND "</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{lyrtable.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">" &lt;= {pageLastOID} ORDER BY "</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{lyrtable.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span><span class="token punctuation">;</span>

                <span class="token punctuation">}</span>

                <span class="token class-name">ICursor</span> pCursor <span class="token operator">=</span> lyrtable<span class="token punctuation">.</span><span class="token function">Search</span><span class="token punctuation">(</span>queryFilter<span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">IRow</span> pRrow <span class="token operator">=</span> pCursor<span class="token punctuation">.</span><span class="token function">NextRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> pRrowSize <span class="token operator">=</span> pageMaxSize<span class="token punctuation">;</span>
                <span class="token keyword">int</span> OIDIndex <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

                <span class="token comment">//获取OIDindex和当前页第一个值的OID</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>pRrow <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pRrow<span class="token punctuation">.</span>Fields<span class="token punctuation">.</span>FieldCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>lyrtable<span class="token punctuation">.</span>Fields<span class="token punctuation">.</span>Field<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Name <span class="token operator">==</span> lyrtable<span class="token punctuation">.</span>OIDFieldName<span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            OIDIndex <span class="token operator">=</span> i<span class="token punctuation">;</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    _pageFirstOID <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>pRrow<span class="token punctuation">.</span>OID<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">//遍历数据，获得Table</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>pRrow <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> pRrowSize <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name">DataRow</span> pRow <span class="token operator">=</span> pTable<span class="token punctuation">.</span><span class="token function">NewRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> StrRow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">string</span><span class="token punctuation">[</span>pRrow<span class="token punctuation">.</span>Fields<span class="token punctuation">.</span>FieldCount<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pRrow<span class="token punctuation">.</span>Fields<span class="token punctuation">.</span>FieldCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>pRrow<span class="token punctuation">.</span>Fields<span class="token punctuation">.</span>Field<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>IFeatureLayer<span class="token punctuation">)</span>lyrtable<span class="token punctuation">)</span><span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span>ShapeFieldName<span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            StrRow<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> pRrow<span class="token punctuation">.</span><span class="token function">get_Value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span>
                        <span class="token punctuation">{<!-- --></span>
                            StrRow<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> geometryType<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    pRow<span class="token punctuation">.</span>ItemArray <span class="token operator">=</span> StrRow<span class="token punctuation">;</span>
                    pTable<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>pRow<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    pRrow <span class="token operator">=</span> pCursor<span class="token punctuation">.</span><span class="token function">NextRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token operator">--</span>pRrowSize<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>pRrowSize <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> pRrow <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token comment">//获取当前页最后一个值的OID</span>
                    <span class="token punctuation">{<!-- --></span>
                        _pageLastOID <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>pRow<span class="token punctuation">[</span><span class="token class-name">OIDIndex</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> pTable<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> pTable<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p>方法二：</p> 
<pre><code class="prism language-csharp"><span class="token comment">//翻页</span>
  <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 跳转到第一页</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ToFirstPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _currentPageIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token function">ChangePage</span><span class="token punctuation">(</span>_currentPageIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
   <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 上一页</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ToPreviousPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>_currentPageIndex <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                _currentPageIndex<span class="token operator">--</span><span class="token punctuation">;</span>
                <span class="token function">ChangePage</span><span class="token punctuation">(</span>_currentPageIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 下一页</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ToNextPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>_currentPageIndex <span class="token operator">&lt;</span> _pageCount<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                _currentPageIndex<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token function">ChangePage</span><span class="token punctuation">(</span>_currentPageIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 跳转到最后一页</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ToLastPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _currentPageIndex <span class="token operator">=</span> _pageCount<span class="token punctuation">;</span>
            <span class="token function">ChangePage</span><span class="token punctuation">(</span>_currentPageIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-csharp"><span class="token comment">//先找到每一页的第一个OBJECTID储存起来。测试list只存一个OBJECTID字段时能储存1.2亿条，与OBJECTID字段的复杂度有关，如果只存每一页的OBJECTID是够用了（数据量大也可以做两层list嵌套，这里不做考虑）</span>
   <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">GetUniqueValue</span><span class="token punctuation">(</span><span class="token class-name">IFeatureClass</span> pFeatureClass<span class="token punctuation">,</span> <span class="token keyword">string</span> fieldName<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            OIDListArry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-method"><span class="token function">List</span><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> fieldIndex <span class="token operator">=</span> pFeatureClass<span class="token punctuation">.</span>Fields<span class="token punctuation">.</span><span class="token function">FindField</span><span class="token punctuation">(</span>fieldName<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 属性过滤器 </span>
            <span class="token class-name">IQueryFilter</span> pQueryFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            pQueryFilter<span class="token punctuation">.</span><span class="token function">AddField</span><span class="token punctuation">(</span>fieldName<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 要素游标</span>
            <span class="token class-name">IFeatureCursor</span> pFeatureCursor <span class="token operator">=</span> pFeatureClass<span class="token punctuation">.</span><span class="token function">Search</span><span class="token punctuation">(</span>pQueryFilter<span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">IFeature</span> pFeature <span class="token operator">=</span> pFeatureCursor<span class="token punctuation">.</span><span class="token function">NextFeature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> pageSizeCount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>pFeature <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>pageSizeCount <span class="token operator">%</span> PageMaxSize <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        OIDListArry<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>pFeature<span class="token punctuation">.</span>Value<span class="token punctuation">[</span>fieldIndex<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        pageSizeCount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    pageSizeCount<span class="token operator">++</span><span class="token punctuation">;</span>
                    pFeature <span class="token operator">=</span> pFeatureCursor<span class="token punctuation">.</span><span class="token function">NextFeature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"数据溢出!"</span><span class="token punctuation">,</span> <span class="token string">"错误提示："</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Warning<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 释放游标</span>
            System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices<span class="token punctuation">.</span>Marshal<span class="token punctuation">.</span><span class="token function">ReleaseComObject</span><span class="token punctuation">(</span>pFeatureCursor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">//取得当前页firstOID和lastOID（lastOID为下一页firstOID-1，可能不存在，但是我们这里只是需要取到包含有pageSizeMax个数据的这个范围就行了）</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ChangePage</span><span class="token punctuation">(</span><span class="token keyword">int</span> pageIndex<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> _featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">DataTable</span> pTable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">string</span> queryFilterSubFilds <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                <span class="token keyword">string</span> geometryType <span class="token operator">=</span> <span class="token function">GetEsriGeometryType</span><span class="token punctuation">(</span>_featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span>ShapeType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">IFields</span> fields <span class="token operator">=</span> _featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span>Fields<span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fields<span class="token punctuation">.</span>FieldCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    pTable<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>fields<span class="token punctuation">.</span><span class="token function">get_Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>fields<span class="token punctuation">.</span><span class="token function">get_Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> _featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span>ShapeFieldName<span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        queryFilterSubFilds <span class="token operator">+</span><span class="token operator">=</span> fields<span class="token punctuation">.</span><span class="token function">get_Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">","</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>queryFilterSubFilds<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    queryFilterSubFilds <span class="token operator">=</span> queryFilterSubFilds<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> queryFilterSubFilds<span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">try</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name">IQueryFilter</span> queryFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    queryFilter<span class="token punctuation">.</span>SubFields <span class="token operator">=</span> queryFilterSubFilds<span class="token punctuation">;</span>
                    <span class="token class-name">IDataset</span> dataset <span class="token operator">=</span> _featureLayer <span class="token keyword">as</span> IDataset<span class="token punctuation">;</span>
                    <span class="token class-name">IWorkspaceName</span> workSpaceName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>IDatasetName<span class="token punctuation">)</span>dataset<span class="token punctuation">.</span>FullName<span class="token punctuation">)</span><span class="token punctuation">.</span>WorkspaceName<span class="token punctuation">;</span>

                    <span class="token keyword">int</span> firtOID <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>OIDListArry<span class="token punctuation">[</span>pageIndex<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">int</span> lastOID <span class="token operator">=</span> firtOID <span class="token operator">+</span> PageMaxSize<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>pageIndex <span class="token operator">&lt;</span> <span class="token punctuation">(</span>OIDListArry<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        lastOID <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>OIDListArry<span class="token punctuation">[</span>pageIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{<!-- --></span>
                        lastOID <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span>workSpaceName<span class="token punctuation">.</span>WorkspaceFactoryProgID<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">"FileGDBWorkspaceFactory"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        queryFilter<span class="token punctuation">.</span>WhereClause <span class="token operator">=</span> $<span class="token string">" {_featureLayer.FeatureClass.OIDFieldName} &gt;= {firtOID} "</span> <span class="token operator">+</span> <span class="token punctuation">(</span>lastOID <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token punctuation">:</span> $<span class="token string">" and {_featureLayer.FeatureClass.OIDFieldName} &lt;= {lastOID} "</span><span class="token punctuation">)</span> <span class="token operator">+</span> $<span class="token string">" ORDER BY {_featureLayer.FeatureClass.OIDFieldName} "</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>workSpaceName<span class="token punctuation">.</span>WorkspaceFactoryProgID<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">"ShapefileWorkspaceFactory"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        queryFilter<span class="token punctuation">.</span>WhereClause <span class="token operator">=</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{_featureLayer.FeatureClass.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">" &gt;= {firtOID} "</span> <span class="token operator">+</span> <span class="token punctuation">(</span>lastOID <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token punctuation">:</span> <span class="token string">" AND\""</span> <span class="token operator">+</span> $<span class="token string">"{_featureLayer.FeatureClass.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">" &lt;= {lastOID} "</span><span class="token punctuation">)</span> <span class="token operator">+</span> $<span class="token string">" ORDER BY "</span> <span class="token operator">+</span> <span class="token string">"\""</span> <span class="token operator">+</span> $<span class="token string">"{_featureLayer.FeatureClass.OIDFieldName}"</span> <span class="token operator">+</span> <span class="token string">"\""</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token class-name">ICursor</span> pCursor <span class="token operator">=</span> _featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span><span class="token function">Search</span><span class="token punctuation">(</span>queryFilter<span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ICursor<span class="token punctuation">;</span>
                    <span class="token class-name">IRow</span> pRrow <span class="token operator">=</span> pCursor<span class="token punctuation">.</span><span class="token function">NextRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">//获取目标数据集对应源数据集索引字典</span>
                    Dictionary<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> TargetFieldsModel<span class="token operator">&gt;</span> targetsource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-method"><span class="token function">Dictionary</span><span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token class-name">TargetFieldsModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fields<span class="token punctuation">.</span>FieldCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token class-name">IField</span> tField <span class="token operator">=</span> fields<span class="token punctuation">.</span><span class="token function">get_Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        targetsource<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">TargetFieldsModel</span> <span class="token punctuation">{<!-- --></span> Name <span class="token operator">=</span> tField<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> TargetType <span class="token operator">=</span> tField<span class="token punctuation">.</span>Type <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">//遍历数据，获得Table</span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span>pRrow <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token class-name">DataRow</span> pRow <span class="token operator">=</span> pTable<span class="token punctuation">.</span><span class="token function">NewRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> StrRow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">string</span><span class="token punctuation">[</span>pRrow<span class="token punctuation">.</span>Fields<span class="token punctuation">.</span>FieldCount<span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">foreach</span> <span class="token punctuation">(</span>KeyValuePair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> TargetFieldsModel<span class="token operator">&gt;</span> keyValue <span class="token keyword">in</span> targetsource<span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>keyValue<span class="token punctuation">.</span>Value<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> _featureLayer<span class="token punctuation">.</span>FeatureClass<span class="token punctuation">.</span>ShapeFieldName<span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">{<!-- --></span>
                                StrRow<span class="token punctuation">[</span>keyValue<span class="token punctuation">.</span>Key<span class="token punctuation">]</span> <span class="token operator">=</span> pRrow<span class="token punctuation">.</span>Value<span class="token punctuation">[</span>keyValue<span class="token punctuation">.</span>Key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            <span class="token keyword">else</span>
                            <span class="token punctuation">{<!-- --></span>
                                StrRow<span class="token punctuation">[</span>keyValue<span class="token punctuation">.</span>Key<span class="token punctuation">]</span> <span class="token operator">=</span> geometryType<span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                        pRow<span class="token punctuation">.</span>ItemArray <span class="token operator">=</span> StrRow<span class="token punctuation">;</span>
                        pTable<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>pRow<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        pRrow <span class="token operator">=</span> pCursor<span class="token punctuation">.</span><span class="token function">NextRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>

                <span class="token punctuation">}</span>
                _attributeTableData <span class="token operator">=</span> pTable<span class="token punctuation">;</span>
                <span class="token function">RaisePropertyChanged</span><span class="token punctuation">(</span><span class="token function">nameof</span><span class="token punctuation">(</span>AttributeTableData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p><em><strong>10w+数据测试方法二比方法一效率跟高！</strong></em></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3e6dd8c2c42342936cb579b7b76282ad/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">hive的函数</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/177f472d14b9c481163e4be1f7de537f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">tensorflow一种简单的修改变量某个特定tensor值的方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>