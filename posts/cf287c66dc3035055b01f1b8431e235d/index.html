<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>linux 安装 mysql8.0  两台 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="linux 安装 mysql8.0  两台" />
<meta property="og:description" content="安装第一台，一般用到一个机器安装第二台的时候，一般机器上已经有一台mysql了，所以，如果你没有可以参考下面链接安装,链接没有指定mysql配置文件地址，因为一般大家都是这样子装的，所以，为了能同样流程在正式机器安装成功，所以我没有指定配置文件，保证测试机和正式一样的环境
linux安装 mysql8.0 ------------------------------------------------------------------现在安装第二个mysql----------------------------------------------------------------------
一定要先先看一下当前系统版本再下载对应的包，我开始没看，然后就一堆麻烦：
cat /proc/version
Linux version 3.10.0-862.14.4.el7.x86_64 (mockbuild@kbuilder.bsys.centos.org) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-28) (GCC) ) #1 SMP Wed Sep 26 15:12:11 UTC 2018
64位就下载对应64位
1.先下载 可以去官网直接下载，
mysql-8.0.17-linux-glibc2.12-x86_64.tar.xz下载链接
我是直接从官网下载的，因为我安装的服务器之前已经安装了一个mariadb了，所以我现在使用另外一个端口3308
将下载的文件移到/usr/local 目录
# 切换到当前目录
cd /usr/local
tar -xvf mysql-8.0.17-linux-glibc2.12-x86_64.tar.xz
开始用的 tar -zxvf mysql-8.0.17-linux-glibc2.12-x86_64.tar.xz,查资料说这个压缩包没有用gzip格式压缩，所以不用加z参数
ls,查看文件夹 然后重命名一下解压后的文件：
mv mysql-8.0.17-linux-glibc2.12-x86_64 mysql3308
新建data目录,用于存放数据
cd mysql3308/
#新建mysql用户、mysql用户组,如果之前已经建立过，就不用建立了
groupadd mysql
#给mysql添加用户 为 mysql
useradd mysql -g mysql
#将/usr/local/mysql的所有者及所属组改为mysql
chown -R mysql:mysql /usr/local/mysql3308/" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/cf287c66dc3035055b01f1b8431e235d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-09-16T14:53:28+08:00" />
<meta property="article:modified_time" content="2019-09-16T14:53:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">linux 安装 mysql8.0  两台</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>安装第一台，一般用到一个机器安装第二台的时候，一般机器上已经有一台mysql了，所以，如果你没有可以参考下面链接安装,链接没有指定mysql配置文件地址，因为一般大家都是这样子装的，所以，为了能同样流程在正式机器安装成功，所以我没有指定配置文件，保证测试机和正式一样的环境</p> 
<p><a href="https://blog.csdn.net/qq_40562912/article/details/100885212">linux安装 mysql8.0 </a></p> 
<p><span style="color:#f33b45;">------------------------------------------------------------------现在安装第二个mysql----------------------------------------------------------------------</span></p> 
<p>一定要先先看一下当前系统版本再下载对应的包，我开始没看，然后就一堆麻烦：</p> 
<p>cat /proc/version<br> Linux version 3.10.0-862.14.4.el7.x86_64 (mockbuild@kbuilder.bsys.centos.org) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-28) (GCC) ) #1 SMP Wed Sep 26 15:12:11 UTC 2018</p> 
<p>64位就下载对应64位</p> 
<p><strong>1.先下载 </strong></p> 
<p>可以去官网直接下载，</p> 
<p><a href="https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.17-linux-glibc2.12-x86_64.tar.xz" rel="nofollow">mysql-8.0.17-linux-glibc2.12-x86_64.tar.xz下载链接</a></p> 
<p>我是直接从官网下载的，因为我安装的服务器之前已经安装了一个mariadb了，所以我现在使用另外一个端口3308</p> 
<p>将下载的文件移到/usr/local 目录</p> 
<p># 切换到当前目录</p> 
<blockquote> 
 <p>cd /usr/local</p> 
 <p>tar -xvf <a href="https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.17-linux-glibc2.12-x86_64.tar.xz" rel="nofollow">mysql-8.0.17-linux-glibc2.12-x86_64.tar.xz</a></p> 
</blockquote> 
<p>开始用的 tar -zxvf <a href="https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.17-linux-glibc2.12-x86_64.tar.xz" rel="nofollow">mysql-8.0.17-linux-glibc2.12-x86_64.tar.xz</a>,查资料说这个压缩包没有用gzip格式压缩，所以不用加z参数</p> 
<p><img alt="" class="has" height="403" src="https://images2.imgbox.com/67/d1/D8JXJnbh_o.png" width="700"></p> 
<p>ls,查看文件夹 </p> 
<p><img alt="" class="has" height="276" src="https://images2.imgbox.com/a3/08/M9gZfofW_o.png" width="700"></p> 
<p>然后重命名一下解压后的文件：</p> 
<blockquote> 
 <p>mv mysql-8.0.17-linux-glibc2.12-x86_64 mysql3308</p> 
</blockquote> 
<p> </p> 
<p><img alt="" class="has" height="253" src="https://images2.imgbox.com/52/d1/z6XIQ0VQ_o.png" width="700"></p> 
<p>新建data目录,用于存放数据</p> 
<blockquote> 
 <p>cd mysql3308/</p> 
 <p>#新建mysql用户、mysql用户组,如果之前已经建立过，就不用建立了</p> 
 <p>groupadd mysql</p> 
 <p>#给mysql添加用户 为 mysql</p> 
 <p>useradd mysql -g mysql</p> 
 <p>#将/usr/local/mysql的所有者及所属组改为mysql</p> 
 <p>chown -R mysql:mysql /usr/local/mysql3308/</p> 
 <p>chmod -R 755 /usr/local/mysql3308/</p> 
</blockquote> 
<p>配置参数</p> 
<p>在mysql3308下新增文件夹data,var,etc备用，etc是用来放配置文件的</p> 
<p>ls 查看一下当前文件目录</p> 
<p>将没有的文件夹添加一下</p> 
<blockquote> 
 <p><span style="color:#86ca5e;">mkdir data;</span></p> 
 <p>mkdir var</p> 
 <p><span style="color:#86ca5e;">mkdir etc</span></p> 
</blockquote> 
<p> </p> 
<p><img alt="" class="has" height="113" src="https://images2.imgbox.com/0f/e9/RsQnuzAs_o.png" width="900"></p> 
<p><strong> 创建数据库配置文件</strong>，一般为my.cnf 。其实在根目录  /etc/my.cnf 有这个文件，所以只需要复制就行了，如果根目录下没有的话，就需要使用touch命令创建新的空文件</p> 
<blockquote> 
 <p>ls /etc</p> 
 <p>cp /etc/my.cnf etc/</p> 
 <p>ls etc/</p> 
</blockquote> 
<p>编辑刚刚复制的 <strong>my.cnf</strong></p> 
<blockquote> 
 <p>vi etc/my.cnf<strong> </strong></p> 
 <p><strong>[mysqld]<br> basedir = /usr/local/mysql3308<br> datadir = /usr/local/mysql3308/data<br> socket = /usr/local/mysql3308/tmp/mysql.sock<br> port = 3308</strong></p> 
 <p><strong>[client]<br> socket = /usr/local/mysql3308/tmp/mysql.sock<br> default-character-set=utf8</strong></p> 
 <p><strong>[mysqld_safe]<br> log-error=/usr/local/mysql3308/mysql-log/error.log<br> pid-file=/usr/local/mysql3308/mysql.pid</strong></p> 
</blockquote> 
<p>#如果/usr/local/mysql3308/目录下没有tmp文件，手动创建，并且配置权限：</p> 
<blockquote> 
 <p>mkdir tmp<br> chmod 777 ./tmp</p> 
 <p>mkdir mysql-log</p> 
 <p>chmod 777 ./mysql-log</p> 
 <p>cd mysql-log</p> 
 <p>touch error.log</p> 
</blockquote> 
<p><img alt="" class="has" height="265" src="https://images2.imgbox.com/4f/72/gdQ2Lx5p_o.png" width="463"></p> 
<p><strong>安装依赖包--如果已经安装过就不要执行了，虽然执行也没啥问题，会再次检查一遍</strong></p> 
<blockquote> 
 <p>yum -y install make gcc-c++ cmake bison-devel ncurses ncurses-devel libaio-devel</p> 
</blockquote> 
<p><img alt="" class="has" height="469" src="https://images2.imgbox.com/d4/73/Rt7Gnuzc_o.png" width="1000"></p> 
<p>指定刚刚编写的配置文件初始化：a/NRxfzh;87p</p> 
<p>要在mysql3308 文件夹下面执行：</p> 
<blockquote> 
 <p><strong>cd /usr/local/mysql3308</strong></p> 
 <p>./bin/mysqld --defaults-file=<strong>/usr/local/mysql3308/etc/my.cnf</strong> --initialize --user=mysql</p> 
</blockquote> 
<p>#这个命令和mysql5.7之前的命令不一样了，之前命令是：bin/mysql_install_db --user=mysql，但是之后的版本已经被#mysqld --initialize替代</p> 
<p>#mysql5.7版本之上会初始化话一个密码，在这里要记住这个初始化密码 Y_Bhf!hjo0k0，在下面初次登录会用上。 </p> 
<pre class="has"><code class="language-bash">2019-09-17T03:01:00.156712Z 0 [System] [MY-013169] [Server] /usr/local/mysql3308/bin/mysqld (mysqld 8.0.17) initializing of server in progress as process 1554
2019-09-17T03:01:05.651404Z 5 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: Y_Bhf!hjo0k0
2019-09-17T03:01:07.114536Z 0 [System] [MY-013170] [Server] /usr/local/mysql3308/bin/mysqld (mysqld 8.0.17) initializing of server has completed
</code></pre> 
<p>./bin/mysqld_safe --defaults-file=<strong>/usr/local/mysql3308/etc/my.cnf</strong> --user=mysql &amp;</p> 
<blockquote> 
 <p>#打开当前mysql的启动文件</p> 
 <p>一定要确保这里改正确，否则会报错：<span style="color:#f33b45;">Starting MySQL....The server quit without updating PID file[FAILED]ocal/mysql3308/data/iZ2zeborh4vm8ozw6k3j07Z.pid).</span></p> 
 <p>vi support-files/mysql.server </p> 
 <p>指定地址和配置文件的位置：</p> 
 <p>改1：并删掉下面的conf=/etc/my.cnf</p> 
 <p>basedir=/usr/local/mysql3308<br> datadir=/usr/local/mysql3308/data<br> conf=/usr/local/mysql3308/etc/my.cnf</p> 
</blockquote> 
<p><img alt="" class="has" height="88" src="https://images2.imgbox.com/50/23/fUpHVKoo_o.png" width="600"></p> 
<blockquote> 
 <p>改2：加 extra_args="-c $conf"</p> 
</blockquote> 
<p><img alt="" class="has" height="143" src="https://images2.imgbox.com/dc/14/RPWW3MUh_o.png" width="572"></p> 
<blockquote> 
 <p>改3 --增加绿色部分</p> 
 <p>$bindir/mysqld_safe<strong><span style="color:#86ca5e;"> --defaults-file="$conf"</span></strong> --datadir="$datadir" --pid-file="$mysqld_pid_file_path" $other_args &gt;/dev/null &amp;</p> 
</blockquote> 
<p><img alt="" class="has" height="167" src="https://images2.imgbox.com/1f/1b/63L1JEvY_o.png" width="1000"> </p> 
<p> </p> 
<blockquote> 
 <p>support-files/mysql.server start</p> 
</blockquote> 
<p> <img alt="" class="has" height="142" src="https://images2.imgbox.com/4e/24/KUPeOSlV_o.png" width="700"></p> 
<p>查看是否已经启动起来 </p> 
<blockquote> 
 <p>netstat -ntlp</p> 
</blockquote> 
<p><img alt="" class="has" height="145" src="https://images2.imgbox.com/16/21/w7Nc077T_o.png" width="700"></p> 
<p>如图，3308，已经启动起来了</p> 
<p>#将3308 mysql加入服务</p> 
<blockquote> 
 <p>cp /usr/local/mysql3308/support-files/mysql.server /etc/init.d/mysql3308</p> 
</blockquote> 
<p>#开机自启</p> 
<blockquote> 
 <p>chkconfig --add mysql3308</p> 
 <p>显示服务列表</p> 
 <p>chkconfig --list</p> 
 <p>#如果3,4,5都是开的就说明是自启设置成功</p> 
</blockquote> 
<p><img alt="" class="has" height="108" src="https://images2.imgbox.com/30/29/SdHwy1br_o.png" width="600"> </p> 
<blockquote> 
 <p><strong><span style="color:#86ca5e;">重启数据库的命令：/etc/init.d/mysql3308 restart</span></strong></p> 
</blockquote> 
<p>访问mysql:</p> 
<blockquote> 
 <p>第二个数据库必须使用<code>socket</code>进入，否则默认为第一个数据库。因为配置了全局环境变量</p> 
 <p>cd bin/</p> 
 <p>mysql -uroot -p -h 127.0.0.1 --socket=../tmp/mysql.sock --port=3308</p> 
 <p>输入初始化的密码：a/NRxfzh;87p</p> 
 <p>alter user 'root'@'localhost' identified by '111111';</p> 
 <p>flush privileges;</p> 
</blockquote> 
<p><img alt="" class="has" height="309" src="https://images2.imgbox.com/89/2a/HzDWBseW_o.png" width="800"></p> 
<blockquote> 
 <p>远程连接用户设置：</p> 
 <p>mysql -uroot -p -h 127.0.0.1 --socket=../tmp/mysql.sock --port=3308<br> use mysql;<br> select 'host' from user where user='root';<br> update user set host = '%' where user ='root';<br> flush privileges;<br> select 'host' from user where user='root';</p> 
</blockquote> 
<p>然后将阿里云安全组防火墙3308 ，打开，使用navcat远程连接</p> 
<p><img alt="" class="has" height="172" src="https://images2.imgbox.com/cf/fe/ICKYNkpY_o.png" width="800"></p> 
<p><img alt="" class="has" height="359" src="https://images2.imgbox.com/97/ac/DXsmD1yY_o.png" width="300"></p> 
<p>如上图所示，即为安装cheng</p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/311bd672de52bc70e49e429340c88a48/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">结合python的一次arcgis等时圈划分实践</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cea328ae28fe50c6655008d541f43022/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">sqlzoo--using null</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>