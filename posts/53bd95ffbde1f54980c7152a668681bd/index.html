<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>高通 gpio控制方式 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="高通 gpio控制方式" />
<meta property="og:description" content="前言 随着内核的发展，linux驱动框架在不断的变化。很早很早以前，出现了gpio子系统，后来又出现了pinctrl子系统。对于一个驱动工程师来说，如何利用系统提供出来的api去进行控制gpio的状态，在这里总结几种方式。（希望总结的有点深度，但是实力不允许，继续努力！！！）
gpio介绍 gpio是我们最常提及的，但对于gpio的介绍，我想在这里引用下大牛的总结，感谢蜗窝科技。对于不同的硬件芯片，它所呈现的IO Port是不同的。
1、和CPU的连接方式不同
对于ARM的嵌入式硬件平台，SOC本身可以提供大量的IO port，SOC上的GPIO controller是通过SOC的总线（AMBA）连接到CPU的。对于嵌入式系统而言，除了SOC的IO port，一些外设芯片也可能会提供IO port，例如：
（1）有些key controller芯片、codec或者PMU的芯片会提供I/O port
（2）有些专用的IO expander芯片可以扩展16个或者32个GPIO
当然这些IO Port的控制方式自然是不同的，比如有些IO expander芯片，是由i2c或者spi去和主cpu连接的。codec芯片有可能是PDM总线连接等。
2、访问方式不同
追根溯源，我们操控gpio口，都是去操控IO所对应的寄存器，只是不同的芯片对寄存器bit位的定义不同
3、配置方式不同
即便是使用了同样的硬件（例如都使用同样的某款SOC），不同硬件系统上GPIO的配置不同。在一个系统上配置为输入，在另外的系统上可能配置为输出。
4、GPIO特性不同。这些特性包括：
（1）是否能触发中断
（2）如果能够触发中断，那么该GPIO是否能够将CPU从sleep状态唤醒
（3）有些有软件可控的上拉或者下拉电阻的特性，有的GPIO不支持这种特性。在设定为输入的时候，有的GPIO可以设定debouce的算法，有的则不可以。
（4）多功能复用
截取一个高通sdm660的GPIO Configuration Spreadsheet
更正：MPM interrupt = Y，是指可配置可唤醒中断
gpio子系统控制方式 上面也说了，操控SOC上的gpio，最终控制的就是IO对应的寄存器。
针对你所使用的平台，找到gpio 硬件寄存器手册，找到对应gpio的基地址。
如上图：660平台，gpio的基地址就是0x03100000。
比如讲gpio62的地址是多少，0x03100000 &#43; (num)*1000=0x0313e000
接下来介绍第一种方法去操控gpio的状态（不建议使用）
方式1：
#define GPIO62CON 0x0313e000 #define GPIO62DAT 0x0313e004 volatile unsigned int * gpio62con; volatile unsigned int * gpio62dat; //在调用流程中执行 gpio62con = ioremap(GPIO62CON,0x4); //物理地址映射成虚拟地址 if(NULL == gpio62con) { printk(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/53bd95ffbde1f54980c7152a668681bd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-10-21T11:27:09+08:00" />
<meta property="article:modified_time" content="2019-10-21T11:27:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">高通 gpio控制方式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>前言</h2> 
<p>随着内核的发展，linux驱动框架在不断的变化。很早很早以前，出现了gpio子系统，后来又出现了pinctrl子系统。对于一个驱动工程师来说，如何利用系统提供出来的api去进行控制gpio的状态，在这里总结几种方式。（希望总结的有点深度，但是实力不允许，继续努力！！！）</p> 
<h2><a id="gpio_3"></a>gpio介绍</h2> 
<p>gpio是我们最常提及的，但对于gpio的介绍，我想在这里引用下大牛的总结，感谢蜗窝科技。对于不同的硬件芯片，它所呈现的IO Port是不同的。</p> 
<p>1、和CPU的连接方式不同<br> 对于ARM的嵌入式硬件平台，SOC本身可以提供大量的IO port，SOC上的GPIO controller是通过SOC的总线（AMBA）连接到CPU的。对于嵌入式系统而言，除了SOC的IO port，一些外设芯片也可能会提供IO port，例如：</p> 
<p>（1）有些key controller芯片、codec或者PMU的芯片会提供I/O port</p> 
<p>（2）有些专用的IO expander芯片可以扩展16个或者32个GPIO</p> 
<p>当然这些IO Port的控制方式自然是不同的，比如有些IO expander芯片，是由i2c或者spi去和主cpu连接的。codec芯片有可能是PDM总线连接等。</p> 
<p>2、访问方式不同<br> 追根溯源，我们操控gpio口，都是去操控IO所对应的寄存器，只是不同的芯片对寄存器bit位的定义不同</p> 
<p>3、配置方式不同<br> 即便是使用了同样的硬件（例如都使用同样的某款SOC），不同硬件系统上GPIO的配置不同。在一个系统上配置为输入，在另外的系统上可能配置为输出。</p> 
<p>4、GPIO特性不同。这些特性包括：<br> （1）是否能触发中断<br> （2）如果能够触发中断，那么该GPIO是否能够将CPU从sleep状态唤醒<br> （3）有些有软件可控的上拉或者下拉电阻的特性，有的GPIO不支持这种特性。在设定为输入的时候，有的GPIO可以设定debouce的算法，有的则不可以。<br> （4）多功能复用</p> 
<p>截取一个高通sdm660的GPIO Configuration Spreadsheet</p> 
<p><em><strong>更正：MPM interrupt = Y，是指可配置可唤醒中断</strong></em><br> <img src="https://images2.imgbox.com/2c/5a/p6SSskGi_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="gpio_31"></a>gpio子系统控制方式</h2> 
<p>上面也说了，操控SOC上的gpio，最终控制的就是IO对应的寄存器。<br> <img src="https://images2.imgbox.com/9c/15/cMXggiWf_o.png" alt="在这里插入图片描述"><br> 针对你所使用的平台，找到gpio 硬件寄存器手册，找到对应gpio的基地址。<br> 如上图：660平台，gpio的基地址就是0x03100000。</p> 
<p>比如讲gpio62的地址是多少，0x03100000 + (num)*1000=0x0313e000</p> 
<p>接下来介绍第一种方法去操控gpio的状态（不建议使用）<br> <strong>方式1：</strong></p> 
<pre><code class="prism language-c"><span class="token macro property">#<span class="token directive keyword">define</span>  GPIO62CON    0x0313e000</span>
<span class="token macro property">#<span class="token directive keyword">define</span>  GPIO62DAT    0x0313e004</span>
<span class="token keyword">volatile</span>  <span class="token keyword">unsigned</span>  <span class="token keyword">int</span>  <span class="token operator">*</span>  gpio62con<span class="token punctuation">;</span>
<span class="token keyword">volatile</span>  <span class="token keyword">unsigned</span>  <span class="token keyword">int</span>  <span class="token operator">*</span>  gpio62dat<span class="token punctuation">;</span>

<span class="token comment">//在调用流程中执行</span>
gpio62con  <span class="token operator">=</span>  <span class="token function">ioremap</span><span class="token punctuation">(</span>GPIO62CON<span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//物理地址映射成虚拟地址</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span>  <span class="token operator">==</span> gpio62con<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printk</span><span class="token punctuation">(</span><span class="token string">"ioremap  gpio62con  fail  \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">goto</span>  err1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
gpio62dat  <span class="token operator">=</span>  <span class="token function">ioremap</span><span class="token punctuation">(</span>GPIO62DAT<span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span>  <span class="token operator">==</span> gpi62dat<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printk</span><span class="token punctuation">(</span><span class="token string">"ioremap  gpio62dat  fail  \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">goto</span>  err2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">*</span>gpio62con <span class="token operator">=</span> <span class="token number">0x03</span><span class="token punctuation">;</span><span class="token comment">//DRV_2_MA,PULL_UP</span>
<span class="token operator">*</span>gpio62dat <span class="token operator">=</span> <span class="token number">0x02</span><span class="token punctuation">;</span><span class="token comment">//输出1</span>

</code></pre> 
<p><strong>方式2：</strong><br> 针对上述方式是直接操控寄存器，在高通Android的系统中，也提供了一种api去供用户debug。<br> 读写寄存器的命令如下：</p> 
<pre><code class="prism language-c"><span class="token operator">/</span>system<span class="token operator">/</span>bin<span class="token operator">/</span>r <span class="token operator">&lt;</span>Address<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>
</code></pre> 
<p>编译读写gpio寄存器地址工具:/system/bin/r</p> 
<pre><code class="prism language-c">Android9<span class="token punctuation">.</span><span class="token number">0</span>源码地址<span class="token punctuation">:</span>
system<span class="token operator">/</span>core<span class="token operator">/</span>toolbox<span class="token operator">/</span>r<span class="token punctuation">.</span>c
system<span class="token operator">/</span>core<span class="token operator">/</span>toolbox<span class="token operator">/</span>Android<span class="token punctuation">.</span>bp
cc_binary <span class="token punctuation">{<!-- --></span>                          
    name<span class="token punctuation">:</span> <span class="token string">"r"</span><span class="token punctuation">,</span>                    
    defaults<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"toolbox_defaults"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                            
    srcs<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"r.c"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">}</span>
</code></pre> 
<p><strong>方式3：</strong><br> 我们常用的gpio子系统提供的接口函数<br> 简单介绍下使用方法：<br> 例：<br> 在设备树中添加资源配置：</p> 
<pre><code class="prism language-c">qcom<span class="token punctuation">,</span>msm<span class="token operator">-</span>spk<span class="token operator">-</span>ext<span class="token operator">-</span>pa <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">&amp;</span>tlmm <span class="token number">62</span> <span class="token number">0</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token comment">//第三个参数是flag</span>
</code></pre> 
<pre><code class="prism language-c">pa_enable <span class="token operator">=</span> <span class="token function">of_get_named_gpio</span><span class="token punctuation">(</span>pdev<span class="token operator">-&gt;</span>dev<span class="token punctuation">.</span>of_node<span class="token punctuation">,</span><span class="token string">"qcom,msm-spk-ext-pa"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">gpio_is_valid</span><span class="token punctuation">(</span>pa_enable <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">pr_debug</span><span class="token punctuation">(</span><span class="token string">"%s: pa_enable request %d\n"</span><span class="token punctuation">,</span> <span class="token constant">__func__</span><span class="token punctuation">,</span>
		pa_enable <span class="token punctuation">)</span><span class="token punctuation">;</span>
	ret <span class="token operator">=</span> <span class="token function">gpio_request</span><span class="token punctuation">(</span>pa_enable <span class="token punctuation">,</span> <span class="token string">"msm-spk-ext-pa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">pr_err</span><span class="token punctuation">(</span><span class="token string">"%s: pa_enable request failed, ret:%d\n"</span><span class="token punctuation">,</span>
			<span class="token constant">__func__</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> err<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">gpio_direction_output</span><span class="token punctuation">(</span>pa_enable <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//EN</span>
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">//请求一个/一组gpio</span>
gpio_request<span class="token operator">/</span>devm_gpio_request、gpio_request_one<span class="token operator">/</span>devm_gpio_request_one、gpio_request_array   <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">&gt;</span>  
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">//设置gpio方向为输入/输出</span>
gpio_direction_input或者gpio_direction_output        <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator">&gt;</span>  
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">//将该gpio通过sys文件系统导出，应用层可以通过文件操作gpio</span>
gpio_export                                          <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token number">3</span><span class="token operator">&gt;</span>  
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">//如果gpio为输入，获取gpio值，如果gpio为输出，可以设置gpio高低电平</span>
gpio_get_value、gpio_set_value                       <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">&gt;</span>  
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">//将gpio转为对应的irq，然后注册该irq的中断handler</span>
<span class="token function">request_irq</span><span class="token punctuation">(</span><span class="token function">gpio_to_irq</span><span class="token punctuation">(</span>gpio_num<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>                <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token number">5</span><span class="token operator">&gt;</span>  
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">//释放请求的一个或者一组gpio</span>
gpio_free<span class="token operator">/</span>devm_gpio_free、gpio_free_array                           <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token number">6</span><span class="token operator">&gt;</span>  
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

</code></pre> 
<p>补充一点：qcom,msm-spk-ext-pa = &lt;&amp;tlmm 62 0&gt;;//第三个参数是flag<br> 对于第三个参数，很多情况下可能会忽略，我理解第三个参数是flag,在我们使用接口函数的时候，很多接口函数是可以利用这个flag的。<br> 比如:</p> 
<pre><code class="prism language-c"><span class="token keyword">static</span> <span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">of_get_named_gpio_flags</span><span class="token punctuation">(</span><span class="token keyword">struct</span> device_node <span class="token operator">*</span>np<span class="token punctuation">,</span>
		<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>list_name<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token keyword">enum</span> of_gpio_flags <span class="token operator">*</span>flags<span class="token punctuation">)</span>

<span class="token keyword">int</span> <span class="token function">gpio_request_one</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> gpio<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> flags<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>label<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">struct</span> gpio_desc <span class="token operator">*</span>desc<span class="token punctuation">;</span>
	<span class="token keyword">int</span> err<span class="token punctuation">;</span>

	desc <span class="token operator">=</span> <span class="token function">gpio_to_desc</span><span class="token punctuation">(</span>gpio<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/* Compatibility: assume unavailable "valid" GPIOs will appear later */</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>desc <span class="token operator">&amp;&amp;</span> <span class="token function">gpio_is_valid</span><span class="token punctuation">(</span>gpio<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token operator">-</span>EPROBE_DEFER<span class="token punctuation">;</span>

	err <span class="token operator">=</span> <span class="token function">gpiod_request</span><span class="token punctuation">(</span>desc<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">return</span> err<span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> GPIOF_OPEN_DRAIN<span class="token punctuation">)</span>
		<span class="token function">set_bit</span><span class="token punctuation">(</span>FLAG_OPEN_DRAIN<span class="token punctuation">,</span> <span class="token operator">&amp;</span>desc<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> GPIOF_OPEN_SOURCE<span class="token punctuation">)</span>
		<span class="token function">set_bit</span><span class="token punctuation">(</span>FLAG_OPEN_SOURCE<span class="token punctuation">,</span> <span class="token operator">&amp;</span>desc<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> GPIOF_ACTIVE_LOW<span class="token punctuation">)</span>
		<span class="token function">set_bit</span><span class="token punctuation">(</span>FLAG_ACTIVE_LOW<span class="token punctuation">,</span> <span class="token operator">&amp;</span>desc<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> GPIOF_DIR_IN<span class="token punctuation">)</span>
		err <span class="token operator">=</span> <span class="token function">gpiod_direction_input</span><span class="token punctuation">(</span>desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		err <span class="token operator">=</span> <span class="token function">gpiod_direction_output_raw</span><span class="token punctuation">(</span>desc<span class="token punctuation">,</span>
				<span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> GPIOF_INIT_HIGH<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">goto</span> free_gpio<span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> GPIOF_EXPORT<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		err <span class="token operator">=</span> <span class="token function">gpiod_export</span><span class="token punctuation">(</span>desc<span class="token punctuation">,</span> flags <span class="token operator">&amp;</span> GPIOF_EXPORT_CHANGEABLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span>
			<span class="token keyword">goto</span> free_gpio<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

 free_gpio<span class="token punctuation">:</span>
	<span class="token function">gpiod_free</span><span class="token punctuation">(</span>desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> err<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>我们可以在配置的时候使用这个flag去做一些事情，比如配置中断触发方式，设置输入输出。（个人理解）</p> 
<p><strong>方式4：</strong><br> pinctrl的配置方式<br> (1)默认在使用状态时不需要改变gpio状态</p> 
<pre><code class="prism language-c"><span class="token comment">//sdm670-pinctrl.dtsi</span>
<span class="token operator">&amp;</span>soc <span class="token punctuation">{<!-- --></span>
tlmm<span class="token punctuation">:</span> pinctrl@<span class="token number">03400000</span><span class="token punctuation">{<!-- --></span>
…<span class="token punctuation">.</span><span class="token punctuation">.</span>
…<span class="token punctuation">.</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span>
Client1_pins <span class="token punctuation">{<!-- --></span>
Client1_default<span class="token punctuation">:</span> client1_default<span class="token punctuation">{<!-- --></span>
			mux <span class="token punctuation">{<!-- --></span>
				pins <span class="token operator">=</span> <span class="token string">"gpio54"</span><span class="token punctuation">;</span>
				function <span class="token operator">=</span> <span class="token string">"gpio"</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">;</span>
			config <span class="token punctuation">{<!-- --></span>
				pins <span class="token operator">=</span> <span class="token string">"gpio54"</span><span class="token punctuation">;</span>
				drive<span class="token operator">-</span>strength <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">/* 2 mA */</span>
				bias<span class="token operator">-</span>pull<span class="token operator">-</span>down<span class="token punctuation">;</span> <span class="token comment">/* pull down */</span>
				input<span class="token operator">-</span>enable<span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">//sdm670.dtsi or sdm670-&lt;board&gt;.dts</span>
Soc <span class="token punctuation">{<!-- --></span>
	……<span class="token punctuation">.</span>
	…
	<span class="token punctuation">.</span><span class="token punctuation">.</span>
Client1 <span class="token punctuation">{<!-- --></span>
	……
	…
	<span class="token comment">/*Note the default state is programmed by the kernel at the time of
	kernel bootup. No driver changes are necessary since at probe time the
	default state would already be programmed in TLMM */</span>
	pinctrl<span class="token operator">-</span>states <span class="token operator">=</span> “<span class="token keyword">default</span>”<span class="token punctuation">;</span>
	<span class="token comment">/* Use phandle reference to default configuration node */</span>
	pinctrl<span class="token operator">-</span><span class="token number">0</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">&amp;</span>Client1_default<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>(2)配置gpio的active和sleep状态</p> 
<pre><code class="prism language-c"><span class="token operator">&amp;</span>soc <span class="token punctuation">{<!-- --></span>
tlmm<span class="token punctuation">:</span> pinctrl@<span class="token number">03400000</span><span class="token punctuation">{<!-- --></span>
…<span class="token punctuation">.</span><span class="token punctuation">.</span>
…<span class="token punctuation">.</span>
<span class="token comment">/* I2C CONFIGURATION */</span>
<span class="token comment">/* QUPv3 South SE mappings */</span>
<span class="token comment">/* SE 0 pin mappings */</span>
qupv3_se0_i2c_pins<span class="token punctuation">:</span> qupv3_se0_i2c_pins <span class="token punctuation">{<!-- --></span>
qupv3_se0_i2c_active<span class="token punctuation">:</span> qupv3_se0_i2c_active <span class="token punctuation">{<!-- --></span>
	mux <span class="token punctuation">{<!-- --></span>
		pins <span class="token operator">=</span> <span class="token string">"gpio0"</span><span class="token punctuation">,</span> <span class="token string">"gpio1"</span><span class="token punctuation">;</span>
		function <span class="token operator">=</span> <span class="token string">"qup0"</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	config <span class="token punctuation">{<!-- --></span>
		pins <span class="token operator">=</span> <span class="token string">"gpio0"</span><span class="token punctuation">,</span> <span class="token string">"gpio1"</span><span class="token punctuation">;</span>
		drive<span class="token operator">-</span>strength <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
		bias<span class="token operator">-</span>disable<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
qupv3_se0_i2c_sleep<span class="token punctuation">:</span> qupv3_se0_i2c_sleep <span class="token punctuation">{<!-- --></span>
		mux <span class="token punctuation">{<!-- --></span>
			pins <span class="token operator">=</span> <span class="token string">"gpio0"</span><span class="token punctuation">,</span> <span class="token string">"gpio1"</span><span class="token punctuation">;</span>
			function <span class="token operator">=</span> <span class="token string">"gpio"</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
		config <span class="token punctuation">{<!-- --></span>
			pins <span class="token operator">=</span> <span class="token string">"gpio0"</span><span class="token punctuation">,</span> <span class="token string">"gpio1"</span><span class="token punctuation">;</span>
			drive<span class="token operator">-</span>strength <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
			bias<span class="token operator">-</span>pull<span class="token operator">-</span>up<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-c">Soc <span class="token punctuation">{<!-- --></span>
	……<span class="token punctuation">.</span>
	…
Client2 <span class="token punctuation">{<!-- --></span>
	……
	pinctrl<span class="token operator">-</span>states <span class="token operator">=</span> “active”<span class="token punctuation">,</span> “suspend”<span class="token punctuation">;</span>
	<span class="token comment">/* Use phandle reference to active and sleep configurations to
	Define the active and sleep pin states */</span>
	pinctrl<span class="token operator">-</span><span class="token number">0</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">&amp;</span> qupv3_se0_i2c_active<span class="token operator">&gt;</span><span class="token punctuation">;</span>
	pinctrl<span class="token operator">-</span><span class="token number">1</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">&amp;</span> qupv3_se0_i2c_sleep <span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">//driver需要修改接口</span>
Static <span class="token keyword">int</span> client2_probe <span class="token punctuation">(</span><span class="token keyword">struct</span> platform_device <span class="token operator">*</span>pdev<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	Struct pinctrl_state <span class="token operator">*</span>set_state<span class="token punctuation">;</span>
	Struct client2_data <span class="token operator">*</span>client2_dd<span class="token punctuation">;</span>
	…<span class="token punctuation">.</span><span class="token punctuation">.</span>
	…
	<span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token comment">/* Try to obtain pinctrl handle */</span>
	Pdev<span class="token operator">-&gt;</span>dev<span class="token operator">-&gt;</span>pins<span class="token operator">-&gt;</span>p <span class="token operator">=</span> <span class="token function">devm_pinctrl_get</span><span class="token punctuation">(</span>pdev<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">/* Lookup the active configuration */</span> <span class="token number">34</span>
	set_state <span class="token operator">=</span> <span class="token function">pinctrl_lookup_state</span><span class="token punctuation">(</span>pdev<span class="token operator">-&gt;</span>dev<span class="token operator">-&gt;</span>pins<span class="token operator">-&gt;</span>p<span class="token punctuation">,</span> “active”<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>set_state<span class="token punctuation">)</span>
	<span class="token keyword">goto</span> fail<span class="token punctuation">;</span>
	<span class="token keyword">else</span>
	<span class="token comment">/*Actually write the active configuration to hardware */</span>
	ret <span class="token operator">=</span> <span class="token function">pinctrl_select_state</span><span class="token punctuation">(</span>pdev<span class="token operator">-&gt;</span>dev<span class="token operator">-&gt;</span>pins<span class="token operator">-&gt;</span>p<span class="token punctuation">,</span> set_state<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">/* Install sleep configuration in runtime suspend function */</span>
	Static <span class="token keyword">int</span> <span class="token function">client2_suspend</span><span class="token punctuation">(</span> <span class="token keyword">struct</span> platfom_device<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">/* Configure pins to sleep state state */</span>
		Struct pinctrl_state <span class="token operator">*</span>set_state<span class="token punctuation">;</span>
		<span class="token comment">/* Actually write the sleep configuration to hardware */</span>
		set_state <span class="token operator">=</span> <span class="token function">pinctrl_lookup_state</span><span class="token punctuation">(</span>pdev<span class="token operator">-&gt;</span>dev<span class="token operator">-&gt;</span>pins<span class="token operator">-&gt;</span>p<span class="token punctuation">,</span> “sleep”<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>set_state<span class="token punctuation">)</span>
		<span class="token keyword">goto</span> fail<span class="token punctuation">;</span>
		<span class="token keyword">else</span>
		ret <span class="token operator">=</span> <span class="token function">pinctrl_select_state</span><span class="token punctuation">(</span>pdev<span class="token operator">-&gt;</span>dev<span class="token operator">-&gt;</span>pins<span class="token operator">-&gt;</span>p<span class="token punctuation">,</span> set_state<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<p><strong>方式5：</strong><br> gpio系统中会创建接口到文件系统中，以便用户使用。<br> /sys/class/gpio</p> 
<pre><code class="prism language-c">export       gpiochip1021 gpiochip378 gpiochip474 gpiochip570 gpiochip666 gpiochip762 gpiochip858 gpiochip954 
gpiochip0    gpiochip314  gpiochip410 gpiochip506 gpiochip602 gpiochip698 gpiochip794 gpiochip890 gpiochip986 
gpiochip1018 gpiochip346  gpiochip442 gpiochip538 gpiochip634 gpiochip730 gpiochip826 gpiochip922 unexport 
</code></pre> 
<p>1、gpio_operation 通过 /sys/ 文件接口操作 IO 端口 GPIO 到文件系统的映射。<br> 2、控制 GPIO 的目录位于 /sys/class/gpio。<br> 3、/sys/class/gpio/export 文件用于通知系统需要导出控制的 GPIO 引脚编号。<br> 4、/sys/class/gpio/unexport 用于通知系统取消导出。<br> 5、/sys/class/gpio/gpiochipX 目录保存系统中 GPIO 寄存器的信息，包括每个寄存器控制引脚的起始编号 base，寄存器名称，引脚总数。</p> 
<p>解释下gpiochipX,我理解每个gpiochipX都对应一个gpio控制器，bsp工程师有可能会根据芯片对应的gpio可以自行写一个gpio控制器驱动，主要是通过gpiochip_add这个函数实现。有兴趣可看源码。</p> 
<p>可参考大牛写的例子：<a href="https://blog.csdn.net/mike8825/article/details/99707281">Linux下的gpio控制器驱动</a></p> 
<p>gpio引脚编号说明：<br> 引脚编号 = 控制引脚的寄存器基数 + 控制引脚寄存器位数<br> 引脚编号是gpiochipxxx下的base + 第几个GPIO，也就是base加偏移，偏移的是位数。<br> 例如gpiochip1028 下的第1个GPIO那么编号就是1018 + 1 = 1019</p> 
<p>导出gpio号，比如gpio12</p> 
<pre><code class="prism language-c">linux<span class="token punctuation">:</span><span class="token operator">/</span>sys<span class="token operator">/</span>class<span class="token operator">/</span>gpio # echo <span class="token number">12</span> <span class="token operator">&gt;</span> export
linux<span class="token punctuation">:</span><span class="token operator">/</span>sys<span class="token operator">/</span>class<span class="token operator">/</span>gpio # cd gpio12
linux<span class="token punctuation">:</span><span class="token operator">/</span>sys<span class="token operator">/</span>class<span class="token operator">/</span>gpio<span class="token operator">/</span>gpio12 # ls
active_low device direction edge power subsystem uevent value 
</code></pre> 
<p>之后通过echo和cat去设置查看相应的属性。</p> 
<h2><a id="lkgpio_345"></a>高通平台lk阶段设置gpio</h2> 
<h5><a id="1_gpio_346"></a>(1) 配置普通gpio</h5> 
<pre><code class="prism language-c"><span class="token function">gpio_tlmm_config</span><span class="token punctuation">(</span>uint32_t gpio<span class="token punctuation">,</span> uint8_t func<span class="token punctuation">,</span> uint8_t dir<span class="token punctuation">,</span> uint8_t pull<span class="token punctuation">,</span> uint8_t drvstr<span class="token punctuation">,</span> uint32_t enable<span class="token punctuation">)</span>

gpio <span class="token operator">=</span> GPIO number
func <span class="token operator">=</span> always <span class="token string">'0'</span>
dir <span class="token operator">=</span> GPIO_OUTPUT or GPIO_INPUT
pull <span class="token operator">=</span> Don't care <span class="token keyword">if</span> it is GPIO_OUTPUT
drvstr <span class="token operator">=</span> GPIO_xMA
enable <span class="token operator">=</span> GPIO_DISABLE   is <span class="token keyword">for</span> output <span class="token punctuation">,</span> GPIO_ENALE <span class="token keyword">for</span> input <span class="token punctuation">.</span>
</code></pre> 
<p>举个栗子：</p> 
<pre><code class="prism language-c"><span class="token operator">*</span><span class="token operator">*</span>configure gpio as input<span class="token operator">*</span><span class="token operator">*</span>

<span class="token function">gpio_tlmm_config</span><span class="token punctuation">(</span>TLMM_VOL_UP_BTN_GPIO<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> GPIO_INPUT<span class="token punctuation">,</span> GPIO_PULL_UP<span class="token punctuation">,</span> GPIO_2MA<span class="token punctuation">,</span> GPIO_ENABLE<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">gpio_status</span><span class="token punctuation">(</span>TLMM_VOL_UP_BTN_GPIO<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//get gpio value </span>


<span class="token operator">*</span><span class="token operator">*</span>configure gpio as output<span class="token operator">*</span><span class="token operator">*</span>
 
<span class="token function">gpio_tlmm_config</span><span class="token punctuation">(</span><span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> GPIO_OUTPUT<span class="token punctuation">,</span> GPIO_NO_PULL<span class="token punctuation">,</span> GPIO_2MA<span class="token punctuation">,</span> GPIO_DISABLE<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">gpio_set</span><span class="token punctuation">(</span><span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">set gpio value </span>
</code></pre> 
<h5><a id="2_lkgpio_373"></a>(2) lk配置gpio作为中断</h5> 
<p>据高通solution介绍，目前在lk中并没有 GPIO_IRQ driver。</p> 
<p>As you know, there’s no dedicate vector value for the every gpio IRQ. tlmm_summary_irq number need you check the msm**-pinctrl.dts, the</p> 
<p>Interrupt num should be the num in</p> 
<pre><code>    reg = &lt;0x1000000 0x300000&gt;;

    interrupts = &lt;0 208 0&gt;;
    
    Then interrup num should be : 208+32=240
</code></pre> 
<p>注：刚开始有点疑惑中断号为什么是240，该中断为共享处理器中断，起始中断号为32.<br> 先看几个缩写<br> IPI：inter-processer interrupt 中断号0～15<br> PPI：per processor interrupts 中断号16～31<br> SPI：shared processor interrupts 中断号 32～224<br> SGI：software generated interrupts (SGI)</p> 
<p>设备树是用来描述硬件信息的，因此里面不涉及软件中断SGI，从设备树包含的头文件可以看出这一点：<br> 在arm-gic.h文件中定义的只有SPI和PPI<br> #define GIC_SPI 0<br> #define GIC_PPI 1</p> 
<p>一般设备树中的中断都是SPI，那么 interrupts = &lt;0 208 1&gt;;形式中的<br> 都是什么呢<br> X：GIC_SPI或者GIC_PPI<br> Y：物理中断号-32<br> Z：触发方式<br> 1 = low-to-high edge triggered<br> 2 = high-to-low edge triggered (invalid for SPIs)<br> 4 = active high level-sensitive<br> 8 = active low level-sensitive (invalid for SPIs).</p> 
<p>接上<br> It meant that any gpio irq are triggered, the tlmm_summary_irq() handler would be called. Then, needed to check about GPIO_INTR_STATUS_ADDR(10); if the GPIO 's IRQ is really triggered.</p> 
<p>For gpio interrupt type (falling edge /rising edge /dual edge ) need you config the GPIO_INTR_CFGn register , for register information , need you refer chip SWI (software interface) document</p> 
<p>Normally 0x9B for falling edge , 0x9f for dual edge .</p> 
<pre><code class="prism language-c"><span class="token operator">+</span>#define <span class="token function">GPIO_INT_CONFIG_ADDR</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>         <span class="token punctuation">(</span>TLMM_BASE_ADDR <span class="token operator">+</span> <span class="token number">0x00000008</span> <span class="token operator">+</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">0x1000</span><span class="token punctuation">)</span>
<span class="token operator">+</span>#define <span class="token function">GPIO_INT_STATUS_CONFIG_ADDR</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>         <span class="token punctuation">(</span>TLMM_BASE_ADDR <span class="token operator">+</span> <span class="token number">0x0000000C</span> <span class="token operator">+</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">0x1000</span><span class="token punctuation">)</span>

<span class="token comment">//gpio irq handler :</span>

<span class="token operator">+</span><span class="token keyword">enum</span> handler_return <span class="token function">summary_interrupt</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>arg<span class="token punctuation">)</span>
<span class="token operator">+</span><span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>        <span class="token keyword">unsigned</span> ret <span class="token operator">=</span> INT_NO_RESCHEDULE<span class="token punctuation">;</span>
<span class="token operator">+</span>
<span class="token operator">+</span>        <span class="token function">dprintf</span><span class="token punctuation">(</span>CRITICAL<span class="token punctuation">,</span> <span class="token string">"Home IRQ:0x%08x\n"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> uint32_t <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GPIO_INT_STATUS_CONFIG_ADDR</span><span class="token punctuation">(</span><span class="token number">109</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">/* 

     add your gpio irq handler here  .

      */</span>
<span class="token operator">+</span>        <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token punctuation">}</span>

 

<span class="token comment">//where you configure gpio as interrupt and register irq handler .</span>
  

<span class="token operator">+</span>    <span class="token function">gpio_tlmm_config</span><span class="token punctuation">(</span><span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> GPIO_INPUT<span class="token punctuation">,</span> GPIO_NO_PULL<span class="token punctuation">,</span> GPIO_2MA<span class="token punctuation">,</span> GPIO_ENABLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token operator">+</span>    <span class="token function">writel</span><span class="token punctuation">(</span><span class="token number">0x9B</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GPIO_INT_CONFIG_ADDR</span><span class="token punctuation">(</span><span class="token number">109</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                
<span class="token operator">+</span>    <span class="token function">register_int_handler</span><span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">,</span> summary_interrupt<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>    <span class="token function">unmask_interrupt</span><span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">+</span>        <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">target_volume_down</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">+</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token operator">+</span>            <span class="token function">dprintf</span><span class="token punctuation">(</span>CRITICAL<span class="token punctuation">,</span> <span class="token string">"HOME_KEY status:%d\n"</span><span class="token punctuation">,</span> <span class="token function">gpio_status</span><span class="token punctuation">(</span><span class="token number">109</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>            <span class="token function">mdelay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token punctuation">}</span>      
   
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c498b09df65f8f2569feadace8c1411b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【NLP】GPT原理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a457e81e33f603ba4a8da37e0857dbd0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">matlab对点云进行三角化(las格式读入)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>