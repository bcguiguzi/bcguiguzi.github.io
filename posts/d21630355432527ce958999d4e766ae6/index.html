<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>完整的vite &#43; ts &#43; vue3项目，克隆就能用，傻瓜式保姆教程(第二篇) - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="完整的vite &#43; ts &#43; vue3项目，克隆就能用，傻瓜式保姆教程(第二篇)" />
<meta property="og:description" content="目录
前言
一、基础知识准备
1.1 接口请求 （本篇重点内容）
1.1.1 Fetch API
1.1.2 XMLHttpRequest
1.1.3 axios（推荐）
1.1.4 EventSource
1.1.5 WebSocket
1.2 ts 类型定义 （本篇内容）
1.3 svg 雪碧图（本篇内容）
1.4 i18n 多语言（本篇内容）
1.5 公共工具方法（非本篇内容）
1.5.1 本地存储相关
a）cookie
b）localStorage
1.5.2 日期相关
a）格式化和计算
b）时差问题
1.5.3 设备区分
a) userAgent
b）h5 唤起 APP
1.5.4 判断 js 类型 （is）
1.5.5 上传文件
1.5.6 下载文件
a）浏览器能预览的文件
b）浏览器不能预览的文件
1.5.7 防抖和节流
1.6 部署
小结
二、增加接口请求模块
2.1 使用 axios 模块
2.1.1 安装 axios 模块" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/d21630355432527ce958999d4e766ae6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-18T19:01:31+08:00" />
<meta property="article:modified_time" content="2023-12-18T19:01:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">完整的vite &#43; ts &#43; vue3项目，克隆就能用，傻瓜式保姆教程(第二篇)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:80px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
<p id="%E4%B8%80%E3%80%81%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E5%87%86%E5%A4%87-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E5%87%86%E5%A4%87" rel="nofollow">一、基础知识准备</a></p> 
<p id="1.1%20%E6%8E%A5%E5%8F%A3%E8%AF%B7%E6%B1%82%20%EF%BC%88%E6%9C%AC%E7%AF%87%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%EF%BC%89-toc" style="margin-left:40px;"><a href="#1.1%20%E6%8E%A5%E5%8F%A3%E8%AF%B7%E6%B1%82%20%EF%BC%88%E6%9C%AC%E7%AF%87%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%EF%BC%89" rel="nofollow">1.1 接口请求 （本篇重点内容）</a></p> 
<p id="1.1.1%C2%A0Fetch%20API-toc" style="margin-left:80px;"><a href="#1.1.1%C2%A0Fetch%20API" rel="nofollow">1.1.1 Fetch API</a></p> 
<p id="1.1.2%20XMLHttpRequest-toc" style="margin-left:80px;"><a href="#1.1.2%20XMLHttpRequest" rel="nofollow">1.1.2 XMLHttpRequest</a></p> 
<p id="1.1.3%C2%A0axios%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89-toc" style="margin-left:80px;"><a href="#1.1.3%C2%A0axios%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89" rel="nofollow">1.1.3 axios（推荐）</a></p> 
<p id="1.1.4%20EventSource-toc" style="margin-left:80px;"><a href="#1.1.4%20EventSource" rel="nofollow">1.1.4 EventSource</a></p> 
<p id="1.1.5%20WebSocket-toc" style="margin-left:80px;"><a href="#1.1.5%20WebSocket" rel="nofollow">1.1.5 WebSocket</a></p> 
<p id="1.2%20ts%20%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89%20%EF%BC%88%E6%9C%AC%E7%AF%87%E5%86%85%E5%AE%B9%EF%BC%89-toc" style="margin-left:40px;"><a href="#1.2%20ts%20%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89%20%EF%BC%88%E6%9C%AC%E7%AF%87%E5%86%85%E5%AE%B9%EF%BC%89" rel="nofollow">1.2 ts 类型定义 （本篇内容）</a></p> 
<p id="1.3%C2%A0svg%20%E9%9B%AA%E7%A2%A7%E5%9B%BE%EF%BC%88%E6%9C%AC%E7%AF%87%E5%86%85%E5%AE%B9%EF%BC%89-toc" style="margin-left:40px;"><a href="#1.3%C2%A0svg%20%E9%9B%AA%E7%A2%A7%E5%9B%BE%EF%BC%88%E6%9C%AC%E7%AF%87%E5%86%85%E5%AE%B9%EF%BC%89" rel="nofollow">1.3 svg 雪碧图（本篇内容）</a></p> 
<p id="1.4%C2%A0%C2%A0i18n%20%E5%A4%9A%E8%AF%AD%E8%A8%80%EF%BC%88%E6%9C%AC%E7%AF%87%E5%86%85%E5%AE%B9%EF%BC%89-toc" style="margin-left:40px;"><a href="#1.4%C2%A0%C2%A0i18n%20%E5%A4%9A%E8%AF%AD%E8%A8%80%EF%BC%88%E6%9C%AC%E7%AF%87%E5%86%85%E5%AE%B9%EF%BC%89" rel="nofollow">1.4  i18n 多语言（本篇内容）</a></p> 
<p id="1.5%C2%A0%E5%85%AC%E5%85%B1%E5%B7%A5%E5%85%B7%E6%96%B9%E6%B3%95%EF%BC%88%E9%9D%9E%E6%9C%AC%E7%AF%87%E5%86%85%E5%AE%B9%EF%BC%89-toc" style="margin-left:40px;"><a href="#1.5%C2%A0%E5%85%AC%E5%85%B1%E5%B7%A5%E5%85%B7%E6%96%B9%E6%B3%95%EF%BC%88%E9%9D%9E%E6%9C%AC%E7%AF%87%E5%86%85%E5%AE%B9%EF%BC%89" rel="nofollow">1.5 公共工具方法（非本篇内容）</a></p> 
<p id="1.5.1%20%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3-toc" style="margin-left:80px;"><a href="#1.5.1%20%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3" rel="nofollow">1.5.1 本地存储相关</a></p> 
<p id="a%EF%BC%89cookie-toc" style="margin-left:120px;"><a href="#a%EF%BC%89cookie" rel="nofollow">a）cookie</a></p> 
<p id="b%EF%BC%89localStorage-toc" style="margin-left:120px;"><a href="#b%EF%BC%89localStorage" rel="nofollow">b）localStorage</a></p> 
<p id="1.5.2%20%E6%97%A5%E6%9C%9F%E7%9B%B8%E5%85%B3-toc" style="margin-left:80px;"><a href="#1.5.2%20%E6%97%A5%E6%9C%9F%E7%9B%B8%E5%85%B3" rel="nofollow">1.5.2 日期相关</a></p> 
<p id="a%EF%BC%89%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%92%8C%E8%AE%A1%E7%AE%97-toc" style="margin-left:120px;"><a href="#a%EF%BC%89%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%92%8C%E8%AE%A1%E7%AE%97" rel="nofollow">a）格式化和计算</a></p> 
<p id="b%EF%BC%89%E6%97%B6%E5%B7%AE%E9%97%AE%E9%A2%98-toc" style="margin-left:120px;"><a href="#b%EF%BC%89%E6%97%B6%E5%B7%AE%E9%97%AE%E9%A2%98" rel="nofollow">b）时差问题</a></p> 
<p id="1.5.3%20%E8%AE%BE%E5%A4%87%E5%8C%BA%E5%88%86-toc" style="margin-left:80px;"><a href="#1.5.3%20%E8%AE%BE%E5%A4%87%E5%8C%BA%E5%88%86" rel="nofollow">1.5.3 设备区分</a></p> 
<p id="a)%20userAgent-toc" style="margin-left:120px;"><a href="#a%29%20userAgent" rel="nofollow">a) userAgent</a></p> 
<p id="b%EF%BC%89h5%20%E5%94%A4%E8%B5%B7%20APP-toc" style="margin-left:120px;"><a href="#b%EF%BC%89h5%20%E5%94%A4%E8%B5%B7%20APP" rel="nofollow">b）h5 唤起 APP</a></p> 
<p id="1.5.4%20%E5%88%A4%E6%96%AD%20js%20%E7%B1%BB%E5%9E%8B%20%EF%BC%88is%EF%BC%89-toc" style="margin-left:80px;"><a href="#1.5.4%20%E5%88%A4%E6%96%AD%20js%20%E7%B1%BB%E5%9E%8B%20%EF%BC%88is%EF%BC%89" rel="nofollow">1.5.4 判断 js 类型 （is）</a></p> 
<p id="1.5.5%20%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6-toc" style="margin-left:80px;"><a href="#1.5.5%20%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6" rel="nofollow">1.5.5 上传文件</a></p> 
<p id="1.5.6%20%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6-toc" style="margin-left:80px;"><a href="#1.5.6%20%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6" rel="nofollow">1.5.6 下载文件</a></p> 
<p id="a%EF%BC%89%E6%B5%8F%E8%A7%88%E5%99%A8%E8%83%BD%E9%A2%84%E8%A7%88%E7%9A%84%E6%96%87%E4%BB%B6-toc" style="margin-left:120px;"><a href="#a%EF%BC%89%E6%B5%8F%E8%A7%88%E5%99%A8%E8%83%BD%E9%A2%84%E8%A7%88%E7%9A%84%E6%96%87%E4%BB%B6" rel="nofollow">a）浏览器能预览的文件</a></p> 
<p id="b%EF%BC%89%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8D%E8%83%BD%E9%A2%84%E8%A7%88%E7%9A%84%E6%96%87%E4%BB%B6-toc" style="margin-left:120px;"><a href="#b%EF%BC%89%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8D%E8%83%BD%E9%A2%84%E8%A7%88%E7%9A%84%E6%96%87%E4%BB%B6" rel="nofollow">b）浏览器不能预览的文件</a></p> 
<p id="1.5.7%20%E9%98%B2%E6%8A%96%E5%92%8C%E8%8A%82%E6%B5%81-toc" style="margin-left:80px;"><a href="#1.5.7%20%E9%98%B2%E6%8A%96%E5%92%8C%E8%8A%82%E6%B5%81" rel="nofollow">1.5.7 防抖和节流</a></p> 
<p id="1.6%C2%A0%E9%83%A8%E7%BD%B2-toc" style="margin-left:40px;"><a href="#1.6%C2%A0%E9%83%A8%E7%BD%B2" rel="nofollow">1.6 部署</a></p> 
<p id="%E5%B0%8F%E7%BB%93-toc" style="margin-left:40px;"><a href="#%E5%B0%8F%E7%BB%93" rel="nofollow">小结</a></p> 
<p id="%E4%BA%8C%E3%80%81%E5%A2%9E%E5%8A%A0%E6%8E%A5%E5%8F%A3%E8%AF%B7%E6%B1%82%E6%A8%A1%E5%9D%97-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E5%A2%9E%E5%8A%A0%E6%8E%A5%E5%8F%A3%E8%AF%B7%E6%B1%82%E6%A8%A1%E5%9D%97" rel="nofollow">二、增加接口请求模块</a></p> 
<p id="2.1%20%E4%BD%BF%E7%94%A8%20axios%20%E6%A8%A1%E5%9D%97-toc" style="margin-left:40px;"><a href="#2.1%20%E4%BD%BF%E7%94%A8%20axios%20%E6%A8%A1%E5%9D%97" rel="nofollow">2.1 使用 axios 模块</a></p> 
<p id="2.1.1%20%E5%AE%89%E8%A3%85%20axios%20%E6%A8%A1%E5%9D%97-toc" style="margin-left:80px;"><a href="#2.1.1%20%E5%AE%89%E8%A3%85%20axios%20%E6%A8%A1%E5%9D%97" rel="nofollow">2.1.1 安装 axios 模块</a></p> 
<p id="2.1.2%20%E6%96%B0%E5%BB%BA%C2%A0service%20%E6%96%87%E4%BB%B6%E5%A4%B9-toc" style="margin-left:80px;"><a href="#2.1.2%20%E6%96%B0%E5%BB%BA%C2%A0service%20%E6%96%87%E4%BB%B6%E5%A4%B9" rel="nofollow">2.1.2 新建 service 文件夹</a></p> 
<p id="2.1.3%C2%A0%E6%96%B0%E5%BB%BA%20request.ts-toc" style="margin-left:80px;"><a href="#2.1.3%C2%A0%E6%96%B0%E5%BB%BA%20request.ts" rel="nofollow">2.1.3 新建 request.ts</a></p> 
<p id="2.1.4%20%E5%88%9B%E5%BB%BA%20axio%20%E8%AF%B7%E6%B1%82%E5%AE%9E%E4%BE%8B-toc" style="margin-left:80px;"><a href="#2.1.4%20%E5%88%9B%E5%BB%BA%20axio%20%E8%AF%B7%E6%B1%82%E5%AE%9E%E4%BE%8B" rel="nofollow">2.1.4 创建 axios 请求实例</a></p> 
<p id="2.1.5%C2%A0%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#2.1.5%C2%A0%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81" rel="nofollow">2.1.5 提交代码</a></p> 
<p id="2.2%20%E5%A2%9E%E5%8A%A0%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86-toc" style="margin-left:40px;"><a href="#2.2%20%E5%A2%9E%E5%8A%A0%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86" rel="nofollow">2.2 增加错误处理</a></p> 
<p id="2.2.1%20%E6%96%B0%E5%BB%BA%20error.ts%C2%A0-toc" style="margin-left:80px;"><a href="#2.2.1%20%E6%96%B0%E5%BB%BA%20error.ts%C2%A0" rel="nofollow">2.2.1 新建 error.ts </a></p> 
<p id="2.2.2%20%E6%96%B0%E5%BB%BA%C2%A0handleError.ts-toc" style="margin-left:80px;"><a href="#2.2.2%20%E6%96%B0%E5%BB%BA%C2%A0handleError.ts" rel="nofollow">2.2.2 新建 handleError.ts</a></p> 
<p id="2.2.3%C2%A0%E5%BA%94%E7%94%A8%20handleError%20%E6%96%B9%E6%B3%95-toc" style="margin-left:80px;"><a href="#2.2.3%C2%A0%E5%BA%94%E7%94%A8%20handleError%20%E6%96%B9%E6%B3%95" rel="nofollow">2.2.3 应用 handleError 方法</a></p> 
<p id="2.3%C2%A0%20%E5%A2%9E%E5%8A%A0%20web%20%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95-toc" style="margin-left:40px;"><a href="#2.3%C2%A0%20%E5%A2%9E%E5%8A%A0%20web%20%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95" rel="nofollow">2.3  增加 web 请求方法</a></p> 
<p id="2.3.1%C2%A0%E5%AE%9A%E4%B9%89%E6%8E%A5%E5%8F%A3%E5%88%97%E8%A1%A8-toc" style="margin-left:80px;"><a href="#2.3.1%C2%A0%E5%AE%9A%E4%B9%89%E6%8E%A5%E5%8F%A3%E5%88%97%E8%A1%A8" rel="nofollow">2.3.1 定义接口列表</a></p> 
<p id="2.3.2%C2%A0%E5%B0%81%E8%A3%85%20API%20%E7%B1%BB-toc" style="margin-left:80px;"><a href="#2.3.2%C2%A0%E5%B0%81%E8%A3%85%20API%20%E7%B1%BB" rel="nofollow">2.3.2 封装 API 类</a></p> 
<p id="2.3.3%20%E5%AE%9E%E4%BE%8B%E5%8C%96%20API%20%E7%B1%BB-toc" style="margin-left:80px;"><a href="#2.3.3%20%E5%AE%9E%E4%BE%8B%E5%8C%96%20API%20%E7%B1%BB" rel="nofollow">2.3.3 实例化 API 类</a></p> 
<p id="2.3.4%C2%A0%E6%B5%8B%E8%AF%95%E4%B8%80%E4%B8%8B%E9%9D%99%E6%80%81%E5%87%BD%E6%95%B0-toc" style="margin-left:80px;"><a href="#2.3.4%C2%A0%E6%B5%8B%E8%AF%95%E4%B8%80%E4%B8%8B%E9%9D%99%E6%80%81%E5%87%BD%E6%95%B0" rel="nofollow">2.3.4 测试一下静态函数</a></p> 
<p id="2.3.5%20%E6%B5%8B%E8%AF%95%E4%B8%80%E4%B8%8B%E9%9D%9E%E9%9D%99%E6%80%81%E5%87%BD%E6%95%B0-toc" style="margin-left:80px;"><a href="#2.3.5%20%E6%B5%8B%E8%AF%95%E4%B8%80%E4%B8%8B%E9%9D%9E%E9%9D%99%E6%80%81%E5%87%BD%E6%95%B0" rel="nofollow">2.3.5 测试一下非静态函数</a></p> 
<p id="2.4%C2%A0%E4%BC%98%E5%8C%96%E8%AF%B7%E6%B1%82%E6%A8%A1%E5%9D%97-toc" style="margin-left:40px;"><a href="#2.4%C2%A0%E4%BC%98%E5%8C%96%E8%AF%B7%E6%B1%82%E6%A8%A1%E5%9D%97" rel="nofollow">2.4 优化请求模块</a></p> 
<p id="2.4.1%C2%A0%E4%BC%98%E5%8C%96%E8%AF%B7%E6%B1%82%E5%9C%B0%E5%9D%80-toc" style="margin-left:80px;"><a href="#2.4.1%C2%A0%E4%BC%98%E5%8C%96%E8%AF%B7%E6%B1%82%E5%9C%B0%E5%9D%80" rel="nofollow">2.4.1 优化请求地址</a></p> 
<p id="%E4%B8%89%E3%80%81ts%20%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81ts%20%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89" rel="nofollow">三、ts 类型定义</a></p> 
<p id="3.1%C2%A0%E6%96%B0%E5%BB%BA%20typings%20%E6%96%87%E4%BB%B6%E5%A4%B9-toc" style="margin-left:40px;"><a href="#3.1%C2%A0%E6%96%B0%E5%BB%BA%20typings%20%E6%96%87%E4%BB%B6%E5%A4%B9" rel="nofollow">3.1 新建 typings 文件夹</a></p> 
<p id="3.2%C2%A0%E6%96%B0%E5%BB%BA%20index.d.ts-toc" style="margin-left:40px;"><a href="#3.2%C2%A0%E6%96%B0%E5%BB%BA%20index.d.ts" rel="nofollow">3.2 新建 index.d.ts</a></p> 
<p id="%C2%A03.3%C2%A0%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#%C2%A03.3%C2%A0%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81" rel="nofollow">3.3 提交代码</a></p> 
<p id="%E5%9B%9B%E3%80%81%E5%A2%9E%E5%8A%A0%20svg%20%E9%9B%AA%E7%A2%A7%E5%9B%BE-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%E5%A2%9E%E5%8A%A0%20svg%20%E9%9B%AA%E7%A2%A7%E5%9B%BE" rel="nofollow">四、增加 svg 雪碧图</a></p> 
<p id="4.1%C2%A0%E9%85%8D%E7%BD%AE%E6%8F%92%E4%BB%B6-toc" style="margin-left:40px;"><a href="#4.1%C2%A0%E9%85%8D%E7%BD%AE%E6%8F%92%E4%BB%B6" rel="nofollow">4.1 配置插件</a></p> 
<p id="4.1.1%20%E5%AE%89%E8%A3%85%20vite-plugin-svg-icons-toc" style="margin-left:80px;"><a href="#4.1.1%20%E5%AE%89%E8%A3%85%20vite-plugin-svg-icons" rel="nofollow">4.1.1 安装 vite-plugin-svg-icons</a></p> 
<p id="4.1.2%20%E5%9C%A8%20vite.config.ts%20%E4%B8%AD%E9%85%8D%E7%BD%AE-toc" style="margin-left:80px;"><a href="#4.1.2%20%E5%9C%A8%20vite.config.ts%20%E4%B8%AD%E9%85%8D%E7%BD%AE" rel="nofollow">4.1.2 在 vite.config.ts 中配置</a></p> 
<p id="4.1.3%20%E5%9C%A8%20main.ts%20%E4%B8%AD%E5%BC%95%E5%85%A5-toc" style="margin-left:80px;"><a href="#4.1.3%20%E5%9C%A8%20main.ts%20%E4%B8%AD%E5%BC%95%E5%85%A5" rel="nofollow">4.1.3 在 main.ts 中引入</a></p> 
<p id="%C2%A04.1.4%C2%A0%E5%88%9B%E5%BB%BA%20src%2Fimages%2Fsvgs%20%E6%96%87%E4%BB%B6%E5%A4%B9-toc" style="margin-left:80px;"><a href="#%C2%A04.1.4%C2%A0%E5%88%9B%E5%BB%BA%20src%2Fimages%2Fsvgs%20%E6%96%87%E4%BB%B6%E5%A4%B9" rel="nofollow"> 4.1.4 创建 src/images/svgs 文件夹</a></p> 
<p id="4.2%C2%A0%E4%BD%BF%E7%94%A8%E6%8F%92%E4%BB%B6-toc" style="margin-left:40px;"><a href="#4.2%C2%A0%E4%BD%BF%E7%94%A8%E6%8F%92%E4%BB%B6" rel="nofollow">4.2 使用插件</a></p> 
<p id="4.2.1%20%E6%96%B0%E5%BB%BA%20SvgIcon.vue-toc" style="margin-left:80px;"><a href="#4.2.1%20%E6%96%B0%E5%BB%BA%20SvgIcon.vue" rel="nofollow">4.2.1 新建 SvgIcon.vue</a></p> 
<p id="4.2.2%20%E5%9C%A8%20login.vue%20%E4%B8%AD%E4%BD%BF%E7%94%A8-toc" style="margin-left:80px;"><a href="#4.2.2%20%E5%9C%A8%20login.vue%20%E4%B8%AD%E4%BD%BF%E7%94%A8" rel="nofollow">4.2.2 在 login.vue 中使用</a></p> 
<p id="4.2.3%20%E8%BF%90%E8%A1%8C%E6%95%88%E6%9E%9C-toc" style="margin-left:80px;"><a href="#4.2.3%20%E8%BF%90%E8%A1%8C%E6%95%88%E6%9E%9C" rel="nofollow">4.2.3 运行效果</a></p> 
<p id="4.2.4%20%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#4.2.4%20%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81" rel="nofollow">4.2.4 提交代码</a></p> 
<p id="%E4%BA%94%E3%80%81i18n%20%E5%A4%9A%E8%AF%AD%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E4%BA%94%E3%80%81i18n%20%E5%A4%9A%E8%AF%AD%E8%A8%80" rel="nofollow">五、i18n 多语言</a></p> 
<p id="5.1%C2%A0%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px;"><a href="#5.1%C2%A0%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE" rel="nofollow">5.1 安装和配置</a></p> 
<p id="5.1.1%20%E5%AE%89%E8%A3%85%20vue-i18n-toc" style="margin-left:80px;"><a href="#5.1.1%20%E5%AE%89%E8%A3%85%20vue-i18n" rel="nofollow">5.1.1 安装 vue-i18n</a></p> 
<p id="5.1.2%C2%A0%E6%96%B0%E5%BB%BA%20i18n%20%E6%96%87%E4%BB%B6%E5%A4%B9-toc" style="margin-left:80px;"><a href="#5.1.2%C2%A0%E6%96%B0%E5%BB%BA%20i18n%20%E6%96%87%E4%BB%B6%E5%A4%B9" rel="nofollow">5.1.2 新建 i18n 文件夹</a></p> 
<p id="5.1.3%C2%A0%E6%9B%B4%E6%96%B0%20zh.ts%20%26%20en.ts-toc" style="margin-left:80px;"><a href="#5.1.3%C2%A0%E6%9B%B4%E6%96%B0%20zh.ts%20%26%20en.ts" rel="nofollow">5.1.3 更新 zh.ts &amp; en.ts</a></p> 
<p id="5.1.4%C2%A0%E6%9B%B4%E6%96%B0%20index.ts-toc" style="margin-left:80px;"><a href="#5.1.4%C2%A0%E6%9B%B4%E6%96%B0%20index.ts" rel="nofollow">5.1.4 更新 index.ts</a></p> 
<p id="5.1.5%C2%A0%E5%9C%A8%20main.ts%20%E6%B3%A8%E5%86%8C-toc" style="margin-left:80px;"><a href="#5.1.5%C2%A0%E5%9C%A8%20main.ts%20%E6%B3%A8%E5%86%8C" rel="nofollow">5.1.5 在 main.ts 注册</a></p> 
<p id="5.2%C2%A0%E4%BD%BF%E7%94%A8-toc" style="margin-left:40px;"><a href="#5.2%C2%A0%E4%BD%BF%E7%94%A8" rel="nofollow">5.2 使用多语言</a></p> 
<p id="5.2.1%20%E5%9C%A8%20login.vue%20%E4%B8%AD%E4%BD%BF%E7%94%A8-toc" style="margin-left:80px;"><a href="#5.2.1%20%E5%9C%A8%20login.vue%20%E4%B8%AD%E4%BD%BF%E7%94%A8" rel="nofollow">5.2.1 在 login.vue 中使用</a></p> 
<p id="5.2.2%20%E8%BF%90%E8%A1%8C%E6%95%88%E6%9E%9C-toc" style="margin-left:80px;"><a href="#5.2.2%20%E8%BF%90%E8%A1%8C%E6%95%88%E6%9E%9C" rel="nofollow">5.2.2 运行效果</a></p> 
<p id="5.3%20%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#5.3%20%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81" rel="nofollow">5.3 提交代码</a></p> 
<p id="%E6%80%BB%E7%BB%93-toc" style="margin-left:0px;"><a href="#%E6%80%BB%E7%BB%93" rel="nofollow">总结</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h4 id="%E5%89%8D%E8%A8%80">前言</h4> 
<p>这篇文章是在之前的<a class="link-info" href="https://blog.csdn.net/qq_17335549/article/details/128480583" title="这篇小白教程">这篇小白教程</a>的基础上进行的，建议先完成之前的文章的学习。请去我的<a class="link-info" href="https://gitee.com/yangjihong2113/learn-vite" rel="nofollow" title="gitee仓库">gitee仓库</a>拉取代码，代码相对于小白教程的文章有部分优化内容（下图），在教程中没有详细指出，可以参照提交记录学习。</p> 
<p><img alt="" height="402" src="https://images2.imgbox.com/07/18/vu6ZCouX_o.png" width="1200"></p> 
<h2 id="%E4%B8%80%E3%80%81%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E5%87%86%E5%A4%87">一、基础知识准备</h2> 
<p>一个完整的 vue 工程化项目，除了<a class="link-info" href="https://blog.csdn.net/qq_17335549/article/details/128480583" title="这篇文章">这篇文章</a>完成的基础建设之外，还有必不可少的几个模块，分别是：</p> 
<h3 id="1.1%20%E6%8E%A5%E5%8F%A3%E8%AF%B7%E6%B1%82%20%EF%BC%88%E6%9C%AC%E7%AF%87%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%EF%BC%89">1.1 接口请求 （本篇重点内容）</h3> 
<p>常见的接口请求方式有</p> 
<h4 id="1.1.1%C2%A0Fetch%20API">1.1.1 Fetch API</h4> 
<p>Fetch API 是比较简单的原生接口请求方式，支持 Promise 但是兼容不太好，不推荐整个项目都使用。</p> 
<h4 id="1.1.2%20XMLHttpRequest">1.1.2 XMLHttpRequest</h4> 
<p>XMLHttpRequest 是原生ajax 请求的方法，不支持 Promise，用起来需要自己封装，不推荐使用。</p> 
<h4 id="1.1.3%C2%A0axios%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89">1.1.3 axios（推荐）</h4> 
<p><a class="link-info" href="https://www.axios-http.cn/" rel="nofollow" title="axios">axios</a> 是基于 XMLHttpRequest 封装的比较成熟的前端请求库，推荐使用。本篇文章主要介绍的是使用 axios 封装请求。 </p> 
<h4 id="1.1.4%20EventSource">1.1.4 EventSource</h4> 
<p>用来建立长链接，接收服务器推送的消息，可以<a class="link-info" href="https://blog.csdn.net/qq_17335549/article/details/131245948" title="参考这篇文章">参考这篇文章</a>，请按需使用。</p> 
<h4 id="1.1.5%20WebSocket">1.1.5 WebSocket</h4> 
<p>WebSocket 基于 tcp 协议，可以实现客户端和后端双向交换消息，请按需使用。</p> 
<p></p> 
<h3 id="1.2%20ts%20%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89%20%EF%BC%88%E6%9C%AC%E7%AF%87%E5%86%85%E5%AE%B9%EF%BC%89">1.2 ts 类型定义 （本篇内容）</h3> 
<p>ts 项目都需要一个 typing.d.ts 进行类型定义</p> 
<p></p> 
<h3 id="1.3%C2%A0svg%20%E9%9B%AA%E7%A2%A7%E5%9B%BE%EF%BC%88%E6%9C%AC%E7%AF%87%E5%86%85%E5%AE%B9%EF%BC%89">1.3 svg 雪碧图（本篇内容）</h3> 
<p>使用插件实现对 svg 图标的压缩和管理，vite 项目可以使用 <a class="link-info" href="https://github.com/vbenjs/vite-plugin-svg-icons/tree/main?tab=readme-ov-file#readme" title="vite-plugin-svg-icons">vite-plugin-svg-icons</a></p> 
<p>关于svg 图标相关知识，可以参考<a class="link-info" href="https://blog.csdn.net/qq_17335549/article/details/126603138" title="这篇文章">这篇文章</a>。</p> 
<p></p> 
<h3 id="1.4%C2%A0%C2%A0i18n%20%E5%A4%9A%E8%AF%AD%E8%A8%80%EF%BC%88%E6%9C%AC%E7%AF%87%E5%86%85%E5%AE%B9%EF%BC%89">1.4  i18n 多语言（本篇内容）</h3> 
<p><a class="link-info" href="https://www.npmjs.com/package/i18n" rel="nofollow" title="i18n">i18n</a> 是一个成熟的国际化工具，用来实现页面上的语言切换</p> 
<p></p> 
<h3 id="1.5%C2%A0%E5%85%AC%E5%85%B1%E5%B7%A5%E5%85%B7%E6%96%B9%E6%B3%95%EF%BC%88%E9%9D%9E%E6%9C%AC%E7%AF%87%E5%86%85%E5%AE%B9%EF%BC%89">1.5 公共工具方法（非本篇内容）</h3> 
<h4 id="1.5.1%20%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3">1.5.1 本地存储相关</h4> 
<p>本地存储包括 cookie、localStorage、indexDB等</p> 
<h5 id="a%EF%BC%89cookie">a）cookie</h5> 
<p>对于 cookie 过期时间的处理比较麻烦，建议不要自己写方法，已经有成熟的库 js-cookie 可供我们使用了。</p> 
<h5 id="b%EF%BC%89localStorage">b）localStorage</h5> 
<p>localStorage 存储数据涉及到对对象和数组的存储，为了使用方便，我们一般封装几个获取对象/数组的方法，将使用原生方法 localStorage.getItem 获取的值进行 JSON.parse 再返回对象/数组。</p> 
<h4 id="1.5.2%20%E6%97%A5%E6%9C%9F%E7%9B%B8%E5%85%B3">1.5.2 日期相关</h4> 
<h5 id="a%EF%BC%89%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%92%8C%E8%AE%A1%E7%AE%97">a）格式化和计算</h5> 
<p>不要要在自己格式化和计算日期了，<a class="link-info" href="https://www.npmjs.com/package/moment" rel="nofollow" title="moment">moment</a> 插件帮你解决各种日期转换问题。</p> 
<h5 id="b%EF%BC%89%E6%97%B6%E5%B7%AE%E9%97%AE%E9%A2%98">b）时差问题</h5> 
<p>用时间戳彻底解决前端的时差问题，其他的问题丢给后端，请参考<a class="link-info" href="https://blog.csdn.net/qq_17335549/article/details/131253073" title="这篇文章">这篇文章</a>。</p> 
<h4 id="1.5.3%20%E8%AE%BE%E5%A4%87%E5%8C%BA%E5%88%86">1.5.3 设备区分</h4> 
<h5 id="a)%20userAgent">a) userAgent</h5> 
<p>使用 navigator.userAgent 进行设备、浏览器的区分</p> 
<h5 id="b%EF%BC%89h5%20%E5%94%A4%E8%B5%B7%20APP">b）h5 唤起 APP</h5> 
<p>使用 <a class="link-info" href="https://www.npmjs.com/package/callapp-lib" rel="nofollow" title="callapp-lib">callapp-lib</a></p> 
<h4 id="1.5.4%20%E5%88%A4%E6%96%AD%20js%20%E7%B1%BB%E5%9E%8B%20%EF%BC%88is%EF%BC%89">1.5.4 判断 js 类型 （is）</h4> 
<p>可以使用<a class="link-info" href="https://www.npmjs.com/package/is" rel="nofollow" title="is">is</a> 库，也可以自己实现常用的方法，因为比较简单</p> 
<h4 id="1.5.5%20%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6">1.5.5 上传文件</h4> 
<p>上传图片、文件</p> 
<h4 id="1.5.6%20%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6">1.5.6 下载文件</h4> 
<h5 id="a%EF%BC%89%E6%B5%8F%E8%A7%88%E5%99%A8%E8%83%BD%E9%A2%84%E8%A7%88%E7%9A%84%E6%96%87%E4%BB%B6">a）浏览器能预览的文件</h5> 
<p>pdf、txt 等使用ajax</p> 
<h5 id="b%EF%BC%89%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8D%E8%83%BD%E9%A2%84%E8%A7%88%E7%9A%84%E6%96%87%E4%BB%B6">b）浏览器不能预览的文件</h5> 
<p>直接使用 window.location.href 即可</p> 
<h4 id="1.5.7%20%E9%98%B2%E6%8A%96%E5%92%8C%E8%8A%82%E6%B5%81">1.5.7 防抖和节流</h4> 
<p>使用 <a class="link-info" href="https://www.npmjs.com/package/lodash" rel="nofollow" title="lodash">lodash</a></p> 
<p></p> 
<h3 id="1.6%C2%A0%E9%83%A8%E7%BD%B2">1.6 部署</h3> 
<p>使用 <a class="link-info" href="https://vercel.com" rel="nofollow" title="vercel">vercel</a> 部署</p> 
<p></p> 
<h3 id="%E5%B0%8F%E7%BB%93">小结</h3> 
<p>全部的内容非常多，所以本篇文章不包含5、6这两部分内容，对于其他内容也不具体解释每个模块的细致原理和功能，只详细介绍写代码的流程步骤。</p> 
<p>再次强调，在开始之前，需要在仓库的的这个合并拉一个新的分支 feat-project</p> 
<p><img alt="" height="396" src="https://images2.imgbox.com/96/d9/CbKRe6r9_o.png" width="1200"></p> 
<p></p> 
<h2 id="%E4%BA%8C%E3%80%81%E5%A2%9E%E5%8A%A0%E6%8E%A5%E5%8F%A3%E8%AF%B7%E6%B1%82%E6%A8%A1%E5%9D%97">二、增加接口请求模块</h2> 
<p>流程图如下，建议克隆代码，一步一步的跟着来，本质是对 axios 的封装。</p> 
<p><img alt="" height="594" src="https://images2.imgbox.com/62/08/0R70nLTK_o.png" width="1200"></p> 
<h3 id="2.1%20%E4%BD%BF%E7%94%A8%20axios%20%E6%A8%A1%E5%9D%97">2.1 使用 axios 模块</h3> 
<h4 id="2.1.1%20%E5%AE%89%E8%A3%85%20axios%20%E6%A8%A1%E5%9D%97">2.1.1 安装 axios 模块</h4> 
<pre><code class="language-bash">pnpm i axios</code></pre> 
<h4 id="2.1.2%20%E6%96%B0%E5%BB%BA%C2%A0service%20%E6%96%87%E4%BB%B6%E5%A4%B9">2.1.2 新建 service 文件夹</h4> 
<p>在 src 下新建 service 文件夹</p> 
<h4 id="2.1.3%C2%A0%E6%96%B0%E5%BB%BA%20request.ts">2.1.3 新建 request.ts</h4> 
<p>在 service 文件夹下新建 request.ts</p> 
<p><img alt="" height="394" src="https://images2.imgbox.com/4d/c0/H7cvgQyk_o.png" width="472"></p> 
<h4 id="2.1.4%20%E5%88%9B%E5%BB%BA%20axio%20%E8%AF%B7%E6%B1%82%E5%AE%9E%E4%BE%8B">2.1.4 创建 axios 请求实例</h4> 
<p>（1）在 request.ts 中使用创建 axios请求实例</p> 
<p><img alt="" height="508" src="https://images2.imgbox.com/ef/6f/KAMMq4et_o.png" width="1028"></p> 
<p>（2）源代码</p> 
<pre><code class="language-TypeScript">import axios, { AxiosInstance } from 'axios'

function createRequestInstance(url: string): AxiosInstance {
	const instance = axios.create({
		timeout: 1000 * 60 * 5, // 超时时间
		withCredentials: true, // 允许跨域携带cookie
		baseURL: url, // 请求地址
	})
	return instance
}

export default createRequestInstance
</code></pre> 
<h4 id="2.1.5%C2%A0%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81">2.1.5 提交代码</h4> 
<p></p> 
<h3 id="2.2%20%E5%A2%9E%E5%8A%A0%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">2.2 增加错误处理</h3> 
<h4 id="2.2.1%20%E6%96%B0%E5%BB%BA%20error.ts%C2%A0">2.2.1 新建 error.ts </h4> 
<p>（1）在 service 目录下增加 error.ts 文件，用于axios 请求的错误处理</p> 
<p><img alt="" height="336" src="https://images2.imgbox.com/27/b5/4smJrRl5_o.png" width="492"></p> 
<p>（2） 在 error.ts 中增加 AxiosRequestError 类，将 axios 原生的错误类型(AxiosError)封装成我们自定义的错误类型，并对一些常见的错误码进行处理</p> 
<p><img alt="" height="1022" src="https://images2.imgbox.com/41/97/1OinbyR4_o.png" width="1200"></p> 
<p>（3）源代码</p> 
<pre><code class="language-TypeScript">import { AxiosError } from 'axios'

// 服务器报错返回 Error 的时候的数据结构，可以和后端商量定义，但是所有接口的格式要统一
export type ErrorResponse = {
	status: number // http 状态码，这个是必须的
	// 其他自定义类型类型
}

class AxiosRequestError extends Error {
	data: ErrorResponse | undefined

	raw: AxiosError

	isUnAuthorized = false // 权限错误 401

	isServerError = false // 服务器错误 500 等

	constructor(status: number, message: string, raw: AxiosError, data?: ErrorResponse) {
		// 调用父类「Error」的构造函数
		super(message)
		this.data = data // 后端返回的 data
		this.raw = raw // axios 返回的原始数据
		this.isUnAuthorized = status === 401
		this.isServerError = status &gt;= 500
		this.message = this.message || '' //给用户展示的错误消息，后续可以自定义
	}
}

export default AxiosRequestError
</code></pre> 
<p>（4）提交代码</p> 
<h4 id="2.2.2%20%E6%96%B0%E5%BB%BA%C2%A0handleError.ts">2.2.2 新建 handleError.ts</h4> 
<p>（1）在 service 文件夹下增加 handleError.ts</p> 
<p><img alt="" height="370" src="https://images2.imgbox.com/3a/12/ao8ladZS_o.png" width="494"><br> （2）新增 handleError 方法</p> 
<p>在 handleError.ts 中调用 AxiosRequestError 类，将 axios 默认的 AxiosError 转成我们处理过的  AxiosRequestError 类</p> 
<p><img alt="" height="452" src="https://images2.imgbox.com/6c/5d/mPzCozkV_o.png" width="1200"></p> 
<p>（3） 源代码</p> 
<pre><code class="language-TypeScript">import { AxiosError } from 'axios'
import AxiosRequestError, { ErrorResponse } from './error'

// 把 axios 的 错误 转成 我们已经封装的 AxiosRequestError 类，统一处理
export function handleError(error: AxiosError | AxiosRequestError): AxiosRequestError {
	const err = error instanceof AxiosRequestError ? error : new AxiosRequestError(error.response?.status || 1, error.message, error, error.response?.data as ErrorResponse)
	return err
}
</code></pre> 
<p>（4）提交代码</p> 
<h4 id="2.2.3%C2%A0%E5%BA%94%E7%94%A8%20handleError%20%E6%96%B9%E6%B3%95">2.2.3 应用 handleError 方法</h4> 
<p>（1）在 request.ts 中应用handleError，增加 axios 响应的拦截器，对错误进行处理</p> 
<p><img alt="" height="876" src="https://images2.imgbox.com/8f/5f/csuL3ZQa_o.png" width="1200"></p> 
<p>（2） 源代码</p> 
<pre><code class="language-TypeScript">import axios, { AxiosInstance } from 'axios'
import { handleError } from './handleError'

function createRequestInstance(url: string): AxiosInstance {
	const instance = axios.create({
		timeout: 1000 * 60 * 5, // 超时时间
		withCredentials: true, // 允许跨域携带cookie
		baseURL: url, // 请求地址
	})

	instance.interceptors.response.use(
		async res =&gt; {
			return res
		},
		async err =&gt; {
			err = await handleError(err)
			return Promise.reject(err)
		},
	)
	return instance
}

export default createRequestInstance
</code></pre> 
<p>（3）提交代码</p> 
<p></p> 
<h3 id="2.3%C2%A0%20%E5%A2%9E%E5%8A%A0%20web%20%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95">2.3  增加 web 请求方法</h3> 
<h4 id="2.3.1%C2%A0%E5%AE%9A%E4%B9%89%E6%8E%A5%E5%8F%A3%E5%88%97%E8%A1%A8" style="background-color:transparent;">2.3.1 定义接口列表</h4> 
<p>（1）在 service 下面增加 apiList.ts 存放系统中所有的请求地址</p> 
<p><img alt="" height="376" src="https://images2.imgbox.com/02/78/mkit6Md4_o.png" width="442"></p> 
<p>（2）在 apiList.ts 中随便定义接口</p> 
<p><img alt="" height="382" src="https://images2.imgbox.com/27/e6/opdpvVRO_o.png" width="770"></p> 
<p>（3）源代码</p> 
<pre><code class="language-TypeScript">// 系统中所有请求的接口
export const APIs = {
	login: '/login',
	// 还可以这样分成功能模块
	user: {
		Info: '/userinfo',
	},
}
</code></pre> 
<p> （4）提交代码</p> 
<h4 id="2.3.2%C2%A0%E5%B0%81%E8%A3%85%20API%20%E7%B1%BB">2.3.2 封装 API 类</h4> 
<p>（1）增加 requestList.ts</p> 
<p><img alt="" height="448" src="https://images2.imgbox.com/0f/9c/KCVfXmOj_o.png" width="436"></p> 
<p>（3）封装 API 类</p> 
<p><img alt="" height="1142" src="https://images2.imgbox.com/09/e6/TNLmIxdz_o.png" width="1200"></p> 
<p>（3） 源代码</p> 
<pre><code class="language-TypeScript">import { AxiosRequestConfig, AxiosResponse } from 'axios'
import createRequestInstance from './request'

class API {
	request!: ReturnType&lt;typeof createRequestInstance&gt;

	get!: &lt;T = any, R = AxiosResponse&lt;T&gt;&gt;(url: string, config?: AxiosRequestConfig) =&gt; Promise&lt;R&gt;

	delete!: &lt;T = any, R = AxiosResponse&lt;T&gt;&gt;(url: string, config?: AxiosRequestConfig) =&gt; Promise&lt;R&gt;

	head!: &lt;T = any, R = AxiosResponse&lt;T&gt;&gt;(url: string, config?: AxiosRequestConfig) =&gt; Promise&lt;R&gt;

	options!: &lt;T = any, R = AxiosResponse&lt;T&gt;&gt;(url: string, config?: AxiosRequestConfig) =&gt; Promise&lt;R&gt;

	post!: &lt;T = any, R = AxiosResponse&lt;T&gt;&gt;(url: string, data?: any, config?: AxiosRequestConfig) =&gt; Promise&lt;R&gt;

	put!: &lt;T = any, R = AxiosResponse&lt;T&gt;&gt;(url: string, data?: any, config?: AxiosRequestConfig) =&gt; Promise&lt;R&gt;

	patch!: &lt;T = any, R = AxiosResponse&lt;T&gt;&gt;(url: string, data?: any, config?: AxiosRequestConfig) =&gt; Promise&lt;R&gt;

	constructor(options: { url: string }) {
		const request = createRequestInstance(options.url)
		this.request = request
		this.post = request.post.bind(this)
		this.put = request.put.bind(this)
		this.get = request.get.bind(this)
		this.delete = request.delete.bind(this)
		this.head = request.head.bind(this)
		this.options = request.options.bind(this)
		this.patch = request.patch.bind(this)
	}
}

export default API
</code></pre> 
<p>（4）提交代码</p> 
<h4 id="2.3.3%20%E5%AE%9E%E4%BE%8B%E5%8C%96%20API%20%E7%B1%BB">2.3.3 实例化 API 类</h4> 
<p>（1） 增加 webRequest.ts</p> 
<p><img alt="" height="474" src="https://images2.imgbox.com/fc/6d/gq2TEdvl_o.png" width="412"></p> 
<p>（2）实例化API类，增加 axio的拦截器</p> 
<p><img alt="" height="1088" src="https://images2.imgbox.com/18/97/GNiueKM2_o.png" width="1200"></p> 
<p>（3）源代码</p> 
<pre><code class="language-TypeScript">import API from './requestList'
import AxiosRequestError from './error'
import { handleError } from './handleError'

const $api = new API({
	url: 'https://xxx.com/api', // 这个是请求的后台的服务的地址
})

// 请求的拦截器
$api.request.interceptors.request.use((config: any) =&gt; {
	const headers = config.headers || {}
	// 这个地方可以自定义请求头
	config.headers = {
		...headers,
		language: 'en', // 这个是自定义的请求头，还可以加 token 等
	}
	return config
})

// 响应的拦截器
$api.request.interceptors.response.use(undefined, async (err: AxiosRequestError) =&gt; {
	err = handleError(err) // 调用我们自定义的 错误处理方法
	if (err.isUnAuthorized) {
		// 未授权的情况的处理
	}
	// 还可以自定义其他的情况的处理

	return Promise.reject(err)
})

// 在 page 页面就可以直接调用这个 $api 请求接口
export default $api
</code></pre> 
<p>（4）提交代码</p> 
<h4 id="2.3.4%C2%A0%E6%B5%8B%E8%AF%95%E4%B8%80%E4%B8%8B%E9%9D%99%E6%80%81%E5%87%BD%E6%95%B0">2.3.4 测试一下静态函数</h4> 
<p>（1）增加API 类的静态函数</p> 
<p>在 requestList.ts 中的 API 类中增加静态方法 getUserInfo </p> 
<p><img alt="" height="794" src="https://images2.imgbox.com/ef/2d/3zEvTA6j_o.png" width="1200"></p> 
<p>（3）在 App.vue 中调用</p> 
<p><img alt="" height="746" src="https://images2.imgbox.com/39/a8/htlF2eVr_o.png" width="1200"></p> 
<p>（4）npm run dev 运行项目</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/5e/e4/reBAFnFq_o.png" width="1200"></p> 
<p>（5）提交代码</p> 
<h4 id="2.3.5%20%E6%B5%8B%E8%AF%95%E4%B8%80%E4%B8%8B%E9%9D%9E%E9%9D%99%E6%80%81%E5%87%BD%E6%95%B0">2.3.5 测试一下非静态函数</h4> 
<p>（1）在 App.vue 测试</p> 
<p><img alt="" height="850" src="https://images2.imgbox.com/1d/f9/N3YldOtF_o.png" width="1200"></p> 
<p>（2）效果</p> 
<p><img alt="" height="538" src="https://images2.imgbox.com/10/f5/rL5iCkht_o.png" width="1200"></p> 
<p> （3）提交代码</p> 
<p></p> 
<h3 id="2.4%C2%A0%E4%BC%98%E5%8C%96%E8%AF%B7%E6%B1%82%E6%A8%A1%E5%9D%97">2.4 优化请求模块</h3> 
<h4 id="2.4.1%C2%A0%E4%BC%98%E5%8C%96%E8%AF%B7%E6%B1%82%E5%9C%B0%E5%9D%80">2.4.1 优化请求地址</h4> 
<p>实际项目中，我们需要区分请求的测试服务地址和正式服务地址，所以在 3.3 的步骤中，webRequest.ts 中 实例化 API 类的过程中 url的地址就不能写成一个固定的字符串。本节中我们对这一部分做优化。</p> 
<p>（1）新建 env.ts</p> 
<p>在 src 目录下新建 global 文件夹放通用配置文件，在 global 文件夹下面新建 env.ts 用于配置项目的环境变量（用于区分测试环境和正式环境）</p> 
<p><img alt="" height="202" src="https://images2.imgbox.com/bb/06/aPibz2NM_o.png" width="476"></p> 
<p>（2）定义环境变量和获取环境变量的函数</p> 
<p><img alt="" height="1072" src="https://images2.imgbox.com/9c/d8/gWerqAFc_o.png" width="1200"></p> 
<p>（3）修改 request.ts</p> 
<p>将 service/request.ts 中的函数参数变成一个函数，用于调用获取环境变量的函数</p> 
<p><img alt="" height="548" src="https://images2.imgbox.com/75/70/wKl5J1ZM_o.png" width="1200"></p> 
<p></p> 
<p>（4）修改 requestList.ts</p> 
<p>修改在 API 类构造函数中调用 createRequestInstance 的参数</p> 
<p><img alt="" height="484" src="https://images2.imgbox.com/80/db/nHvQsvca_o.png" width="1200"></p> 
<p>（5）修改 webRequest.ts </p> 
<p>修改实例化 API 类的地方的参数</p> 
<p><img alt="" height="522" src="https://images2.imgbox.com/db/be/G0V363Dp_o.png" width="1200"></p> 
<p>（6）测试一下测试环境</p> 
<p>运行 npm run dev 测试一下配置的地址是否正确</p> 
<p><img alt="" height="376" src="https://images2.imgbox.com/26/28/z1b412sK_o.png" width="1176"></p> 
<p>（7）测试一下正式环境</p> 
<p><img alt="" height="1058" src="https://images2.imgbox.com/dc/d9/vbh9WbD3_o.png" width="1200"></p> 
<p><img alt="" height="412" src="https://images2.imgbox.com/4d/e7/w6uhUlWC_o.png" width="1200"></p> 
<p> （8）还原（7）中修改的 env.ts 中的代码</p> 
<p>最终的env.ts的代码如下</p> 
<pre><code class="language-TypeScript">// 正式环境
export const PROD_ENV = {
	SERVER_URL: 'https://xxx.com/api', // 服务地址
	IS_DEV: 'false', // 是否是测试环境
}

// 测试环境
export const DEV_ENV = {
	SERVER_URL: 'https://xxx-test.com/api',
	IS_DEV: 'true',
}

// 假设测试环境的域名是 https://xxx-test.com
const isDev = process.env.NODE_ENV === 'development' || ['xxx-test.com'].includes(location.host)

export type EnvKey = keyof typeof PROD_ENV

// 调用这个函数获取当前的环境变量
export function getProcessEnv(key: EnvKey): string | void {
	if (isDev) {
		if (DEV_ENV[key] !== undefined) {
			return DEV_ENV[key]
		}
		return ''
	}
	if (PROD_ENV[key] !== undefined) {
		return PROD_ENV[key]
	}
}
</code></pre> 
<p>（9）提交代码</p> 
<p>再确认一下，这个小节，主要的工作:</p> 
<ol><li>增加一个配置文件 env.ts</li><li>修改了一个函数的参数（request.ts 中的 createRequestInstance）导致了修改了三个文件</li></ol> 
<p> <img alt="" height="598" src="https://images2.imgbox.com/b7/2b/R4HirIQq_o.png" width="1058"></p> 
<p></p> 
<p>至此，本项目中的接口请求模块结束。</p> 
<p></p> 
<h2 id="%E4%B8%89%E3%80%81ts%20%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89">三、ts 类型定义</h2> 
<p>对于ts项目，可以自定义数据的类型，对于一些没有提供类型定义的第三方模块，我们为了解决编辑器报的ts类型错误，也可以自定义ts类型</p> 
<h3 id="3.1%C2%A0%E6%96%B0%E5%BB%BA%20typings%20%E6%96%87%E4%BB%B6%E5%A4%B9">3.1 新建 typings 文件夹</h3> 
<p>在src 目录下新建 typings文件夹，存放类型文件</p> 
<h3 id="3.2%C2%A0%E6%96%B0%E5%BB%BA%20index.d.ts">3.2 新建 index.d.ts</h3> 
<p>在 typings 文件夹下面新建 index.d.ts 用于类型定义</p> 
<p><img alt="" height="310" src="https://images2.imgbox.com/49/16/xgmIIz7F_o.png" width="758"></p> 
<h3 id="%C2%A03.3%C2%A0%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81">3.3 提交代码</h3> 
<p></p> 
<h2 id="%E5%9B%9B%E3%80%81%E5%A2%9E%E5%8A%A0%20svg%20%E9%9B%AA%E7%A2%A7%E5%9B%BE">四、增加 svg 雪碧图</h2> 
<h3 id="4.1%C2%A0%E9%85%8D%E7%BD%AE%E6%8F%92%E4%BB%B6">4.1 配置插件</h3> 
<h4 id="4.1.1%20%E5%AE%89%E8%A3%85%20vite-plugin-svg-icons">4.1.1 安装 vite-plugin-svg-icons</h4> 
<pre><code class="language-bash">pnpm i vite-plugin-svg-icons -D</code></pre> 
<h4 id="4.1.2%20%E5%9C%A8%20vite.config.ts%20%E4%B8%AD%E9%85%8D%E7%BD%AE">4.1.2 在 vite.config.ts 中配置</h4> 
<p><img alt="" height="768" src="https://images2.imgbox.com/1d/7f/upWhLGRX_o.png" width="1200"></p> 
<h4 id="4.1.3%20%E5%9C%A8%20main.ts%20%E4%B8%AD%E5%BC%95%E5%85%A5">4.1.3 在 main.ts 中引入</h4> 
<pre><code class="language-TypeScript">import 'virtual:svg-icons-register'</code></pre> 
<p><img alt="" height="414" src="https://images2.imgbox.com/15/74/fPmiUb0I_o.png" width="1200"></p> 
<h4 id="%C2%A04.1.4%C2%A0%E5%88%9B%E5%BB%BA%20src%2Fimages%2Fsvgs%20%E6%96%87%E4%BB%B6%E5%A4%B9"> 4.1.4 创建 src/images/svgs 文件夹</h4> 
<p><img alt="" height="170" src="https://images2.imgbox.com/6c/ec/U8bRtHBk_o.png" width="474"></p> 
<p>随便弄个svg 图片放入 src/images/svgs 文件夹下，项目中的那个vue.svg 就是现成的</p> 
<p><img alt="" height="114" src="https://images2.imgbox.com/07/5b/JFFWcbGS_o.png" width="488"></p> 
<p></p> 
<h3 id="4.2%C2%A0%E4%BD%BF%E7%94%A8%E6%8F%92%E4%BB%B6">4.2 使用插件</h3> 
<h4 id="4.2.1%20%E6%96%B0%E5%BB%BA%20SvgIcon.vue">4.2.1 新建 SvgIcon.vue</h4> 
<p>在 src/components 目录下新建 SvgIcon.vue</p> 
<p><img alt="" height="1074" src="https://images2.imgbox.com/71/73/vh8KCdnB_o.png" width="1200"></p> 
<h4 id="4.2.2%20%E5%9C%A8%20login.vue%20%E4%B8%AD%E4%BD%BF%E7%94%A8">4.2.2 在 login.vue 中使用</h4> 
<p id="%E2%80%8B%E7%BC%96%E8%BE%914.2.3%20%E8%BF%90%E8%A1%8C%E6%95%88%E6%9E%9C"><img alt="" height="524" src="https://images2.imgbox.com/69/a2/cMDApA4g_o.png" width="1200"></p> 
<h4 id="4.2.3%20%E8%BF%90%E8%A1%8C%E6%95%88%E6%9E%9C">4.2.3 运行效果</h4> 
<p id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="227" src="https://images2.imgbox.com/73/b9/GlJwemqt_o.png" width="271"></p> 
<h4 id="4.2.4%20%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81">4.2.4 提交代码</h4> 
<p><img alt="" height="638" src="https://images2.imgbox.com/02/8e/SUM3JPz0_o.png" width="1200"></p> 
<p></p> 
<h2 id="%E4%BA%94%E3%80%81i18n%20%E5%A4%9A%E8%AF%AD%E8%A8%80">五、i18n 多语言</h2> 
<h3 id="5.1%C2%A0%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE">5.1 安装和配置</h3> 
<h4 id="5.1.1%20%E5%AE%89%E8%A3%85%20vue-i18n">5.1.1 安装 vue-i18n</h4> 
<pre><code class="language-bash">pnpm i vue-i18n</code></pre> 
<h4 id="5.1.2%C2%A0%E6%96%B0%E5%BB%BA%20i18n%20%E6%96%87%E4%BB%B6%E5%A4%B9">5.1.2 新建 i18n 文件夹</h4> 
<p>在 src/global 下面新建 i18n 文件夹，同时在该文件夹下新建 index.ts 、en.ts、zh.ts</p> 
<p><img alt="" height="288" src="https://images2.imgbox.com/c2/92/kXQAwtoh_o.png" width="476"></p> 
<h4 id="5.1.3%C2%A0%E6%9B%B4%E6%96%B0%20zh.ts%20%26%20en.ts">5.1.3 更新 zh.ts &amp; en.ts</h4> 
<p><img alt="" height="256" src="https://images2.imgbox.com/ad/fc/kwstEjdD_o.png" width="1134"></p> 
<h4 id="5.1.4%C2%A0%E6%9B%B4%E6%96%B0%20index.ts">5.1.4 更新 index.ts</h4> 
<p><img alt="" height="572" src="https://images2.imgbox.com/16/c9/sAIxe1OB_o.png" width="1104"></p> 
<h4 id="5.1.5%C2%A0%E5%9C%A8%20main.ts%20%E6%B3%A8%E5%86%8C">5.1.5 在 main.ts 注册</h4> 
<p><img alt="" height="476" src="https://images2.imgbox.com/d3/5c/eadgrjKs_o.png" width="1200"></p> 
<h3 id="5.2%C2%A0%E4%BD%BF%E7%94%A8">5.2 使用多语言</h3> 
<h4 id="5.2.1%20%E5%9C%A8%20login.vue%20%E4%B8%AD%E4%BD%BF%E7%94%A8">5.2.1 在 login.vue 中使用</h4> 
<p><img alt="" height="478" src="https://images2.imgbox.com/28/3c/HYsrcOsE_o.png" width="1200"></p> 
<h4 id="5.2.2%20%E8%BF%90%E8%A1%8C%E6%95%88%E6%9E%9C">5.2.2 运行效果</h4> 
<p>运行 npm run dev ，点击按钮可以切换语言</p> 
<p><img alt="" height="268" src="https://images2.imgbox.com/7c/ea/EWM4XisE_o.png" width="324"></p> 
<h3 id="5.3%20%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81">5.3 提交代码</h3> 
<p><img alt="" height="632" src="https://images2.imgbox.com/6c/a1/jFx4BHih_o.png" width="1200"></p> 
<p></p> 
<h2 id="%E6%80%BB%E7%BB%93">总结</h2> 
<p>至此，本片文章内容结束，一个完整的vite 项目还剩两个部分，一个是公共函数一个是部署，这将在下一片文章完成。</p> 
<p>其实到这里整个项目基本就完成了，剩下的公共函数可以等你用到的时候再写也来得及，至于部署的部分，每个公司的部署流程也不一样，也看你的需求了。</p> 
<p>项目地址是，<a href="https://gitee.com/yangjihong2113/learn-vite" rel="nofollow" title="learn-vite: 搭建简单的vite+ts+vue框架">learn-vite: 搭建简单的vite+ts+vue框架</a></p> 
<p>有问题欢迎在评论区指正。</p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4a3427d663134cd00f91a0437ab0b4f4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue父组件的watch比子组件的watch先触发</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a0cd10dbdf0f2f8a4fa7a2a177c3048f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Vue系列之指令 v-once</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>