<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>浅谈先验分布和后验分布 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="浅谈先验分布和后验分布" />
<meta property="og:description" content="【前言】
上文提到贝叶斯定理是先验分布和后验分布转换的桥梁，贝叶斯学派计算参数后验分布的难点在于如何选择参数的先验分布，本文通过二项式分布的例子来形象的表达如何选择先验分布和计算后验分布，并阐述了先验分布和后验分布是如何转换的，最后对本文进行总结。
共轭先验分布
定义
当先验分布和后验分布相同时，先验分布和后验分布为共轭先验。
条件
为了满足共轭先验这一条件，先验分布和似然函数分布应相同。
目的
先验分布和后验分布按照人的直观来说应是相同的，且可以形成一个先验链，即随着新观测数据的增加，当前参数的后验分布成为前验分布，新观测数据下的参数分布为后验分布。
先验分布和后验分布的转化过程
连续采样新的观测数据时，当前参数的概率分布为先验分布，计算新采集的数据（可能是一个或一组）的似然函数，计算先验分布和似然函数的乘积，并对该乘积结果进行归一化，得到参数的后验分布，若又有新的观测数据时，则重复以上过程，更新参数的后验分布。
先验分布和后验分布关系的应用举例
【例】用一个二值随机变量x表示抛硬币的结果，1表示正面，0表示反面。假设该硬币的正反两面的概率不相同，且正面概率为参数u，若抛掷N次，正面向上的次数为m，反面向上的此时为l。求（1）参数u的后验概率分布，（2）若连续抛掷硬币，求先验分布和后验分布参数的关系，（3）正面向上的概率
解：（1）多次抛硬币符合二项式分布，正面向上次数为m的概率为：
为了满足共轭先验的条件，参数u的先验分布也应与似然函数的分布相同。即选择参数u的先验分布为beta分布，如下：
等式右边的系数部分是为了满足先验分布的标准化，即：
参数u的先验分布的期望：
后验分布等于前验分布和似然函数的乘积，并对该结果进行标准化，得到该参数的后验分布。
后验分布形式：
标准化后的结果：
（2）连续抛掷硬币时，当前的参数分布为先验分布，与新采样数据的似然函数进行乘积，再对该结果进行标准化。容易知道，后验分布的形式保持不变，指数发生变化。
比较数据集似然函数的二项式分布和beta分布，可知a表示正面向上的次数，b表示反面向上的次数，由（1）的后验概率分布可知，当新数据的抛掷结果为m次正面向上，l次反面向上，那么后验概率分布的指数表示m&#43;a次正面向上，l&#43;b次反面向上，以此递推。
若a=1，b=1，参数u的先验分布为：
当观测新数据为1次正面向上(m=1)，2次反面向上(l=2)，则后验分布的指数表示2次正面向上，3次反面向上。
后验分布如下图：
（3）根据贝叶斯的求和准则与求积准则，参数u的分布采用后验分布，得：
参考先验分布的参数u的期望，可得后验分布：
总结
后验分布等于先验分布与似然函数乘积的标准化，共轭先验的目的在于使先验分布和后验分布保持同一形式，形成先验链，当有新的观测数据时，当前的分布成为先验分布，重新计算参数的后验分布。
参考：
Christopher M.Bishop &lt;&lt;Pattern Reconition and Machine Learning&gt;&gt;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/cecf78fbe79c062a771ae109878ca32a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-11-08T21:48:58+08:00" />
<meta property="article:modified_time" content="2018-11-08T21:48:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">浅谈先验分布和后验分布</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>【<strong>前言</strong>】</p> 
<p>上文提到贝叶斯定理是先验分布和后验分布转换的桥梁，贝叶斯学派计算参数后验分布的难点在于如何选择参数的先验分布，本文通过二项式分布的例子来形象的表达如何选择先验分布和计算后验分布，并阐述了先验分布和后验分布是如何转换的，最后对本文进行总结。</p> 
<p> </p> 
<p><strong>                                                                                         共轭先验分布</strong></p> 
<hr> 
<p><strong>定义</strong></p> 
<p>当先验分布和后验分布相同时，先验分布和后验分布为共轭先验。</p> 
<p><strong>条件</strong></p> 
<p>为了满足共轭先验这一条件，先验分布和似然函数分布应相同。</p> 
<p><strong>目的</strong></p> 
<p>先验分布和后验分布按照人的直观来说应是相同的，且可以形成一个先验链，即随着新观测数据的增加，当前参数的后验分布成为前验分布，新观测数据下的参数分布为后验分布。</p> 
<p> </p> 
<p><strong>                                                                             先验分布和后验分布的转化过程</strong></p> 
<hr> 
<p>连续采样新的观测数据时，当前参数的概率分布为先验分布，计算新采集的数据（可能是一个或一组）的似然函数，计算先验分布和似然函数的乘积，并对该乘积结果进行归一化，得到参数的后验分布，若又有新的观测数据时，则重复以上过程，更新参数的后验分布。</p> 
<p><strong>                                                                          先验分布和后验分布关系的应用举例</strong></p> 
<hr> 
<p><strong>【例】</strong>用一个二值随机变量x表示抛硬币的结果，1表示正面，0表示反面。假设该硬币的正反两面的概率不相同，且正面概率为参数u，若抛掷N次，正面向上的次数为m，反面向上的此时为l。求（1）参数u的后验概率分布，（2）若连续抛掷硬币，求先验分布和后验分布参数的关系，（3）正面向上的概率</p> 
<p><strong>解：</strong>（1）多次抛硬币符合二项式分布，正面向上次数为m的概率为：</p> 
<p>                                                  <img alt="" class="has" height="74" src="https://images2.imgbox.com/61/12/UPu7VhKt_o.png" width="374"></p> 
<p><strong>为了满足共轭先验的条件，参数u的先验分布也应与似然函数的分布相同。即选择参数u的先验分布为beta分布，</strong>如下<strong>：</strong></p> 
<p>                                                      <img alt="" class="has" height="66" src="https://images2.imgbox.com/ab/ce/q9xuGABi_o.png" width="400"></p> 
<p><strong>等式右边的系数部分是为了满足先验分布的标准化，即：</strong></p> 
<p>                                                     <img alt="" class="has" height="73" src="https://images2.imgbox.com/3c/19/ZLLvaYgE_o.png" width="230"></p> 
<p>参数u的先验分布的期望：</p> 
<p>                                                     <img alt="" class="has" height="44" src="https://images2.imgbox.com/6b/28/xZNYMj2z_o.png" width="146"></p> 
<p> </p> 
<p><strong>后验分布等于前验分布和似然函数的乘积，并对该结果进行标准化，得到该参数的后验分布</strong>。</p> 
<p>后验分布形式：</p> 
<p><img alt="" class="has" height="46" src="https://images2.imgbox.com/3b/05/kmDZsW73_o.png" width="373"></p> 
<p> </p> 
<p>标准化后的结果：</p> 
<p><img alt="" class="has" height="64" src="https://images2.imgbox.com/02/79/wcQNlcLy_o.png" width="545"></p> 
<p> </p> 
<p>（2）连续抛掷硬币时，当前的参数分布为先验分布，与新采样数据的似然函数进行乘积，再对该结果进行标准化。容易知道，后验分布的形式保持不变，指数发生变化。</p> 
<p>比较数据集似然函数的二项式分布和beta分布，可知a表示正面向上的次数，b表示反面向上的次数，由（1）的后验概率分布可知，当新数据的抛掷结果为m次正面向上，l次反面向上，那么后验概率分布的指数表示m+a次正面向上，l+b次反面向上，以此递推。</p> 
<p>若a=1，b=1，参数u的先验分布为：</p> 
<p>                                                              <img alt="" class="has" height="215" src="https://images2.imgbox.com/8a/b1/tZDp8reJ_o.png" width="301"></p> 
<p>当观测新数据为1次正面向上(m=1)，2次反面向上(l=2)，则后验分布的指数表示2次正面向上，3次反面向上。</p> 
<p>后验分布如下图：</p> 
<p>                                                          <img alt="" class="has" height="256" src="https://images2.imgbox.com/47/44/Ca7wXhV3_o.png" width="347"></p> 
<p>（3）根据贝叶斯的求和准则与求积准则，参数u的分布采用后验分布，得：</p> 
<p>                                           <img alt="" class="has" height="61" src="https://images2.imgbox.com/c1/cc/8FU4VYFZ_o.png" width="558"></p> 
<p>参考先验分布的参数u的期望，可得后验分布：</p> 
<p>                                                                <img alt="" class="has" height="57" src="https://images2.imgbox.com/a7/04/AgaHaa2s_o.png" width="280"></p> 
<p><strong>                                                                                      总结</strong></p> 
<hr> 
<p>后验分布等于先验分布与似然函数乘积的标准化，共轭先验的目的在于使先验分布和后验分布保持同一形式，形成先验链，当有新的观测数据时，当前的分布成为先验分布，重新计算参数的后验分布。</p> 
<p>                                                               <img alt="" class="has" height="237" src="https://images2.imgbox.com/81/e1/GRoqV9e1_o.png" width="291"></p> 
<p><strong>参考：</strong></p> 
<p><strong>Christopher M.Bishop &lt;&lt;Pattern Reconition and Machine Learning&gt;&gt;</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/df764dfb3be111f0ecea57569cb0c6c6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">偏度与峰度的正态性分布判断</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f1b38a2b90ec20f6152d0f532d128261/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">贝叶斯分析：抛硬币的概率真的是1/2吗</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>