<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>系统管理简介 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="系统管理简介" />
<meta property="og:description" content="系统管理 Linux基础 走进Linux Linux历史
Linux之父：Linus Torvalds林纳斯.托瓦兹1994 年，Torvalds 发布 Linux-v1.01996 年，Torvalds 发布 Linux-v2.0，确定了 Linux 的吉祥物：企鹅 常见Linux发行版
Linux Mint、Ubuntu 乌班图、Debian GNU、openSUSE、CentOS、Redhat CentOS
最新版本：centos stream 9；使用版本：centos linux 7红帽 red-hat IBM （红帽认证：RHCSA&gt;RHCE&gt;RHCA 使用红帽收费版rhel）https： #www.centos.org/download/ 服务器简介
IDC：互联网数据中心
机柜：用来存放计算机和相关控制设备的物件
物理服务器：机架式服务器、塔式服务器、刀片式服务器、机柜式服务器
云服务器：公有云、私有云、混合云、容器云
企业通道机（堡垒机、跳板机）：登录功能、账号管理、身份认证、资源授权、访问控制
华为云服务器
www.huaweicloud.com 注册 -&gt; 登录 -&gt; 实名认证 -&gt; 绑定邮箱 -&gt; 开发者免费试用专区
创建实例（实例==云服务器ECS）
控制台 -&gt; 选择服务器位置 -&gt; 服务列表 -&gt; 弹性云服务器ECS -&gt; 更多
云服务器-ECS；公网IP-EIP；私网IP-VPC
系统安装 VMware使用
创建虚拟机
文件 -&gt; 新建虚拟机 -&gt; 自定义-&gt; 兼容性与版本匹配 -&gt; 稍后安装 -&gt; Linux cenos 7 -&gt; 自定义名称位置 -&gt; 处理器数量不超过电脑本身 -&gt; 内存不超过电脑本身 -&gt; 网络地址转换 -&gt; lsi logic-scsi -&gt; 创建新虚拟磁盘 -&gt; 拆分成多个文件 -&gt; 自定义文件位置 -&gt; 确认完成" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/f7062e5eff1720da66ca40f7dd498935/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-12T23:44:51+08:00" />
<meta property="article:modified_time" content="2022-09-12T23:44:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">系统管理简介</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>系统管理</h2> 
<h3><a id="Linux_2"></a>Linux基础</h3> 
<h4><a id="Linux_4"></a>走进Linux</h4> 
<ul><li> <p>Linux历史</p> 
  <ul><li>Linux之父：Linus Torvalds林纳斯.托瓦兹</li><li>1994 年，Torvalds 发布 Linux-v1.0</li><li>1996 年，Torvalds 发布 Linux-v2.0，确定了 Linux 的吉祥物：企鹅</li></ul> </li><li> <p>常见Linux发行版</p> 
  <ul><li>Linux Mint、Ubuntu 乌班图、Debian GNU、openSUSE、CentOS、Redhat</li></ul> </li><li> <p>CentOS</p> 
  <ul><li>最新版本：centos stream 9；使用版本：centos linux 7</li><li>红帽 red-hat IBM （红帽认证：RHCSA&gt;RHCE&gt;RHCA 使用红帽收费版rhel）</li><li>https： #www.centos.org/download/</li></ul> </li><li> <p>服务器简介</p> <p>IDC：互联网数据中心<br> 机柜：用来存放计算机和相关控制设备的物件<br> 物理服务器：机架式服务器、塔式服务器、刀片式服务器、机柜式服务器<br> 云服务器：公有云、私有云、混合云、容器云<br> 企业通道机（堡垒机、跳板机）：登录功能、账号管理、身份认证、资源授权、访问控制</p> 
  <ul><li> <p>华为云服务器</p> <p>www.huaweicloud.com 注册 -&gt; 登录 -&gt; 实名认证 -&gt; 绑定邮箱 -&gt; 开发者免费试用专区<br> 创建实例（实例==云服务器ECS）<br> 控制台 -&gt; 选择服务器位置 -&gt; 服务列表 -&gt; 弹性云服务器ECS -&gt; 更多<br> 云服务器-ECS；公网IP-EIP；私网IP-VPC</p> </li></ul> </li></ul> 
<h4><a id="_37"></a>系统安装</h4> 
<ul><li> <p>VMware使用</p> 
  <ul><li> <p>创建虚拟机</p> <p>文件 -&gt; 新建虚拟机 -&gt; 自定义-&gt; 兼容性与版本匹配 -&gt; 稍后安装 -&gt; Linux cenos 7 -&gt; 自定义名称位置 -&gt; 处理器数量不超过电脑本身 -&gt; 内存不超过电脑本身 -&gt; 网络地址转换 -&gt; lsi logic-scsi -&gt; 创建新虚拟磁盘 -&gt; 拆分成多个文件 -&gt; 自定义文件位置 -&gt; 确认完成</p> </li><li> <p>虚拟机使用</p> <p>启动、关闭、挂起、重启<br> 快照（备份还原点） -&gt; 拍摄、恢复<br> 管理 -&gt; 克隆、从磁盘中删除<br> 设置 -&gt; 添加、修改</p> </li><li> <p>虚拟机网络类型</p> 
    <ul><li> <p>网络地址转换（NAT）</p> <p>可以跟宿主机互相通信，及访问宿主机同一网段的所有服务器，只能被宿主机访问</p> </li><li> <p>桥接：虚拟机IP与宿主机本身处于同一网段</p> </li><li> <p>仅主机：虚拟机只能跟宿主机通信</p> </li></ul> </li></ul> </li><li> <p>安装centos操作系统</p> <p>我的计算机 -&gt; CD/DVD配置IOS镜像文件 -&gt; 开启此虚拟机 -&gt; 选择系统install centos 7 -&gt; 选择语言 -&gt; 设置时区(亚洲上海) -&gt; 软件选择安装环境 -&gt; 安装位置自定义分配分区/boot / -&gt; 关闭KDUMP -&gt; 打开网络、自定义主机名 -&gt; 关闭SECURITY -&gt; 开始安装 -&gt; 设置用户密码 -&gt; 重启</p> </li><li> <p>mobaxterm使用</p> 
  <ul><li>远程连接工具，连接虚拟机（xshell：免费版本 不能用于商业；finalshell）</li><li>ssh 远程连接协议 端口号：22</li><li>使用：session -&gt; ssh -&gt; 填ip 用户名root 端口号22 -&gt; ok -&gt; 输密码</li></ul> </li></ul> 
<h4><a id="_71"></a>基本操作</h4> 
<ul><li> <p>shell介绍</p> <p>用户登录到系统就会被分配一个shell。shell是命令解释器，是人与计算机交互的接口。CentOS系统默认的shell是bash</p> 
  <ul><li> <p>打开终端</p> 
    <ul><li> <p>远程连接创建会话</p> </li><li> <p>桌面版</p> 
      <ul><li>右键打开终端</li><li>活动终端上ctrl+shift+t</li><li>alt+F2输入gnome-terminal</li><li>系统右键在终端打开</li></ul> </li><li> <p>退出</p> 
      <ul><li>exit命令/鼠标关闭</li></ul> </li></ul> </li></ul> </li><li> <p>bash提示符</p> 
  <ul><li> <p>[root@nginx ~]#</p> 
    <ul><li>root - 当前所登陆的用户名，在Linux系统中，root用户为超管理员</li><li>@- 同 at</li><li>nginx - 所登陆主机的主机名</li><li>～- 当前所在的目录。~ 表示用户的家目录，是用户登录到系统后的默认位置</li><li> <h2><a id="______99"></a>- 身份提示符 #：超级管理员； $：普通用户</h2> </li></ul> </li></ul> </li><li> <p>常用快捷键</p> 
  <ul><li>清屏：ctrl+l / clear</li><li>命令执行：ctrl+c–中断 ； ctrl+z–挂起</li><li>调用上一条命令的最后一个参数：alt+. / esc+. / !$</li><li>移动光标：ctrl+a / Home–移到行首；ctrl+e / End–移到行尾</li><li>删除字符：ctrl+u–删除光标(不包含)前所有字符；ctrl+k–删除光标(包含)后所有字符</li><li>Tab：命令或文件名自动补全</li></ul> </li></ul> 
<h4><a id="_110"></a>基本命令</h4> 
<ul><li> <p>命令格式</p> 
  <ul><li> <p>命令名 [选项]… [参数]…</p> 
    <ul><li>命令名：一般由多个小写字母组成，大小写敏感</li><li>选项：一般用于修饰命令，改变命令的执行效果</li><li>参数：指命令的作用对象</li></ul> </li><li> <p>选项的格式</p> 
    <ul><li>以-开头的，后面一般跟一个字母或数字，多数情况下多个选项可以合并</li><li>以–开头的，后面一般跟单词，不能合并</li><li>没有-或–，直接是小写字母，多个选项可以合并(较少)</li></ul> </li></ul> </li><li> <p>基本命令</p> 
  <ul><li> <p>关机</p> 
    <ul><li>init 0 / shutdown -h now / shutdown -h 10</li><li>shutdown -c 取消</li></ul> </li><li> <p>重启</p> 
    <ul><li>init 6 / shutdown -r now / shutdown -r 10 / reboot</li></ul> </li><li> <p>nit 5 从最小化切换到图形化；init 3 从图形化切换成最小化</p> </li><li> <p>history：查看执行过的历史命令</p> </li><li> <p>who：查看当前所登录用户</p> 
    <ul><li> <p>tty</p> 
      <ul><li>本机登录用户</li></ul> </li><li> <p>pts</p> 
      <ul><li>远程登录用户</li></ul> </li></ul> </li><li> <p>ip a 查看IP</p> </li><li> <p>which 文件 ：查看文件绝对路径</p> </li><li> <p>pwd：查看当前所在目录的绝对路径</p> </li><li> <p>echo 打印</p> </li></ul> </li><li> <p>帮助信息</p> 
  <ul><li> <p>help</p> 
    <ul><li>用法：命令 --help</li><li>[ ]表示可选项；{ } 表示必选项；|表示或者；…表示多个；&lt;&gt; 有些命令中是必选，但是有些命令中是可选</li></ul> </li><li> <p>man</p> 
    <ul><li> <p>用法：man 命令</p> </li><li> <p>分类：1.一般命令；2.系统调用库；3.c标准库；4.设备文件；5.配置文件；6.游戏相关；7.杂项；8.系统管理相关命令；9.内核(rhel5)。重点158</p> </li><li> <p>man -f passwd #查看命令在第几类</p> </li><li> <p>man手册快捷键</p> <p>空格翻页、回车翻行、g定位到手册顶部、G定位到手册底部、/关键字 查找关键字、n 按关键字往下翻、N 按关键字往上翻、q 退出</p> </li></ul> </li></ul> </li><li> <p>特殊符号</p> 
  <ul><li>|：管道符，把前面命令执行结果交给后面命令执行 cat passwd |grep root</li><li> 
    <blockquote> 
     <blockquote> 
      <p>追加 &gt;覆盖 eg：echo “zhangqingsheng” &gt;&gt; /opt/passwd</p> 
     </blockquote> 
    </blockquote> </li><li>$()：把（）里面的命令执行结果交给外面的命令去执行。等同于<code> </code></li><li>&amp;&amp;连接两条命令，前面执行成功后才会继续执行后面；&amp; 表示任务后台执行</li><li>. ：当前目录；… ：上一级目录；~ ：家目录</li><li>#：超级管理员； $：普通用户</li></ul> </li></ul> 
<h3><a id="_179"></a>软件安装</h3> 
<h4><a id="_181"></a>介绍</h4> 
<ul><li> <p>软件管理方式</p> 
  <ul><li> <p>dpkg</p> 
    <ul><li>包类型：.deb</li><li>命令：apt-get，dpkg</li><li>代表发行版：Ubuntu，Debian，MInt</li></ul> </li><li> <p>rpm</p> 
    <ul><li>包类型：.rpm</li><li>命令：rpm，yum</li><li>代表发行版：Redhat，Centos，Fedora</li></ul> </li></ul> </li><li> <p>CentOS系统软件安装方式</p> 
  <ul><li>rpm: 安装简单,可定制性差,一台机器上不能装多个相同的软件,稳定性高</li><li>源码包: 编译安装,安装复杂,可定制性好,一台机器上可安装多个相同的软件</li><li>二进制包: 安装简单,可定制性差,一台机器可安装多个相同的软件,稳定性较高</li></ul> </li><li> <p>获取rpm包</p> 
  <ul><li>http://rpmfind.net/</li><li>网络yum源中获取 #epel,CentOS</li><li>镜像中获取: 在光盘镜像中的Packages目录下</li><li>相应软件官网，红帽官方ftp: //ftp.redhat.com</li></ul> </li><li> <p>rpm包介绍</p> 
  <ul><li>zsh-5.0.2-25.el7.x86_64.rpm 包全名<br> zsh: 软件名<br> 5.0.2: 主版本号.次版本号.源程序的发行号<br> 25: rpm发行号<br> el7: 平台 一般来说,不同平台的包不兼容<br> x86_64: 架构<br> x86_64: 64位<br> i686: 32位<br> noarch: 通用</li></ul> </li></ul> 
<h4><a id="rpm_222"></a>rpm包管理</h4> 
<ul><li> <p>rpm工具</p> 
  <ul><li> <p>安装</p> 
    <ul><li> <p>-i：install安装</p> 
      <ul><li>rpm -ivh 包全名 #安装软件包</li></ul> </li><li> <p>-U：upgrade升级</p> 
      <ul><li>rpm -Uvh 包全名 #升级软件包,如果本来没有安装,则安装</li></ul> </li><li> <p>-vh：显示安装过程</p> </li><li> <p>–force 强制安装</p> </li></ul> </li><li> <p>卸载</p> 
    <ul><li> <p>-e：erase擦除</p> 
      <ul><li>rpm -e 软件名</li></ul> </li><li> <p>–nodeps 只卸载当前软件,不检查依赖关系</p> </li></ul> </li><li> <p>查询</p> 
    <ul><li> <p>-q：query查询</p> 
      <ul><li>rpm -q 软件名 #查询指定软件包有没有安装</li></ul> </li><li> <p>-a：all全部</p> 
      <ul><li>rpm -qa #查询所有已安装的软件包</li></ul> </li><li> <p>-l：list列出包中文件</p> 
      <ul><li>rpm -ql 软件名 #查询已安装的软件包安装的所有文件</li></ul> </li><li> <p>-f：file文件</p> 
      <ul><li>rpm -qf 文件的绝对路径 #通过文件名反查文件是由哪个包安装的</li></ul> </li><li> <p>-c：configfiles配置文件</p> 
      <ul><li>rpm -qc 软件名 #查询已安装的软件包安装的配置文件</li></ul> </li><li> <p>-i：info信息</p> 
      <ul><li>rpm -qi 软件名 #查询已安装的软件包详细信息</li></ul> </li><li> <p>-p：pachage软件包</p> 
      <ul><li>rpm -qpl 包全名 #查询未安装的软件包将会安装的所有文件</li><li>rpm -qpc 包全名 #查询未安装的软件包将会安装的配置文件</li></ul> </li></ul> </li><li> <p>注意</p> 
    <ul><li> <p>包全名可使用下载链接代替</p> </li><li> <p>rpm包无法自动解决依赖性问题,需要手动解决</p> 
      <ul><li>解决依赖关系：执行安装命令–yum provides 查询报错信息中所需要的软件对应安装包名称–逐个使用rpm安装</li></ul> </li></ul> </li></ul> </li><li> <p>yum工具</p> 
  <ul><li> <p>yum仓库</p> 
    <ul><li> <p>存放rpm包：Packages</p> 
      <ul><li>cachedir=/var/cache/yum/<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
            
             
              
              
                b 
               
              
                a 
               
              
                s 
               
              
                e 
               
              
                a 
               
              
                r 
               
              
                c 
               
              
                h 
               
              
                / 
               
              
             
               basearch/ 
              
             
           </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">ba</span><span class="mord mathnormal">se</span><span class="mord mathnormal">a</span><span class="mord mathnormal">rc</span><span class="mord mathnormal">h</span><span class="mord">/</span></span></span></span></span>releasever</li></ul> </li><li> <p>记录rpm包之间的依赖关系：repodata</p> </li><li> <p>createrepo：创建repodata</p> </li><li> <p>yum配置文件：/etc/yum.conf</p> </li><li> <p>仓库配置文件：/etc/yum.repos.d/目录下以.repo结尾</p> 
      <ul><li>CentOS-Base.repo-主仓库</li><li>epel.repo-扩展仓库</li></ul> </li><li> <p>仓库类型</p> 
      <ul><li> <p>本地源</p> </li><li> <p>网络源</p> 
        <ul><li> <p>阿里</p> 
          <ul><li>https://developer.aliyun.com/mirror/</li></ul> </li><li> <p>网易</p> 
          <ul><li>http://mirrors.163.com/</li></ul> </li><li> <p>清华</p> 
          <ul><li>https://mirrors.tuna.tsinghua.edu.cn/</li></ul> </li><li> <p>中科大</p> 
          <ul><li>https://mirrors.ustc.edu.cn/</li></ul> </li><li> <p>搜狐</p> 
          <ul><li>http://mirrors.sohu.com/</li></ul> </li><li> <p>北京外国语</p> 
          <ul><li>https://mirrors.bfsu.edu.cn/</li></ul> </li></ul> </li></ul> </li><li> <p>获取方式</p> 
      <ul><li>直接下载仓库repo文件</li><li>自己创建编辑.repo文件</li><li>下载安装对应的rpm仓库包</li></ul> </li></ul> </li><li> <p>yum源</p> 
    <ul><li> <p>自制本地yum源</p> 
      <ul><li> <p>镜像包</p> 
        <ul><li> <p>1.将镜像挂载到/mnt(默认挂载目录，只读方式)<br> mount CentOS-7-x86_64-Minimal-1708.iso /mnt</p> </li><li> <p>2.创建仓库配置文件<br> vim /etc/yum.repos.d/myyum.repo</p> 
          <ul><li>[my yum] #仓库ID<br> name=xingdian yum #仓库名称(描述)<br> baseurl=file:///mnt #仓库的地址<br> gpgcheck=0 #校验开关<br> enabled=1 #仓库开关</li></ul> </li><li> <p>3.检验：yum repolist（可用数量不为0）</p> </li></ul> </li><li> <p>缓存包</p> 
        <ul><li> <p>1.在服务器上创建目录用来存放rpm包<br> mkdir /packages</p> </li><li> <p>2.打开缓存开关(后续安装的rpm包会保存到缓存目录中)<br> vim /etc/yum.conf -&gt;keepcache=1</p> </li><li> <p>3.将缓存目录中的rpm包拷贝到/packages<br> cp /var/cache/yum/x86_64/7/base/packages/*.rpm /packages/</p> </li><li> <p>4.创建依赖关系：createrepo /packages/</p> </li><li> <p>5.创建仓库配置文件<br> vim /etc/yum.repos.d/myyum.repo</p> 
          <ul><li>[my yum] #仓库ID<br> name=xingdian yum #仓库名称(描述)<br> baseurl=file:///pachages #仓库的地址<br> gpgcheck=0 #校验开关<br> enabled=1 #仓库开关</li></ul> </li><li> <p>6.检验：yum repolist</p> </li></ul> </li></ul> </li><li> <p>网络源</p> 
      <ul><li> <p>删除原有仓库（系统默认国外官方源，下载速度慢）<br> rm -rfv /etc/yum.repos.d/*</p> </li><li> <p>访问国内镜像站</p> </li><li> <p>直接下载</p> 
        <ul><li>base仓库：<br> curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo<br> 或curl -o /etc/yum.repos.d/CentOS-Base.repo https://repo.huaweicloud.com/repository/conf/CentOS-7-reg.repo</li><li>epel仓库：<br> curl -o /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</li></ul> </li><li> <p>自己配置</p> 
        <ul><li> <p>vim /etc/yum.repos.d/base-ali.repo</p> 
          <ul><li>[base]<br> name=base-ali<br> baseurl=https://mirrors.aliyun.com/centos/7/os/x86_64/<br> gpgcheck=1<br> gpgkey=https://mirrors.aliyun.com/centos/7/os/x86_64/RPM-GPG-KEY-CentOS-7<br> enabled=1</li></ul> </li><li> <p>vim /etc/yum.repos.d/epel-ali.repo</p> 
          <ul><li>[epel]<br> name=epel-ali<br> baseurl=https://mirrors.aliyun.com/epel/7/x86_64/<br> gpgcheck=1<br> gpgkey=https://mirrors.aliyun.com/epel/RPM-GPG-KEY-EPEL-7<br> enabled=1</li></ul> </li></ul> </li><li> <p>检验：yum repolist</p> </li></ul> </li></ul> </li><li> <p>yum命令</p> 
    <ul><li> <p>缓存</p> 
      <ul><li>yum makecache fast #创建yum缓存</li><li>yum clean all #清空yum缓存</li></ul> </li><li> <p>rpm包</p> 
      <ul><li> <p>查询</p> 
        <ul><li> <p>yum list #列出所有软件包（最后一列@表示已安装）</p> 
          <ul><li>yum list xxx #查询具体软件包</li><li>yum list installed #查询已安装的软件包</li></ul> </li><li> <p>yum repolist #查看可用的仓库（id前带!表示已失效，需重建缓存）</p> </li><li> <p>yum info httpd #查询安装包详细信息</p> </li><li> <p>查询文件是由什么包安装的</p> 
          <ul><li>yum provides passwd</li><li>yum provides /usr/bin/passwd</li><li>yum provides */passwd</li></ul> </li><li> <p>yum search 关键字 #搜索名称或描述中含关键字的包</p> </li></ul> </li><li> <p>安装</p> 
        <ul><li> <p>yum install xxx xxx… #安装软件包</p> 
          <ul><li>-y #确认安装（不交互）</li><li>–downloadonly #仅下载不安装，默认到缓存目录</li><li>–downloaddir=DIR #指定下载的目录</li></ul> </li><li> <p>yum -y install /root/xxx.rpm #从本地安装</p> </li><li> <p>yum -y install 包链接 #从网页安装</p> </li><li> <p>yum -y reinstall xxx #重新安装（某个配置文件损坏，删除后重装）</p> </li></ul> </li><li> <p>升级</p> 
        <ul><li>yum -y update httpd #更新httpd</li><li>yum -y update #更新系统中全部</li></ul> </li><li> <p>卸载</p> 
        <ul><li>yum remove/erase httpd #会卸载本软件及所有依赖本软件的软件</li></ul> </li></ul> </li><li> <p>组包</p> 
      <ul><li>yum group list #列出组包信息</li><li>yum groupinfo mariadb #查组包详细信息</li><li>yum -y groupinstall mariadb #安装组包</li><li>groupremove 卸载组包</li></ul> </li></ul> </li></ul> </li></ul> 
<h4><a id="_464"></a>装机必备</h4> 
<ul><li> <p>文本编辑</p> 
  <ul><li> <p>vim</p> 
    <ul><li> <p>vim /etc/vimrc</p> 
      <ul><li> <p>mouse</p> 
        <ul><li> <p>添加set mouse=ni #打开鼠标</p> </li><li> <p>生效模式</p> 
          <ul><li>n 普通模式</li><li>v 可视模式</li><li>i 插入模式</li><li>c 命令行模式</li><li>a 以上所有的模式</li></ul> </li></ul> </li><li> <p>tab缩进</p> 
        <ul><li>添加set ts=4 #缩进4个字符，默认8个</li></ul> </li><li> <p>粘贴模式</p> 
        <ul><li> <p>set paste</p> 
          <ul><li>粘贴不会改变格式</li></ul> </li></ul> </li></ul> </li></ul> </li></ul> </li><li> <p>文件传输</p> 
  <ul><li> <p>lrzsz（xshell）</p> 
    <ul><li> <p>rz</p> 
      <ul><li>receive，从Windows传到Linux</li></ul> </li><li> <p>sz 文件名</p> 
      <ul><li>send，从Linux传到Windows</li></ul> </li></ul> </li></ul> </li><li> <p>网络工具</p> 
  <ul><li>net-tools</li></ul> </li><li> <p>命令补全工具</p> 
  <ul><li>bash-completion</li></ul> </li></ul> 
<h3><a id="_513"></a>开机启动</h3> 
<h4><a id="_515"></a>启动流程</h4> 
<ul><li> <p>引导阶段</p> 
  <ul><li> <p>目的</p> 
    <ul><li>引导内核装载到内存中运行起来</li></ul> </li><li> <p>引导过程</p> 
    <ul><li>POST - BIOS - MBR(BOOTLOADER) - 装载位于MBR和第一个分区中间的通用文件系统驱动 - 挂载第一个分区（/boot）- 读取grub文件（内核文件的名称及启动参数）- 找到并运行内核 - 挂载临时文件系统initramfs(驱动rootfs) - 挂载rootfs</li></ul> </li><li> <p>步骤</p> 
    <ul><li> <p>POST：硬件自检，选择驱动器</p> 
      <ul><li>打开电源</li><li>初始化硬件设备，检查系统外围主要设备（CPU，内存，硬盘等）</li><li>根据BIOS设置的启动顺寻，检测驱动器（硬盘，光盘，U盘，网络）</li><li>如果硬盘是启动项，读取硬盘第一个扇区（MBR）到内存</li></ul> </li><li> <p>Bootloader：引导装载内核</p> 
      <ul><li> <p>Stage1</p> 
        <ul><li>加载MBR中的引导记录bootloader，定位并加载阶段 1.5 的代码</li></ul> </li><li> <p>Stage1.5</p> 
        <ul><li>识别stage2所在的分区（/boot）上的文件系统</li></ul> </li><li> <p>Stage2</p> 
        <ul><li> <p>EL6</p> 
          <ul><li>解析grub配置文件/boot/grub/grub.conf</li></ul> </li><li> <p>EL7</p> 
          <ul><li>解析grub2配置文件/boot/grub2/grub.cfg</li></ul> </li><li> <p>定位并加载Linux内核到内存中，并转移控制权到内核</p> </li></ul> </li></ul> </li><li> <p>KERNEL + INITRD—&gt;ROOTFS 内核引导</p> 
      <ul><li>通过内存中的虚拟根文件系统，加载驱动，然后切换到真正的根文件系统，并执行/sbin/init程序</li><li>initrd是一个临时的根文件系统rootfs，在安装系统时产生，装载了必要的驱动模块。在stage2被拷贝到了内存中</li><li>kernel内核为了精简只保留了基本模块，没有硬件驱动程序，无法识别rootfs所在的设备</li><li>kernel启动时，可以从initrd文件中装载驱动模块，直到挂载真正的rootfs，然后将initrd从内存中移除</li></ul> </li><li> <p>运行第一个用户进程</p> 
      <ul><li>EL6：init</li><li>EL7：systemd</li></ul> </li></ul> </li></ul> </li><li> <p>启动阶段</p> 
  <ul><li> <p>EL6</p> 
    <ul><li>/etc/inittab 确定运行级别</li><li>/etc/rc.d/rc.sysinit 系统初始化</li><li>/etc/rc#.d/S* 启动开机启动的服务</li><li>/etc/rc.d/rc.local 执行用户自定义脚本</li><li>/bin/login 用户登录</li></ul> </li><li> <p>EL7</p> 
    <ul><li>1.执行initrd.target 包括挂载/etc/fstab文件中的系统,挂载后,切换到根目录(chroot)</li><li>2.执行默认target配置（运行级别）</li><li>3.执行sysinit.target</li><li>4.启动multi-user.target下的本机与服务器服务</li><li>5.执行multi-user.target下的/etc/rc.d/rc.local</li><li>6.执行multi-user.target下的getty.target及登录服务</li><li>7.执行graphical需要的服务(如果默认target是图形的话)</li></ul> </li></ul> </li><li> <p>注释</p> 
  <ul><li> <p>内核</p> 
    <ul><li>是一个操作系统的核心</li><li>负责管理系统的进程、内存、设备驱动程序、文件和网络系统，决定着系统的性能和稳定性</li><li>指的是一个提供硬件抽象层、磁盘及文件系统控制、多任务等功能的系统软件</li><li>一个内核不是一套完整的操作系统</li></ul> </li><li> <p>运行级别</p> 
    <ul><li> <p>0 -关机</p> 
      <ul><li>init 0</li></ul> </li><li> <p>1 -单用户模式（只有root用户，不需要输入密码）</p> 
      <ul><li>init 1</li></ul> </li><li> <p>2 -无网络的多用户模式</p> 
      <ul><li>init 2</li></ul> </li><li> <p>3 -多用户模式（正常的文本模式），使用最多的模式</p> 
      <ul><li>init 3</li></ul> </li><li> <p>4 -保留（未使用）</p> 
      <ul><li>init 4</li></ul> </li><li> <p>5 -桌面模式</p> 
      <ul><li>init 5</li></ul> </li><li> <p>6 -重启</p> 
      <ul><li>init 6</li></ul> </li></ul> </li></ul> </li></ul> 
<h4><a id="root_629"></a>破解root密码</h4> 
<ul><li> <p>EL6</p> 
  <ul><li>启动系统，倒计时的时候按任意键，进入内核选择界面</li><li>按"a"</li><li>在quiet后面加上空格 1 回车</li><li>直接passwd修改</li></ul> </li><li> <p>EL7</p> 
  <ul><li> <p>方法一</p> 
    <ul><li> <p>启动系统，倒计时时按"e"进入编辑模式</p> </li><li> <p>将光标定位到linux16这一行,在行尾添加:init=/bin/sh，然后按ctrl+x</p> </li><li> <p>以读写方式重挂根：mount -o remount,rw /</p> </li><li> <p>passwd修改密码</p> </li><li> <p>如果开启了selinux，执行touch /.autorelabel（没有则跳过）</p> </li><li> <p>exec /sbin/init</p> 
      <ul><li>执行/sbin/init</li></ul> </li></ul> </li><li> <p>方法二</p> 
    <ul><li>启动系统，倒计时时按"e"进入编辑模式</li><li>修改内核参数：linux16这一行，ro改成rw，行尾加上 init=/bin/sh selinux=0</li><li>ctrl+x启动</li><li>修改密码</li><li>执行 exec /sbin/init</li></ul> </li></ul> </li></ul> 
<h4><a id="_659"></a>救援模式</h4> 
<ul><li> <p>打开救援模式界面</p> 
  <ul><li> <p>物理服务器</p> 
    <ul><li>ctrl+alt+del</li></ul> </li><li> <p>虚拟机</p> 
    <ul><li>启动时按 c ，输入exit</li></ul> </li></ul> </li><li> <p>进入</p> 
  <ul><li>选择Troubleshooting进入</li><li>选择Rescue a CentOS system进入</li><li>输入 1 回车</li><li>回车</li></ul> </li><li> <p>执行操作（真正的根挂载在 /mnt/sysimage 目录）</p> </li></ul> 
<h3><a id="_680"></a>进程管理</h3> 
<h4><a id="_682"></a>进程介绍</h4> 
<ul><li> <p>相关定义</p> 
  <ul><li>程序：完成某些功能的代码的集合。磁盘上的文件</li><li>进程：程序运行之后，在内存中的状态，运行的程序会产生一个或多个进程。内存中</li><li>线程：进程内独立运行的一个单元（操作系统的调度单元，进程至少包括一个线程）</li><li>父进程：程序运行时产生的第一个进程</li><li>子进程：由父进程创建出来的新进程（继承）</li></ul> </li><li> <p>产生进程</p> 
  <ul><li>执行程序或命令</li><li>计划任务</li></ul> </li><li> <p>生命周期</p> 
  <ul><li> <p>就绪</p> 
    <ul><li> <p>当进程运行所需要的资源及环境加载完成后,即进入就绪状态,等待CPU执行</p> </li><li> <p>就绪-&gt;运行</p> 
      <ul><li>当就绪的进程占用CPU，并在CPU上运行时,进入运行状态</li></ul> </li></ul> </li><li> <p>运行</p> 
    <ul><li> <p>运行-&gt;就绪</p> 
      <ul><li>CPU时间片运行完而进程尚未执行完成</li><li>有更高优先级的进程要运行时被迫让出CPU</li><li>因中断被迫让出CPU</li></ul> </li><li> <p>运行-&gt;阻塞</p> 
      <ul><li>正在执行的进程因发生某等待事件而无法执行，则进程由执行状态变为阻塞状态，如发生了I/O请求</li></ul> </li><li> <p>运行-&gt;结束</p> </li></ul> </li><li> <p>阻塞</p> 
    <ul><li> <p>阻塞-&gt;就绪</p> 
      <ul><li>进程所等待的事件已经完成，进入就绪队列</li></ul> </li></ul> </li></ul> </li><li> <p>进程状态</p> 
  <ul><li> <p>常见</p> 
    <ul><li> <p>R</p> 
      <ul><li>该进程正在运行或就绪</li></ul> </li><li> <p>S</p> 
      <ul><li>休眠进程</li></ul> </li><li> <p>s</p> 
      <ul><li>父进程</li></ul> </li><li> <p>l</p> 
      <ul><li>以线程的方式运行</li></ul> </li><li> <p>&lt;</p> 
      <ul><li>较高优先级</li></ul> </li></ul> </li><li> <p>其他</p> 
    <ul><li> <p>Z</p> 
      <ul><li>僵尸进程，实际上该进程已经终止，但是它的父进程却无法正常终止它，造成僵尸进程的状态</li></ul> </li><li> <p>T</p> 
      <ul><li>该进程正在跟踪或者已经停止</li></ul> </li><li> <p>X</p> 
      <ul><li>死亡进程</li></ul> </li><li> 
      <ul><li></ul> 
      <ul><li>在前台运行的进程组</li></ul> </li><li> <p>N</p> 
      <ul><li>较低优先级</li></ul> </li><li> <p>D</p> 
      <ul><li>不可中断的睡眠状态</li></ul> </li></ul> </li><li> <p>说明</p> 
    <ul><li>每个CPU在一个时间点只能处理一个进程</li></ul> </li></ul> </li><li> <p>进程文件</p> 
  <ul><li>/proc/pid #以pid命名</li></ul> </li></ul> 
<h4><a id="_784"></a>查看</h4> 
<p>进程</p> 
<ul><li> <p>静态<br> 查看</p> 
  <ul><li> <p>ps</p> 
    <ul><li> <p>用法</p> 
      <ul><li> <p>ps -ef</p> </li><li> <p>ps aux</p> 
        <ul><li> <p>排序</p> 
          <ul><li>ps aux --sort %cpu 按cpu从小到大排序</li><li>ps aux --sort -%cpu 按cpu从大到小排序</li></ul> </li></ul> </li><li> <p>ps -axo</p> 
        <ul><li>ps axo user,pid,ppid,%cpu,%mem,command</li></ul> </li></ul> </li><li> <p>选项</p> 
      <ul><li>-e：显示所有进程</li><li>-f：全格式显示</li><li>a：显示所有进程(包含其他用户的进程)</li><li>u：显示进程的拥有者</li><li>x：和a一起使用，显示所有进程(包含无控制终端的进程-TTY为?的进程)</li><li>o：指定显示字段</li></ul> </li><li> <p>字段</p> 
      <ul><li> <p>USER PID PPID %CPU %MEM VSZ RSS<br> 用户 进程ID 父进程ID CPU占用率 内存占用率 占用虚拟内存 占用实际内存</p> </li><li> <p>TTY STAT START TIME COMMAND<br> 运行的终端 状态 启动时间 占用CPU总时间 进程名称(命令)</p> </li><li> <p>TTY</p> 
        <ul><li>tty 查看当前终端</li><li>pts：伪终端、虚拟终端</li><li>tty1–tty6： 字符终端</li></ul> </li></ul> </li></ul> </li><li> <p>pstree</p> 
    <ul><li>yum -y install psmisc</li><li>以树形显示正在运行的进程</li><li>-p 打印pid</li></ul> </li></ul> </li><li> <p>查看PID</p> 
  <ul><li> <p>cat /run/sshd.pid(/run下的.pid文件-默认的服务)</p> </li><li> <p>ps aux |grep sshd</p> </li><li> <p>pstree -p |grep sshd</p> </li><li> <p>pgrep sshd</p> 
    <ul><li>-l 显示进程名称</li></ul> </li><li> <p>pidof sshd</p> </li><li> <p>lsof</p> 
    <ul><li> <p>lsof -i:22(端口号)</p> 
      <ul><li>查看端口对应服务的pid</li></ul> </li><li> <p>lsof -p pid</p> 
      <ul><li>查看进程打开的文件</li></ul> </li><li> <p>利用进程打开的文件找回误删除文件</p> 
      <ul><li>lsof |grep /var/log/messages</li><li>cat /proc/657/fd/6 &gt; /var/log/messages;systemctl restart rsyslog</li></ul> </li></ul> </li><li> <p>$$：当前shell的pid</p> </li></ul> </li><li> <p>动态查看</p> 
  <ul><li> <p>top</p> 
    <ul><li> <p>top选项</p> 
      <ul><li>top -d 1 #刷新频率1秒</li><li>top -u user #查看指定用户的进程</li><li>top -p pid1,pid2 #查看指定pid进程</li><li>top -n 1 #刷新1次后退出</li><li>top -b -n 2 &gt; top.txt#打印2次结果到top.txt中-b全局</li></ul> </li><li> <p>top内容</p> 
      <ul><li> <p>统计信息区</p> 
        <ul><li>top - 05:44:00 up 10 min, 1 user, load average: 0.27, 1.14, 1.00<br> 当前系统时间 系统运行时间 , 当前登录用户数, 系统平均负载: 1分钟,5分钟,15分钟</li><li>Tasks: 155 total, 2 running, 153 sleeping, 0 stopped, 0 zombie<br> 任务(进程): 总数, 正在运行的, 休眠的, 停止的, 僵尸</li><li>%Cpu(s): 7.0 us , 1.3 sy , 0.0 ni , 91.6 id , 0.0 wa , 0.0 hi , 0.0 si , 0.0 st<br> cpu状态(%): 用户空间, 内核空间, 改变过优先级的, 空闲的, IO等待的, 硬中断, 软中断, 虚拟机</li><li>KiB Mem : 4030144 total, 140068 free, 2078828 used, 1811248 buff/cache<br> 内存状态(K): 总量, 空闲的, 使用中的, 缓存的</li><li>KiB Swap: 2097148 total, 2097148 free, 0 used. 1560872 avail Mem<br> swap状态(K): 总量, 空闲的, 使用中的, 缓冲的</li></ul> </li><li> <p>进程信息区</p> 
        <ul><li>PR：进程优先级</li><li>NI：nice值。负值表示高优先级，正值表示低优先级</li><li>VIRT：进程使用的虚拟内存总量，单位kb。VIRT=SWAP+RES</li><li>RES：进程使用的、未被换出的物理内存大小，单位kb。RES=CODE+DATA</li><li>SHR：共享内存大小，单位kb</li></ul> </li></ul> </li><li> <p>top操作</p> 
      <ul><li> <p>h/? 帮助</p> </li><li> <p>1 展开cpu信息（多核）</p> </li><li> <p>f 更改显示内容</p> 
        <ul><li>空格选择</li><li>w保存</li><li>esc退出</li></ul> </li><li> <p>M 按mem排序</p> </li><li> <p>P 按cpu排序</p> </li><li> <p>N 按PID排序</p> </li><li> <p>R 将排序反转</p> </li><li> <p>K 杀死，默认占用最高的</p> </li><li> <p>q 退出</p> </li></ul> </li></ul> </li><li> <p>htop</p> 
    <ul><li>yum -y install htop</li><li>F3进程搜索、F4进程过滤、F6排序、F9杀掉指定进程</li></ul> </li><li> <p>watch</p> 
    <ul><li> <p>用法</p> 
      <ul><li> <p>watch [选项] ‘命令’</p> 
        <ul><li>watch -n1 ‘ps aux’</li></ul> </li><li> <p>每多少秒(默认为2秒)执行一次后面的命令</p> </li><li> <p>ctrl c 退出</p> </li></ul> </li><li> <p>选项</p> 
      <ul><li>-n 指定命令执行间隔时间(秒)</li></ul> </li></ul> </li></ul> </li><li> <p>网络进程</p> 
  <ul><li> <p>ss -anutpl</p> 
    <ul><li>-a所有进程</li><li>-n 以数字的形式显示地址</li><li>-u udp进程</li><li>-t tcp进程</li><li>-p显示pid和名称</li><li>-l 显示监听状态的进程</li></ul> </li><li> <p>netstat -anutpl</p> 
    <ul><li>选项与ss一致</li></ul> </li></ul> </li></ul> 
<h4><a id="_947"></a>进程控制</h4> 
<ul><li> <p>前后台调度</p> 
  <ul><li> <p>前台运行</p> 
    <ul><li>该程序一直占用终端，其他命令不能够再在这个终端运行</li></ul> </li><li> <p>后台运行</p> 
    <ul><li>不会占用执行命令的终端，用户仍然可以使用这个终端做操作</li></ul> </li><li> <p>调度</p> 
    <ul><li> <p>&amp;</p> 
      <ul><li>命令后面接 &amp; 表示放到后台运行（从后台启动），如：sh test.sh &amp;</li></ul> </li><li> <p>ctrl +z</p> 
      <ul><li>将已经运行的命令放置于后台并停止</li></ul> </li><li> <p>jobs</p> 
      <ul><li>查看后台进程运行状态</li></ul> </li><li> <p>bg n</p> 
      <ul><li>激活后台进程，n为进程工作号</li></ul> </li><li> <p>fg n</p> 
      <ul><li>将后台运行的命令变成前台运行（仅针对R进程）</li></ul> </li></ul> </li><li> <p>终端进程</p> 
    <ul><li> <p>无论前后台运行，终端关闭即终止。父进程结束子进程也终止</p> </li><li> <p>脱离终端</p> 
      <ul><li>nohup sh /test.sh &amp;</li><li>当其父进程结束后，该进程将被systemd接管，将不受终端影响</li></ul> </li></ul> </li></ul> </li><li> <p>终止进程</p> 
  <ul><li> <p>方法</p> 
    <ul><li> 
      <ol><li>前台正在执行的命令: ctrl+c</li></ol> </li><li> 
      <ol start="2"><li>kill,pkill,killall等命令</li></ol> </li></ul> </li><li> <p>kill</p> 
    <ul><li> <p>用法</p> 
      <ul><li>kill -信号 pid</li><li>kill -1 PID 或者kill -HUP PID</li></ul> </li><li> <p>信号</p> 
      <ul><li> <p>kill -l #查看信号的列表</p> </li><li> <p>1 HUP</p> 
        <ul><li>重置进程的配置，即不停止服务的情况下，重新读取配置文件</li></ul> </li><li> <p>2 INT</p> 
        <ul><li>中断(interrupt)，ctrl+c</li></ul> </li><li> <p>3 QUIT</p> 
        <ul><li>退出quit</li></ul> </li><li> <p>9 KILL</p> 
        <ul><li>强制杀死进程（不保存数据，非必要不要使用）</li></ul> </li><li> <p>10 USR1</p> 
        <ul><li>重新打开log日志文件</li></ul> </li><li> <p>15 TERM</p> 
        <ul><li>正常终止进程，此信号为kill默认（推荐使用）</li></ul> </li><li> <p>18 CONT</p> 
        <ul><li>继续，bg</li></ul> </li><li> <p>19 STOP</p> 
        <ul><li>挂起，ctrl+z</li></ul> </li></ul> </li></ul> </li><li> <p>pkill</p> 
    <ul><li>按照进程的属性结束进程</li><li>pkill test.sh #按照进程名关键字杀死进程</li><li>pkill -U 用户名 #杀死指定用户的进程</li><li>pkill -9 -t 终端名称 #杀死指定终端（不加-9只杀进程）</li></ul> </li><li> <p>killall</p> 
    <ul><li>killall 进程名称 #杀死全部的同名进程</li></ul> </li></ul> </li><li> <p>谦让值nice</p> 
  <ul><li> <p>作用</p> 
    <ul><li>指定或者调整用户进程的nice值</li><li>nice值越高，优先级越低</li><li>范围：-20~19</li></ul> </li><li> <p>命令</p> 
    <ul><li> <p>运行时直接设置</p> 
      <ul><li>nice -n 数字 command</li></ul> </li><li> <p>已经运行的调整nice值</p> 
      <ul><li>renice 数字 PID</li></ul> </li></ul> </li></ul> </li></ul> 
<h3><a id="_1067"></a>日志管理</h3> 
<h4><a id="_1069"></a>日志介绍</h4> 
<ul><li> <p>定义</p> 
  <ul><li>将系统中发生的事情，按照发生时间的先后顺序，分门别类的记载到不同的文件中称为记录日志，其文件就是日志文件</li></ul> </li><li> <p>用途</p> 
  <ul><li>1）解决系统方面错误</li><li>2）解决应用的错误</li><li>3）记录重要的历史事件，便于数据统计汇总</li><li>4）解决安全方面的问题</li></ul> </li><li> <p>分类</p> 
  <ul><li> <p>系统日志</p> 
    <ul><li>/var/log/messages /var/log/secure</li></ul> </li><li> <p>应用日志</p> 
    <ul><li>ssh、http等服务都有相应的日志</li></ul> </li></ul> </li><li> <p>分析工具</p> 
  <ul><li>少量：vim cat tail grep awk</li><li>大量：splunk、elk</li></ul> </li></ul> 
<h4><a id="_1097"></a>系统日志</h4> 
<ul><li> <p>默认存放位置</p> 
  <ul><li>/var/log</li></ul> </li><li> <p>常见系统日志</p> 
  <ul><li> <p>/var/log/messages</p> 
    <ul><li>最重要的系统日志，几乎所有的系统信息都会记录在此</li></ul> </li><li> <p>/var/log/secure</p> 
    <ul><li>安全相关的日志(需要输入用户名密码的软件，比如ssh、su等)</li></ul> </li><li> <p>/var/log/dmesg</p> 
    <ul><li>内核检测过程中产生的各种信息，硬件检测信息</li></ul> </li><li> <p>/var/log/lastlog</p> 
    <ul><li>所有账户最近一次登录系统的相关信息, 使用 lastlog 命令查看</li></ul> </li><li> <p>/var/log/boot.log</p> 
    <ul><li>记录系统启动信息</li></ul> </li><li> <p>/var/log/wtmp</p> 
    <ul><li>记录的是正确登录的人的信息，可以用 last 命令来查看</li></ul> </li><li> <p>/var/log/btmp</p> 
    <ul><li>登录失败日志 可以使用 lastb 命令查看</li></ul> </li><li> <p>/var/log/cron</p> 
    <ul><li>计划任务相关的日志</li></ul> </li></ul> </li></ul> 
<h4><a id="_1137"></a>日志服务</h4> 
<ul><li> <p>服务名称</p> 
  <ul><li>rsyslog</li></ul> </li><li> <p>配置文件</p> 
  <ul><li>/etc/rsyslog.conf</li></ul> </li><li> <p>日志配置</p> 
  <ul><li> <p>配置格式</p> 
    <ul><li>服务名称+分隔符+日志级别 动作</li></ul> </li><li> <p>服务名称</p> 
    <ul><li> <p>authpriv(auth)</p> 
      <ul><li>用户授权相关的，认证等 ssh、login、su等</li></ul> </li><li> <p>cron</p> 
      <ul><li>和计划任务相关的服务</li></ul> </li><li> <p>mail</p> 
      <ul><li>和邮件相关的</li></ul> </li><li> <p>news</p> 
      <ul><li>新闻相关的 uucp</li></ul> </li><li> <p>kern</p> 
      <ul><li>和内核相关的</li></ul> </li><li> <p>lpr</p> 
      <ul><li>打印机相关的</li></ul> </li><li> <p>syslog</p> 
      <ul><li>和rsyslogd进程相关的</li></ul> </li><li> <p>local0~local7</p> 
      <ul><li>自定义服务名称，需要同步在对应服务配置文件中使用</li></ul> </li></ul> </li><li> <p>日志的级别</p> 
    <ul><li> <p>级别越低越详细，低级别包含其及以上级别的信息</p> </li><li> <p>debug</p> 
      <ul><li>调试信息</li></ul> </li><li> <p>info</p> 
      <ul><li>一般的通知信息</li></ul> </li><li> <p>notice</p> 
      <ul><li>提醒信息，比info稍微重要点</li></ul> </li><li> <p>warn/warning</p> 
      <ul><li>警告信息，可能有问题</li></ul> </li><li> <p>error</p> 
      <ul><li>错误信息</li></ul> </li><li> <p>critical/crit</p> 
      <ul><li>比较严重的错误</li></ul> </li><li> <p>alert</p> 
      <ul><li>警报信息，需要立即行动</li></ul> </li><li> <p>emerg/panic</p> 
      <ul><li>紧急(恐慌)，系统可能已经不可用了</li></ul> </li></ul> </li><li> <p>分隔符</p> 
    <ul><li> <p>.</p> 
      <ul><li>mail.warning 表示记录mail服务，warning及其以上级别的日志</li></ul> </li><li> <p>.=</p> 
      <ul><li>mail.=warning 表示记录mail服务warning级别日志</li></ul> </li><li> <p>.!</p> 
      <ul><li>mail.!warning 表示除了warning级别以外的，其他级别的所有日志都记录</li></ul> </li><li> <p>.none</p> 
      <ul><li>表示不记录</li></ul> </li></ul> </li><li> <p>动作</p> 
    <ul><li> <p>/file</p> 
      <ul><li>将日志同步记录到某文件</li></ul> </li><li> <p>-/file</p> 
      <ul><li>异步记录</li></ul> </li><li> 
      <ul><li></ul> 
      <ul><li>通知所有在线用户 ,也可以写具体的用户名</li></ul> </li><li> <p>@@remote_host:port</p> 
      <ul><li>通过TCP发送到远程服务器。一个@:UDP</li></ul> </li></ul> </li><li> <p>示例</p> 
    <ul><li> <p>*.info;mail.none;authpriv.none;cron.none /var/log/messages<br> 所有服务的info及以上级别；mail、authpriv、cron不记录 同步记录到/var/log/messages</p> </li><li> <p>authpriv.* /var/log/secure<br> 授权相关的所有级别 同步记录到/var/log/secure</p> </li><li> <p>自定义ssh日志</p> 
      <ul><li>1）vim /etc/ssh/sshd_config 将SyslogFacility值改为local2；</li><li>2）vim /etc/rsyslog.conf 添加local2.* /var/log/ssh.log</li><li>3）重启服务systemctl restart rsyslog sshd</li></ul> </li><li> <p>远程收集服务器日志</p> 
      <ul><li> <p>产生端</p> 
        <ul><li>关闭防火墙</li><li> <h2><a id="vim_etcrsyslogconf_1275"></a>vim /etc/rsyslog.conf</h2> </li></ul> </li></ul> </li></ul> </li></ul> </li></ul> 
<p><em>.</em> @收集端IP<br> - systemctl restart rsyslog</p> 
<pre><code>		- 收集端

			- 关闭防火墙
			- #vim /etc/rsyslog.conf（打开注释）
</code></pre> 
<p>$ModLoad imtcp<br> $UDPServerRun 514<br> - systemctl restart rsyslog</p> 
<pre><code>		- 查看：cat /var/log/messages
</code></pre> 
<h4><a id="logrotate_1289"></a>日志轮转logrotate</h4> 
<ul><li> <p>配置文件</p> 
  <ul><li>/etc/logrotate.conf</li><li>/etc/logrotate.d/*</li></ul> </li><li> <p>轮转规则</p> 
  <ul><li> <p>weekly 每周轮转</p> </li><li> <p>rotate 4 保留4份旧文件</p> </li><li> <p>create 轮转后创建新文件</p> </li><li> <p>dateext 用日期作为日志文件后缀</p> </li><li> <p>compress 通过gzip压缩转储以后的日志</p> </li><li> <p>minsize 1M 最小达到1M才轮转，未达到等下一个周期</p> </li><li> <p>create 0644 root root 轮转后创建指定属性文件</p> </li><li> <p>missingok 错过不轮转</p> </li><li> <p>notifempty 为空不轮转</p> </li><li> <p>特殊指定某个服务的轮转规则</p> 
    <ul><li>/var/log/btmp { … }</li></ul> </li></ul> </li><li> <p>轮转过程</p> 
  <ul><li>读取配置文件，判断是否需要轮转</li><li>如果需要，先将旧文件重命名</li><li>创建新日志文件</li><li>如果有配置postrotate/endscript，执行其脚本</li><li>重启rsyslog服务</li></ul> </li><li> <p>手动轮转</p> 
  <ul><li>logrotate -vf /etc/logrotate.d/secure</li><li>systemctl restart rsyslog</li></ul> </li><li> <p>注意</p> 
  <ul><li>rpm包安装的服务自带轮转规则，编译安装或自定义服务日志需要手动编写轮转规则</li><li>系统日志（配置在rsyslog.conf中）在轮转后会自动重启rsyslog服务，保证新的日志记录到新文件中</li><li>如果配置的日志不是由rsyslog记录（如应用日志），需要在轮转规则中配置postrotate/endscript来重启服务</li><li>postrotate<br> /bin/systemctl reload httpd.service &gt; /dev/null 2&gt;/dev/null || true<br> endscript</li></ul> </li></ul> 
<h3><a id="_1333"></a>系统信息</h3> 
<h4><a id="cpu_1335"></a>cpu信息</h4> 
<ul><li>lscpu</li><li>cat /proc/cpuinfo</li></ul> 
<h4><a id="cpu_1340"></a>cpu使用</h4> 
<ul><li>top、htop、mpstat、sar</li></ul> 
<h4><a id="_1344"></a>系统负载</h4> 
<ul><li>top、htop、uptime</li></ul> 
<h4><a id="_1348"></a>内存信息</h4> 
<ul><li>cat /proc/meminfo</li><li>free、sar</li></ul> 
<h4><a id="_1353"></a>系统版本</h4> 
<ul><li>uname -a</li><li>cat /etc/redhat-release</li></ul> 
<h4><a id="_1358"></a>运行级别</h4> 
<ul><li>runlevel</li></ul> 
<h4><a id="free_1362"></a>free</h4> 
<ul><li> <p>用法</p> 
  <ul><li> <p>free [选项]…</p> 
    <ul><li>显示系统内存的使用情况</li></ul> </li></ul> </li><li> <p>选项</p> 
  <ul><li> <p>-h</p> 
    <ul><li> <p>人性化显示</p> 
      <ul><li>free -h</li></ul> </li></ul> </li><li> <p>-s N</p> 
    <ul><li> <p>每隔N秒打印一次</p> 
      <ul><li>free -h -s 3</li></ul> </li></ul> </li><li> <p>单位</p> 
    <ul><li>-b(默认)：比特；-k：Kb；-m：Mb；-g：Gb</li></ul> </li></ul> </li><li> <p>显示内容</p> 
  <ul><li> <p>Mem</p> 
    <ul><li>内存的使用情况</li></ul> </li><li> <p>Swap</p> 
    <ul><li>交换空间的使用情况</li></ul> </li><li> <p>total used free shared<br> 总可用空间 已使用空间 空闲物理内存 被共享的物理内存</p> </li><li> <p>buff(缓冲)</p> 
    <ul><li>把分散的写操作集中进行，减少磁盘碎片和硬盘的反复寻道，从而提高系统性能</li></ul> </li><li> <p>cache(缓存)</p> 
    <ul><li>操作系统为了更高的读取效率，使用更多的内存来缓存可能被再次访问的数据</li></ul> </li><li> <p>available</p> 
    <ul><li>从应用程序的角度看到的可用内存数量：free + buffer/cache</li></ul> </li></ul> </li><li> <p>释放buff/cache</p> 
  <ul><li>echo 3 &gt; /proc/sys/vm/drop_caches</li></ul> </li></ul> 
<h4><a id="df_1416"></a>df</h4> 
<ul><li> <p>用法</p> 
  <ul><li>显示指定磁盘文件的可用空间，默认已挂载的文件系统</li><li>df [选项]… [文件]…</li></ul> </li><li> <p>选项</p> 
  <ul><li>-a 全部文件系统</li><li>-h 人性化显示</li><li>-i 显示inode信息</li><li>-T 显示文件系统类型</li><li>-t 指定文件系统类型</li></ul> </li></ul> 
<h4><a id="sar_1431"></a>sar</h4> 
<ul><li> <p>用法</p> 
  <ul><li>系统运行状态统计</li><li>sar [ options ] [ [ ] ]</li></ul> </li><li> <p>参数</p> 
  <ul><li> <p>-R 显示内存状态</p> </li><li> <p>-b 显示I/O速率</p> </li><li> <p>-d 显示每个块设备的状态</p> </li><li> <p>-i 状态信息刷新的间隔时间</p> </li><li> <p>-u 显示CPU利用率</p> </li><li> <p>-n { [,…] | ALL }</p> 
    <ul><li>sar -n DEV 1 5 #实时查看网卡流量，每秒刷新1次，共5次</li><li>sar -n DEV -f /var/log/sa/sa02 #查看网卡历史流量</li></ul> </li></ul> </li></ul> 
<h4><a id="mpstat_1450"></a>mpstat</h4> 
<ul><li> <p>显示变化的CPU数据</p> </li><li> <p>监控第一个CPU</p> 
  <ul><li>mpstat -P 1</li></ul> </li><li> <p>监控全部CPU</p> 
  <ul><li>mpstat -P ALL</li></ul> </li><li> <p>每隔1个时间单位采样5次</p> 
  <ul><li>mpstat 1 5</li></ul> </li></ul> 
<h4><a id="uptime_1465"></a>uptime</h4> 
<ul><li> <p>查看系统负载</p> </li><li> <p>显示内容</p> 
  <ul><li>06:28:19 up 54 min, 2 users, load average: 0.32, 0.43, 0.58<br> 当前时间 运行时长 当前登录用户数 系统平均负载 最近1m 5m 15m</li></ul> </li><li> <p>参数</p> 
  <ul><li> <p>-p</p> 
    <ul><li>显示机器正常运行的时间</li></ul> </li><li> <p>-s</p> 
    <ul><li>系统自开始运行时间，格式为yyyy-mm-dd hh:mm:ss</li></ul> </li></ul> </li></ul> 
<h4><a id="_1483"></a>查看登录服务器终端</h4> 
<ul><li> <p>w</p> </li><li> <p>who</p> </li><li> <p>last</p> 
  <ul><li>历史记录</li></ul> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9edf4f2167f8be5d96d1493cbf716492/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【数电实验】随机数生成电路</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/25749acc51ef160062baaebde0a5106a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">文件管理简介</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>