<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>面试必备的经典SQL语句大全 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="面试必备的经典SQL语句大全" />
<meta property="og:description" content="练习SQL语句大全（关键看思路） 该数据有三张表：
部门表dept（deptno部门编号、dname部门名称、loc位置）
/* Navicat MySQL Data Transfer Source Server : localhost_3306 Source Server Version : 50718 Source Host : localhost:3306 Source Database : sql_demo Target Server Type : MYSQL Target Server Version : 50718 File Encoding : 65001 Date: 2019-02-23 21:54:13 */ SET FOREIGN_KEY_CHECKS=0; -- ---------------------------- -- Table structure for dept -- ---------------------------- DROP TABLE IF EXISTS `dept`; CREATE TABLE `dept` ( `deptno` int(10) NOT NULL COMMENT &#39;部门编号&#39;, `dname` varchar(14) DEFAULT NULL COMMENT &#39;部门名称&#39;, `loc` varchar(13) DEFAULT NULL COMMENT &#39;部门位置&#39;, PRIMARY KEY (`deptno`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; -- ---------------------------- -- Records of dept -- ---------------------------- INSERT INTO `dept` VALUES (&#39;10&#39;, &#39;后勤部门&#39;, &#39;NEW YORK&#39;); INSERT INTO `dept` VALUES (&#39;20&#39;, &#39;开发部门&#39;, &#39;DALLAS&#39;); INSERT INTO `dept` VALUES (&#39;30&#39;, &#39;销售部门&#39;, &#39;CHICAGO&#39;); INSERT INTO `dept` VALUES (&#39;40&#39;, &#39;推广部门&#39;, &#39;BOSTON&#39;); 员工表emp（empno工号、ename员工姓名、job职位、mgr直属领导工号、hiredate入职日期、sal月薪、comm补贴、deptno部门编号）" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/d96c9b0dda0b33762cf0798b8573f594/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-15T21:36:14+08:00" />
<meta property="article:modified_time" content="2018-10-15T21:36:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">面试必备的经典SQL语句大全</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="SQL_0"></a>练习SQL语句大全（关键看思路）</h3> 
<p><strong>该数据有三张表：</strong><br> <strong>部门表dept</strong>（deptno部门编号、dname部门名称、loc位置）</p> 
<pre><code class="prism language-java"><span class="token comment">/*
Navicat MySQL Data Transfer

Source Server         : localhost_3306
Source Server Version : 50718
Source Host           : localhost:3306
Source Database       : sql_demo

Target Server Type    : MYSQL
Target Server Version : 50718
File Encoding         : 65001

Date: 2019-02-23 21:54:13
*/</span>

SET FOREIGN_KEY_CHECKS<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token operator">--</span> Table structure <span class="token keyword">for</span> dept
<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
DROP TABLE IF EXISTS `dept`<span class="token punctuation">;</span>
CREATE TABLE `dept` <span class="token punctuation">(</span>
  `deptno` <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT NULL COMMENT <span class="token string">'部门编号'</span><span class="token punctuation">,</span>
  `dname` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span> DEFAULT NULL COMMENT <span class="token string">'部门名称'</span><span class="token punctuation">,</span>
  `loc` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> DEFAULT NULL COMMENT <span class="token string">'部门位置'</span><span class="token punctuation">,</span>
  PRIMARY KEY <span class="token punctuation">(</span>`deptno`<span class="token punctuation">)</span>
<span class="token punctuation">)</span> ENGINE<span class="token operator">=</span>InnoDB DEFAULT CHARSET<span class="token operator">=</span>utf8<span class="token punctuation">;</span>

<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token operator">--</span> Records of dept
<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
INSERT INTO `dept` VALUES <span class="token punctuation">(</span><span class="token string">'10'</span><span class="token punctuation">,</span> <span class="token string">'后勤部门'</span><span class="token punctuation">,</span> <span class="token string">'NEW YORK'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `dept` VALUES <span class="token punctuation">(</span><span class="token string">'20'</span><span class="token punctuation">,</span> <span class="token string">'开发部门'</span><span class="token punctuation">,</span> <span class="token string">'DALLAS'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `dept` VALUES <span class="token punctuation">(</span><span class="token string">'30'</span><span class="token punctuation">,</span> <span class="token string">'销售部门'</span><span class="token punctuation">,</span> <span class="token string">'CHICAGO'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `dept` VALUES <span class="token punctuation">(</span><span class="token string">'40'</span><span class="token punctuation">,</span> <span class="token string">'推广部门'</span><span class="token punctuation">,</span> <span class="token string">'BOSTON'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<p><strong>员工表emp</strong>（empno工号、ename员工姓名、job职位、mgr直属领导工号、hiredate入职日期、sal月薪、comm补贴、deptno部门编号）</p> 
<pre><code class="prism language-java"><span class="token comment">/*
Navicat MySQL Data Transfer

Source Server         : localhost_3306
Source Server Version : 50718
Source Host           : localhost:3306
Source Database       : sql_demo

Target Server Type    : MYSQL
Target Server Version : 50718
File Encoding         : 65001

Date: 2019-02-23 21:54:29
*/</span>

SET FOREIGN_KEY_CHECKS<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token operator">--</span> Table structure <span class="token keyword">for</span> emp
<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
DROP TABLE IF EXISTS `emp`<span class="token punctuation">;</span>
CREATE TABLE `emp` <span class="token punctuation">(</span>
  `empno` <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> NOT NULL<span class="token punctuation">,</span>
  `ename` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> DEFAULT NULL<span class="token punctuation">,</span>
  `job` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> DEFAULT NULL<span class="token punctuation">,</span>
  `mgr` <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> DEFAULT NULL COMMENT <span class="token string">'直属领导工号'</span><span class="token punctuation">,</span>
  `hiredate` date DEFAULT NULL COMMENT <span class="token string">'入职日期'</span><span class="token punctuation">,</span>
  `sal` <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> DEFAULT NULL<span class="token punctuation">,</span>
  `comm` <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> DEFAULT NULL COMMENT <span class="token string">'补贴'</span><span class="token punctuation">,</span>
  `deptno` <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> DEFAULT NULL<span class="token punctuation">,</span>
  PRIMARY KEY <span class="token punctuation">(</span>`empno`<span class="token punctuation">)</span>
<span class="token punctuation">)</span> ENGINE<span class="token operator">=</span>InnoDB DEFAULT CHARSET<span class="token operator">=</span>utf8<span class="token punctuation">;</span>

<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token operator">--</span> Records of emp
<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7369'</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'CLERK'</span><span class="token punctuation">,</span> <span class="token string">'7902'</span><span class="token punctuation">,</span> <span class="token string">'1980-12-17'</span><span class="token punctuation">,</span> <span class="token string">'800.00'</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token string">'20'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7499'</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token string">'SALESMAN'</span><span class="token punctuation">,</span> <span class="token string">'7698'</span><span class="token punctuation">,</span> <span class="token string">'1981-02-20'</span><span class="token punctuation">,</span> <span class="token string">'1600.00'</span><span class="token punctuation">,</span> <span class="token string">'300.00'</span><span class="token punctuation">,</span> <span class="token string">'30'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7521'</span><span class="token punctuation">,</span> <span class="token string">'王二'</span><span class="token punctuation">,</span> <span class="token string">'SALESMAN'</span><span class="token punctuation">,</span> <span class="token string">'7698'</span><span class="token punctuation">,</span> <span class="token string">'1981-02-22'</span><span class="token punctuation">,</span> <span class="token string">'1250.00'</span><span class="token punctuation">,</span> <span class="token string">'500.00'</span><span class="token punctuation">,</span> <span class="token string">'30'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7566'</span><span class="token punctuation">,</span> <span class="token string">'李武'</span><span class="token punctuation">,</span> <span class="token string">'MANAGER'</span><span class="token punctuation">,</span> <span class="token string">'7839'</span><span class="token punctuation">,</span> <span class="token string">'1981-04-02'</span><span class="token punctuation">,</span> <span class="token string">'2975.00'</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token string">'20'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7654'</span><span class="token punctuation">,</span> <span class="token string">'周六'</span><span class="token punctuation">,</span> <span class="token string">'SALESMAN'</span><span class="token punctuation">,</span> <span class="token string">'7698'</span><span class="token punctuation">,</span> <span class="token string">'1981-09-28'</span><span class="token punctuation">,</span> <span class="token string">'1250.00'</span><span class="token punctuation">,</span> <span class="token string">'1400.00'</span><span class="token punctuation">,</span> <span class="token string">'30'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7698'</span><span class="token punctuation">,</span> <span class="token string">'刘振'</span><span class="token punctuation">,</span> <span class="token string">'MANAGER'</span><span class="token punctuation">,</span> <span class="token string">'7839'</span><span class="token punctuation">,</span> <span class="token string">'1981-05-01'</span><span class="token punctuation">,</span> <span class="token string">'2850.00'</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token string">'30'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7782'</span><span class="token punctuation">,</span> <span class="token string">'曹阳'</span><span class="token punctuation">,</span> <span class="token string">'MANAGER'</span><span class="token punctuation">,</span> <span class="token string">'7839'</span><span class="token punctuation">,</span> <span class="token string">'1981-06-09'</span><span class="token punctuation">,</span> <span class="token string">'2450.00'</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token string">'10'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7788'</span><span class="token punctuation">,</span> <span class="token string">'爱丽丝'</span><span class="token punctuation">,</span> <span class="token string">'ANALYST'</span><span class="token punctuation">,</span> <span class="token string">'7566'</span><span class="token punctuation">,</span> <span class="token string">'1987-04-19'</span><span class="token punctuation">,</span> <span class="token string">'3000.00'</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token string">'20'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7839'</span><span class="token punctuation">,</span> <span class="token string">'哪吒'</span><span class="token punctuation">,</span> <span class="token string">'PRESIDENT'</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token string">'1981-11-17'</span><span class="token punctuation">,</span> <span class="token string">'5000.00'</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token string">'10'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7844'</span><span class="token punctuation">,</span> <span class="token string">'赵云'</span><span class="token punctuation">,</span> <span class="token string">'SALESMAN'</span><span class="token punctuation">,</span> <span class="token string">'7698'</span><span class="token punctuation">,</span> <span class="token string">'1981-09-08'</span><span class="token punctuation">,</span> <span class="token string">'1500.00'</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token string">'30'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7876'</span><span class="token punctuation">,</span> <span class="token string">'妲己'</span><span class="token punctuation">,</span> <span class="token string">'CLERK'</span><span class="token punctuation">,</span> <span class="token string">'7788'</span><span class="token punctuation">,</span> <span class="token string">'1987-05-23'</span><span class="token punctuation">,</span> <span class="token string">'1100.00'</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token string">'20'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7900'</span><span class="token punctuation">,</span> <span class="token string">'刘备'</span><span class="token punctuation">,</span> <span class="token string">'CLERK'</span><span class="token punctuation">,</span> <span class="token string">'7698'</span><span class="token punctuation">,</span> <span class="token string">'1981-12-03'</span><span class="token punctuation">,</span> <span class="token string">'950.00'</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token string">'30'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7902'</span><span class="token punctuation">,</span> <span class="token string">'猴子'</span><span class="token punctuation">,</span> <span class="token string">'ANALYST'</span><span class="token punctuation">,</span> <span class="token string">'7566'</span><span class="token punctuation">,</span> <span class="token string">'1981-12-03'</span><span class="token punctuation">,</span> <span class="token string">'3000.00'</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token string">'20'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `emp` VALUES <span class="token punctuation">(</span><span class="token string">'7934'</span><span class="token punctuation">,</span> <span class="token string">'安其拉'</span><span class="token punctuation">,</span> <span class="token string">'CLERK'</span><span class="token punctuation">,</span> <span class="token string">'7782'</span><span class="token punctuation">,</span> <span class="token string">'1982-01-23'</span><span class="token punctuation">,</span> <span class="token string">'950.00'</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token string">'10'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<p><strong>薪水等级表salgrade</strong>（grade等级、losal区间下限、hisal区间上限）</p> 
<pre><code class="prism language-java"><span class="token comment">/*
Navicat MySQL Data Transfer

Source Server         : localhost_3306
Source Server Version : 50718
Source Host           : localhost:3306
Source Database       : sql_demo

Target Server Type    : MYSQL
Target Server Version : 50718
File Encoding         : 65001

Date: 2019-02-23 21:54:39
*/</span>

SET FOREIGN_KEY_CHECKS<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token operator">--</span> Table structure <span class="token keyword">for</span> salgrade
<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
DROP TABLE IF EXISTS `salgrade`<span class="token punctuation">;</span>
CREATE TABLE `salgrade` <span class="token punctuation">(</span>
  `grade` <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> DEFAULT NULL COMMENT <span class="token string">'薪水等级'</span><span class="token punctuation">,</span>
  `losal` <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> DEFAULT NULL COMMENT <span class="token string">'薪水最低'</span><span class="token punctuation">,</span>
  `hisal` <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> DEFAULT NULL COMMENT <span class="token string">'薪水最高'</span>
<span class="token punctuation">)</span> ENGINE<span class="token operator">=</span>InnoDB DEFAULT CHARSET<span class="token operator">=</span>utf8<span class="token punctuation">;</span>

<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token operator">--</span> Records of salgrade
<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
INSERT INTO `salgrade` VALUES <span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'700'</span><span class="token punctuation">,</span> <span class="token string">'1200'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `salgrade` VALUES <span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'1201'</span><span class="token punctuation">,</span> <span class="token string">'1400'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `salgrade` VALUES <span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'1401'</span><span class="token punctuation">,</span> <span class="token string">'2000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `salgrade` VALUES <span class="token punctuation">(</span><span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'2001'</span><span class="token punctuation">,</span> <span class="token string">'3000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO `salgrade` VALUES <span class="token punctuation">(</span><span class="token string">'5'</span><span class="token punctuation">,</span> <span class="token string">'3001'</span><span class="token punctuation">,</span> <span class="token string">'5000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<h3><a id="1__143"></a>1、 取得每个部门最高薪水人员的名称</h3> 
<p>#1.先查每个部门最高薪水的(按照部门编号分组)<br> SELECT deptno ,MAX(sal) AS maxsal FROM emp GROUP BY deptno<br> #2.把这张表当做临时表，跟emp表进行连接通过员工表的部门编号和最高的薪水<br> SELECT emp.ename , t.*<br> FROM emp<br> JOIN (SELECT deptno ,MAX(sal) AS maxsal FROM emp GROUP BY deptno) as t<br> ON t.deptno = emp.deptno AND t.maxsal = emp.sal</p> 
<h3><a id="2__152"></a>2、 哪些人的薪水在部门平均薪水之上？</h3> 
<p>#第一步需要先按照部门编号分组选出每个部门的平均薪水<br> SELECT deptno , AVG(sal) FROM emp GROUP BY deptno<br> #第二步需要把刚才的那个表当做临时表通过临时表的部门id且当部门表中的薪水比临时表中的薪水高的时候查出所有的数据<br> SELECT emp.ename,emp.sal , t.*<br> FROM emp<br> JOIN (SELECT deptno , AVG(sal) AS avgsal FROM emp GROUP BY deptno)t<br> ON emp.deptno = t.deptno AND emp.sal &gt; t.avgsal</p> 
<p>±-------±--------±-------±------------+<br> | ename | sal | deptno | avgsal |<br> ±-------±--------±-------±------------+<br> | 李四 | 1600.00 | 30 | 1566.666667 |<br> | 李武 | 2975.00 | 20 | 2175.000000 |<br> | 刘振 | 2850.00 | 30 | 1566.666667 |<br> | 爱丽丝 | 3000.00 | 20 | 2175.000000 |<br> | 哪吒 | 5000.00 | 10 | 2916.666667 |<br> | 猴子 | 3000.00 | 20 | 2175.000000 |<br> ±-------±--------±-------±------------+</p> 
<h3><a id="31_172"></a>3、（1）取得部门中（所有人的）平均薪水的等级</h3> 
<p>#思路：其实就是让你把部门的平均薪水等级而且是按部门分组得到临时表，在用临时表的平均薪水放到薪水等级表中用between完成<br> #第一步所以我们的目的是要求平均薪水的等级，也就是求部门的平均薪水(按部门分)<br> SELECT deptno ,AVG(sal) FROM emp GROUP BY deptno<br> #第二步是用得到的上表进行在薪水等级表中进行用betwee和and关联一起<br> SELECT t.* , salgrade.grade<br> FROM (SELECT deptno ,AVG(sal) AS avgsal FROM emp GROUP BY deptno) AS t<br> JOIN salgrade<br> ON avgsal BETWEEN salgrade.losal AND salgrade.hisal</p> 
<p>±-------±------------±------+<br> | deptno | avgsal | grade |<br> ±-------±------------±------+<br> | 10 | 2916.666667 | 4 |<br> | 20 | 2175.000000 | 4 |<br> | 30 | 1566.666667 | 3 |<br> ±-------±------------±------+</p> 
<h3><a id="3_2_190"></a>3、 (2)取得部门中（所有人的）平均的薪水等级</h3> 
<p>#思路：其实说白了就是求出每一个员工的薪水等级然后在按部门进行排序，然后再对部门编号进行分组在分组内进行求平均成绩的函数<br> #第一步先求出每一个员工的薪水等级<br> SELECT emp.ename,emp.sal,emp.deptno,salgrade.grade FROM emp JOIN salgrade ON<br> emp.sal BETWEEN salgrade.losal AND salgrade.hisal ORDER BY emp.deptno<br> #第二步就是在上一步的基础上进行进行按部门分组，并且对成绩等级进行求平均函数<br> SELECT emp.deptno AS deptno,AVG( salgrade.grade) AS avgsal<br> FROM emp<br> JOIN salgrade ON<br> emp.sal BETWEEN salgrade.losal AND salgrade.hisal<br> GROUP BY emp.deptno<br> ±-------±-------+<br> | deptno | avgsal |<br> ±-------±-------+<br> | 10 | 3.6667 |<br> | 20 | 2.8000 |<br> | 30 | 2.5000 |<br> ±-------±-------+</p> 
<h3><a id="5__209"></a>5、 取得平均薪水最高的部门和部门编号（至少给出两种解决方案）</h3> 
<p><strong>（1）思路：（这种是使用最容易想到的两表关联）其实就是查询平均薪水最高的部门和编号，这里没什么好解释的</strong><br> #第一步需要先求出部门平均薪水最高的部门，然后当成一个临时表<br> SELECT ename,deptno,AVG(sal) AS avgsal FROM emp GROUP BY deptno<br> #第二步把你的临时表跟你想要拿到的部门名称和编号都关联起来，这里可以使用当部门编号相同的时候来进行关联<br> SELECT dept.dname,dept.deptno , MAX(t.avgsal)<br> FROM dept<br> JOIN (SELECT ename,deptno,AVG(sal) AS avgsal FROM emp GROUP BY deptno)AS t<br> ON dept.deptno = t.deptno</p> 
<p>±-------------±-------±--------------+<br> | dname | deptno | MAX(t.avgsal) |<br> ±-------------±-------±--------------+<br> | 后勤部门 | 10 | 2916.666667 |<br> ±-------------±-------±--------------+</p> 
<p><strong>（2）思路：（这种是使用临时表和目的表可以使用where条件关联）也是通过部门编号，这里思路和上面那个俩表关联一样的思路</strong><br> #第一步需要先求出部门平均薪水最高的部门，然后当成一个临时表<br> SELECT ename,deptno,AVG(sal) AS avgsal FROM emp GROUP BY deptno<br> #第二步把你的临时表跟你想要拿到的部门名称和编号都关联起来，这里还可以使用where来进行关联<br> SELECT dept.dname,dept.deptno , MAX(t.avgsal)<br> FROM dept ,(SELECT ename,deptno,AVG(sal) AS avgsal FROM emp GROUP BY deptno)AS t<br> WHERE dept.deptno = t.deptno</p> 
<p>±-------------±-------±--------------+<br> | dname | deptno | MAX(t.avgsal) |<br> ±-------------±-------±--------------+<br> | 后勤部门 | 10 | 2916.666667 |<br> ±-------------±-------±--------------+<br> <strong>（3）方案实现就是按照平均薪水降序排列取第一个</strong></p> 
<p>#首先第一步你得先取到每一个部门的平均薪水<br> SELECT AVG( sal) ,deptno FROM emp GROUP BY deptno<br> #然后第二步取出平均薪水最高的那个部门（把它当成一个）<br> SELECT AVG( sal) AS avgsal FROM emp GROUP BY deptno ORDER BY avgsal desc LIMIT 1<br> #第三步其实就是在第一步的基础上用having取到平均薪水最高的那个部门<br> SELECT AVG( sal) ,deptno FROM emp<br> GROUP BY deptno<br> HAVING AVG( sal) = (SELECT AVG( sal) AS avgsal FROM emp GROUP BY deptno ORDER BY avgsal desc LIMIT 1)<br> ±------------±-------+<br> | AVG( sal) | deptno |<br> ±------------±-------+<br> | 2916.666667 | 10 |<br> ±------------±-------+</p> 
<h3><a id="6__254"></a>6、 取得平均薪水最高的部门和部门名称</h3> 
<p>#第一步先拿到每个部门的平均薪水<br> SELECT AVG(sal),deptno FROM emp GROUP BY deptno<br> #第二步先按照部门分组得出每个组的平均薪水，然后在排序取出最高的薪水<br> SELECT AVG(sal) AS avgsal FROM emp GROUP BY deptno ORDER BY avgsal DESC LIMIT 1<br> #第三步把取到的平均薪水最高的部门表当做临时表，和部门表进行关联,然后取出平均薪水最高的那个<br> SELECT dept.dname,avgsal<br> FROM (SELECT AVG(sal) AS avgsal ,deptno FROM emp GROUP BY deptno) AS t<br> JOIN dept<br> ON dept.deptno = t.deptno<br> HAVING avgsal =<br> (SELECT AVG(sal) AS avgsal FROM emp GROUP BY deptno ORDER BY avgsal DESC LIMIT 1)<br> ±-------------±------------+<br> | dname | avgsal |<br> ±-------------±------------+<br> | 后勤部门 | 2916.666667 |<br> ±-------------±------------+</p> 
<h3><a id="7__271"></a>7、 求平均薪水的等级最高的部门的部门名称</h3> 
<p><strong>#第一步先拿到各个部门的平均薪水的等级并且跟部门名称也进行关联一起</strong><br> SELECT dept.dname,AVG(sal),emp.deptno FROM emp JOIN dept ON dept.deptno=emp.deptno GROUP BY deptno<br> <strong>#第二步通过第一步的临时表和薪水等级表进行关联，用临时表的平均薪水用between进行范围查询</strong><br> SELECT t.dname,t.avgsal,s.grade<br> FROM (SELECT dept.dname AS dname,AVG(sal)AS avgsal,emp.deptno FROM emp JOIN dept ON dept.deptno=emp.deptno GROUP BY deptno) AS t<br> JOIN salgrade AS s<br> ON t.avgsal BETWEEN s.losal AND s.hisal<br> <strong>#第三步获取最高等级的值(首先你的想办法把平均薪水临时表和最高等级表进行关联起来)</strong><br> SELECT MAX(grade)<br> FROM (SELECT AVG(sal) AS avgsal,deptno FROM emp GROUP BY deptno) AS t<br> JOIN salgrade AS s<br> ON t.avgsal BETWEEN s.losal AND s.hisal<br> <strong>#第四步其实就是把第二步和第三步进行联合一起进行查询，因为这里涉及到部门名称，<br> #所以需要在第一步的时候也要把部门名称和平均薪水关联起来</strong></p> 
<ul><li></ul> 
<p><strong>SELECT t.dname,t.avgsal,s.grade AS grade<br> FROM<br> (SELECT dept.dname AS dname,AVG(sal)AS avgsal,emp.deptno FROM emp JOIN dept ON dept.deptno=emp.deptno GROUP BY deptno) AS t<br> JOIN salgrade AS s<br> ON t.avgsal<br> BETWEEN s.losal AND s.hisal<br> WHERE grade = (SELECT MAX(grade)<br> FROM<br> (SELECT AVG(sal) AS avgsal,deptno FROM emp GROUP BY deptno) AS t<br> JOIN salgrade AS s<br> ON t.avgsal<br> BETWEEN s.losal AND s.hisal)</strong></p> 
<p>±-------------±------------±------+<br> | dname | avgsal | grade |<br> ±-------------±------------±------+<br> | 后勤部门 | 2916.666667 | 4 |<br> | 开发部门 | 2175.000000 | 4 |<br> ±-------------±------------±------+</p> 
<h3><a id="8_mgr_308"></a>8、 取得比普通员工（院代码没有在mgr字段出现的）的最高薪水还要高的领导人姓名</h3> 
<p><strong>思路就是先取出全部的普通员工，然后用限定条件若不在直接领导人号的列表中就说明是普通员工，然后在取出员工最高的那个值当做一个字段和取出所有薪水的领导人进行where限定筛选</strong><br> <strong>总结：在使用not in 的时候需要手动去除为NULL的字段的值，如果是使用in 的话可以自动忽略为NULL的字段值</strong><br> #第一步首先是取出普通的员工(这里需要注意的是not in不会自动忽略空值，但是in可以)<br> SELECT * FROM emp WHERE empno not in<br> (SELECT DISTINCT mgr FROM emp WHERE mgr is NOT NULL)<br> #第二步找出普通员工的最高的薪水<br> SELECT MAX(sal) FROM emp WHERE empno not in<br> (SELECT DISTINCT mgr FROM emp WHERE mgr is NOT NULL)<br> #第三步需要找到比普通员工最高的薪水的领导人的姓名<br> SELECT emp.ename,sal FROM emp<br> WHERE sal &gt;(SELECT MAX(sal) FROM emp WHERE empno not in<br> (SELECT DISTINCT mgr FROM emp WHERE mgr is NOT NULL))</p> 
<p>±----------±--------+<br> | ename | sal |<br> ±----------±--------+<br> | 李武 | 2975.00 |<br> | 刘振 | 2850.00 |<br> | 曹阳 | 2450.00 |<br> | 爱丽丝 | 3000.00 |<br> | 哪吒 | 5000.00 |<br> | 猴子 | 3000.00 |<br> ±----------±--------+</p> 
<h3><a id="9__333"></a>9、 取得薪水最高的前五名员工</h3> 
<p>#这个没啥好说的就是直接查询然后按照薪水降序排序然后取到前5条数据<br> SELECT emp.ename,emp.sal FROM emp ORDER BY sal DESC LIMIT 5<br> ±------±----------±----------±-----±-----------±--------±-----±-------+<br> | empno | ename | job | mgr | hiredate | sal | comm | deptno |<br> ±------±----------±----------±-----±-----------±--------±-----±-------+<br> | 7839 | 哪吒 | PRESIDENT | NULL | 1981-11-17 | 5000.00 | NULL | 10 |<br> | 7902 | 猴子 | ANALYST | 7566 | 1981-12-03 | 3000.00 | NULL | 20 |<br> | 7788 | 爱丽丝 | ANALYST | 7566 | 1987-04-19 | 3000.00 | NULL | 20 |<br> | 7566 | 李武 | MANAGER | 7839 | 1981-04-02 | 2975.00 | NULL | 20 |<br> | 7698 | 刘振 | MANAGER | 7839 | 1981-05-01 | 2850.00 | NULL | 30 |<br> ±------±----------±----------±-----±-----------±--------±-----±-------+</p> 
<h3><a id="10_346"></a>10、取得薪水最高的第六到第十名员工</h3> 
<p>#这个也没啥好说的主要是利用limit，也就是我们实现分页所需要用到的，<br> #limit的第一个数表示从第几条数据开始截取，第二个参数是从刚刚第一个参数开始截取多少条数据<br> SELECT * FROM emp ORDER BY sal DESC LIMIT 5, 5<br> ±------±----------±---------±-----±-----------±--------±-------±-------+<br> | empno | ename | job | mgr | hiredate | sal | comm | deptno |<br> ±------±----------±---------±-----±-----------±--------±-------±-------+<br> | 7782 | 曹阳 | MANAGER | 7839 | 1981-06-09 | 2450.00 | NULL | 10 |<br> | 7499 | 李四 | SALESMAN | 7698 | 1981-02-20 | 1600.00 | 300.00 | 30 |<br> | 7844 | 赵云 | SALESMAN | 7698 | 1981-09-08 | 1500.00 | NULL | 30 |<br> | 7934 | 安其拉 | CLERK | 7782 | 1982-01-23 | 1300.00 | NULL | 10 |<br> | 7521 | 王二 | SALESMAN | 7698 | 1981-02-22 | 1250.00 | 500.00 | 30 |<br> ±------±----------±---------±-----±-----------±--------±-------±-------+</p> 
<h3><a id="12_360"></a>12、取得每个薪水等级有多少员工</h3> 
<p><strong>思路：首先先按照薪水等级进行分组（这里需要考虑把员工表和薪水等级表进行关联），然后进行分组中的查询每个组的员工的个数</strong><br> SELECT emp.*,COUNT(emp.empno)AS 每个等级的员工个数 FROM emp JOIN salgrade<br> ON sal BETWEEN salgrade.losal AND salgrade.hisal<br> GROUP BY salgrade.grade<br> ±------±-------±----------±-----±-----------±--------±-------±-------±-----------------+<br> | empno | ename | job | mgr | hiredate | sal | comm | deptno | COUNT(emp.empno) |<br> ±------±-------±----------±-----±-----------±--------±-------±-------±-----------------+<br> | 7369 | 张三 | CLERK | 7902 | 1980-12-17 | 800.00 | NULL | 20 | 3 |<br> | 7521 | 王二 | SALESMAN | 7698 | 1981-02-22 | 1250.00 | 500.00 | 30 | 3 |<br> | 7499 | 李四 | SALESMAN | 7698 | 1981-02-20 | 1600.00 | 300.00 | 30 | 2 |<br> | 7566 | 李武 | MANAGER | 7839 | 1981-04-02 | 2975.00 | NULL | 20 | 5 |<br> | 7839 | 哪吒 | PRESIDENT | NULL | 1981-11-17 | 5000.00 | NULL | 10 | 1 |<br> ±------±-------±----------±-----±-----------±--------±-------±-------±-----------------+</p> 
<h3><a id="14_376"></a>14、列出所有员工及领导的姓名</h3> 
<p>#思路：就是因为员工和领导都在员工表中，但是他们的对应关系是员工表的上级是领导的员工号（因为领导也是员工啊）<br> SELECT a.ename AS ‘员工姓名’,b.ename AS ‘领导姓名’ FROM<br> emp AS a JOIN emp AS b<br> ON a.empno = b.mgr<br> ±-------------±-------------+<br> | 员工姓名 | 领导姓名 |<br> ±-------------±-------------+<br> | 猴子 | 张三 |<br> | 刘振 | 李四 |<br> | 刘振 | 王二 |<br> | 哪吒 | 李武 |<br> | 刘振 | 周六 |<br> | 哪吒 | 刘振 |<br> | 哪吒 | 曹阳 |<br> | 李武 | 爱丽丝 |<br> | 刘振 | 赵云 |<br> | 爱丽丝 | 妲己 |<br> | 刘振 | 刘备 |<br> | 李武 | 猴子 |<br> | 曹阳 | 安其拉 |<br> ±-------------±-------------+</p> 
<h3><a id="15_399"></a>15、列出受雇日期早于其直接上级的所有员工的编号、姓名、部门名称</h3> 
<p><strong>#第一步因为员工表中既有员工又有领导，那就让领导和员工表结合<br> #然后用where条件限定日期大小<br> #第二步是把部门表也给关联进去</strong><br> SELECT a.empno AS ‘员工编号’,a.ename AS ‘员工姓名’,a.hiredate,<br> b.hiredate,b.empno AS ‘领导编号’,b.ename AS ‘领导姓名’,dept.dname AS ‘部门名称’<br> FROM emp AS a<br> JOIN emp AS b<br> ON a.empno = b.mgr<br> JOIN dept<br> ON a.deptno = dept.deptno<br> WHERE a.hiredate &lt; b.hiredate</p> 
<p>±-------------±-------------±-----------±-----------±-------------±-------------±-------------+<br> | 员工编号 | 员工姓名 | hiredate | hiredate | 领导编号 | 领导姓名 | 部门名称 |<br> ±-------------±-------------±-----------±-----------±-------------±-------------±-------------+<br> | 7782 | 曹阳 | 1981-06-09 | 1982-01-23 | 7934 | 安其拉 | 后勤部门 |<br> | 7566 | 李武 | 1981-04-02 | 1987-04-19 | 7788 | 爱丽丝 | 开发部门 |<br> | 7788 | 爱丽丝 | 1987-04-19 | 1987-05-23 | 7876 | 妲己 | 开发部门 |<br> | 7566 | 李武 | 1981-04-02 | 1981-12-03 | 7902 | 猴子 | 开发部门 |<br> | 7698 | 刘振 | 1981-05-01 | 1981-09-28 | 7654 | 周六 | 销售部门 |<br> | 7698 | 刘振 | 1981-05-01 | 1981-09-08 | 7844 | 赵云 | 销售部门 |<br> | 7698 | 刘振 | 1981-05-01 | 1981-12-03 | 7900 | 刘备 | 销售部门 |<br> ±-------------±-------------±-----------±-----------±-------------±-------------±-------------+</p> 
<h3><a id="16_424"></a>16、列出部门名称和这些部门的员工信息，同时列出那些没有员工的部门</h3> 
<p>#思路:因为题目说了不仅要简单的列出部门名称和员工信息，而且还要列出部门里面没有员工的情况<br> #所以很容易能想到是用左联接，或者是右连接都可以实现<br> #（1）使用左连接实现<br> SELECT dname AS ‘部门名称’ , emp.* FROM dept LEFT JOIN emp<br> ON dept.deptno = emp.deptno ORDER BY dname<br> #(2)使用右连接实现<br> SELECT dept.dname , emp.* FROM emp RIGHT JOIN dept<br> ON dept.deptno = emp.deptno<br> ±-------------±------±----------±----------±-----±-----------±--------±--------±-------+<br> | 部门名称 | empno | ename | job | mgr | hiredate | sal | comm | deptno |<br> ±-------------±------±----------±----------±-----±-----------±--------±--------±-------+<br> | 后勤部门 | 7782 | 曹阳 | MANAGER | 7839 | 1981-06-09 | 2450.00 | NULL | 10 |<br> | 后勤部门 | 7839 | 哪吒 | PRESIDENT | NULL | 1981-11-17 | 5000.00 | NULL | 10 |<br> | 后勤部门 | 7934 | 安其拉 | CLERK | 7782 | 1982-01-23 | 1300.00 | NULL | 10 |<br> | 开发部门 | 7876 | 妲己 | CLERK | 7788 | 1987-05-23 | 1100.00 | NULL | 20 |<br> | 开发部门 | 7902 | 猴子 | ANALYST | 7566 | 1981-12-03 | 3000.00 | NULL | 20 |<br> | 开发部门 | 7566 | 李武 | MANAGER | 7839 | 1981-04-02 | 2975.00 | NULL | 20 |<br> | 开发部门 | 7788 | 爱丽丝 | ANALYST | 7566 | 1987-04-19 | 3000.00 | NULL | 20 |<br> | 开发部门 | 7369 | 张三 | CLERK | 7902 | 1980-12-17 | 800.00 | NULL | 20 |<br> | 推广部门 | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL |<br> | 销售部门 | 7499 | 李四 | SALESMAN | 7698 | 1981-02-20 | 1600.00 | 300.00 | 30 |<br> | 销售部门 | 7698 | 刘振 | MANAGER | 7839 | 1981-05-01 | 2850.00 | NULL | 30 |<br> | 销售部门 | 7844 | 赵云 | SALESMAN | 7698 | 1981-09-08 | 1500.00 | NULL | 30 |<br> | 销售部门 | 7900 | 刘备 | CLERK | 7698 | 1981-12-03 | 950.00 | NULL | 30 |<br> | 销售部门 | 7521 | 王二 | SALESMAN | 7698 | 1981-02-22 | 1250.00 | 500.00 | 30 |<br> | 销售部门 | 7654 | 周六 | SALESMAN | 7698 | 1981-09-28 | 1250.00 | 1400.00 | 30 |<br> ±-------------±------±----------±----------±-----±-----------±--------±--------±-------+</p> 
<h3><a id="175_453"></a>17、列出至少有5个员工的所有部门的详细信息</h3> 
<p>#思路就是先把员工表和部门表进行关联，然后分组的时候之后只能用having，而且在使用分组的时候还可以是多个字段</p> 
<p>SELECT emp.ename,dept.dname,dept.loc,dept.deptno<br> FROM emp<br> JOIN dept<br> ON emp.deptno = dept.deptno<br> GROUP BY dept.dname,dept.loc,dept.deptno<br> HAVING COUNT(emp.empno)&gt;=5<br> ±-------±-------------±--------±-------+<br> | ename | dname | loc | deptno |<br> ±-------±-------------±--------±-------+<br> | 张三 | 开发部门 | DALLAS | 20 |<br> | 李四 | 销售部门 | CHICAGO | 30 |<br> ±-------±-------------±--------±-------+</p> 
<h3><a id="18simith_470"></a>18、列出薪金比‘simith’多的所有员工信息</h3> 
<p>#先找出妲己的薪水，当做一个字段<br> SELECT emp.sal FROM emp WHERE ename=‘曹阳’<br> #然后找到全部的员工信息加个where条件语句把第一步找到的薪水还大的给找出来<br> SELECT emp.* FROM emp WHERE sal &gt;=(SELECT emp.sal FROM emp WHERE ename=‘曹阳’)<br> ±------±----------±----------±-----±-----------±--------±-----±-------+<br> | empno | ename | job | mgr | hiredate | sal | comm | deptno |<br> ±------±----------±----------±-----±-----------±--------±-----±-------+<br> | 7566 | 李武 | MANAGER | 7839 | 1981-04-02 | 2975.00 | NULL | 20 |<br> | 7698 | 刘振 | MANAGER | 7839 | 1981-05-01 | 2850.00 | NULL | 30 |<br> | 7782 | 曹阳 | MANAGER | 7839 | 1981-06-09 | 2450.00 | NULL | 10 |<br> | 7788 | 爱丽丝 | ANALYST | 7566 | 1987-04-19 | 3000.00 | NULL | 20 |<br> | 7839 | 哪吒 | PRESIDENT | NULL | 1981-11-17 | 5000.00 | NULL | 10 |<br> | 7902 | 猴子 | ANALYST | 7566 | 1981-12-03 | 3000.00 | NULL | 20 |<br> ±------±----------±----------±-----±-----------±--------±-----±-------+</p> 
<h3><a id="19clerk_486"></a>19、列出所有’clerk’（办事员）的姓名及部门名称，部门人数</h3> 
<p>#<strong>第一步是先找出所有的“clerk”的姓名和部门名称作为一个表</strong><br> SELECT e.ename,d.dname FROM emp AS e<br> JOIN dept AS d<br> ON d.deptno = e.deptno<br> WHERE job = ‘clerk’<br> #第二步是找出部门人数而且是按照部门编号进行分组<br> SELECT deptno , COUNT(<em>) AS total FROM emp GROUP BY deptno<br> #第三步是把第一步的表和第二步的表进行连接通过部门编号<br> SELECT e.ename,d.dname,t.total FROM emp AS e<br> JOIN dept AS d<br> ON d.deptno = e.deptno<br> JOIN (SELECT deptno , COUNT(</em>) AS total FROM emp GROUP BY deptno)AS t<br> ON t.deptno = e.deptno<br> WHERE job = ‘clerk’<br> ±----------±-------------±------+<br> | ename | dname | total |<br> ±----------±-------------±------+<br> | 张三 | 开发部门 | 5 |<br> | 妲己 | 开发部门 | 5 |<br> | 刘备 | 销售部门 | 6 |<br> | 安其拉 | 后勤部门 | 3 |<br> ±----------±-------------±------+</p> 
<h3><a id="201500_509"></a>20、列出最低薪金大于1500的各种工作及从事此工作的全部雇员人数</h3> 
<p><strong>（1）第一种方式答案</strong><br> #第一步先按工作进行分组<br> SELECT job ,sal FROM emp GROUP BY job<br> #第二步然后找出工资最低的然后限定条件是大于1500<br> SELECT job, MIN(sal)AS minsal,COUNT(<em>)<br> FROM emp GROUP BY job HAVING minsal&gt;1500<br> ±----------±--------±---------+<br> | job | minsal | COUNT(</em>) |<br> ±----------±--------±---------+<br> | ANALYST | 3000.00 | 2 |<br> | MANAGER | 2450.00 | 3 |<br> | PRESIDENT | 5000.00 | 1 |<br> ±----------±--------±---------+</p> 
<h3><a id="21_525"></a>21、列出在部门‘开发部门’工作的员工的姓名，假定不知道开发部的部门编号</h3> 
<p>#第一步如果不知道开发部门的部门编号，但是我根据部门名称不是也可以查询部门编号吗<br> SELECT deptno FROM dept WHERE dname = ‘开发部门’<br> #第二步然后把查到的部门编号当做是一个字段，在进行去员工表中去查询<br> SELECT ename FROM emp<br> WHERE deptno = (SELECT deptno FROM dept WHERE dname = ‘开发部门’)<br> ±----------+<br> | ename |<br> ±----------+<br> | 张三 |<br> | 李武 |<br> | 爱丽丝 |<br> | 妲己 |<br> | 猴子 |<br> ±----------+</p> 
<h3><a id="22_541"></a>22、列出薪金高于公司平均薪金的所有员工，所在部门，上级领导的姓名，雇员的工资等级</h3> 
<p>#第一步是查出公司所有员工的平均工资<br> SELECT AVG(sal) FROM emp<br> #第二步还需要去查询上一级领导<br> SELECT a.ename AS ‘员工名称’,b.ename AS ‘领导的名字’<br> FROM emp AS a JOIN emp AS b ON a.empno = b.mgr</p> 
<p>#第三步是需要把部门表和员工表和薪水等级表进行关联起来<br> SELECT a.sal ,b.ename,dept.dname ,salgrade.grade ,a.ename AS ‘上级领导’<br> FROM emp AS a JOIN dept ON a.deptno =dept.deptno<br> JOIN emp AS b ON a.empno = b.mgr<br> JOIN salgrade ON a.sal<br> BETWEEN salgrade.losal AND salgrade.hisal<br> WHERE a.sal &gt; (SELECT AVG(emp.sal) FROM emp )<br> ±--------±----------±-------------±------±-------------+<br> | sal | ename | dname | grade | 上级领导 |<br> ±--------±----------±-------------±------±-------------+<br> | 3000.00 | 张三 | 开发部门 | 4 | 猴子 |<br> | 2850.00 | 李四 | 销售部门 | 4 | 刘振 |<br> | 2850.00 | 王二 | 销售部门 | 4 | 刘振 |<br> | 5000.00 | 李武 | 后勤部门 | 5 | 哪吒 |<br> | 2850.00 | 周六 | 销售部门 | 4 | 刘振 |<br> | 5000.00 | 刘振 | 后勤部门 | 5 | 哪吒 |<br> | 5000.00 | 曹阳 | 后勤部门 | 5 | 哪吒 |<br> | 2975.00 | 爱丽丝 | 开发部门 | 4 | 李武 |<br> | 2850.00 | 赵云 | 销售部门 | 4 | 刘振 |<br> | 3000.00 | 妲己 | 开发部门 | 4 | 爱丽丝 |<br> | 2850.00 | 刘备 | 销售部门 | 4 | 刘振 |<br> | 2975.00 | 猴子 | 开发部门 | 4 | 李武 |<br> | 2450.00 | 安其拉 | 后勤部门 | 4 | 曹阳 |<br> ±--------±----------±-------------±------±-------------+</p> 
<h3><a id="23_573"></a>23、列出与‘妲己’从事相同工作的所有员工及部门名称</h3> 
<p>#第一步先找到和妲己同一个部门的部门编号，然后通过找到的这个部门编号再去查询素有的员工信息<br> SELECT dept.deptno FROM dept JOIN emp ON emp.deptno = dept.deptno WHERE emp.ename=‘妲己’<br> #第二步通过部门编号去找所有的员工信息<br> SELECT emp.ename, dept.dname<br> FROM emp JOIN dept ON emp.deptno=dept.deptno<br> WHERE dept.deptno=(SELECT dept.deptno FROM dept JOIN emp<br> ON emp.deptno = dept.deptno WHERE emp.ename=‘妲己’)<br> ±----------±-------------+<br> | ename | dname |<br> ±----------±-------------+<br> | 张三 | 开发部门 |<br> | 李武 | 开发部门 |<br> | 爱丽丝 | 开发部门 |<br> | 妲己 | 开发部门 |<br> | 猴子 | 开发部门 |<br> ±----------±-------------+</p> 
<h3><a id="2430_593"></a>24、列出薪金等于部门30中员工的薪金的其他员工的姓名和薪金</h3> 
<p>#第一步首先是先查出部们编号等于30的员工<br> SELECT DISTINCT sal FROM emp WHERE deptno = 30<br> #第二步是查询所有部门的员工的薪水在上一个SQL中，且部门编号不等于30的<br> SELECT ename,sal FROM emp WHERE sal<br> in(SELECT DISTINCT sal FROM emp WHERE deptno = 30) AND deptno != 30<br> ±----------±-------+<br> | ename | sal |<br> ±----------±-------+<br> | 安其拉 | 950.00 |<br> ±----------±-------+</p> 
<h3><a id="2530_605"></a>25、列出薪金高于在部门30工作的所有员工的薪金的员工姓名和薪金，部门名称</h3> 
<p>#第一步其实就是找出部门编号为30的员工的最高薪水<br> SELECT MAX(sal) FROM emp WHERE deptno = 30<br> #第二步就是把员工表和部门表联合然后薪水的条件大于上面的SQL语句的薪水<br> SELECT emp.ename,emp.sal,dept.dname FROM emp JOIN<br> dept ON emp.deptno=dept.deptno<br> WHERE sal &gt; (SELECT MAX(sal) FROM emp WHERE deptno = 30)</p> 
<p>±----------±--------±-------------+<br> | ename | sal | dname |<br> ±----------±--------±-------------+<br> | 李武 | 2975.00 | 开发部门 |<br> | 爱丽丝 | 3000.00 | 开发部门 |<br> | 哪吒 | 5000.00 | 后勤部门 |<br> | 猴子 | 3000.00 | 开发部门 |<br> ±----------±--------±-------------+</p> 
<h3><a id="26_623"></a>26、列出在每个部门工作的员工数量，平均工资和平均服务期限</h3> 
<p>#第一步先按部门编号分组去找出平均工资和员工数量，因为有的部门是没有员工的<br> SELECT dept.deptno,COUNT(emp.ename),IFNULL(AVG(sal),0)AS ‘平均工资’ ,<br> IFNULL(((TO_DAYS(now())-TO_DAYS(emp.hiredate))/365),0) AS ‘平均服务期限’<br> FROM emp<br> RIGHT JOIN dept<br> ON emp.deptno=dept.deptno<br> GROUP BY dept.deptno<br> #总结：这里用到了ifNull(A,B)是用来判断如果A为空，就会把值设置为B<br> #TO_days(A)是把时间转换为天数的函数</p> 
<p>±-------±-----------------±-------------±-------------------+<br> | deptno | COUNT(emp.ename) | 平均工资 | 平均服务期限 |<br> ±-------±-----------------±-------------±-------------------+<br> | 10 | 3 | 2800.000000 | 37.4192 |<br> | 20 | 5 | 2175.000000 | 37.8959 |<br> | 30 | 6 | 1566.666667 | 37.7178 |<br> | 40 | 0 | 0.000000 | 0.0000 |<br> ±-------±-----------------±-------------±-------------------+</p> 
<h3><a id="27_644"></a>27、列出所有员工的姓名、部门名称、工资</h3> 
<p>#这个有点太简单了直接就能写出来了<br> SELECT emp.ename,emp.sal ,dept.dname FROM emp JOIN dept ON emp.deptno=dept.deptno</p> 
<p>±----------±--------±-------------+<br> | ename | sal | dname |<br> ±----------±--------±-------------+<br> | 张三 | 800.00 | 开发部门 |<br> | 李四 | 1600.00 | 销售部门 |<br> | 王二 | 1250.00 | 销售部门 |<br> | 李武 | 2975.00 | 开发部门 |<br> | 周六 | 1250.00 | 销售部门 |<br> | 刘振 | 2850.00 | 销售部门 |<br> | 曹阳 | 2450.00 | 后勤部门 |<br> | 爱丽丝 | 3000.00 | 开发部门 |<br> | 哪吒 | 5000.00 | 后勤部门 |<br> | 赵云 | 1500.00 | 销售部门 |<br> | 妲己 | 1100.00 | 开发部门 |<br> | 刘备 | 950.00 | 销售部门 |<br> | 猴子 | 3000.00 | 开发部门 |<br> | 安其拉 | 950.00 | 后勤部门 |<br> ±----------±--------±-------------+</p> 
<h3><a id="28_666"></a>28、列出所有部门的详细信息和人数</h3> 
<p>#首先思路就是直接按照部门编号进行分组，然后对需要考虑到左联或者右联接<br> SELECT dept.* ,COUNT(emp.ename)AS ‘部门人数’ FROM dept LEFT JOIN emp ON emp.deptno=dept.deptno<br> GROUP BY dept.deptno<br> ±-------±-------------±---------±-------------+<br> | deptno | dname | loc | 部门人数 |<br> ±-------±-------------±---------±-------------+<br> | 10 | 后勤部门 | NEW YORK | 3 |<br> | 20 | 开发部门 | DALLAS | 5 |<br> | 30 | 销售部门 | CHICAGO | 6 |<br> | 40 | 推广部门 | BOSTON | 0 |<br> ±-------±-------------±---------±-------------+</p> 
<h3><a id="29_678"></a>29、列出各种工作的最低工资以及从事此工作的雇员姓名</h3> 
<p>SELECT MIN(emp.sal),ename,job FROM emp GROUP BY job ORDER BY sal<br> ±-------------±----------±----------+<br> | MIN(emp.sal) | ename | job |<br> ±-------------±----------±----------+<br> | 800.00 | 张三 | CLERK |<br> | 1250.00 | 李四 | SALESMAN |<br> | 2450.00 | 李武 | MANAGER |<br> | 3000.00 | 爱丽丝 | ANALYST |<br> | 5000.00 | 哪吒 | PRESIDENT |<br> ±-------------±----------±----------+</p> 
<h3><a id="30manager_690"></a>30、列出各个部门的manager的最低薪金</h3> 
<p>SELECT deptno,MIN(sal ) FROM emp WHERE job = ‘MANAGER’ GROUP BY deptno<br> ±-------±----------+<br> | deptno | MIN(sal ) |<br> ±-------±----------+<br> | 10 | 2450.00 |<br> | 20 | 2975.00 |<br> | 30 | 2850.00 |<br> ±-------±----------+</p> 
<h3><a id="31_699"></a>31、列出员工的年工资，按年薪从低到高排序</h3> 
<p>SELECT (sal*12) AS total ,emp.ename FROM emp ORDER BY total<br> ±---------±----------+<br> | total | ename |<br> ±---------±----------+<br> | 9600.00 | 张三 |<br> | 11400.00 | 刘备 |<br> | 11400.00 | 安其拉 |<br> | 13200.00 | 妲己 |<br> | 15000.00 | 王二 |<br> | 15000.00 | 周六 |<br> | 18000.00 | 赵云 |<br> | 19200.00 | 李四 |<br> | 29400.00 | 曹阳 |<br> | 34200.00 | 刘振 |<br> | 35700.00 | 李武 |<br> | 36000.00 | 爱丽丝 |<br> | 36000.00 | 猴子 |<br> | 60000.00 | 哪吒 |<br> ±---------±----------+</p> 
<h3><a id="323000_720"></a>32、求出员工领导的薪水超过3000的员工名称与领导姓名</h3> 
<p>SELECT a.ename AS ‘员工名称’,b.ename AS ‘领导姓名’ ,b.sal<br> FROM emp AS a JOIN emp AS b ON a.mgr=b.empno WHERE b.sal&gt;3000<br> ±-------------±-------------±--------+<br> | 员工名称 | 领导姓名 | sal |<br> ±-------------±-------------±--------+<br> | 李武 | 哪吒 | 5000.00 |<br> | 刘振 | 哪吒 | 5000.00 |<br> | 曹阳 | 哪吒 | 5000.00 |<br> ±-------------±-------------±--------+</p> 
<h3><a id="33s_730"></a>33、求出部门名称中，带有‘s’字符的部门员工的工资合计、部门人数</h3> 
<p>#第一步先把部门表和员工表进行连接，需要注意当部门编号为40的时候是没有员工的，<br> #然后按照员工编号进行分组<br> SELECT IFNULL(SUM(emp.sal),0),COUNT(emp.empno) FROM dept LEFT JOIN emp<br> ON dept.deptno=emp.deptno GROUP BY dept.deptno<br> #第二步因为说把含有“s”字符的部门员工都统计到，需要在上面的基础上加上like限定<br> SELECT dept.deptno, IFNULL(SUM(emp.sal),0),COUNT(emp.ename)<br> FROM dept LEFT JOIN emp<br> ON dept.deptno=emp.deptno<br> WHERE dept.dname LIKE ‘%部%’<br> GROUP BY dept.deptno<br> ±-------±-----------------------±-----------------+<br> | deptno | IFNULL(SUM(emp.sal),0) | COUNT(emp.ename) |<br> ±-------±-----------------------±-----------------+<br> | 10 | 8400.00 | 3 |<br> | 20 | 10875.00 | 5 |<br> | 30 | 9400.00 | 6 |<br> | 40 | 0.00 | 0 |<br> ±-------±-----------------------±-----------------+</p> 
<h3><a id="343510_749"></a>34、给任职日期超过35年的员工加薪10%</h3> 
<p>CREATE TABLE emp_bak AS SELECT * FROM emp</p> 
<p>UPDATE emp_bak SET sal = sal*1.1<br> WHERE (TO_DAYS(NOW())-(TO_DAYS(hiredate)))/365 &gt; 30</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5eb51dbd70d234ca80b0b6ec83971645/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Go语言解析时间并计算时间差</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/17e7ffd80ead02303d58f1c31536011d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Docker容器跨主机通讯的几种方式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>