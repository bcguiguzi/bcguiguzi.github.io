<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2021年10月30日 axios请求的端口号与设置的端口号不同 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2021年10月30日 axios请求的端口号与设置的端口号不同" />
<meta property="og:description" content="Vue&#43;SpringBoot项目
axios请求地址错误 全部都是404 请求了错误的网址
正确的那个请求也是axios，不过是写在.vue中的请求
getXianCha() { this.$http({ method: &#34;post&#34;, url: &#34;/der/milkTea/queryByXianCha&#34;, }).then( (res) =&gt; { // this.$message.warning(JSON.stringify(res.data)); this.result = res.data; }, (error) =&gt; { console.log(&#34; request error : &#34; &#43; error.response.status); } ); }, 返回的状态码是200 是正确的
错误的请求是写在store/index.js里的
state: { materialsState: [ { index: 1, value: &#34;pearl&#34;, text: &#34;珍珠&#34;, }, ], sugerStates: [ { index: 1, value: &#34;normal&#34;, text: &#34;正常糖&#34;, }, ], temperatureState: [ { index: 4, value: &#34;hot&#34;, text: &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/8bf484b325a876c8da992d76ba1238a8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-30T14:16:34+08:00" />
<meta property="article:modified_time" content="2021-10-30T14:16:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2021年10月30日 axios请求的端口号与设置的端口号不同</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>Vue+SpringBoot项目<br> axios请求地址错误 全部都是404 请求了错误的网址<br> <img src="https://images2.imgbox.com/a2/a6/KDFqslDl_o.png" alt="页面请求情况">正确的那个请求也是axios，不过是写在.vue中的请求</p> 
<pre><code class="prism language-html">getXianCha() {
      this.$http({
        method: "post",
        url: "/der/milkTea/queryByXianCha",
      }).then(
        (res) =&gt; {
          // this.$message.warning(JSON.stringify(res.data));
          this.result = res.data;
        },
        (error) =&gt; {
          console.log(" request error : " + error.response.status);
        }
      );
    },
   
</code></pre> 
<p>返回的状态码是200 是正确的<br> 错误的请求是写在store/index.js里的</p> 
<pre><code class="prism language-html">state: {
    materialsState: [
      {
        index: 1,
        value: "pearl",
        text: "珍珠",
      },
    ],
    sugerStates: [
      {
        index: 1,
        value: "normal",
        text: "正常糖",
      },
    ],
    temperatureState: [
      {
        index: 4,
        value: "hot",
        text: "热",
      },
    ],
  },
  mutations: {
    updateMaterialsState(state, payload) {
      state.materialsState = payload;
    },
    updateSugerStates(state, payload) {
      state.sugerStates = payload;
    },
    updateTemperatureState(state, payload) {
      state.temperatureState = payload;
    },
  },
  actions: {
    getMaterialsState(context) {
      //this.$http  this.$message
      axios({
        method: "get",
        url: "/der/common/materialsState",

      }).then(
        (res) =&gt; {
          // Message.warning(JSON.stringify(res.data));
          context.commit("updateMaterialsState", res.data);
        },
        (error) =&gt; {
          console.log(" request error : " + error.response.status);
        }
      );
    },
    getSugerStates(context) {
      //this.$http  this.$message
      axios({
        method: "get",
        url: "/der/common/sugerState",
      }).then(
        (res) =&gt; {
          // Message.warning(JSON.stringify(res.data));
          context.commit("updateSugerStates", res.data);
        },
        (error) =&gt; {
          console.log(" request error : " + error.response.status);
        }
      );
    },
    getTemperatureState(context) {
      //this.$http  this.$message
      axios({
        method: "get",
        url: "/der/common/temperatureState",
      }).then(
        (res) =&gt; {
          // Message.warning(JSON.stringify(res.data));
          context.commit("updateTemperatureState", res.data);
        },
        (error) =&gt; {
          console.log(" request error : " + error.response.status);
        }
      );
    },
  },
  modules: {},
});

</code></pre> 
<p>后端接口用swagger测试过了 没有任何问题<br> 前端端口是8090 后端是9090<br> 在Vue的根app组件里调用请求</p> 
<pre><code class="prism language-html">created() {
    this.$store.dispatch("getMaterialsState");
    this.$store.dispatch("getTemperatureState");
    this.$store.dispatch("getSugerStates");
  },
</code></pre> 
<p>然后就发生了图一的情况<br> 现在没有解决 等到周一问一下老师<br> 我问完老师了 老师说<br> 我在axios里面写的请求是对的，但是引入的axios是原生的axios没有经过任何配置，所以axios发请求的时候用的是默认的前端端口。<br> 在axios的配置文件中看一下src/plugins/axios.js</p> 
<pre><code class="prism language-html">"use strict";

import Vue from "vue";
import axios from "axios";
import { Message, Notification } from "element-ui";

// Full config:  https://github.com/axios/axios#request-config
// axios.defaults.baseURL = process.env.baseURL || process.env.apiUrl || '';
// axios.defaults.headers.common['Authorization'] = AUTH_TOKEN;
// axios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';

let config = {
  // baseURL: process.env.baseURL || process.env.apiUrl || ""
  baseURL: "http://localhost:8080",
  timeout: 60 * 1000, // Timeout
  withCredentials: true, // Check cross-site Access-Control
};

const _axios = axios.create(config);

_axios.interceptors.request.use(
  function (config) {
    // Do something before request is sent
    Message.success("将要发送请求内容  " + JSON.stringify(config.data));
    return config;
  },
  function (error) {
    // Do something with request error
    return Promise.reject(error);
  }
);

// Add a response interceptor
_axios.interceptors.response.use(
  function (response) {
    // Do something with response data
    return response;
  },

  function (error) {
    // Do something with response error
    if (error &amp;&amp; error.response) {
      switch (error.response.state) {
        case 701:
          Message.error("异常" + error.response.data);
          break;
        case 731:
          Notification.warning("通知" + error.response.data);
          break;
        case 1024:
          Message.error("未知异常" + error.response.data);
          break;
        default:
      }
    }
    return Promise.reject(error);
  }
);

Plugin.install = function (Vue, options) {
  Vue.axios = _axios;
  window.axios = _axios;
  Object.defineProperties(Vue.prototype, {
    axios: {
      get() {
        return _axios;
      },
    },
    $axios: {
      get() {
        return _axios;
      },
    },
    $http: {
      get() {
        return _axios;
      },
    },
  });
};

Vue.use(Plugin);

export default Plugin;

</code></pre> 
<p>这个配置文件中的 axios是已经配置好的axios，所以只要在store/index.js中的axios请求前加上windos. 就ok了<br> <img src="https://images2.imgbox.com/4f/10/37tMl0V6_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c01a97c73c8049a432a154ede5e2e5dd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">求定制闲鱼爬虫获取最新发布商品</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8511673a5965c82fc4165aa5d54089dd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java反射机制</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>