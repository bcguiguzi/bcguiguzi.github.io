<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>å¦‚ä½•åˆ©ç”¨æç‹GitLab è½»æ¾ç®¡ç†NPMä¾èµ–å‘å¸ƒä¸æ›´æ–°ï¼Ÿ - ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="å¦‚ä½•åˆ©ç”¨æç‹GitLab è½»æ¾ç®¡ç†NPMä¾èµ–å‘å¸ƒä¸æ›´æ–°ï¼Ÿ" />
<meta property="og:description" content="æœ¬æ–‡æ¥è‡ªï¼š
ä»»æ²»æ¡ æç‹(GitLab)Â å‰ç«¯å·¥ç¨‹å¸ˆ
NPM æ˜¯ Node.js çš„åŒ…ç®¡ç†å·¥å…·ï¼Œç”¨æ¥å®‰è£…å„ç§ Node.js çš„æ‰©å±•ã€‚æœ¬æ–‡å°†åˆ†äº«å¦‚ä½•é€šè¿‡æç‹GitLabï¼Œè®© NPM ä¾èµ–å‘å¸ƒæ›´æ–°æ›´åŠ å¿«é€Ÿå’Œè‡ªåŠ¨åŒ–ï¼Œè®©ä½ è½»æ¾ç®¡ç†ä¾èµ–ï¼Œæ‹¥æœ‰æ›´å¤šæ—¶é—´ä¸“æ³¨äºæ ¸å¿ƒå·¥ä½œï¼
å°‘å¹´å°æ˜ä¹‹çƒ¦æ¼ åœ¨å¼€å‘å›¢é˜Ÿæ—¥å¸¸å·¥ä½œä¸­ï¼Œä¸å¯é¿å…çš„ä¼šä¾èµ–å¤§é‡ç¬¬ä¸‰æ–¹æ¨¡å—ï¼›åŒæ—¶ï¼Œå›¢é˜Ÿå†…éƒ¨ä¹Ÿä¼šå‘å¸ƒä¸€äº›å…¬å…±æ¨¡å—åˆ°å†…éƒ¨æˆ–å¤–éƒ¨æºä¸­ï¼Œæ–¹ä¾¿è·¨å›¢é˜Ÿå¤ç”¨ã€‚ä½†å¾€å¾€ä¼šé‡åˆ°å’Œå°æ˜ä¸€æ ·çš„çƒ¦æ¼ã€‚
å°æ˜åŒå­¦è´Ÿè´£å†…éƒ¨å…¬å…±Â NPMÂ æ¨¡å—å‘å¸ƒå’Œå‡çº§å·¥ä½œã€‚ä»–æ¯å¤©çš„å·¥ä½œæ˜¯è¿™æ ·çš„ï¼š
1.Â å¼€å‘åŒå­¦é€šçŸ¥å°æ˜æŸä¸ªå…¬å…±æ¨¡å—ä»£ç æœ‰æ›´æ–°ï¼›
2.Â å°æ˜æ‰“åŒ…å†…éƒ¨å…¬å…±æ¨¡å—ï¼›
3.Â å‘å¸ƒåˆ°Â NPMÂ æºï¼›
4.Â åœ¨å¼€å‘ç¾¤é‡Œé€šçŸ¥å„ä¸ªå›¢é˜Ÿå‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚
æ¸æ¸çš„ï¼Œæ¯ä¸ªå›¢é˜Ÿéƒ½è¢«ç¹çå°äº‹ç¼ èº«ï¼Œä½æ•ˆï¼š
å¼€å‘åŒå­¦éœ€è¦ç»å¸¸æ£€æŸ¥ä¾èµ–çš„Â NPMÂ æ¨¡å—æ˜¯å¦æœ‰æ›´æ–°ï¼›
å…¬å…±æ¨¡å—çš„ç»´æŠ¤åŒå­¦æ›´æ–°ä»£ç åéœ€è¦å†³å®šæ˜¯å¦å‘å¸ƒç‰ˆæœ¬ï¼›
ç‰ˆæœ¬æ›´æ–°åè¿˜éœ€è¦é€šçŸ¥å„ä¸ªå›¢é˜Ÿï¼›
å„ä¸ªå›¢é˜Ÿè¿˜æ˜¯å®¹æ˜“å‡ºç°æ›´æ–°ä¸åŠæ—¶ã€å®¹æ˜“é—æ¼ç­‰é—®é¢˜ã€‚
ç»ˆäºæœ‰ä¸€å¤©ï¼Œå°æ˜åŒå­¦çµæœºä¸€åŠ¨ï¼šå¦‚æœä»¥åæ›´æ–°å…¬å…±æ¨¡å—ä»£ç èƒ½å¤Ÿæ ¹æ®ä¸€å®šè§„åˆ™ï¼Œè‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·â†’è‡ªåŠ¨å‘å¸ƒæ—¥å¿—â†’è‡ªåŠ¨å‘å¸ƒåˆ°Â NPMÂ æºâ†’è‡ªåŠ¨å°†å…¬å¸å†…æ‰€æœ‰ä¾èµ–è¯¥æ¨¡å—çš„ä»£ç åº“æ›´æ–°ä¸ºæœ€æ–°ç‰ˆæœ¬ï¼Œå²‚ä¸ä¹å“‰ï¼Ÿ
ç»è¿‡ä¸€ç•ªæ¢ç´¢ï¼Œå°æ˜å‘ç°ï¼Œé€šè¿‡æç‹GitLab CI å’Œç¬¬ä¸‰æ–¹å·¥å…·ç»“åˆï¼Œå°±å¯ä»¥è¾¾åˆ°ç›®çš„ã€‚ä¸€èµ·å®è·µå§ï¼
NPM è‡ªåŠ¨å‘å¸ƒ-æ“ä½œæŒ‡å— æˆ‘ä»¬çŸ¥é“ï¼ŒNPMÂ åŒ…ç‰ˆæœ¬è§„èŒƒä¸ºÂ Semantic VersioningÂ ï¼Œå³ä¸ºÂ major.minor.patchÂ æ ¼å¼æ•°å­—ç»„æˆã€‚
é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥è¯†åˆ«å¼€å‘äººå‘˜çš„Â git commit messageÂ ï¼Œé€šè¿‡å¯¹æäº¤ä¿¡æ¯è¿›è¡Œå½¢å¼åŒ–çº¦å®šï¼Œå°±å¯ä»¥è‡ªåŠ¨ç”Ÿæˆæ–°çš„ç¬¦åˆ Semantic Versioning çš„ç‰ˆæœ¬å·ã€‚ç„¶åï¼Œå°†æ–°ç‰ˆæœ¬å·æ›´æ–°åˆ°æˆ‘ä»¬çš„Â package.jsonÂ æ–‡ä»¶ä¸­ï¼Œæœ€åå‘å¸ƒåˆ° NPM æºä¸­å³å¯ã€‚
commitlint é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡Â commitlintÂ æˆ–ç±»ä¼¼å·¥å…·ï¼Œå¼ºåˆ¶è§„èŒƒåŒ–å›¢é˜Ÿçš„Â git commit messageÂ ï¼Œé€šè¿‡å¦‚ä¸‹å‘½ä»¤å°†Â commitlintÂ å®‰è£…åˆ°é¡¹ç›®ä¸­ï¼š" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/350e1a9a5c6a13e4d66cec9a5d9905b0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-17T18:50:57+08:00" />
<meta property="article:modified_time" content="2023-01-17T18:50:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">å¦‚ä½•åˆ©ç”¨æç‹GitLab è½»æ¾ç®¡ç†NPMä¾èµ–å‘å¸ƒä¸æ›´æ–°ï¼Ÿ</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p><strong>æœ¬æ–‡æ¥è‡ªï¼š</strong></p> 
 <p>ä»»æ²»æ¡ æç‹(GitLab)Â  å‰ç«¯å·¥ç¨‹å¸ˆ</p> 
</blockquote> 
<p></p> 
<p>NPM æ˜¯ Node.js çš„åŒ…ç®¡ç†å·¥å…·ï¼Œç”¨æ¥å®‰è£…å„ç§ Node.js çš„æ‰©å±•ã€‚æœ¬æ–‡å°†åˆ†äº«å¦‚ä½•é€šè¿‡æç‹GitLabï¼Œè®© NPM ä¾èµ–å‘å¸ƒæ›´æ–°æ›´åŠ å¿«é€Ÿå’Œè‡ªåŠ¨åŒ–ï¼Œè®©ä½ è½»æ¾ç®¡ç†ä¾èµ–ï¼Œæ‹¥æœ‰æ›´å¤šæ—¶é—´ä¸“æ³¨äºæ ¸å¿ƒå·¥ä½œï¼</p> 
<p></p> 
<h2><strong>å°‘å¹´å°æ˜ä¹‹çƒ¦æ¼</strong></h2> 
<hr> 
<p>åœ¨å¼€å‘å›¢é˜Ÿæ—¥å¸¸å·¥ä½œä¸­ï¼Œä¸å¯é¿å…çš„ä¼šä¾èµ–å¤§é‡ç¬¬ä¸‰æ–¹æ¨¡å—ï¼›åŒæ—¶ï¼Œå›¢é˜Ÿå†…éƒ¨ä¹Ÿä¼šå‘å¸ƒä¸€äº›å…¬å…±æ¨¡å—åˆ°å†…éƒ¨æˆ–å¤–éƒ¨æºä¸­ï¼Œæ–¹ä¾¿è·¨å›¢é˜Ÿå¤ç”¨ã€‚ä½†å¾€å¾€ä¼šé‡åˆ°å’Œå°æ˜ä¸€æ ·çš„çƒ¦æ¼ã€‚</p> 
<p></p> 
<p>å°æ˜åŒå­¦è´Ÿè´£å†…éƒ¨å…¬å…±Â NPMÂ æ¨¡å—å‘å¸ƒå’Œå‡çº§å·¥ä½œã€‚ä»–æ¯å¤©çš„å·¥ä½œæ˜¯è¿™æ ·çš„ï¼š</p> 
<p></p> 
<p><strong>1.</strong>Â å¼€å‘åŒå­¦é€šçŸ¥å°æ˜æŸä¸ªå…¬å…±æ¨¡å—ä»£ç æœ‰æ›´æ–°ï¼›</p> 
<p><strong>2.</strong>Â å°æ˜æ‰“åŒ…å†…éƒ¨å…¬å…±æ¨¡å—ï¼›</p> 
<p><strong>3.</strong>Â å‘å¸ƒåˆ°Â NPMÂ æºï¼›</p> 
<p><strong>4.</strong>Â åœ¨å¼€å‘ç¾¤é‡Œé€šçŸ¥å„ä¸ªå›¢é˜Ÿå‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/ca/ff/HdSXBDpO_o.png"></p> 
<p></p> 
<p>æ¸æ¸çš„ï¼Œæ¯ä¸ªå›¢é˜Ÿéƒ½è¢«ç¹çå°äº‹ç¼ èº«ï¼Œä½æ•ˆï¼š</p> 
<p></p> 
<ul><li> <p>å¼€å‘åŒå­¦éœ€è¦ç»å¸¸æ£€æŸ¥ä¾èµ–çš„Â NPMÂ æ¨¡å—æ˜¯å¦æœ‰æ›´æ–°ï¼›</p> </li><li> <p>å…¬å…±æ¨¡å—çš„ç»´æŠ¤åŒå­¦æ›´æ–°ä»£ç åéœ€è¦å†³å®šæ˜¯å¦å‘å¸ƒç‰ˆæœ¬ï¼›</p> </li><li> <p>ç‰ˆæœ¬æ›´æ–°åè¿˜éœ€è¦é€šçŸ¥å„ä¸ªå›¢é˜Ÿï¼›</p> </li><li> <p>å„ä¸ªå›¢é˜Ÿè¿˜æ˜¯å®¹æ˜“å‡ºç°æ›´æ–°ä¸åŠæ—¶ã€å®¹æ˜“é—æ¼ç­‰é—®é¢˜ã€‚</p> </li></ul> 
<p></p> 
<p>ç»ˆäºæœ‰ä¸€å¤©ï¼Œå°æ˜åŒå­¦çµæœºä¸€åŠ¨ï¼š<strong>å¦‚æœä»¥åæ›´æ–°å…¬å…±æ¨¡å—ä»£ç èƒ½å¤Ÿæ ¹æ®ä¸€å®šè§„åˆ™ï¼Œè‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·â†’è‡ªåŠ¨å‘å¸ƒæ—¥å¿—â†’è‡ªåŠ¨å‘å¸ƒåˆ°Â NPMÂ æºâ†’è‡ªåŠ¨å°†å…¬å¸å†…æ‰€æœ‰ä¾èµ–è¯¥æ¨¡å—çš„ä»£ç åº“æ›´æ–°ä¸ºæœ€æ–°ç‰ˆæœ¬ï¼Œå²‚ä¸ä¹å“‰ï¼Ÿ</strong></p> 
<p></p> 
<p>ç»è¿‡ä¸€ç•ªæ¢ç´¢ï¼Œå°æ˜å‘ç°ï¼Œé€šè¿‡æç‹GitLab CI å’Œç¬¬ä¸‰æ–¹å·¥å…·ç»“åˆï¼Œå°±å¯ä»¥è¾¾åˆ°ç›®çš„ã€‚ä¸€èµ·å®è·µå§ï¼</p> 
<p></p> 
<h2><strong>NPM è‡ªåŠ¨å‘å¸ƒ-æ“ä½œæŒ‡å—</strong></h2> 
<hr> 
<p>æˆ‘ä»¬çŸ¥é“ï¼ŒNPMÂ åŒ…ç‰ˆæœ¬è§„èŒƒä¸ºÂ <a class="link-info" href="https://semver.org/" rel="nofollow" title="Semantic Versioning">Semantic Versioning</a>Â ï¼Œå³ä¸ºÂ major.minor.patchÂ æ ¼å¼æ•°å­—ç»„æˆã€‚</p> 
<p></p> 
<p>é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥è¯†åˆ«å¼€å‘äººå‘˜çš„Â git commit messageÂ ï¼Œé€šè¿‡å¯¹æäº¤ä¿¡æ¯è¿›è¡Œå½¢å¼åŒ–çº¦å®šï¼Œå°±å¯ä»¥è‡ªåŠ¨ç”Ÿæˆæ–°çš„ç¬¦åˆ Semantic Versioning çš„ç‰ˆæœ¬å·ã€‚ç„¶åï¼Œå°†æ–°ç‰ˆæœ¬å·æ›´æ–°åˆ°æˆ‘ä»¬çš„Â package.jsonÂ æ–‡ä»¶ä¸­ï¼Œæœ€åå‘å¸ƒåˆ° NPM æºä¸­å³å¯ã€‚</p> 
<p></p> 
<h4><strong>commitlint</strong></h4> 
<p></p> 
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡Â <a class="link-info" href="https://commitlint.js.org/#/" rel="nofollow" title="commitlint">commitlint</a>Â æˆ–ç±»ä¼¼å·¥å…·ï¼Œå¼ºåˆ¶è§„èŒƒåŒ–å›¢é˜Ÿçš„Â git commit messageÂ ï¼Œé€šè¿‡å¦‚ä¸‹å‘½ä»¤å°†Â commitlintÂ å®‰è£…åˆ°é¡¹ç›®ä¸­ï¼š</p> 
<p></p> 
<pre><code class="language-bash">yarnÂ addÂ --devÂ @commitlint/cliÂ @commitlint/config-conventional

#Â è®¾ç½®Â commitlintÂ é…ç½®æ–‡ä»¶ä½¿ç”¨Â conventionalÂ config
echoÂ "module.exportsÂ =Â {Â extends:Â ['@commitlint/config-conventional']Â };"Â &gt;Â commitlint.config.js
</code></pre> 
<p></p> 
<p></p> 
<p>æˆ‘ä»¬é‡‡ç”¨Â @commitlint/config-conventionalÂ ä½œä¸ºå¸¸è§„é…ç½®ï¼Œå®ƒé»˜è®¤é‡‡ç”¨Â <a class="link-info" href="https://github.com/angular/angular/blob/main/CONTRIBUTING.md#-commit-message-format" title="Angular Commit Message">Angular Commit Message</a>Â è§„èŒƒï¼Œä¹Ÿå¯è‡ªè¡Œä¿®æ”¹ã€‚é»˜è®¤Â git commit messageÂ æ ¼å¼å¦‚ä¸‹ï¼š</p> 
<p></p> 
<pre><code class="language-bash">&lt;type&gt;(&lt;scope&gt;):Â &lt;shortÂ summary&gt;Â 
Â Â â”‚
Â Â â””â”€â«¸Â å¯é€‰ç±»å‹:Â build|ci|docs|feat|fix|perf|refactor|test|chore
</code></pre> 
<p></p> 
<p></p> 
<h4><strong>æµæ°´çº¿é…ç½®</strong></h4> 
<p></p> 
<p>ä¹‹åï¼Œéœ€è¦åœ¨æç‹GitLab CI æµæ°´çº¿ä¸­æ‰§è¡ŒÂ commitlintÂ ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªÂ .gitlab-ci.ymlÂ æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p> 
<p></p> 
<pre><code class="language-bash">#Â .gitlab-ci.yml

stages:
Â Â -Â lint

workflow:
Â Â rules:
Â Â Â Â -Â if:Â $CI_MERGE_REQUEST_IID
Â Â Â Â -Â if:Â $CI_COMMIT_TAG
Â Â Â Â -Â if:Â $CI_COMMIT_BRANCHÂ ==Â $CI_DEFAULT_BRANCH

default:
Â Â image:Â node:16
Â Â cache:
Â Â Â Â paths:
Â Â Â Â Â Â -Â node_modules/
Â Â Â Â Â Â -Â .yarn

.yarn_install:
Â Â before_script:
Â Â Â Â -Â yarnÂ installÂ --frozen-lockfileÂ --check-filesÂ --cache-folderÂ .yarn

lint:commit:
Â Â extends:Â .yarn_install
Â Â stage:Â lint
Â Â rules:
Â Â Â Â -Â if:Â '$CI_PIPELINE_SOURCEÂ ==Â "merge_request_event"'
Â Â script:
Â Â Â Â -Â yarnÂ commitlintÂ --fromÂ ${CI_MERGE_REQUEST_DIFF_BASE_SHA}Â --toÂ HEADÂ --verbose
</code></pre> 
<p></p> 
<p></p> 
<p><strong>å¦‚æœæœ‰ä¸ç¬¦åˆ</strong>Â <strong>commitlintÂ è§„èŒƒçš„Â git commit message</strong>ï¼Œ<strong>æç‹GitLab CI å°±ä¼šé˜»æ­¢è¯¥</strong>Â MRÂ <strong>åˆå…¥</strong>ã€‚</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/2d/a8/4p5ipcVp_o.png"></p> 
<p></p> 
<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±æ‹¥æœ‰äº†ç¬¦åˆçº¦å®šçš„æäº¤ä¿¡æ¯ã€‚</p> 
<p></p> 
<h4><strong>semantic-release</strong></h4> 
<p></p> 
<p><a class="link-info" href="https://semantic-release.gitbook.io/semantic-release/" rel="nofollow" title="Semantic-release">Semantic-release</a>Â æ˜¯ä¸€ä¸ªå¯ä»¥æ ¹æ®çº¦å®šæäº¤ä¿¡æ¯ç±»å‹ç”Ÿæˆæ–°ç‰ˆæœ¬å·ã€æç‹GitLab Changelogï¼Œè¿˜æä¾›äº†å¤§é‡æ’ä»¶ç”¨äºå‘å¸ƒÂ NPMÂ çš„å·¥å…·ã€‚</p> 
<p></p> 
<p>é¦–å…ˆå®‰è£…Â semantic-releaseÂ åˆ°æˆ‘ä»¬çš„é¡¹ç›®ï¼š</p> 
<p></p> 
<pre><code>yarnÂ addÂ --devÂ semantic-release
</code></pre> 
<p></p> 
<p></p> 
<p>ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜æƒ³åŒæ­¥Â publishÂ åˆ°Â NPMÂ æºï¼Œæ¥ç€å°†æ›´æ–°çš„ç‰ˆæœ¬å·æ¨é€åˆ°ä¸»åˆ†æ”¯ï¼Œæœ€ååˆ›å»ºæç‹GitLab Changelogã€‚æ‰€ä»¥è¿˜éœ€è¦å®‰è£…å¦‚ä¸‹Â semantic-release plugins:</p> 
<p></p> 
<pre><code>yarnÂ addÂ --devÂ @semantic-release/changelogÂ @semantic-release/gitÂ @semantic-release/gitlab
</code></pre> 
<p></p> 
<blockquote> 
 <p>ç”±äº @semantic-release/npm æ’ä»¶å·²ç»æ˜¯Â semantic-releaseÂ çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥ä¸éœ€è¦å•ç‹¬å®‰è£…ï¼Œå‚è§<a class="link-info" href="https://semantic-release.gitbook.io/semantic-release/usage/plugins#default-plugins" rel="nofollow" title="æ–‡æ¡£">æ–‡æ¡£</a>Â ã€‚</p> 
</blockquote> 
<p></p> 
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯</strong>ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€é’ˆå¯¹ä¸»åˆ†æ”¯æµæ°´çº¿æ‰§è¡Œï¼š</p> 
<p></p> 
<ul><li> <p>æ›´æ–°Â package.jsonÂ ç‰ˆæœ¬å·ï¼›</p> </li><li> <p>æ¨é€Â NPMÂ æºï¼›</p> </li><li> <p>ç”ŸæˆÂ changelogã€‚</p> </li></ul> 
<p></p> 
<p>è€Œåœ¨Â MRÂ æµæ°´çº¿ä¸­ï¼Œæˆ‘ä»¬åªéœ€ç¡®ä¿èƒ½å¤Ÿæ­£å¸¸ç”ŸæˆÂ changelogÂ å³å¯ã€‚ä¸ºæ­¤ï¼Œé’ˆå¯¹Â MRÂ æ‰§è¡ŒÂ --dry-runÂ æ¨¡å¼ï¼Œç„¶ååœ¨Â semantic-releaseÂ é…ç½®æ–‡ä»¶ä¸­åŒºåˆ†æ‰§è¡Œæ­¥éª¤ã€‚</p> 
<p></p> 
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„æäº¤ä¿¡æ¯ä¼šæŒ‰ç…§å¦‚ä¸‹è§„åˆ™æ›´æ–°ç‰ˆæœ¬å·ï¼š</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/ae/9f/HHQo7aqk_o.png"></p> 
<p></p> 
<p>å®Œæ•´çš„åŒ¹é…è§„åˆ™å‚è§Â <a class="link-info" href="https://github.com/semantic-release/commit-analyzer/blob/9b1c9500c4bcea6f268c24be19c9c9c1576bf93c/lib/default-release-rules.js" title="default-release-rules.js">default-release-rules.js</a>Â ï¼š</p> 
<p></p> 
<pre><code class="language-bash">/**
Â *Â DefaultÂ `releaseRules`Â rulesÂ forÂ commonÂ commitÂ formats,Â followingÂ conventions.
Â *
Â *Â @typeÂ {Array}
Â */
module.exportsÂ =Â [
Â Â {breaking:Â true,Â release:Â 'major'},
Â Â {revert:Â true,Â release:Â 'patch'},
Â Â //Â Angular
Â Â {type:Â 'feat',Â release:Â 'minor'},
Â Â {type:Â 'fix',Â release:Â 'patch'},
Â Â {type:Â 'perf',Â release:Â 'patch'},
Â Â //Â Atom
Â Â {emoji:Â ':racehorse:',Â release:Â 'patch'},
Â Â {emoji:Â ':bug:',Â release:Â 'patch'},
Â Â {emoji:Â ':penguin:',Â release:Â 'patch'},
Â Â {emoji:Â ':apple:',Â release:Â 'patch'},
Â Â {emoji:Â ':checkered_flag:',Â release:Â 'patch'},
Â Â //Â Ember
Â Â {tag:Â 'BUGFIX',Â release:Â 'patch'},
Â Â {tag:Â 'FEATURE',Â release:Â 'minor'},
Â Â {tag:Â 'SECURITY',Â release:Â 'patch'},
Â Â //Â ESLint
Â Â {tag:Â 'Breaking',Â release:Â 'major'},
Â Â {tag:Â 'Fix',Â release:Â 'patch'},
Â Â {tag:Â 'Update',Â release:Â 'minor'},
Â Â {tag:Â 'New',Â release:Â 'minor'},
Â Â //Â Express
Â Â {component:Â 'perf',Â release:Â 'patch'},
Â Â {component:Â 'deps',Â release:Â 'patch'},
Â Â //Â JSHint
Â Â {type:Â 'FEAT',Â release:Â 'minor'},
Â Â {type:Â 'FIX',Â release:Â 'patch'},
];
</code></pre> 
<p></p> 
<p>å¦‚éœ€ä¿®æ”¹ä¸Šè¿°è§„åˆ™ï¼Œå°±éœ€è¦æ·»åŠ Â semantic-releaseÂ é…ç½®æ–‡ä»¶ï¼Œæ–°å»ºÂ release.config.jsÂ æ–‡ä»¶åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼š</p> 
<p></p> 
<pre><code class="language-bash">constÂ {Â execSyncÂ }Â =Â require('child_process');

constÂ isDryRunÂ =Â ()Â =&gt;Â {
Â Â returnÂ process.argv.includes('--dry-run');Â //Â é€šè¿‡å‘½ä»¤è¡Œå‚æ•°åˆ¤æ–­å½“å‰æ¨¡å¼
};

constÂ getCurrentBranchÂ =Â ()Â =&gt;Â {
Â Â returnÂ execSync('gitÂ rev-parseÂ --abbrev-refÂ HEAD').toString().trim();
};

//Â MRè¿è¡Œé…ç½®
constÂ getDryRunConfigÂ =Â ()Â =&gt;Â {
Â Â returnÂ {
Â Â Â Â branches:Â getCurrentBranch(),
Â Â Â Â plugins:Â [
Â Â Â Â Â Â [
Â Â Â Â Â Â Â Â '@semantic-release/commit-analyzer',
Â Â Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â Â Â preset:Â 'conventionalCommits',
Â Â Â Â Â Â Â Â Â Â releaseRules:Â [
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'feat',Â release:Â 'minor'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'revert',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'docs',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'style',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'chore',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'refactor',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'test',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'build',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'ci',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'improvement',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â ],
Â Â Â Â Â Â Â Â },
Â Â Â Â Â Â ],
Â Â Â Â Â Â [
Â Â Â Â Â Â Â Â '@semantic-release/release-notes-generator',
Â Â Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â Â Â preset:Â 'conventionalCommits',
Â Â Â Â Â Â Â Â Â Â presetConfig:Â {
Â Â Â Â Â Â Â Â Â Â Â Â types:Â [
Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'feat',Â section:Â 'Features'Â },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'fix',Â section:Â 'BugÂ Fixes'Â },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'perf',Â section:Â 'PerformanceÂ Improvements'Â },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'revert',Â section:Â 'Reverts'Â },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'docs',Â section:Â 'Documentation',Â hidden:Â falseÂ },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'style',Â section:Â 'Styles',Â hidden:Â trueÂ },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'chore',Â section:Â 'MiscellaneousÂ Chores'Â },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'refactor',Â section:Â 'CodeÂ Refactors',Â hidden:Â falseÂ },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'test',Â section:Â 'Tests',Â hidden:Â trueÂ },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'build',Â section:Â 'BuildÂ System',Â hidden:Â falseÂ },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'ci',Â section:Â 'CI/CD',Â hidden:Â falseÂ },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'improvement',Â section:Â 'Improvements',Â hidden:Â falseÂ },
Â Â Â Â Â Â Â Â Â Â Â Â ],
Â Â Â Â Â Â Â Â Â Â },
Â Â Â Â Â Â Â Â },
Â Â Â Â Â Â ],
Â Â Â Â ],
Â Â };
};

//Â ä¸»åˆ†æ”¯è¿è¡Œé…ç½®
constÂ defaultConfigÂ =Â {
Â Â branches:Â ['main'],
Â Â plugins:Â [
Â Â Â Â [
Â Â Â Â Â Â '@semantic-release/commit-analyzer',
Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â preset:Â 'conventionalCommits',
Â Â Â Â Â Â Â Â releaseRules:Â [
Â Â Â Â Â Â Â Â Â Â {Â type:Â 'feat',Â release:Â 'minor'Â },
Â Â Â Â Â Â Â Â Â Â {Â type:Â 'revert',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â {Â type:Â 'docs',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â {Â type:Â 'style',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â {Â type:Â 'chore',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â {Â type:Â 'refactor',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â {Â type:Â 'test',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â {Â type:Â 'build',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â {Â type:Â 'ci',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â Â Â {Â type:Â 'improvement',Â release:Â 'patch'Â },
Â Â Â Â Â Â Â Â ],
Â Â Â Â Â Â },
Â Â Â Â ],
Â Â Â Â [
Â Â Â Â Â Â '@semantic-release/release-notes-generator',
Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â preset:Â 'conventionalCommits',
Â Â Â Â Â Â Â Â presetConfig:Â {
Â Â Â Â Â Â Â Â Â Â types:Â [
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'feat',Â section:Â 'Features'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'fix',Â section:Â 'BugÂ Fixes'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'perf',Â section:Â 'PerformanceÂ Improvements'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'revert',Â section:Â 'Reverts'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'docs',Â section:Â 'Documentation',Â hidden:Â falseÂ },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'style',Â section:Â 'Styles',Â hidden:Â trueÂ },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'chore',Â section:Â 'MiscellaneousÂ Chores'Â },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'refactor',Â section:Â 'CodeÂ Refactors',Â hidden:Â falseÂ },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'test',Â section:Â 'Tests',Â hidden:Â trueÂ },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'build',Â section:Â 'BuildÂ System',Â hidden:Â falseÂ },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'ci',Â section:Â 'CI/CD',Â hidden:Â falseÂ },
Â Â Â Â Â Â Â Â Â Â Â Â {Â type:Â 'improvement',Â section:Â 'Improvements',Â hidden:Â falseÂ },
Â Â Â Â Â Â Â Â Â Â ],
Â Â Â Â Â Â Â Â },
Â Â Â Â Â Â },
Â Â Â Â ],
Â Â Â Â '@semantic-release/changelog',Â //Â ä»…æœ‰ä¸»åˆ†æ”¯éœ€è¦æ›´æ–°æç‹GitLabÂ changelog
Â Â Â Â '@semantic-release/npm',Â //Â ä»…æœ‰ä¸»åˆ†æ”¯éœ€è¦npmÂ publish
Â Â Â Â '@semantic-release/git',
Â Â Â Â ['@semantic-release/gitlab',Â {Â gitlabUrl:Â 'https://jihulab.com'Â }],Â //Â éœ€è¦æŒ‡å®šgitlabUrlÂ ä¸ºæç‹GitLabåœ°å€
Â Â ],
Â Â success:Â false,
Â Â fail:Â false,
};

module.exportsÂ =Â isDryRun()Â ?Â getDryRunConfig()Â :Â defaultConfig;
</code></pre> 
<p></p> 
<h4><strong>æµæ°´çº¿é…ç½®</strong></h4> 
<p></p> 
<p>æ­¤æ—¶ï¼Œå°±å¯ä»¥è¿›å…¥ä¸Šæ–‡æåˆ°çš„Â .gitlab-ci.ymlÂ æ–‡ä»¶ï¼Œæ·»åŠ Â semantic-releaseÂ ç›¸å…³çš„Â stageï¼š</p> 
<p></p> 
<pre><code class="language-bash">stages:
Â Â -Â lint
Â Â -Â test
Â Â -Â release

workflow:
Â Â rules:
Â Â Â Â -Â if:Â $CI_MERGE_REQUEST_IID
Â Â Â Â -Â if:Â $CI_COMMIT_TAG
Â Â Â Â -Â if:Â $CI_COMMIT_BRANCHÂ ==Â $CI_DEFAULT_BRANCH

default:
Â Â image:Â node:16
Â Â cache:
Â Â Â Â paths:
Â Â Â Â Â Â -Â node_modules/
Â Â Â Â Â Â -Â .yarn

.yarn_install:
Â Â before_script:
Â Â Â Â -Â yarnÂ installÂ --frozen-lockfileÂ --check-filesÂ --cache-folderÂ .yarn

lint:commit:
Â Â extends:Â .yarn_install
Â Â stage:Â lint
Â Â rules:
Â Â Â Â -Â if:Â '$CI_PIPELINE_SOURCEÂ ==Â "merge_request_event"'
Â Â script:
Â Â Â Â -Â yarnÂ commitlintÂ --fromÂ ${CI_MERGE_REQUEST_DIFF_BASE_SHA}Â --toÂ HEADÂ --verbose

lint:prettier:
Â Â extends:Â .yarn_install
Â Â stage:Â lint
Â Â script:
Â Â Â Â -Â yarnÂ lint:prettier

jest:test:
Â Â extends:Â .yarn_install
Â Â stage:Â test
Â Â script:
Â Â Â Â -Â yarnÂ test

semantic-release:
Â Â extends:Â .yarn_install
Â Â stage:Â release
Â Â rules:
Â Â Â Â -Â if:Â $CI_COMMIT_BRANCHÂ ==Â $CI_DEFAULT_BRANCH
Â Â script:
Â Â Â Â -Â gitÂ configÂ --globalÂ http.emptyAuthÂ true
Â Â Â Â -Â yarnÂ semantic-release

#Â RunÂ aÂ dryÂ runÂ onÂ MergeÂ Requests
semantic-release-dry-run:
Â Â needs:Â ['jest:test']
Â Â script:
Â Â Â Â -Â gitÂ configÂ --globalÂ http.emptyAuthÂ true
Â Â Â Â -Â yarnÂ semantic-releaseÂ --branchesÂ $CI_MERGE_REQUEST_SOURCE_BRANCH_NAMEÂ --dry-runÂ --no-ci
Â Â rules:
Â Â Â Â -Â if:Â $CI_MERGE_REQUEST_IID
</code></pre> 
<p></p> 
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°±éœ€è¦è¿›å…¥æç‹GitLab CI è®¾ç½®é¡µé¢ï¼Œæ·»åŠ å¯¹åº”çš„å˜é‡ã€‚</p> 
<p></p> 
<p>é¦–å…ˆå‰å¾€Â <em><a class="link-info" href="https://www.npmjs.com/" rel="nofollow" title="https://www.npmjs.com/">https://www.npmjs.com/</a></em>Â ç”ŸæˆÂ access tokenÂ ç”¨æ¥å‘å¸ƒÂ NPMÂ æ¨¡å—ï¼š</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/20/d1/QyvNcaHp_o.png"></p> 
<p></p> 
<p>ç„¶åï¼Œè¿›å…¥æç‹GitLab é¡¹ç›®è®¾ç½® â†’ è®¿é—®ä»¤ç‰Œç”Ÿæˆé¡¹ç›®Â access tokenï¼Œç”¨æ¥æ¨é€ç‰ˆæœ¬å·æ›´æ–°ï¼Œç”ŸæˆÂ release noteÂ ç­‰ï¼š</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/97/40/aip6SxrH_o.png"></p> 
<p></p> 
<p>æœ€åï¼Œå‰å¾€æç‹GitLab é¡¹ç›®è®¾ç½® â†’ CI/CD â†’ å˜é‡æ–°å¢Â Â NPM_TOKENï¼ŒGITLAB_TOKENÂ ä¸¤ä¸ªå˜é‡ï¼Œåˆ†åˆ«è¾“å…¥åˆšæ‰ç”Ÿæˆçš„Â npm access tokenÂ å’ŒÂ é¡¹ç›® access tokenÂ ã€‚åˆ‡è®°è®¾ä¸º<strong>ä¿æŠ¤å’Œéšè—å˜é‡</strong>ï¼Œå¦åˆ™ä¼šå­˜åœ¨Â tokenÂ æ³„éœ²çš„é£é™©ã€‚</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/35/be/VnyoMVnL_o.png"></p> 
<p></p> 
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬æ‰€æœ‰å‡†å¤‡å·¥ä½œéƒ½å®Œæˆäº†ã€‚ä¸‹é¢å°±æäº¤ä¸€ä¸ªÂ MRÂ è¯•éªŒä¸€ä¸‹ï¼š</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/8c/38/7ILW5zcb_o.png"></p> 
<p></p> 
<p>è¯¥Â MRÂ åŒ…å«äº†ä¸€ä¸ªÂ choreÂ ç±»å‹çš„Â commit messageÂ ï¼Œç­‰å¾…æµæ°´çº¿é€šè¿‡åï¼Œåˆå…¥è¯¥Â MRã€‚æ­¤æ—¶å¯ä»¥çœ‹åˆ°åˆ›å»ºäº†ä¸€æ¡ä¸»åˆ†æ”¯æµæ°´çº¿ï¼Œå¹¶ä¸”æ‰§è¡Œäº†Â semantic-releaseÂ å°†ç‰ˆæœ¬å·æ›´æ–°åˆ° 13.3.2 åÂ publishÂ åˆ°Â NPMÂ æºï¼š</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/84/b3/kQC5cHwP_o.png"></p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/93/23/74fJPE6B_o.png"></p> 
<p></p> 
<p>æ­¤æ—¶è¿›å…¥é¡¹ç›®å‘å¸ƒé¡µé¢ï¼Œå¯ä»¥çœ‹åˆ° semantic-release æ ¹æ®æäº¤ä¿¡æ¯ç”Ÿæˆçš„æç‹GitLabÂ release-noteï¼š</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/e6/60/LQwNcYai_o.png"></p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/30/85/NTuOSmyB_o.png"></p> 
<p></p> 
<p>ğŸ‰ è‡³æ­¤ï¼Œé€šè¿‡æç‹GitLab CI å’Œç¬¬ä¸‰æ–¹å·¥å…·çš„ç»“åˆï¼Œæˆ‘ä»¬å®ç°äº†:</p> 
<p></p> 
<ul><li> <p>æ ¹æ®æäº¤ä¿¡æ¯è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·ï¼›</p> </li><li> <p>è‡ªåŠ¨å‘å¸ƒÂ NPMÂ æ¨¡å—ï¼›</p> </li><li> <p>è‡ªåŠ¨ç”Ÿæˆæç‹GitLabÂ release-noteã€‚</p> </li></ul> 
<p></p> 
<p>æ–°çš„Â NPMÂ æ¨¡å—å‘å¸ƒæµç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/f1/d3/OTA3K6M1_o.png"></p> 
<p></p> 
<p>ä¸‹é¢è®©æˆ‘ä»¬ç»§ç»­å°è¯•ï¼Œä¼˜åŒ–é¡¹ç›®ä¾èµ–Â NPMÂ æ¨¡å—ç‰ˆæœ¬æ›´æ–°æµç¨‹ã€‚</p> 
<p></p> 
<h2><strong>NPM æ¨¡å—è‡ªåŠ¨æ›´æ–°-æ“ä½œæŒ‡å—</strong></h2> 
<hr> 
<p>éšç€æˆ‘ä»¬ä¾èµ–çš„Â NPMÂ æ¨¡å—å¢å¤šï¼Œé¢‘ç¹æ‰‹åŠ¨æ›´æ–°ç‰ˆæœ¬ä¹Ÿæ˜¯ä¸€ä»¶éº»çƒ¦äº‹ã€‚ä¸‹é¢å°±æ¥ä»‹ç»ï¼Œå¦‚ä½•é€šè¿‡æç‹GitLab +Â renovate botÂ è‡ªåŠ¨æ›´æ–°ç¬¬ä¸‰æ–¹ä¾èµ–ç‰ˆæœ¬å·ã€‚</p> 
<p></p> 
<h4><strong>Renovate Bot</strong></h4> 
<p></p> 
<p><a class="link-info" href="https://docs.renovatebot.com/" rel="nofollow" title="Renovate bot">Renovate bot</a>Â æ˜¯ä¸€æ¬¾èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°ä¾èµ–ç‰ˆæœ¬çš„å·¥å…·ï¼Œä¸ä»…é€‚ç”¨äº NPM ä¾èµ–ï¼ŒåŒæ ·é€‚ç”¨äºÂ Dockerã€Ruby gemÂ ç­‰å¤šç§ä¾èµ–ã€‚</p> 
<p></p> 
<p>Renovate botÂ å®˜æ–¹æä¾›äº†ä¸€ä¸ªÂ renovate-runnerÂ é¡¹ç›®ï¼Œæ¥å¸®åŠ©æˆ‘ä»¬æ‰˜ç®¡è‡ªå·±çš„ renovate botã€‚ç”±äºå®˜æ–¹çš„Â renovate-runnerÂ ä½äºÂ <em><a class="link-info" href="https://gitlab.cn/" rel="nofollow" title="GitLab.com">GitLab.com</a></em>Â ã€‚ä¸ºäº†æ–¹ä¾¿å¤§å®¶è®¿é—®ï¼Œæˆ‘å°†è¿™ä¸ªé¡¹ç›®é•œåƒåˆ°äº†æç‹GitLab é‡Œï¼Œé•œåƒé¡¹ç›®åœ°å€ä½äºï¼š<em><a class="link-info" href="https://jihulab.com/gitlab-cn/frontend/renovate-runner" rel="nofollow" title="https://jihulab.com/gitlab-cn/frontend/renovate-runner">https://jihulab.com/gitlab-cn/frontend/renovate-runner</a></em>ã€‚</p> 
<p></p> 
<p>é‚£ä¹ˆå¦‚ä½•åŸºäºÂ renovate-runnerÂ é¡¹ç›®æ‰˜ç®¡è‡ªå·±çš„ renovate æœºå™¨äººå‘¢ï¼Ÿ</p> 
<p></p> 
<p><strong>1.</strong>Â æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„Â my-renovate-botÂ é¡¹ç›®ã€‚é¡¹ç›®åå­—å¯è‡ªæ‹Ÿã€‚</p> 
<p></p> 
<p><strong>2</strong><strong>.</strong>Â åœ¨Â my-renovate-botÂ åˆ›å»ºÂ .gitlab-ci.ymlÂ æ–‡ä»¶ï¼š</p> 
<p></p> 
<pre><code class="language-bash">include:
Â Â Â Â -Â project:Â 'gitlab-cn/frontend/renovate-runner'
Â Â Â Â Â Â file:Â '/templates/renovate-dind.gitlab-ci.yml'

variables:
Â Â RENOVATE_ONBOARDING:Â 'false'
Â Â RENOVATE_REQUIRE_CONFIG:Â 'ignored'
</code></pre> 
<p></p> 
<p></p> 
<p>é…ç½®é¡¹å«ä¹‰å¦‚ä¸‹ï¼š</p> 
<p></p> 
<ul><li> <p>projectÂ é…ç½®ä¸ºÂ renovate-runnerÂ é¡¹ç›®åœ°å€ï¼›</p> </li><li> <p>fileÂ ä¸ºæˆ‘ä»¬éœ€è¦ä½¿ç”¨æµæ°´çº¿æ¨¡æ¿ï¼›</p> </li><li> <p>variablesÂ å¯ä»¥å¯¹æ¨¡æ¿ä¸­å˜é‡çš„é»˜è®¤å€¼è¿›è¡Œè¦†ç›–ã€‚</p> </li></ul> 
<p></p> 
<p><strong>3.</strong>Â åœ¨Â my-renovate-botÂ ä¸‹åˆ›å»ºä¸€ä¸ªÂ renovate botÂ é…ç½®æ–‡ä»¶Â config.jsÂ ï¼š</p> 
<p></p> 
<pre><code class="language-bash">module.exportsÂ =Â {
Â Â Â Â endpoint:Â 'https://jihulab.com/api/v4/',
Â Â Â Â platform:Â 'gitlab',
Â Â Â Â labels:Â ['renovate',Â 'dependencies',Â 'automated'],
Â Â Â Â includeForks:Â true,
Â Â Â Â extends:Â ['config:base'],
Â Â Â Â rangeStrategy:Â 'pin',
Â Â Â Â enabledManagers:Â ["npm",Â "regex"],
Â Â Â Â repositories:Â [{Â 
Â Â Â Â Â Â Â Â repository:Â 'yourÂ projectÂ path',Â 
Â Â Â Â Â Â Â Â bumpVersion:Â true,
Â Â Â Â Â Â Â Â internalChecksFilter:Â "strict",
Â Â Â Â Â Â Â Â stabilityDays:Â 30,
Â Â Â Â Â Â Â Â reviewersFromCodeOwners:Â true,
Â Â Â Â }]
}
</code></pre> 
<p></p> 
<p></p> 
<p>å…¶ä¸­Â repositoriesÂ çš„é…ç½®æœ‰ä¸¤ç§æ–¹å¼ï¼Œå¦‚ä¸Šæ–‡æ‰€ç¤ºï¼Œæ·»åŠ åœ¨Â config.jsÂ ä¸­å¯ä»¥é’ˆå¯¹ä¸åŒé¡¹ç›®ä½¿ç”¨ä¸åŒçš„é…ç½®é¡¹ã€‚å¦‚æœä¸éœ€è¦é’ˆå¯¹å„ä¸ªé¡¹ç›®å•ç‹¬å®šåˆ¶ï¼Œåˆ™å¯ä»¥åœ¨Â my-renovate-botÂ é¡¹ç›®è®¾ç½®â†’ CI/CD å˜é‡ä¸­æ·»åŠ Â RENOVATE_EXTRA_FLAGSÂ é…ç½®é¡¹ï¼Œä»¥ç©ºæ ¼åˆ†éš”å¤šä¸ªé¡¹ç›®åç§°å³å¯ï¼š</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/5c/14/L6WvImqG_o.png"></p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/4f/b8/Fz9U1w5V_o.png"></p> 
<p></p> 
<p><strong>4.</strong>Â ç”ŸæˆÂ RENOVATE_TOKENÂ æ¥æ–¹ä¾¿Â renovate botÂ è®¿é—®é¡¹ç›®ã€åˆ›å»ºÂ MRÂ ã€‚å¦‚æœæ˜¯ä¸ªäººä½¿ç”¨ï¼Œå¯ä»¥å‰å¾€ä¸ªäººè®¾ç½®é¡µé¢åˆ›å»ºÂ Access TokenÂ å³å¯ï¼š</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/e4/dc/gMOsFBdn_o.png"></p> 
<p></p> 
<p><strong>5.</strong>Â ä¸ºäº†æ–¹ä¾¿Â renovate botÂ åˆ›å»ºÂ MRÂ æ—¶æºå¸¦ä¸Šæœ¬æ¬¡æ›´æ–°çš„Â changelogï¼Œæˆ‘ä»¬è¿˜éœ€è¦å‰å¾€ GitHub ç”Ÿæˆä¸€ä¸ªÂ GITHUB_COM_TOKENÂ ã€‚</p> 
<p></p> 
<h4><strong>è®¾ç½®å®šæ—¶ä»»åŠ¡</strong></h4> 
<p></p> 
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„é…ç½®å‡†å¤‡å·¥ä½œå·²ç»å®Œæˆã€‚ä¸‹ä¸€æ­¥å‰å¾€Â my-renovate-botÂ é¡¹ç›® â†’ CI/CD â†’ è®¡åˆ’ é¡µé¢è®¾ç½®å®šæ—¶ä»»åŠ¡ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©æ¯å¤©å‡Œæ™¨è‡ªåŠ¨æ‰§è¡ŒÂ renovate botÂ ï¼Œå®ƒä¼šè‡ªåŠ¨æ‰«ææˆ‘ä»¬çš„Â package.jsonÂ æ–‡ä»¶ï¼Œè·å–æœ€æ–°ä¾èµ–ç‰ˆæœ¬ï¼Œç„¶ååˆ›å»ºæ›´æ–°ç‰ˆæœ¬å·çš„Â MRÂ ã€‚</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/7d/95/a0np2twR_o.png"></p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/08/74/2ndkZXDt_o.png"></p> 
<p></p> 
<blockquote> 
 <p>æ³¨æ„ï¼šå¦‚æœæˆ‘ä»¬é€‰æ‹©è‡ªå®šä¹‰æ‰§è¡Œæ—¶é—´ï¼Œéœ€è¦æŒ‰ç…§Â <a class="link-info" href="https://en.wikipedia.org/wiki/Cron" rel="nofollow" title="Cron è¯­æ³•">Cron è¯­æ³•</a>Â è¾“å…¥ã€‚å¤§å®¶å¯ä»¥ä½¿ç”¨è¿™ä¸ª<a class="link-info" href="https://crontab.guru/" rel="nofollow" title="å·¥å…·">å·¥å…·</a>Â æ–¹ä¾¿ç”Ÿæˆè‡ªå·±çš„ Cron è¡¨è¾¾å¼ã€‚</p> 
</blockquote> 
<p></p> 
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ‰€æœ‰çš„é…ç½®å·¥ä½œå·²ç»å®Œæˆã€‚ä¸‹é¢å°±å°è¯•è§¦å‘Â renovate botÂ è¿›è¡Œæµ‹è¯•ã€‚å‰å¾€æˆ‘ä»¬åœ¨Â config.jsÂ æˆ–Â RENOVATE_EXTRA_FLAGSÂ ä¸­é…ç½®çš„é¡¹ç›®Â MRÂ é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°Â renovate-botÂ å·²ç»å¸®åŠ©æˆ‘ä»¬åˆ›å»ºäº†ä¸‰ä¸ªÂ MRÂ ï¼Œåˆ†åˆ«è¿›è¡Œäº†å›ºå®šç‰ˆæœ¬å·ï¼Œå‡çº§Â pathÂ ç‰ˆæœ¬ï¼Œå‡çº§Â majorÂ ç‰ˆæœ¬çš„æ“ä½œã€‚</p> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/42/87/i8IGooW2_o.png"></p> 
<p></p> 
<p>è¿›å…¥Â MRÂ è¯¦æƒ…ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œrenovate botÂ å¸®åŠ©æˆ‘ä»¬æŠ“å–äº†è¯¦ç»†çš„Â changelogÂ ã€‚è¡¨æ ¼ä¸­çš„å­—æ®µå«ä¹‰åˆ†åˆ«æ˜¯ï¼š</p> 
<p></p> 
<ul><li> <p>Age - è¯¥ç‰ˆæœ¬å‘å¸ƒè‡³ä»Šçš„æ—¶é—´ï¼›</p> </li><li> <p>Adoption - è¯¥ç‰ˆæœ¬åœ¨ä½¿ç”¨Â renovate botÂ çš„é¡¹ç›®ä¸­æ¥å—å®‰è£…çš„æ¯”ä¾‹ï¼›</p> </li><li> <p>Passing - è¯¥ç‰ˆæœ¬é€šè¿‡æµ‹è¯•çš„æ›´æ–°çš„ç™¾åˆ†æ¯”ï¼›</p> </li><li> <p>Confidence - è¯¥ç‰ˆæœ¬çš„å¯ä¿¡åº¦ã€‚</p> </li></ul> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/7b/ab/thNRm1u7_o.png"></p> 
<p></p> 
<p>æœ€åï¼Œæˆ‘ä»¬åªéœ€è¦æŸ¥çœ‹æœ€æ–°çš„Â MRï¼Œé€‰æ‹©æ˜¯å¦éœ€è¦åˆå¹¶å³å¯ã€‚ğŸ‰</p> 
<p></p> 
<h2><strong>æ€»ç»“</strong></h2> 
<hr> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/86/a4/xCkZnqOH_o.png"></p> 
<p></p> 
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å·²ç»å®ç°äº†é€šè¿‡æç‹GitLab å’ŒÂ renovate bot ç»“åˆè‡ªåŠ¨æ›´æ–°Â NPMÂ ä¾èµ–ç‰ˆæœ¬å·çš„åŠŸèƒ½ã€‚</p> 
<p></p> 
<p>é€šè¿‡å’Œç¬¬ä¸€éƒ¨åˆ†æ‰€è¿°Â NPMÂ è‡ªåŠ¨å‘å¸ƒç›¸ç»“åˆï¼Œå°±å¯ä»¥å®ç°ä¸éœ€è¦äººå·¥ä»‹å…¥çš„Â NPMÂ åŒ…è‡ªåŠ¨å‘å¸ƒ + è‡ªåŠ¨æ›´æ–°çš„å·¥ä½œæµäº†ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Š<strong>èŠ‚çº¦å¼€å‘æ—¶é—´ï¼Œå‡å°‘æ²Ÿé€šæˆæœ¬</strong>ï¼Œè®©Â NPMÂ å‘å¸ƒæ›´æ–°æ›´åŠæ—¶ï¼Œè®©ç ”å‘å·¥ä½œæ›´é«˜æ•ˆï¼çˆ±é’»ç ”çš„å°æ˜ï¼Œæµ…å°åˆ°äº†ç²¾è‹±æ•ˆèƒ½çš„å¥‡å¦™æ»‹å‘³ã€‚ğŸ˜</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8cd8cf5f406e9d5b019dc86f758255cc/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">CADæ•°æ®å¯¼å…¥åˆ°ArcGISä¸­å‡ºç°ä¹±ç æ€ä¹ˆåŠï¼Ÿ</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5760e2dee051f1d5cb94f8a93575ef46/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">HBASE shell å‘½ä»¤</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>