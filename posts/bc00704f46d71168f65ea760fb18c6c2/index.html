<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C# 使用gdi绘制自定义控件，自适应分辨率。 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C# 使用gdi绘制自定义控件，自适应分辨率。" />
<meta property="og:description" content="录制_2023_08_06_14_12_28_725
C# 使用gdi绘制自定义控件 解决cpu占用高的问题以及闪烁问题的解决方案
视频演示
问题描述 GDI&#43;的效率其实没有GDI的效率高的, 一般的提高效率的方法也就那么多:
减少不必要的绘制, 区域刷新效果比全部绘制效率高很多, 比如只是一个控件需要重绘,我们就不应该让整个窗口或者说大于次区域的界面无效不在显示区域的绘制工作能省就省, 主要绘制可视界面, 就是平时说的 脏矩形技术使用内存绘制, 然后直接贴图(或者截取贴图), 另外如果某些工作是不变的,比如说背景, 那么就在第一次的时候绘制到内存dc, 以后直接取用如果有可能可以使用Directx或者openGL 主要分为3步，
1.添加自适应分辨率类
2.绘制GDI图形
3.调用
1.添加自适应分辨率类
class AutoSizeFormClass { //(1).声明结构,只记录窗体和其控件的初始位置和大小。 public struct controlRect { public int Left; public int Top; public int Width; public int Height; public float FontSize; public string name; } //(2).声明 1个对象 //注意这里不能使用控件列表记录 List nCtrl;，因为控件的关联性，记录的始终是当前的大小。 // public List oldCtrl= new List();//这里将西文的大于小于号都过滤掉了，只能改为中文的，使用中要改回西文 public List&lt;controlRect&gt; oldCtrl = new List&lt;controlRect&gt;(); int ctrlNo = 0;//1; //(3)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/bc00704f46d71168f65ea760fb18c6c2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-06T14:25:53+08:00" />
<meta property="article:modified_time" content="2023-08-06T14:25:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C# 使用gdi绘制自定义控件，自适应分辨率。</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="csdn-video-box"> 
 <iframe id="Z5r1EbsW-1691302937702" frameborder="0" src="https://live.csdn.net/v/embed/317557" allowfullscreen="true" data-mediaembed="csdn"></iframe> 
 <p>录制_2023_08_06_14_12_28_725</p> 
</div> 
<p></p> 
<h2><a id="C_gdi_7"></a>C# 使用gdi绘制自定义控件</h2> 
<hr> 
<p>解决cpu占用高的问题以及闪烁问题的解决方案<br> 视频演示</p> 
<h2><a id="_14"></a>问题描述</h2> 
<p>GDI+的效率其实没有GDI的效率高的, 一般的提高效率的方法也就那么多:</p> 
<ol><li>减少不必要的绘制, 区域刷新效果比全部绘制效率高很多, 比如只是一个控件需要重绘,我们就不应该让整个窗口或者说大于次区域的界面无效</li><li>不在显示区域的绘制工作能省就省, 主要绘制可视界面, 就是平时说的 脏矩形技术</li><li>使用内存绘制, 然后直接贴图(或者截取贴图), 另外如果某些工作是不变的,比如说背景, 那么就在第一次的时候绘制到内存dc, 以后直接取用</li><li>如果有可能可以使用Directx或者openGL</li></ol> 
<p>主要分为3步，<br> 1.添加自适应分辨率类<br> 2.绘制GDI图形<br> 3.调用</p> 
<p>1.添加自适应分辨率类</p> 
<pre><code class="prism language-c"> class AutoSizeFormClass
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//(1).声明结构,只记录窗体和其控件的初始位置和大小。</span>
        public <span class="token keyword">struct</span> <span class="token class-name">controlRect</span>
        <span class="token punctuation">{<!-- --></span>
            public <span class="token keyword">int</span> Left<span class="token punctuation">;</span>
            public <span class="token keyword">int</span> Top<span class="token punctuation">;</span>
            public <span class="token keyword">int</span> Width<span class="token punctuation">;</span>
            public <span class="token keyword">int</span> Height<span class="token punctuation">;</span>
            public <span class="token keyword">float</span> FontSize<span class="token punctuation">;</span>
            public string name<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//(2).声明 1个对象</span>
        <span class="token comment">//注意这里不能使用控件列表记录 List nCtrl;，因为控件的关联性，记录的始终是当前的大小。</span>
        <span class="token comment">//      public List oldCtrl= new List();//这里将西文的大于小于号都过滤掉了，只能改为中文的，使用中要改回西文</span>
        public List<span class="token operator">&lt;</span>controlRect<span class="token operator">&gt;</span> oldCtrl <span class="token operator">=</span> new List<span class="token operator">&lt;</span>controlRect<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> ctrlNo <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//1;</span>
        <span class="token comment">//(3). 创建两个函数</span>
        <span class="token comment">//(3.1)记录窗体和其控件的初始位置和大小,</span>
        public <span class="token keyword">void</span> <span class="token function">controllInitializeSize</span><span class="token punctuation">(</span>Control mForm<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            controlRect cR<span class="token punctuation">;</span>
            cR<span class="token punctuation">.</span>Left <span class="token operator">=</span> mForm<span class="token punctuation">.</span>Left<span class="token punctuation">;</span> cR<span class="token punctuation">.</span>Top <span class="token operator">=</span> mForm<span class="token punctuation">.</span>Top<span class="token punctuation">;</span> cR<span class="token punctuation">.</span>Width <span class="token operator">=</span> mForm<span class="token punctuation">.</span>Width<span class="token punctuation">;</span> cR<span class="token punctuation">.</span>Height <span class="token operator">=</span> mForm<span class="token punctuation">.</span>Height<span class="token punctuation">;</span>cR<span class="token punctuation">.</span>name<span class="token operator">=</span>mForm<span class="token punctuation">.</span>Name <span class="token punctuation">;</span>cR<span class="token punctuation">.</span>FontSize <span class="token operator">=</span> mForm<span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Size<span class="token punctuation">;</span>
            oldCtrl<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>cR<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//第一个为"窗体本身",只加入一次即可</span>
            <span class="token function">AddControl</span><span class="token punctuation">(</span>mForm<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//窗体内其余控件还可能嵌套控件(比如panel),要单独抽出,因为要递归调用</span>
                              <span class="token comment">//this.WindowState = (System.Windows.Forms.FormWindowState)(2);//记录完控件的初始位置和大小后，再最大化</span>
                              <span class="token comment">//0 - Normalize , 1 - Minimize,2- Maximize</span>
        <span class="token punctuation">}</span>
        private <span class="token keyword">void</span> <span class="token function">AddControl</span><span class="token punctuation">(</span>Control ctl<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">foreach</span> <span class="token punctuation">(</span>Control c in ctl<span class="token punctuation">.</span>Controls<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>  
                <span class="token comment">//**放在这里，是先记录控件的子控件，后记录控件本身              </span>
                controlRect objCtrl<span class="token punctuation">;</span>              
                objCtrl<span class="token punctuation">.</span>Left <span class="token operator">=</span> c<span class="token punctuation">.</span>Left<span class="token punctuation">;</span> objCtrl<span class="token punctuation">.</span>Top <span class="token operator">=</span> c<span class="token punctuation">.</span>Top<span class="token punctuation">;</span> objCtrl<span class="token punctuation">.</span>Width <span class="token operator">=</span> c<span class="token punctuation">.</span>Width<span class="token punctuation">;</span> objCtrl<span class="token punctuation">.</span>Height <span class="token operator">=</span> c<span class="token punctuation">.</span>Height<span class="token punctuation">;</span> objCtrl<span class="token punctuation">.</span>FontSize <span class="token operator">=</span> c<span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Size<span class="token punctuation">;</span> objCtrl<span class="token punctuation">.</span>name <span class="token operator">=</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>               
                oldCtrl<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>objCtrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//**放在这里，是先记录控件本身，后记录控件的子控件</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>c<span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                    <span class="token function">AddControl</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//窗体内其余控件还可能嵌套控件(比如panel),要单独抽出,因为要递归调用</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//(3.2)控件自适应大小,</span>
        public <span class="token keyword">void</span> <span class="token function">controlAutoSize</span><span class="token punctuation">(</span>Control mForm<span class="token punctuation">,</span>FormWindowState windowState<span class="token operator">=</span> FormWindowState<span class="token punctuation">.</span>Normal<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>windowState <span class="token operator">==</span> FormWindowState<span class="token punctuation">.</span>Minimized<span class="token punctuation">)</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>           
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ctrlNo <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span> <span class="token comment">//*如果在窗体的Form1_Load中，记录控件原始的大小和位置，正常没有问题，但要加入皮肤就会出现问题，因为有些控件如dataGridView的的子控件还没有完成，个数少</span>
              <span class="token comment">//*要在窗体的Form1_SizeChanged中，第一次改变大小时，记录控件原始的大小和位置,这里所有控件的子控件都已经形成</span>
                controlRect cR<span class="token punctuation">;</span>
                <span class="token comment">//  cR.Left = mForm.Left; cR.Top = mForm.Top; cR.Width = mForm.Width; cR.Height = mForm.Height;</span>
                cR<span class="token punctuation">.</span>Left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> cR<span class="token punctuation">.</span>Top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> cR<span class="token punctuation">.</span>Width <span class="token operator">=</span> mForm<span class="token punctuation">.</span>PreferredSize<span class="token punctuation">.</span>Width<span class="token punctuation">;</span> cR<span class="token punctuation">.</span>Height <span class="token operator">=</span> mForm<span class="token punctuation">.</span>PreferredSize<span class="token punctuation">.</span>Height<span class="token punctuation">;</span> cR<span class="token punctuation">.</span>FontSize <span class="token operator">=</span> mForm<span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Size<span class="token punctuation">;</span> cR<span class="token punctuation">.</span>name <span class="token operator">=</span> mForm<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>

                oldCtrl<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>cR<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//第一个为"窗体本身",只加入一次即可                </span>
                <span class="token function">AddControl</span><span class="token punctuation">(</span>mForm<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//窗体内其余控件可能嵌套其它控件(比如panel),故单独抽出以便递归调用             </span>
            <span class="token punctuation">}</span>        
            <span class="token keyword">float</span> wScale <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>mForm<span class="token punctuation">.</span>Width <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>oldCtrl<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Width<span class="token punctuation">;</span><span class="token comment">//新旧窗体之间的比例，与最早的旧窗体</span>
            <span class="token keyword">float</span> hScale <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>mForm<span class="token punctuation">.</span>Height <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>oldCtrl<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Height<span class="token punctuation">;</span><span class="token comment">//.Height;</span>
            ctrlNo <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//进入=1，第0个为窗体本身,窗体内的控件,从序号1开始</span>
            <span class="token function">AutoScaleControl</span><span class="token punctuation">(</span>mForm<span class="token punctuation">,</span> wScale<span class="token punctuation">,</span> hScale<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//窗体内其余控件还可能嵌套控件(比如panel),要单独抽出,因为要递归调用</span>
        <span class="token punctuation">}</span>
        private <span class="token keyword">void</span> <span class="token function">AutoScaleControl</span><span class="token punctuation">(</span>Control ctl<span class="token punctuation">,</span> <span class="token keyword">float</span> wScale<span class="token punctuation">,</span> <span class="token keyword">float</span> hScale<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> ctrLeft0<span class="token punctuation">,</span> ctrTop0<span class="token punctuation">,</span> ctrWidth0<span class="token punctuation">,</span> ctrHeight0<span class="token punctuation">;</span>
            <span class="token keyword">float</span> ctrfontsize<span class="token punctuation">;</span>
            <span class="token comment">//int ctrlNo = 1;//第1个是窗体自身的 Left,Top,Width,Height，所以窗体控件从ctrlNo=1开始</span>
            <span class="token function">foreach</span> <span class="token punctuation">(</span>Control c in ctl<span class="token punctuation">.</span>Controls<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span> 
                <span class="token comment">//**放在这里，是先缩放控件的子控件，后缩放控件本身                            </span>
                ctrLeft0 <span class="token operator">=</span> oldCtrl<span class="token punctuation">[</span>ctrlNo<span class="token punctuation">]</span><span class="token punctuation">.</span>Left<span class="token punctuation">;</span>
                ctrTop0 <span class="token operator">=</span> oldCtrl<span class="token punctuation">[</span>ctrlNo<span class="token punctuation">]</span><span class="token punctuation">.</span>Top<span class="token punctuation">;</span>
                ctrWidth0 <span class="token operator">=</span> oldCtrl<span class="token punctuation">[</span>ctrlNo<span class="token punctuation">]</span><span class="token punctuation">.</span>Width<span class="token punctuation">;</span>
                ctrHeight0 <span class="token operator">=</span> oldCtrl<span class="token punctuation">[</span>ctrlNo<span class="token punctuation">]</span><span class="token punctuation">.</span>Height<span class="token punctuation">;</span>
                ctrfontsize <span class="token operator">=</span> oldCtrl<span class="token punctuation">[</span>ctrlNo<span class="token punctuation">]</span><span class="token punctuation">.</span>FontSize<span class="token punctuation">;</span>
                <span class="token comment">//c.Left = (int)((ctrLeft0 - wLeft0) * wScale) + wLeft1;//新旧控件之间的线性比例</span>
                <span class="token comment">//c.Top = (int)((ctrTop0 - wTop0) * h) + wTop1;</span>
                c<span class="token punctuation">.</span>Left <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctrLeft0<span class="token punctuation">)</span> <span class="token operator">*</span> wScale<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//新旧控件之间的线性比例。控件位置只相对于窗体，所以不能加 + wLeft1</span>
                c<span class="token punctuation">.</span>Top <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctrTop0<span class="token punctuation">)</span> <span class="token operator">*</span> hScale<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span>
                c<span class="token punctuation">.</span>Width <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ctrWidth0 <span class="token operator">*</span> wScale<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//只与最初的大小相关，所以不能与现在的宽度相乘 (int)(c.Width * w);</span>
                c<span class="token punctuation">.</span>Height <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ctrHeight0 <span class="token operator">*</span> hScale<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span>
                <span class="token comment">// 创建一个新的字体，按比例缩放原始字体大小</span>
                Font scaledFont <span class="token operator">=</span> new <span class="token function">Font</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>Font<span class="token punctuation">.</span>FontFamily<span class="token punctuation">,</span> hScale <span class="token operator">*</span> ctrfontsize<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 设置 Label 的字体为新创建的字体</span>
                c<span class="token punctuation">.</span>Font <span class="token operator">=</span> scaledFont<span class="token punctuation">;</span>
               
                <span class="token comment">//窗体内其余控件还可能嵌套控件(比如panel),要单独抽出,因为要递归调用</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>c<span class="token punctuation">.</span>Controls<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                    <span class="token function">AutoScaleControl</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> wScale<span class="token punctuation">,</span> hScale<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ctl is DataGridView<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    DataGridView dgv <span class="token operator">=</span> ctl as DataGridView<span class="token punctuation">;</span>
                    Cursor<span class="token punctuation">.</span>Current <span class="token operator">=</span> Cursors<span class="token punctuation">.</span>WaitCursor<span class="token punctuation">;</span>

                    <span class="token keyword">int</span> widths <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dgv<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        dgv<span class="token punctuation">.</span><span class="token function">AutoResizeColumn</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> DataGridViewAutoSizeColumnMode<span class="token punctuation">.</span>AllCells<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 自动调整列宽  </span>
                        widths <span class="token operator">+=</span> dgv<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Width<span class="token punctuation">;</span>   <span class="token comment">// 计算调整列后单元列的宽度和                       </span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>widths <span class="token operator">&gt;=</span> ctl<span class="token punctuation">.</span>Size<span class="token punctuation">.</span>Width<span class="token punctuation">)</span>  <span class="token comment">// 如果调整列的宽度大于设定列宽  </span>
                        dgv<span class="token punctuation">.</span>AutoSizeColumnsMode <span class="token operator">=</span> DataGridViewAutoSizeColumnsMode<span class="token punctuation">.</span>DisplayedCells<span class="token punctuation">;</span>  <span class="token comment">// 调整列的模式 自动  </span>
                    <span class="token keyword">else</span>
                        dgv<span class="token punctuation">.</span>AutoSizeColumnsMode <span class="token operator">=</span> DataGridViewAutoSizeColumnsMode<span class="token punctuation">.</span>Fill<span class="token punctuation">;</span>  <span class="token comment">// 如果小于 则填充  </span>

                    Cursor<span class="token punctuation">.</span>Current <span class="token operator">=</span> Cursors<span class="token punctuation">.</span>Default<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>              
                ctrlNo<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//累加序号</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre> 
<p>2.创建自定义控件并绘制图形添加事件</p> 
<pre><code class="prism language-c"> public partial class UserControl1 <span class="token operator">:</span> UserControl
    <span class="token punctuation">{<!-- --></span>
        public <span class="token function">UserControl1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            this<span class="token punctuation">.</span><span class="token function">SetStyle</span><span class="token punctuation">(</span>ControlStyles<span class="token punctuation">.</span>OptimizedDoubleBuffer <span class="token operator">|</span>
                ControlStyles<span class="token punctuation">.</span>UserPaint <span class="token operator">|</span>
                      ControlStyles<span class="token punctuation">.</span>AllPaintingInWmPaint<span class="token punctuation">,</span> true<span class="token punctuation">)</span><span class="token punctuation">;</span>    
        <span class="token punctuation">}</span>      
        <span class="token keyword">float</span> size1  <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>

        public bool IsPaint <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> false<span class="token punctuation">;</span>

        private <span class="token keyword">int</span> _count_H <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Get or set the width of the border</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token punctuation">[</span>System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span><span class="token function">Browsable</span><span class="token punctuation">(</span>true<span class="token punctuation">)</span><span class="token punctuation">,</span>
        System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span><span class="token function">Category</span><span class="token punctuation">(</span><span class="token string">"Appearance"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">"Set the border style"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        public <span class="token keyword">int</span> count_H 
        <span class="token punctuation">{<!-- --></span>
            set
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>_count_H <span class="token operator">==</span> value<span class="token punctuation">)</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>_count_H <span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    _count_H <span class="token operator">=</span> value<span class="token punctuation">;</span>
                    <span class="token keyword">int</span> MaxSize <span class="token operator">=</span> pictureBox1<span class="token punctuation">.</span>Height <span class="token operator">&lt;</span> pictureBox1<span class="token punctuation">.</span>Width <span class="token operator">?</span> pictureBox1<span class="token punctuation">.</span>Height <span class="token operator">:</span> pictureBox1<span class="token punctuation">.</span>Width<span class="token punctuation">;</span>
                    <span class="token keyword">int</span> MaxCnt <span class="token operator">=</span> count_H <span class="token operator">&lt;</span> count_W <span class="token operator">?</span> count_H <span class="token operator">:</span> count_W<span class="token punctuation">;</span>
                    size1 <span class="token operator">=</span> MaxSize <span class="token operator">/</span> MaxCnt<span class="token punctuation">;</span>
                    <span class="token function">Invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{<!-- --></span>
                    throw new <span class="token function">ArgumentException</span><span class="token punctuation">(</span><span class="token string">"This value should be between 0 and 5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            get 
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> _count_H<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        private <span class="token keyword">int</span> _count_W <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Get or set the width of the border</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token punctuation">[</span>System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span><span class="token function">Browsable</span><span class="token punctuation">(</span>true<span class="token punctuation">)</span><span class="token punctuation">,</span>
        System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span><span class="token function">Category</span><span class="token punctuation">(</span><span class="token string">"Appearance"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">"Set the border style"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        public <span class="token keyword">int</span> count_W 
        <span class="token punctuation">{<!-- --></span>
            set
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>_count_W <span class="token operator">==</span> value<span class="token punctuation">)</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>_count_W <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    _count_W <span class="token operator">=</span> value<span class="token punctuation">;</span>
                    <span class="token keyword">int</span> MaxSize <span class="token operator">=</span> pictureBox1<span class="token punctuation">.</span>Height <span class="token operator">&lt;</span> pictureBox1<span class="token punctuation">.</span>Width <span class="token operator">?</span> pictureBox1<span class="token punctuation">.</span>Height <span class="token operator">:</span> pictureBox1<span class="token punctuation">.</span>Width<span class="token punctuation">;</span>
                    <span class="token keyword">int</span> MaxCnt <span class="token operator">=</span> count_H <span class="token operator">&lt;</span> count_W <span class="token operator">?</span> count_H <span class="token operator">:</span> count_W<span class="token punctuation">;</span>
                    size1 <span class="token operator">=</span> MaxSize <span class="token operator">/</span> MaxCnt<span class="token punctuation">;</span>
                    <span class="token function">Invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{<!-- --></span>
                    throw new <span class="token function">ArgumentException</span><span class="token punctuation">(</span><span class="token string">"This value should be between 0 and 5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            get
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> _count_W<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> 
     
        private string _text <span class="token operator">=</span> <span class="token string">"label1"</span><span class="token punctuation">;</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Get or set the width of the border</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token punctuation">[</span>System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span><span class="token function">Browsable</span><span class="token punctuation">(</span>true<span class="token punctuation">)</span><span class="token punctuation">,</span>
        System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span><span class="token function">Category</span><span class="token punctuation">(</span><span class="token string">"Appearance"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">"Set the border style"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        public string TextValue
        <span class="token punctuation">{<!-- --></span>
            get
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> _text<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            set
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>_text <span class="token operator">==</span> value<span class="token punctuation">)</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>_text <span class="token operator">!=</span> <span class="token string">""</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    _text <span class="token operator">=</span> value<span class="token punctuation">;</span>
                    <span class="token keyword">int</span> MaxSize <span class="token operator">=</span> pictureBox1<span class="token punctuation">.</span>Height <span class="token operator">&lt;</span> pictureBox1<span class="token punctuation">.</span>Width <span class="token operator">?</span> pictureBox1<span class="token punctuation">.</span>Height <span class="token operator">:</span> pictureBox1<span class="token punctuation">.</span>Width<span class="token punctuation">;</span>
                    <span class="token keyword">int</span> MaxCnt <span class="token operator">=</span> count_H <span class="token operator">&lt;</span> count_W <span class="token operator">?</span> count_H <span class="token operator">:</span> count_W<span class="token punctuation">;</span>
                    size1 <span class="token operator">=</span> MaxSize <span class="token operator">/</span> MaxCnt<span class="token punctuation">;</span>                                     
                    <span class="token function">Invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{<!-- --></span>
                    throw new <span class="token function">ArgumentException</span><span class="token punctuation">(</span><span class="token string">"This value should be between 0 and 5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        private <span class="token keyword">void</span> <span class="token function">panel1_MouseClick</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> MouseEventArgs e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> MaxSize <span class="token operator">=</span> pictureBox1<span class="token punctuation">.</span>Height <span class="token operator">&lt;</span> pictureBox1<span class="token punctuation">.</span>Width <span class="token operator">?</span> pictureBox1<span class="token punctuation">.</span>Height <span class="token operator">:</span> pictureBox1<span class="token punctuation">.</span>Width<span class="token punctuation">;</span>
            <span class="token keyword">int</span> MaxCnt <span class="token operator">=</span> count_H <span class="token operator">&lt;</span> count_W <span class="token operator">?</span> count_H <span class="token operator">:</span> count_W<span class="token punctuation">;</span>
            size1 <span class="token operator">=</span> MaxSize <span class="token operator">/</span> MaxCnt<span class="token operator">*</span><span class="token number">0.75f</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count_H<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> count_W<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">int</span> index <span class="token operator">=</span> count_W <span class="token operator">*</span> i <span class="token operator">+</span> j<span class="token punctuation">;</span>
                    string strtemp <span class="token operator">=</span> $<span class="token string">"{_text}{index}"</span><span class="token punctuation">;</span>
                    Point point <span class="token operator">=</span> new <span class="token function">Point</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>j <span class="token operator">*</span> <span class="token punctuation">(</span>_text<span class="token punctuation">.</span>Length <span class="token operator">*</span> size1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>size1 <span class="token operator">*</span> <span class="token number">1.25f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    Size size <span class="token operator">=</span> new <span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>size1 <span class="token operator">*</span> <span class="token punctuation">(</span>_text<span class="token punctuation">.</span>Length<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>size1 <span class="token operator">*</span> <span class="token number">1.15</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    Rectangle rectangle <span class="token operator">=</span> new <span class="token function">Rectangle</span><span class="token punctuation">(</span>point<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    var path <span class="token operator">=</span> new <span class="token function">GraphicsPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    path<span class="token punctuation">.</span><span class="token function">AddEllipse</span><span class="token punctuation">(</span>rectangle<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    path<span class="token punctuation">.</span><span class="token function">CloseFigure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    var region <span class="token operator">=</span> new <span class="token function">Region</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>region<span class="token punctuation">.</span><span class="token function">IsVisible</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Location<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span>strtemp<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">//pointLast = Point.Empty;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        
        Bitmap bmp<span class="token punctuation">;</span>
        private <span class="token keyword">void</span> <span class="token function">panel1_Paint</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> PaintEventArgs e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//创建内存位图，将背景及圆形绘制在此内存位图上</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>IsPaint<span class="token punctuation">)</span> 
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            bmp <span class="token operator">=</span> new <span class="token function">Bitmap</span><span class="token punctuation">(</span>pictureBox1<span class="token punctuation">.</span>Width<span class="token punctuation">,</span> pictureBox1<span class="token punctuation">.</span>Height<span class="token punctuation">)</span><span class="token punctuation">;</span>
            var g <span class="token operator">=</span> Graphics<span class="token punctuation">.</span><span class="token function">FromImage</span><span class="token punctuation">(</span>bmp<span class="token punctuation">)</span><span class="token punctuation">;</span>         
            
            <span class="token keyword">int</span> MaxSize <span class="token operator">=</span> pictureBox1<span class="token punctuation">.</span>Height <span class="token operator">&lt;</span> pictureBox1<span class="token punctuation">.</span>Width <span class="token operator">?</span> pictureBox1<span class="token punctuation">.</span>Height <span class="token operator">:</span> pictureBox1<span class="token punctuation">.</span>Width<span class="token punctuation">;</span>
            <span class="token keyword">int</span> MaxCnt <span class="token operator">=</span> count_H <span class="token operator">&lt;</span> count_W <span class="token operator">?</span> count_H <span class="token operator">:</span> count_W<span class="token punctuation">;</span>
            size1 <span class="token operator">=</span> MaxSize <span class="token operator">/</span> MaxCnt <span class="token operator">*</span> <span class="token number">0.75f</span><span class="token punctuation">;</span>
           

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count_H<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> count_W<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">int</span> index <span class="token operator">=</span> count_W <span class="token operator">*</span> i <span class="token operator">+</span> j<span class="token punctuation">;</span>
                    PointF point <span class="token operator">=</span> new <span class="token function">PointF</span><span class="token punctuation">(</span>j <span class="token operator">*</span> <span class="token punctuation">(</span>_text<span class="token punctuation">.</span>Length <span class="token operator">*</span> size1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>size1<span class="token operator">*</span><span class="token number">1.25f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   
                    g<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>$<span class="token string">"{index}"</span><span class="token punctuation">,</span> new <span class="token function">Font</span><span class="token punctuation">(</span><span class="token string">"宋体"</span><span class="token punctuation">,</span> size1<span class="token punctuation">)</span><span class="token punctuation">,</span> new <span class="token function">SolidBrush</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Black<span class="token punctuation">)</span><span class="token punctuation">,</span> point<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count_H<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> count_W<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">int</span> index <span class="token operator">=</span> count_W <span class="token operator">*</span> i <span class="token operator">+</span> j<span class="token punctuation">;</span>                  
                    Point point <span class="token operator">=</span> new <span class="token function">Point</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>j <span class="token operator">*</span> <span class="token punctuation">(</span>_text<span class="token punctuation">.</span>Length <span class="token operator">*</span> size1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>size1 <span class="token operator">*</span> <span class="token number">1.25f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    Size size <span class="token operator">=</span> new <span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>size1<span class="token operator">*</span><span class="token punctuation">(</span>_text<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>size1<span class="token operator">*</span><span class="token number">1.15</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    Rectangle rectangle <span class="token operator">=</span> new <span class="token function">Rectangle</span><span class="token punctuation">(</span>point<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    g<span class="token punctuation">.</span><span class="token function">DrawRectangle</span><span class="token punctuation">(</span>new <span class="token function">Pen</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Red<span class="token punctuation">)</span><span class="token punctuation">,</span> rectangle<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            pictureBox1<span class="token punctuation">.</span>Image <span class="token operator">=</span> bmp<span class="token punctuation">;</span>
            <span class="token comment">//bmp.Dispose();</span>
            g<span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            IsPaint <span class="token operator">=</span> true<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>3.调用，添加一个form窗体</p> 
<pre><code class="prism language-c"> public partial class Form1 <span class="token operator">:</span> Form
    <span class="token punctuation">{<!-- --></span>
       
        public <span class="token function">Form1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          
            this<span class="token punctuation">.</span><span class="token function">SetStyle</span><span class="token punctuation">(</span>ControlStyles<span class="token punctuation">.</span>OptimizedDoubleBuffer <span class="token operator">|</span>
                ControlStyles<span class="token punctuation">.</span>UserPaint <span class="token operator">|</span>
                      ControlStyles<span class="token punctuation">.</span>AllPaintingInWmPaint<span class="token punctuation">,</span> true<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      
        AutoSizeFormClass AutoSizeFormClass <span class="token operator">=</span> new <span class="token function">AutoSizeFormClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      

        private <span class="token keyword">void</span> <span class="token function">Form1_Load</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            AutoSizeFormClass<span class="token punctuation">.</span><span class="token function">controllInitializeSize</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        private <span class="token keyword">void</span> <span class="token function">Form1_Resize</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>           
            userControl11<span class="token punctuation">.</span>IsPaint <span class="token operator">=</span> false<span class="token punctuation">;</span>
            AutoSizeFormClass<span class="token punctuation">.</span><span class="token function">controlAutoSize</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span> this<span class="token punctuation">.</span>WindowState<span class="token punctuation">)</span><span class="token punctuation">;</span>         
        <span class="token punctuation">}</span>           
    <span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_httpsdownloadcsdnnetdownloadweixin_4210368888166861_354"></a># 代码连接：<a href="https://download.csdn.net/download/weixin_42103688/88166861">本文的源代码</a></h2> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/396cd8f38f62cb10e8e3397906c96ad0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【OpenCV实战】简洁易懂的车牌号识别Python&#43;OpenCV实现“超详解”（含代码）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/32faa435a8b45dcc9420e4d25d7c625e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【数学】这可能是全网最易懂的贝叶斯公式讲解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>