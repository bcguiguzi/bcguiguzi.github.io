<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>è®¡ç®—æœºè®¾è®¡å¤§èµ› é¢˜ç›®ï¼šåŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„æ‰‹å†™å­—ç¬¦è¯†åˆ« - æ·±åº¦å­¦ä¹  - ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="è®¡ç®—æœºè®¾è®¡å¤§èµ› é¢˜ç›®ï¼šåŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„æ‰‹å†™å­—ç¬¦è¯†åˆ« - æ·±åº¦å­¦ä¹ " />
<meta property="og:description" content="æ–‡ç« ç›®å½• 0 å‰è¨€1 ç®€ä»‹2 LeNet-5 æ¨¡å‹çš„ä»‹ç»2.1 ç»“æ„è§£æ2.2 C1å±‚2.3 S2å±‚S2å±‚å’ŒC3å±‚è¿æ¥ 2.4 F6ä¸C5å±‚ 3 å†™æ•°å­—è¯†åˆ«ç®—æ³•æ¨¡å‹çš„æ„å»º3.1 è¾“å…¥å±‚è®¾è®¡3.2 æ¿€æ´»å‡½æ•°çš„é€‰å–3.3 å·ç§¯å±‚è®¾è®¡3.4 é™é‡‡æ ·å±‚3.5 è¾“å‡ºå±‚è®¾è®¡ 4 ç½‘ç»œæ¨¡å‹çš„æ€»ä½“ç»“æ„5 éƒ¨åˆ†å®ç°ä»£ç 6 åœ¨çº¿æ‰‹å†™è¯†åˆ«7 æœ€å 0 å‰è¨€ ğŸ”¥ ä¼˜è´¨ç«èµ›é¡¹ç›®ç³»åˆ—ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯
åŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„æ‰‹å†™å­—ç¬¦è¯†åˆ«
è¯¥é¡¹ç›®è¾ƒä¸ºæ–°é¢–ï¼Œé€‚åˆä½œä¸ºç«èµ›è¯¾é¢˜æ–¹å‘ï¼Œå­¦é•¿éå¸¸æ¨èï¼
ğŸ§¿ æ›´å¤šèµ„æ–™, é¡¹ç›®åˆ†äº«ï¼š
https://gitee.com/dancheng-senior/postgraduate
1 ç®€ä»‹ è¯¥è®¾è®¡å­¦é•¿ä½¿ç”¨pythonåŸºäºTensorFlowè®¾è®¡æ‰‹å†™æ•°å­—è¯†åˆ«ç®—æ³•ï¼Œå¹¶ç¼–ç¨‹å®ç°GUIç•Œé¢ï¼Œæ„å»ºæ‰‹å†™æ•°å­—è¯†åˆ«ç³»ç»Ÿã€‚
è¿™æ˜¯å­¦é•¿åšçš„æ·±åº¦å­¦ä¹ demoï¼Œå¤§å®¶å¯ä»¥ç”¨äºç«èµ›è¯¾é¢˜ã€‚
è¿™é‡Œå­¦é•¿ä¸ä¼šä»¥è®ºæ–‡çš„å½¢å¼å±•ç°ï¼Œè€Œæ˜¯ä»¥ç¼–ç¨‹å®æˆ˜å®Œæˆæ·±åº¦å­¦ä¹ é¡¹ç›®çš„è§’åº¦å»æè¿°ã€‚
é¡¹ç›®è¦æ±‚ï¼šä¸»è¦è§£å†³çš„é—®é¢˜æ˜¯æ‰‹å†™æ•°å­—è¯†åˆ«ï¼Œæœ€ç»ˆè¦å®Œæˆä¸€ä¸ªè¯†åˆ«ç³»ç»Ÿã€‚
è®¾è®¡è¯†åˆ«ç‡é«˜çš„ç®—æ³•ï¼Œå®ç°å¿«é€Ÿè¯†åˆ«çš„ç³»ç»Ÿã€‚
2 LeNet-5 æ¨¡å‹çš„ä»‹ç» å­¦é•¿å®ç°æ‰‹å†™æ•°å­—è¯†åˆ«ï¼Œä½¿ç”¨çš„æ˜¯å·ç§¯ç¥ç»ç½‘ç»œï¼Œå»ºæ¨¡æ€æƒ³æ¥è‡ªLeNet-5ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
2.1 ç»“æ„è§£æ è¿™æ˜¯åŸå§‹çš„åº”ç”¨äºæ‰‹å†™æ•°å­—è¯†åˆ«çš„ç½‘ç»œï¼Œæˆ‘è®¤ä¸ºè¿™ä¹Ÿæ˜¯æœ€ç®€å•çš„æ·±åº¦ç½‘ç»œã€‚
LeNet-5ä¸åŒ…æ‹¬è¾“å…¥ï¼Œä¸€å…±7å±‚ï¼Œè¾ƒä½å±‚ç”±å·ç§¯å±‚å’Œæœ€å¤§æ± åŒ–å±‚äº¤æ›¿æ„æˆï¼Œæ›´é«˜å±‚åˆ™æ˜¯å…¨è¿æ¥å’Œé«˜æ–¯è¿æ¥ã€‚
LeNet-5çš„è¾“å…¥ä¸BPç¥ç»ç½‘è·¯çš„ä¸ä¸€æ ·ã€‚è¿™é‡Œå‡è®¾å›¾åƒæ˜¯é»‘ç™½çš„ï¼Œé‚£ä¹ˆLeNet-5çš„è¾“å…¥æ˜¯ä¸€ä¸ª32*32çš„äºŒç»´çŸ©é˜µã€‚åŒ
æ—¶ï¼Œè¾“å…¥ä¸ä¸‹ä¸€å±‚å¹¶ä¸æ˜¯å…¨è¿æ¥çš„ï¼Œè€Œæ˜¯è¿›è¡Œç¨€ç–è¿æ¥ã€‚æœ¬å±‚æ¯ä¸ªç¥ç»å…ƒçš„è¾“å…¥æ¥è‡ªäºå‰ä¸€å±‚ç¥ç»å…ƒçš„å±€éƒ¨åŒºåŸŸ(5Ã—5)ï¼Œå·ç§¯æ ¸å¯¹åŸå§‹å›¾åƒå·ç§¯çš„ç»“æœåŠ ä¸Šç›¸åº”çš„é˜ˆå€¼ï¼Œå¾—å‡ºçš„ç»“æœå†ç»è¿‡æ¿€æ´»å‡½æ•°å¤„ç†ï¼Œè¾“å‡ºå³å½¢æˆå·ç§¯å±‚ï¼ˆCå±‚ï¼‰ã€‚å·ç§¯å±‚ä¸­çš„æ¯ä¸ªç‰¹å¾æ˜ å°„éƒ½å„è‡ªå…±äº«æƒé‡å’Œé˜ˆå€¼ï¼Œè¿™æ ·èƒ½å¤§å¤§å‡å°‘è®­ç»ƒå¼€é”€ã€‚é™é‡‡æ ·å±‚ï¼ˆSå±‚ï¼‰ä¸ºå‡å°‘æ•°æ®é‡åŒæ—¶ä¿å­˜æœ‰ç”¨ä¿¡æ¯ï¼Œè¿›è¡ŒäºšæŠ½æ ·ã€‚
2.2 C1å±‚ ç¬¬ä¸€ä¸ªå·ç§¯å±‚ï¼ˆC1å±‚ï¼‰ç”±6ä¸ªç‰¹å¾æ˜ å°„æ„æˆï¼Œæ¯ä¸ªç‰¹å¾æ˜ å°„æ˜¯ä¸€ä¸ª28Ã—28çš„ç¥ç»å…ƒé˜µåˆ—ï¼Œå…¶ä¸­æ¯ä¸ªç¥ç»å…ƒè´Ÿè´£ä»5Ã—5çš„åŒºåŸŸé€šè¿‡å·ç§¯æ»¤æ³¢å™¨æå–å±€éƒ¨ç‰¹å¾ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ»¤æ³¢å™¨æ•°é‡è¶Šå¤šï¼Œå°±ä¼šå¾—å‡ºè¶Šå¤šçš„ç‰¹å¾æ˜ å°„ï¼Œåæ˜ è¶Šå¤šçš„åŸå§‹å›¾åƒçš„ç‰¹å¾ã€‚æœ¬å±‚è®­ç»ƒå‚æ•°å…±6Ã—(5Ã—5&#43;1)=156ä¸ªï¼Œæ¯ä¸ªåƒç´ ç‚¹éƒ½æ˜¯ç”±ä¸Šå±‚5Ã—5=25ä¸ªåƒç´ ç‚¹å’Œ1ä¸ªé˜ˆå€¼è¿æ¥è®¡ç®—æ‰€å¾—ï¼Œå…±28Ã—28Ã—156=122304ä¸ªè¿æ¥ã€‚
2.3 S2å±‚ S2å±‚æ˜¯å¯¹åº”ä¸Šè¿°6ä¸ªç‰¹å¾æ˜ å°„çš„é™é‡‡æ ·å±‚ï¼ˆpoolingå±‚ï¼‰ã€‚poolingå±‚çš„å®ç°æ–¹æ³•æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯max-poolingå’Œmean-
poolingï¼ŒLeNet-5é‡‡ç”¨çš„æ˜¯mean-
poolingï¼Œå³å–nÃ—nåŒºåŸŸå†…åƒç´ çš„å‡å€¼ã€‚C1é€šè¿‡2Ã—2çš„çª—å£åŒºåŸŸåƒç´ æ±‚å‡å€¼å†åŠ ä¸Šæœ¬å±‚çš„é˜ˆå€¼ï¼Œç„¶åç»è¿‡æ¿€æ´»å‡½æ•°çš„å¤„ç†ï¼Œå¾—åˆ°S2å±‚ã€‚poolingçš„å®ç°ï¼Œåœ¨ä¿å­˜å›¾ç‰‡ä¿¡æ¯çš„åŸºç¡€ä¸Šï¼Œå‡å°‘äº†æƒé‡å‚æ•°ï¼Œé™ä½äº†è®¡ç®—æˆæœ¬ï¼Œè¿˜èƒ½æ§åˆ¶è¿‡æ‹Ÿåˆã€‚æœ¬å±‚å­¦ä¹ å‚æ•°å…±æœ‰1*6&#43;6=12ä¸ªï¼ŒS2ä¸­çš„æ¯ä¸ªåƒç´ éƒ½ä¸C1å±‚ä¸­çš„2Ã—2ä¸ªåƒç´ å’Œ1ä¸ªé˜ˆå€¼ç›¸è¿ï¼Œå…±6Ã—(2Ã—2&#43;1)Ã—14Ã—14=5880ä¸ªè¿æ¥ã€‚
S2å±‚å’ŒC3å±‚è¿æ¥ S2å±‚å’ŒC3å±‚çš„è¿æ¥æ¯”è¾ƒå¤æ‚ã€‚C3å·ç§¯å±‚æ˜¯ç”±16ä¸ªå¤§å°ä¸º10Ã—10çš„ç‰¹å¾æ˜ å°„ç»„æˆçš„ï¼Œå½“ä¸­çš„æ¯ä¸ªç‰¹å¾æ˜ å°„ä¸S2å±‚çš„è‹¥å¹²ä¸ªç‰¹å¾æ˜ å°„çš„å±€éƒ¨æ„Ÿå—é‡ï¼ˆå¤§å°ä¸º5Ã—5ï¼‰ç›¸è¿ã€‚å…¶ä¸­ï¼Œå‰6ä¸ªç‰¹å¾æ˜ å°„ä¸S2å±‚è¿ç»­3ä¸ªç‰¹å¾æ˜ å°„ç›¸è¿ï¼Œåé¢æ¥ç€çš„6ä¸ªæ˜ å°„ä¸S2å±‚çš„è¿ç»­çš„4ä¸ªç‰¹å¾æ˜ å°„ç›¸è¿ï¼Œç„¶åçš„3ä¸ªç‰¹å¾æ˜ å°„ä¸S2å±‚ä¸è¿ç»­çš„4ä¸ªç‰¹å¾æ˜ å°„ç›¸è¿ï¼Œæœ€åä¸€ä¸ªæ˜ å°„ä¸S2å±‚çš„æ‰€æœ‰ç‰¹å¾æ˜ å°„ç›¸è¿ã€‚
æ­¤å¤„å·ç§¯æ ¸å¤§å°ä¸º5Ã—5ï¼Œæ‰€ä»¥å­¦ä¹ å‚æ•°å…±æœ‰6Ã—(3Ã—5Ã—5&#43;1)&#43;9Ã—(4Ã—5Ã—5&#43;1)&#43;1Ã—(6Ã—5Ã—5&#43;1)=1516ä¸ªå‚æ•°ã€‚è€Œå›¾åƒå¤§å°ä¸º28Ã—28ï¼Œå› æ­¤å…±æœ‰151600ä¸ªè¿æ¥ã€‚
S4å±‚æ˜¯å¯¹C3å±‚è¿›è¡Œçš„é™é‡‡æ ·ï¼Œä¸S2åŒç†ï¼Œå­¦ä¹ å‚æ•°æœ‰16Ã—1&#43;16=32ä¸ªï¼ŒåŒæ—¶å…±æœ‰16Ã—(2Ã—2&#43;1)Ã—5Ã—5=2000ä¸ªè¿æ¥ã€‚
C5å±‚æ˜¯ç”±120ä¸ªå¤§å°ä¸º1Ã—1çš„ç‰¹å¾æ˜ å°„ç»„æˆçš„å·ç§¯å±‚ï¼Œè€Œä¸”S4å±‚ä¸C5å±‚æ˜¯å…¨è¿æ¥çš„ï¼Œå› æ­¤å­¦ä¹ å‚æ•°æ€»ä¸ªæ•°ä¸º120Ã—(16Ã—25&#43;1)=48120ä¸ªã€‚
2.4 F6ä¸C5å±‚ F6æ˜¯ä¸C5å…¨è¿æ¥çš„84ä¸ªç¥ç»å…ƒï¼Œæ‰€ä»¥å…±æœ‰84Ã—(120&#43;1)=10164ä¸ªå­¦ä¹ å‚æ•°ã€‚
å·ç§¯ç¥ç»ç½‘ç»œé€šè¿‡é€šè¿‡ç¨€ç–è¿æ¥å’Œå…±äº«æƒé‡å’Œé˜ˆå€¼ï¼Œå¤§å¤§å‡å°‘äº†è®¡ç®—çš„å¼€é”€ï¼ŒåŒæ—¶ï¼Œpoolingçš„å®ç°ï¼Œä¸€å®šç¨‹åº¦ä¸Šå‡å°‘äº†è¿‡æ‹Ÿåˆé—®é¢˜çš„å‡ºç°ï¼Œéå¸¸é€‚åˆç”¨äºå›¾åƒçš„å¤„ç†å’Œè¯†åˆ«ã€‚
3 å†™æ•°å­—è¯†åˆ«ç®—æ³•æ¨¡å‹çš„æ„å»º 3." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/2efca5652dad88690a78aaf5d7b8548f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-15T15:51:18+08:00" />
<meta property="article:modified_time" content="2024-03-15T15:51:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">è®¡ç®—æœºè®¾è®¡å¤§èµ› é¢˜ç›®ï¼šåŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„æ‰‹å†™å­—ç¬¦è¯†åˆ« - æ·±åº¦å­¦ä¹ </h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#0__2" rel="nofollow">0 å‰è¨€</a></li><li><a href="#1__19" rel="nofollow">1 ç®€ä»‹</a></li><li><a href="#2_LeNet5__31" rel="nofollow">2 LeNet-5 æ¨¡å‹çš„ä»‹ç»</a></li><li><ul><li><a href="#21__37" rel="nofollow">2.1 ç»“æ„è§£æ</a></li><li><a href="#22_C1_46" rel="nofollow">2.2 C1å±‚</a></li><li><a href="#23_S2_50" rel="nofollow">2.3 S2å±‚</a></li><li><ul><li><a href="#S2C3_56" rel="nofollow">S2å±‚å’ŒC3å±‚è¿æ¥</a></li></ul> 
   </li><li><a href="#24_F6C5_65" rel="nofollow">2.4 F6ä¸C5å±‚</a></li></ul> 
  </li><li><a href="#3__71" rel="nofollow">3 å†™æ•°å­—è¯†åˆ«ç®—æ³•æ¨¡å‹çš„æ„å»º</a></li><li><ul><li><a href="#31__73" rel="nofollow">3.1 è¾“å…¥å±‚è®¾è®¡</a></li><li><a href="#32__79" rel="nofollow">3.2 æ¿€æ´»å‡½æ•°çš„é€‰å–</a></li><li><a href="#33__85" rel="nofollow">3.3 å·ç§¯å±‚è®¾è®¡</a></li><li><a href="#34__89" rel="nofollow">3.4 é™é‡‡æ ·å±‚</a></li><li><a href="#35__93" rel="nofollow">3.5 è¾“å‡ºå±‚è®¾è®¡</a></li></ul> 
  </li><li><a href="#4__99" rel="nofollow">4 ç½‘ç»œæ¨¡å‹çš„æ€»ä½“ç»“æ„</a></li><li><a href="#5__103" rel="nofollow">5 éƒ¨åˆ†å®ç°ä»£ç </a></li><li><a href="#6__267" rel="nofollow">6 åœ¨çº¿æ‰‹å†™è¯†åˆ«</a></li><li><a href="#7__277" rel="nofollow">7 æœ€å</a></li></ul> 
</div> 
<p></p> 
<h2><a id="0__2"></a>0 å‰è¨€</h2> 
<p>ğŸ”¥ ä¼˜è´¨ç«èµ›é¡¹ç›®ç³»åˆ—ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯</p> 
<p><strong>åŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„æ‰‹å†™å­—ç¬¦è¯†åˆ«</strong></p> 
<p>è¯¥é¡¹ç›®è¾ƒä¸ºæ–°é¢–ï¼Œé€‚åˆä½œä¸ºç«èµ›è¯¾é¢˜æ–¹å‘ï¼Œå­¦é•¿éå¸¸æ¨èï¼</p> 
<p>ğŸ§¿ <strong>æ›´å¤šèµ„æ–™, é¡¹ç›®åˆ†äº«ï¼š</strong></p> 
<p><a href="https://gitee.com/dancheng-senior/postgraduate" rel="nofollow">https://gitee.com/dancheng-senior/postgraduate</a></p> 
<p><img src="https://images2.imgbox.com/60/4e/uv68mrQp_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="1__19"></a>1 ç®€ä»‹</h2> 
<p>è¯¥è®¾è®¡å­¦é•¿ä½¿ç”¨pythonåŸºäºTensorFlowè®¾è®¡æ‰‹å†™æ•°å­—è¯†åˆ«ç®—æ³•ï¼Œå¹¶ç¼–ç¨‹å®ç°GUIç•Œé¢ï¼Œæ„å»ºæ‰‹å†™æ•°å­—è¯†åˆ«ç³»ç»Ÿã€‚</p> 
<p>è¿™æ˜¯å­¦é•¿åšçš„æ·±åº¦å­¦ä¹ demoï¼Œå¤§å®¶å¯ä»¥ç”¨äºç«èµ›è¯¾é¢˜ã€‚</p> 
<p>è¿™é‡Œå­¦é•¿ä¸ä¼šä»¥è®ºæ–‡çš„å½¢å¼å±•ç°ï¼Œè€Œæ˜¯ä»¥ç¼–ç¨‹å®æˆ˜å®Œæˆæ·±åº¦å­¦ä¹ é¡¹ç›®çš„è§’åº¦å»æè¿°ã€‚</p> 
<p><strong>é¡¹ç›®è¦æ±‚ï¼šä¸»è¦è§£å†³çš„é—®é¢˜æ˜¯æ‰‹å†™æ•°å­—è¯†åˆ«ï¼Œæœ€ç»ˆè¦å®Œæˆä¸€ä¸ªè¯†åˆ«ç³»ç»Ÿã€‚</strong></p> 
<p><strong>è®¾è®¡è¯†åˆ«ç‡é«˜çš„ç®—æ³•ï¼Œå®ç°å¿«é€Ÿè¯†åˆ«çš„ç³»ç»Ÿã€‚</strong></p> 
<h2><a id="2_LeNet5__31"></a>2 LeNet-5 æ¨¡å‹çš„ä»‹ç»</h2> 
<p>å­¦é•¿å®ç°æ‰‹å†™æ•°å­—è¯†åˆ«ï¼Œä½¿ç”¨çš„æ˜¯å·ç§¯ç¥ç»ç½‘ç»œï¼Œå»ºæ¨¡æ€æƒ³æ¥è‡ªLeNet-5ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> 
<p><img src="https://images2.imgbox.com/42/1f/V65gsf0X_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="21__37"></a>2.1 ç»“æ„è§£æ</h3> 
<p>è¿™æ˜¯åŸå§‹çš„åº”ç”¨äºæ‰‹å†™æ•°å­—è¯†åˆ«çš„ç½‘ç»œï¼Œæˆ‘è®¤ä¸ºè¿™ä¹Ÿæ˜¯æœ€ç®€å•çš„æ·±åº¦ç½‘ç»œã€‚</p> 
<p>LeNet-5ä¸åŒ…æ‹¬è¾“å…¥ï¼Œä¸€å…±7å±‚ï¼Œè¾ƒä½å±‚ç”±å·ç§¯å±‚å’Œæœ€å¤§æ± åŒ–å±‚äº¤æ›¿æ„æˆï¼Œæ›´é«˜å±‚åˆ™æ˜¯å…¨è¿æ¥å’Œé«˜æ–¯è¿æ¥ã€‚</p> 
<p>LeNet-5çš„è¾“å…¥ä¸BPç¥ç»ç½‘è·¯çš„ä¸ä¸€æ ·ã€‚è¿™é‡Œå‡è®¾å›¾åƒæ˜¯é»‘ç™½çš„ï¼Œé‚£ä¹ˆLeNet-5çš„è¾“å…¥æ˜¯ä¸€ä¸ª32*32çš„äºŒç»´çŸ©é˜µã€‚åŒ<br> æ—¶ï¼Œè¾“å…¥ä¸ä¸‹ä¸€å±‚å¹¶ä¸æ˜¯å…¨è¿æ¥çš„ï¼Œè€Œæ˜¯è¿›è¡Œç¨€ç–è¿æ¥ã€‚æœ¬å±‚æ¯ä¸ªç¥ç»å…ƒçš„è¾“å…¥æ¥è‡ªäºå‰ä¸€å±‚ç¥ç»å…ƒçš„å±€éƒ¨åŒºåŸŸ(5Ã—5)ï¼Œå·ç§¯æ ¸å¯¹åŸå§‹å›¾åƒå·ç§¯çš„ç»“æœåŠ ä¸Šç›¸åº”çš„é˜ˆå€¼ï¼Œå¾—å‡ºçš„ç»“æœå†ç»è¿‡æ¿€æ´»å‡½æ•°å¤„ç†ï¼Œè¾“å‡ºå³å½¢æˆå·ç§¯å±‚ï¼ˆCå±‚ï¼‰ã€‚å·ç§¯å±‚ä¸­çš„æ¯ä¸ªç‰¹å¾æ˜ å°„éƒ½å„è‡ªå…±äº«æƒé‡å’Œé˜ˆå€¼ï¼Œè¿™æ ·èƒ½å¤§å¤§å‡å°‘è®­ç»ƒå¼€é”€ã€‚é™é‡‡æ ·å±‚ï¼ˆSå±‚ï¼‰ä¸ºå‡å°‘æ•°æ®é‡åŒæ—¶ä¿å­˜æœ‰ç”¨ä¿¡æ¯ï¼Œè¿›è¡ŒäºšæŠ½æ ·ã€‚</p> 
<h3><a id="22_C1_46"></a>2.2 C1å±‚</h3> 
<p>ç¬¬ä¸€ä¸ªå·ç§¯å±‚ï¼ˆC1å±‚ï¼‰ç”±6ä¸ªç‰¹å¾æ˜ å°„æ„æˆï¼Œæ¯ä¸ªç‰¹å¾æ˜ å°„æ˜¯ä¸€ä¸ª28Ã—28çš„ç¥ç»å…ƒé˜µåˆ—ï¼Œå…¶ä¸­æ¯ä¸ªç¥ç»å…ƒè´Ÿè´£ä»5Ã—5çš„åŒºåŸŸé€šè¿‡å·ç§¯æ»¤æ³¢å™¨æå–å±€éƒ¨ç‰¹å¾ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ»¤æ³¢å™¨æ•°é‡è¶Šå¤šï¼Œå°±ä¼šå¾—å‡ºè¶Šå¤šçš„ç‰¹å¾æ˜ å°„ï¼Œåæ˜ è¶Šå¤šçš„åŸå§‹å›¾åƒçš„ç‰¹å¾ã€‚æœ¬å±‚è®­ç»ƒå‚æ•°å…±6Ã—(5Ã—5+1)=156ä¸ªï¼Œæ¯ä¸ªåƒç´ ç‚¹éƒ½æ˜¯ç”±ä¸Šå±‚5Ã—5=25ä¸ªåƒç´ ç‚¹å’Œ1ä¸ªé˜ˆå€¼è¿æ¥è®¡ç®—æ‰€å¾—ï¼Œå…±28Ã—28Ã—156=122304ä¸ªè¿æ¥ã€‚</p> 
<h3><a id="23_S2_50"></a>2.3 S2å±‚</h3> 
<p>S2å±‚æ˜¯å¯¹åº”ä¸Šè¿°6ä¸ªç‰¹å¾æ˜ å°„çš„é™é‡‡æ ·å±‚ï¼ˆpoolingå±‚ï¼‰ã€‚poolingå±‚çš„å®ç°æ–¹æ³•æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯max-poolingå’Œmean-<br> poolingï¼ŒLeNet-5é‡‡ç”¨çš„æ˜¯mean-<br> poolingï¼Œå³å–nÃ—nåŒºåŸŸå†…åƒç´ çš„å‡å€¼ã€‚C1é€šè¿‡2Ã—2çš„çª—å£åŒºåŸŸåƒç´ æ±‚å‡å€¼å†åŠ ä¸Šæœ¬å±‚çš„é˜ˆå€¼ï¼Œç„¶åç»è¿‡æ¿€æ´»å‡½æ•°çš„å¤„ç†ï¼Œå¾—åˆ°S2å±‚ã€‚poolingçš„å®ç°ï¼Œåœ¨ä¿å­˜å›¾ç‰‡ä¿¡æ¯çš„åŸºç¡€ä¸Šï¼Œå‡å°‘äº†æƒé‡å‚æ•°ï¼Œé™ä½äº†è®¡ç®—æˆæœ¬ï¼Œè¿˜èƒ½æ§åˆ¶è¿‡æ‹Ÿåˆã€‚æœ¬å±‚å­¦ä¹ å‚æ•°å…±æœ‰1*6+6=12ä¸ªï¼ŒS2ä¸­çš„æ¯ä¸ªåƒç´ éƒ½ä¸C1å±‚ä¸­çš„2Ã—2ä¸ªåƒç´ å’Œ1ä¸ªé˜ˆå€¼ç›¸è¿ï¼Œå…±6Ã—(2Ã—2+1)Ã—14Ã—14=5880ä¸ªè¿æ¥ã€‚</p> 
<h4><a id="S2C3_56"></a>S2å±‚å’ŒC3å±‚è¿æ¥</h4> 
<p>S2å±‚å’ŒC3å±‚çš„è¿æ¥æ¯”è¾ƒå¤æ‚ã€‚C3å·ç§¯å±‚æ˜¯ç”±16ä¸ªå¤§å°ä¸º10Ã—10çš„ç‰¹å¾æ˜ å°„ç»„æˆçš„ï¼Œå½“ä¸­çš„æ¯ä¸ªç‰¹å¾æ˜ å°„ä¸S2å±‚çš„è‹¥å¹²ä¸ªç‰¹å¾æ˜ å°„çš„å±€éƒ¨æ„Ÿå—é‡ï¼ˆå¤§å°ä¸º5Ã—5ï¼‰ç›¸è¿ã€‚å…¶ä¸­ï¼Œå‰6ä¸ªç‰¹å¾æ˜ å°„ä¸S2å±‚è¿ç»­3ä¸ªç‰¹å¾æ˜ å°„ç›¸è¿ï¼Œåé¢æ¥ç€çš„6ä¸ªæ˜ å°„ä¸S2å±‚çš„è¿ç»­çš„4ä¸ªç‰¹å¾æ˜ å°„ç›¸è¿ï¼Œç„¶åçš„3ä¸ªç‰¹å¾æ˜ å°„ä¸S2å±‚ä¸è¿ç»­çš„4ä¸ªç‰¹å¾æ˜ å°„ç›¸è¿ï¼Œæœ€åä¸€ä¸ªæ˜ å°„ä¸S2å±‚çš„æ‰€æœ‰ç‰¹å¾æ˜ å°„ç›¸è¿ã€‚</p> 
<p>æ­¤å¤„å·ç§¯æ ¸å¤§å°ä¸º5Ã—5ï¼Œæ‰€ä»¥å­¦ä¹ å‚æ•°å…±æœ‰6Ã—(3Ã—5Ã—5+1)+9Ã—(4Ã—5Ã—5+1)+1Ã—(6Ã—5Ã—5+1)=1516ä¸ªå‚æ•°ã€‚è€Œå›¾åƒå¤§å°ä¸º28Ã—28ï¼Œå› æ­¤å…±æœ‰151600ä¸ªè¿æ¥ã€‚</p> 
<p>S4å±‚æ˜¯å¯¹C3å±‚è¿›è¡Œçš„é™é‡‡æ ·ï¼Œä¸S2åŒç†ï¼Œå­¦ä¹ å‚æ•°æœ‰16Ã—1+16=32ä¸ªï¼ŒåŒæ—¶å…±æœ‰16Ã—(2Ã—2+1)Ã—5Ã—5=2000ä¸ªè¿æ¥ã€‚<br> C5å±‚æ˜¯ç”±120ä¸ªå¤§å°ä¸º1Ã—1çš„ç‰¹å¾æ˜ å°„ç»„æˆçš„å·ç§¯å±‚ï¼Œè€Œä¸”S4å±‚ä¸C5å±‚æ˜¯å…¨è¿æ¥çš„ï¼Œå› æ­¤å­¦ä¹ å‚æ•°æ€»ä¸ªæ•°ä¸º120Ã—(16Ã—25+1)=48120ä¸ªã€‚</p> 
<h3><a id="24_F6C5_65"></a>2.4 F6ä¸C5å±‚</h3> 
<p>F6æ˜¯ä¸C5å…¨è¿æ¥çš„84ä¸ªç¥ç»å…ƒï¼Œæ‰€ä»¥å…±æœ‰84Ã—(120+1)=10164ä¸ªå­¦ä¹ å‚æ•°ã€‚</p> 
<p>å·ç§¯ç¥ç»ç½‘ç»œé€šè¿‡é€šè¿‡ç¨€ç–è¿æ¥å’Œå…±äº«æƒé‡å’Œé˜ˆå€¼ï¼Œå¤§å¤§å‡å°‘äº†è®¡ç®—çš„å¼€é”€ï¼ŒåŒæ—¶ï¼Œpoolingçš„å®ç°ï¼Œä¸€å®šç¨‹åº¦ä¸Šå‡å°‘äº†è¿‡æ‹Ÿåˆé—®é¢˜çš„å‡ºç°ï¼Œéå¸¸é€‚åˆç”¨äºå›¾åƒçš„å¤„ç†å’Œè¯†åˆ«ã€‚</p> 
<h2><a id="3__71"></a>3 å†™æ•°å­—è¯†åˆ«ç®—æ³•æ¨¡å‹çš„æ„å»º</h2> 
<h3><a id="31__73"></a>3.1 è¾“å…¥å±‚è®¾è®¡</h3> 
<p>è¾“å…¥ä¸º28Ã—28çš„çŸ©é˜µï¼Œè€Œä¸æ˜¯å‘é‡ã€‚</p> 
<p><img src="https://images2.imgbox.com/14/a8/iX7YVyFn_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="32__79"></a>3.2 æ¿€æ´»å‡½æ•°çš„é€‰å–</h3> 
<p>Sigmoidå‡½æ•°å…·æœ‰å…‰æ»‘æ€§ã€é²æ£’æ€§å’Œå…¶å¯¼æ•°å¯ç”¨è‡ªèº«è¡¨ç¤ºçš„ä¼˜ç‚¹ï¼Œä½†å…¶è¿ç®—æ¶‰åŠæŒ‡æ•°è¿ç®—ï¼Œåå‘ä¼ æ’­æ±‚è¯¯å·®æ¢¯åº¦æ—¶ï¼Œæ±‚å¯¼åˆæ¶‰åŠä¹˜é™¤è¿ç®—ï¼Œè®¡ç®—é‡ç›¸å¯¹è¾ƒå¤§ã€‚åŒæ—¶ï¼Œé’ˆå¯¹æœ¬æ–‡æ„å»ºçš„å«æœ‰ä¸¤å±‚å·ç§¯å±‚å’Œé™é‡‡æ ·å±‚ï¼Œç”±äºsgmoidå‡½æ•°è‡ªèº«çš„ç‰¹æ€§ï¼Œåœ¨åå‘ä¼ æ’­æ—¶ï¼Œå¾ˆå®¹æ˜“å‡ºç°æ¢¯åº¦æ¶ˆå¤±çš„æƒ…å†µï¼Œä»è€Œéš¾ä»¥å®Œæˆç½‘ç»œçš„è®­ç»ƒã€‚å› æ­¤ï¼Œæœ¬æ–‡è®¾è®¡çš„ç½‘ç»œä½¿ç”¨ReLUå‡½æ•°ä½œä¸ºæ¿€æ´»å‡½æ•°ã€‚</p> 
<p><img src="https://images2.imgbox.com/73/8a/dd5fmzts_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="33__85"></a>3.3 å·ç§¯å±‚è®¾è®¡</h3> 
<p>å­¦é•¿è®¾è®¡å·ç§¯ç¥ç»ç½‘ç»œé‡‡å–çš„æ˜¯ç¦»æ•£å·ç§¯ï¼Œå·ç§¯æ­¥é•¿ä¸º1ï¼Œå³æ°´å¹³å’Œå‚ç›´æ–¹å‘æ¯æ¬¡è¿ç®—å®Œï¼Œç§»åŠ¨ä¸€ä¸ªåƒç´ ã€‚å·ç§¯æ ¸å¤§å°ä¸º5Ã—5ã€‚</p> 
<h3><a id="34__89"></a>3.4 é™é‡‡æ ·å±‚</h3> 
<p>å­¦é•¿è®¾è®¡çš„é™é‡‡æ ·å±‚çš„poolingæ–¹å¼æ˜¯max-poolingï¼Œå¤§å°ä¸º2Ã—2ã€‚</p> 
<h3><a id="35__93"></a>3.5 è¾“å‡ºå±‚è®¾è®¡</h3> 
<p>è¾“å‡ºå±‚è®¾ç½®ä¸º10ä¸ªç¥ç»ç½‘ç»œèŠ‚ç‚¹ã€‚æ•°å­—0~9çš„ç›®æ ‡å‘é‡å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p> 
<p><img src="https://images2.imgbox.com/da/84/znqFH2p3_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="4__99"></a>4 ç½‘ç»œæ¨¡å‹çš„æ€»ä½“ç»“æ„</h2> 
<p><img src="https://images2.imgbox.com/a4/ce/prQ8ZRL0_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="5__103"></a>5 éƒ¨åˆ†å®ç°ä»£ç </h2> 
<p>ä½¿ç”¨Pythonï¼Œè°ƒç”¨TensorFlowçš„apiå®Œæˆæ‰‹å†™æ•°å­—è¯†åˆ«çš„ç®—æ³•ã€‚</p> 
<p>æ³¨ï¼šæˆ‘çš„ç¨‹åºè¿è¡Œç¯å¢ƒæ˜¯ï¼šWin10,python3.ã€‚</p> 
<p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨Linuxä¸‹è¿è¡Œï¼Œç”±äºTensorFlowå¯¹py2å’Œpy3å…¼å®¹å¾—æ¯”è¾ƒå¥½ï¼Œåœ¨Linuxä¸‹å¯ä»¥åœ¨python2.7ä¸­è¿è¡Œã€‚</p> 
<p>â€‹</p> 
<pre><code class="prism language-python">
    <span class="token comment">#!/usr/bin/env python2</span>
    <span class="token comment"># -*- coding: utf-8 -*-</span>
   
    <span class="token comment">#import modules</span>
    <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
    <span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
    <span class="token comment">#from sklearn.metrics import confusion_matrix</span>
    <span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
    <span class="token keyword">import</span> time
    <span class="token keyword">from</span> datetime <span class="token keyword">import</span> timedelta
    <span class="token keyword">import</span> math
    <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>examples<span class="token punctuation">.</span>tutorials<span class="token punctuation">.</span>mnist <span class="token keyword">import</span> input_data

    <span class="token keyword">def</span> <span class="token function">new_weights</span><span class="token punctuation">(</span>shape<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>truncated_normal<span class="token punctuation">(</span>shape<span class="token punctuation">,</span>stddev<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">new_biases</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>constant<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span>shape<span class="token operator">=</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">conv2d</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>W<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>conv2d<span class="token punctuation">(</span>x<span class="token punctuation">,</span>W<span class="token punctuation">,</span>strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>padding<span class="token operator">=</span><span class="token string">'SAME'</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">max_pool_2x2</span><span class="token punctuation">(</span>inputx<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>max_pool<span class="token punctuation">(</span>inputx<span class="token punctuation">,</span>ksize<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>padding<span class="token operator">=</span><span class="token string">'SAME'</span><span class="token punctuation">)</span>
    
    <span class="token comment">#import data</span>
    data <span class="token operator">=</span> input_data<span class="token punctuation">.</span>read_data_sets<span class="token punctuation">(</span><span class="token string">"./data"</span><span class="token punctuation">,</span> one_hot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># one_hot means [0 0 1 0 0 0 0 0 0 0] stands for 2</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Size of:"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"--Training-set:\t\t{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>train<span class="token punctuation">.</span>labels<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"--Testing-set:\t\t{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>labels<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"--Validation-set:\t\t{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>labels<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>cls <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>labels<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># show the real test labels: [7 2 1 ..., 4 5 6], 10000values</span>
    
    x <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span><span class="token string">"float"</span><span class="token punctuation">,</span>shape<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span><span class="token number">784</span><span class="token punctuation">]</span><span class="token punctuation">,</span>name<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">)</span>
    x_image <span class="token operator">=</span> tf<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    y_true <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span><span class="token string">"float"</span><span class="token punctuation">,</span>shape<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>name<span class="token operator">=</span><span class="token string">'y_true'</span><span class="token punctuation">)</span>
    y_true_cls <span class="token operator">=</span> tf<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>dimension<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment"># Conv 1</span>
    layer_conv1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"weights"</span><span class="token punctuation">:</span>new_weights<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"biases"</span><span class="token punctuation">:</span>new_biases<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    h_conv1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>conv2d<span class="token punctuation">(</span>x_image<span class="token punctuation">,</span>layer_conv1<span class="token punctuation">[</span><span class="token string">"weights"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>layer_conv1<span class="token punctuation">[</span><span class="token string">"biases"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    h_pool1 <span class="token operator">=</span> max_pool_2x2<span class="token punctuation">(</span>h_conv1<span class="token punctuation">)</span>
    <span class="token comment"># Conv 2</span>
    layer_conv2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"weights"</span><span class="token punctuation">:</span>new_weights<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"biases"</span><span class="token punctuation">:</span>new_biases<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    h_conv2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>conv2d<span class="token punctuation">(</span>h_pool1<span class="token punctuation">,</span>layer_conv2<span class="token punctuation">[</span><span class="token string">"weights"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>layer_conv2<span class="token punctuation">[</span><span class="token string">"biases"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    h_pool2 <span class="token operator">=</span> max_pool_2x2<span class="token punctuation">(</span>h_conv2<span class="token punctuation">)</span>
    <span class="token comment"># Full-connected layer 1</span>
    fc1_layer <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"weights"</span><span class="token punctuation">:</span>new_weights<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token string">"biases"</span><span class="token punctuation">:</span>new_biases<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    h_pool2_flat <span class="token operator">=</span> tf<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h_pool2<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    h_fc1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>h_pool2_flat<span class="token punctuation">,</span>fc1_layer<span class="token punctuation">[</span><span class="token string">"weights"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>fc1_layer<span class="token punctuation">[</span><span class="token string">"biases"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># Droupout Layer</span>
    keep_prob <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span><span class="token string">"float"</span><span class="token punctuation">)</span>
    h_fc1_drop <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>dropout<span class="token punctuation">(</span>h_fc1<span class="token punctuation">,</span>keep_prob<span class="token punctuation">)</span>
    <span class="token comment"># Full-connected layer 2</span>
    fc2_layer <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"weights"</span><span class="token punctuation">:</span>new_weights<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           <span class="token string">"biases"</span><span class="token punctuation">:</span>new_weights<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token comment"># Predicted class</span>
    y_pred <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>h_fc1_drop<span class="token punctuation">,</span>fc2_layer<span class="token punctuation">[</span><span class="token string">"weights"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>fc2_layer<span class="token punctuation">[</span><span class="token string">"biases"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># The output is like [0 0 1 0 0 0 0 0 0 0]</span>
    y_pred_cls <span class="token operator">=</span> tf<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span>dimension<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># Show the real predict number like '2'</span>
    <span class="token comment"># cost function to be optimized</span>
    cross_entropy <span class="token operator">=</span> <span class="token operator">-</span>tf<span class="token punctuation">.</span>reduce_mean<span class="token punctuation">(</span>y_true<span class="token operator">*</span>tf<span class="token punctuation">.</span>log<span class="token punctuation">(</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
    optimizer <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span>AdamOptimizer<span class="token punctuation">(</span>learning_rate<span class="token operator">=</span><span class="token number">1e-4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>minimize<span class="token punctuation">(</span>cross_entropy<span class="token punctuation">)</span>
    <span class="token comment"># Performance Measures</span>
    correct_prediction <span class="token operator">=</span> tf<span class="token punctuation">.</span>equal<span class="token punctuation">(</span>y_pred_cls<span class="token punctuation">,</span>y_true_cls<span class="token punctuation">)</span>
    accuracy <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_mean<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>cast<span class="token punctuation">(</span>correct_prediction<span class="token punctuation">,</span><span class="token string">"float"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> sess<span class="token punctuation">:</span>
      init <span class="token operator">=</span> tf<span class="token punctuation">.</span>global_variables_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
      sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>init<span class="token punctuation">)</span>
      train_batch_size <span class="token operator">=</span> <span class="token number">50</span>
      <span class="token keyword">def</span> <span class="token function">optimize</span><span class="token punctuation">(</span>num_iterations<span class="token punctuation">)</span><span class="token punctuation">:</span>
        total_iterations<span class="token operator">=</span><span class="token number">0</span>
        start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>total_iterations<span class="token punctuation">,</span>total_iterations<span class="token operator">+</span>num_iterations<span class="token punctuation">)</span><span class="token punctuation">:</span>
          x_batch<span class="token punctuation">,</span>y_true_batch <span class="token operator">=</span> data<span class="token punctuation">.</span>train<span class="token punctuation">.</span>next_batch<span class="token punctuation">(</span>train_batch_size<span class="token punctuation">)</span>
          feed_dict_train_op <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>x<span class="token punctuation">:</span>x_batch<span class="token punctuation">,</span>y_true<span class="token punctuation">:</span>y_true_batch<span class="token punctuation">,</span>keep_prob<span class="token punctuation">:</span><span class="token number">0.5</span><span class="token punctuation">}</span>
          feed_dict_train <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>x<span class="token punctuation">:</span>x_batch<span class="token punctuation">,</span>y_true<span class="token punctuation">:</span>y_true_batch<span class="token punctuation">,</span>keep_prob<span class="token punctuation">:</span><span class="token number">1.0</span><span class="token punctuation">}</span>
          sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>optimizer<span class="token punctuation">,</span>feed_dict<span class="token operator">=</span>feed_dict_train_op<span class="token punctuation">)</span>
          <span class="token comment"># Print status every 100 iterations.</span>
          <span class="token keyword">if</span> i<span class="token operator">%</span><span class="token number">100</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token comment"># Calculate the accuracy on the training-set.</span>
            acc <span class="token operator">=</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>accuracy<span class="token punctuation">,</span>feed_dict<span class="token operator">=</span>feed_dict_train<span class="token punctuation">)</span>
            <span class="token comment"># Message for printing.</span>
            msg <span class="token operator">=</span> <span class="token string">"Optimization Iteration:{0:&gt;6}, Training Accuracy: {1:&gt;6.1%}"</span>
            <span class="token comment"># Print it.</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>acc<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># Update the total number of iterations performed</span>
        total_iterations <span class="token operator">+=</span> num_iterations
        <span class="token comment"># Ending time</span>
        end_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># Difference between start and end_times.</span>
        time_dif <span class="token operator">=</span> end_time<span class="token operator">-</span>start_time
        <span class="token comment"># Print the time-usage</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Time usage:"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>timedelta<span class="token punctuation">(</span>seconds<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>time_dif<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      test_batch_size <span class="token operator">=</span> <span class="token number">256</span>
      <span class="token keyword">def</span> <span class="token function">print_test_accuracy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Number of images in the test-set.</span>
        num_test <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>images<span class="token punctuation">)</span>
        cls_pred <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>shape<span class="token operator">=</span>num_test<span class="token punctuation">,</span>dtype<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">int</span><span class="token punctuation">)</span>
        i <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">while</span> i <span class="token operator">&lt;</span> num_test<span class="token punctuation">:</span>
          <span class="token comment"># The ending index for the next batch is denoted j.</span>
          j <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>i<span class="token operator">+</span>test_batch_size<span class="token punctuation">,</span>num_test<span class="token punctuation">)</span>
          <span class="token comment"># Get the images from the test-set between index i and j</span>
          images <span class="token operator">=</span> data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>images<span class="token punctuation">[</span>i<span class="token punctuation">:</span>j<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
          <span class="token comment"># Get the associated labels</span>
          labels <span class="token operator">=</span> data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>labels<span class="token punctuation">[</span>i<span class="token punctuation">:</span>j<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
          <span class="token comment"># Create a feed-dict with these images and labels.</span>
          feed_dict<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>x<span class="token punctuation">:</span>images<span class="token punctuation">,</span>y_true<span class="token punctuation">:</span>labels<span class="token punctuation">,</span>keep_prob<span class="token punctuation">:</span><span class="token number">1.0</span><span class="token punctuation">}</span>
          <span class="token comment"># Calculate the predicted class using Tensorflow.</span>
          cls_pred<span class="token punctuation">[</span>i<span class="token punctuation">:</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>y_pred_cls<span class="token punctuation">,</span>feed_dict<span class="token operator">=</span>feed_dict<span class="token punctuation">)</span>
          <span class="token comment"># Set the start-index for the next batch to the</span>
          <span class="token comment"># end-index of the current batch</span>
          i <span class="token operator">=</span> j
        cls_true <span class="token operator">=</span> data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>cls
        correct <span class="token operator">=</span> <span class="token punctuation">(</span>cls_true<span class="token operator">==</span>cls_pred<span class="token punctuation">)</span>
        correct_sum <span class="token operator">=</span> correct<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        acc <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>correct_sum<span class="token punctuation">)</span> <span class="token operator">/</span> num_test
        <span class="token comment"># Print the accuracy</span>
        msg <span class="token operator">=</span> <span class="token string">"Accuracy on Test-Set: {0:.1%} ({1}/{2})"</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span>correct_sum<span class="token punctuation">,</span>num_test<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token comment"># Performance after 10000 optimization iterations</span>
      optimize<span class="token punctuation">(</span>num_iterations<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">)</span>
      print_test_accuracy<span class="token punctuation">(</span><span class="token punctuation">)</span>
      savew_hl1 <span class="token operator">=</span> layer_conv1<span class="token punctuation">[</span><span class="token string">"weights"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      saveb_hl1 <span class="token operator">=</span> layer_conv1<span class="token punctuation">[</span><span class="token string">"biases"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      savew_hl2 <span class="token operator">=</span> layer_conv2<span class="token punctuation">[</span><span class="token string">"weights"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      saveb_hl2 <span class="token operator">=</span> layer_conv2<span class="token punctuation">[</span><span class="token string">"biases"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      savew_fc1 <span class="token operator">=</span> fc1_layer<span class="token punctuation">[</span><span class="token string">"weights"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      saveb_fc1 <span class="token operator">=</span> fc1_layer<span class="token punctuation">[</span><span class="token string">"biases"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      savew_op <span class="token operator">=</span> fc2_layer<span class="token punctuation">[</span><span class="token string">"weights"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      saveb_op <span class="token operator">=</span> fc2_layer<span class="token punctuation">[</span><span class="token string">"biases"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
      np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"savew_hl1.npy"</span><span class="token punctuation">,</span> savew_hl1<span class="token punctuation">)</span>
      np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"saveb_hl1.npy"</span><span class="token punctuation">,</span> saveb_hl1<span class="token punctuation">)</span>
      np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"savew_hl2.npy"</span><span class="token punctuation">,</span> savew_hl2<span class="token punctuation">)</span>
      np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"saveb_hl2.npy"</span><span class="token punctuation">,</span> saveb_hl2<span class="token punctuation">)</span>
      np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"savew_hl3.npy"</span><span class="token punctuation">,</span> savew_fc1<span class="token punctuation">)</span>
      np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"saveb_hl3.npy"</span><span class="token punctuation">,</span> saveb_fc1<span class="token punctuation">)</span>
      np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"savew_op.npy"</span><span class="token punctuation">,</span> savew_op<span class="token punctuation">)</span>
      np<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"saveb_op.npy"</span><span class="token punctuation">,</span> saveb_op<span class="token punctuation">)</span>

</code></pre> 
<p>è¿è¡Œç»“æœæ˜¾ç¤ºï¼šæµ‹è¯•é›†ä¸­å‡†ç¡®ç‡å¤§æ¦‚ä¸º99.2%ã€‚</p> 
<p><img src="https://images2.imgbox.com/c4/a3/nTVXntY7_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <strong>æŸ¥çœ‹æ··æ·†çŸ©é˜µ</strong></p> 
<p><img src="https://images2.imgbox.com/6a/e7/bW5WjDzV_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="6__267"></a>6 åœ¨çº¿æ‰‹å†™è¯†åˆ«</h2> 
<p><img src="https://images2.imgbox.com/d2/96/SiZsqltA_o.gif" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/cd/02/TVjE8vp1_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="7__277"></a>7 æœ€å</h2> 
<p>ğŸ§¿ <strong>æ›´å¤šèµ„æ–™, é¡¹ç›®åˆ†äº«ï¼š</strong></p> 
<p><a href="https://gitee.com/dancheng-senior/postgraduate" rel="nofollow">https://gitee.com/dancheng-senior/postgraduate</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/24dd309d11ab356b1fd5561d42ab5158/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">Tomcatä¼šè¯ä¿æŒ</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/633050a16e70df4a17a81532d58a2e8a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ã€ç¬¬ä¸‰ç« ã€‘ç¥ç»ç½‘ç»œçš„æ¶æ„-å‰é¦ˆç¥ç»ç½‘ç»œ</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>