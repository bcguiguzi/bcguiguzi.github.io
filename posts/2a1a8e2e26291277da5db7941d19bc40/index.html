<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>大数据OLAP引擎 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="大数据OLAP引擎" />
<meta property="og:description" content="一、OLAP介绍 1. OLAP简介 OLAP（Online AnalyticalProcessing）是一种数据处理技术，专门设计用于支持复杂的分析操作，侧重对决策人员和高层管理人员的决策支持。数据仓库对外数据能力的一种重要的输出方式。
OLAP遵循以下准则
OLAP模型必须提供多维概念视图透明性准则存取能力准则稳定的报表能力客户/服务器体系结构维的等同性准则动态的稀疏矩阵处理准则多用户支持能力准则非受限的跨维操作直观的数据操纵灵活的报表生成不受限的维与聚集层次 OLAP场景的关键特征
大多数是读请求数据总是以相当大的批(&gt; 1000 rows)进行写入不修改已添加的数据每次查询都从数据库中读取大量的行，但是同时又仅需要少量的列宽表，即每个表包含着大量的列较少的查询(通常每台服务器每秒数百个查询或更少)对于简单查询，允许延迟大约50毫秒列中的数据相对较小：数字和短字符串(例如，每个URL 60个字节)处理单个查询时需要高吞吐量（每个服务器每秒高达数十亿行）事务不是必须的对数据一致性要求低每一个查询除了一个大表外都很小查询结果明显小于源数据，换句话说，数据被过滤或聚合后能够被盛放在单台服务器的内存中 2. OLAP与OLTP OLTP系统强调数据库内存效率，强调内存各种指标的命令率，强调绑定变量，强调并发操作，强调事务性。典型作为后端服务的数据来源。
OLAP系统则强调数据分析，强调SQL执行时长，强调磁盘I/O，强调分区。典型作为数据报表、数据产品的数据来源。
OLTPOLAP使用场景在线业务服务数据分析，数据挖掘DB设计面向应用面向主题数据存储最新的数据历史的，多数据源的DB大小MB-GBGB-EB时间要求实时响应不严格要求数据模型关系模型(3范式)维度模型主要应用数据库数据仓库代表MySQLSQL on Hadoop、Kylin 3. OLAP常规操作 上卷（Roll Up）/聚合：选定某些维度，根据这些维度来聚合事实，如果用SQL来表达就是select dim_a, aggs_func(fact_b) from fact_table group by dim_a.
下钻（Drill Down）：上卷和下钻是相反的操作。它是选定某些维度（维度之间有层级关系，典型如年、月、日），将这些维度拆解出小的维度（如年拆解为月，省份拆解为城市），之后聚合事实。
切片（Slicing、Dicing）：选定某些维度，并根据特定值过滤这些维度的值，将原来的大Cube切成小cube。如dim_a in (‘CN’, ‘USA’)
旋转（Pivot/Rotate）：维度位置的互换。
二、OLAP引擎分类 目前市面上主流的开源OLAP引擎包含不限于：Hive、Spark SQL、Presto、Kylin、Impala、Druid、Clickhouse、Doris等，可以说目前没有一个引擎能在数据量，灵活程度和性能上做到完美，用户需要根据自己的需求进行选型。
主流的 OLAP 可以分为3类：多维 OLAP ( Multi-dimensional OLAP )、关系型 OLAP ( Relational OLAP ) 和混合 OLAP ( Hybrid OLAP ) 三大类。
1. 多维OLAP MOLAP的典型代表是：Druid、Kylin，MOLAP一般会根据用户定义的数据维度、度量（也可以叫指标）在数据写入时生成预聚合数据；Query查询到来时，实际上查询的是预聚合的数据而不是原始明细数据。
优点：数据预处理，将原始数据按照指定的计算规则预先做聚合计算，这样避免了查询过程中出现大量的即使计算，提升了查询性能。
缺点：限制后期数据查询的灵活性
2. 关系OALP ROLAP的典型代表是：Presto，Impala，GreenPlum，Clickhouse，Elasticsearch，Hive，Spark SQL，Flink SQL，Doris。数据写入时，ROLAP并未使用像MOLAP那样的预聚合技术；ROLAP收到Query请求时，会先解析Query，生成执行计划，扫描数据，执行关系型算子，在原始数据上做过滤(Where)、聚合(Sum, Avg, Count)、关联(Join)，分组（Group By)、排序（Order By）等，最后将结算结果返回给用户，整个过程都是即时计算，没有预先聚合好的数据可供优化查询速度，拼的都是资源和算力的大小。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/2a1a8e2e26291277da5db7941d19bc40/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-03T10:05:32+08:00" />
<meta property="article:modified_time" content="2022-12-03T10:05:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">大数据OLAP引擎</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="OLAP_0"></a>一、OLAP介绍</h2> 
<h3><a id="1_OLAP_2"></a>1. OLAP简介</h3> 
<p>OLAP（Online AnalyticalProcessing）是一种数据处理技术，专门设计用于支持复杂的分析操作，侧重对决策人员和高层管理人员的决策支持。数据仓库对外数据能力的一种重要的输出方式。</p> 
<ol><li> <p>OLAP遵循以下准则</p> 
  <ol><li>OLAP模型必须提供多维概念视图</li><li>透明性准则</li><li>存取能力准则</li><li>稳定的报表能力</li><li>客户/服务器体系结构</li><li>维的等同性准则</li><li>动态的稀疏矩阵处理准则</li><li>多用户支持能力准则</li><li>非受限的跨维操作</li><li>直观的数据操纵</li><li>灵活的报表生成</li><li>不受限的维与聚集层次</li></ol> </li><li> <p>OLAP场景的关键特征</p> 
  <ol><li>大多数是读请求</li><li>数据总是以相当大的批(&gt; 1000 rows)进行写入</li><li>不修改已添加的数据</li><li>每次查询都从数据库中读取大量的行，但是同时又仅需要少量的列</li><li>宽表，即每个表包含着大量的列</li><li>较少的查询(通常每台服务器每秒数百个查询或更少)</li><li>对于简单查询，允许延迟大约50毫秒</li><li>列中的数据相对较小：数字和短字符串(例如，每个URL 60个字节)</li><li>处理单个查询时需要高吞吐量（每个服务器每秒高达数十亿行）</li><li>事务不是必须的</li><li>对数据一致性要求低</li><li>每一个查询除了一个大表外都很小</li><li>查询结果明显小于源数据，换句话说，数据被过滤或聚合后能够被盛放在单台服务器的内存中</li></ol> </li></ol> 
<h3><a id="2_OLAPOLTP_35"></a>2. OLAP与OLTP</h3> 
<ul><li> <p>OLTP系统强调数据库内存效率，强调内存各种指标的命令率，强调绑定变量，强调并发操作，强调事务性。典型作为后端服务的数据来源。</p> </li><li> <p>OLAP系统则强调数据分析，强调SQL执行时长，强调磁盘I/O，强调分区。典型作为数据报表、数据产品的数据来源。</p> </li><li> 
  <table><thead><tr><th></th><th><strong>OLTP</strong></th><th><strong>OLAP</strong></th></tr></thead><tbody><tr><td><strong>使用场景</strong></td><td>在线业务服务</td><td>数据分析，数据挖掘</td></tr><tr><td><strong>DB设计</strong></td><td>面向应用</td><td>面向主题</td></tr><tr><td><strong>数据存储</strong></td><td>最新的数据</td><td>历史的，多数据源的</td></tr><tr><td><strong>DB大小</strong></td><td>MB-GB</td><td>GB-EB</td></tr><tr><td><strong>时间要求</strong></td><td>实时响应</td><td>不严格要求</td></tr><tr><td><strong>数据模型</strong></td><td>关系模型(3范式)</td><td>维度模型</td></tr><tr><td><strong>主要应用</strong></td><td>数据库</td><td>数据仓库</td></tr><tr><td><strong>代表</strong></td><td>MySQL</td><td>SQL on Hadoop、Kylin</td></tr></tbody></table></li></ul> 
<h3><a id="3_OLAP_52"></a>3. OLAP常规操作</h3> 
<ol><li> <p>上卷（Roll Up）/聚合：选定某些维度，根据这些维度来聚合事实，如果用SQL来表达就是select dim_a, aggs_func(fact_b) from fact_table group by dim_a.</p> </li><li> <p>下钻（Drill Down）：上卷和下钻是相反的操作。它是选定某些维度（维度之间有层级关系，典型如年、月、日），将这些维度拆解出小的维度（如年拆解为月，省份拆解为城市），之后聚合事实。</p> </li><li> <p>切片（Slicing、Dicing）：选定某些维度，并根据特定值过滤这些维度的值，将原来的大Cube切成小cube。如dim_a in (‘CN’, ‘USA’)</p> </li><li> <p>旋转（Pivot/Rotate）：维度位置的互换。</p> </li></ol> 
<p><img src="https://images2.imgbox.com/d4/e9/MCUoGlBX_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="OLAP_65"></a>二、OLAP引擎分类</h2> 
<p>目前市面上主流的开源OLAP引擎包含不限于：Hive、Spark SQL、Presto、Kylin、Impala、Druid、Clickhouse、Doris等，可以说目前没有一个引擎能在数据量，灵活程度和性能上做到完美，用户需要根据自己的需求进行选型。</p> 
<p>主流的 OLAP 可以分为3类：多维 OLAP ( Multi-dimensional OLAP )、关系型 OLAP ( Relational OLAP ) 和混合 OLAP ( Hybrid OLAP ) 三大类。</p> 
<h3><a id="1_OLAP_71"></a>1. 多维OLAP</h3> 
<p>MOLAP的典型代表是：Druid、Kylin，MOLAP一般会根据用户定义的数据维度、度量（也可以叫指标）在数据写入时生成预聚合数据；Query查询到来时，实际上查询的是预聚合的数据而不是原始明细数据。</p> 
<p>优点：数据预处理，将原始数据按照指定的计算规则预先做聚合计算，这样避免了查询过程中出现大量的即使计算，提升了查询性能。</p> 
<p>缺点：限制后期数据查询的灵活性</p> 
<h3><a id="2_OALP_79"></a>2. 关系OALP</h3> 
<p>ROLAP的典型代表是：Presto，Impala，GreenPlum，Clickhouse，Elasticsearch，Hive，Spark SQL，Flink SQL，Doris。数据写入时，ROLAP并未使用像MOLAP那样的预聚合技术；ROLAP收到Query请求时，会先解析Query，生成执行计划，扫描数据，执行关系型算子，在原始数据上做过滤(Where)、聚合(Sum, Avg, Count)、关联(Join)，分组（Group By)、排序（Order By）等，最后将结算结果返回给用户，整个过程都是即时计算，没有预先聚合好的数据可供优化查询速度，拼的都是资源和算力的大小。</p> 
<p>优缺点，与MOLAP恰好相反</p> 
<h3><a id="3_OLAP_85"></a>3. 混合OLAP</h3> 
<p>混合 OLAP，是 MOLAP 和 ROLAP 的一种融合。当查询聚合性数据的时候，使用MOLAP 技术；当查询明细数据时，使用 ROLAP 技术。在给定使用场景的前提下，以达到查询性能的最优化。</p> 
<h2><a id="_89"></a>三、各引擎对比</h2> 
<h3><a id="1__91"></a>1. 简单查询对比</h3> 
<p>简单查询指的是点查、简单聚合查询或者数据查询能够命中索引或物化视图。这样的查询经常出现在【数据产品服务】应用中，如阿里的生意参谋、腾讯的广点通等。这种查询通常有几个特点：对响应时间要求高；查询模型相对固定（可以通过数仓建模进行部分预计算）；并发量大。从下图可以看出，这些场景最合适的是，Elasticsearch、Doris、Druid、Kylin这些。<br> <img src="https://images2.imgbox.com/23/f1/fhNpldP0_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2__98"></a>2. 复杂查询对比</h3> 
<p>复杂查询指的是复杂聚合查询、大批量数据SCAN、复杂的查询（如JOIN）。在ad-hoc场景中，经常会有这样的查询，往往用户不能预先知道要查询什么，更多的是探索式的。像ES、Druid、Kylin，几乎是不支持这种查询。<br> <img src="https://images2.imgbox.com/95/4b/GwK6JXNR_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3__105"></a>3. 执行模型对比</h3> 
<p><img src="https://images2.imgbox.com/72/45/I4GaWwl7_o.jpg" alt="在这里插入图片描述"></p> 
<ul><li> <p>Scatter-Gather执行模型：相当于MapReduce中的一趟Map和Reduce，没有多轮的迭代，而且中间计算结果往往存储在内存中，通过网络直接交换。Elasticsearch、Druid、Kylin都是此模型。</p> </li><li> <p>MapReduce：Hive是此模型</p> </li><li> <p>MPP：MPP学名是大规模并行计算，其实很难给它一个准确的定义。如果说的宽泛一点，Presto、Impala、Doris、Clickhouse、Spark SQL、Flink SQL这些都算。</p> </li></ul> 
<h2><a id="_115"></a>四、各引擎介绍</h2> 
<h3><a id="4_Hive_117"></a>4. Hive</h3> 
<p><img src="https://images2.imgbox.com/1a/e9/VcXLnpGk_o.png" alt="在这里插入图片描述"></p> 
<p>Hive是一个分布式SQL on Hadoop方案，底层依赖MapReduce计算模型执行分布式计算。Hive擅长执行长时间运行的离线批处理，数据量越大，优势越明显。而且Hive需要的几乎仅仅是硬盘资源，节省成本，稳定性高，仍是OLAP引擎的主流选择之一。不过目前有被SparkSQL取代之势。</p> 
<p>MapReduce计算模型执行分布式计算。Hive擅长执行长时间运行的离线批处理，数据量越大，优势越明显。而且Hive需要的几乎仅仅是硬盘资源，节省成本，稳定性高，仍是OLAP引擎的主流选择之一。不过目前有被SparkSQL取代之势。</p> 
<ol><li> <h3><a id="_124"></a>未完待续…</h3> </li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d075918b441e496e08c8de0bc3ae066d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Next.js-基于文件的路由</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/31f4a1f78fc1e5f12712f9436907b3b2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">查看会议/期刊是否被EI收录</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>