<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>多区域的OSPF实战配置 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="多区域的OSPF实战配置" />
<meta property="og:description" content="多区域的OSPF实战配置 需求 如图配置设备的接口IP地址如图规划OSPF网络的区域要求每个设备的 router-id 都是 x.x.x.x（x是每个路由器的名字）确保不同的PC之间可以互通 拓扑图 配置命令 PC1： 192.168.1.1 255.255.255.0 192.168.1.254 PC2: 192.168.2.1 255.255.255.0 192.168.2.254 R1: undo terminal monitor system-view sysname R1 interface gi0/0/2 ip address 192.168.1.254 24 quit interface gi0/0/0 ip address 192.168.12.1 24 ospf authentication-mode simple plain hcip quit ospf 1 router-id 1.1.1.1 area 12 network 192.168.12.0 0.0.0.255 network 192.168.1.0 0.0.0.255 quit quit R2: undo terminal monitor system-view sysname R2 interface gi0/0/1 ip address 192.168.12.2 24 ospf authentication-mode simple plain hcip quit interface gi0/0/0 ip address 192." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/781fee2c62fe6839b624cce7e8a403a3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-26T10:24:17+08:00" />
<meta property="article:modified_time" content="2023-02-26T10:24:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">多区域的OSPF实战配置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="OSPF_0"></a>多区域的OSPF实战配置</h2> 
<h3><a id="_1"></a>需求</h3> 
<ul><li>如图配置设备的接口IP地址</li><li>如图规划OSPF网络的区域</li><li>要求每个设备的 router-id 都是 x.x.x.x（x是每个路由器的名字）</li><li>确保不同的PC之间可以互通</li></ul> 
<h3><a id="_6"></a>拓扑图</h3> 
<p><img src="https://images2.imgbox.com/5b/c7/764P8tu7_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_8"></a>配置命令</h3> 
<pre><code class="prism language-bash">PC1：
<span class="token number">192.168</span>.1.1
<span class="token number">255.255</span>.255.0
<span class="token number">192.168</span>.1.254

PC2:
<span class="token number">192.168</span>.2.1
<span class="token number">255.255</span>.255.0
<span class="token number">192.168</span>.2.254

R1:
undo terminal monitor
system-view
sysname R1
interface gi0/0/2
<span class="token function">ip</span> address <span class="token number">192.168</span>.1.254 <span class="token number">24</span>
quit
interface gi0/0/0
<span class="token function">ip</span> address <span class="token number">192.168</span>.12.1 <span class="token number">24</span>
ospf authentication-mode simple plain hcip
quit
ospf <span class="token number">1</span> router-id <span class="token number">1.1</span>.1.1
area <span class="token number">12</span>
network <span class="token number">192.168</span>.12.0 <span class="token number">0.0</span>.0.255
network <span class="token number">192.168</span>.1.0 <span class="token number">0.0</span>.0.255
quit
quit

R2:
undo terminal monitor
system-view
sysname R2
interface gi0/0/1
<span class="token function">ip</span> address <span class="token number">192.168</span>.12.2 <span class="token number">24</span>
ospf authentication-mode simple plain hcip
quit
interface gi0/0/0
<span class="token function">ip</span> address <span class="token number">192.168</span>.23.2 <span class="token number">24</span>
quit
ospf <span class="token number">1</span> router-id <span class="token number">2.2</span>.2.2
area <span class="token number">0</span> 
network <span class="token number">192.168</span>.23.0 <span class="token number">0.0</span>.0.255
authentication-mode simple plain hcie
quit
area <span class="token number">12</span>
network <span class="token number">192.168</span>.12.0 <span class="token number">0.0</span>.0.255
quit
quit


R3:
undo terminal monitor
system-view
sysname R3
interface gi0/0/1
<span class="token function">ip</span> address <span class="token number">192.168</span>.23.3 <span class="token number">24</span>
quit
interface gi0/0/0
<span class="token function">ip</span> address <span class="token number">192.168</span>.34.3 <span class="token number">24</span>
quit
ospf <span class="token number">1</span> router-id <span class="token number">3.3</span>.3.3
area <span class="token number">0</span> 
network <span class="token number">192.168</span>.23.0 <span class="token number">0.0</span>.0.255
network <span class="token number">192.168</span>.34.0 <span class="token number">0.0</span>.0.255
authentication-mode simple plain hcie
quit
quit


R4:
undo terminal monitor
system-view
sysname R4
interface gi0/0/1
<span class="token function">ip</span> address <span class="token number">192.168</span>.34.4 <span class="token number">24</span>
quit
interface gi0/0/0
<span class="token function">ip</span> address <span class="token number">192.168</span>.45.4 <span class="token number">24</span>
quit
ospf <span class="token number">1</span> router-id <span class="token number">4.4</span>.4.4
area <span class="token number">0</span> 
network <span class="token number">192.168</span>.45.0 <span class="token number">0.0</span>.0.255
network <span class="token number">192.168</span>.34.0 <span class="token number">0.0</span>.0.255
authentication-mode simple plain hcie
quit
quit


R5:
undo terminal monitor
system-view
sysname R5
interface gi0/0/1
<span class="token function">ip</span> address <span class="token number">192.168</span>.45.5 <span class="token number">24</span>
quit
interface gi0/0/0
<span class="token function">ip</span> address <span class="token number">192.168</span>.56.5 <span class="token number">24</span>
ospf authentication-mode md5 <span class="token number">9</span> HCIP
quit
ospf <span class="token number">1</span> router-id <span class="token number">5.5</span>.5.5
area <span class="token number">0</span> 
network <span class="token number">192.168</span>.45.0 <span class="token number">0.0</span>.0.255
authentication-mode simple plain hcie
quit
area <span class="token number">56</span>
network <span class="token number">192.168</span>.56.0 <span class="token number">0.0</span>.0.255
quit
quit



R6:
undo terminal monitor
system-view
sysname R6
interface gi0/0/1
<span class="token function">ip</span> address <span class="token number">192.168</span>.56.6 <span class="token number">24</span>
ospf authentication-mode md5 <span class="token number">9</span> HCIP
quit
interface gi0/0/2
<span class="token function">ip</span> address <span class="token number">192.168</span>.2.254 <span class="token number">24</span>
quit
ospf <span class="token number">1</span> router-id <span class="token number">6.6</span>.6.6
area <span class="token number">56</span>
network <span class="token number">192.168</span>.56.0 <span class="token number">0.0</span>.0.255
network <span class="token number">192.168</span>.2.0 <span class="token number">0.0</span>.0.255
quit
quit

</code></pre> 
<h3><a id="_142"></a>验证</h3> 
<p><img src="https://images2.imgbox.com/0c/f3/pNn2t4UQ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/67/e0/HLRNSlTT_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_145"></a>认证</h6> 
<ol><li>链路认证：指的是在接口上配置认证的相关命令 
  <ul><li> <p>开启认证以后，该端口发送OSPF报文时，都需要携带着密码</p> </li><li> <p>开启认证以后，该端口接收OSPF报文时，都需要检查对方携带的密码，是否和自己相同<br> <img src="https://images2.imgbox.com/32/1f/fntCAG7C_o.png" alt="在这里插入图片描述"></p> </li><li> <p>配置命令：</p> </li></ul> </li></ol> 
<pre><code class="prism language-Dart">链路认证，仅仅需要在“直接相连的2个OSPF设备之间”的端口上，进行配置。
配置原则是：链路两端的认证命令，保持完全相同，就一定可以认证成功！
比如：在R2和R3之间的链路上，启用链路认证：认证的类型是明文认证，认证的密码是HCIE。
配置命令如下：
R1:
interface gi0/0/0
ospf authentication-mode simple  hcip
quit 


R2:
interface gi0/0/1
ospf authentication-mode simple hcip
quit 

上面配置的“明文认证”，密码在传输过程中，是不加密的。所以非常不安全。
所以，我们建议使用“密文认证”：即密码在传输过程中是加密的，不容易被破解。

比如，我们在R3和R4之间，也是配置链路认证，认证方式是：md5，认证密码是：HCIP

R5：
interface gi0/0/0
ospf authentication-mode md5 9 HCIP
quit

R6：
interface gi0/0/1
ospf authentication-mode md5 9 HCIP
quit
</code></pre> 
<ol start="2"><li>区域认证：指的是在区域中配置认证的相关命令 
  <ul><li> <p>配置区域认证以后，那么该设备上，属于这个特定区域的所有链路，就都启用了认证功能。<br> <img src="https://images2.imgbox.com/ca/9f/vn9vpaWV_o.png" alt="在这里插入图片描述"></p> </li><li> <p>配置命令：</p> </li></ul> </li></ol> 
<pre><code class="prism language-Dart">例如：在R4的 0 区域中，配置“区域认证”，认证方式为 明文， 认证密码是 HAHA
R4:
ospf 1 
 area 0 
   authentication-mode simple plain hcie
   quit 
   
一旦配置了这个认证，R4上属于区域 0 的接口(Gi0/0/0和Gi0/0/1)就都启用认证了：
即在这两个端口上发送 OSPF 报文的时候，都加密码；
在这个两个端口上接收 OSPF 报文的时候，都检查密码；

所以结果是：
-R4和R5之间的邻居，断开了；
-R4和R3之间的邻居，挺好；
   纠结：此时R4和R3之间，发送的 OSPF 报文，到底是使用明文认证还是密文认证，使用的是HCIP还是hcie

结果是：   
   区域认证，相比较链路认证而言，节省了很多工作量，少配置了很多命令；
           但我们都启用区域认证的情况下，
           该区域的所有的OSPF路由器，都要配置相同的区域认证命令。
   如果同一个接口上，同时启用了链路认证和区域认证，那么链路认证的优先级更高。  
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e28ea0e25bb24922d107b0d720058764/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python 查看import package/function的具体路径</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2ce3e1b12680718f7e3622b1c0c04456/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Fast_boot</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>