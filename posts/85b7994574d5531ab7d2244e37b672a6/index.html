<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python的pandas库来实现将Excel文件转换为JSON格式的操作 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python的pandas库来实现将Excel文件转换为JSON格式的操作" />
<meta property="og:description" content="✅作者简介：2022年博客新星 第八。热爱国学的Java后端开发者，修心和技术同步精进。
🍎个人主页：Java Fans的博客
🍊个人信条：不迁怒，不贰过。小知识，大智慧。
💞当前专栏：Python案例分享专栏
✨特色专栏：国学周更-心性养成之路
🥭本文内容：Python的pandas库来实现将Excel文件转换为JSON格式的操作
文章目录 1、使用Flask将数据转为JSON数据提供给客户端2、使用pandas库实现Excel文件转换为JSON格式 1、使用Flask将数据转为JSON数据提供给客户端 如果您想创建一个本地接口来提供商品信息，您可以考虑使用Python以及一些流行的库来实现这个目标。以下是一些步骤和建议：
准备数据： 首先，确保您的Excel表包含商品信息，并将其保存为一个常见的数据格式，如CSV文件。这将使数据更容易在Python中处理。
安装Python： 如果您还没有安装Python，可以从Python官方网站下载并安装Python的最新版本。
选择Web框架： 为了创建本地接口，您可以选择一个Python的Web框架，如Flask或Django。对于初学者来说，Flask可能更容易入手。您可以使用以下命令安装Flask：
pip install Flask 创建Flask应用： 使用Flask，您可以创建一个简单的Web应用程序，将商品信息作为JSON数据提供给客户端。以下是一个简单的示例：
插入代码 复制代码 from flask import Flask, jsonify import pandas as pd app = Flask(__name__) # 读取CSV文件 data = pd.read_csv(&#39;商品信息.csv&#39;) @app.route(&#39;/api/products&#39;, methods=[&#39;GET&#39;]) def get_products(): # 将CSV数据转换为JSON格式 products = data.to_dict(orient=&#39;records&#39;) return jsonify(products) if __name__ == &#39;__main__&#39;: app.run(debug=True) 这个示例创建了一个Flask应用，它可以在访问/api/products端点时返回商品信息的JSON数据。
运行应用程序： 保存上述代码为一个Python文件（例如app.py），然后在命令行中运行它：
python app.py 这将启动本地Web服务器，并使您的接口在http://127.0.0.1:5000/api/products上可用。
测试接口： 使用浏览器或工具如Postman来测试您的接口。访问http://127.0.0.1:5000/api/products应该返回商品信息的JSON数据。
这只是一个简单的示例，您可以根据需要扩展和自定义接口。此外，如果您希望接口支持其他操作（如添加、编辑、删除商品信息），您可以在Flask应用中添加相应的路由和处理程序。
2、使用pandas库实现Excel文件转换为JSON格式 使用Python的pandas库来实现将Excel文件转换为JSON格式的操作。以下是一个简单的示例代码：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/85b7994574d5531ab7d2244e37b672a6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-08T16:58:37+08:00" />
<meta property="article:modified_time" content="2023-09-08T16:58:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python的pandas库来实现将Excel文件转换为JSON格式的操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/46/fe/Ap0uwdhK_o.gif" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>✅作者简介：2022年<font color="red">博客新星 <strong>第八</strong></font>。热爱国学的Java后端开发者，修心和技术同步精进。<br> 🍎个人主页：<a href="https://blog.csdn.net/hh867308122">Java Fans的博客</a><br> 🍊个人信条：不迁怒，不贰过。小知识，大智慧。<br> 💞当前专栏：<a href="https://blog.csdn.net/hh867308122/category_12000402.html">Python案例分享专栏</a><br> ✨特色专栏：<a href="https://blog.csdn.net/hh867308122/category_11971690.html">国学周更-心性养成之路</a><br> 🥭本文内容：Python的pandas库来实现将Excel文件转换为JSON格式的操作</p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#1FlaskJSON_12" rel="nofollow">1、使用Flask将数据转为JSON数据提供给客户端</a></li><li><a href="#2pandasExcelJSON_66" rel="nofollow">2、使用pandas库实现Excel文件转换为JSON格式</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p><img src="https://images2.imgbox.com/23/8c/sEpnBfOm_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="1FlaskJSON_12"></a>1、使用Flask将数据转为JSON数据提供给客户端</h3> 
<p>  如果您想创建一个本地接口来提供商品信息，您可以考虑使用Python以及一些流行的库来实现这个目标。以下是一些步骤和建议：</p> 
<p>  <strong>准备数据：</strong> 首先，确保您的Excel表包含商品信息，并将其保存为一个常见的数据格式，如CSV文件。这将使数据更容易在Python中处理。</p> 
<p>  <strong>安装Python：</strong> 如果您还没有安装Python，可以从Python官方网站下载并安装Python的最新版本。</p> 
<p>  <strong>选择Web框架：</strong> 为了创建本地接口，您可以选择一个Python的Web框架，如Flask或Django。对于初学者来说，Flask可能更容易入手。您可以使用以下命令安装Flask：</p> 
<pre><code class="prism language-p">pip install Flask
</code></pre> 
<p>  <strong>创建Flask应用：</strong> 使用Flask，您可以创建一个简单的Web应用程序，将商品信息作为JSON数据提供给客户端。以下是一个简单的示例：</p> 
<pre><code class="prism language-python">插入代码
复制代码
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> jsonify
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token comment"># 读取CSV文件</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'商品信息.csv'</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/api/products'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_products</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 将CSV数据转换为JSON格式</span>
    products <span class="token operator">=</span> data<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span>orient<span class="token operator">=</span><span class="token string">'records'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span>products<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<p>  这个示例创建了一个Flask应用，它可以在访问/api/products端点时返回商品信息的JSON数据。</p> 
<p>  <strong>运行应用程序：</strong> 保存上述代码为一个Python文件（例如app.py），然后在命令行中运行它：</p> 
<pre><code class="prism language-python">python app<span class="token punctuation">.</span>py
</code></pre> 
<p>  这将启动本地Web服务器，并使您的接口在http://127.0.0.1:5000/api/products上可用。</p> 
<p>  <strong>测试接口：</strong> 使用浏览器或工具如Postman来测试您的接口。访问http://127.0.0.1:5000/api/products应该返回商品信息的JSON数据。</p> 
<p>  这只是一个简单的示例，您可以根据需要扩展和自定义接口。此外，如果您希望接口支持其他操作（如添加、编辑、删除商品信息），您可以在Flask应用中添加相应的路由和处理程序。</p> 
<h3><a id="2pandasExcelJSON_66"></a>2、使用pandas库实现Excel文件转换为JSON格式</h3> 
<p>  使用Python的pandas库来实现将Excel文件转换为JSON格式的操作。以下是一个简单的示例代码：</p> 
<p>  首先，确保您已经安装了pandas库。如果没有安装，可以使用以下命令进行安装：</p> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> pandas
</code></pre> 
<p>  然后，您可以使用以下代码将Excel文件转换为JSON：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
</code></pre> 
<p><strong>读取Excel文件</strong><br>   df = pd.read_excel(‘your_excel_file.xlsx’) # 请将文件名替换为实际的Excel文件名</p> 
<p><strong>将DataFrame转换为JSON</strong><br> json_data = df.to_json(orient=‘records’)</p> 
<p>  上述代码中，your_excel_file.xlsx应该替换为实际的Excel文件名。df.to_json(orient=‘records’)将DataFrame对象转换为JSON格式，并以列表的形式返回。</p> 
<p>  最后，您可以在Flask应用中将JSON数据提供给客户端，例如：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> jsonify

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/api/data'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 这里将之前转换的JSON数据返回给客户端</span>
    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span>json_data<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<p>  在这个示例中，当访问/api/data端点时，Flask将返回之前转换的JSON数据。</p> 
<p>  请确保将文件名和路由根据您的实际需求进行适当更改。同时，也请注意异常处理和数据清理等方面的工作，以确保您的应用能够稳健运行。</p> 
<hr> 
<p><font color="#A2E043">  码文不易，本篇文章就介绍到这里，如果想要学习更多<font color="#ED7976"><strong>Java系列知识</strong></font>，<font color="orange"><strong>点击</strong></font><a href="https://blog.csdn.net/hh867308122?type=blog"><font color="red"><strong>关注博主</strong></font></a>，博主带你零基础学习Java知识。与此同时，对于日常生活有困扰的朋友，欢迎阅读我的<font color="#ED7976"><strong>第四栏目</strong></font>：<a href="https://blog.csdn.net/hh867308122/category_11971690.html">《国学周更—心性养成之路》</a>，学习技术的同时，我们也注重了心性的养成。</font></p> 
<p><img src="https://images2.imgbox.com/a5/1e/ZN5WKIQl_o.gif" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/76bc456c4ceae228bd8f8722bfe227f8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【python学习】基础篇-常用函数-format() 输出与字符串格式化操作 文字对齐、填充值、标志设置、格式化、类型转换、千位符(数字分组)等</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8d8be07790b0a47217932a796fbd6037/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ES6-ES12所有特性详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>