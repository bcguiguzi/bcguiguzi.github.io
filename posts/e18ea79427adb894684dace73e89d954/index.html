<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>iproute2工具集使用总结 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="iproute2工具集使用总结" />
<meta property="og:description" content="一. iproute2工具集介绍 iproute2是一组集成了网络配置指令ip的开源软件包，ip指令功能齐全，可以配置和查看网络接口（link），网络接口的地址（address），ARP（neighbour），路由（route），路由策略数据库（rule），隧道（tunnel）等等。ip命令非常强大，用于网络开发的一把利器，是时候放弃ifconfig命令了。
二. ip命令格式介绍 1. ip命令的一般格式：
ip [OPTIONS] OBJECT [COMMAND [ARGUMENTS] ]
OPTIONS：
-V，-Version ：打印iproute2工具集的版本号
-s，-stats，-statistics ：输出更多的信息
-f，-family { inet，inet6，link } ：强制使用哪个协议族
-4 ： -family inet 的缩写
-6 ： -family inet6 的缩写
-0 ： -family link 的缩写
-o，-oneline ： 以单行的形式输出查询结果，原来的换行符用 &#34;\&#34; 替代。
OBJECT：
link ： 物理或者逻辑网络接口
address ：网络设备的协议（IPv4和IPv6）地址
neighbour ： ARP条目相关
route ： 路由表条目
rule ： 路由策略数据库规则
tunnel ： 给予IP的隧道
COMMAND：
add，delete，show（list）
三. ip命令详细介绍 1. ip link - 网络设备配置" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/e18ea79427adb894684dace73e89d954/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-22T12:03:07+08:00" />
<meta property="article:modified_time" content="2023-01-22T12:03:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">iproute2工具集使用总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>一. iproute2工具集介绍</h4> 
<p>        iproute2是一组集成了网络配置指令ip的开源软件包，ip指令功能齐全，可以配置和查看网络接口（link），网络接口的地址（address），ARP（neighbour），路由（route），路由策略数据库（rule），隧道（tunnel）等等。ip命令非常强大，用于网络开发的一把利器，是时候放弃ifconfig命令了。</p> 
<p></p> 
<h4>二. ip命令格式介绍</h4> 
<p><strong><span style="color:#1a439c;">1. ip命令的一般格式：</span></strong></p> 
<p>     <em><span style="color:#1a439c;"><strong>  </strong> ip</span>  </em>[<em><span style="color:#1a439c;">OPTIONS</span></em>]<em>  <span style="color:#1a439c;">OBJECT</span> </em> [<span style="color:#1a439c;">COMMAND</span>  [<em><span style="color:#1a439c;">ARGUMENTS</span></em>] ]</p> 
<p><span style="color:#1a439c;">OPTIONS</span>：</p> 
<p><span style="color:#fe2c24;">-V，-Version </span>：打印iproute2工具集的版本号</p> 
<p><span style="color:#fe2c24;">-s，-stats，-statistics </span>：输出更多的信息</p> 
<p><span style="color:#fe2c24;">-f，-family { inet，inet6，link }</span> ：强制使用哪个协议族</p> 
<p><span style="color:#fe2c24;">-4</span> ： -family inet 的缩写</p> 
<p><span style="color:#fe2c24;">-6 </span>： -family inet6 的缩写</p> 
<p><span style="color:#fe2c24;">-0 </span>： -family link 的缩写</p> 
<p><span style="color:#fe2c24;">-o，-oneline</span> ： 以单行的形式输出查询结果，原来的换行符用 "\" 替代。</p> 
<p><span style="color:#1a439c;">OBJECT</span>：</p> 
<p><span style="color:#fe2c24;">link</span><span style="color:#1a439c;"> </span>： 物理或者逻辑网络接口</p> 
<p><span style="color:#fe2c24;">address</span> ：网络设备的协议（IPv4和IPv6）地址</p> 
<p><span style="color:#fe2c24;">neighbour</span> ： ARP条目相关</p> 
<p><span style="color:#fe2c24;">route </span>： 路由表条目</p> 
<p><span style="color:#fe2c24;">rule</span> ： 路由策略数据库规则</p> 
<p><span style="color:#fe2c24;">tunnel</span> ： 给予IP的隧道</p> 
<p><span style="color:#1a439c;">COMMAND</span>：</p> 
<p>        add，delete，show（list）</p> 
<p></p> 
<h4>三. ip命令详细介绍</h4> 
<p><span style="color:#1a439c;"><strong>1. ip link - 网络设备配置</strong></span></p> 
<p><strong><em><span style="color:#1a439c;">* ip link set（改变网络设备属性）</span></em></strong></p> 
<p>缩写形式：<span style="color:#fe2c24;">set， s</span></p> 
<p><span style="color:#1a439c;">参数：</span></p> 
<p><span style="color:#fe2c24;">dev NAME (default) </span>：指定要操作的网络接口</p> 
<p><span style="color:#fe2c24;">up / down </span>：改变接口的状态为UP或是DOWN</p> 
<p><span style="color:#fe2c24;">arp on / arp off </span>：改变网络接口的NOARP标志，决定接口能否发arp包</p> 
<p><span style="color:#fe2c24;">multicast on / multicast off </span>：改变网络接口MULTICAST标志</p> 
<p><span style="color:#fe2c24;">dynamic on / dynamic off </span>：修改网络接口DYNAMIC标志</p> 
<p><span style="color:#fe2c24;">name NAME</span> ：修改网络接口名</p> 
<p><span style="color:#fe2c24;">txqueuelen NUMBER / txqlen NUMBER</span> ：修改网络接口的发送队列长度</p> 
<p><span style="color:#fe2c24;">mtu NUMBER </span>：修改网络接口的MTU</p> 
<p><span style="color:#fe2c24;">address LLADDRESS</span> ：修改网络接口的MAC地址</p> 
<p><span style="color:#fe2c24;">broadcast LLADDRESS，brd LLADDRESS or peer LLADDRESS</span>：修改广播地址</p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>        ip link set br0 up</p> 
<p>        ip link set br0 name lan</p> 
<p>        ip link set br0 mtu 1500</p> 
<p>        ip link set br0 address 4E:0C:BC:44:4C:A2  </p> 
<p>        </p> 
<p><strong><em><span style="color:#1a439c;">* ip link show （查看网络设备属性）</span></em></strong></p> 
<p>缩写形式：<span style="color:#fe2c24;">show，list，lst，sh，ls，l</span></p> 
<p>参数：</p> 
<p><span style="color:#fe2c24;">dev NAME (default) </span>：显示指定网络接口，省略NAME，则显示所有接口</p> 
<p><span style="color:#fe2c24;">up </span>：显示所有在运行的网络接口</p> 
<p>举例：</p> 
<p>        ip link show dev br0</p> 
<p>        ip link show br0</p> 
<p>        ip link ls br0</p> 
<p>        ip link l br0</p> 
<p></p> 
<p><span style="color:#1a439c;"><strong>2. ip address - 协议地址管理</strong></span></p> 
<p>缩写形式：<span style="color:#fe2c24;">address，addr，a</span></p> 
<p>参数：add，delete，flush，show (list)</p> 
<p><span style="color:#1a439c;"><strong><em>* ip address add （添加新的协议地址）</em></strong></span></p> 
<p>缩写形式：<span style="color:#fe2c24;">add，a</span></p> 
<p>参数：</p> 
<p><span style="color:#fe2c24;">dev NAME</span> ：添加地址的接口</p> 
<p><span style="color:#fe2c24;">local ADDRESS (default)</span> ：接口的地址</p> 
<p><span style="color:#fe2c24;">peer ADDRESS </span>：用于pointtopoint接口，设置对端接口地址</p> 
<p><span style="color:#fe2c24;">broadcast ADDRESS</span> ：设置接口的广播地址</p> 
<p><span style="color:#1a439c;">举例：</span></p> 
<p>        ip address add 192.168.100.5/24 dev lan</p> 
<p>        <span style="color:#fe2c24;">ip addr</span> add 192.168.100.10/24 dev lan</p> 
<p><span style="color:#fe2c24;">        ip a</span> add 192.168.100.10/24 dev lan</p> 
<p></p> 
<p><em><strong><span style="color:#1a439c;">* ip address delete（删除</span>IP<span style="color:#1a439c;"><strong><em>地址</em></strong>）</span></strong></em></p> 
<p>缩写形式：<span style="color:#fe2c24;">delete，del，d</span></p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>        ip address del 192.168.100.5/24 dev br0</p> 
<p>        ip addr del 192.168.100.5/24 dev br0</p> 
<p></p> 
<p><strong><span style="color:#1a439c;"><em>* ip address show（查看</em></span><em><span style="color:#1a439c;">IP地址）</span></em></strong></p> 
<p>缩写形式：<span style="color:#fe2c24;">show，list，lst，sh，ls，l</span></p> 
<p>参数：</p> 
<p><span style="color:#fe2c24;">dev NAME (default) </span>：指定网络设备名称</p> 
<p><span style="color:#fe2c24;">scope SCOPE_VAL</span> ：列出指定scope的地址</p> 
<p><span style="color:#fe2c24;">to PREFIX</span> ：列出指定指定前缀的地址</p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>~ # ip addr show to 192.168.100.5<br> 6: lan: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default <br>     inet 192.168.100.5/32 scope global lan<br>        valid_lft forever preferred_lft forever<br>     inet 192.168.100.5/24 scope global secondary lan<br>        valid_lft forever preferred_lft forever</p> 
<p><br><span style="color:#1a439c;"><strong><em>* ip address flush（删除接口的IP地址）</em></strong></span></p> 
<p>缩写形式：<span style="color:#fe2c24;">flush，f</span></p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>        ip address flush dev br0 </p> 
<p>        ip a flush dev br0</p> 
<p></p> 
<p><span style="color:#1a439c;"><strong>3. ip neighbour - arp表管理</strong></span></p> 
<p>缩写形式：<span style="color:#fe2c24;">neighbour，neighbor，neigh，n</span></p> 
<p>参数：add，change，replace，delete，flush，show</p> 
<p><strong><span style="color:#1a439c;"><em>* ip neighbour add（添加新的ARP条目）</em></span></strong></p> 
<p><em><span style="color:#1a439c;"><strong>* ip neighbour change（修改存在的条目）</strong></span></em></p> 
<p><em><span style="color:#1a439c;"><strong>* ip neighbour replace（添加新的或修改一个存在的条目）</strong></span></em></p> 
<p>缩写形式：<span style="color:#fe2c24;">add，a；change，chg；replace，repl</span></p> 
<p><span style="color:#fe2c24;">to ADDRESS (default)</span> ：指定ARP的IP地址，IPv4或IPv6地址</p> 
<p><span style="color:#fe2c24;">dev NAME </span>：指定ARP表绑定的接口</p> 
<p><span style="color:#fe2c24;">lladdr LLADDRESS</span> ：指定ARP的MAC地址</p> 
<p><span style="color:#fe2c24;">nud NUD_STATE </span>：ARP条目的状态，NUD是"Neighbour Unreachability Detection"，状态有以下几个：</p> 
<p><span style="color:#fe2c24;">        - permanent </span>：添加的ARP表条目永久有效，除非手动操作移除</p> 
<p>        <span style="color:#fe2c24;">- noarp </span>：此ARP条目是有效的，但是不会尝试去验证它。生存周期到了将会被移除</p> 
<p><span style="color:#fe2c24;">        - reachable </span>：可达性超时时间之前，ARP条目都有效</p> 
<p>       <span style="color:#fe2c24;"> - stale</span> ：ARP条目有效，但是是可疑的。如果一个ARP条目本来就有效的，此选项不会改变条目的状态，地址也不会被改变</p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>        ip neighbour add 192.168.100.4 lladdr 42:a9:7f:86:22:5c dev lan</p> 
<p></p> 
<p><em><strong><span style="color:#1a439c;">* ip neighbour delete（删除ARP条目）</span></strong></em></p> 
<p>缩写形式：<span style="color:#fe2c24;">delete，del，d</span></p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>        ip neigh del 192.168.100.5 dev br0</p> 
<p></p> 
<p><strong><span style="color:#1a439c;"><em>* ip neighbour show（显示ARP条目）</em></span></strong></p> 
<p>缩写形式：<span style="color:#fe2c24;">show，list，sh，ls</span></p> 
<p>参数：</p> 
<p><span style="color:#fe2c24;">to ADDRESS (default) </span>：显示以ADDRESS前缀的ARP表</p> 
<p><span style="color:#fe2c24;">dev NAME</span> ：只显示网络接口NAME的ARP表</p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>        ip neigh show</p> 
<p></p> 
<p><strong><em><span style="color:#1a439c;">* ip neighbour flush（清空ARRP表）</span></em></strong></p> 
<p>缩写：<span style="color:#fe2c24;">flush，f</span></p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>        ip neighbour f dev br0</p> 
<p></p> 
<p><span style="color:#1a439c;"><strong>4. ip route - 路由表管理</strong></span></p> 
<p>缩写形式：<span style="color:#fe2c24;">route，ro，r</span></p> 
<p><strong><span style="color:#1a439c;"><em>* ip route add（添加新的路由表）</em></span></strong></p> 
<p><strong><span style="color:#1a439c;"><em>* ip route change（修改路由）</em></span></strong></p> 
<p><strong><span style="color:#1a439c;"><em>* ip route replace（修改或添加路由（如果原不存在））</em></span></strong></p> 
<p><span style="color:#fe2c24;">metric NUMBER or preference NUMBER</span>：路由的preference值</p> 
<p><span style="color:#fe2c24;">table TABLEID </span>：路由添加的路由表，可以是数字或字符串，字符串对应的数字参考<span style="color:#fe2c24;">/etc/iproute2/rt_tables</span></p> 
<p>[root@192 ~]# cat /etc/iproute2/rt_tables <br><span style="color:#fe2c24;">255</span>     local<br><span style="color:#fe2c24;">254</span>     main<br><span style="color:#fe2c24;">253</span>     default<br><span style="color:#fe2c24;">0 </span>        unspec<br><span style="color:#fe2c24;">dev NAME</span> ：路由的网络接口</p> 
<p><span style="color:#fe2c24;">via ADDRESS </span>：路由的下一跳地址</p> 
<p><span style="color:#fe2c24;">src ADDRESS</span> ：指定路由的原地址</p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>        ip route add 10.0.0/24 via 192.168.10.10</p> 
<p>        ip route add default dev eth1 via 192.168.10.10</p> 
<p></p> 
<p><strong><span style="color:#1a439c;"><em>* ip route delete（删除路由）</em></span></strong></p> 
<p>缩写形式：<span style="color:#fe2c24;">delete，del，d</span></p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>        ip route del default</p> 
<p></p> 
<p><strong><span style="color:#1a439c;"><em>* ip route show（查看路由表）</em></span></strong></p> 
<p>缩写形式：<span style="color:#fe2c24;">show，list，sh，ls，l</span></p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>        ip route show </p> 
<p>        ip route default</p> 
<p>        ip route show table 400</p> 
<p></p> 
<p><strong><span style="color:#1a439c;">5. ip rule - 路由策略数据库管理</span></strong></p> 
<p>缩写形式：<span style="color:#fe2c24;">rule，ru</span></p> 
<p>参数：add，show</p> 
<p><em><span style="color:#1a439c;"><strong>* ip rule add（插入新的rule）</strong></span></em></p> 
<p><em><span style="color:#1a439c;"><strong>* ip rule delete（删除rule）</strong></span></em></p> 
<p> 缩写形式：<span style="color:#fe2c24;">add，a，delete，del，d</span></p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>[root@192 ~]# ip rule add from all table 400 fwmark 400 priority 400</p> 
<p>[root@192 ~]# ip rule show<br> 400:    from all fwmark 0x190 lookup 400 </p> 
<p></p> 
<p><span style="color:#1a439c;"><strong>6. ip tunnel - ip隧道配置</strong></span></p> 
<p>缩写：<span style="color:#fe2c24;">tunnel，tunl</span></p> 
<p><strong><span style="color:#1a439c;"><em>* ip tunnel add（创建隧道）</em></span></strong></p> 
<p>缩写形式：<span style="color:#fe2c24;">add，a</span></p> 
<p>参数：</p> 
<p><span style="color:#fe2c24;">name NAME (default) </span>：选择隧道网络接口名</p> 
<p><span style="color:#fe2c24;">mode MODE </span>：设置隧道模式，有ipip，sit，gre模式</p> 
<p><span style="color:#fe2c24;">remote ADDRESS</span> ：设置隧道对端的地址</p> 
<p><span style="color:#fe2c24;">local ADDRESS </span>： 设置隧道本地地址</p> 
<p><span style="color:#fe2c24;">dev NAME</span> ：绑定隧道到一个网络接口，隧道的包将会通过此接口路由出去</p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>        ip tunl add cisco mode sit remote 10.0.0.10 local 10.0.0.1 ttl 32</p> 
<p></p> 
<p><strong><span style="color:#1a439c;"><em>* ip tunnel show（查看隧道属性）</em></span></strong></p> 
<p>缩写形式：<span style="color:#fe2c24;">show，list，sh，ls，l</span></p> 
<p><span style="color:#1a439c;">举例</span>：</p> 
<p>[root@192 ~]# ip tunl show<br> cisco: ipv6/ip remote 10.0.0.10 local 10.0.0.1 ttl 32 6rd-prefix 2002::/16</p> 
<p></p> 
<h4>四. 总结</h4> 
<p>        ip命令非常强大，所以用法也会有些复杂，本文只是写了粗浅的使用方法，后面工作使用到了新的内容会继续补充。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8456f88e67eb07ca60bf1043b2edc6da/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Simulink】使用Model Explorer设置模块变量初值</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ca525501b43beae15f01ad16ab6cf02e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Pygame中可能出现的安装问题（在Spyder使用中发现的）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>