<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java 从服务器下载文件并保存到本地 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java 从服务器下载文件并保存到本地" />
<meta property="og:description" content="昨天在做一个项目时，用到了从服务器上下载文件并保存到本地的知识，以前也没有接触过，昨天搞了一天，这个小功能实现了，下面就简单的说一下实现过程；
1.基础知识 当我们想要下载网站上的某个资源时，我们会获取一个url，它是服务器定位资源的一个描述，下载的过程有如下几步： （1）客户端发起一个url请求，获取连接对象。 （2）服务器解析url，并且将指定的资源返回一个输入流给客户。 （3）建立存储的目录以及保存的文件名。 （4）输出了写数据。 （5）关闭输入流和输出流。 2.实现代码的方法 /** * @功能 下载临时素材接口 * @param filePath 文件将要保存的目录 * @param method 请求方法，包括POST和GET * @param url 请求的路径 * @return */ public static File saveUrlAs(String url,String filePath,String method){ //System.out.println(&#34;fileName----&gt;&#34;&#43;filePath); //创建不同的文件夹目录 File file=new File(filePath); //判断文件夹是否存在 if (!file.exists()) { //如果文件夹不存在，则创建新的的文件夹 file.mkdirs(); } FileOutputStream fileOut = null; HttpURLConnection conn = null; InputStream inputStream = null; try { // 建立链接 URL httpUrl=new URL(url); conn=(HttpURLConnection) httpUrl.openConnection(); //以Post方式提交表单，默认get方式 conn." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/89c6dbce2ae6a42894424e3a0552d5d5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-05-28T10:33:55+08:00" />
<meta property="article:modified_time" content="2017-05-28T10:33:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java 从服务器下载文件并保存到本地</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><br> </p> 
<p>   昨天在做一个项目时，用到了从服务器上下载文件并保存到本地的知识，以前也没有接触过，昨天搞了一天，这个小功能实现了，下面就简单的说一下实现过程；</p> 
<h4>   1.基础知识</h4> 
<div>
            当我们想要下载网站上的某个资源时，我们会获取一个url，它是服务器定位资源的一个描述，下载的过程有如下几步： 
</div> 
<div>
      
</div> 
<div>
             （1）客户端发起一个url请求，获取连接对象。 
</div> 
<div>
             （2）服务器解析url，并且将指定的资源返回一个输入流给客户。 
</div> 
<div>
             （3）建立存储的目录以及保存的文件名。 
</div> 
<div>
             （4）输出了写数据。 
</div> 
<div>
             （5）关闭输入流和输出流。 
</div> 
<div> 
 <br> 
</div> 
<h4>    2.实现代码的方法</h4> 
<div>
          
 <pre><code class="language-html">	/**
	 * @功能 下载临时素材接口
	 * @param filePath 文件将要保存的目录
	 * @param method 请求方法，包括POST和GET
	 * @param url 请求的路径
	 * @return
	 */

	public static File saveUrlAs(String url,String filePath,String method){
		 //System.out.println("fileName----&gt;"+filePath);
		 //创建不同的文件夹目录
		 File file=new File(filePath);
		 //判断文件夹是否存在
		 if (!file.exists())
		{
			//如果文件夹不存在，则创建新的的文件夹
			 file.mkdirs();
		}
		 FileOutputStream fileOut = null;
		 HttpURLConnection conn = null;
		 InputStream inputStream = null;
		 try
		{
			 // 建立链接
			 URL httpUrl=new URL(url);
			 conn=(HttpURLConnection) httpUrl.openConnection();
			 //以Post方式提交表单，默认get方式
			 conn.setRequestMethod(method);
		     conn.setDoInput(true);  
		     conn.setDoOutput(true);
		     // post方式不能使用缓存 
		     conn.setUseCaches(false);
		     //连接指定的资源 
		     conn.connect();
		     //获取网络输入流
		     inputStream=conn.getInputStream();
		     BufferedInputStream bis = new BufferedInputStream(inputStream);
		     //判断文件的保存路径后面是否以/结尾
		     if (!filePath.endsWith("/")) {

		    	 filePath += "/";

		    	 }
		     //写入到文件（注意文件保存路径的后面一定要加上文件的名称）
	         fileOut = new FileOutputStream(filePath+"123.png");
	         BufferedOutputStream bos = new BufferedOutputStream(fileOut);
	         
	         byte[] buf = new byte[4096];
	         int length = bis.read(buf);
	         //保存文件
	         while(length != -1)
	         {
	        	 bos.write(buf, 0, length);
	        	 length = bis.read(buf);
	         }
	         bos.close();
	         bis.close();
	         conn.disconnect();
		} catch (Exception e)
		{
			 e.printStackTrace();
			 System.out.println("抛出异常！！");
		}
		 
		 return file;
		 
	 }</code></pre> 
 <h4>      3.代码测试类（主函数）</h4> 
 <div>
           
  <pre><code class="language-html">/**
	 * @param args
	 */
	public static void main(String[] args)
	{
		String photoUrl = "https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superman/img/logo/bd_logo1_31bdc765.png";                                    
        String fileName = photoUrl.substring(photoUrl.lastIndexOf("/")); 
        //System.out.println("fileName----&gt;"+fileName);
        String filePath = "d:";  
        File file = saveUrlAs(photoUrl, filePath + fileName,"GET");  
        System.out.println("Run ok!/n&lt;BR&gt;Get URL file " + file);  

	}</code></pre> 
  <br> 
 </div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4b70dd7ba5a6e8086a017f679af0a85f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Wayland】初识Wayland（X、Mir）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2ef90f14435e66aa2d6107d22df7422e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">实例详解不同VLAN间通信（转发过程）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>