<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【小程序从0到1】网络数据请求——request合法域名｜GET｜POST｜跨域？Ajax？ - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【小程序从0到1】网络数据请求——request合法域名｜GET｜POST｜跨域？Ajax？" />
<meta property="og:description" content="欢迎来到我的博客
📔博主是一名大学在读本科生，主要学习方向是前端。
🍭目前已经更新了【Vue】、【React–从基础到实战】、【TypeScript】等等系列专栏
🛠目前正在学习的是🔥 R e a c t / 小程序 React/小程序 React/小程序🔥，中间穿插了一些基础知识的回顾
🌈博客主页👉codeMak1r.小新的博客
😇本文目录😇 小程序中网络数据请求的限制配置request合法域名发起GET请求发起POST请求页面刚加载时请求数据 --- onLoad跳过request合法域名校验关于跨域和Ajax的说明 本文被专栏【小程序｜原力计划】收录
🕹坚持创作✏️，一起学习📖，码出未来👨🏻‍💻！
上篇文章详细讲解了微信小程序的页面配置，这篇文章将带领大家学习的是小程序的「网络数据请求」
小程序中网络数据请求的限制 处于安全性考虑，小程序官方对于数据接口的请求作出了如下两个限制：
只能请求https类型的接口；必须将接口的域名添加到信任列表中 需要将接口的域名添加到图中的request合法域名中。
配置request合法域名 假设需要在自己的微信小程序中，希望请求https://www.escook.cn/域名下的接口
配置步骤：登录微信小程序管理后台 ⇒ 开发 ⇒ 开发设置 ⇒ 服务器域名 ⇒ 修改request合法域名
⚠️注意：https://www.escook.cn是刘龙斌老师提供的域名。
域名只支持https协议域名不能使用IP地址或者localhost域名必须经过ICP备案服务器域名一个月内最多可申请50次修改 发起GET请求 调用微信小程序提供的 wx.request()方法，可以发起GET数据请求，示例代码如下：
（在小程序中有一个顶级的对象就是wx，相当于web开发中的window，此类对象不需要声明就可以直接使用）
getInfo() { wx.request({ url: &#39;https://www.escook.cn/api/get&#39;, // 请求的地址，必须基于https协议 method: &#39;GET&#39;, data: { name: &#39;zs&#39;, age: 20 }, success: res =&gt; { console.log(res.data); } }) 发起POST请求 调用微信小程序提供的 wx.request() 方法，可以发起POST数据请求，示例代码如下：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/0e781284f0170c14ff29992419347e08/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-12T14:45:45+08:00" />
<meta property="article:modified_time" content="2022-10-12T14:45:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【小程序从0到1】网络数据请求——request合法域名｜GET｜POST｜跨域？Ajax？</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p><strong><font color="#FF7F50"> 欢迎来到我的博客</font></strong><br> <strong>📔博主是一名大学在读本科生，主要学习方向是前端。<br> 🍭目前已经更新了<font color="#FF7F50">【Vue】、【React–从基础到实战】、【TypeScript】等等系列专栏</font><br> 🛠目前正在学习的是🔥<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           R 
          
         
           e 
          
         
           a 
          
         
           c 
          
         
           t 
          
         
           / 
          
         
           小程序 
          
         
        
          React/小程序 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord">/</span><span class="mord cjk_fallback">小程序</span></span></span></span></span>🔥，中间穿插了一些基础知识的回顾<br> 🌈博客主页👉<a href="https://blog.csdn.net/Svik_zy?type=blog">codeMak1r.小新的博客</a></strong></p> 
 <p></p> 
 <div class="toc"> 
  <h4>😇本文目录😇</h4> 
  <ul><li><a href="#_15" rel="nofollow">小程序中网络数据请求的限制</a></li><li><a href="#request_26" rel="nofollow">配置request合法域名</a></li><li><a href="#GET_41" rel="nofollow">发起GET请求</a></li><li><a href="#POST_62" rel="nofollow">发起POST请求</a></li><li><a href="#__onLoad_82" rel="nofollow">页面刚加载时请求数据 --- onLoad</a></li><li><a href="#request_95" rel="nofollow">跳过request合法域名校验</a></li><li><a href="#Ajax_103" rel="nofollow">关于跨域和Ajax的说明</a></li></ul> 
 </div> 
 <p></p> 
 <p><strong><font color="#FF7F50">本文被专栏<a href="https://blog.csdn.net/svik_zy/category_12002413.html?spm=1001.2014.3001.5482">【小程序｜原力计划】</a>收录</font></strong></p> 
</blockquote> 
<blockquote> 
 <p><strong><font color="#FF7F50">🕹坚持创作✏️，一起学习📖，码出未来👨🏻‍💻！</font></strong><br> <img src="https://images2.imgbox.com/98/02/ZtiKc4Xy_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p><strong>上篇文章详细讲解了微信小程序的页面配置，这篇文章将带领大家学习的是小程序的「网络数据请求」</strong></p> 
<h2><a id="_15"></a>小程序中网络数据请求的限制</h2> 
<blockquote> 
 <p>处于安全性考虑，小程序官方对于数据接口的请求作出了如下两个限制：</p> 
 <ul><li>只能请求https类型的接口；</li><li>必须将接口的域名添加到信任列表中</li></ul> 
</blockquote> 
<p><img src="https://images2.imgbox.com/9e/66/rlMWvdZG_o.png" alt="在这里插入图片描述" width="60%" height="60%"></p> 
<p>需要将接口的域名添加到图中的request合法域名中。</p> 
<h2><a id="request_26"></a>配置request合法域名</h2> 
<p>假设需要在自己的微信小程序中，希望请求<code>https://www.escook.cn/</code>域名下的接口</p> 
<p>配置步骤：登录微信小程序管理后台 ⇒ 开发 ⇒ 开发设置 ⇒ 服务器域名 ⇒ 修改request合法域名</p> 
<p><img src="https://images2.imgbox.com/29/b7/iKl3ltIQ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bd/64/kq9kVGiW_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>⚠️注意：<code>https://www.escook.cn</code>是刘龙斌老师提供的域名。</p> 
 <ul><li>域名只支持https协议</li><li>域名不能使用IP地址或者localhost</li><li>域名必须经过ICP备案</li><li>服务器域名一个月内最多可申请50次修改</li></ul> 
</blockquote> 
<h2><a id="GET_41"></a>发起GET请求</h2> 
<blockquote> 
 <p>调用微信小程序提供的 <code>wx.request()</code>方法，可以发起GET数据请求，示例代码如下：<br> （在小程序中有一个顶级的对象就是<code>wx</code>，相当于web开发中的<code>window</code>，此类对象不需要声明就可以直接使用）</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'https://www.escook.cn/api/get'</span><span class="token punctuation">,</span>  <span class="token comment">// 请求的地址，必须基于https协议</span>
      <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'zs'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/45/72/WLZM7rk3_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="POST_62"></a>发起POST请求</h2> 
<blockquote> 
 <p>调用微信小程序提供的 <code>wx.request()</code> 方法，可以发起POST数据请求，示例代码如下：</p> 
</blockquote> 
<pre><code class="prism language-javascript">wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'https://www.escook.cn/api/post'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'ls'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">33</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/bc/e5/QwS8jh76_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="__onLoad_82"></a>页面刚加载时请求数据 — onLoad</h2> 
<p>onLoad生命周期函数——监听页面加载</p> 
<blockquote> 
 <p>在很多情况下，我们需要在页面刚加载的时候，自动请求一些初始化的数据。此时需要在页面的 onLoad 事件中调用获取数据的函数，示例代码如下：</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token comment">// 生命周期函数——监听页面加载</span>
<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">postInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p>这样就可以在页面刚一加载时，就去调用<code>getInfo</code> / <code>postInfo</code>两个方法。</p> 
<h2><a id="request_95"></a>跳过request合法域名校验</h2> 
<blockquote> 
 <p>如果后端程序员仅仅提供了http协议的接口，暂时没有提供https协议的接口。<br> 此时为了不耽误开发进度，我们可以在微信开发者工具中，临时开启「开发环境不校验请求域名、TLS版本以及 HTTPS 证书」选项，跳过request合法域名校验。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/e7/35/RyFhLSB1_o.png" alt="在这里插入图片描述" width="60%" height="60%"></p> 
<p>注意：跳过request合法域名校验的选项，仅限在开发与调试阶段使用！</p> 
<h2><a id="Ajax_103"></a>关于跨域和Ajax的说明</h2> 
<blockquote> 
 <p>跨域问题只存在于基于浏览器的Web开发中。由于小程序的宿主环境不是浏览器，而是微信客户端，所以小程序中 <strong><font color="#FF7F50"> 不存在跨域问题 ！！</font></strong></p> 
</blockquote> 
<blockquote> 
 <p>Ajax技术的核心是依赖于浏览器中的 <code>XMLHttpRuquest</code>这个对象，由于小程序的宿主环境是微信客户端，所以小程序不能叫做<code>发起Ajax请求</code>，而是叫做 <code>发起网络数据请求</code>。</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8310990a84c72cba7d3d82ea2f80c3f4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">获取短信验证码</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/800869e71e448ab960e628c5cb1fa853/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java1逻辑运算符作业（16道）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>