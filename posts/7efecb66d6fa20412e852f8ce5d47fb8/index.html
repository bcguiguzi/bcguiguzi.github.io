<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Redis 8种基本数据类型及常用命令和数据类型的应用场景 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Redis 8种基本数据类型及常用命令和数据类型的应用场景" />
<meta property="og:description" content="小伙伴们好，欢迎关注，一起学习，无限进步
文章内容为学习的一些笔记及工作中遇到的一些问题
文章目录 Redis 五大数据类型keyStringListSetHashSorted Set 三种特殊类型Geospatial 地理位置HyperloglogBitmap Redis 五大数据类型 redis 官方网张：https://redis.io/
redis 常用命令：https://www.redis.net.cn/order/
使用 SpringBoot。Jedis 连接的方法也是这些命令
key # 验证 redis 服务密码 127.0.0.1:6379&gt; auth 123456 # 查看 redis 节点信息 127.0.0.1:6379&gt; info replication # 测试是否连接 redis 127.0.0.1:6379&gt; ping # 查看所有的key 127.0.0.1:6379&gt; keys * #关闭redis 127.0.0.1:6379&gt; shutdown # 退出 127.0.0.1:6379&gt; exit # 切换数据库 127.0.0.1:6379&gt; select 3 # 查看DB大小 127.0.0.1:6379&gt; DBSIZE # 清除当前数据库 127.0.0.1:6379&gt; flushdb # 清除全部数据库的内容 127.0.0.1:6379&gt; flushall # 判断当前的key是否存在 127.0.0.1:6379&gt; exists name 127." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/7efecb66d6fa20412e852f8ce5d47fb8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-02-28T11:59:02+08:00" />
<meta property="article:modified_time" content="2024-02-28T11:59:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Redis 8种基本数据类型及常用命令和数据类型的应用场景</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>小伙伴们好，欢迎关注，一起学习，无限进步<br> 文章内容为学习的一些笔记及工作中遇到的一些问题</p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#Redis__5" rel="nofollow">Redis 五大数据类型</a></li><li><ul><li><a href="#key_13" rel="nofollow">key</a></li><li><a href="#String_49" rel="nofollow">String</a></li><li><a href="#List_124" rel="nofollow">List</a></li><li><a href="#Set_191" rel="nofollow">Set</a></li><li><a href="#Hash_246" rel="nofollow">Hash</a></li><li><a href="#Sorted_Set_307" rel="nofollow">Sorted Set</a></li></ul> 
   </li><li><a href="#_358" rel="nofollow">三种特殊类型</a></li><li><ul><li><a href="#Geospatial__360" rel="nofollow">Geospatial 地理位置</a></li><li><a href="#Hyperloglog_391" rel="nofollow">Hyperloglog</a></li><li><a href="#Bitmap_427" rel="nofollow">Bitmap</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="Redis__5"></a>Redis 五大数据类型</h3> 
<p>redis 官方网张：https://redis.io/</p> 
<p>redis 常用命令：https://www.redis.net.cn/order/</p> 
<p>使用 SpringBoot。Jedis 连接的方法也是这些命令</p> 
<h4><a id="key_13"></a>key</h4> 
<pre><code class="prism language-bash"><span class="token comment"># 验证 redis 服务密码</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> auth <span class="token number">123456</span>
<span class="token comment"># 查看 redis 节点信息</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> info replication
<span class="token comment"># 测试是否连接 redis</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token function">ping</span>
<span class="token comment"># 查看所有的key</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys * 
<span class="token comment">#关闭redis </span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token function">shutdown</span>
<span class="token comment"># 退出</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">exit</span>  
<span class="token comment"># 切换数据库</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token keyword">select</span> <span class="token number">3</span>
<span class="token comment"># 查看DB大小</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> DBSIZE  
<span class="token comment"># 清除当前数据库</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> flushdb
<span class="token comment"># 清除全部数据库的内容</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> flushall
<span class="token comment"># 判断当前的key是否存在</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> exists name
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> name
<span class="token comment"># 移动key到第一个数据库</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> move name <span class="token number">1</span>
<span class="token comment"># 设置key的过期时间，单位是秒</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> expite name <span class="token number">10</span>
<span class="token comment"># 查看当前 key 的剩余时间</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ttl name  
<span class="token comment"># 查看当前key的一个类型</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">type</span> name
</code></pre> 
<h4><a id="String_49"></a>String</h4> 
<pre><code class="prism language-bash"><span class="token comment"># 设置值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> k1 v1  
<span class="token comment"># 获取值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get k1  
<span class="token comment"># 获取所有的 key</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys *
<span class="token comment"># 判断一个 key 是否存在</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> exists k1
<span class="token comment"># 获取字符串的长度</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> STRLEN key1
<span class="token comment"># 追加字符串，如果当前 key 不存在，就相当于set key</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> APPEND k1 <span class="token string">",Hello"</span>
<span class="token comment"># 初始浏览量为 0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> views <span class="token number">0</span>
<span class="token comment"># 自增1 浏览量变为1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incr views
<span class="token comment"># 自减1  浏览量-1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> decr views
<span class="token comment"># 可以设置步长，指定增加10</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incrby views <span class="token number">10</span> 
<span class="token comment"># 可以设置步长，指定减小10</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> decrby views <span class="token number">10</span> 
<span class="token comment"># 设置 k1 的值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> k1 <span class="token string">"hello,world"</span>
<span class="token comment"># 截取字符串 [0,3]</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getrange k1 <span class="token number">0</span> <span class="token number">3</span>
<span class="token comment"># 获取全部的字符串和 get key 是一样的</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getrange k1 <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token comment"># 设置 k2 的值 "12345678"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> k2 <span class="token string">"12345678"</span>
<span class="token comment"># 替换指定位置开始的字符串</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SETRANGE k2 <span class="token number">1</span> xx

<span class="token comment"># setex (set with expire)  # 设置过期时间</span>
<span class="token comment"># setnx (set if not exist)  # 不存在在设置 （在分布式锁中会常常使用！）</span>
<span class="token comment"># 设置key3 的值为 hello,30秒后过期</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setex k3 <span class="token number">30</span> <span class="token string">"hello"</span> 
<span class="token comment"># 查看 k3 过期时间</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ttl k3
<span class="token comment"># 如果 k3 不存在，创建 k3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setnx k3 <span class="token string">"haha"</span>
<span class="token comment"># 清除当前数据库的所有 key</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> flushdb
<span class="token comment"># 同时设置多个值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mset k1 v1 k2 v2 k3 v3  
<span class="token comment"># 同时获取多个值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mget k1 k2 k3

<span class="token comment"># msetnx 是一个原子性的操作，要么一起成功，要么一起失败 结果返回 0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> msetnx k1 v1 k4 v4

<span class="token comment"># 对象 set user:1 {name:zhangsan,age:3}  设置一个user:1 对象值为 json 字符来保存一个对象</span>
<span class="token comment"># 这里的key是一个巧妙的设计： user:{id}:{filed} , 如此设计在Redis中是完全OK了</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mset user:1:name zhangsan user:1:age <span class="token number">2</span>
<span class="token comment"># 获取对象中的值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mget user:1:name user:1:age

<span class="token comment"># getset  先get然后在set</span>
<span class="token comment"># 如果不存在值，则返回 nil</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getset db redis
<span class="token comment"># 如果存在值，获取原来的值，并设置新的值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getset db mongodb
</code></pre> 
<p>String类似的使用场景：value 除了是字符串还可以是数字</p> 
<ul><li>用户token</li><li>计数器</li><li>统计多单位的数量</li><li>粉丝数</li><li>对象缓存存储</li></ul> 
<h4><a id="List_124"></a>List</h4> 
<p>基本的数据类型，列表，在redis里面，list 是一种比较灵活的链表数据结构，可以充当栈、队列、阻塞队列</p> 
<p>list 列表是链表型的数据结构，所以它的元素是有序的，而且列表内的元素是可以重复的。意味着它可以根据链表的下标获取指定的元素和某个范围内的元素集。</p> 
<pre><code class="prism language-bash"><span class="token comment"># 将一个值或者多个值，插入到列表头部 （左）</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpush list one
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpush list one two three
<span class="token comment"># 获取 list 中的所有值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpush list <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token comment"># 通过区间获取具体的值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange lisr <span class="token number">0</span> <span class="token number">1</span>
<span class="token comment"># 将一个值或者多个值，插入到列表位部 （右）</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> rpush list righr

<span class="token comment"># 通过下标获得 list 中的某一个值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lindex list <span class="token number">1</span>
<span class="token comment"># 返回 list 列表的长度</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> llen list

<span class="token comment"># 移除list的第一个元素</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpop list
<span class="token comment"># 移除list的最后一个元素</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> rpop list  
<span class="token comment"># 移除list集合中指定个数的value，精确匹配</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrem list <span class="token number">1</span> one 


<span class="token comment"># trim 修剪 </span>
<span class="token comment"># 新建一个 newlist 集合</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpush newlist <span class="token string">"hello"</span> <span class="token string">"hello1"</span> <span class="token string">"hello2"</span> <span class="token string">"hello3"</span> <span class="token string">"hello4"</span>
<span class="token comment"># 通过下标截取指定的长度，这个list已经被改变了，截断了只剩下截取的元素</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ltrim newlist <span class="token number">1</span> <span class="token number">2</span>

<span class="token comment"># rpoplpush 移除列表的最后一个元素，将他移动到新的列表中</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> rpush newlist <span class="token string">"hello1"</span>
<span class="token comment"># 移除列表的最后一个元素，将他移动到新的列表中</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> rpoplpush another anotherlist
<span class="token comment"># 查看目标列表中，确实存在改值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange anotherlist <span class="token number">0</span> <span class="token parameter variable">-1</span> 

<span class="token comment"># lset 将列表中指定下标的值替换为另外一个值，更新操作</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> exists list
<span class="token comment"># 如果不存在列表更新机会报错，更新前先检查列表是否存在（0表示下表索引）</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lset list <span class="token number">0</span> item
<span class="token comment"># 如果下标不存在，则会报错</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lset list <span class="token number">10</span> other

<span class="token comment"># linsert 将某个具体的 value 插入到列表中某个元素的前面或者后面</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> rpush list <span class="token string">"hello"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> rpush list <span class="token string">"world"</span>
<span class="token comment"># 把 other 添加到 world 前面</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> linsert list before <span class="token string">"world"</span> <span class="token string">"other"</span>
<span class="token comment"># 把 another 添加到 world 后面</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> linsert list after <span class="token string">"world"</span> <span class="token string">"another"</span>
</code></pre> 
<p>List 是一个链表，before , after ， left，right 都可以插入值，在两边插入或者改动值，效率最高！ 中间元素，相对来说效率会低一点</p> 
<p><strong>使用场景：</strong></p> 
<ul><li>消息队列</li><li>排行榜</li><li>最新列表</li></ul> 
<h4><a id="Set_191"></a>Set</h4> 
<p>Sets: 不重复且无序的字符串元素的集合。</p> 
<p>set 类型是 string 类型的集合，其特点是集合元素无序且不重复，每个集合最多可以存储 232 - 1 个元素（40多亿）</p> 
<p>所有的 set 命令都是 s 开始</p> 
<pre><code class="prism language-bash"><span class="token comment"># 清空当前数据库</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> flushdb
<span class="token comment"># set 集合中添加几个值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd myset <span class="token string">"1"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd myset <span class="token string">"1"</span> <span class="token string">"2"</span> <span class="token string">"3"</span> <span class="token string">"4"</span> <span class="token string">"5"</span> <span class="token string">"6"</span> <span class="token string">"7"</span> <span class="token string">"8"</span> <span class="token string">"9"</span> <span class="token string">"0"</span>
<span class="token comment"># 查看指定 set 的所有值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers myset
<span class="token comment"># 判断某一个值是不是在 set 集合中</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sismember myset

<span class="token comment"># 获取 set 集合中的内容元素个数</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> scard myset
<span class="token comment"># 移除 set 集合中的指定元素</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> srem myset <span class="token number">3</span>

<span class="token comment"># 随机抽选出一个元素,set 无序不重复集合。抽随机</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> srandmember myset
<span class="token comment"># 随机抽取2个</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> srandmember myset <span class="token number">2</span>

<span class="token comment"># 随机删除 myset 中的值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> spop myset

<span class="token comment"># 将一个指定的值，移动到另外一个set集合</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd <span class="token string">"hello"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd <span class="token string">"world"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smove myset newset <span class="token string">"hello"</span>

<span class="token comment"># 数字集合类 - 差集 sdiff - 交集 sinter - 并集 sunion</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd key1 <span class="token string">"a"</span> <span class="token string">"b"</span> <span class="token string">"c"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd key2 <span class="token string">"c"</span> <span class="token string">"e"</span> <span class="token string">"f"</span>
<span class="token comment"># 差集—— key1 在 key2 中没有的值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token function">sdiff</span> key1 key2
<span class="token comment"># 交集—— key1 和 key2 共同拥有的值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sinter key1 key2
<span class="token comment"># 并集—— key1 和 key2　所有的值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sunion key1 key2
</code></pre> 
<p><strong>Set使用场景：</strong></p> 
<ul><li>共同关注，共同爱好，推荐好友，共同好友，共同喜好，二度好友，共同粉丝，微信点赞同好友可看，感兴趣的人集合</li><li>兴趣标签，相同爱好的为一个标签</li><li>统计网站的独立IP。利用set集合当中元素不唯一性，可以快速实时统计访问网站的独立IP。</li><li>安全提示，群聊拉人的时候，新人入群的提示，如果被拉进群聊的新人除了拉取人之外，和其他群友都不是好友关系或者跟不超过N个人是好友关系的时候，就可以给一个安全提示。此时用到的是SISMEMBER</li></ul> 
<h4><a id="Hash_246"></a>Hash</h4> 
<p>Map集合，key-maps 时候这个值是一个map集合！ 本质和String类型没有太大区别，还是一个简单的key-vlaue！</p> 
<p>有点像 HashMap 的 value 又套了个HashMap</p> 
<p>所有 hash 的命令都是 h 开头</p> 
<pre><code class="prism language-bash"><span class="token comment"># set一个具体 key-vlaue</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hset myhash field <span class="token string">"hello
# 获取一个字段值
127.0.0.1:6379&gt; hget myhash field
# set 多个 key-vlaue 返回 OK
127.0.0.1:6379&gt; hmset myhash field1 "</span>hello<span class="token string">" field2 "</span>world<span class="token string">"
# set 多个 key-vlaue 返回成功的数量
127.0.0.1:6379&gt; hset myhash field3 "</span>hello<span class="token string">" field4 "</span>world<span class="token string">"
# 获取多个字段值
127.0.0.1:6379&gt; hmget myhash field1 field2
# 获取全部的数据
127.0.0.1:6379&gt; hgetall myhash

# 获取hash表的字段数量
127.0.0.1:6379&gt; hlen myhash
# 判断hash中指定字段是否存在
127.0.0.1:6379&gt; hexists myhash field1

# 只获得所有 field
127.0.0.1:6379&gt; hkeys myhash
# 只获得所有value
127.0.0.1:6379&gt; hvals myhash

# 指定增量
127.0.0.1:6379&gt; hset myhash field5 5
127.0.0.1:6379&gt; hincrby myhash field5 5
127.0.0.1:6379&gt; hincrby myhash field5 -2

# 如果不存在则可以设置,存在则不能设置
127.0.0.1:6379&gt; hsetnx myhash field6 "</span>hello"
<span class="token comment"># 删除指定的 field</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>hdel myhash field

<span class="token comment"># 返回 hash 指定 field 的 value 的字符串长度，field 不存在返回 0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hstrlen myhash field1
</code></pre> 
<p>hash变更的数据 user name age,尤其是是用户信息之类的，经常变动的信息！ hash 更适合于对象的存储，String更加适合字符串存储</p> 
<p>购物车的实现：field (商品id)，hincrby (商品数量，添加增量会返回总数)，hdel(删除)，hgetall(全选)，hlen(购物车车数量)，key(用户id)</p> 
<p>Hash 结构优点：</p> 
<ul><li>同类数据归类整合存储，方便数据管理</li><li>相比 String 操作消耗内存与 cpu 更小</li><li>相比 String 储存更节省空间</li></ul> 
<p>缺点：</p> 
<ul><li>过期功能不能使用在 field 上，只能用在 key 上</li><li>Redis 集群架构下不适合大规模使用</li></ul> 
<h4><a id="Sorted_Set_307"></a>Sorted Set</h4> 
<p>Sorted-Set和Set类型极为相似，它们都是字符串的集合，都不允许重复的成员出现在一个Set中。它们之间的主要差别是Sorted-Set中的每一个成员都会有一个分数(score)与之关联，Redis正是通过分数来为集合中的成员进行从小到大的排序。然而需要额外指出的是，尽管Sorted-Set中的成员必须是唯一的，但是分数(score)却是可以重复的</p> 
<p>在set的基础上，增加了一个值，set k1 v1 zset k1 score1 v1</p> 
<pre><code class="prism language-bash"><span class="token comment"># 添加一个值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd myzset <span class="token number">1</span> one 
<span class="token comment"># 添加多个值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd myzset <span class="token number">2</span> two <span class="token number">3</span> three
<span class="token comment"># zincrby 和 zadd 效果一样，最后返回结果是字符串，zadd 返回添加总数</span>

<span class="token comment"># 查看添加的值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange myzset <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange myzset <span class="token number">0</span> <span class="token parameter variable">-1</span> withscores

<span class="token comment"># 实现排序 添加三个用户</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>	zadd salary <span class="token number">120</span> zhang <span class="token number">98</span> wang <span class="token number">110</span> li
<span class="token comment"># ZRANGEBYSCORE key min max   显示全部的用户 从小到大</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>	zrangebyscore salary <span class="token parameter variable">-inf</span> +inf
<span class="token comment"># 从大到进行排序</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>	zrevrange salary <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token comment"># 显示全部的用户并且附带成绩</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>	zrangebyscore salary <span class="token parameter variable">-inf</span> +inf withscores
<span class="token comment"># 显示成绩小于 110 的所有人，升序排序</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>	zrangebyscore salary <span class="token parameter variable">-inf</span> <span class="token number">110</span> withscores
<span class="token comment"># zrem 移除，移除有序集合中的指定元素</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrem salary zhang

<span class="token comment"># 添加值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd myzset <span class="token number">2</span> hello <span class="token number">3</span> world
<span class="token comment"># 有序集合的元素个数， key 不存在则返回0 </span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zcard myzset
<span class="token comment"># 获取区间成员数量</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zcount myzset <span class="token number">1</span> <span class="token number">3</span>
<span class="token comment"># 计算成员之间的数量</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zlexcount myzset - +
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zlexcount myzset <span class="token punctuation">[</span>b <span class="token punctuation">[</span>f

<span class="token comment"># 删除一个 zset -&gt; del myzset</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> del myzset

</code></pre> 
<p>ZSet 数据类型使用场景：游戏排名、微博热点话题，根据时间排序的新闻列表， 阅读排行榜，延时队列等</p> 
<p>限流，滑动窗口是限流常见的一种策略。如果我们把一个用户的 ID 作为 key 来定义一个 zset ，member 或者 score 可以都为访问时的时间戳。我们只需统计某个 key 下在指定时间戳区间内的个数，就能得到这个用户滑动窗口内访问频次，与最大通过次数比较，来决定是否允许通过。</p> 
<h3><a id="_358"></a>三种特殊类型</h3> 
<h4><a id="Geospatial__360"></a>Geospatial 地理位置</h4> 
<p>将指定的地理空间位置（纬度、经度、名称）添加到指定的key中。这些数据将会存储到sorted set这样的目的是为了方便使用GEORADIUS或者GEORADIUSBYMEMBER命令对数据进行半径查询等操作</p> 
<p><strong>常用命令：</strong></p> 
<table><thead><tr><th align="left">命令</th><th align="left">描述</th></tr></thead><tbody><tr><td align="left"><a href="https://www.redis.net.cn/order/3687.html" rel="nofollow">Redis GEOHASH 命令</a></td><td align="left">返回一个或多个位置元素的 Geohash 表示</td></tr><tr><td align="left"><a href="https://www.redis.net.cn/order/3688.html" rel="nofollow">Redis GEOPOS 命令</a></td><td align="left">从key里返回所有给定位置元素的位置（经度和纬度）</td></tr><tr><td align="left"><a href="https://www.redis.net.cn/order/3686.html" rel="nofollow">Redis GEODIST 命令</a></td><td align="left">返回两个给定位置之间的距离</td></tr><tr><td align="left"><a href="https://www.redis.net.cn/order/3689.html" rel="nofollow">Redis GEORADIUS 命令</a></td><td align="left">以给定的经纬度为中心， 找出某一半径内的元素</td></tr><tr><td align="left"><a href="https://www.redis.net.cn/order/3685.html" rel="nofollow">Redis GEOADD 命令</a></td><td align="left">将指定的地理空间位置（纬度、经度、名称）添加到指定的key中</td></tr><tr><td align="left"><a href="https://www.redis.net.cn/order/3690.html" rel="nofollow">Redis GEORADIUSBYMEMBER 命令</a></td><td align="left">找出位于指定范围内的元素，中心点是由给定的位置元素决定</td></tr></tbody></table> 
<p><strong>使用场景：</strong></p> 
<p>例如：微信位置共享，附近的人等地图功能</p> 
<pre><code class="prism language-bash">redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>  GEOADD Sicily <span class="token number">13.361389</span> <span class="token number">38.115556</span> <span class="token string">"beijing"</span> <span class="token number">15.087269</span> <span class="token number">37.502669</span> <span class="token string">"shanghai"</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>  GEODIST Sicily beijing shanghai
<span class="token string">"166274.15156960039"</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>  GEORADIUS Sicily <span class="token number">15</span> <span class="token number">37</span> <span class="token number">100</span> km
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"shanghai"</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>  GEORADIUS Sicily <span class="token number">15</span> <span class="token number">37</span> <span class="token number">200</span> km
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"beijing"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"shanghai"</span>
</code></pre> 
<h4><a id="Hyperloglog_391"></a>Hyperloglog</h4> 
<p><strong>使用场景：</strong></p> 
<p>统计注册的IP数，每日访问数，每天在线人数，搜索词条数等类似场景</p> 
<table><thead><tr><th align="left">命令</th><th align="left">描述</th></tr></thead><tbody><tr><td align="left"><a href="https://www.redis.net.cn/order/3631.html" rel="nofollow">Redis Pgmerge 命令</a></td><td align="left">将多个 HyperLogLog 合并为一个 HyperLogLog</td></tr><tr><td align="left"><a href="https://www.redis.net.cn/order/3629.html" rel="nofollow">Redis Pfadd 命令</a></td><td align="left">添加指定元素到 HyperLogLog 中。</td></tr><tr><td align="left"><a href="https://www.redis.net.cn/order/3630.html" rel="nofollow">Redis Pfcount 命令</a></td><td align="left">返回给定 HyperLogLog 的基数估算值。</td></tr></tbody></table> 
<p>示例1：</p> 
<pre><code class="prism language-bash">redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> PFADD mykey a b c d e f g h i j
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> PFCOUNT mykey
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">10</span>


</code></pre> 
<p>示例2:</p> 
<pre><code class="prism language-bash">redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> PFADD hll1 foo bar zap a
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> PFADD hll2 a b c foo
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> PFMERGE hll3 hll1 hll2
OK
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> PFCOUNT hll3
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">6</span>
</code></pre> 
<h4><a id="Bitmap_427"></a>Bitmap</h4> 
<p><strong>使用场景：</strong></p> 
<p>统计用户信息、活跃、不活跃、 登录 、 未登录、打卡、365打卡！ 两个状态的，都可以使用 Bitmaps！</p> 
<p>Bitmap 位图，数据结构，都是操作二进制位来进行记录，就只有0 和 1 两个状态！</p> 
<p>365 天 = 365 bit 1字节 = 8bit 46 个字节左右！</p> 
<pre><code class="prism language-bash"><span class="token comment"># 使用 bitmap 记录周一到周日打卡</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">0</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">1</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">2</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">3</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">4</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">5</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">6</span> <span class="token number">1</span>
<span class="token comment"># 查看那一天是否打卡</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getbit sign <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getbit sign <span class="token number">4</span>

<span class="token comment"># 统计这周的打卡记录，就可以看到是否有全勤</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> bitcount sign
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/17cecb293a7ac40eb9ed9962631420d3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">策略分析：Atlassian Server版停止支持，Server版用户应该转向数据中心版本还是云版？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e5b05db93a54089cf65bb16a53e96466/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python实战项目 名片管理系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>