<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>LogisticRegression 多分类实例 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="LogisticRegression 多分类实例" />
<meta property="og:description" content="import pandas as pd from sklearn.linear_model import LogisticRegression from sklearn.model_selection import train_test_split import matplotlib.pyplot as plt import plotly.graph_objs as go from plotly.offline import init_notebook_mode, iplot init_notebook_mode(connected = True) from sklearn import metrics df = pd.read_csv(filepath_or_buffer=&#39;./data/iris/iris.csv&#39;,header=None) df.columns = [&#39;sepal_len&#39;, &#39;sepal_width&#39;, &#39;petal_len&#39;, &#39;petal_width&#39;, &#39;class&#39;] df.tail() sepal_lensepal_widthpetal_lenpetal_widthclass1456.73.05.22.3Iris-virginica1466.32.55.01.9Iris-virginica1476.53.05.22.0Iris-virginica1486.23.45.42.3Iris-virginica1495.93.05.11.8Iris-virginica df.loc[df[&#39;class&#39;] == &#39;Iris-setosa&#39;,&#39;class&#39;] = 0 df.loc[df[&#39;class&#39;] == &#39;Iris-versicolor&#39;,&#39;class&#39;] = 1 df.loc[df[&#39;class&#39;] == &#39;Iris-virginica&#39;,&#39;class&#39;] = 2 df.tail() sepal_lensepal_widthpetal_lenpetal_widthclass1456.73.05.22.321466.32.55.01.921476.53.05.22.021486.23.45.42.321495.93.05.11.82 df.head() sepal_lensepal_widthpetal_lenpetal_widthclass05.13.51.40.2014.93.01.40.2024.73.21.30.2034.63.11.50.2045.03.61.40.20 labels = df.groupby(&#39;class&#39;).size().index values = df.groupby(&#39;class&#39;).size() trace = go." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/50b80a456b54c66cf3942ec9f772fced/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-10-09T11:26:16+08:00" />
<meta property="article:modified_time" content="2020-10-09T11:26:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">LogisticRegression 多分类实例</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> plotly<span class="token punctuation">.</span>graph_objs <span class="token keyword">as</span> go
<span class="token keyword">from</span> plotly<span class="token punctuation">.</span>offline <span class="token keyword">import</span> init_notebook_mode<span class="token punctuation">,</span> iplot
init_notebook_mode<span class="token punctuation">(</span>connected <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
</code></pre> 
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>filepath_or_buffer<span class="token operator">=</span><span class="token string">'./data/iris/iris.csv'</span><span class="token punctuation">,</span>header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'sepal_len'</span><span class="token punctuation">,</span> <span class="token string">'sepal_width'</span><span class="token punctuation">,</span> <span class="token string">'petal_len'</span><span class="token punctuation">,</span> <span class="token string">'petal_width'</span><span class="token punctuation">,</span> <span class="token string">'class'</span><span class="token punctuation">]</span>
df<span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<div> 
</div> 
<table border="1" class="dataframe"><thead><tr><th></th><th>sepal_len</th><th>sepal_width</th><th>petal_len</th><th>petal_width</th><th>class</th></tr></thead><tbody><tr><th>145</th><td>6.7</td><td>3.0</td><td>5.2</td><td>2.3</td><td>Iris-virginica</td></tr><tr><th>146</th><td>6.3</td><td>2.5</td><td>5.0</td><td>1.9</td><td>Iris-virginica</td></tr><tr><th>147</th><td>6.5</td><td>3.0</td><td>5.2</td><td>2.0</td><td>Iris-virginica</td></tr><tr><th>148</th><td>6.2</td><td>3.4</td><td>5.4</td><td>2.3</td><td>Iris-virginica</td></tr><tr><th>149</th><td>5.9</td><td>3.0</td><td>5.1</td><td>1.8</td><td>Iris-virginica</td></tr></tbody></table> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'class'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Iris-setosa'</span><span class="token punctuation">,</span><span class="token string">'class'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'class'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Iris-versicolor'</span><span class="token punctuation">,</span><span class="token string">'class'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'class'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Iris-virginica'</span><span class="token punctuation">,</span><span class="token string">'class'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span>


</code></pre> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<div> 
</div> 
<table border="1" class="dataframe"><thead><tr><th></th><th>sepal_len</th><th>sepal_width</th><th>petal_len</th><th>petal_width</th><th>class</th></tr></thead><tbody><tr><th>145</th><td>6.7</td><td>3.0</td><td>5.2</td><td>2.3</td><td>2</td></tr><tr><th>146</th><td>6.3</td><td>2.5</td><td>5.0</td><td>1.9</td><td>2</td></tr><tr><th>147</th><td>6.5</td><td>3.0</td><td>5.2</td><td>2.0</td><td>2</td></tr><tr><th>148</th><td>6.2</td><td>3.4</td><td>5.4</td><td>2.3</td><td>2</td></tr><tr><th>149</th><td>5.9</td><td>3.0</td><td>5.1</td><td>1.8</td><td>2</td></tr></tbody></table> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<div> 
</div> 
<table border="1" class="dataframe"><thead><tr><th></th><th>sepal_len</th><th>sepal_width</th><th>petal_len</th><th>petal_width</th><th>class</th></tr></thead><tbody><tr><th>0</th><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>0</td></tr><tr><th>1</th><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>0</td></tr><tr><th>2</th><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>0</td></tr><tr><th>3</th><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>0</td></tr><tr><th>4</th><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>0</td></tr></tbody></table> 
<pre><code class="prism language-python">labels <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index
values <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span>
trace <span class="token operator">=</span> go<span class="token punctuation">.</span>Pie<span class="token punctuation">(</span>labels<span class="token operator">=</span>labels<span class="token punctuation">,</span> values<span class="token operator">=</span>values<span class="token punctuation">)</span>
layout <span class="token operator">=</span> go<span class="token punctuation">.</span>Layout<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">)</span>
fig <span class="token operator">=</span> go<span class="token punctuation">.</span>Figure<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token punctuation">[</span>trace<span class="token punctuation">]</span><span class="token punctuation">,</span> layout<span class="token operator">=</span>layout<span class="token punctuation">)</span>
iplot<span class="token punctuation">(</span>fig<span class="token punctuation">)</span>


</code></pre> 
<div> 
 <div id="fa8f013f-33df-43da-b3ca-0d40cc41d3a7" class="plotly-graph-div"></div> 
</div> 
<p>var gd = document.getElementById(‘fa8f013f-33df-43da-b3ca-0d40cc41d3a7’);<br> var x = new MutationObserver(function (mutations, observer) {<!-- -->{<!-- --><br> var display = window.getComputedStyle(gd).display;<br> if (!display || display === ‘none’) {<!-- -->{<!-- --><br> console.log([gd, ‘removed!’]);<br> Plotly.purge(gd);<br> observer.disconnect();<br> }}<br> }});</p> 
<p>// Listen for the removal of the full notebook cells<br> var notebookContainer = gd.closest(’#notebook-container’);<br> if (notebookContainer) {<!-- -->{<!-- --><br> x.observe(notebookContainer, {childList: true});<br> }}</p> 
<p>// Listen for the clearing of the current output cell<br> var outputEl = gd.closest(’.output’);<br> if (outputEl) {<!-- -->{<!-- --><br> x.observe(outputEl, {childList: true});<br> }}</p> 
<pre><code>                    })                };                });            &lt;/script&gt;        &lt;/div&gt;
</code></pre> 
<pre><code class="prism language-python">X <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
Y <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'class'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span>

</code></pre> 
<pre><code class="prism language-python">x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span> test_size <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">x_train<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>y_train<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>x_test<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> y_test<span class="token punctuation">.</span>shape

</code></pre> 
<pre><code>((105, 4), (105,), (45, 4), (45,))
</code></pre> 
<h4><a id="_346"></a>模型搭建与分类器训练</h4> 
<p>1、导入模型，调用逻辑回归LogisticRegression()函数。</p> 
<ul><li>penalty: 正则化选择参数（惩罚项的种类），默认方式为L2正则化</li><li>C: 正则项系数的倒数</li><li>solver: 对于多分类任务， 使用‘newton-cg’, ‘sag’, ‘saga’ and ‘lbfgs’ 来解决多项式loss</li><li>multi_class: 默认值‘ovr’适用于二分类问题，对于多分类问题，用‘multinomial’在全局的概率分布上最小化损失</li></ul> 
<p>2、训练LogisticRegression分类器</p> 
<ul><li>调用fit(x,y)的方法来训练模型，其中x为数据的属性，y为所属类型。</li></ul> 
<p>3、利用训练得到的模型对数据集进行预测 predict()，返回预测结果。</p> 
<pre><code class="prism language-python">lr <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span>penalty<span class="token operator">=</span><span class="token string">'l2'</span><span class="token punctuation">,</span>solver<span class="token operator">=</span><span class="token string">'newton-cg'</span><span class="token punctuation">,</span>multi_class<span class="token operator">=</span><span class="token string">'multinomial'</span><span class="token punctuation">)</span>

</code></pre> 
<pre><code class="prism language-python">lr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>
</code></pre> 
<pre><code>LogisticRegression(multi_class='multinomial', solver='newton-cg')
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Logistic Regression模型训练集的准确率：%.3f"</span> <span class="token operator">%</span>lr<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>Logistic Regression模型训练集的准确率：0.981
</code></pre> 
<pre><code class="prism language-python">y_hat <span class="token operator">=</span> lr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
accuracy  <span class="token operator">=</span> metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_hat<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Logistic Regression模型正确率：%.3f"</span> <span class="token operator">%</span>accuracy<span class="token punctuation">)</span>


</code></pre> 
<pre><code>Logistic Regression模型正确率：0.978
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/321c44ca510fd46d5ef3f12da71c8cf6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">POCIB实训</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5b3028fdb2671037dc941e53581ee0ff/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">QPSK调制及MATLAB实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>