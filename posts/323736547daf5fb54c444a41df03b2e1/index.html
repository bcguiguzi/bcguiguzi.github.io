<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Visual Studio属性配置中使用宏 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Visual Studio属性配置中使用宏" />
<meta property="og:description" content="在学习C语言的时候，我们曾经遇到过一个宏的概念。宏的作用机理本质上是宏的展开，C语言中的宏的用法也有很多种（水其实很深...），不过从感觉上来讲，人们大致上会在以下的场景中，利用宏来解决一些窘境：一是为了避免重复书写同样性质代码时，会使用到宏；二是为了定义一些常量参数时，会使用到宏。另外，宏的意义也在于，当我们修改某个宏的定义时，便修改了所有引用宏的地方所展开的代码，这无疑节省了我们修改代码的工作量以及代码修改的灵活性。
在Visual Studio中进行C&#43;&#43;工程属性的配置时，同样也会遇到与写代码类似的场景，例如我们可能会在不同的表单（同一个工程或者多个工程）中，填写相同的内容（例如某个路径）。这样就造成了一些重复性的劳动，而且填写时可能因为疏忽而造成错误，修改时也需要找到所有填写这个内容的地方。为了解决这个问题，Visual Studio在工程属性配置时，也提供了宏这样一个工具，来帮助我们减少这些无谓的辛劳。
C&#43;&#43;工程属性中的宏
工程属性中的宏具体长得是什么样子呢？在打开工程属性时，我们在表单中可能经常会看到一些以美元符号（$）为开头的字符串，$(SomeMacro)。其实这些字符串便是Visual Studio中默认定义的一些宏，它们其实就是代表一些与某个工程相关的常量字符串。在下图中我们可以看到一些这样默认定义的宏：
任意点击一个表单，然后点击Edit选项，便可以在弹出的窗口中，查看这些默认定义宏的含义。
注意到上面两个宏进行结合，对项目的输出路径（Output）进行了配置，也就是项目生成exe、lib或dll的地方。Visual Studio中还有很多类似这样的宏，有些宏还是和机器相关的，所以我们也可以利用其来进行工程配置，避免因为不同机器上路径不同，而对每台机器单独配置一次属性。对工程属性中默认定义的宏，微软的官方指南上也有一个比较详细的介绍。
http://msdn.microsoft.com/en-us/library/c02as0cs.aspx
自定义工程属性中的宏
那么我们如何自己定义工程属性中的宏呢？首先我们需要打开属性管理器选项卡（Property Manager），然后为工程添加一个属性页面（Property Sheet）。该属性页面在被添加后，会被当前的工程属性继承，于是便可以使用其中定义的宏了。
以上添加了一个宏，代表使用OpenCV第三方库的版本号，因为在第三方库升级时，库的名字也会随版本号发生改变；而使用了宏后，我们就可以很方便的修改引用库的名称了。下面我们可以回到原来的工程属性当中来，利用上面的宏来动态确定引用库的名称。
我们可以看到，Linker当中所展开的命令行参数中，$(OpenCVLibVersion)已经被展开为245了。而以后在发生库版本的升级时，便可以只修改$(OpenCVLibVersion)这个宏便可以正常使用升级后的库了，所以这种方法还是很实用的吧。在工程属性的配置中，宏的使用场景还有很多，如果能够灵活使用，便可以节省很多的时间，避免很多因重复劳动所造成的错误。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/323736547daf5fb54c444a41df03b2e1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2013-06-30T22:45:05+08:00" />
<meta property="article:modified_time" content="2013-06-30T22:45:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Visual Studio属性配置中使用宏</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>      在学习C语言的时候，我们曾经遇到过一个宏的概念。宏的作用机理本质上是宏的展开，C语言中的宏的用法也有很多种（水其实很深...），不过从感觉上来讲，人们大致上会在以下的场景中，利用宏来解决一些窘境：一是为了避免重复书写同样性质代码时，会使用到宏；二是为了定义一些常量参数时，会使用到宏。另外，宏的意义也在于，当我们修改某个宏的定义时，便修改了所有引用宏的地方所展开的代码，这无疑节省了我们修改代码的工作量以及代码修改的灵活性。</p> 
<p>      在Visual Studio中进行C++工程属性的配置时，同样也会遇到与写代码类似的场景，例如我们可能会在不同的表单（同一个工程或者多个工程）中，填写相同的内容（例如某个路径）。这样就造成了一些重复性的劳动，而且填写时可能因为疏忽而造成错误，修改时也需要找到所有填写这个内容的地方。为了解决这个问题，Visual Studio在工程属性配置时，也提供了宏这样一个工具，来帮助我们减少这些无谓的辛劳。</p> 
<p>      <strong>C++工程属性中的宏</strong></p> 
<p>      工程属性中的宏具体长得是什么样子呢？在打开工程属性时，我们在表单中可能经常会看到一些以美元符号（$）为开头的字符串，<em><span style="color:#33cc00">$(SomeMacro)</span></em>。其实这些字符串便是Visual Studio中默认定义的一些宏，它们其实就是代表一些与某个工程相关的常量字符串。在下图中我们可以看到一些这样默认定义的宏：</p> 
<p style="text-align:center"><img width="600" height="423" alt="" src="https://images2.imgbox.com/e3/1a/yqBt6k59_o.png"><br> </p> 
<p style="text-align:left">      任意点击一个表单，然后点击Edit选项，便可以在弹出的窗口中，查看这些默认定义宏的含义。</p> 
<p style="text-align:center"><img width="600" height="425" alt="" src="https://images2.imgbox.com/ca/6d/iEyJzhyZ_o.png"><br> </p> 
<p style="text-align:center"><img alt="" src="https://images2.imgbox.com/de/c6/lAv3FKB9_o.png"><br> </p> 
<p style="text-align:center"><img alt="" src="https://images2.imgbox.com/30/a6/2pa7sP2e_o.png"><br> </p> 
<p style="text-align:left">      注意到上面两个宏进行结合，对项目的输出路径（Output）进行了配置，也就是项目生成exe、lib或dll的地方。Visual Studio中还有很多类似这样的宏，有些宏还是和机器相关的，所以我们也可以利用其来进行工程配置，避免因为不同机器上路径不同，而对每台机器单独配置一次属性。对工程属性中默认定义的宏，微软的官方指南上也有一个比较详细的介绍。</p> 
<p style="text-align:center"><a target="_blank" href="http://msdn.microsoft.com/en-us/library/c02as0cs.aspx" rel="nofollow noopener noreferrer">http://msdn.microsoft.com/en-us/library/c02as0cs.aspx</a><br> </p> 
<p><strong>      自定义工程属性中的宏</strong></p> 
<p><strong>      </strong>那么我们如何自己定义工程属性中的宏呢？首先我们需要打开属性管理器选项卡（Property Manager），然后为工程添加一个属性页面（Property Sheet）。该属性页面在被添加后，会被当前的工程属性继承，于是便可以使用其中定义的宏了。</p> 
<p style="text-align:center"><img alt="" src="https://images2.imgbox.com/94/9f/XIj7QYWu_o.png"><br> </p> 
<p style="text-align:center"><img width="600" height="410" alt="" src="https://images2.imgbox.com/32/15/EmdhiWxt_o.png"><br> </p> 
<p style="text-align:center"><img alt="" src="https://images2.imgbox.com/3d/fb/rV9vwJrg_o.png"><br> </p> 
<p style="text-align:center"><img width="600" height="423" alt="" src="https://images2.imgbox.com/6f/25/INv0RThd_o.png"><br> </p> 
<p style="text-align:center"><img width="600" height="423" alt="" src="https://images2.imgbox.com/19/f8/YB8DvspO_o.png"><br> </p> 
<p style="text-align:left">      以上添加了一个宏，代表使用OpenCV第三方库的版本号，因为在第三方库升级时，库的名字也会随版本号发生改变；而使用了宏后，我们就可以很方便的修改引用库的名称了。下面我们可以回到原来的工程属性当中来，利用上面的宏来动态确定引用库的名称。</p> 
<p style="text-align:center"><img alt="" src="https://images2.imgbox.com/12/90/Fa48BmHB_o.png"><br> </p> 
<p style="text-align:center"><img width="600" height="423" alt="" src="https://images2.imgbox.com/dc/a7/y5jDWCFJ_o.png"><br> </p> 
<p style="text-align:left">      我们可以看到，Linker当中所展开的命令行参数中，$(OpenCVLibVersion)已经被展开为245了。而以后在发生库版本的升级时，便可以只修改$(OpenCVLibVersion)这个宏便可以正常使用升级后的库了，所以这种方法还是很实用的吧。在工程属性的配置中，宏的使用场景还有很多，如果能够灵活使用，便可以节省很多的时间，避免很多因重复劳动所造成的错误。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/85e5aaa8c2dfc225510e688aafc0e24d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">onvif 客户端的发现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/053966cea8a04ded580eff6142f6721f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基类与派生类对象和指针赋值的小结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>