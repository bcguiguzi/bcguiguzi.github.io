<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#中 GridView控件的使用 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#中 GridView控件的使用" />
<meta property="og:description" content="GridView控件是一个visualStudio自带的数据控件，它可以非常快速的将数据以表格方式显示在web页面上。下面就是一个利用GridView控件进行数据绑定的小例子，内容如下：
数据来源自一个XML文件，至于如何操作XML文件，这里不作详细描述，具体可以参考 http://www.cnblogs.com/programsky/p/3816073.html
1.XML内容如下：
&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt; &lt;gunbook&gt; &lt;gun type=&#34;自动步枪&#34; gid=&#34;001&#34;&gt; &lt;name&gt;AK-47&lt;/name&gt; &lt;from&gt;俄罗斯&lt;/from&gt; &lt;clip&gt;30&lt;/clip&gt; &lt;accurate&gt;0.2&lt;/accurate&gt; &lt;range&gt;300M&lt;/range&gt; &lt;/gun&gt; &lt;gun type=&#34;狙击枪&#34; gid=&#34;002&#34;&gt; &lt;name&gt;AWM&lt;/name&gt; &lt;from&gt;英国&lt;/from&gt; &lt;clip&gt;10&lt;/clip&gt; &lt;accurate&gt;1&lt;/accurate&gt; &lt;range&gt;1000M&lt;/range&gt; &lt;/gun&gt; &lt;gun type=&#34;冲锋枪&#34; gid=&#34;003&#34;&gt; &lt;name&gt;MP5&lt;/name&gt; &lt;from&gt;美国&lt;/from&gt; &lt;clip&gt;80&lt;/clip&gt; &lt;accurate&gt;0.1&lt;/accurate&gt; &lt;range&gt;280M&lt;/range&gt; &lt;/gun&gt; &lt;gun type=&#34;霰弹枪&#34; gid=&#34;004&#34;&gt; &lt;name&gt;气锤&lt;/name&gt; &lt;from&gt;德国&lt;/from&gt; &lt;clip&gt;10&lt;/clip&gt; &lt;accurate&gt;0.2&lt;/accurate&gt; &lt;range&gt;120M&lt;/range&gt; &lt;/gun&gt; &lt;/gunbook&gt; View Code
(这里的数据源还可以从数据库中读取，比如“select uid,uname,usex,uage from users”…这样就可以不用XML了)
2.定义了一个model类便于数据交换：
//定义一个枪的数据模型类
public class GunModel { public GunModel() { } //枪的名称 public string GunName { get; set; } //枪的类型 public string GunType { get; set; } //枪的编号 public string GunID { get; set; } //枪的产地 public string GunFrom { get; set; } //枪的弹夹 public string GunClip { get; set; } //枪的精准度 public string GunAccurate { get; set; } //枪的射程 public string GunRange { get; set; } } View Code" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/49d623dc2608c46ec384adcf6dc20a74/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-25T16:26:33+08:00" />
<meta property="article:modified_time" content="2020-08-25T16:26:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#中 GridView控件的使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>GridView控件是一个visualStudio自带的数据控件，它可以非常快速的将数据以表格方式显示在web页面上。下面就是一个利用GridView控件进行数据绑定的小例子，内容如下：</p> 
<p>数据来源自一个XML文件，至于如何操作XML文件，这里不作详细描述，具体可以参考 http://www.cnblogs.com/programsky/p/3816073.html</p> 
<p>1.XML内容如下：</p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gunbook</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gun</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>自动步枪<span class="token punctuation">"</span></span> <span class="token attr-name">gid</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>001<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>AK-47<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">&gt;</span></span>俄罗斯<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>clip</span><span class="token punctuation">&gt;</span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>clip</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accurate</span><span class="token punctuation">&gt;</span></span>0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accurate</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>range</span><span class="token punctuation">&gt;</span></span>300M<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>range</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gun</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gun</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>狙击枪<span class="token punctuation">"</span></span> <span class="token attr-name">gid</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>002<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>AWM<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">&gt;</span></span>英国<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>clip</span><span class="token punctuation">&gt;</span></span>10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>clip</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accurate</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accurate</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>range</span><span class="token punctuation">&gt;</span></span>1000M<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>range</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gun</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gun</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>冲锋枪<span class="token punctuation">"</span></span> <span class="token attr-name">gid</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>003<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>MP5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">&gt;</span></span>美国<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>clip</span><span class="token punctuation">&gt;</span></span>80<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>clip</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accurate</span><span class="token punctuation">&gt;</span></span>0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accurate</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>range</span><span class="token punctuation">&gt;</span></span>280M<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>range</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gun</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gun</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>霰弹枪<span class="token punctuation">"</span></span> <span class="token attr-name">gid</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>004<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>气锤<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">&gt;</span></span>德国<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>clip</span><span class="token punctuation">&gt;</span></span>10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>clip</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accurate</span><span class="token punctuation">&gt;</span></span>0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accurate</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>range</span><span class="token punctuation">&gt;</span></span>120M<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>range</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gun</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gunbook</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>View Code<br> (这里的数据源还可以从数据库中读取，比如“select uid,uname,usex,uage from users”…这样就可以不用XML了)</p> 
<p>2.定义了一个model类便于数据交换：</p> 
<p>//定义一个枪的数据模型类</p> 
<pre><code class="prism language-csharp">   <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GunModel</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">public</span> <span class="token function">GunModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span>
        <span class="token comment">//枪的名称</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> GunName <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//枪的类型</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> GunType <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//枪的编号</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> GunID <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//枪的产地</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> GunFrom <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//枪的弹夹</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> GunClip <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//枪的精准度</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> GunAccurate <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//枪的射程</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> GunRange <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>View Code</p> 
<p>3.前台界面如下：</p> 
<p><img src="https://images2.imgbox.com/90/8d/FXfHFJac_o.png" alt="在这里插入图片描述"></p> 
<p>上面的文本框从左到右分别是TextBox1-TextBox7,编号是用来作为主键的因此不可编辑,3个按钮亦是Button1-Button3,GridView1是当前数据控件；</p> 
<p>4.GridView设计</p> 
<p>①从工具箱拖一个控件到web页面</p> 
<p><img src="https://images2.imgbox.com/b7/5a/ij9rWlLz_o.png" alt="在这里插入图片描述"></p> 
<p>②点击控件右上角的小三角按钮，然后点击“编辑列”</p> 
<p><img src="https://images2.imgbox.com/a4/52/00QCEzeq_o.png" alt="在这里插入图片描述"></p> 
<p>③在弹出窗口中分别添加若干BoundFiled控件和一个TemplateField控件，并去掉窗口左下角的“自动生成字段”即不勾选；<br> <img src="https://images2.imgbox.com/5d/63/gzKN3WYH_o.png" alt="在这里插入图片描述"></p> 
<p>注意，具体设置是——选中 BoundFiled 点击“添加”，然后在右边填写数据中的DataField（数据源中的列名，例如当前的编号GunID）、外观中的HeaderText（要显示在页面上的列名，例如当前的“编号”），</p> 
<p>TemplateField只需要填写HeaderText即可，然后取消“自动生成字段”的勾选框，最后点击“确定”；</p> 
<p>④点击“自动套用格式”可以根据需要设置相应的样式，点击“编辑模板”进行操作中的模板设置</p> 
<p><img src="https://images2.imgbox.com/9d/69/Erz96prX_o.png" alt="在这里插入图片描述"></p> 
<p>拖两个LinkButton，分别起名称 编辑 、 删除 （LinkButton属性Font–&gt;UnderLine选择False可以去掉下划线，不过要选2下才能启用此操作）</p> 
<p><img src="https://images2.imgbox.com/53/21/djXisQUc_o.png" alt="在这里插入图片描述"></p> 
<p>⑤编辑后界面如下<br> <img src="https://images2.imgbox.com/14/2a/3pWqsdt2_o.png" alt="在这里插入图片描述"></p> 
<p>⑥进行前台界面的相关设置</p> 
<p><img src="https://images2.imgbox.com/1a/72/yxwCqnrG_o.png" alt="在这里插入图片描述"></p> 
<p>注意：CommandArgument可以绑定当前控件上的相应值，一般我们都是绑定主键列的值，例如这里的GunID(不分区大小写)；CommandName是为了方便后台通过GridView的RowCommand事件找到当前操作的类型，比如编辑或是删除，注意起名字一定要避免关键字，如"edit"、“update”、“delete”,可以起"upd"、"del"等；OnClientClick一般用于前台的弹框事件，比如这里的删除提示。</p> 
<p>另外，控件的属性AllowPaging=true 可以进行分页，而PageSize属性可以设置分页大小，即每页显示的数量。</p> 
<p>5.后台代码</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> System<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Linq<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Web<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>UI<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>UI<span class="token punctuation">.</span>WebControls<span class="token punctuation">;</span>

<span class="token keyword">using</span> System<span class="token punctuation">.</span>Xml<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> AboutXML
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">Gun</span> <span class="token punctuation">:</span> <span class="token class-name">System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>UI<span class="token punctuation">.</span>Page</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">Page_Load</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            TextBox1<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Page<span class="token punctuation">.</span>IsPostBack<span class="token punctuation">)</span> 
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">OperationXML</span><span class="token punctuation">(</span><span class="token string">"select"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>        
        
        <span class="token comment">//查询</span>
        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">Button1_Click</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">OperationXML</span><span class="token punctuation">(</span><span class="token string">"select"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//添加</span>
        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">Button2_Click</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//在后台改变控件的样式</span>
            <span class="token comment">//Button2.Attributes.Add("style", "background-color:red;");//这是方式1，按照Css的样式进行改变</span>
            <span class="token comment">//Button2.Style.Add("Color", "blue");//这是方式2，按照控件自带属性进行改变</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>TextBox1<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">//编号必须存在</span>
            <span class="token punctuation">{<!-- --></span>
                Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script&gt;alert('请填写要添加数据')&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token function">OperationXML</span><span class="token punctuation">(</span><span class="token string">"create"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">ClearControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清空文本框</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//修改</span>
        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">Button3_Click</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>TextBox1<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">//编号必须存在</span>
            <span class="token punctuation">{<!-- --></span>
                Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script&gt;alert('请在要修改的行上点击“编辑”后重试！')&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token class-name">XmlDocument</span> xmldoc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmlDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一个xml文档对象</span>
            xmldoc<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token function">GetXMLPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//加载文档</span>

            <span class="token class-name">XmlNode</span> gunroot <span class="token operator">=</span> xmldoc<span class="token punctuation">.</span><span class="token function">SelectSingleNode</span><span class="token punctuation">(</span><span class="token string">"gunbook"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取根节点</span>
            <span class="token keyword">string</span> conditionPath <span class="token operator">=</span> <span class="token string">"/gunbook/gun[@gid=\""</span> <span class="token operator">+</span> TextBox1<span class="token punctuation">.</span>Text <span class="token operator">+</span> <span class="token string">"\"]"</span><span class="token punctuation">;</span><span class="token comment">//XML获取节点的条件，格式固定，如果想要添加属性还可以用“and @属性=属性值” 操作</span>
            <span class="token class-name">XmlNode</span> updateNode <span class="token operator">=</span> xmldoc<span class="token punctuation">.</span><span class="token function">SelectSingleNode</span><span class="token punctuation">(</span>conditionPath<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//根据条件获取一个节点</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>updateNode <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> updateNode<span class="token punctuation">.</span>ChildNodes <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> updateNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">.</span>Count <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                updateNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText <span class="token operator">=</span> TextBox2<span class="token punctuation">.</span>Text<span class="token punctuation">;</span><span class="token comment">//名称</span>
                updateNode<span class="token punctuation">.</span>Attributes<span class="token punctuation">.</span><span class="token function">GetNamedItem</span><span class="token punctuation">(</span><span class="token string">"type"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText <span class="token operator">=</span> TextBox3<span class="token punctuation">.</span>Text<span class="token punctuation">;</span><span class="token comment">//类型</span>
                updateNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText <span class="token operator">=</span> TextBox4<span class="token punctuation">.</span>Text<span class="token punctuation">;</span><span class="token comment">//产地</span>
                updateNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText <span class="token operator">=</span> TextBox5<span class="token punctuation">.</span>Text<span class="token punctuation">;</span><span class="token comment">//弹夹</span>
                updateNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText <span class="token operator">=</span> TextBox6<span class="token punctuation">.</span>Text<span class="token punctuation">;</span><span class="token comment">//精准</span>
                updateNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText <span class="token operator">=</span> TextBox7<span class="token punctuation">.</span>Text<span class="token punctuation">;</span><span class="token comment">//射程</span>
            <span class="token punctuation">}</span>

            <span class="token function">SaveXML</span><span class="token punctuation">(</span>xmldoc<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//保存文件并刷新当前页面</span>

            <span class="token function">ClearControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清空文本框</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 清空控件值</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ClearControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{<!-- --></span>
            TextBox1<span class="token punctuation">.</span>Text <span class="token operator">=</span> TextBox2<span class="token punctuation">.</span>Text <span class="token operator">=</span> TextBox3<span class="token punctuation">.</span>Text <span class="token operator">=</span> TextBox4<span class="token punctuation">.</span>Text <span class="token operator">=</span> TextBox5<span class="token punctuation">.</span>Text <span class="token operator">=</span> TextBox6<span class="token punctuation">.</span>Text <span class="token operator">=</span> TextBox7<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 操作XML类的公共方法 Response.Write("&lt;script&gt;alert('"++"')&lt;/script&gt;");</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="opname"&gt;操作类型名称，select/create/update/delete&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="commandAugument"&gt;操作参数，这里传入的是主键gunid&lt;/param&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">OperationXML</span><span class="token punctuation">(</span><span class="token keyword">string</span> opname<span class="token punctuation">,</span><span class="token keyword">string</span> commandAugument<span class="token punctuation">)</span> 
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">XmlDocument</span> xmldoc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmlDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一个xml文档对象</span>
            xmldoc<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token function">GetXMLPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//加载文档</span>

            <span class="token class-name">XmlNode</span> gunroot <span class="token operator">=</span> xmldoc<span class="token punctuation">.</span><span class="token function">SelectSingleNode</span><span class="token punctuation">(</span><span class="token string">"gunbook"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取根节点</span>

            <span class="token keyword">switch</span> <span class="token punctuation">(</span>opname<span class="token punctuation">)</span> 
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">case</span> <span class="token string">"select"</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>查询
                    <span class="token preprocessor property">#<span class="token directive keyword">region</span></span>

                    List<span class="token operator">&lt;</span>GunModel<span class="token operator">&gt;</span> gunList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-method"><span class="token function">List</span><span class="token punctuation">&lt;</span><span class="token class-name">GunModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定义一个枪的集合</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>gunroot <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> gunroot<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token class-name">XmlNodeList</span> childList<span class="token punctuation">;</span>
                        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">XmlNode</span> child <span class="token keyword">in</span> gunroot<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">)</span><span class="token comment">//循环所有子节点</span>
                        <span class="token punctuation">{<!-- --></span>
                            <span class="token comment">//第一种，直接通过XmlNode获取属性值</span>
                            <span class="token keyword">string</span> type <span class="token operator">=</span> child<span class="token punctuation">.</span>Attributes<span class="token punctuation">.</span><span class="token function">GetNamedItem</span><span class="token punctuation">(</span><span class="token string">"type"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">;</span>
                            <span class="token keyword">string</span> id <span class="token operator">=</span> child<span class="token punctuation">.</span>Attributes<span class="token punctuation">.</span><span class="token function">GetNamedItem</span><span class="token punctuation">(</span><span class="token string">"gid"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">;</span>

                            <span class="token comment">//第二种，通过XmlElement获取属性值</span>
                            <span class="token comment">//XmlElement xmlatt = (XmlElement)child;</span>
                            <span class="token comment">//string type = xmlatt.GetAttribute("type");</span>
                            <span class="token comment">//string id = xmlatt.GetAttribute("gid");</span>

                            <span class="token class-name">GunModel</span> gunmodel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GunModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            gunmodel<span class="token punctuation">.</span>GunType <span class="token operator">=</span> type<span class="token punctuation">;</span>
                            gunmodel<span class="token punctuation">.</span>GunID <span class="token operator">=</span> id<span class="token punctuation">;</span>

                            childList <span class="token operator">=</span> child<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">;</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>childList <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> childList<span class="token punctuation">.</span>Count <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span>
                            <span class="token punctuation">{<!-- --></span>
                                gunmodel<span class="token punctuation">.</span>GunName <span class="token operator">=</span> childList<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">;</span><span class="token comment">//名称</span>
                                gunmodel<span class="token punctuation">.</span>GunFrom <span class="token operator">=</span> childList<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">;</span><span class="token comment">//产地</span>
                                gunmodel<span class="token punctuation">.</span>GunClip <span class="token operator">=</span> childList<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">;</span><span class="token comment">//弹夹</span>
                                gunmodel<span class="token punctuation">.</span>GunAccurate <span class="token operator">=</span> childList<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">;</span><span class="token comment">//精准</span>
                                gunmodel<span class="token punctuation">.</span>GunRange <span class="token operator">=</span> childList<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">;</span><span class="token comment">//射程</span>
                            <span class="token punctuation">}</span>
                            <span class="token keyword">else</span> 
                            <span class="token punctuation">{<!-- --></span>
                                gunmodel<span class="token punctuation">.</span>GunName <span class="token operator">=</span> <span class="token string">"no data"</span><span class="token punctuation">;</span>
                                gunmodel<span class="token punctuation">.</span>GunFrom <span class="token operator">=</span> <span class="token string">"no data"</span><span class="token punctuation">;</span>
                                gunmodel<span class="token punctuation">.</span>GunClip <span class="token operator">=</span> <span class="token string">"no data"</span><span class="token punctuation">;</span>
                                gunmodel<span class="token punctuation">.</span>GunAccurate <span class="token operator">=</span> <span class="token string">"no data"</span><span class="token punctuation">;</span>
                                gunmodel<span class="token punctuation">.</span>GunRange <span class="token operator">=</span> <span class="token string">"no data"</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>

                            gunList<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>gunmodel<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将枪对象添加到枪集合中</span>
                        <span class="token punctuation">}</span><span class="token comment">//foreach (XmlNode child in gunroot.ChildNodes) end</span>

                        GridView1<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> gunList<span class="token punctuation">;</span><span class="token comment">//绑定数据源</span>
                        GridView1<span class="token punctuation">.</span><span class="token function">DataBind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span><span class="token comment">//if (gunroot != null &amp;&amp; gunroot.ChildNodes.Count &gt; 0) end</span>

                <span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>

                <span class="token keyword">case</span> <span class="token string">"create"</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>增加
                    <span class="token preprocessor property">#<span class="token directive keyword">region</span></span>

                    <span class="token class-name">XmlElement</span> createElement <span class="token operator">=</span> xmldoc<span class="token punctuation">.</span><span class="token function">CreateElement</span><span class="token punctuation">(</span><span class="token string">"gun"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建一个枪的节点元素</span>
                    createElement<span class="token punctuation">.</span><span class="token function">SetAttribute</span><span class="token punctuation">(</span><span class="token string">"type"</span><span class="token punctuation">,</span> TextBox3<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//类型</span>
                    createElement<span class="token punctuation">.</span><span class="token function">SetAttribute</span><span class="token punctuation">(</span><span class="token string">"gid"</span><span class="token punctuation">,</span> TextBox1<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//编号</span>
                    <span class="token class-name">XmlNode</span> createNode <span class="token operator">=</span> <span class="token punctuation">(</span>XmlNode<span class="token punctuation">)</span>createElement<span class="token punctuation">;</span>
                    gunroot<span class="token punctuation">.</span><span class="token function">AppendChild</span><span class="token punctuation">(</span>createNode<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span>

                    <span class="token class-name">XmlElement</span> createElementChildName <span class="token operator">=</span> xmldoc<span class="token punctuation">.</span><span class="token function">CreateElement</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//名称</span>
                    createElementChildName<span class="token punctuation">.</span>InnerText <span class="token operator">=</span> TextBox2<span class="token punctuation">.</span>Text<span class="token punctuation">;</span><span class="token comment">//值</span>
                    createElement<span class="token punctuation">.</span><span class="token function">AppendChild</span><span class="token punctuation">(</span>createElementChildName<span class="token punctuation">)</span><span class="token punctuation">;</span>

                     <span class="token class-name">XmlElement</span> createElementChildFrom <span class="token operator">=</span> xmldoc<span class="token punctuation">.</span><span class="token function">CreateElement</span><span class="token punctuation">(</span><span class="token string">"from"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//产地</span>
                    createElementChildFrom<span class="token punctuation">.</span>InnerText <span class="token operator">=</span> TextBox4<span class="token punctuation">.</span>Text<span class="token punctuation">;</span><span class="token comment">//值</span>
                    createElement<span class="token punctuation">.</span><span class="token function">AppendChild</span><span class="token punctuation">(</span>createElementChildFrom<span class="token punctuation">)</span><span class="token punctuation">;</span>

                     <span class="token class-name">XmlElement</span> createElementChildClip <span class="token operator">=</span> xmldoc<span class="token punctuation">.</span><span class="token function">CreateElement</span><span class="token punctuation">(</span><span class="token string">"clip"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//弹夹</span>
                    createElementChildClip<span class="token punctuation">.</span>InnerText <span class="token operator">=</span> TextBox5<span class="token punctuation">.</span>Text<span class="token punctuation">;</span><span class="token comment">//值</span>
                    createElement<span class="token punctuation">.</span><span class="token function">AppendChild</span><span class="token punctuation">(</span>createElementChildClip<span class="token punctuation">)</span><span class="token punctuation">;</span>

                     <span class="token class-name">XmlElement</span> createElementChildAccurate <span class="token operator">=</span> xmldoc<span class="token punctuation">.</span><span class="token function">CreateElement</span><span class="token punctuation">(</span><span class="token string">"accurate"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//精准</span>
                    createElementChildAccurate<span class="token punctuation">.</span>InnerText <span class="token operator">=</span> TextBox6<span class="token punctuation">.</span>Text<span class="token punctuation">;</span><span class="token comment">//值</span>
                    createElement<span class="token punctuation">.</span><span class="token function">AppendChild</span><span class="token punctuation">(</span>createElementChildAccurate<span class="token punctuation">)</span><span class="token punctuation">;</span>

                     <span class="token class-name">XmlElement</span> createElementChildRange <span class="token operator">=</span> xmldoc<span class="token punctuation">.</span><span class="token function">CreateElement</span><span class="token punctuation">(</span><span class="token string">"range"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//射程</span>
                    createElementChildRange<span class="token punctuation">.</span>InnerText <span class="token operator">=</span> TextBox7<span class="token punctuation">.</span>Text<span class="token punctuation">;</span><span class="token comment">//值</span>
                    createElement<span class="token punctuation">.</span><span class="token function">AppendChild</span><span class="token punctuation">(</span>createElementChildRange<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token function">SaveXML</span><span class="token punctuation">(</span>xmldoc<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//保存文件并刷新当前页面</span>

                    <span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>

                <span class="token keyword">case</span> <span class="token string">"update"</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>修改
                    <span class="token preprocessor property">#<span class="token directive keyword">region</span></span>

                    <span class="token keyword">string</span> conditionPath <span class="token operator">=</span> <span class="token string">"/gunbook/gun[@gid=\""</span> <span class="token operator">+</span> commandAugument <span class="token operator">+</span> <span class="token string">"\"]"</span><span class="token punctuation">;</span><span class="token comment">//XML获取节点的条件，格式固定，如果想要添加属性还可以用“and @属性=属性值” 操作</span>
                    <span class="token class-name">XmlNode</span> updateNode <span class="token operator">=</span> xmldoc<span class="token punctuation">.</span><span class="token function">SelectSingleNode</span><span class="token punctuation">(</span>conditionPath<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//根据条件获取一个节点</span>
                    TextBox1<span class="token punctuation">.</span>Text <span class="token operator">=</span> commandAugument<span class="token punctuation">;</span><span class="token comment">//编号</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>updateNode <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> updateNode<span class="token punctuation">.</span>ChildNodes <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> updateNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">.</span>Count <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        TextBox2<span class="token punctuation">.</span>Text <span class="token operator">=</span> updateNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">;</span><span class="token comment">//名称</span>
                        TextBox3<span class="token punctuation">.</span>Text <span class="token operator">=</span> updateNode<span class="token punctuation">.</span>Attributes<span class="token punctuation">.</span><span class="token function">GetNamedItem</span><span class="token punctuation">(</span><span class="token string">"type"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">;</span><span class="token comment">//类型</span>
                        TextBox4<span class="token punctuation">.</span>Text <span class="token operator">=</span> updateNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">;</span><span class="token comment">//产地</span>
                        TextBox5<span class="token punctuation">.</span>Text <span class="token operator">=</span> updateNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">;</span><span class="token comment">//弹夹</span>
                        TextBox6<span class="token punctuation">.</span>Text <span class="token operator">=</span> updateNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">;</span><span class="token comment">//精准</span>
                        TextBox7<span class="token punctuation">.</span>Text <span class="token operator">=</span> updateNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">.</span><span class="token function">Item</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">;</span><span class="token comment">//射程</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span> 
                    <span class="token punctuation">{<!-- --></span>
                        TextBox2<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                        TextBox3<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                        TextBox4<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                        TextBox5<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                        TextBox6<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                        TextBox7<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>

                <span class="token keyword">default</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>删除
                    <span class="token preprocessor property">#<span class="token directive keyword">region</span></span>

                    <span class="token keyword">string</span> conditionPath2 <span class="token operator">=</span> <span class="token string">"/gunbook/gun[@gid=\""</span> <span class="token operator">+</span> commandAugument <span class="token operator">+</span> <span class="token string">"\"]"</span><span class="token punctuation">;</span><span class="token comment">//XML获取节点的条件，格式固定，如果想要添加属性还可以用“and @属性=属性值” 操作</span>
                    <span class="token class-name">XmlNode</span> deleteNode <span class="token operator">=</span> xmldoc<span class="token punctuation">.</span><span class="token function">SelectSingleNode</span><span class="token punctuation">(</span>conditionPath2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//根据条件获取一个节点</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span>deleteNode <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> 
                    <span class="token punctuation">{<!-- --></span>
                        deleteNode<span class="token punctuation">.</span>ParentNode<span class="token punctuation">.</span><span class="token function">RemoveChild</span><span class="token punctuation">(</span>deleteNode<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//移除当前节点</span>
                    <span class="token punctuation">}</span>

                    <span class="token function">SaveXML</span><span class="token punctuation">(</span>xmldoc<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//保存文件并刷新当前页面</span>

                    <span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            
        <span class="token punctuation">}</span><span class="token comment">//function end</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 获取xml文件路径</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">string</span> <span class="token function">GetXMLPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">string</span> xmlPath <span class="token operator">=</span> Server<span class="token punctuation">.</span><span class="token function">MapPath</span><span class="token punctuation">(</span><span class="token string">"Gun.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> xmlPath<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 保存XML文件</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="xmldoc"&gt;xml文件名称&lt;/param&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">SaveXML</span><span class="token punctuation">(</span><span class="token class-name">XmlDocument</span> xmldoc<span class="token punctuation">)</span> 
        <span class="token punctuation">{<!-- --></span>
            xmldoc<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token function">GetXMLPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">OperationXML</span><span class="token punctuation">(</span><span class="token string">"select"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//刷新页面</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">GridView1_RowCommand</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">GridViewCommandEventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>CommandName <span class="token operator">==</span> <span class="token string">"upd"</span><span class="token punctuation">)</span><span class="token comment">//编辑</span>
            <span class="token punctuation">{<!-- --></span>
                TextBox1<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span><span class="token comment">//编号不能编辑，否则失去主键意义</span>
                <span class="token keyword">string</span> guid <span class="token operator">=</span> e<span class="token punctuation">.</span>CommandArgument<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token function">OperationXML</span><span class="token punctuation">(</span><span class="token string">"update"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>CommandArgument<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//GridViewRow gvr = (GridViewRow)(((LinkButton)(e.CommandSource)).Parent.Parent);//当前控件所在行</span>
                <span class="token comment">//int j = gvr.RowIndex;//当前控件所在行的 Index，即行的位置</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token comment">//del，删除</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">OperationXML</span><span class="token punctuation">(</span><span class="token string">"delete"</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span>CommandArgument<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//分页</span>
        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">GridView1_PageIndexChanging</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">GridViewPageEventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            GridView1<span class="token punctuation">.</span>PageIndex <span class="token operator">=</span> e<span class="token punctuation">.</span>NewPageIndex<span class="token punctuation">;</span>
            <span class="token function">OperationXML</span><span class="token punctuation">(</span><span class="token string">"select"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//绑定数据源</span>
        <span class="token punctuation">}</span>
      
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>View Code<br> 当然，这里的查询还可以按照条件来，只不过我这里没有实现，有兴趣可以自己试试。</p> 
<p>转载于:https://www.cnblogs.com/programsky/p/4620480.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8c1ffb66a860363f81db8181a8b20b7a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux内存管理之kmalloc、malloc、vmalloc的区别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4280001ccc6308123a1c48a9ade7dabb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">在Ubuntu下使用QEMU搭建arm开发环境（六）配置网络</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>