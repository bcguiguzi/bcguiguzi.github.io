<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ubuntu 14.04：PaddleOCR基于PaddleServing的在线服务化部署（失败） - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Ubuntu 14.04：PaddleOCR基于PaddleServing的在线服务化部署（失败）" />
<meta property="og:description" content="一、 二、安装 注：
安装 PaddleOCR 2.3 。
因为 PaddleOCR 2.4 的 推荐环境 PaddlePaddle &gt;= 2.1.2。
https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.4/doc/doc_ch/environment.md
安装前的环境准备 在使用Paddle Serving之前，需要完成如下任务：
（1）安装python 3.8 具体安装方法请参见 Ubuntu 14.04：安装PaddlePaddle（Conda安装）-CSDN博客 （2）安装paddlepaddle 2.0.0
具体安装方法请参见 Ubuntu 14.04：安装PaddlePaddle（Conda安装）-CSDN博客 参考资料：https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.3/doc/doc_ch/environment.md
安装时的运行环境准备 准备 PaddleOCR 的运行环境链接 下载 PaddleOCR 2.3
https://codeload.github.com/PaddlePaddle/PaddleOCR/zip/refs/heads/release/2.3
上传到目标位置，解压
unzip PaddleOCR-release-2.3.zip
注：
官方文档中，是 clone。
因为我 clone 时有异常，偷懒不想处理，就直接下载包，然后安装。
查看 github 中的 PaddleOCR 版本 GitHub - PaddlePaddle/PaddleOCR
准备 PaddleServing 的运行环境 参考资料：https://github.com/PaddlePaddle/Serving/blob/v0.9.0/doc/Latest_Packages_EN.md
查看版本：
https://github.com/PaddlePaddle/Serving
切换到 PaddleOCR 的运行环境中的 pdserving 目录 /home/xxx/PaddleOCR-release-2.3/deploy/pdserving
paddle-serving-server：paddle_serving_server-0.9.0-py3-none-any.whl 安装server，用于启动服务" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/ac4b4a5c2d6915f80fa59d5128a44051/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-12T17:40:03+08:00" />
<meta property="article:modified_time" content="2024-03-12T17:40:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Ubuntu 14.04：PaddleOCR基于PaddleServing的在线服务化部署（失败）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p></p> 
<h2>一、</h2> 
<p></p> 
<h2>二、安装</h2> 
<p>注：</p> 
<p>安装 PaddleOCR 2.3 。</p> 
<p>因为 PaddleOCR 2.4 的 推荐环境 PaddlePaddle &gt;= 2.1.2。</p> 
<p><a href="https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.4/doc/doc_ch/environment.md" title="https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.4/doc/doc_ch/environment.md">https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.4/doc/doc_ch/environment.md</a></p> 
<p><img alt="" height="293" src="https://images2.imgbox.com/b5/f4/ceE2ykCh_o.png" width="792"></p> 
<p></p> 
<h3>安装前的环境准备</h3> 
<p></p> 
<p>在使用Paddle Serving之前，需要完成如下任务：</p> 
<p>（1）安装python 3.8 </p> 
<p>具体安装方法请参见 <a href="https://blog.csdn.net/djj1015591892/article/details/136587018" title="Ubuntu 14.04：安装PaddlePaddle（Conda安装）-CSDN博客">Ubuntu 14.04：安装PaddlePaddle（Conda安装）-CSDN博客</a> </p> 
<p><br> （2）安装paddlepaddle 2.0.0</p> 
<p>具体安装方法请参见 <a href="https://blog.csdn.net/djj1015591892/article/details/136587018" title="Ubuntu 14.04：安装PaddlePaddle（Conda安装）-CSDN博客">Ubuntu 14.04：安装PaddlePaddle（Conda安装）-CSDN博客</a> </p> 
<p></p> 
<p><span style="background-color:#f9eda6;"> 参考资料</span>：<a href="https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.3/doc/doc_ch/environment.md" title="https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.3/doc/doc_ch/environment.md">https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.3/doc/doc_ch/environment.md</a></p> 
<p><img alt="" height="605" src="https://images2.imgbox.com/bf/a9/APnYogL8_o.png" width="1200"></p> 
<p></p> 
<h3>安装时的运行环境准备</h3> 
<h4>准备 PaddleOCR 的运行环境链接</h4> 
<p><span style="background-color:#f9eda6;">下载 PaddleOCR 2.3</span></p> 
<p><a href="https://codeload.github.com/PaddlePaddle/PaddleOCR/zip/refs/heads/release/2.3" rel="nofollow" title="https://codeload.github.com/PaddlePaddle/PaddleOCR/zip/refs/heads/release/2.3">https://codeload.github.com/PaddlePaddle/PaddleOCR/zip/refs/heads/release/2.3</a></p> 
<p></p> 
<p><img alt="" height="574" src="https://images2.imgbox.com/10/5f/G6HJCuJB_o.png" width="1200"></p> 
<p></p> 
<p><img alt="" height="54" src="https://images2.imgbox.com/e3/a6/lkaD0c19_o.png" width="344"></p> 
<p><span style="background-color:#f9eda6;">上传到目标位置，解压</span></p> 
<blockquote> 
 <p>unzip PaddleOCR-release-2.3.zip</p> 
</blockquote> 
<p><img alt="" height="105" src="https://images2.imgbox.com/0c/f0/UShynTCp_o.png" width="787"></p> 
<p></p> 
<p>注：</p> 
<p>官方文档中，是 clone。</p> 
<p>因为我 clone 时有异常，偷懒不想处理，就直接下载包，然后安装。</p> 
<p><img alt="" height="83" src="https://images2.imgbox.com/0e/c2/IrDbu60T_o.png" width="1200"></p> 
<p></p> 
<h5>查看 github 中的 PaddleOCR 版本</h5> 
<p><a href="https://github.com/PaddlePaddle/PaddleOCR" title="GitHub - PaddlePaddle/PaddleOCR">GitHub - PaddlePaddle/PaddleOCR</a></p> 
<p><img alt="" height="770" src="https://images2.imgbox.com/a3/7a/Ob0fD1r2_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<h4>准备 PaddleServing 的运行环境</h4> 
<p>参考资料：<a href="https://github.com/PaddlePaddle/Serving/blob/v0.9.0/doc/Latest_Packages_EN.md" title="https://github.com/PaddlePaddle/Serving/blob/v0.9.0/doc/Latest_Packages_EN.md">https://github.com/PaddlePaddle/Serving/blob/v0.9.0/doc/Latest_Packages_EN.md</a></p> 
<p></p> 
<p><span style="background-color:#f9eda6;"> 查看版本</span>：</p> 
<p><a href="https://github.com/PaddlePaddle/Serving" title="https://github.com/PaddlePaddle/Serving">https://github.com/PaddlePaddle/Serving</a></p> 
<p><img alt="" height="688" src="https://images2.imgbox.com/e1/1c/GkeX5lf2_o.png" width="1200"></p> 
<p></p> 
<h5>切换到 PaddleOCR 的运行环境中的 pdserving 目录</h5> 
<p>/home/xxx/PaddleOCR-release-2.3/deploy/pdserving<br>  </p> 
<h5>paddle-serving-server：paddle_serving_server-0.9.0-py3-none-any.whl</h5> 
<p>安装server，用于启动服务</p> 
<p><span style="background-color:#f9eda6;">下载</span></p> 
<blockquote> 
 <p>wget https://paddle-serving.bj.bcebos.com/test-dev/whl/paddle_serving_server-0.9.0-py3-none-any.whl</p> 
</blockquote> 
<p><img alt="" height="331" src="https://images2.imgbox.com/e4/50/gE8NUWm6_o.png" width="1200"></p> 
<p><img alt="" height="136" src="https://images2.imgbox.com/37/be/sy0kBCRv_o.png" width="1200"></p> 
<p><span style="background-color:#f9eda6;">安装</span></p> 
<p>注：此处需要进入paddlepaddle所在的Anaconda虚拟环境，那里面才有pip3。</p> 
<blockquote> 
 <p>pip3 install paddle_serving_server-0.9.0-py3-none-any.whl</p> 
</blockquote> 
<p><img alt="" height="678" src="https://images2.imgbox.com/41/9a/vcoSV0kK_o.png" width="1200"></p> 
<p><img alt="" height="613" src="https://images2.imgbox.com/05/9e/aLupnjI8_o.png" width="1200"></p> 
<p><img alt="" height="457" src="https://images2.imgbox.com/c1/4c/J4h8pRgr_o.png" width="1200"></p> 
<p></p> 
<h5>paddle-serving-app：paddle_serving_app-0.9.0-py3-none-any.whl</h5> 
<p><span style="background-color:#f9eda6;">下载</span></p> 
<blockquote> 
 <p>wget https://paddle-serving.bj.bcebos.com/test-dev/whl/arm/paddle_serving_app-0.9.0-py3-none-any.whl</p> 
</blockquote> 
<p><img alt="" height="331" src="https://images2.imgbox.com/c2/fd/e23CTTmk_o.png" width="1200"></p> 
<p><img alt="" height="97" src="https://images2.imgbox.com/52/a5/77BxwPvk_o.png" width="1200"></p> 
<p><span style="background-color:#f9eda6;">安装</span></p> 
<p>注：此处需要进入paddlepaddle所在的Anaconda虚拟环境，那里面才有pip3。</p> 
<blockquote> 
 <p>pip3 install paddle_serving_app-0.9.0-py3-none-any.whl</p> 
</blockquote> 
<p><img alt="" height="669" src="https://images2.imgbox.com/62/15/Rv04JSgZ_o.png" width="1200"></p> 
<p></p> 
<h5>paddle-serving-client： paddle_serving_client-0.9.0-cp38-none-any.whl</h5> 
<p>安装client，用于向服务发送请求。</p> 
<p></p> 
<p><span style="background-color:#f9eda6;">下载</span></p> 
<p>下载链接：</p> 
<p><a href="https://github.com/PaddlePaddle/Serving/blob/v0.9.0/doc/Latest_Packages_EN.md" title="https://github.com/PaddlePaddle/Serving/blob/v0.9.0/doc/Latest_Packages_EN.md">https://github.com/PaddlePaddle/Serving/blob/v0.9.0/doc/Latest_Packages_EN.md</a></p> 
<p><img alt="" height="282" src="https://images2.imgbox.com/d4/60/f2XzGvSn_o.png" width="896"></p> 
<p>注：不同的Python版本，对应不同哦！</p> 
<p></p> 
<p>也可以直接用wget：</p> 
<blockquote> 
 <p>wget https://paddle-serving.bj.bcebos.com/test-dev/whl/paddle_serving_client-0.9.0-cp38-none-any.whl</p> 
</blockquote> 
<p></p> 
<p><span style="background-color:#f9eda6;">whl包放到目标位置</span></p> 
<p>/home/xxx/PaddleOCR-release-2.3/deploy/pdserving</p> 
<p><img alt="" height="110" src="https://images2.imgbox.com/7c/cb/XtR7rAnL_o.png" width="1200"></p> 
<p></p> 
<p><span style="background-color:#f9eda6;">安装</span></p> 
<p>注：此处需要进入paddlepaddle所在的Anaconda虚拟环境，那里面才有pip3。</p> 
<blockquote> 
 <p>pip3 install paddle_serving_client-0.9.0-cp38-none-any.whl</p> 
</blockquote> 
<p><img alt="" height="713" src="https://images2.imgbox.com/eb/72/b1mgheAk_o.png" width="1200"></p> 
<p></p> 
<h3>inference 模型转换</h3> 
<p>使用PaddleServing做服务化部署时，需要将保存的inference模型转换为serving易于部署的模型。</p> 
<p></p> 
<h4>模型存放位置</h4> 
<p><span style="background-color:#f9eda6;">切换到 PaddleOCR 的运行环境中的 pdserving 目录</span><br> /home/xxx/PaddleOCR-release-2.3/deploy/pdserving</p> 
<p><span style="background-color:#f9eda6;">创建目录：inference</span></p> 
<blockquote> 
 <p>mkdir inference</p> 
</blockquote> 
<p><img alt="" height="122" src="https://images2.imgbox.com/0f/bc/RMzKnb1s_o.png" width="1200"></p> 
<p><span style="background-color:#f9eda6;">模型存放位置</span></p> 
<p>/home/xxx/PaddleOCR-release-2.3/deploy/pdserving/inference</p> 
<p></p> 
<h4>模型下载链接</h4> 
<p><span style="background-color:#f9eda6;">模型下载链接1</span>：</p> 
<p><a href="https://github.com/PaddlePaddle/PaddleOCR/tree/release/2.3?tab=readme-ov-file" title="GitHub - PaddlePaddle/PaddleOCR at release/2.3">GitHub - PaddlePaddle/PaddleOCR at release/2.3</a></p> 
<p><img alt="" height="620" src="https://images2.imgbox.com/8e/a8/asYWmVq6_o.png" width="906"></p> 
<p></p> 
<p> <span style="background-color:#f9eda6;">模型下载链接2</span>：<a href="https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.3/doc/doc_en/models_list_en.md" title="https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.3/doc/doc_en/models_list_en.md">https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.3/doc/doc_en/models_list_en.md</a></p> 
<p><img alt="" height="632" src="https://images2.imgbox.com/a6/30/lOGel35R_o.png" width="1057"></p> 
<p></p> 
<p><img alt="" height="738" src="https://images2.imgbox.com/72/d3/nY2VIDOV_o.png" width="1046"></p> 
<p></p> 
<h4>OCR 文本检测模型</h4> 
<p><span style="background-color:#f9eda6;">下载并解压</span></p> 
<p>可以下载包，上传至目标位置，也可以wget。</p> 
<p>我这里是wget，省去上传的步骤。</p> 
<blockquote> 
 <p>wget https://paddleocr.bj.bcebos.com/PP-OCRv2/chinese/ch_PP-OCRv2_det_infer.tar -O ch_PP-OCRv2_det_infer.tar &amp;&amp; tar -xf ch_PP-OCRv2_det_infer.tar</p> 
</blockquote> 
<p><img alt="" height="468" src="https://images2.imgbox.com/e4/b7/9nwKVoJR_o.png" width="1200"></p> 
<p></p> 
<p><span style="background-color:#f9eda6;">转换模型</span></p> 
<p>？</p> 
<p></p> 
<h4>OCR 文本识别模型</h4> 
<p><span style="background-color:#f9eda6;">下载并解压</span></p> 
<p>可以下载包，上传至目标位置，也可以wget。</p> 
<p>我这里是wget，省去上传的步骤。</p> 
<blockquote> 
 <p>wget https://paddleocr.bj.bcebos.com/PP-OCRv2/chinese/ch_PP-OCRv2_rec_infer.tar -O ch_PP-OCRv2_rec_infer.tar &amp;&amp;  tar -xf ch_PP-OCRv2_rec_infer.tar</p> 
</blockquote> 
<p><img alt="" height="618" src="https://images2.imgbox.com/26/42/0Dnaz5tp_o.png" width="1200"></p> 
<p></p> 
<p><span style="background-color:#f9eda6;">转换模型</span></p> 
<p>？</p> 
<p></p> 
<h4>异常处理</h4> 
<p><span style="background-color:#f9eda6;">上面转换模型时，出现下面的异常</span></p> 
<blockquote> 
 <p>ImportError: dlopen: cannot load any more object with static TLS</p> 
</blockquote> 
<p><img alt="" height="741" src="https://images2.imgbox.com/dd/34/sfBrZUug_o.png" width="1200"></p> 
<p><img alt="" height="419" src="https://images2.imgbox.com/86/70/Ky35HktV_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<p>问题点：~/workspace/anaconda3/envs/paddle_env/lib/python3.8/site-packages/paddle/fluid/core.py</p> 
<p><a href="https://blog.csdn.net/blobliu/article/details/119145108" title="dlopen: cannot load any more object with static TLS问题解决-CSDN博客">dlopen: cannot load any more object with static TLS问题解决-CSDN博客</a></p> 
<p><img alt="" height="585" src="https://images2.imgbox.com/72/40/wtXzeDxN_o.png" width="1200"></p> 
<p></p> 
<p>解决方案：升级glibc版本到2.23。</p> 
<p></p> 
<p><span style="color:#fe2c24;"><span style="background-color:#f9eda6;">20240312 娟娟：因为glibc升级可能引起系统奔溃，所以下面流程不再处理，转 PaddleHub Serving 。</span></span></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4cd35d57b8c7075379316e469590e568/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">探索TikTok云手机在社交媒体营销的作用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8a4e3d52e53fea3de0fbc925a29783df/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据结构中的平衡搜索树 --- AVL树是怎样进行旋转处理的？（平衡因子版本）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>