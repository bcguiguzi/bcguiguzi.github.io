<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>GR - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="GR" />
<meta property="og:description" content="应用场景： GR适用功能场景：核心交换机S86或者S12K双主控引擎，或是两台S86或者S12K构建VSU的场景下，双链路与邻居设备（比如聚合AP口与汇聚5750E设备相连）互联，同时启用动态路由协议（常见的OSPF，BGP）时与邻居设备交互路由，强烈建议开启GR功能，这样当双引擎中的主引擎故障的时候切换到备引擎工作，或者是VSU组中的主设备故障时候切换到备设备工作的时候，能够保证邻居以及自身的OSPF，BGP路由条目保持不删除，只是邻居关系重新收敛建立，这样保证数据不断流转发（根据每个测试场景实际情况的不同有时候不丢包，有时候丢1个包）。
功能简介： GR技术产生的背景：
1、分布式架构并支持不间断转发技术的设备，要求控制平面和数据平面分离。
2、控制平面负责路由计算、表项下发等；数据平面根据控制平面下发的转发表项进行数据转发。
3、在主备引擎切换时，备引擎上有数据平面信息，可以快速接替主引擎完成数据转发；但备引擎无控制面信息（比如动态路由数据库、邻居关系等），那么将导致其邻接设备检测到本设备动态协议中断，邻接的设备动态路由重新收敛，导致整网路由黑洞或路由旁路。
4、动态路由的收敛时间将是分钟级别的，无法满足不间断转发需求。
GR的原理：
Graceful Restart（优雅重启），主要是为了实现在协议的重新启动过程中数据转发不间断。在管理板主备切换过程中，GR功能使动态路由邻居的路由转发表项保持住，待新的邻居协商收敛完成后再进行表项刷新，使得网络拓扑保持稳定，维持转发表；保障业务不中断。
GR的两个角色：
Restarter：要执行优雅重启的设备
Helper ：辅助Restarter完成优雅重启，是Restarter的邻接设备
GR配置：
1、RIP-GR配置：需在本端配置Restarter，邻接设备无需配置（RIP天然支持Helper 角色）
Ruijie(config)#router rip
Ruijie(config-router)#graceful-restart
2、OSPF-GR配置：需在本端配置Restarter，邻接设备配置helper（锐捷设备默认开启helper功能，无需配置；友商设备行为需要确认，多数也为默认，建议参阅其配置手册确认）
Ruijie(config)#router ospf 1
Ruijie(config-router)#graceful-restart 3、BGP-GR配置：两端都需配置Restarter
Ruijie(config)#router bgp 1
Ruijie(config-router)#bgp graceful-restart 4、LDP-GR配置：需在本端配置Restarter，邻接设备配置helper（锐捷设备默认开启helper功能，无需配置；友商设备行为需要确认，多数也为默认，建议参阅其配置手册确认）
Ruijie(config)#mpls router ldp
Ruijie(config-mpls-router)#graceful-restart
转载于:https://blog.51cto.com/12855977/2106732" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/f214a7d42e0de5875d55189e01e2e187/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-04-23T12:12:41+08:00" />
<meta property="article:modified_time" content="2018-04-23T12:12:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">GR</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="artical-content-bak main-content editor-side-new"> 
 <div class="con editor-preview-side" id="result"> 
  <p><strong><span style="color:#FF0000;font-family:'微软雅黑', 'sans-serif';font-size:15px;">应用场景： </span></strong></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', 'sans-serif';font-size:13px;">GR适用功能场景：核心交换机S86或者S12K双主控引擎，或是两台S86或者S12K构建VSU的场景下，双链路与邻居设备（比如聚合AP口与汇聚5750E设备相连）互联，同时启用动态路由协议（常见的OSPF，BGP）时与邻居设备交互路由，强烈建议开启GR功能，这样当双引擎中的主引擎故障的时候切换到备引擎工作，或者是VSU组中的主设备故障时候切换到备设备工作的时候，能够保证邻居以及自身的OSPF，BGP路由条目保持不删除，只是邻居关系重新收敛建立，这样保证数据不断流转发（根据每个测试场景实际情况的不同有时候不丢包，有时候丢1个包）。</span></p> 
  <p><span style="font-family:Tahoma, sans-serif;font-size:12px;"></span></p> 
  <p><strong><span style="color:#FF0000;font-family:'微软雅黑', 'sans-serif';font-size:15px;"> </span></strong></p> 
  <p><strong><span style="color:#FF0000;font-family:'微软雅黑', 'sans-serif';font-size:15px;">功能简介： </span></strong></p> 
  <p style="margin-left:27px;"><span style="color:#800000;font-family:'微软雅黑', 'sans-serif';font-size:13px;">GR技术产生的背景：</span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">1、分布式架构并支持不间断转发技术的设备，要求控制平面和数据平面分离。</span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">2、控制平面负责路由计算、表项下发等；数据平面根据控制平面下发的转发表项进行数据转发。</span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">3、在主备引擎切换时，备引擎上有数据平面信息，可以快速接替主引擎完成数据转发；但备引擎无控制面信息（比如动态路由数据库、邻居关系等），那么将导致其邻接设备检测到本设备动态协议中断，邻接的设备动态路由重新收敛，导致整网路由黑洞或路由旁路。</span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">4、动态路由的收敛时间将是分钟级别的，无法满足不间断转发需求。</span></p> 
  <p style="margin-left:27px;"><span style="color:#800000;font-family:'微软雅黑', 'sans-serif';font-size:13px;">GR的原理：</span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">Graceful Restart（优雅重启），主要是为了实现在协议的重新启动过程中数据转发不间断。在管理板主备切换过程中，GR功能使动态路由邻居的路由转发表项保持住，待新的邻居协商收敛完成后再进行表项刷新，使得网络拓扑保持稳定，维持转发表；保障业务不中断。</span></p> 
  <p style="margin-left:27px;"><span style="color:#800000;font-family:'微软雅黑', 'sans-serif';font-size:13px;">GR的两个角色：</span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">Restarter：要执行优雅重启的设备</span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">Helper ：辅助Restarter完成优雅重启，是Restarter的邻接设备</span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;"> </span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;"> </span></p> 
  <p><strong><span style="color:#FF0000;font-family:'微软雅黑', 'sans-serif';font-size:15px;">GR配置：</span></strong></p> 
  <p><span style="font-family:'微软雅黑', sans-serif;font-size:13px;"> </span></p> 
  <p style="margin-left:27px;"><strong><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">1、RIP-GR配置：需在本端配置Restarter，邻接设备无需配置（RIP天然支持Helper 角色）</span></strong></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">Ruijie(config)#router rip</span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">Ruijie(config-router)#graceful-restart</span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;"> </span></p> 
  <p style="margin-left:27px;"><strong><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">2、OSPF-GR配置：需在本端配置Restarter，邻接设备配置helper（锐捷设备默认开启helper功能，无需配置；友商设备行为需要确认，多数也为默认，建议参阅其配置手册确认）</span></strong></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">Ruijie(config)#router ospf 1</span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">Ruijie(config-router)#graceful-restart </span></p> 
  <p style="margin-left:27px;"><strong><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">3、BGP-GR配置：两端都需配置Restarter</span></strong></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">Ruijie(config)#router bgp 1</span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">Ruijie(config-router)#bgp graceful-restart </span></p> 
  <p style="margin-left:27px;"><strong><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">4、LDP-GR配置：需在本端配置Restarter，邻接设备配置helper（锐捷设备默认开启helper功能，无需配置；友商设备行为需要确认，多数也为默认，建议参阅其配置手册确认）</span></strong></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">Ruijie(config)#mpls router ldp</span></p> 
  <p style="margin-left:53px;"><span style="font-family:'微软雅黑', sans-serif;font-size:13px;">Ruijie(config-mpls-router)#graceful-restart</span></p> 
  <p><br></p> 
 </div> 
</div> 
<p>转载于:https://blog.51cto.com/12855977/2106732</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8ff154f1b6166dcc48699fd78ce4f279/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">kali修改配置文件后并保存</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1fce57247f944b6235557647cce875e4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL 中的 information_schema 数据库</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>