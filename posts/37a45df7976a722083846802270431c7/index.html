<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【OpenCv】 VS C&#43;&#43; 图像处理（一）: 环境配置及简单使用 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【OpenCv】 VS C&#43;&#43; 图像处理（一）: 环境配置及简单使用" />
<meta property="og:description" content="欢迎大家访问我的github:https://github.com/Iamttp 有问题欢迎在评论留言呀！
OpenCv专栏：https://blog.csdn.net/qq_40515692/article/details/102885061
2020/2/5更新：
VS2019/VS2017 OpenCv配置：
VS对于C&#43;&#43;配置外部库有两种方式，另一种写在了后面，这里介绍的是新建配置文件的方式，这种方式好处是一劳永逸，我重装电脑后直接用的之前在VS2017上生成的配置文件配置的VS2019。所以非常方便。
首先是VS的OpenCv配置，外部库目录指定和外部包含文件的指定。
指定建立的工程为空白工程。建立完工程之后，我们选中解决方案栏中的Resource Files目录（即源码目录），然后新建一个C&#43;&#43;源码文件。设置源码的文件名，例如：Main，然后创建此源码文件到工程中。在VS中有个叫做“属性管理器”的工具，用于进行VS整体参数的配置，配置一次之后，以后所有新建项目都能应用改配置，不用再一一进行配置操作，使用起来也非常方便。点击工具栏中的：View—&gt;Other Windows—&gt;Property Manger打开属性管理器。我先假设配置的VS运行环境为 Debug | x64 ，VS上面很醒目的地方可以更改。选择给新项目添加属性配置表。（如果配置好后保存好文件，下一次新建项目就可以选择添加已存在的属性配置表了）。 取个和项目相关的名字吧。然后双击刚刚新建的文件。
1）配置包含目录：
在通用属性（Common Properties）—&gt;VC &#43;&#43;目录—&gt;包含目录，然后点击右侧三角标志选中Edit进入编辑：
向其中添加下面三个路径（你自己的OpenCv安装的位置）：
F:\opencv\build\include
F:\opencv\build\include\opencv
F:\opencv\build\include\opencv2
2）配置库文件目录：
完成上面的包含目录配置之后，我们还需要进行库文件的配置：回到属性界面，选择包含目录下面的Library Directories（库文件目录）：
向库文件目录下添加OpenCV的库文件目录：F:\opencv\build\x64\vc14\lib，这个目录根据每个人自己在第一步安装OpenCV中选择的目录进行选定：
3）配置动态链接库：
我们可以查看步骤2）中添加的库文件目录下面.lib文件列表，发现在3.1.0版本的OpenCV中，仅剩下两个库文件，分别是：opencv_world310.lib和opencv_world310d.lib，这里两个库文件的区别就是：opencv_world310.lib是Release模式版本，而opencv_world310d.lib是Debug模式版本：
我们刚刚选的Debug模式版本，跟上述两个步骤相似，在属性界面中打开Linker(链接库)—&gt;Input(输入)—&gt;Additional Dependencies(添加依赖)：
将我们刚刚在OpenCV库文件目录下看到的两个库文件其中一个添加到这里：
上面部分为新建工程时VS的Opencv的配置，配置好了之后可以引入头文件，使用OpenCv了。正常运行：
VS OpenCv配置：
首先是VS的OpenCv配置，外部库目录指定和外部包含文件的指定。
指定建立的工程为空白工程：建立完工程之后，我们选中解决方案栏中的Resource Files目录（即源码目录），然后新建一个C&#43;&#43;源码文件：设置源码的文件名，例如：Main，然后创建此源码文件到工程中： 在VS中有个叫做“属性管理器”的工具，用于进行VS整体参数的配置，配置一次之后，以后所有新建项目都能应用改配置，不用再一一进行配置操作，使用起来也非常方便。点击工具栏中的：View—&gt;Other Windows—&gt;Property Manger打开属性管理器：在新出现的属性管理器栏中，展开目录，选中Debug|Win64中的Microsoft.Cpp.x64.user，并右键点击属性（Properties）进入属性界面： 1）配置包含目录：
在通用属性（Common Properties）—&gt;VC &#43;&#43;目录—&gt;包含目录，然后点击右侧三角标志选中Edit进入编辑：
向其中添加下面三个路径（你自己的OpenCv安装的位置）：
E:\OpenCV\opencv\build\include
E:\OpenCV\opencv\build\include\opencv
E:\OpenCV\opencv\build\include\opencv2
2）配置库文件目录：
完成上面的包含目录配置之后，我们还需要进行库文件的配置：回到属性界面，选择包含目录下面的Library Directories（库文件目录）：
向库文件目录下添加OpenCV的库文件目录：E:\OpenCV\opencv\build\x64\vc14\lib，这个目录根据每个人自己在第一步安装OpenCV中选择的目录进行选定：
3）配置动态链接库：
我们可以查看步骤2）中添加的库文件目录下面.lib文件列表，发现在3.1.0版本的OpenCV中，仅剩下两个库文件，分别是：opencv_world310.lib和opencv_world310d.lib，这里两个库文件的区别就是：opencv_world310.lib是Release模式版本，而opencv_world310d.lib是Debug模式版本：
跟上述两个步骤相似，在属性界面中打开Linker(链接库)—&gt;Input(输入)—&gt;Additional Dependencies(添加依赖)：
将我们刚刚在OpenCV库文件目录下看到的两个库文件其中一个添加到这里（根据模式需求Release模式或Debug模式）：
上面部分为新建工程时VS的Opencv的配置，配置好了之后可以引入头文件，使用OpenCv了。
OpenCv图像处理：
（1）.首先讲解OpenCv改变图像大小，这里以调用摄像头举例。
#include&lt;opencv2\core\core.hpp&gt; #include&lt;opencv2\highgui\highgui.hpp&gt; #include&lt;opencv2\opencv.hpp&gt; using namespace cv; int main() { // 从摄像头读入视频 VideoCapture capture(0); while (1) { Mat frame;	//定义一个Mat变量，用于存储每一帧的图像 capture &gt;&gt; frame;	//读取当前帧 resize(frame, frame, Size(360, 240));	//改变图像大小 imshow(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/37a45df7976a722083846802270431c7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-07-14T14:54:18+08:00" />
<meta property="article:modified_time" content="2018-07-14T14:54:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【OpenCv】 VS C&#43;&#43; 图像处理（一）: 环境配置及简单使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>欢迎大家访问我的github:<a href="https://github.com/Iamttp">https://github.com/Iamttp </a>有问题欢迎在评论留言呀！</p> 
<p>OpenCv专栏：<a href="https://blog.csdn.net/qq_40515692/article/details/102885061">https://blog.csdn.net/qq_40515692/article/details/102885061</a></p> 
<hr> 
<p>2020/2/5更新：</p> 
<p><strong>VS2019/VS2017 OpenCv配置：</strong></p> 
<p>VS对于C++配置外部库有两种方式，另一种写在了后面，这里介绍的是新建配置文件的方式，这种方式好处是一劳永逸，我重装电脑后直接用的之前在VS2017上生成的配置文件配置的VS2019。所以非常方便。</p> 
<p> </p> 
<p>首先是VS的OpenCv配置，外部库目录指定和外部包含文件的指定。</p> 
<ol><li>指定建立的工程为空白工程。</li><li>建立完工程之后，我们选中解决方案栏中的Resource Files目录（即源码目录），然后新建一个C++源码文件。</li><li>设置源码的文件名，例如：Main，然后创建此源码文件到工程中。</li><li>在VS中有个叫做“<span style="color:#ff6600;">属性管理器</span>”的工具，用于进行VS整体参数的配置，配置一次之后，以后所有新建项目都能应用改配置，不用再一一进行配置操作，使用起来也非常方便。点击工具栏中的：View—&gt;Other Windows—&gt;Property Manger打开属性管理器。</li><li>我先假设配置的VS运行环境为 Debug | x64 ，VS上面很醒目的地方可以更改。选择给新项目添加属性配置表。（如果配置好后保存好文件，下一次新建项目就可以选择添加已存在的属性配置表了）。</li></ol> 
<p><img alt="" class="has" height="161" src="https://images2.imgbox.com/d2/79/2T6sul5y_o.png" width="639"></p> 
<p>取个和项目相关的名字吧。然后双击刚刚新建的文件。</p> 
<p> <img alt="" class="has" height="105" src="https://images2.imgbox.com/b0/ff/6WQqPjmN_o.png" width="335"></p> 
<p> </p> 
<p>1）配置包含目录：</p> 
<p>        在通用属性（Common Properties）—&gt;VC ++目录—&gt;包含目录，然后点击右侧三角标志选中Edit进入编辑：</p> 
<p>        向其中添加下面三个路径（你自己的OpenCv安装的位置）：</p> 
<p>        F:\opencv\build\include</p> 
<p>        F:\opencv\build\include\opencv</p> 
<p>        F:\opencv\build\include\opencv2</p> 
<p> </p> 
<p><img alt="" class="has" height="273" src="https://images2.imgbox.com/ee/be/5UcO0hrt_o.png" width="876"></p> 
<p>2）配置库文件目录：</p> 
<p>        完成上面的包含目录配置之后，我们还需要进行库文件的配置：回到属性界面，选择包含目录下面的Library Directories（库文件目录）：</p> 
<p>        向库文件目录下添加OpenCV的库文件目录：F:\opencv\build\x64\vc14\lib，这个目录根据每个人自己在第一步安装OpenCV中选择的目录进行选定：</p> 
<p><img alt="" class="has" height="257" src="https://images2.imgbox.com/4c/c0/iQTN0t8D_o.png" width="884"></p> 
<p>3）配置动态链接库：</p> 
<p>        我们可以查看步骤2）中添加的库文件目录下面.lib文件列表，发现在3.1.0版本的OpenCV中，仅剩下两个库文件，分别是：<span style="color:#ff6600;">opencv_world310.lib</span>和<span style="color:#ff6600;">opencv_world310d.lib</span>，这里两个库文件的区别就是：<span style="color:#ff6600;">opencv_world310.lib</span>是Release模式版本，而<span style="color:#ff6600;">opencv_world310d.lib</span>是Debug模式版本：</p> 
<p>        我们刚刚选的Debug模式版本，跟上述两个步骤相似，在属性界面中打开Linker(链接库)—&gt;Input(输入)—&gt;Additional Dependencies(添加依赖)：</p> 
<p>        将我们刚刚在OpenCV库文件目录下看到的两个库文件其中一个添加到这里：</p> 
<p><img alt="" class="has" height="286" src="https://images2.imgbox.com/67/08/YJqV8HBL_o.png" width="873"></p> 
<p> </p> 
<p>上面部分为新建工程时VS的Opencv的配置，配置好了之后可以引入头文件，使用OpenCv了。正常运行：</p> 
<p><img alt="" class="has" height="807" src="https://images2.imgbox.com/e2/4f/xHj6oDyq_o.png" width="1200"></p> 
<hr> 
<p> </p> 
<p><strong>VS OpenCv配置：</strong></p> 
<p>首先是VS的OpenCv配置，外部库目录指定和外部包含文件的指定。</p> 
<ol><li>指定建立的工程为空白工程：</li><li>建立完工程之后，我们选中解决方案栏中的Resource Files目录（即源码目录），然后新建一个C++源码文件：</li><li>设置源码的文件名，例如：Main，然后创建此源码文件到工程中： </li></ol> 
<p><img alt="" class="has" src="https://images2.imgbox.com/e5/2c/kAfmjh9k_o.png"></p> 
<p> </p> 
<ol><li>在VS中有个叫做“<span style="color:#ff6600;">属性管理器</span>”的工具，用于进行VS整体参数的配置，配置一次之后，以后所有新建项目都能应用改配置，不用再一一进行配置操作，使用起来也非常方便。点击工具栏中的：View—&gt;Other Windows—&gt;Property Manger打开属性管理器：</li><li>在新出现的属性管理器栏中，展开目录，选中<span style="color:#ff6600;">Debug|Win64</span>中的Microsoft.Cpp.x64.user，并右键点击属性（Properties）进入属性界面： </li></ol> 
<p> <img alt="" class="has" src="https://images2.imgbox.com/9c/3f/zGrBYl27_o.png"></p> 
<p>1）配置包含目录：</p> 
<p>        在通用属性（Common Properties）—&gt;VC ++目录—&gt;包含目录，然后点击右侧三角标志选中Edit进入编辑：</p> 
<p>        向其中添加下面三个路径（你自己的OpenCv安装的位置）：</p> 
<p>        E:\OpenCV\opencv\build\include</p> 
<p>        E:\OpenCV\opencv\build\include\opencv</p> 
<p>        E:\OpenCV\opencv\build\include\opencv2</p> 
<p>  <img alt="" class="has" src="https://images2.imgbox.com/19/80/1BpLPz6G_o.png"></p> 
<p>2）配置库文件目录：</p> 
<p>        完成上面的包含目录配置之后，我们还需要进行库文件的配置：回到属性界面，选择包含目录下面的Library Directories（库文件目录）：</p> 
<p>        向库文件目录下添加OpenCV的库文件目录：E:\OpenCV\opencv\build\x64\vc14\lib，这个目录根据每个人自己在第一步安装OpenCV中选择的目录进行选定：</p> 
<p>3）配置动态链接库：</p> 
<p>        我们可以查看步骤2）中添加的库文件目录下面.lib文件列表，发现在3.1.0版本的OpenCV中，仅剩下两个库文件，分别是：<span style="color:#ff6600;">opencv_world310.lib</span>和<span style="color:#ff6600;">opencv_world310d.lib</span>，这里两个库文件的区别就是：<span style="color:#ff6600;">opencv_world310.lib</span>是Release模式版本，而<span style="color:#ff6600;">opencv_world310d.lib</span>是Debug模式版本：</p> 
<p>        跟上述两个步骤相似，在属性界面中打开Linker(链接库)—&gt;Input(输入)—&gt;Additional Dependencies(添加依赖)：</p> 
<p>        将我们刚刚在OpenCV库文件目录下看到的两个库文件其中一个添加到这里（根据模式需求Release模式或Debug模式）：</p> 
<p> </p> 
<p>上面部分为新建工程时VS的Opencv的配置，配置好了之后可以引入头文件，使用OpenCv了。</p> 
<p><br>  </p> 
<p><strong>OpenCv图像处理：</strong></p> 
<p><strong>（1）</strong>.首先讲解OpenCv改变图像大小，这里以调用摄像头举例。</p> 
<pre class="has"><code class="language-cpp">#include&lt;opencv2\core\core.hpp&gt;
#include&lt;opencv2\highgui\highgui.hpp&gt;
#include&lt;opencv2\opencv.hpp&gt;

using namespace cv;

int main()
{
	// 从摄像头读入视频
	VideoCapture capture(0);
	while (1)
	{
		Mat frame;								//定义一个Mat变量，用于存储每一帧的图像
		capture &gt;&gt; frame;						//读取当前帧    
		resize(frame, frame, Size(360, 240));	//改变图像大小
		imshow("aa", frame);
		waitKey(30);							//延时30ms
	}
	return 0;
}</code></pre> 
<p><em>using namespace cv;</em>引入OpenCv的命名空间。</p> 
<p><em>VideoCapture</em>是一个摄像头类，可以读取摄像头或者本地的视频文件。</p> 
<p><em>Mat</em>是OpenCv的矩阵类，一般用来存储图像。</p> 
<p><em>resize</em>函数可以改变图像大小。</p> 
<p> </p> 
<p><strong>（2）</strong>.然后讲解OpenCv改变图像编码格式</p> 
<pre class="has"><code class="language-cpp">#include&lt;opencv2\core\core.hpp&gt;
#include&lt;opencv2\highgui\highgui.hpp&gt;
#include&lt;opencv2\opencv.hpp&gt;

using namespace cv;

int main()
{
	// 从摄像头读入视频
	VideoCapture capture(0);
	while (1)
	{
		Mat frame;									//定义一个Mat变量，用于存储每一帧的图像
		capture &gt;&gt; frame;							//读取当前帧    

		cvtColor(frame, frame, CV_BGR2GRAY);		//转为灰度图
		imshow("aa", frame);
		waitKey(30); //延时30ms
	}
	return 0;
}</code></pre> 
<p>首先需要注意的是OpenCv的图片是按<strong>BGR顺序</strong>存储的。</p> 
<p>早期的OpenCV开发者选择BGR颜色格式的原因在于主流的摄像头制造商和软件供应商都普遍使用这种格式，比如说Windows在用COLORREF描述颜色值的时候用的就是BGR格式： 0x00bbggrr</p> 
<p><em>cvtColor</em>改变编码格式，常用的是<em>COLOR_BGR2GRAY（CV_BGR2GRAY）</em></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/5f/32/oAR81awn_o.png"></p> 
<p>还有接近人的直观感觉的<em>COLOR_BGR2HSV（CV_BGR2HSV）</em>，颜色信息（H）、饱和度（S）、亮度（V）。</p> 
<p><span style="color:#444444;">转化后颜色改变，因为imshow命令里面接受的参数是BGR空间的矩阵，把HSV空间的矩阵给imshow，会把它解释为BGR空间的矩阵，显示出的效果就不是源图像了.</span></p> 
<p><span style="color:#444444;"><img alt="" class="has" src="https://images2.imgbox.com/31/aa/NiCyS5GT_o.png"></span></p> 
<p><span style="color:#444444;">HSV范围（根据实际情况改）</span></p> 
<p><span style="color:#444444;">这里给出一个获取HSV的代码。</span></p> 
<pre class="has"><code class="language-cpp">#include &lt;opencv2\opencv.hpp&gt;  
#include "iostream"  

using namespace std;
using namespace cv;

void on_mouse(int EVENT, int x, int y, int flags, void* userdata);

int main(int argc, char** argv)
{
	Mat src, hsv;
	//此处更改图片地址  
	src = imread("C:\\Users\\ttp\\Pictures\\2.png");
	namedWindow("display");
	setMouseCallback("display", on_mouse, &amp;src);
	while (1)
	{
		imshow("display", src);
		waitKey(40);
	}
}

void on_mouse(int EVENT, int x, int y, int flags, void* userdata)
{
	Mat rgb, hsv;
	rgb = *(Mat*)userdata;
	Mat temp;
	cvtColor(*(Mat*)userdata, hsv, CV_BGR2HSV);
	Point p(x, y);
	switch (EVENT)
	{
		case EVENT_LBUTTONDOWN:
		{
			printf("b=%d\t", rgb.at&lt;Vec3b&gt;(p)[0]);
			printf("g=%d\t", rgb.at&lt;Vec3b&gt;(p)[1]);
			printf("r=%d\n", rgb.at&lt;Vec3b&gt;(p)[2]);

			printf("H=%d\t", hsv.at&lt;Vec3b&gt;(p)[0]);
			printf("S=%d\t", hsv.at&lt;Vec3b&gt;(p)[1]);
			printf("V=%d\n", hsv.at&lt;Vec3b&gt;(p)[2]);
			circle(rgb, p, 2, Scalar(255), 3);
		}
		break;
	}
}</code></pre> 
<p><em>setMouseCallback</em>会捕获指定窗口的鼠标消息。</p> 
<p> </p> 
<p><span style="color:#444444;"><strong>（3）.</strong>然后再讲解OpenCv图像的颜色识别</span></p> 
<pre class="has"><code class="language-cpp">#include &lt;opencv2\core\core.hpp&gt;
#include &lt;opencv2\highgui\highgui.hpp&gt;
#include &lt;opencv2\opencv.hpp&gt;

using namespace cv;

int alpha_slider1, alpha_slider2;
void on_trackbar(int, void*) {}

int main()
{
	VideoCapture capture(0);	// 从摄像头读入视频
	namedWindow("[总]");
	createTrackbar("Hmin", "[总]", &amp;alpha_slider1, 180, on_trackbar);
	createTrackbar("Hmax", "[总]", &amp;alpha_slider2, 180, on_trackbar);
	Mat frame; // 定义一个Mat变量，用于存储每一帧的图像
	Mat HSV;
	Mat mask; // 保存inRange后的值
	while (1)
	{
		capture &gt;&gt; frame;  // 读取当前帧    
		cvtColor(frame, HSV, COLOR_BGR2HSV);	// 转化为HSV					
		inRange(HSV, Scalar(alpha_slider1, 43, 46), Scalar(alpha_slider2, 255, 255), mask);
		imshow("保存", mask);
		imshow("[总]", frame);
		waitKey(30); // 延时30ms
	}
	return 0;
}</code></pre> 
<p><span style="color:#444444;"><span style="color:#333333;">这个程序会创建一个滑动条来改变H的值，从而识别颜色</span></span></p> 
<p><em>createTrackbar会在指定窗口创建滑动条。</em></p> 
<p><span style="color:#444444;"><span style="color:#333333;">函数原型（C++）：</span></span></p> 
<p><em><span style="color:#444444;"><span style="color:#333333;">void inRange(InputArray src, InputArray lowerb, InputArray upperb, OutputArray dst)</span></span></em></p> 
<p><em><span style="color:#444444;"><span style="color:#333333;">dst(I) = lowerb(I)0 ≤ src(I)0 &lt; upperb(I)0 ∧ lowerb(I)1 ≤ src(I)1 &lt; upperb(I)1 ∧lowerb(I)2 ≤ src(I)2 &lt; upperb(I)2</span></span></em></p> 
<p><span style="color:#444444;"><span style="color:#333333;">即，每个通道的像素值都必须在规定的阈值范围内！</span></span></p> 
<p><span style="color:#444444;"><span style="color:#333333;">这篇文章先讲到这。</span></span></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b86be886b85c6f284399beea8938d7c6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">fl2440开发板移植tslib-1.4</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7b02cbcac03a71427df3fe74fe304cc9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">HDU 6284 Longest Increasing Subsequence(LIS&#43;思维)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>