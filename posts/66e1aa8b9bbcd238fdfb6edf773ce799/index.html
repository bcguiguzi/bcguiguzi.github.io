<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>人群归因分数（Population Attributable Fraction, PAF）：概念、简单计算案例 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="人群归因分数（Population Attributable Fraction, PAF）：概念、简单计算案例" />
<meta property="og:description" content="专注系列化、高质量的R语言教程
推文索引 | 联系小编 | 付费合集
本篇目录如下：
1 人群归因分数
1.1 相对风险度
1.2 人群归因分数
2 案例
2.1 示例数据
2.2 计算案例1
2.3 计算案例2
2.4 计算案例3
3 总结
1 人群归因分数 人群归因分数（Population Attributable Fraction, PAF）是疾病负担研究中常用的指标，其大致含义是，假设人群的风险暴露降低至理想水平，预计可减少的患病人口数占实际患病人口数的比例。
The population attributable fraction (PAF), which represents the proportion of risk that would be reduced in a given year if the exposure to a risk factor in the past were reduced to an ideal exposure scenario.[1]
风险因素的理想暴露水平有多种定义方式，常用的是理论最小风险水平（Theoretical Minimum Risk Level，TMREL），指理论上能使疾病负担水平达到最低的暴露水平。如世卫组织推荐的不会造成健康风险的污染物临界指标[2]：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/66e1aa8b9bbcd238fdfb6edf773ce799/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-11T08:02:22+08:00" />
<meta property="article:modified_time" content="2023-05-11T08:02:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">人群归因分数（Population Attributable Fraction, PAF）：概念、简单计算案例</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <hr> 
 <p style="text-align:center;"><strong>专注</strong><strong>系列化</strong><strong>、</strong><strong>高质量</strong><strong>的R语言教程</strong></p> 
 <p style="text-align:center;"><a href="" rel="nofollow">推文索引</a> | <a href="" rel="nofollow">联系小编</a> | <a href="" rel="nofollow">付费合集</a></p> 
 <hr> 
 <p>本篇目录如下：</p> 
 <ul><li><p>1 人群归因分数</p> 
   <ul><li><p>1.1 相对风险度</p></li><li><p>1.2 人群归因分数</p></li></ul></li><li><p>2 案例</p> 
   <ul><li><p>2.1 示例数据</p></li><li><p>2.2 计算案例1</p></li><li><p>2.3 计算案例2</p></li><li><p>2.4 计算案例3</p></li></ul></li><li><p>3 总结</p></li></ul> 
 <h3>1 人群归因分数</h3> 
 <p>人群归因分数（Population Attributable Fraction, PAF）是疾病负担研究中常用的指标，其大致含义是，假设人群的风险暴露降低至理想水平，预计可减少的患病人口数占实际患病人口数的比例。</p> 
 <blockquote> 
   
  <p>The population attributable fraction (PAF), which represents the proportion of risk that would be reduced in a given year if the exposure to a risk factor in the past were reduced to an ideal exposure scenario.<sup>[1]</sup></p> 
   
 </blockquote> 
 <p>风险因素的理想暴露水平有多种定义方式，常用的是<strong>理论最小风险水平</strong>（Theoretical Minimum Risk Level，TMREL），指理论上能使疾病负担水平达到最低的暴露水平。如世卫组织推荐的不会造成健康风险的污染物临界指标<sup>[2]</sup>：</p> 
 <img src="https://images2.imgbox.com/59/12/MbjxI2CH_o.png" alt="3a90070a8d6adc3ee41e8d25a5e154c6.png"> 
 <h4>1.1 相对风险度</h4> 
 <p>假设理想暴露水平时的患病人口比例为，暴露水平为时的患病人口比例为，则该暴露水平的<strong>相对风险度</strong>（Relative Risk，RR）为：</p> 
  
 <h4>1.2 人群归因分数</h4> 
 <p>如果暴露水平是分类变量，，暴露在各水平的人群比例使用表示，则<strong>人群归因分数</strong>（PAF）可表示为：</p> 
  
 <p>是指理想暴露水平的相对风险度，一般说来它应该是1。不过相对风险度并不一定需要使用本队列的数据进行计算，也可以直接使用或汇总已有的研究成果，这时不一定为1。</p> 
 <p>如果暴露水平是连续变量：</p> 
  
 <h3>2 案例</h3> 
 <p>本节通过几个例子展示PAF的具体计算过程。</p> 
 <h4>2.1 示例数据</h4> 
 <p>示例数据使用<code>causalPAF</code>工具包的数据集<code>strokedata</code>。该数据集包括16623个观察样本，本案例涉及到的变量有：</p> 
 <ul><li><p>case：二分变量，数值型；0表示未患病，1表示患病；</p></li><li><p>phys：二分变量；因子类型；1表示缺乏锻炼，2表示积极锻炼。</p></li></ul> 
 <p>根据后文需要，将<code>phys</code>转换为0/1变量。需要注意的是，<code>phys</code>的类别顺序为“2、1”，因此转换后0表示积极锻炼、1表示缺乏锻炼。</p> 
 <pre class="has"><code class="language-go">library(causalPAF)
data = strokedata  
levels(data$phys)
## [1] "2" "1"

data$phys &lt;- as.numeric(data$phys) - 1
unique(data$phys)
## [1] 1 0</code></pre> 
 <h4>2.2 计算案例1</h4> 
 <p>以<code>phys</code>为分组变量，展示样本的分布情况：</p> 
 <pre class="has"><code class="language-go">library(tidyverse) 
table &lt;- data %&gt;%
  group_by(phys) %&gt;%
  summarise(pop = length(case),
            pop_prop = pop/16623,
            case_num = sum(case),
            case_prop = mean(case))

table
##    phys   pop pop_prop case_num case_prop
##   &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1     0  2297    0.138     1043     0.454
## 2     1 14326    0.862     7192     0.502</code></pre> 
 <blockquote> 
   
  <ul><li><p>pop：样本数；</p></li><li><p>pop_prop：样本占总样本比例；</p></li><li><p>case_num：患病样本数；</p></li><li><p>case_prop：患病率，即<code>case_num/pop</code>。</p></li></ul> 
   
 </blockquote> 
 <p>显然，可以将<code>phys = 0</code>定义为理想暴露水平，计算<code>phys = 0,1</code>时的相对风险度：</p> 
 <pre class="has"><code class="language-go">rr0 = 1
(rr1 = table$case_prop[2]/table$case_prop[1]) 
## [1] 1.105609</code></pre> 
 <p><code>phys = 0,1</code>时的人口暴露比例即<code>pop_prop</code>：</p> 
 <pre class="has"><code class="language-go">p0 = table$pop_prop[1]
p1 = table$pop_prop[2]</code></pre> 
 <p>套用上节的计算公式，计算PAF：</p> 
 <pre class="has"><code class="language-go">1 - rr0/(rr0*p0 + rr1*p1)
## [1] 0.08342266</code></pre> 
 <p>因此，由缺乏锻炼（<code>phys = 1</code>）导致的患病人群归因分数为8.34%。</p> 
 <h4>2.3 计算案例2</h4> 
 <p>上节是使用公式计算PAF，也可以直接使用PAF的定义来计算，即若所有样本的<code>phys</code>都取0（理想暴露水平），预计可减少的患病人口数占实际患病人口数的比例。</p> 
 <p>可减少的患病人口数<code>reduce</code>即<code>phys = 1</code>的样本数乘以两个暴露水平的患病率之差：</p> 
 <pre class="has"><code class="language-go">(reduce &lt;- table$pop[2]*(table$case_prop[2] - table$case_prop[1])) 
## [1] 686.9856</code></pre> 
 <p>实际患病人口数<code>total_case</code>：</p> 
 <pre class="has"><code class="language-go">(total_case = sum(data$case))
## [1] 8235</code></pre> 
 <p><code>reduce</code>与<code>total_case</code>之比即PAF：</p> 
 <pre class="has"><code class="language-go">reduce/total_case
## [1] 0.08342266</code></pre> 
 <p>与2.2节计算结果一致。</p> 
 <h4>2.4 计算案例3</h4> 
 <p>在该类研究中，响应变量通常都是0/1二分变量，因此一般可使用Logistic回归进行建模。</p> 
 <p>以<code>case</code>为响应变量，<code>phys</code>为解释变量（风险因子），建立Logistic模型：</p> 
 <pre class="has"><code class="language-go">fit &lt;- glm(case ~ phys, data = data,
           family = binomial())
summary(fit)
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.18424    0.04191  -4.396 1.10e-05 ***
## phys         0.19233    0.04512   4.263 2.02e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre> 
 <p>使用回归结果估计在理想暴露水平<code>phys = 0</code>时的患病率：</p> 
 <pre class="has"><code class="language-go">newdata &lt;- data.frame(phys = 0)
(p0 &lt;- predict(fit, newdata = newdata, type = "response"))
## 0.4540705</code></pre> 
 <p>使用PAF定义的计算公式：</p> 
  
 <p>就是实际人群患病比例，因此上式可简化为：</p> 
  
 <pre class="has"><code class="language-go">(p = mean(data$case))
## [1] 0.4953979

1 - p0/p
## 0.08342266</code></pre> 
 <p><code>AF</code>工具包的<code>AFglm()</code>函数以广义回归模型为输入对象计算PAF：</p> 
 <pre class="has"><code class="language-go">library(AF)
AFglm(fit, exposure = "phys", data = data)
## Estimated attributable fraction (AF) and standard error : 
## 
##          AF  Std.Error
##  0.08342266 0.01948951</code></pre> 
 <h3>3 总结</h3> 
 <p>本篇推文简要介绍了PAF、RR的概念及其计算公式，使用的案例只涉及一个风险变量，后续推文会介绍有控制变量、多风险变量及中介变量（mediator）的情况。</p> 
 <h4>参考资料</h4> 
 <p>[1]</p> 
 <p>GBD:2017 补充材料1，p33: <em>https://doi.org/10.1016/S0140-6736(18)32225-6</em></p> 
 [2] 
 <p>环境（室外）空气质量和健康: <em>https://www.who.int/zh/news-room/fact-sheets/detail/ambient-(outdoor)-air-quality-and-health</em></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/936afe03927a91f9837e285d62d81446/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">安全测试 —— 越权漏洞</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1c0f64f87566e0c3356eed220e2e6a70/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【毕业设计】基于JAVA的springboot篮球竞赛预约平台(源代码&#43;论文）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>