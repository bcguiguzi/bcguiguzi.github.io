<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>支持向量机（二）重要参数kernel&#43;探索核函数在不同数据集上的表现&#43;乳腺癌数据集上验证各种核函数的效果&#43;硬间隔和软间隔以及重要的参数C - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="支持向量机（二）重要参数kernel&#43;探索核函数在不同数据集上的表现&#43;乳腺癌数据集上验证各种核函数的效果&#43;硬间隔和软间隔以及重要的参数C" />
<meta property="og:description" content="文章目录 1 重要参数kernel2 探索核函数在不同数据集上的表现3 乳腺癌数据集上验证各种kernel效果4 硬间隔与软间隔：重要参数C 1 重要参数kernel 之前画图时使用的是选项“linear&#34;，自然不能处理环形数据这样非线性的状况。而刚才我们使用的计算r的方法，其实是高斯径向基核函数所对应的功能，在参数”kernel“中输入”rbf“就可以使用这种核函数。
from sklearn.svm import SVC import matplotlib.pyplot as plt import numpy as np from sklearn.datasets import make_circles from mpl_toolkits import mplot3d x, y = make_circles(100, factor=0.1, noise=0.1) clf_1 = SVC(kernel=&#34;rbf&#34;).fit(x,y) plt.scatter(x[:, 0], x[:, 1], c=y, s=50, cmap=&#34;rainbow&#34;) plot_scv_decision_function(clf_1) plt.show() 2 探索核函数在不同数据集上的表现 import numpy as np import matplotlib.pyplot as plt from matplotlib.colors import ListedColormap from sklearn.svm import SVC from sklearn.datasets import make_circles, make_moons, make_blobs, make_classification n_samples = 100 datasets = [make_moons(n_samples=n_samples, noise=0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/9237c53e2d968657046eaf20f165c022/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-04T21:26:28+08:00" />
<meta property="article:modified_time" content="2021-11-04T21:26:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">支持向量机（二）重要参数kernel&#43;探索核函数在不同数据集上的表现&#43;乳腺癌数据集上验证各种核函数的效果&#43;硬间隔和软间隔以及重要的参数C</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1_kernel_2" rel="nofollow">1 重要参数kernel</a></li><li><a href="#2__24" rel="nofollow">2 探索核函数在不同数据集上的表现</a></li><li><a href="#3_kernel_133" rel="nofollow">3 乳腺癌数据集上验证各种kernel效果</a></li><li><a href="#4_C_302" rel="nofollow">4 硬间隔与软间隔：重要参数C</a></li></ul> 
</div> 
<p></p> 
<h2><a id="1_kernel_2"></a>1 重要参数kernel</h2> 
<p><img src="https://images2.imgbox.com/61/84/GWbnmx4h_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6b/1b/ayaRWNZp_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/49/80/kb7Zalbj_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/42/2b/FLEXHvpK_o.png" alt="在这里插入图片描述"><br> 之前画图时使用的是选项“linear"，自然不能处理环形数据这样非线性的状况。而刚才我们使用的计算r的方法，其实是高斯径向基核函数所对应的功能，在参数”kernel“中输入”rbf“就可以使用这种核函数。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_circles
<span class="token keyword">from</span> mpl_toolkits <span class="token keyword">import</span> mplot3d
x<span class="token punctuation">,</span> y <span class="token operator">=</span> make_circles<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> factor<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> noise<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>

clf_1 <span class="token operator">=</span> SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">"rbf"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">"rainbow"</span><span class="token punctuation">)</span>
plot_scv_decision_function<span class="token punctuation">(</span>clf_1<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/85/b2/jkrfOTz1_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="2__24"></a>2 探索核函数在不同数据集上的表现</h2> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>colors <span class="token keyword">import</span> ListedColormap
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_circles<span class="token punctuation">,</span> make_moons<span class="token punctuation">,</span> make_blobs<span class="token punctuation">,</span> make_classification

n_samples <span class="token operator">=</span> <span class="token number">100</span>

datasets <span class="token operator">=</span> <span class="token punctuation">[</span>make_moons<span class="token punctuation">(</span>n_samples<span class="token operator">=</span>n_samples<span class="token punctuation">,</span> noise<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            make_circles<span class="token punctuation">(</span>n_samples<span class="token operator">=</span>n_samples<span class="token punctuation">,</span> noise<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> factor<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            make_blobs<span class="token punctuation">(</span>n_samples<span class="token operator">=</span>n_samples<span class="token punctuation">,</span> centers<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            make_classification<span class="token punctuation">(</span>n_samples<span class="token operator">=</span>n_samples<span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> n_informative<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> n_redundant<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

kenerls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"linear"</span><span class="token punctuation">,</span> <span class="token string">"poly"</span><span class="token punctuation">,</span> <span class="token string">"rbf"</span><span class="token punctuation">,</span> <span class="token string">"sigmoid"</span><span class="token punctuation">]</span>

<span class="token comment">#四个数据集分别是什么样的嘞？</span>
<span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> datasets<span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">"rainbow"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>月亮型</strong><br> <img src="https://images2.imgbox.com/fe/c1/aufQd4nB_o.png" alt="在这里插入图片描述"><br> <strong>环形</strong><br> <img src="https://images2.imgbox.com/32/e3/VD7QLtfL_o.png" alt="在这里插入图片描述"><br> <strong>两簇交织在一起</strong><br> <img src="https://images2.imgbox.com/98/e5/pYNiTNIG_o.png" alt="在这里插入图片描述"><br> <strong>一半一半型</strong><br> <img src="https://images2.imgbox.com/a4/88/pWnHvER0_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment">#构建子图的行和列</span>
nrows <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>datasets<span class="token punctuation">)</span>
ncols <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>kenerls<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>

<span class="token comment">#print([*enumerate(datasets)])</span>
<span class="token comment">#[(索引值，array(x), array(y))]的形式诶</span>
<span class="token comment">#print([*enumerate(kenerls)])</span>


fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>nrows<span class="token punctuation">,</span> ncols<span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> ds_cnt<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>datasets<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    if ds_cnt == 0:
        print(ds_cnt, x[0], y[0])
    '''</span>
    ax <span class="token operator">=</span> axes<span class="token punctuation">[</span>ds_cnt<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> ds_cnt <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Input data"</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">,</span> zorder<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Paired<span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment">#第二层循环：在不同的核函数中循环</span>
    <span class="token comment">#从图像的第二列开始，一个个填充分类结果：</span>
    <span class="token keyword">for</span> est_idx<span class="token punctuation">,</span> kernel <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>kenerls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#定义子图的位置</span>
        ax <span class="token operator">=</span> axes<span class="token punctuation">[</span>ds_cnt<span class="token punctuation">,</span> est_idx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span>

        <span class="token comment">#建模</span>
        clf <span class="token operator">=</span> SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span>kernel<span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        socre <span class="token operator">=</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>

        <span class="token comment">#绘制图像本身分布的散点图</span>
        ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">,</span> zorder<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Paired<span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">)</span>
        <span class="token comment">#绘制支持向量</span>
        ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>clf<span class="token punctuation">.</span>support_vectors_<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> clf<span class="token punctuation">.</span>support_vectors_<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>
                    facecolors<span class="token operator">=</span><span class="token string">'none'</span><span class="token punctuation">,</span> zorder<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">)</span>
        <span class="token comment">#绘制决策边界</span>
        x_min<span class="token punctuation">,</span> x_max <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span>
        y_min<span class="token punctuation">,</span> y_max <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span>

        <span class="token comment"># 表示为[起始值：结束值：步长]</span>
        <span class="token comment"># 如果步长是复数，则其整数部分就是起始值和结束值之间创建的点的数量，并且结束值被包含在内</span>
        xx<span class="token punctuation">,</span> yy <span class="token operator">=</span> np<span class="token punctuation">.</span>mgrid<span class="token punctuation">[</span>x_min<span class="token punctuation">:</span> x_max<span class="token punctuation">:</span> <span class="token number">200j</span><span class="token punctuation">,</span> y_min<span class="token punctuation">:</span> y_max<span class="token punctuation">:</span> <span class="token number">200j</span><span class="token punctuation">]</span>

        <span class="token comment">##np.c_，类似于np.vstack的功能</span>
        xxyy <span class="token operator">=</span> np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>xx<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        z <span class="token operator">=</span> clf<span class="token punctuation">.</span>decision_function<span class="token punctuation">(</span>xxyy<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>xx<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

        <span class="token comment">#填充等高线不同区域的颜色</span>
        ax<span class="token punctuation">.</span>pcolormesh<span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> z<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Paired<span class="token punctuation">)</span>
        <span class="token comment">#绘制等高线</span>
        ax<span class="token punctuation">.</span>contour<span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> z<span class="token punctuation">,</span> colors<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'--'</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">,</span> <span class="token string">'--'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> levels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token comment">#设定坐标轴不显示</span>
        ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment">#将标题放在第一行的顶上</span>
        <span class="token keyword">if</span> ds_cnt <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">:</span>
            ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>kernel<span class="token punctuation">)</span>

        <span class="token comment">#为每张图添加分类的分数</span>
        ax<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">0.95</span><span class="token punctuation">,</span> <span class="token number">0.06</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"%.2f"</span> <span class="token operator">%</span> socre<span class="token punctuation">)</span><span class="token punctuation">.</span>lstrip<span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                size<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> bbox<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>boxstyle<span class="token operator">=</span><span class="token string">'round'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'white'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">#为分数添加一个白色的格子作为底色</span>
                transform<span class="token operator">=</span>ax<span class="token punctuation">.</span>transAxes<span class="token punctuation">,</span> <span class="token comment">#确定文字所对应的坐标轴，就是ax子图的坐标轴</span>
                horizontalalignment<span class="token operator">=</span><span class="token string">'right'</span> <span class="token comment">#位于坐标轴的什么方向</span>
                <span class="token punctuation">)</span> <span class="token comment">#横坐标的位置，纵坐标的位置，分数不显示0</span>

plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>根据下图可以看出，除了sigmoid的kernel以外，其他的kernel基本上都有擅长的数据类型，尤其是rbf，在各类数据集上都表现优良。<br> <img src="https://images2.imgbox.com/8c/34/qjSQiStr_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3_kernel_133"></a>3 乳腺癌数据集上验证各种kernel效果</h2> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_breast_cancer
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> time <span class="token keyword">import</span> time
<span class="token keyword">import</span> datetime

data <span class="token operator">=</span> load_breast_cancer<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#print(data.data)</span>
<span class="token comment">#print(data.target)</span>

x <span class="token operator">=</span> data<span class="token punctuation">.</span>data
y <span class="token operator">=</span> data<span class="token punctuation">.</span>target
<span class="token comment">#print(x.shape)  #(569, 30)</span>
<span class="token comment">#print(y.shape)  #(569,)</span>

<span class="token comment">#print(np.unique(y))</span>
<span class="token comment">#[0 1] 查看y的标签类型，只有两个</span>


plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>看看其中两种特征的可视化结果<br> <img src="https://images2.imgbox.com/bb/92/TTbdj2VG_o.png" alt="在这里插入图片描述"><br> 降维到二维空间再看一下</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>decomposition <span class="token keyword">import</span> PCA
x_dr <span class="token operator">=</span> PCA<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment">#print(x_dr)</span>

plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_dr<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x_dr<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e2/84/oi3rfCdl_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

kernel <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"linear"</span><span class="token punctuation">,</span> <span class="token string">"poly"</span><span class="token punctuation">,</span> <span class="token string">"rbf"</span><span class="token punctuation">,</span> <span class="token string">"sigmoid"</span><span class="token punctuation">]</span>


<span class="token keyword">for</span> kernel <span class="token keyword">in</span> kernel<span class="token punctuation">:</span>
    time0 <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    clf <span class="token operator">=</span> SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span>kernel<span class="token punctuation">,</span>
              gamma<span class="token operator">=</span><span class="token string">"auto"</span><span class="token punctuation">,</span>
              cache_size<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The accuracy under kernel %s is %f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>kernel<span class="token punctuation">,</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>time0<span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%M:%S:%f"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

The accuracy under kernel linear <span class="token keyword">is</span> <span class="token number">0.959064</span>
<span class="token number">00</span><span class="token punctuation">:</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token number">247745</span>
</code></pre> 
<p>这种情况下，只输出了linear的结果，卡在了poly上，因为poly多项式默认d（幂次方）为3，我们可以认为是次方太高，计算量过大所以算不出来<br> <img src="https://images2.imgbox.com/cf/6c/lWhvNgo9_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/05/b4/WpNKF7wW_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">for</span> kernel <span class="token keyword">in</span> kernel<span class="token punctuation">:</span>
    time0 <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    clf <span class="token operator">=</span> SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span>kernel<span class="token punctuation">,</span>
              gamma<span class="token operator">=</span><span class="token string">"auto"</span><span class="token punctuation">,</span>
              degree<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
              cache_size<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The accuracy under kernel %s is %f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>kernel<span class="token punctuation">,</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> time0<span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%M:%S:%f"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


The accuracy under kernel linear <span class="token keyword">is</span> <span class="token number">0.959064</span>
<span class="token number">00</span><span class="token punctuation">:</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token number">165836</span>
The accuracy under kernel poly <span class="token keyword">is</span> <span class="token number">0.935673</span>
<span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">059846</span>
The accuracy under kernel rbf <span class="token keyword">is</span> <span class="token number">0.631579</span>
<span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">059675</span>
The accuracy under kernel sigmoid <span class="token keyword">is</span> <span class="token number">0.631579</span>
<span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">006134</span>
</code></pre> 
<p>rbf 的效果不如linear，真的不应该呀，所以看看数据集本身是什么样子的</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
feature_describe <span class="token operator">=</span> data<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.99</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
<span class="token comment">#print(feature_describe)</span>
<span class="token comment">#最好有jupyter notebook来看值，所有的值都能看得到</span>
<span class="token comment">#可以发现数据存在严重的量纲不一致的情况，我们使用数据预处理中的标准化类，对数据进行归一化处理</span>

<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler
newx <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
new_describe <span class="token operator">=</span> data<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.99</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
<span class="token comment">#print(new_describe)</span>
</code></pre> 
<p>由于pycharm显示不了全部，所以就不贴图了！肉眼可见我们的数据有不同的量纲，且有一些特征有偏态问题，所以进行了归一化处理。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler
newx <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
new_describe <span class="token operator">=</span> data<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.99</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
<span class="token comment">#print(new_describe)</span>
<span class="token comment">#仍然有一些特征存在偏态的问题</span>

newx_train<span class="token punctuation">,</span> newx_test<span class="token punctuation">,</span> newy_train<span class="token punctuation">,</span> newy_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>newx<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> kernel <span class="token keyword">in</span> kernel<span class="token punctuation">:</span>
    time0 <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    clf <span class="token operator">=</span> SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span>kernel<span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token string">"auto"</span><span class="token punctuation">,</span> degree<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> cache_size<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>newx_train<span class="token punctuation">,</span> newy_train<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The accuracy under kernel %s is %f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>kernel<span class="token punctuation">,</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>newx_test<span class="token punctuation">,</span> newy_test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> time0<span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%M:%S:%f"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

The accuracy under kernel linear <span class="token keyword">is</span> <span class="token number">0.959064</span>
<span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">010021</span>
The accuracy under kernel poly <span class="token keyword">is</span> <span class="token number">0.970760</span>
<span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">006397</span>
The accuracy under kernel rbf <span class="token keyword">is</span> <span class="token number">0.976608</span>
<span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">010460</span>
The accuracy under kernel sigmoid <span class="token keyword">is</span> <span class="token number">0.941520</span>
<span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">003067</span>
</code></pre> 
<p>对rbf进行调参</p> 
<pre><code class="prism language-python">score <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
gamma_range <span class="token operator">=</span> np<span class="token punctuation">.</span>logspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment">#返回对数刻度上</span>
<span class="token comment">#print(gamma_range)</span>


<span class="token keyword">for</span> i <span class="token keyword">in</span> gamma_range<span class="token punctuation">:</span>
    clf <span class="token operator">=</span> SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">"rbf"</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span>i<span class="token punctuation">,</span> cache_size<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>newx_train<span class="token punctuation">,</span> newy_train<span class="token punctuation">)</span>
    score<span class="token punctuation">.</span>append<span class="token punctuation">(</span>clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>newx_test<span class="token punctuation">,</span> newy_test<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span> gamma_range<span class="token punctuation">[</span>score<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>gamma_range<span class="token punctuation">,</span> score<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#0.9824561403508771 0.05689866029018305</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/dd/40/gnl1xH0y_o.png" alt="在这里插入图片描述"><br> 对poly调参，通过网格搜索，寻找最好的gamma和r的值cofe表示r的值</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> StratifiedShuffleSplit
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> GridSearchCV

time0 <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>

gamma_range <span class="token operator">=</span> np<span class="token punctuation">.</span>logspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
coef0_range <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>

param_grid <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>gamma<span class="token operator">=</span>gamma_range<span class="token punctuation">,</span>
                  coef0<span class="token operator">=</span>coef0_range<span class="token punctuation">)</span>

cv <span class="token operator">=</span> StratifiedShuffleSplit<span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
grid <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span>SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">"poly"</span><span class="token punctuation">,</span> degree<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> cache_size<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    param_grid<span class="token operator">=</span>param_grid<span class="token punctuation">,</span> cv<span class="token operator">=</span>cv<span class="token punctuation">)</span>
grid<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>newx<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The best parameters are %s with a score of %0.5f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>grid<span class="token punctuation">.</span>best_params_<span class="token punctuation">,</span>
grid<span class="token punctuation">.</span>best_score_<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>time0<span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%M:%S:%f"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

The best parameters are <span class="token punctuation">{<!-- --></span><span class="token string">'coef0'</span><span class="token punctuation">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token string">'gamma'</span><span class="token punctuation">:</span> <span class="token number">0.04832930238571752</span><span class="token punctuation">}</span> <span class="token keyword">with</span> a score of <span class="token number">0.96608</span>
<span class="token number">00</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token number">612675</span>
</code></pre> 
<p>但是调参的效果还不如不调</p> 
<h2><a id="4_C_302"></a>4 硬间隔与软间隔：重要参数C</h2> 
<p><img src="https://images2.imgbox.com/be/51/FHKwFGiB_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/d3/f1/qWap1BEU_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/57/ca/OjeiPw5o_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/76/be/6wwGv7x6_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/af/98/4NH0PcEz_o.png" alt="在这里插入图片描述"><br> 重要参数C<br> <img src="https://images2.imgbox.com/56/b0/XVsjnquN_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">
score <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
c_range <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> c_range<span class="token punctuation">:</span>
    clf <span class="token operator">=</span> SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">"rbf"</span><span class="token punctuation">,</span> C<span class="token operator">=</span>i<span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">0.05689866029018305</span><span class="token punctuation">,</span> cache_size<span class="token operator">=</span><span class="token number">5000</span> <span class="token comment">#计算内存大小).fit(newx_train, newy_train)</span>
    score<span class="token punctuation">.</span>append<span class="token punctuation">(</span>clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>newx_test<span class="token punctuation">,</span> newy_test<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span> c_range<span class="token punctuation">[</span>score<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#0.9883040935672515 2.4581632653061223</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>c_range<span class="token punctuation">,</span> score<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#0.9883040935672515 2.4581632653061223</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/41/0b/xCCfaBSK_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a7d1f2febba6088201a52fe3fdf99e42/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android 重力感应和手动横竖屏切换</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4f47d9fe3192ef3b15ca5101bb06b1fd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">粗暴解决 ‘Flutter/Flutter.h‘ file not found</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>