<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>BottomSheetDialog&#43;Recyclerview一次记录 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="BottomSheetDialog&#43;Recyclerview一次记录" />
<meta property="og:description" content="记一次Recyclerview&#43;BottomSheetDialog的简单使用
列子里用到的依赖
implementation &#39;com.android.support:recyclerview-v7:27.1.0&#39; implementation &#39;de.hdodenhof:circleimageview:2.1.0&#39; implementation &#39;com.android.support:design:27.1.0&#39; 大致形式是这样，没有实现点赞，收藏和喜欢功能，底部可以弹出输入框，并加到列表中显示。
/** *srdx *2019/8/6 */ public class MainActivity extends AppCompatActivity implements View.OnClickListener{ private ArrayList list=new ArrayList(); private RecyclerView recyclerView; private CommitAdapter mAdapter; private GridLayoutManager mLayoutManager; private BottomSheetDialog dialog; private TextView bt_comment; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); initData(); initView(); } private void initData(){ for (int i=0;i&lt;10;i&#43;&#43;){ list.add(&#34;这是第&#34;&#43;i&#43;&#34;条评论&#34;); } } private void initView(){ recyclerView=findViewById(R.id.recy); mAdapter=new CommitAdapter(this,list); recyclerView.setAdapter(mAdapter); mLayoutManager=new GridLayoutManager(this,1); recyclerView.setLayoutManager(mLayoutManager); bt_comment = findViewById(R." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/3e2d010c1059de02e7f64115f7889e31/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-08-06T17:08:08+08:00" />
<meta property="article:modified_time" content="2019-08-06T17:08:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">BottomSheetDialog&#43;Recyclerview一次记录</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>记一次Recyclerview+BottomSheetDialog的简单使用</p> 
<p>列子里用到的依赖</p> 
<pre class="has"><code class="language-java">
    implementation 'com.android.support:recyclerview-v7:27.1.0'
    implementation 'de.hdodenhof:circleimageview:2.1.0'
    implementation 'com.android.support:design:27.1.0'</code></pre> 
<p><img alt="" class="has" height="284" src="https://images2.imgbox.com/2b/31/F39whZME_o.jpg" width="131">大致形式是这样，没有实现点赞，收藏和喜欢功能，底部可以弹出输入框，并加到列表中显示。</p> 
<pre class="has"><code class="language-java">/**
 *srdx
 *2019/8/6
 */
public class MainActivity extends AppCompatActivity implements View.OnClickListener{
    private ArrayList list=new ArrayList();
    private RecyclerView recyclerView;
    private CommitAdapter mAdapter;
    private GridLayoutManager mLayoutManager;
    private BottomSheetDialog dialog;
    private TextView bt_comment;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        initData();
        initView();
    }
    private void initData(){
        for (int i=0;i&lt;10;i++){
            list.add("这是第"+i+"条评论");
        }
    }
    private void initView(){
        recyclerView=findViewById(R.id.recy);
        mAdapter=new CommitAdapter(this,list);
        recyclerView.setAdapter(mAdapter);
        mLayoutManager=new GridLayoutManager(this,1);
        recyclerView.setLayoutManager(mLayoutManager);
        bt_comment =  findViewById(R.id.detail_page_do_comment);
        bt_comment.setOnClickListener(this);
    }
    private void showCommentDialog(){
        dialog =new BottomSheetDialog(this);
        View commentView = LayoutInflater.from(this).inflate(R.layout.comment_dialog_layout,null);
        final EditText commentText=commentView.findViewById(R.id.dialog_comment_et);
        final Button bt_comment=commentView.findViewById(R.id.dialog_comment_bt);
        dialog.setContentView(commentView);
        View parent = (View) commentView.getParent();
        BottomSheetBehavior behavior = BottomSheetBehavior.from(parent);
        commentView.measure(0,0);
        behavior.setPeekHeight(commentView.getMeasuredHeight());

        bt_comment.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                String commentContent=commentText.getText().toString().trim();
                if(!TextUtils.isEmpty(commentContent)){
                    dialog.dismiss();
                    mAdapter.addNewComment(commentContent);
                    Toast.makeText(MainActivity.this,"评论成功",Toast.LENGTH_SHORT).show();
                }
            }
        });
        dialog.show();
    }

    @Override
    public void onClick(View view) {
        if(view.getId()==R.id.detail_page_do_comment){
            Log.d("click","this is click---");
            showCommentDialog();
        }
    }

}</code></pre> 
<pre class="has"><code class="language-java">public class CommitAdapter extends RecyclerView.Adapter&lt;RecyclerView.ViewHolder&gt; {
    private ArrayList list = new ArrayList();//数据源
    public Context context;
    public LayoutInflater inflater;
    private int ThemPsersonType = 0;
    private int NormalType = 1;
    public CommitAdapter(Context context, ArrayList list) {
        this.context = context;
        this.list = list;
        inflater = LayoutInflater.from(context);
    }

    @NonNull
    @Override
    public RecyclerView.ViewHolder onCreateViewHolder(@NonNull ViewGroup viewGroup, int viewType) {
        if(viewType==NormalType){
            return new ViewHolder(inflater.from(context).inflate(R.layout.comment_item_layout, null));
        }else{
            return new ThemPersonHolder(inflater.from(context).inflate(R.layout.themperson_comment,null));
        }
    }

    class ViewHolder extends RecyclerView.ViewHolder {
        TextView commit;

        public ViewHolder(View itemView) {
            super(itemView);
            commit = itemView.findViewById(R.id.comment_item_content);
        }
    }

    class ThemPersonHolder extends RecyclerView.ViewHolder {
        public ThemPersonHolder(View itemView) {
            super(itemView);
        }
    }

    @Override
    public void onBindViewHolder(@NonNull RecyclerView.ViewHolder holder, int position) {
        if(holder instanceof ViewHolder){
            ((ViewHolder) holder).commit.setText(list.get(position-1).toString());
        }

    }

    @Override
    public int getItemCount() {
        return list.size() + 1;
    }

    @Override
    public int getItemViewType(int position) {
        if (position == 0) {
            return ThemPsersonType;
        } else {
            return NormalType;
        }
        //return super.getItemViewType(position);
    }

    public void addNewComment(String comment) {
        list.add(comment);
        notifyDataSetChanged();
    }
}</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3c49b9b8d97269df682a0076fcafad5b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数模matlab入门教程-001-xlsread用法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ba4800c7b70ed62353923002bb6f6f02/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android数据存储（二）——Android存储概念、内部存储、外部存储</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>