<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Shell 脚本常用语法总结 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Shell 脚本常用语法总结" />
<meta property="og:description" content="计算机中 Shell 术语最早是在 1964 年 Multics 操作系统中定义的，作用是提供人机交互的操作界面，它会解释执行用户输入命令并输出结果。对 Shell 通常的理解是 类Unix系统 上的命令行和批处理程序，可以看作是早期操作系统的桌面，像如今的图形化界面（文件资源管理器、任务管理器、控制面板）一样，可以操作文件、查看进程、配置系统、管理硬件等功能。图形化界面虽然能更直观的使用计算机，但无法使用没有界面的程序，且没有Shell脚本灵活的编程复用能力。Shell 通常基于内核API实现，演变出了很多版本，下列介绍目前最常用的版本：
首版名称开发者历史1971年Thompson shell（sh）Ken Thompson为 Unix V1 开发，简化了早期的 Multics shell，新增了如 输入(&lt;)，输出(&gt;) 等特性1977年Bourne shell（sh）Stephen Bourne为 Unix V7 开发，给脚本添加了变量、循环等特性，是当今 shell 的基础，衍生了 csh/ksh/zsh/bash 等1989年Bourne-Again Shell（Bash）Brian Fox为 GNU计划 开发的免费软件，功能上是 Bourne shell 的超集，名字源自 born again 双关语，被 Linux、macOS 系统很多版本广泛使用1990年Z shell（Zsh）Paul Falstad是 csh 的子集，包含了 bash/ksh 部分特性，有热度很高的 Oh My Zsh 插件和社区，并从 2019年 起作为 macOS 默认 shell Shell 本身是指一种应用程序，现在通常也指 Shell 脚本（shell script）。这篇文章主要介绍 Shell 脚本的语法，由于不同版本会有差异，本文采用的案例以覆盖最广泛的 Bash 为准，测试环境为 macOS 中的 Terminal。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/422ffa198a787756a65063a8753556c3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-17T23:49:04+08:00" />
<meta property="article:modified_time" content="2022-09-17T23:49:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Shell 脚本常用语法总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>计算机中 <a href="https://en.wikipedia.org/wiki/Shell_%28computing%29" rel="nofollow">Shell</a> 术语最早是在 1964 年 Multics 操作系统中定义的，作用是提供人机交互的操作界面，它会解释执行用户输入命令并输出结果。对 Shell 通常的理解是 类Unix系统 上的命令行和批处理程序，可以看作是早期操作系统的桌面，像如今的图形化界面（文件资源管理器、任务管理器、控制面板）一样，可以操作文件、查看进程、配置系统、管理硬件等功能。图形化界面虽然能更直观的使用计算机，但无法使用没有界面的程序，且没有Shell脚本灵活的编程复用能力。Shell 通常基于内核API实现，演变出了很多版本，下列介绍目前最常用的版本：</p> 
<table><thead><tr><th>首版</th><th>名称</th><th>开发者</th><th>历史</th></tr></thead><tbody><tr><td>1971年</td><td>Thompson shell（sh）</td><td>Ken Thompson</td><td>为 Unix V1 开发，简化了早期的 Multics shell，新增了如 输入(&lt;)，输出(&gt;) 等特性</td></tr><tr><td>1977年</td><td>Bourne shell（sh）</td><td>Stephen Bourne</td><td>为 Unix V7 开发，给脚本添加了变量、循环等特性，是当今 shell 的基础，衍生了 csh/ksh/zsh/bash 等</td></tr><tr><td>1989年</td><td>Bourne-Again Shell（<a href="https://en.wikipedia.org/wiki/Bash_%28Unix_shell%29" rel="nofollow">Bash</a>）</td><td>Brian Fox</td><td>为 GNU计划 开发的免费软件，功能上是 Bourne shell 的超集，名字源自 <code>born again</code> 双关语，被 Linux、macOS 系统很多版本广泛使用</td></tr><tr><td>1990年</td><td>Z shell（<a href="https://en.wikipedia.org/wiki/Z_shell" rel="nofollow">Zsh</a>）</td><td>Paul Falstad</td><td>是 csh 的子集，包含了 bash/ksh 部分特性，有热度很高的 <a href="https://github.com/ohmyzsh/ohmyzsh">Oh My Zsh</a> 插件和社区，并从 2019年 起作为 macOS 默认 shell</td></tr></tbody></table> 
<p>Shell 本身是指一种应用程序，现在通常也指 Shell 脚本（shell script）。这篇文章主要介绍 Shell 脚本的语法，由于不同版本会有差异，本文采用的案例以覆盖最广泛的 Bash 为准，测试环境为 macOS 中的 Terminal。</p> 
<h3><a id="_12"></a>一、类型定义</h3> 
<h4><a id="1Shebang_14"></a>1，Shebang</h4> 
<p><a href="https://en.wikipedia.org/wiki/Shebang_%28Unix%29" rel="nofollow">Shebang</a> 通常是类Unix系统上脚本的第一行，作用是在执行脚本文件时指明用哪个解释器，比如用 Bash（<code>#!/bin/bash</code>）、Python（<code>#!/usr/bin/python</code>），在 <code>#!</code> 标识后面跟的是解释器的绝对路径。如果脚本中不写这一行，会采用默认的 <code>$SHELL</code> 解释器执行。</p> 
<pre><code class="prism language-shell"><span class="token shebang important">#!/bin/bash</span>
</code></pre> 
<h4><a id="2_22"></a>2，变量</h4> 
<p>变量定义时不需要声明类型，使用 <code>name=value</code> 格式，值属于弱类型等同于字符串。变量命名规则跟主流编程语言差不多，需注意<code>等号 (=) 间不要有空格！！！</code>。</p> 
<p>自定义变量使用 <code>unset xxx</code> 清除，另外查看环境变量用 <code>env</code> 命令，查看所有变量用 <code>declare -p</code> 命令。</p> 
<h5><a id="_28"></a>定义变量</h5> 
<pre><code class="prism language-shell"><span class="token assign-left variable">var1</span><span class="token operator">=</span>hello					<span class="token comment"># 定义变量 var1（可以不加引号）</span>
<span class="token assign-left variable">var1</span><span class="token operator">=</span><span class="token string">"hello world"</span>			<span class="token comment"># 修改变量 var1（包含空格时需添加引号）</span>
<span class="token builtin class-name">readonly</span> <span class="token assign-left variable">var2</span><span class="token operator">=</span><span class="token string">"hello world"</span>	<span class="token comment"># 定义只读变量 var2</span>
</code></pre> 
<h5><a id="_36"></a>引用变量</h5> 
<pre><code class="prism language-shell"><span class="token builtin class-name">echo</span> <span class="token variable">${var1}</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$var1</span>		<span class="token comment"># 打印 var1（在引用无歧义时可以不加{}）</span>
</code></pre> 
<h5><a id="_43"></a>通过变量引用变量</h5> 
<p>使用变量值作为要引用变量的名称，类似于通过变量名称反射它的值，如：</p> 
<pre><code class="prism language-shell"><span class="token assign-left variable">var1</span><span class="token operator">=</span><span class="token string">"hello"</span>
<span class="token assign-left variable">var2</span><span class="token operator">=</span><span class="token string">"var1"</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${<!-- --><span class="token operator">!</span>var2}</span>		<span class="token comment"># 注意添加了感叹号，输出：hello</span>
</code></pre> 
<h4><a id="3_53"></a>3，字符串</h4> 
<p>单引号中任何字符都会原样输出且不能有变量：</p> 
<h5><a id="_57"></a>单引号与双引号</h5> 
<pre><code class="prism language-shell"><span class="token assign-left variable">var1</span><span class="token operator">=</span><span class="token string">"world"</span>
<span class="token builtin class-name">echo</span> <span class="token string">'hello ${var1}'</span>	<span class="token comment"># 输出：hello ${var1}</span>
<span class="token builtin class-name">echo</span> <span class="token string">"hello <span class="token variable">${var1}</span>"</span>	<span class="token comment"># 输出：hello world</span>
</code></pre> 
<h5><a id="_65"></a>截取、删除和替换</h5> 
<pre><code class="prism language-shell"><span class="token assign-left variable">filepath</span><span class="token operator">=</span><span class="token string">"app/src/main.c"</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${<!-- --><span class="token operator">#</span>filepath}</span>		<span class="token comment"># 打印字符串长度，输出：14</span>

<span class="token builtin class-name">echo</span> <span class="token variable">${filepath<span class="token operator">:</span>3}</span>		<span class="token comment"># 从第3位开始（Index从0开始），截取到最后，输出：/src/main.c</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${filepath<span class="token operator">:</span>3<span class="token operator">:</span>4}</span>	<span class="token comment"># 从第3位开始，截取4个字符，输出：/src</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${filepath<span class="token operator">:</span>0<span class="token operator">:</span>${<!-- --><span class="token operator">#</span>filepath}</span>-6<span class="token punctuation">}</span>	<span class="token comment"># 删除字符串末尾的6个字符，输出：app/src/</span>

<span class="token builtin class-name">echo</span> <span class="token variable">${filepath<span class="token operator">#</span>*<span class="token operator">/</span>}</span>		<span class="token comment"># 删除左侧匹配（*/）到的字符串（app/），输出：src/main.c</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${filepath<span class="token operator">##</span>*<span class="token operator">/</span>}</span>	<span class="token comment"># 删除左侧贪婪匹配（*/）到的字符串（app/src/），输出：main.c</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${filepath<span class="token operator">%</span><span class="token operator">/</span>*}</span>		<span class="token comment"># 删除右侧匹配（/*）到的字符串（/main.c），输出：app/src</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${filepath<span class="token operator">%%</span><span class="token operator">/</span>*}</span>	<span class="token comment"># 删除右侧贪婪匹配（/*）到的字符串（/src/main.c），输出：app</span>

<span class="token builtin class-name">echo</span> <span class="token variable">${filepath<span class="token operator">/</span>app<span class="token operator">/</span>sdk}</span>	<span class="token comment"># 将第一个 app 字符串替换为 sdk，输出：sdk/src/main.c</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${filepath<span class="token operator">/</span><span class="token operator">/</span>c<span class="token operator">/</span>cpp}</span>		<span class="token comment"># 将所有 c 字符串替换为 cpp，输出：app/srcpp/main.cpp</span>
</code></pre> 
<h4><a id="4_84"></a>4，数组</h4> 
<p>数组用括号 <code>()</code> 表达，元素间用空格 （<code> </code>） 分隔，下面只介绍 <code>索引数组</code>。此外还有用字符串作为下标的 <code>关联数组</code>，删除数组或数组元素都可以用 unset。</p> 
<h5><a id="_88"></a>定义数组</h5> 
<pre><code class="prism language-shell"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"aa"</span> <span class="token string">"bb"</span> <span class="token string">"cc"</span><span class="token punctuation">)</span>		<span class="token comment"># 创建三个数组元素</span>
</code></pre> 
<p>或：使用字符串的处理结果创建数组</p> 
<pre><code class="prism language-shell"><span class="token assign-left variable">text</span><span class="token operator">=</span><span class="token string">"aa:bb:cc"</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">${text<span class="token operator">/</span><span class="token operator">/</span><span class="token operator">:</span><span class="token operator">/</span> }</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_101"></a>修改数组</h5> 
<pre><code class="prism language-shell">array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"dd"</span>		<span class="token comment"># 设置指定下标的值（超过数组长度的下标会新增）</span>
array<span class="token punctuation">[</span><span class="token variable">${<!-- --><span class="token operator">#</span>array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"ee"</span>		<span class="token comment"># 添加单个元素</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"<span class="token variable">${array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"</span> <span class="token string">"ff"</span> <span class="token string">"gg"</span><span class="token punctuation">)</span>	<span class="token comment"># 添加两个元素</span>
</code></pre> 
<h5><a id="_109"></a>查看数组</h5> 
<pre><code class="prism language-shell"><span class="token builtin class-name">echo</span> <span class="token variable">${array<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>		<span class="token comment"># 输出第一个元素，结果：aa</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${array<span class="token punctuation">[</span>${<!-- --><span class="token operator">#</span>array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>-1<span class="token punctuation">]</span><span class="token punctuation">}</span>		<span class="token comment"># 输出最后一个元素，结果：gg</span>

<span class="token builtin class-name">echo</span> <span class="token variable">${array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>		<span class="token comment"># 输出全部元素，结果：aa bb cc dd ee ff gg</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${<!-- --><span class="token operator">#</span>array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>	<span class="token comment"># 输出数组长度，结果：7</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${<!-- --><span class="token operator">!</span>array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>	<span class="token comment"># 输出数组下标，结果：0 1 2 3 4 5 6</span>
</code></pre> 
<h4><a id="5_120"></a>5，函数</h4> 
<h5><a id="_122"></a>函数定义</h5> 
<pre><code class="prism language-shell"><span class="token keyword">function</span> <span class="token function-name function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token builtin class-name">return</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>function：函数修饰符（可选）</li><li>name()：函数名称，括号内不支持写参数名</li><li>return 0：返回值，仅限数值0-255，0表示成功（可选）</li></ul> 
<h5><a id="_134"></a>函数参数</h5> 
<p>函数参数是数组形式，在函数内引用参数从 <code>$1</code> 开始，查看全部参数用 <code>$@</code>，获取参数跟查看数组的语法基本一致。示例如下：</p> 
<pre><code class="prism language-shell"><span class="token keyword">function</span> <span class="token function-name function">fun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token builtin class-name">echo</span> <span class="token string">"第一个参数：<span class="token variable">$1</span>，全部参数：[<span class="token variable">$@</span>]，参数个数：<span class="token variable">$#</span>"</span>
	<span class="token builtin class-name">return</span> <span class="token number">66</span>
<span class="token punctuation">}</span>
fun1 <span class="token string">"aa"</span> <span class="token string">"bb"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"函数返回值：<span class="token variable">$?</span>"</span>
</code></pre> 
<p>输出结果：</p> 
<pre><code>第一个参数：aa，全部参数：[aa bb]，参数个数：2
函数返回值：66
</code></pre> 
<h4><a id="6_154"></a>6，注释</h4> 
<p>语法中提供了特殊字符 <code>#</code> 作为单行注释标识符，但多行注释并未提供，下面贴出其他同学的解法。</p> 
<h5><a id="_158"></a>单行注释</h5> 
<pre><code class="prism language-shell"><span class="token comment"># echo "hello world"</span>
</code></pre> 
<h5><a id="_165"></a>多行注释</h5> 
<ol><li> <p>转化为 <code>&lt;&lt;EOF ... EOF</code> 多行文本的形式，然后丢弃掉输入内容</p> <pre><code class="prism language-shell">:<span class="token operator">&lt;&lt;</span><span class="token string">EOF
...
EOF</span>
</code></pre> 
  <ul><li>这里的 <code>:</code> 是空命令，相当于丢弃了后面的输入，如果换成 <code>cat</code> 是打印注释的内容。</li><li>问题不足：如果内容包含反引号 <code>`</code>，反引号中的内容会被执行，如 <code>`touch ~/Downloads/test.log`</code>，依旧会在下载目录创建文件。</li></ul> </li><li> <p>转成函数定义，不调用就不会执行</p> <pre><code class="prism language-shell"><span class="token function-name function">annotation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">..</span>.
<span class="token punctuation">}</span>
</code></pre> </li></ol> 
<h3><a id="_187"></a>二、流程控制</h3> 
<h4><a id="1_189"></a>1，逻辑分支</h4> 
<h5><a id="ifelse__191"></a>if/else 语句</h5> 
<pre><code class="prism language-shell"><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$num1</span> -gt <span class="token number">100</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"number &gt; 100"</span>
<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$num1</span> -lt <span class="token number">50</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span> 
    <span class="token builtin class-name">echo</span> <span class="token string">"number &lt; 50"</span>
<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"50 &lt;= number &lt;= 100"</span>
<span class="token keyword">fi</span>
</code></pre> 
<p>判断变量 <code>num1</code> 的数字范围，<code>-gt</code> 是大于，<code>-lt</code> 是小于。</p> 
<h5><a id="for__205"></a>for 循环语句</h5> 
<pre><code class="prism language-shell"><span class="token comment"># array=("aa" "bb" "cc")</span>
<span class="token comment"># for item in ${array[@]}; do</span>

<span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token string">"aa"</span> <span class="token string">"bb"</span> <span class="token string">"cc"</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"item = <span class="token variable">$item</span>"</span>
<span class="token keyword">done</span>
</code></pre> 
<p>for 循环数组，可以先定义数组再引用，或者直接在循环语句中定义。</p> 
<h5><a id="while__218"></a>while 循环语句</h5> 
<pre><code class="prism language-shell"><span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$num1</span> -lt <span class="token number">10</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"number = <span class="token variable">$num1</span>"</span>
    <span class="token builtin class-name">let</span> <span class="token string">"num1++"</span>
<span class="token keyword">done</span>
</code></pre> 
<p>while 当条件为 true 时一直循环，若 <code>num1=1</code> 输出结果是 1 到 9，let 命令用于执行表达式。</p> 
<h5><a id="switch__228"></a>switch 选择语句</h5> 
<pre><code class="prism language-shell"><span class="token keyword">case</span> <span class="token variable">$num1</span> <span class="token keyword">in</span>
    <span class="token number">1</span><span class="token operator">|</span><span class="token number">2</span><span class="token punctuation">)</span>
		<span class="token builtin class-name">echo</span> <span class="token string">'number = 1 or 2'</span>
		<span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token number">3</span><span class="token punctuation">)</span>
		<span class="token builtin class-name">echo</span> <span class="token string">'number = 3'</span>
		<span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span>
		<span class="token builtin class-name">echo</span> <span class="token string">'number other'</span>
    	<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre> 
<p>在 shell 中选择语句的定义是 <code>case ... esac</code>，多个可选值用 <code>|</code> 分割，默认值用 <code>*</code> 表示。</p> 
<h4><a id="2_246"></a>2，条件判断</h4> 
<p>比较数值关系或检测文件状态，用于 <code>if</code> 语句后面的条件时，需要使用关键字修饰，常有这几种写法：</p> 
<ul><li><code>test</code> 关键字，判断语句后的表达式为 true/false；</li><li><code>[ ]</code> 单个中括号，基本等同 test 关键字（注意括号内要有空格）；</li><li><code>[[ ]]</code> 双中括号，是 [] 写法的升级版，是在 bash 中引入，支持了 <code>&amp;&amp;</code>、<code>||</code> 和 <code>!</code> 逻辑运算符，和字符串的正则表达式；</li></ul> 
<p>以下三种写法是等同的：</p> 
<pre><code class="prism language-shell"><span class="token keyword">if</span> <span class="token builtin class-name">test</span> <span class="token variable">$num</span> -ge <span class="token number">50</span> -a <span class="token variable">$num</span> -le <span class="token number">100</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token comment"># if [ $num -ge 50 -a $num -le 100 ]; then</span>
<span class="token comment"># if [[ $num -ge 50 &amp;&amp; $num -le 100 ]]; then</span>
	<span class="token builtin class-name">echo</span> <span class="token string">"50 &lt;= number &lt;= 100"</span>
<span class="token keyword">fi</span>
</code></pre> 
<h5><a id="_264"></a>比较符号</h5> 
<p><strong>布尔运算符</strong>：用于连接多条表达式</p> 
<table><thead><tr><th>符号</th><th>含义</th><th></th><th>符号</th><th>含义</th><th></th><th>符号</th><th>含义</th></tr></thead><tbody><tr><td>!</td><td>非运算</td><td></td><td>-o (or)</td><td>或运算（|）</td><td></td><td>-a (and)</td><td>与运算（&amp;）</td></tr></tbody></table> 
<p><strong>数值比较</strong></p> 
<table><thead><tr><th>符号</th><th>含义</th><th></th><th>符号</th><th>含义</th></tr></thead><tbody><tr><td>-eq (equal)</td><td>等于（=）</td><td></td><td>-ne (not equal)</td><td>不等于（!=）</td></tr><tr><td>-gt (greater than)</td><td>大于（&gt;）</td><td></td><td>-ge (greater than or equal)</td><td>大于等于（&gt;=）</td></tr><tr><td>-lt (less than)</td><td>小于（&lt;）</td><td></td><td>-le (less than or equal)</td><td>小于等于（&lt;=）</td></tr></tbody></table> 
<p><strong>字符串比较</strong></p> 
<table><thead><tr><th>符号</th><th>含义</th><th></th><th>符号</th><th>含义</th></tr></thead><tbody><tr><td>== / =</td><td>字符串相同</td><td></td><td>!=</td><td>字符串不相同</td></tr><tr><td>-z</td><td>字符串为空（长度为0）</td><td></td><td>-n / $xxx</td><td>字符串非空（长度大于0）</td></tr><tr><td>&gt;</td><td>字符串的字典顺序先后</td><td></td><td>=~</td><td>字符串包含</td></tr></tbody></table> 
<pre><code class="prism language-shell"><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$string1</span> <span class="token operator">==</span> <span class="token string">'xxx'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>		// 判断字符串相同（也可以用单个等号 <span class="token punctuation">(</span><span class="token operator">=</span><span class="token punctuation">)</span>）
<span class="token keyword">if</span> <span class="token punctuation">[</span> -z <span class="token string">"<span class="token variable">$string1</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>		// 判断字符串为空（建议变量用双引号 <span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> 包裹，避免变量未定义时出错）
<span class="token keyword">if</span> <span class="token punctuation">[</span> -n <span class="token string">"<span class="token variable">$string1</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>		// 判断字符串不为空（也可以直接写变量，如 <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$string1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>）
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$string1</span>"</span> <span class="token operator">&gt;</span> <span class="token string">"<span class="token variable">$string2</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>		// 判断字符串 string1 排序在 string2 之后（注：要用双中括号，单中括号是ASCII排序）
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$string1</span>"</span> <span class="token operator">=~</span> <span class="token string">"xxx"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>		// 判断字符串 string1 中是否包含某个字符 （注：要用双中括号，单括号会报错）
</code></pre> 
<p><strong>文件状态判断</strong></p> 
<table><thead><tr><th>符号</th><th>含义</th><th></th><th>符号</th><th>含义</th></tr></thead><tbody><tr><td>-e (exist) / -a</td><td>文件存在</td><td></td><td>-s</td><td>文件存在且文件尺寸大于零</td></tr><tr><td>-f (file)</td><td>文件存在且为普通文件</td><td></td><td>-d (directory)</td><td>文件存在且为目录</td></tr><tr><td>-L (link)</td><td>文件存在且为链接文件</td><td></td><td>-r (read)</td><td>文件存在且可读</td></tr><tr><td>-w (write)</td><td>文件存在且可写</td><td></td><td>-x (eXecute)</td><td>文件存在且可执行</td></tr></tbody></table> 
<pre><code class="prism language-shell"><span class="token keyword">if</span> <span class="token punctuation">[</span> -s <span class="token variable">$file</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>		// 判断文件存在且文件尺寸大于零
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> -e <span class="token variable">$file</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>		// 判断文件不存在
</code></pre> 
<h3><a id="_312"></a>三、脚本交互参数</h3> 
<p>在调用脚本前需要先添加执行权限（<code>chmod +x file</code>），相对路径时要以点开头（./），最终会使用脚本中 Shebang 定义的解释器执行。我通常使用解释器加文件的方式运行（<code>bash xxx.sh</code>），这样可以省去添加执行权限。</p> 
<h5><a id="_316"></a>默认传参</h5> 
<p>在执行脚本后面追加的字符串，会被当作参数全部传入，如执行：</p> 
<pre><code class="prism language-shell"><span class="token function">bash</span> xxx.sh <span class="token string">"aa"</span> <span class="token string">"bb"</span> <span class="token string">"cc"</span>
</code></pre> 
<p>其中 xxx.sh 的内容为：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">echo</span> <span class="token string">"第一个参数：<span class="token variable">${1}</span>"</span>		// 输出：aa
<span class="token builtin class-name">echo</span> <span class="token string">"参数个数：<span class="token variable">${<!-- --><span class="token operator">#</span>}</span>"</span>		// 输出：3
<span class="token builtin class-name">echo</span> <span class="token string">"全部参数：<span class="token variable">${@}</span>"</span>		// 输出：aa bb cc
</code></pre> 
<h5><a id="getopts__332"></a>getopts 解析传参</h5> 
<p>当要传多个参数时，更友好的做法是用（-key value）形式，系统内置了 getopts 命令来解析这种参数，不过它只支持单字符选项。要多字符选项请参照 <code>getopt</code> 命令，或自行实现。下列命令执行后，会输出a、b的值：</p> 
<pre><code class="prism language-shell"><span class="token function">bash</span> xxx.sh -a <span class="token string">"111"</span> -b <span class="token string">"222"</span>
</code></pre> 
<p>其中 xxx.sh 的内容为：</p> 
<pre><code class="prism language-shell"><span class="token keyword">while</span> <span class="token builtin class-name">getopts</span> a:b:h ops<span class="token punctuation">;</span> <span class="token keyword">do</span>
	<span class="token keyword">case</span> <span class="token variable">${ops}</span> <span class="token keyword">in</span>
		a<span class="token punctuation">)</span>
			<span class="token builtin class-name">echo</span> <span class="token string">"a value = <span class="token variable">${OPTARG}</span>"</span>
			<span class="token punctuation">;</span><span class="token punctuation">;</span>
		b<span class="token punctuation">)</span>
			<span class="token builtin class-name">echo</span> <span class="token string">"b value = <span class="token variable">${OPTARG}</span>"</span>
			<span class="token punctuation">;</span><span class="token punctuation">;</span>
		h<span class="token punctuation">)</span>
			<span class="token builtin class-name">echo</span> <span class="token string">"help : "</span>
			<span class="token builtin class-name">echo</span> <span class="token string">"-a xxx"</span>
			<span class="token builtin class-name">echo</span> <span class="token string">"-b xxx"</span>
			<span class="token builtin class-name">echo</span> <span class="token string">"-h help"</span>
			<span class="token builtin class-name">exit</span>
			<span class="token punctuation">;</span><span class="token punctuation">;</span>
		*<span class="token punctuation">)</span>
			<span class="token builtin class-name">echo</span> <span class="token string">"unknow params"</span>
			<span class="token builtin class-name">exit</span>
			<span class="token punctuation">;</span><span class="token punctuation">;</span>
	<span class="token keyword">esac</span>
<span class="token keyword">done</span>
</code></pre> 
<ul><li>通过 while 循环逐个解析参数；</li><li>代码（<code>a:b:h</code>）：a、b字符后有冒号，意思是要携带值，h字符后无冒号表示不用额外值；</li></ul> 
<h5><a id="_370"></a>运行时传参</h5> 
<p>在脚本运行中与用户交互，读取用户输入信息通过 read 命令，示例如下：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">read</span> -p <span class="token string">"请输入 ok 继续执行: "</span> inputCmd
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">'ok'</span> <span class="token operator">!=</span> <span class="token string">"<span class="token variable">$inputCmd</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"已取消，退出程序"</span>
    <span class="token builtin class-name">exit</span>
<span class="token keyword">fi</span>
</code></pre> 
<h3><a id="_383"></a>参考资料</h3> 
<ul><li>Bash手册： <a href="http://www.gnu.org/software/bash/manual/bash.html" rel="nofollow">http://www.gnu.org/software/bash/manual/bash.html</a></li><li>菜鸟联盟： <a href="https://www.runoob.com/linux/linux-shell.html" rel="nofollow">https://www.runoob.com/linux/linux-shell.html</a></li><li>shell数组详解：<a href="https://blog.csdn.net/anqixiang/article/details/114415491">https://blog.csdn.net/anqixiang/article/details/114415491</a></li><li>UNIX考古记：一个“遗失”的SHELL： <a href="https://coolshell.cn/articles/9410.html" rel="nofollow">https://coolshell.cn/articles/9410.html</a></li><li>Evolution of shells in Linux： <a href="https://developer.ibm.com/tutorials/l-linux-shells/" rel="nofollow">https://developer.ibm.com/tutorials/l-linux-shells/</a></li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8cc40d0864f7cda9c79431d3c28d3fe0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">linux学习，配置bond</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dc939a0d40b097e74e7d0824f50375c0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">DRM驱动（六）之atomic_check</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>