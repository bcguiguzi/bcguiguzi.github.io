<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>自建网盘利用OneDrive，oneindex网盘 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="自建网盘利用OneDrive，oneindex网盘" />
<meta property="og:description" content="网盘自建 1.准备工作2.下载源码并上传3.配置教程4.主题使用方法5.Oneindex文件描述6.给文件夹加密码7.可能出现的问题8.命令指示9.定时清除缓存10.转载须知 Oneindex不占用服务器空间，不走服务器流量，直接列出 OneDrive 目录，文件直链下载。有微软账号即可
1.准备工作 微软账号(刚注册的内存空间只有5G大小，需要扩宽内存可自行百度)下载oneindex的源码上传到自己的服务器即可准备一个域名，或者放到自己域名的非根目录下服务器要求PHP空间，PHP 5.6&#43; 需打开curl支持 2.下载源码并上传 下载地址下载后上传到服务器，根目录或者其他目录，按需安装 3.配置教程 登录设定的域名，开始部署配置
注:第三空将域名填入即可
点击蓝色按钮获取client_id和client_secret
client_secret
client_id 点击上方图片所示的知道了返回快速启动，下滑找到client_id
确认信息后点击下一步演示地址 效果主题为以下主题，按照指示修改即可 4.主题使用方法 主题包中的信息需要修改 主题包下载地址
找到 nexmoe 下 layout.php 使用打开
修改 第7行 、第9行 第18行 pan.mr90.top为自己域名（或者自己引用的目录）
修改 第15行 链接里的QQ 为自己QQ（或者自己引用的图片）
打开 theme 下 style.css 文件
修改 第97行、第103行 pan.mr90.top 为自己域名（或者自己引用的目录）
请删除原有 nexmoe 主题文件夹，将压缩包内 nexmoe 复制到该位置。
将 theme 文件夹放在网站根目录.（或者别的地方，可以引用就好）
5.Oneindex文件描述 文件描述仿照Github的README.md文件
在文件夹底部添加说明
在 OneDrive 的文件夹中添加`README.md`文件，使用 Markdown 语法。 在文件夹头部添加说明:
在 OneDrive 的文件夹中添加`HEAD.md` 文件，使用 Markdown 语法。 直接输出网页" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/28722594ab53e9767daef8866f85b07a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-13T21:04:10+08:00" />
<meta property="article:modified_time" content="2020-12-13T21:04:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">自建网盘利用OneDrive，oneindex网盘</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>网盘自建</h4> 
 <ul><li><ul><li><ul><li><ul><li><a href="#1_2" rel="nofollow">1.准备工作</a></li><li><a href="#2_9" rel="nofollow">2.下载源码并上传</a></li><li><a href="#3_12" rel="nofollow">3.配置教程</a></li><li><a href="#4_26" rel="nofollow">4.主题使用方法</a></li><li><a href="#5Oneindex_43" rel="nofollow">5.Oneindex文件描述</a></li><li><a href="#6_61" rel="nofollow">6.给文件夹加密码</a></li><li><a href="#7_67" rel="nofollow">7.可能出现的问题</a></li><li><a href="#8_85" rel="nofollow">8.命令指示</a></li><li><a href="#9_110" rel="nofollow">9.定时清除缓存</a></li><li><a href="#10_120" rel="nofollow">10.转载须知</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<blockquote> 
 <p>Oneindex不占用服务器空间，不走服务器流量，直接列出 OneDrive 目录，文件直链下载。有微软账号即可</p> 
</blockquote> 
<h5><a id="1_2"></a>1.准备工作</h5> 
<ol><li>微软账号(刚注册的内存空间只有5G大小，需要扩宽内存可自行百度)</li><li>下载oneindex的源码上传到自己的服务器即可</li><li>准备一个域名，或者放到自己域名的非根目录下</li><li>服务器要求PHP空间，PHP 5.6+ 需打开curl支持</li></ol> 
<h5><a id="2_9"></a>2.下载源码并上传</h5> 
<ul><li><a href="https://pan.mr90.top/PcFile/%E7%BC%96%E7%A8%8B/Source%20code/Oneindex/" rel="nofollow noopener noreferrer" target="_blank">下载地址</a></li><li>下载后上传到服务器，根目录或者其他目录，按需安装</li></ul> 
<h5><a id="3_12"></a>3.配置教程</h5> 
<p>登录设定的域名，开始部署配置<br> <img src="https://images2.imgbox.com/b4/92/dOuW0EH0_o.png" alt=""><br> <img src="https://images2.imgbox.com/a0/34/kJ3qRRgP_o.png" alt=""><br> <code>注:第三空将域名填入即可</code></p> 
<blockquote> 
 <p>点击蓝色按钮获取<code>client_id</code>和<code>client_secret</code></p> 
</blockquote> 
<ul><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled> client_secret<br> <img src="https://images2.imgbox.com/5a/10/Ulac8mxr_o.png" alt=""></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled> client_id</li></ul> 
<blockquote> 
 <p>点击上方图片所示的知道了返回快速启动，下滑找到<code>client_id</code></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/1e/da/PQfrVlQ7_o.png" alt=""></p> 
<ul><li>确认信息后点击下一步</li><li><a href="https://pan.mr90.top" rel="nofollow noopener noreferrer" target="_blank">演示地址</a> 效果主题为以下主题，按照指示修改即可</li></ul> 
<h5><a id="4_26"></a>4.主题使用方法</h5> 
<p>主题包中的信息需要修改 主题包<a href="https://pan.mr90.top/PcFile/%E7%BC%96%E7%A8%8B/Source%20code/Oneindex/" rel="nofollow noopener noreferrer" target="_blank">下载地址</a></p> 
<ol><li> <p>找到 <code>nexmoe</code> 下 <code>layout.php</code> 使用打开</p> <p>修改 第7行 、第9行 第18行 pan.mr90.top为自己域名（或者自己引用的目录）</p> <p>修改 第15行 链接里的QQ 为自己QQ（或者自己引用的图片）</p> </li><li> <p>打开 <code>theme</code> 下 <code>style.css</code> 文件</p> <p>修改 第97行、第103行 <code>pan.mr90.top</code> 为自己域名（或者自己引用的目录）</p> <p>请删除原有 <code>nexmoe</code> 主题文件夹，将压缩包内 <code>nexmoe</code> 复制到该位置。</p> </li><li> <p>将 <code>theme</code> 文件夹放在网站根目录.（或者别的地方，可以引用就好）</p> </li></ol> 
<h5><a id="5Oneindex_43"></a>5.Oneindex文件描述</h5> 
<blockquote> 
 <p>文件描述仿照<code>Github</code>的README.md文件</p> 
</blockquote> 
<ol><li> <p>在文件夹底部添加说明</p> <pre><code>在 OneDrive 的文件夹中添加`README.md`文件，使用 Markdown 语法。
</code></pre> </li><li> <p>在文件夹头部添加说明:</p> <pre><code>在 OneDrive 的文件夹中添加`HEAD.md` 文件，使用 Markdown 语法。
</code></pre> </li><li> <p>直接输出网页</p> <pre><code>在 OneDrive 的文件夹中添加`index.html` 文件，程序会直接输出网页而不列目录。
</code></pre> </li></ol> 
<p>配合 文件展示设置-直接输出 效果更佳。</p> 
<ul><li><code>如图所示</code></li></ul> 
<p><img src="https://images2.imgbox.com/d9/cc/cEydbmwh_o.png" alt=""></p> 
<h5><a id="6_61"></a>6.给文件夹加密码</h5> 
<ul><li>新建一个名为<code>.password</code>的无后缀格式文件，在其中输入密码</li></ul> 
<p><code>如图所示</code><br> <img src="https://images2.imgbox.com/f9/52/4KX1HMi3_o.png" alt=""><br> <code>注</code>密码写入文件夹即可，可以直接在需要加密的文件夹中创建，注意修改文件时看是否有文件后缀(不要犯这个低级错误)</p> 
<h5><a id="7_67"></a>7.可能出现的问题</h5> 
<ul><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled> 安装配置后，域名链接出现了/?/ 如何去掉？</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled> 配置网站的伪静态，代码如下</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled> Nginx 伪静态设置</li></ul> 
<pre><code>if (!-f $request_filename){
set $rule_0 1$rule_0;
}
if (!-d $request_filename){
set $rule_0 2$rule_0;
}
if ($rule_0 = "21"){
rewrite ^/(.*)$ /index.php?/$1 last;
}
</code></pre> 
<p><code>后台</code>打开去掉<code>/?/</code>(需配合伪静态使用!!)，保存设置</p> 
<h5><a id="8_85"></a>8.命令指示</h5> 
<pre><code>命令功能
仅能在PHP CLI模式下运行
清除缓存：
php one.php cache:clear
刷新缓存：
php one.php cache:refresh
刷新令牌：
php one.php token:refresh
上传文件：
php one.php upload:file 本地文件 [OneDrive文件]
上传文件夹：
php one.php upload:folder 本地文件夹 [OneDrive文件夹]
</code></pre> 
<p><code>例如：</code></p> 
<ul><li>//上传temp.zip 到OneDrive 根目录<br> php one.php upload:file temp.zip</li><li>//上传temp.zip 到OneDrive /test/目录<br> php one.php upload:file temp.zip /test/</li><li>//上传temp.zip 到OneDrive /test/目录并将其命名为 ad.zip<br> php one.php upload:file temp.zip /test/ad.zip</li><li>//上传 temp/ 到OneDrive /test/ 目录(<code>temp/</code>为文件夹)<br> php one.php upload:file temp/ /test/</li></ul> 
<h5><a id="9_110"></a>9.定时清除缓存</h5> 
<ul><li>设置一个定时清除缓存任务</li><li>利用宝塔的计划任务</li><li>代码如下</li></ul> 
<pre><code>*/10 * * * * php /www/wwwroot/pan.mr90.top/one.php cache:refresh
</code></pre> 
<p><code>如图所示</code><br> <img src="https://images2.imgbox.com/64/6f/JsaGwDxs_o.png" alt=""></p> 
<h5><a id="10_120"></a>10.转载须知</h5> 
<ul><li>转载请标明出处</li></ul> 
<pre><code># 商业转载请联系作者获得授权，非商业转载请注明出处。
# For commercial use, please contact the author for authorization. For non-commercial use, please indicate the source.
# 协议(License)：署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0)
# 作者(Author)：Boo
# 链接(URL)： https://t.mr90.top/wx-page/build/oneindex1.html
# 来源(Source)：Booの小破站
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c4e54212a37b7b8f1ec3e5279ef5849b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mysql视图和存储过程哪个性能好_MySQL系列(6)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c927fe7161b2cfeebe7024650a21dc6e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Flutter系列之自定义实现圆角渐变进度条</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>