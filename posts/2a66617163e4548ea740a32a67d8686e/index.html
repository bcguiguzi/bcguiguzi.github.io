<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux环境下运行Tess4j进行OCR识别 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux环境下运行Tess4j进行OCR识别" />
<meta property="og:description" content="1.Tess4j&amp; Tesseract OCR简介 Tess4J 是一个基于 Tesseract OCR 引擎的 Java 接口，可以用来识别图像中的文本。Tesseract 是一个由 Google 开发的开源 OCR 引擎，可以识别多种语言的文本。Tess4J 将 Tesseract 引擎的优势和简单性与 Java 的可移植性和易用性相结合，是一个非常强大的 OCR 解决方案。
Tess4J 提供了丰富的 API，可以很方便地进行图像处理和文本识别。它支持多种格式的图像文件，包括 BMP、PNG、JPEG、GIF 和 TIFF 等格式。Tess4J 还可以进行图像预处理，例如裁剪、缩放和二值化等，以提高文本识别的准确性。
Tess4j官网：https://tess4j.sourceforge.net/usage.html
Tesseract OCR代码库：https://github.com/tesseract-ocr/
2.Tess4j的简单案例 引入依赖 首先引入maven依赖：
&lt;dependency&gt; &lt;groupId&gt;net.sourceforge.tess4j&lt;/groupId&gt; &lt;artifactId&gt;tess4j&lt;/artifactId&gt; &lt;version&gt;4.0.0&lt;/version&gt; &lt;/dependency&gt; 代码案例 下面是一段简单的代码案例：
// 新建工具对象 ITesseract iTesseract = new Tesseract(); // 设置语言 这里设置简体中文 iTesseract.setLanguage(&#34;chi_sim&#34;); // 设置训练数据路径 iTesseract.setDatapath(&#34;D:\\tessdata&#34;); // 提取图片中的文字 String result = iTesseract.doOCR(new File(&#34;D:\\test.png&#34;)); 上面设置了语言是简体中文，需要去tesseract-ocr语言库中下载预训练数据。
下载语言库 语言库下载地址：https://github.com/tesseract-ocr/tessdata
这里下载简体中文(chi_sim.traineddata)预训练数据。
3.Windows上运行ITesseract类 经过上面步骤后，可以在Windows上直接运行代码案例，因为Tess4J在Windows上是开箱即用的。下面看一下原因。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/2a66617163e4548ea740a32a67d8686e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-30T17:24:55+08:00" />
<meta property="article:modified_time" content="2023-05-30T17:24:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux环境下运行Tess4j进行OCR识别</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h5><a id="1Tess4j_Tesseract_OCR_0"></a>1.Tess4j&amp; Tesseract OCR简介</h5> 
<p>Tess4J 是一个基于 Tesseract OCR 引擎的 Java 接口，可以用来识别图像中的文本。Tesseract 是一个由 Google 开发的开源 OCR 引擎，可以识别多种语言的文本。Tess4J 将 Tesseract 引擎的优势和简单性与 Java 的可移植性和易用性相结合，是一个非常强大的 OCR 解决方案。<br> Tess4J 提供了丰富的 API，可以很方便地进行图像处理和文本识别。它支持多种格式的图像文件，包括 BMP、PNG、JPEG、GIF 和 TIFF 等格式。Tess4J 还可以进行图像预处理，例如裁剪、缩放和二值化等，以提高文本识别的准确性。<br> Tess4j官网：<a href="https://tess4j.sourceforge.net/usage.html" rel="nofollow">https://tess4j.sourceforge.net/usage.html</a><br> Tesseract OCR代码库：<a href="https://github.com/tesseract-ocr/">https://github.com/tesseract-ocr/</a></p> 
<h5><a id="2Tess4j_5"></a>2.Tess4j的简单案例</h5> 
<h6><a id="_6"></a>引入依赖</h6> 
<p>首先引入maven依赖：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>net.sourceforge.tess4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>tess4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h6><a id="_15"></a>代码案例</h6> 
<p>下面是一段简单的代码案例：</p> 
<pre><code class="prism language-java"><span class="token comment">// 新建工具对象</span>
<span class="token class-name">ITesseract</span> iTesseract <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tesseract</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置语言 这里设置简体中文</span>
iTesseract<span class="token punctuation">.</span><span class="token function">setLanguage</span><span class="token punctuation">(</span><span class="token string">"chi_sim"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置训练数据路径</span>
iTesseract<span class="token punctuation">.</span><span class="token function">setDatapath</span><span class="token punctuation">(</span><span class="token string">"D:\\tessdata"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 提取图片中的文字</span>
<span class="token class-name">String</span> result <span class="token operator">=</span> iTesseract<span class="token punctuation">.</span><span class="token function">doOCR</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"D:\\test.png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>上面设置了语言是简体中文，需要去tesseract-ocr语言库中下载预训练数据。</p> 
<h6><a id="_28"></a>下载语言库</h6> 
<p>语言库下载地址：<a href="https://github.com/tesseract-ocr/tessdata">https://github.com/tesseract-ocr/tessdata</a><br> <img src="https://images2.imgbox.com/b7/5c/1Dd7upZh_o.png" alt="image.png"><br> 这里下载简体中文(<a href="https://github.com/tesseract-ocr/tessdata/blob/main/chi_sim.traineddata">chi_sim.traineddata</a>)预训练数据。</p> 
<h5><a id="3WindowsITesseract_32"></a>3.Windows上运行ITesseract类</h5> 
<p>经过上面步骤后，可以在Windows上直接运行代码案例，因为Tess4J在Windows上是开箱即用的。下面看一下原因。</p> 
<h6><a id="_34"></a>代码调用链分析</h6> 
<p>首先，看一下OCR识别的核心代码调用链路：</p> 
<pre><code class="prism language-java"><span class="token class-name">String</span> result <span class="token operator">=</span> iTesseract<span class="token punctuation">.</span><span class="token function">doOCR</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"D:\\test.png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>下面是Tesseractl类的方法：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">doOCR</span><span class="token punctuation">(</span><span class="token class-name">File</span> imageFile<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TesseractException</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token function">doOCR</span><span class="token punctuation">(</span>imageFile<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">doOCR</span><span class="token punctuation">(</span><span class="token class-name">File</span> imageFile<span class="token punctuation">,</span> <span class="token class-name">Rectangle</span> rect<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TesseractException</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token function">doOCR</span><span class="token punctuation">(</span><span class="token class-name">ImageIOHelper</span><span class="token punctuation">.</span><span class="token function">getIIOImageList</span><span class="token punctuation">(</span>imageFile<span class="token punctuation">)</span><span class="token punctuation">,</span> imageFile<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rect<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TesseractException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>下面doOCR方法里面通过init方法初始化TessAPI对象：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">doOCR</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">IIOImage</span><span class="token punctuation">&gt;</span></span> imageList<span class="token punctuation">,</span> <span class="token class-name">String</span> filename<span class="token punctuation">,</span> <span class="token class-name">Rectangle</span> rect<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TesseractException</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTessVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>TessAPI对象初始化：</p> 
<pre><code class="prism language-java"><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    api <span class="token operator">=</span> <span class="token class-name">TessAPI</span><span class="token punctuation">.</span>INSTANCE<span class="token punctuation">;</span>
    handle <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">api<span class="token punctuation">.</span></span>TessBaseAPICreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">StringArray</span> sarray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringArray</span><span class="token punctuation">(</span>configList<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">PointerByReference</span> configs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PointerByReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    configs<span class="token punctuation">.</span><span class="token function">setPointer</span><span class="token punctuation">(</span>sarray<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token namespace">api<span class="token punctuation">.</span></span>TessBaseAPIInit1</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> datapath<span class="token punctuation">,</span> language<span class="token punctuation">,</span> ocrEngineMode<span class="token punctuation">,</span> configs<span class="token punctuation">,</span> configList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>psm <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token namespace">api<span class="token punctuation">.</span></span>TessBaseAPISetPageSegMode</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> psm<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>通过Native方法通过库名称从本地依赖库中加载TessAPI对象：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">TessAPI</span> INSTANCE <span class="token operator">=</span> <span class="token class-name">LoadLibs</span><span class="token punctuation">.</span><span class="token function">getTessAPIInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">TessAPI</span> <span class="token function">getTessAPIInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">TessAPI</span><span class="token punctuation">)</span> <span class="token class-name">Native</span><span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token function">getTesseractLibName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">TessAPI</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>下面是的getTesseractLibName方法的处理逻辑：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> LIB_NAME <span class="token operator">=</span> <span class="token string">"libtesseract400"</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> LIB_NAME_NON_WIN <span class="token operator">=</span> <span class="token string">"tesseract"</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getTesseractLibName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token class-name">Platform</span><span class="token punctuation">.</span><span class="token function">isWindows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> LIB_NAME <span class="token operator">:</span> LIB_NAME_NON_WIN<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>上面的代码表明，Windows系统通过libtesseract400这个name从本地依赖库获取TessAPI对象，其它系统通过tesseract这个name来获取TessAPI对象。<br> 下面是Native类中的方法：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Object</span> <span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Class</span> interfaceClass<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token function">loadLibrary</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> interfaceClass<span class="token punctuation">,</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span>EMPTY_MAP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Object</span> <span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token class-name">Class</span> interfaceClass<span class="token punctuation">,</span><span class="token class-name">Map</span> options<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Library<span class="token punctuation">.</span>Handler</span> handler <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Library<span class="token punctuation">.</span>Handler</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> interfaceClass<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ClassLoader</span> loader <span class="token operator">=</span> interfaceClass<span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Library</span> proxy <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Library</span><span class="token punctuation">)</span><span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>loader<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>interfaceClass<span class="token punctuation">}</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cacheOptions</span><span class="token punctuation">(</span>interfaceClass<span class="token punctuation">,</span> options<span class="token punctuation">,</span> proxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> proxy<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>上面代码通过JDK动态代理来生成interfaceClass的对象。</p> 
<h6><a id="Windows_110"></a>为什么Windows能开箱即用</h6> 
<p>通过上面的代码调用链分析，可以知道代码运行需要调用path路径中名称为libtesseract400的本地库，上面我们引入了下面的依赖：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>net.sourceforge.tess4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>tess4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>打开本地maven仓库(我的是D:\m2\repository)，找到tess4j的jar包：<br> <img src="https://images2.imgbox.com/27/7b/UmjaM6pO_o.png" alt="image.png"><br> 将上面tess4j-4.0.0.jar解压：<br> <img src="https://images2.imgbox.com/b9/63/oUxsNQ9t_o.png" alt="image.png"><br> 进入win32-x86-64目录：<br> <img src="https://images2.imgbox.com/d4/e2/KohECtL7_o.png" alt="image.png"><br> 可以看到tess4j-4.0.0.jar中已经包含了Windows系统需要的dll库，所以可以在Windows系统开箱即用。</p> 
<h5><a id="4linuxITesseract_126"></a>4.linux上运行ITesseract类</h5> 
<h6><a id="tesserac_127"></a>安装tesserac</h6> 
<p>在linux系统上运行Tess4j的代码，首先需要安装leptonica和tesserac，具体安装过程参考：<br> <a href="https://blog.csdn.net/weixin_47914635/article/details/128715110">https://blog.csdn.net/weixin_47914635/article/details/128715110</a>《linux安装tesseract支持tess4j图片识别》<br> 安装目录为：/usr/local，进入tesserac的lib目录：<br> <img src="https://images2.imgbox.com/70/9d/n09e7ysL_o.png" alt="image.png"><br> 可以看到tesserac的so文件。</p> 
<h6><a id="_133"></a>配置环境变量</h6> 
<p>如果运行代码，报如下错误：<br> <img src="https://images2.imgbox.com/bd/69/ojejJAIZ_o.png" alt="image.png"><br> 表示path中找不到tesserac的so文件。从上面的代码调用链分析中可以知道，是下面这段代码出了问题：</p> 
<pre><code class="prism language-java"><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    api <span class="token operator">=</span> <span class="token class-name">TessAPI</span><span class="token punctuation">.</span>INSTANCE<span class="token punctuation">;</span>
    handle <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">api<span class="token punctuation">.</span></span>TessBaseAPICreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">StringArray</span> sarray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringArray</span><span class="token punctuation">(</span>configList<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">PointerByReference</span> configs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PointerByReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    configs<span class="token punctuation">.</span><span class="token function">setPointer</span><span class="token punctuation">(</span>sarray<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token namespace">api<span class="token punctuation">.</span></span>TessBaseAPIInit1</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> datapath<span class="token punctuation">,</span> language<span class="token punctuation">,</span> ocrEngineMode<span class="token punctuation">,</span> configs<span class="token punctuation">,</span> configList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>psm <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token namespace">api<span class="token punctuation">.</span></span>TessBaseAPISetPageSegMode</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> psm<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>即系统无法初始化TessAPI对象，TessAPI对象是通过下面的代码完成的：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> LIB_NAME <span class="token operator">=</span> <span class="token string">"libtesseract400"</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> LIB_NAME_NON_WIN <span class="token operator">=</span> <span class="token string">"tesseract"</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">TessAPI</span> INSTANCE <span class="token operator">=</span> <span class="token class-name">LoadLibs</span><span class="token punctuation">.</span><span class="token function">getTessAPIInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">TessAPI</span> <span class="token function">getTessAPIInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">TessAPI</span><span class="token punctuation">)</span> <span class="token class-name">Native</span><span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token function">getTesseractLibName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">TessAPI</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getTesseractLibName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token class-name">Platform</span><span class="token punctuation">.</span><span class="token function">isWindows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> LIB_NAME <span class="token operator">:</span> LIB_NAME_NON_WIN<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


</code></pre> 
<p>也就是说，需要从path路径中加载tesseract的so文件，需要将tesseract的so文件路径添加到path中。<br> 修改环境变量(vim /etc/profile)：</p> 
<pre><code class="prism language-shell"><span class="token assign-left variable">LD_LIBRARY_PATH</span><span class="token operator">=</span><span class="token variable">$LD_LIBRARY_PATH</span>:/usr/local/leptonica/lib:/usr/local/tesseract/lib
<span class="token builtin class-name">export</span> LD_LIBRARY_PATH
<span class="token assign-left variable">LIBRARY_PATH</span><span class="token operator">=</span><span class="token variable">$LIBRARY_PATH</span>:/usr/local/leptonica/lib:/usr/local/tesseract/lib
<span class="token builtin class-name">export</span> LIBRARY_PATH
<span class="token assign-left variable">LIBLEPT_HEADERSDIR</span><span class="token operator">=</span>/usr/local/leptonica/include/leptonica
<span class="token builtin class-name">export</span> LIBLEPT_HEADERSDIR

<span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span>:/usr/local/tesseract/bin
<span class="token builtin class-name">export</span> <span class="token environment constant">PATH</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">TESSDATA_PREFIX</span><span class="token operator">=</span>/usr/local/tesseract/share/tessdata 
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$TESSDATA_PREFIX</span>
</code></pre> 
<p>让环境变量生效：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">source</span> /etc/profile
</code></pre> 
<p>然后重新运行Tess4j代码。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c18c9eea56da14828dd13d665ca89fe5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux环境搭建OpenCV运行java-cv代码</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e4d2fa68efe3ccecabd07aaaa5fb8430/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">AttributeError: partially initialized module ‘cv2‘ has no attribute ‘gapi_wip_gst_GStreamerPipeline‘</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>