<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python处理图片生成天际线（2024.1.29） - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python处理图片生成天际线（2024.1.29）" />
<meta property="og:description" content="引言 小的时候，自己有一个大大的梦想——让我们生活的世界变得更加美丽、干净和整洁！当我第一次在中学食堂的电视机上看到航天员们登上太空时，内心无比兴奋和向往，从太空回传的影像画面让人不由震惊，印象深刻！
曾经感慨浩瀚无垠的宇宙不知有多么宽广，流星为何会从夜空滑落，陨石又不知何时从天空坠落地坑，古人也在抬头夜观天象、探讨天圆地方的过程中，也能启发思维、浮现灵感、激发创造力，作为来者的我们在现代化社会更应该学会深入思考，学思结合。正所谓：学而不思则罔，思而不学则怠。
潮涨潮落，云卷云舒，黑夜白昼，四季交替，世间万物，自然更新，在规律中暗含不确定性，在不规律中似有玄机。人类在探索真理、改造和利用自然的过程中，逐渐认识自己、认识外物、认识自然、认识世界，在认识的过程中坚持走出去与引进来相结合，说者容易做者困难。
1、天际线简介 天际线（SkyLine）顾名思义就是天空与地面的边界线，人站在不同的高度，会看到不同的景色和地平线，天空与地面建筑物分离的标记线，不得不说，每天抬头仰望天空，相信大家都可以看到，它的的确确客观存在，美丽值得欣赏。
2、Python代码 #-*- coding:utf-8 -*- import sys from os.path import exists import cv2 import numpy as np def getImage(height, width, channels): image = np.zeros([height, width, 3], np.uint8) # 三通道顺序是BGR # 三层循环逐个修改像素点 for row in range(height): for col in range(width): for c in range(channels): image[row, col, c] = 0 return image def isWhite(pixel_value, threshold): #阈值可以取10、20、30、50、100 res = False if pixel_value[0] &gt; threshold and pixel_value[1] &gt; threshold and pixel_value[2] &gt; threshold: # 10、10、10 50、50、50 这里是天空和地面楼山的分界线，需要调参 res = True return res def isPureWhite(pixel_value): res = False if pixel_value[0] == 255 and pixel_value[1] == 255 and pixel_value[2] == 255: # &gt;3|&gt;3|&gt;3 10、10、10 res = True return res def getRowNumberSpecificCol(image, col): res_row = -1 height, width = image." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/5aea74ff8c82d4a78e5ecbe9ca41034a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-02-07T14:53:20+08:00" />
<meta property="article:modified_time" content="2024-02-07T14:53:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python处理图片生成天际线（2024.1.29）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_2"></a>引言</h2> 
<p>        小的时候，自己有一个大大的梦想——让我们生活的世界变得更加<code>美丽、干净和整洁</code>！当我第一次在中学食堂的电视机上看到航天员们登上太空时，内心无比兴奋和向往，从太空回传的影像画面让人不由震惊，印象深刻！</p> 
<p>        曾经感慨浩瀚无垠的宇宙不知有多么宽广，流星为何会从夜空滑落，陨石又不知何时从天空坠落地坑，古人也在抬头夜观天象、探讨天圆地方的过程中，也能启发思维、浮现灵感、激发创造力，作为来者的我们在现代化社会更应该学会深入思考，学思结合。正所谓：<mark>学而不思则罔，思而不学则怠</mark>。</p> 
<p>        潮涨潮落，云卷云舒，黑夜白昼，四季交替，世间万物，自然更新，在规律中暗含不确定性，在不规律中似有玄机。人类在探索真理、改造和利用自然的过程中，逐渐认识自己、认识外物、认识自然、认识世界，在认识的过程中<strong>坚持走出去与引进来相结合</strong>，说者容易做者困难。</p> 
<h2><a id="1_9"></a>1、天际线简介</h2> 
<p>        <strong>天际线</strong>（<code>SkyLine</code>）顾名思义就是<strong>天空与地面的边界线</strong>，人站在不同的高度，会看到不同的景色和地平线，天空与地面建筑物分离的标记线，不得不说，每天抬头仰望天空，相信大家都可以看到，它的的确确客观存在，美丽值得欣赏。</p> 
<h2><a id="2Python_12"></a>2、Python代码</h2> 
<pre><code class="prism language-python"><span class="token comment">#-*- coding:utf-8 -*-</span>
<span class="token keyword">import</span> sys
<span class="token keyword">from</span> os<span class="token punctuation">.</span>path <span class="token keyword">import</span> exists
<span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token keyword">def</span> <span class="token function">getImage</span><span class="token punctuation">(</span>height<span class="token punctuation">,</span> width<span class="token punctuation">,</span> channels<span class="token punctuation">)</span><span class="token punctuation">:</span>
    image <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span>height<span class="token punctuation">,</span> width<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span> <span class="token comment"># 三通道顺序是BGR</span>
    <span class="token comment"># 三层循环逐个修改像素点</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>channels<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    image<span class="token punctuation">[</span>row<span class="token punctuation">,</span> col<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">return</span> image

<span class="token keyword">def</span> <span class="token function">isWhite</span><span class="token punctuation">(</span>pixel_value<span class="token punctuation">,</span> threshold<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#阈值可以取10、20、30、50、100</span>
    res <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">if</span> pixel_value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> threshold <span class="token keyword">and</span> pixel_value<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> threshold <span class="token keyword">and</span> pixel_value<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> threshold<span class="token punctuation">:</span> <span class="token comment"># 10、10、10 50、50、50 这里是天空和地面楼山的分界线，需要调参</span>
        res <span class="token operator">=</span> <span class="token boolean">True</span>
    <span class="token keyword">return</span> res

<span class="token keyword">def</span> <span class="token function">isPureWhite</span><span class="token punctuation">(</span>pixel_value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">if</span> pixel_value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">255</span> <span class="token keyword">and</span> pixel_value<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">255</span> <span class="token keyword">and</span> pixel_value<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">:</span> <span class="token comment"># &gt;3|&gt;3|&gt;3 10、10、10</span>
        res <span class="token operator">=</span> <span class="token boolean">True</span>
    <span class="token keyword">return</span> res

<span class="token keyword">def</span> <span class="token function">getRowNumberSpecificCol</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res_row <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
    height<span class="token punctuation">,</span> width <span class="token operator">=</span> image<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> col <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token keyword">and</span> col <span class="token operator">&lt;</span> width<span class="token punctuation">:</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">:</span>
            pv <span class="token operator">=</span> image<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>pv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> pv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> pv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                res_row <span class="token operator">=</span> row
                <span class="token keyword">break</span>
    <span class="token keyword">return</span> res_row

<span class="token keyword">def</span> <span class="token function">getEnhancedEdgeImageFromEdgeImage</span><span class="token punctuation">(</span>edge_Image<span class="token punctuation">)</span><span class="token punctuation">:</span>
    edge_SrcImage <span class="token operator">=</span> edge_Image
    height<span class="token punctuation">,</span> width <span class="token operator">=</span> edge_SrcImage<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">:</span>
            pixel_value <span class="token operator">=</span> edge_SrcImage<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span>  <span class="token comment"># 计算红绿蓝三波段的平均值</span>
            <span class="token keyword">if</span> isPureWhite<span class="token punctuation">(</span>pixel_value<span class="token punctuation">)</span><span class="token punctuation">:</span>
                r_last <span class="token operator">=</span> getRowNumberSpecificCol<span class="token punctuation">(</span>edge_SrcImage<span class="token punctuation">,</span> col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> r_last<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> row <span class="token operator">&gt;</span> r_last<span class="token punctuation">:</span>
                        minR<span class="token punctuation">,</span> maxR <span class="token operator">=</span> r_last<span class="token punctuation">,</span> row
                        <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>minR<span class="token punctuation">,</span> maxR<span class="token punctuation">)</span><span class="token punctuation">:</span>
                            edge_SrcImage<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span>
                            edge_SrcImage<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span>
                            edge_SrcImage<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span>
                    <span class="token keyword">else</span><span class="token punctuation">:</span>
                        minR<span class="token punctuation">,</span> maxR <span class="token operator">=</span> row<span class="token punctuation">,</span> r_last
                        <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>minR<span class="token punctuation">,</span> maxR<span class="token punctuation">)</span><span class="token punctuation">:</span>
                            edge_SrcImage<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span>
                            edge_SrcImage<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span>
                            edge_SrcImage<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span>
    <span class="token comment"># cv2.imshow("Enhanced-edge-image", edge_SrcImage)</span>
    <span class="token keyword">return</span> edge_SrcImage

<span class="token keyword">def</span> <span class="token function">getFileExtensionname</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res <span class="token operator">=</span> <span class="token string">".png"</span>
    dot_index <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> filename<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'.'</span><span class="token punctuation">:</span>
            dot_index <span class="token operator">=</span> i
            <span class="token keyword">break</span>
    <span class="token keyword">if</span> dot_index <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
        res <span class="token operator">=</span> filename<span class="token punctuation">[</span>dot_index<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> res

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    origin_pic_filename <span class="token operator">=</span> <span class="token string">"D:/test.png"</span>
    sky_ground_threshold <span class="token operator">=</span> <span class="token number">30</span>
    isDownSampling <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        origin_pic_filename <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">elif</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        origin_pic_filename <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        origin_pic_filename <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        sky_ground_threshold <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        origin_pic_filename <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        sky_ground_threshold <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            isDownSampling <span class="token operator">=</span> <span class="token boolean">True</span>
    <span class="token keyword">if</span> origin_pic_filename <span class="token operator">!=</span> <span class="token string">""</span> <span class="token keyword">and</span> sky_ground_threshold <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"输入图片文件名为：{0}"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>origin_pic_filename<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"天空地面分界灰度阈值为：{0}"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>sky_ground_threshold<span class="token punctuation">)</span><span class="token punctuation">)</span>
        suffix_name <span class="token operator">=</span> getFileExtensionname<span class="token punctuation">(</span>origin_pic_filename<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"后缀名为：{0}"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>suffix_name<span class="token punctuation">)</span><span class="token punctuation">)</span>

        srcImage <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>origin_pic_filename<span class="token punctuation">)</span>
        inputSrcImage <span class="token operator">=</span> srcImage
        <span class="token keyword">if</span> isDownSampling<span class="token punctuation">:</span>
            inputSrcImage <span class="token operator">=</span> cv2<span class="token punctuation">.</span>pyrDown<span class="token punctuation">(</span>inputSrcImage<span class="token punctuation">)</span>
        height<span class="token punctuation">,</span> width <span class="token operator">=</span> inputSrcImage<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"高度：{0}, 宽度：{1}"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>height<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>namedWindow<span class="token punctuation">(</span><span class="token string">'downsampling-image'</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>WINDOW_AUTOSIZE<span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"downsampling-image"</span><span class="token punctuation">,</span> inputSrcImage<span class="token punctuation">)</span>
        Sobelx <span class="token operator">=</span> cv2<span class="token punctuation">.</span>Sobel<span class="token punctuation">(</span>inputSrcImage<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>CV_64F<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        Sobely <span class="token operator">=</span> cv2<span class="token punctuation">.</span>Sobel<span class="token punctuation">(</span>inputSrcImage<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>CV_64F<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        Sobelx <span class="token operator">=</span> cv2<span class="token punctuation">.</span>convertScaleAbs<span class="token punctuation">(</span>Sobelx<span class="token punctuation">)</span>
        Sobely <span class="token operator">=</span> cv2<span class="token punctuation">.</span>convertScaleAbs<span class="token punctuation">(</span>Sobely<span class="token punctuation">)</span>
        <span class="token comment"># cv2.imshow("sobel-x-Abs", Sobelx)</span>
        <span class="token comment"># cv2.imshow("sobel-y-Abs", Sobely)</span>
        Sobelxy <span class="token operator">=</span> cv2<span class="token punctuation">.</span>addWeighted<span class="token punctuation">(</span>Sobelx<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> Sobely<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>namedWindow<span class="token punctuation">(</span><span class="token string">'sobel-xy'</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>WINDOW_AUTOSIZE<span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'sobel-xy'</span><span class="token punctuation">,</span> Sobelxy<span class="token punctuation">)</span>
        edgeImage <span class="token operator">=</span> getImage<span class="token punctuation">(</span>height<span class="token punctuation">,</span> width<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">:</span>
                pixel_value <span class="token operator">=</span> Sobelxy<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span>  <span class="token comment"># 计算红绿蓝三波段的平均值</span>
                <span class="token keyword">if</span> isWhite<span class="token punctuation">(</span>pixel_value<span class="token punctuation">,</span> sky_ground_threshold<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    edgeImage<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span>
                    edgeImage<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span>
                    edgeImage<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span>
                    <span class="token keyword">break</span>
        cv2<span class="token punctuation">.</span>namedWindow<span class="token punctuation">(</span><span class="token string">'edge-image'</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>WINDOW_AUTOSIZE<span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'edge-image'</span><span class="token punctuation">,</span> edgeImage<span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>origin_pic_filename<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>suffix_name<span class="token punctuation">,</span> <span class="token string">"-ZGetEdge.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> edgeImage<span class="token punctuation">)</span>
        enhanced_edgeImage <span class="token operator">=</span> getEnhancedEdgeImageFromEdgeImage<span class="token punctuation">(</span>edgeImage<span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>namedWindow<span class="token punctuation">(</span><span class="token string">'enhanced-edge-image'</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>WINDOW_AUTOSIZE<span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'enhanced-edge-image'</span><span class="token punctuation">,</span> enhanced_edgeImage<span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>origin_pic_filename<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>suffix_name<span class="token punctuation">,</span> <span class="token string">"-EnhancedEdge.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> enhanced_edgeImage<span class="token punctuation">)</span>

        <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">:</span>
                pixel_value <span class="token operator">=</span> enhanced_edgeImage<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span>  <span class="token comment"># 计算红绿蓝三波段的平均值</span>
                <span class="token keyword">if</span> isPureWhite<span class="token punctuation">(</span>pixel_value<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">if</span> row<span class="token operator">+</span><span class="token number">2</span> <span class="token operator">&lt;</span> height<span class="token punctuation">:</span>
                        inputSrcImage<span class="token punctuation">[</span>row<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
                        inputSrcImage<span class="token punctuation">[</span>row<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
                        inputSrcImage<span class="token punctuation">[</span>row<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span>
                    <span class="token keyword">else</span><span class="token punctuation">:</span>
                        inputSrcImage<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
                        inputSrcImage<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
                        inputSrcImage<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span>
                    <span class="token comment"># inputSrcImage[row][col][0] = 0</span>
                    <span class="token comment"># inputSrcImage[row][col][1] = 0</span>
                    <span class="token comment"># inputSrcImage[row][col][2] = 255</span>
                    <span class="token comment"># break #最开始从每列遍历从上到下找第一个分界点就停止才用break</span>

        cv2<span class="token punctuation">.</span>namedWindow<span class="token punctuation">(</span><span class="token string">'RedEdge-image'</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>WINDOW_AUTOSIZE<span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'RedEdge-image'</span><span class="token punctuation">,</span> inputSrcImage<span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>origin_pic_filename<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>suffix_name<span class="token punctuation">,</span> <span class="token string">"-RedEdge.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> inputSrcImage<span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Success!'</span><span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="3_172"></a>3、运行结果</h2> 
<p>        <a href="http://pic1.win4000.com/wallpaper/2018-09-30/5bb098d8e6993.jpg" rel="nofollow">test.jpg下载</a></p> 
<h3><a id="31__175"></a>3.1 非下采样+边缘检测</h3> 
<pre><code class="prism language-cpp">python GetSkyLine<span class="token punctuation">.</span>py test<span class="token punctuation">.</span>jpg  <span class="token number">100</span>
</code></pre> 
<table><tbody><tr><td> <img src="https://images2.imgbox.com/2f/57/KqpLVDl6_o.png" width="100%"> 
    <center> 
     <strong>原始图片</strong> 
    </center> </td><td> <img src="https://images2.imgbox.com/b9/68/5bxEYUco_o.png" width="100%"> 
    <center> 
     <strong>边缘点图片</strong> 
    </center> </td></tr><tr><td> <img src="https://images2.imgbox.com/c2/38/17OISER5_o.png" width="100%"> 
    <center> 
     <strong>边缘增强图片</strong> 
    </center> </td><td> <img src="https://images2.imgbox.com/1d/02/prj7Evwo_o.png" width="100%"> 
    <center> 
     <strong>sobel-xy处理后图片</strong> 
    </center> </td></tr><tr><td> <img src="https://images2.imgbox.com/83/b4/0jmZQrk1_o.png" width="100%"> 
    <center> 
     <strong>downloadsampling图片</strong> 
    </center> </td><td> <img src="https://images2.imgbox.com/10/53/DF61H4hH_o.png" width="100%"> 
    <center> 
     <strong>红色边缘叠加图片</strong> 
    </center> </td></tr></tbody></table> 
<h3><a id="32__213"></a>3.2 下采样+边缘检测</h3> 
<pre><code class="prism language-cpp">python GetSkyLine<span class="token punctuation">.</span>py test<span class="token punctuation">.</span>jpg  <span class="token number">50</span>  <span class="token number">1</span>
</code></pre> 
<img src="https://images2.imgbox.com/81/53/BWd5GHOY_o.png" width="100%"> 
<center> 
 <strong>原始图片</strong> 
</center> 
<table><tbody><tr><td> <img src="https://images2.imgbox.com/98/cd/yoEZoP4z_o.png" width="100%"> 
    <center> 
     <strong>边缘点图片</strong> 
    </center> </td><td> <img src="https://images2.imgbox.com/e3/88/r0rcmgyR_o.png" width="100%"> 
    <center> 
     <strong>边缘增强图片</strong> 
    </center> </td></tr><tr><td> <img src="https://images2.imgbox.com/27/25/xXru0R99_o.png" width="100%"> 
    <center> 
     <strong>downloadsampling图片</strong> 
    </center> </td><td> <img src="https://images2.imgbox.com/4a/1c/Pfsstfme_o.png" width="100%"> 
    <center> 
     <strong>sobel-xy处理后图片</strong> 
    </center> </td></tr><tr></tr></tbody></table> 
<img src="https://images2.imgbox.com/40/c5/hLSyrM1B_o.png" width="100%"> 
<center> 
 <strong>红色边缘叠加图片</strong> 
</center> 
<h2><a id="4_250"></a>4、小结</h2> 
<p>        在这个人世间，每个人都是独立的个体，身处浩荡洪流之中，难免身不由己，时而坚定，时而困惑，但我们还是应该永远相信美好的事情终将发生，要心怀一颗感恩的心，相信家人，相信自己，相信未来，坦然面对生活，接受平凡。</p> 
<p>       <mark>关关难过关关过，前路漫漫亦灿灿</mark>！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a1ea41e579379a2cc302cdeaa4145f5e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vtkSliderWidget动态调整vtkCellLocator空间单元切分level</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fc71491434b8687e57d8207faba626c1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">FPGA通信——USB2.0（CY7C68013）使用记录</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>