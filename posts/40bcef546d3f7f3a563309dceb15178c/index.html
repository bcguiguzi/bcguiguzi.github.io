<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>åµŒå…¥å¼å¤–è®¾é›† -- è¯­éŸ³æ’­æŠ¥æ¨¡å—ï¼ˆJR6001ï¼‰ - ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="åµŒå…¥å¼å¤–è®¾é›† -- è¯­éŸ³æ’­æŠ¥æ¨¡å—ï¼ˆJR6001ï¼‰" />
<meta property="og:description" content="ç›®å½•
ä¸€ã€æ¨¡å—ä»‹ç»
å…³æ³¨å¾®ä¿¡å…¬ä¼—å·--æ˜Ÿä¹‹æ´å·¥ä½œå®¤ å‘é€å…³é”®å­—ï¼ˆJR6001ï¼‰
ä½¿ç”¨çš„æ³¨æ„äº‹é¡¹
äºŒã€ç§»æ¤ä½¿ç”¨ï¼ˆèµ„æ–™ä»£ç ä¸­æ²¡æœ‰ç§»æ¤åçš„ä»£ç ï¼Œéœ€è¦è‡ªè¡Œç§»æ¤ï¼‰
1.ä¸²å£é…ç½®
usart2.c
usart2.h
2.JR6001çš„åŠŸèƒ½ä»£ç ç¼–å†™
JR6001.c
JR6001.h
ä¸‰ã€å‚è€ƒ
ä¸€ã€æ¨¡å—ä»‹ç» JR6001æ˜¯ä¸€ç§è¯­éŸ³æ’­æ”¾æ¨¡å—ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š
1. è‡ªå¸¦USBæ¥å£ï¼Œå¯ä»¥çµæ´»åœ°æ›¿æ¢SPI-flashä¸­çš„è¯­éŸ³å†…å®¹ï¼Œæ— éœ€å®‰è£…ä¸»æœºç”µè„‘æ¥æ›¿æ¢ä¼ ç»Ÿè¯­éŸ³èŠ¯ç‰‡çš„è¯­éŸ³ã€‚SPI FLASHç›´æ¥æ¨¡æ‹Ÿä¸ºUç›˜ï¼Œå°±åƒå¤åˆ¶Uç›˜ä¸€æ ·ï¼Œéå¸¸æ–¹ä¾¿ã€‚ä»»ä½•è®¡ç®—æœºç³»ç»Ÿéƒ½å¯ä»¥æ”¯æŒå®ƒã€7â€ sourceã€‘ã€‚
2. æ”¯æŒMP3ã€WAVé«˜è´¨é‡éŸ³é¢‘æ ¼å¼ï¼Œå£°éŸ³ä¼˜ç¾ã€‚
3. 24ä½DACè¾“å‡ºï¼ŒåŠ¨æ€èŒƒå›´æ”¯æŒ90dBï¼Œä¿¡å·æ¯”85dBã€‚
4. æ”¯æŒä¸¤çº¿ä¸²å£æ§åˆ¶ï¼ŒADæ§åˆ¶ã€‚
5. USBæ›´æ–°è¯­éŸ³æ–‡ä»¶ï¼Œæ— éœ€å®‰è£…é©±åŠ¨ç¨‹åºï¼Œæ— éœ€å®‰è£…è½¯ä»¶ï¼Œç›´æ¥å¤åˆ¶ï¼Œå¿«é€Ÿæ–¹ä¾¿ã€‚æ”¯æŒXPç³»ç»Ÿï¼ŒWIN7ï¼ŒWIN8ï¼ŒWIN10ç³»ç»Ÿã€‚
6. æ”¯æŒä¸Šä¸€é¦–æ­Œï¼Œä¸‹ä¸€é¦–æ­Œï¼Œæ’­æ”¾ï¼Œæš‚åœï¼Œåœæ­¢ï¼Œé€‰æ­Œï¼Œå’Œå…¶ä»–å¸¸è§åŠŸèƒ½æ§åˆ¶ã€‚ 7. æ”¯æŒè‡ªç”±ç»„åˆæ’­æ”¾ã€‚ 8. æ”¯æŒ30çº§éŸ³é‡è°ƒæ•´ã€‚
9. æ”¯æŒå‘¨æœŸå·è®¾ç½®ï¼Œæ›´å¤šåº”ç”¨ï¼Œæ›´äººæ€§åŒ–ã€‚
10. ä¸“ç”¨BUSYä¿¡å·è¾“å‡ºæŒ‡ç¤ºã€‚
11. æˆç†Ÿçš„æŒ‡ä»¤å’ŒæŒ‡ä»¤åˆ†æä½¿åº”ç”¨æ›´ç¨³å®šã€‚
12. ä¸“ç”¨æ”¯æŒä¸»æœºç”µè„‘ï¼Œå¿«é€Ÿä½¿ç”¨ï¼Œæ˜“äºè°ƒè¯•ï¼Œå‘½ä»¤è‡ªåŠ¨ç”Ÿæˆã€8â€ sourceã€‘ã€‚
å…³æ³¨å¾®ä¿¡å…¬ä¼—å·--æ˜Ÿä¹‹æ´å·¥ä½œå®¤ å‘é€å…³é”®å­—ï¼ˆJR6001ï¼‰ â¡ï¸ğŸ«¡ğŸ«¡ğŸ«¡ğŸ«¡ğŸ«¡ğŸ«¡ğŸ«¡ğŸ«¡â¡ï¸
ä½¿ç”¨çš„æ³¨æ„äº‹é¡¹ 1.åªéœ€è¦é…ç½®ä¸€ä¸ªä¸²å£å³å¯ï¼Œæ³¢ç‰¹ç‡ä¸º9600
äºŒã€ç§»æ¤ä½¿ç”¨ï¼ˆèµ„æ–™ä»£ç ä¸­æ²¡æœ‰ç§»æ¤åçš„ä»£ç ï¼Œéœ€è¦è‡ªè¡Œç§»æ¤ï¼‰ 1.ä¸²å£é…ç½® usart2.c å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„JR6001æ¨¡å—æ˜¯éœ€è¦ä½¿ç”¨ä¸²å£è¿›è¡Œé€šä¿¡æ§åˆ¶ï¼ˆè¯¦æƒ…å¯åœ¨è·å–çš„èµ„æ–™ä¸­æŸ¥çœ‹ï¼‰ï¼Œæˆ‘ä»¬åªéœ€è¦ç”¨åˆ°è¯¥ä¸²å£çš„å‘é€ç«¯å£å³å¯ï¼Œä¸éœ€è¦å¤„ç†JR6001å›ä¼ çš„æ•°æ®ï¼Œæ‰€ä»¥æ¥æ”¶ä¸­æ–­ä¸­çš„æ•°æ®å¤„ç†å¯ç•¥è¿‡ ~~Â ï¼ˆå¼•ç”¨GPSçš„ä¸²å£é…ç½®ï¼‰
#include &#34;delay.h&#34; #include &#34;usart2.h&#34; #include &#34;stdarg.h&#34; #include &#34;stdio.h&#34; #include &#34;string.h&#34; char rxdatabufer; u16 point1 = 0; _SaveData Save_Data; #if EN_USART2_RX // å¦‚æœä½¿èƒ½äº†æ¥æ”¶ // ä¸²å£1ä¸­æ–­æœåŠ¡ç¨‹åº // æ³¨æ„,è¯»å–USARTx-&gt;SRèƒ½é¿å…è«åå…¶å¦™çš„é”™è¯¯ char USART_RX2_BUF[USART2_REC_LEN]; // æ¥æ”¶ç¼“å†²,æœ€å¤§USART_REC_LENä¸ªå­—èŠ‚." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/40bcef546d3f7f3a563309dceb15178c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-08T10:43:30+08:00" />
<meta property="article:modified_time" content="2023-12-08T10:43:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">åµŒå…¥å¼å¤–è®¾é›† -- è¯­éŸ³æ’­æŠ¥æ¨¡å—ï¼ˆJR6001ï¼‰</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>ç›®å½•</strong></p> 
<p id="%E6%A8%A1%E5%9D%97%E4%BB%8B%E7%BB%8D-toc" style="margin-left:0px;"><a href="#%E6%A8%A1%E5%9D%97%E4%BB%8B%E7%BB%8D" rel="nofollow">ä¸€ã€æ¨¡å—ä»‹ç»</a></p> 
<p id="%E5%85%B3%E6%B3%A8%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7--%E6%98%9F%E4%B9%8B%E6%8F%B4%E5%B7%A5%E4%BD%9C%E5%AE%A4%20%E5%8F%91%E9%80%81%E5%85%B3%E9%94%AE%E5%AD%97%EF%BC%88360%E6%97%8B%E9%92%AE%E7%BC%96%E7%A0%81%E5%99%A8%EF%BC%89-toc" style="margin-left:40px;"><a href="#%E5%85%B3%E6%B3%A8%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7--%E6%98%9F%E4%B9%8B%E6%8F%B4%E5%B7%A5%E4%BD%9C%E5%AE%A4%20%E5%8F%91%E9%80%81%E5%85%B3%E9%94%AE%E5%AD%97%EF%BC%88360%E6%97%8B%E9%92%AE%E7%BC%96%E7%A0%81%E5%99%A8%EF%BC%89" rel="nofollow">å…³æ³¨å¾®ä¿¡å…¬ä¼—å·--æ˜Ÿä¹‹æ´å·¥ä½œå®¤ å‘é€å…³é”®å­—ï¼ˆJR6001ï¼‰</a></p> 
<p id="%C2%A0%E4%BD%BF%E7%94%A8%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-toc" style="margin-left:40px;"><a href="#%C2%A0%E4%BD%BF%E7%94%A8%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" rel="nofollow">ä½¿ç”¨çš„æ³¨æ„äº‹é¡¹</a></p> 
<p id="%E7%A7%BB%E6%A4%8D%E4%BD%BF%E7%94%A8%EF%BC%88%E8%B5%84%E6%96%99%E4%BB%A3%E7%A0%81%E4%B8%AD%E6%B2%A1%E6%9C%89%E7%A7%BB%E6%A4%8D%E5%90%8E%E7%9A%84%E4%BB%A3%E7%A0%81%EF%BC%8C%E9%9C%80%E8%A6%81%E8%87%AA%E8%A1%8C%E7%A7%BB%E6%A4%8D%EF%BC%89-toc" style="margin-left:0px;"><a href="#%E7%A7%BB%E6%A4%8D%E4%BD%BF%E7%94%A8%EF%BC%88%E8%B5%84%E6%96%99%E4%BB%A3%E7%A0%81%E4%B8%AD%E6%B2%A1%E6%9C%89%E7%A7%BB%E6%A4%8D%E5%90%8E%E7%9A%84%E4%BB%A3%E7%A0%81%EF%BC%8C%E9%9C%80%E8%A6%81%E8%87%AA%E8%A1%8C%E7%A7%BB%E6%A4%8D%EF%BC%89" rel="nofollow">äºŒã€ç§»æ¤ä½¿ç”¨ï¼ˆèµ„æ–™ä»£ç ä¸­æ²¡æœ‰ç§»æ¤åçš„ä»£ç ï¼Œéœ€è¦è‡ªè¡Œç§»æ¤ï¼‰</a></p> 
<p id="1.%E4%B8%B2%E5%8F%A3%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px;"><a href="#1.%E4%B8%B2%E5%8F%A3%E9%85%8D%E7%BD%AE" rel="nofollow">1.ä¸²å£é…ç½®</a></p> 
<p id="usart2.c-toc" style="margin-left:80px;"><a href="#usart2.c" rel="nofollow">usart2.c</a></p> 
<p id="usart2.h-toc" style="margin-left:80px;"><a href="#usart2.h" rel="nofollow">usart2.h</a></p> 
<p id="2.GA6-B%E7%9A%84%E5%8A%9F%E8%83%BD%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99-toc" style="margin-left:40px;"><a href="#2.GA6-B%E7%9A%84%E5%8A%9F%E8%83%BD%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99" rel="nofollow">2.JR6001çš„åŠŸèƒ½ä»£ç ç¼–å†™</a></p> 
<p id="JR6001.c-toc" style="margin-left:80px;"><a href="#JR6001.c" rel="nofollow">JR6001.c</a></p> 
<p id="JR6001.h-toc" style="margin-left:80px;"><a href="#JR6001.h" rel="nofollow">JR6001.h</a></p> 
<p id="%E4%B8%89%E3%80%81%E5%8F%82%E8%80%83-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81%E5%8F%82%E8%80%83" rel="nofollow">ä¸‰ã€å‚è€ƒ</a></p> 
<p></p> 
<p id="JR6001.h-toc" style="margin-left:80px;"></p> 
<hr> 
<h2 id="%E6%A8%A1%E5%9D%97%E4%BB%8B%E7%BB%8D" style="background-color:transparent;">ä¸€ã€æ¨¡å—ä»‹ç»</h2> 
<blockquote> 
 <p>JR6001æ˜¯ä¸€ç§è¯­éŸ³æ’­æ”¾æ¨¡å—ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p> 
 <p>1. è‡ªå¸¦USBæ¥å£ï¼Œå¯ä»¥çµæ´»åœ°æ›¿æ¢SPI-flashä¸­çš„è¯­éŸ³å†…å®¹ï¼Œæ— éœ€å®‰è£…ä¸»æœºç”µè„‘æ¥æ›¿æ¢ä¼ ç»Ÿè¯­éŸ³èŠ¯ç‰‡çš„è¯­éŸ³ã€‚SPI FLASHç›´æ¥æ¨¡æ‹Ÿä¸ºUç›˜ï¼Œå°±åƒå¤åˆ¶Uç›˜ä¸€æ ·ï¼Œéå¸¸æ–¹ä¾¿ã€‚ä»»ä½•è®¡ç®—æœºç³»ç»Ÿéƒ½å¯ä»¥æ”¯æŒå®ƒã€7â€ sourceã€‘ã€‚</p> 
 <p>2. æ”¯æŒMP3ã€WAVé«˜è´¨é‡éŸ³é¢‘æ ¼å¼ï¼Œå£°éŸ³ä¼˜ç¾ã€‚</p> 
 <p>3. 24ä½DACè¾“å‡ºï¼ŒåŠ¨æ€èŒƒå›´æ”¯æŒ90dBï¼Œä¿¡å·æ¯”85dBã€‚</p> 
 <p>4. æ”¯æŒä¸¤çº¿ä¸²å£æ§åˆ¶ï¼ŒADæ§åˆ¶ã€‚</p> 
 <p>5. USBæ›´æ–°è¯­éŸ³æ–‡ä»¶ï¼Œæ— éœ€å®‰è£…é©±åŠ¨ç¨‹åºï¼Œæ— éœ€å®‰è£…è½¯ä»¶ï¼Œç›´æ¥å¤åˆ¶ï¼Œå¿«é€Ÿæ–¹ä¾¿ã€‚æ”¯æŒXPç³»ç»Ÿï¼ŒWIN7ï¼ŒWIN8ï¼ŒWIN10ç³»ç»Ÿã€‚</p> 
 <p>6. æ”¯æŒä¸Šä¸€é¦–æ­Œï¼Œä¸‹ä¸€é¦–æ­Œï¼Œæ’­æ”¾ï¼Œæš‚åœï¼Œåœæ­¢ï¼Œé€‰æ­Œï¼Œå’Œå…¶ä»–å¸¸è§åŠŸèƒ½æ§åˆ¶ã€‚ 7. æ”¯æŒè‡ªç”±ç»„åˆæ’­æ”¾ã€‚ 8. æ”¯æŒ30çº§éŸ³é‡è°ƒæ•´ã€‚</p> 
 <p>9. æ”¯æŒå‘¨æœŸå·è®¾ç½®ï¼Œæ›´å¤šåº”ç”¨ï¼Œæ›´äººæ€§åŒ–ã€‚</p> 
 <p>10. ä¸“ç”¨BUSYä¿¡å·è¾“å‡ºæŒ‡ç¤ºã€‚</p> 
 <p>11. æˆç†Ÿçš„æŒ‡ä»¤å’ŒæŒ‡ä»¤åˆ†æä½¿åº”ç”¨æ›´ç¨³å®šã€‚</p> 
 <p>12. ä¸“ç”¨æ”¯æŒä¸»æœºç”µè„‘ï¼Œå¿«é€Ÿä½¿ç”¨ï¼Œæ˜“äºè°ƒè¯•ï¼Œå‘½ä»¤è‡ªåŠ¨ç”Ÿæˆã€8â€ sourceã€‘ã€‚</p> 
</blockquote> 
<p class="img-center"><img alt="" height="370" src="https://images2.imgbox.com/92/27/kPSqZH2c_o.png" width="616"></p> 
<hr> 
<h3 id="%E5%85%B3%E6%B3%A8%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7--%E6%98%9F%E4%B9%8B%E6%8F%B4%E5%B7%A5%E4%BD%9C%E5%AE%A4%20%E5%8F%91%E9%80%81%E5%85%B3%E9%94%AE%E5%AD%97%EF%BC%88360%E6%97%8B%E9%92%AE%E7%BC%96%E7%A0%81%E5%99%A8%EF%BC%89"><span style="color:#fe2c24;"><strong>å…³æ³¨å¾®ä¿¡å…¬ä¼—å·--æ˜Ÿä¹‹æ´å·¥ä½œå®¤ å‘é€å…³é”®å­—ï¼ˆJR6001ï¼‰</strong></span></h3> 
<blockquote> 
 <p><strong>â¡ï¸ğŸ«¡ğŸ«¡ğŸ«¡ğŸ«¡ğŸ«¡ğŸ«¡ğŸ«¡ğŸ«¡</strong><strong>â¡ï¸</strong></p> 
 <p><img alt="" height="328" src="https://images2.imgbox.com/82/ab/mTFlshEm_o.png" width="865"></p> 
</blockquote> 
<h3 id="%C2%A0%E4%BD%BF%E7%94%A8%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" style="background-color:transparent;">ä½¿ç”¨çš„æ³¨æ„äº‹é¡¹</h3> 
<blockquote> 
 <p>1.åªéœ€è¦é…ç½®ä¸€ä¸ªä¸²å£å³å¯ï¼Œæ³¢ç‰¹ç‡ä¸º9600</p> 
</blockquote> 
<h2 id="%E7%A7%BB%E6%A4%8D%E4%BD%BF%E7%94%A8%EF%BC%88%E8%B5%84%E6%96%99%E4%BB%A3%E7%A0%81%E4%B8%AD%E6%B2%A1%E6%9C%89%E7%A7%BB%E6%A4%8D%E5%90%8E%E7%9A%84%E4%BB%A3%E7%A0%81%EF%BC%8C%E9%9C%80%E8%A6%81%E8%87%AA%E8%A1%8C%E7%A7%BB%E6%A4%8D%EF%BC%89" style="background-color:transparent;">äºŒã€ç§»æ¤ä½¿ç”¨ï¼ˆèµ„æ–™ä»£ç ä¸­æ²¡æœ‰ç§»æ¤åçš„ä»£ç ï¼Œéœ€è¦è‡ªè¡Œç§»æ¤ï¼‰</h2> 
<h3 id="1.%E4%B8%B2%E5%8F%A3%E9%85%8D%E7%BD%AE">1.ä¸²å£é…ç½®</h3> 
<h4 id="usart2.c">usart2.c</h4> 
<blockquote> 
 <p>å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„JR6001æ¨¡å—æ˜¯éœ€è¦ä½¿ç”¨ä¸²å£è¿›è¡Œé€šä¿¡æ§åˆ¶ï¼ˆè¯¦æƒ…å¯åœ¨è·å–çš„èµ„æ–™ä¸­æŸ¥çœ‹ï¼‰ï¼Œ<span style="color:#fe2c24;"><strong>æˆ‘ä»¬åªéœ€è¦ç”¨åˆ°è¯¥ä¸²å£çš„å‘é€ç«¯å£å³å¯ï¼Œä¸éœ€è¦å¤„ç†JR6001å›ä¼ çš„æ•°æ®ï¼Œæ‰€ä»¥æ¥æ”¶ä¸­æ–­ä¸­çš„æ•°æ®å¤„ç†å¯ç•¥è¿‡ ~~Â </strong></span>ï¼ˆå¼•ç”¨GPSçš„ä¸²å£é…ç½®ï¼‰</p> 
</blockquote> 
<pre><code class="language-cs">#include "delay.h"
#include "usart2.h"
#include "stdarg.h"
#include "stdio.h"
#include "string.h"

char rxdatabufer;
u16 point1 = 0;

_SaveData Save_Data;

#if EN_USART2_RX // å¦‚æœä½¿èƒ½äº†æ¥æ”¶
// ä¸²å£1ä¸­æ–­æœåŠ¡ç¨‹åº
// æ³¨æ„,è¯»å–USARTx-&gt;SRèƒ½é¿å…è«åå…¶å¦™çš„é”™è¯¯
char USART_RX2_BUF[USART2_REC_LEN]; // æ¥æ”¶ç¼“å†²,æœ€å¤§USART_REC_LENä¸ªå­—èŠ‚.
// æ¥æ”¶çŠ¶æ€
// bit15ï¼Œ	æ¥æ”¶å®Œæˆæ ‡å¿—
// bit14ï¼Œ	æ¥æ”¶åˆ°0x0d
// bit13~0ï¼Œ	æ¥æ”¶åˆ°çš„æœ‰æ•ˆå­—èŠ‚æ•°ç›®
u16 USART2_RX_STA = 0; // æ¥æ”¶çŠ¶æ€æ ‡è®°

void Usart2_Init(u32 bound)
{

	NVIC_InitTypeDef NVIC_InitStructure;
	GPIO_InitTypeDef GPIO_InitStructure;
	USART_InitTypeDef USART_InitStructure;

	RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA, ENABLE);  // GPIOBæ—¶é’Ÿ
	RCC_APB1PeriphClockCmd(RCC_APB1Periph_USART2, ENABLE); // ä¸²å£3æ—¶é’Ÿä½¿èƒ½

	USART_DeInit(USART2);					  // å¤ä½ä¸²å£3
											  // USART3_TX   PB10
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_2; // PB10
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP; // å¤ç”¨æ¨æŒ½è¾“å‡º
	GPIO_Init(GPIOA, &amp;GPIO_InitStructure);			// åˆå§‹åŒ–PB10

	// USART3_RX	  PB11
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_3;
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING; // æµ®ç©ºè¾“å…¥
	GPIO_Init(GPIOA, &amp;GPIO_InitStructure);				  // åˆå§‹åŒ–PB11

	USART_InitStructure.USART_BaudRate = bound;										// æ³¢ç‰¹ç‡ä¸€èˆ¬è®¾ç½®ä¸º9600;
	USART_InitStructure.USART_WordLength = USART_WordLength_8b;						// å­—é•¿ä¸º8ä½æ•°æ®æ ¼å¼
	USART_InitStructure.USART_StopBits = USART_StopBits_1;							// ä¸€ä¸ªåœæ­¢ä½
	USART_InitStructure.USART_Parity = USART_Parity_No;								// æ— å¥‡å¶æ ¡éªŒä½
	USART_InitStructure.USART_HardwareFlowControl = USART_HardwareFlowControl_None; // æ— ç¡¬ä»¶æ•°æ®æµæ§åˆ¶
	USART_InitStructure.USART_Mode = USART_Mode_Rx | USART_Mode_Tx;					// æ”¶å‘æ¨¡å¼

	USART_Init(USART2, &amp;USART_InitStructure); // åˆå§‹åŒ–ä¸²å£	3

	USART_Cmd(USART2, ENABLE); // ä½¿èƒ½ä¸²å£

	// ä½¿èƒ½æ¥æ”¶ä¸­æ–­
	USART_ITConfig(USART2, USART_IT_RXNE, ENABLE); // å¼€å¯ä¸­æ–­

	// è®¾ç½®ä¸­æ–­ä¼˜å…ˆçº§
	NVIC_InitStructure.NVIC_IRQChannel = USART2_IRQn;
	NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 2; // æŠ¢å ä¼˜å…ˆçº§3
	NVIC_InitStructure.NVIC_IRQChannelSubPriority = 3;		  // å­ä¼˜å…ˆçº§3
	NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;			  // IRQé€šé“ä½¿èƒ½
	NVIC_Init(&amp;NVIC_InitStructure);							  // æ ¹æ®æŒ‡å®šçš„å‚æ•°åˆå§‹åŒ–VICå¯„å­˜å™¨

	CLR_Buf(); // æ¸…ç©ºç¼“å­˜
}

void USART2_IRQHandler(void) // ä¸²å£1ä¸­æ–­æœåŠ¡ç¨‹åº
{
	u8 Res;
#ifdef OS_TICKS_PER_SEC // å¦‚æœæ—¶é’ŸèŠ‚æ‹æ•°å®šä¹‰äº†,è¯´æ˜è¦ä½¿ç”¨ucosIIäº†.
	OSIntEnter();
#endif
	if (USART_GetITStatus(USART2, USART_IT_RXNE) != RESET)
	{
		Res = USART_ReceiveData(USART2); //(USART1-&gt;DR);	//è¯»å–æ¥æ”¶åˆ°çš„æ•°æ®

		if (Res == '$')
		{
			point1 = 0;
		}

		USART_RX2_BUF[point1++] = Res;

		if (USART_RX2_BUF[0] == '$' &amp;&amp; USART_RX2_BUF[4] == 'M' &amp;&amp; USART_RX2_BUF[5] == 'C') // ç¡®å®šæ˜¯å¦æ”¶åˆ°"GPRMC/GNRMC"è¿™ä¸€å¸§æ•°æ®
		{
			if (Res == '\n')
			{
				memset(Save_Data.GPS_Buffer, 0, GPS_Buffer_Length);	 // æ¸…ç©º
				memcpy(Save_Data.GPS_Buffer, USART_RX2_BUF, point1); // ä¿å­˜æ•°æ®
				Save_Data.isGetData = true;
				point1 = 0;
				memset(USART_RX2_BUF, 0, USART2_REC_LEN); // æ¸…ç©º
			}
		}

		if (point1 &gt;= USART2_REC_LEN)
		{
			point1 = USART2_REC_LEN;
		}
	}
#ifdef OS_TICKS_PER_SEC // å¦‚æœæ—¶é’ŸèŠ‚æ‹æ•°å®šä¹‰äº†,è¯´æ˜è¦ä½¿ç”¨ucosIIäº†.
	OSIntExit();
#endif
}

u8 Hand(char *a) // ä¸²å£å‘½ä»¤è¯†åˆ«å‡½æ•°
{
	if (strstr(USART_RX2_BUF, a) != NULL)
		return 1;
	else
		return 0;
}

void CLR_Buf(void) // ä¸²å£ç¼“å­˜æ¸…ç†
{
	memset(USART_RX2_BUF, 0, USART2_REC_LEN); // æ¸…ç©º
	point1 = 0;
}

void clrStruct()
{
	Save_Data.isGetData = false;
	Save_Data.isParseData = false;
	Save_Data.isUsefull = false;
	memset(Save_Data.GPS_Buffer, 0, GPS_Buffer_Length); // æ¸…ç©º
	memset(Save_Data.UTCTime, 0, UTCTime_Length);
	memset(Save_Data.latitude, 0, latitude_Length);
	memset(Save_Data.N_S, 0, N_S_Length);
	memset(Save_Data.longitude, 0, longitude_Length);
	memset(Save_Data.E_W, 0, E_W_Length);
}

#endif
</code></pre> 
<h4 id="usart2.h">usart2.h</h4> 
<blockquote> 
 <p>åŠŸèƒ½å‡½æ•°çš„å®šä¹‰ï¼ˆå¼•ç”¨GPSçš„ä¸²å£é…ç½®ï¼‰</p> 
</blockquote> 
<pre><code class="language-cs">#ifndef __USART2_H
#define __USART2_H
#include "stdio.h"	
#include "sys.h"
#include "string.h"

//V1.3ä¿®æ”¹è¯´æ˜ 
//æ”¯æŒé€‚åº”ä¸åŒé¢‘ç‡ä¸‹çš„ä¸²å£æ³¢ç‰¹ç‡è®¾ç½®.
//åŠ å…¥äº†å¯¹printfçš„æ”¯æŒ
//å¢åŠ äº†ä¸²å£æ¥æ”¶å‘½ä»¤åŠŸèƒ½.
//ä¿®æ­£äº†printfç¬¬ä¸€ä¸ªå­—ç¬¦ä¸¢å¤±çš„bug
//V1.4ä¿®æ”¹è¯´æ˜
//1,ä¿®æ”¹ä¸²å£åˆå§‹åŒ–IOçš„bug
//2,ä¿®æ”¹äº†USART_RX_STA,ä½¿å¾—ä¸²å£æœ€å¤§æ¥æ”¶å­—èŠ‚æ•°ä¸º2çš„14æ¬¡æ–¹
//3,å¢åŠ äº†USART_REC_LEN,ç”¨äºå®šä¹‰ä¸²å£æœ€å¤§å…è®¸æ¥æ”¶çš„å­—èŠ‚æ•°(ä¸å¤§äº2çš„14æ¬¡æ–¹)
//4,ä¿®æ”¹äº†EN_USART1_RXçš„ä½¿èƒ½æ–¹å¼
//V1.5ä¿®æ”¹è¯´æ˜
//1,å¢åŠ äº†å¯¹UCOSIIçš„æ”¯æŒ
#define USART2_REC_LEN  			200  	//å®šä¹‰æœ€å¤§æ¥æ”¶å­—èŠ‚æ•° 200
#define EN_USART2_RX 			1		//ä½¿èƒ½ï¼ˆ1ï¼‰/ç¦æ­¢ï¼ˆ0ï¼‰ä¸²å£1æ¥æ”¶
	  	
extern char  USART_RX2_BUF[USART2_REC_LEN]; //æ¥æ”¶ç¼“å†²,æœ€å¤§USART_REC_LENä¸ªå­—èŠ‚.æœ«å­—èŠ‚ä¸ºæ¢è¡Œç¬¦ 
extern u16 USART2_RX_STA;         		//æ¥æ”¶çŠ¶æ€æ ‡è®°	



#define false 0
#define true 1

//å®šä¹‰æ•°ç»„é•¿åº¦
#define GPS_Buffer_Length 80
#define UTCTime_Length 11
#define latitude_Length 11
#define N_S_Length 2
#define longitude_Length 12
#define E_W_Length 2 

typedef struct SaveData 
{
	char GPS_Buffer[GPS_Buffer_Length];
	char isGetData;		//æ˜¯å¦è·å–åˆ°GPSæ•°æ®
	char isParseData;	//æ˜¯å¦è§£æå®Œæˆ
	char UTCTime[UTCTime_Length];		//UTCæ—¶é—´
	char latitude[latitude_Length];		//çº¬åº¦
	char N_S[N_S_Length];		//N/S
	char longitude[longitude_Length];		//ç»åº¦
	char E_W[E_W_Length];		//E/W
	char isUsefull;		//å®šä½ä¿¡æ¯æ˜¯å¦æœ‰æ•ˆ
} _SaveData;




void Usart2_Init(u32 bound);
extern char rxdatabufer;
extern u16 point1;
extern _SaveData Save_Data;

void CLR_Buf(void);
u8 Hand(char *a);
void clrStruct(void);
#endif


</code></pre> 
<h3 id="2.GA6-B%E7%9A%84%E5%8A%9F%E8%83%BD%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99">2.<strong>JR6001</strong>çš„åŠŸèƒ½ä»£ç ç¼–å†™</h3> 
<blockquote> 
 <p>1. é…ç½®å®Œä¸²å£åï¼Œæˆ‘ä»¬éœ€è¦å¼€å§‹ç¼–å†™æˆ‘ä»¬çš„æ§åˆ¶å‡½æ•°ï¼ŒåŒ…æ‹¬æ¨¡å—çš„è¯»å¿™ï¼Œå‘é€ç›¸å…³çš„åŠŸèƒ½æ§åˆ¶å‡½æ•°ç­‰åŸºç¡€åŠŸèƒ½</p> 
</blockquote> 
<h4 id="JR6001.c">JR6001.c</h4> 
<blockquote> 
 <p>åŠŸèƒ½å‡½æ•°çš„ç¼–å†™</p> 
</blockquote> 
<pre><code class="language-cs">#include "JR6001.h"

#include "usart.h"
#include "delay.h"
#include "stdarg.h"
#include "stdio.h"
#include "string.h"
// å»¶æ—¶å‡½æ•°é‡å®šä¹‰ JR6001å»¶æ—¶å‡½æ•°å®šä¹‰ï¼Œç”¨æˆ·è‡ªè¡Œæ›´æ”¹ä¸ºè‡ªå·±çš„å»¶æ—¶å‡½æ•°
#define JR6001_ms(ms) delay_ms(ms)
#define JR6001_us(us) delay_us(us)

void JR6001_Volumecontrol(u8 num);

void JR6001_Init(void)
{
	// GPIOç«¯å£è®¾ç½®
	GPIO_InitTypeDef GPIO_InitStructure;

#ifdef JR6001_BUSY // æŸ¥å¿™å¼•è„šé…ç½®

	RCC_APB2PeriphClockCmd(JR6001_BUSY_GPIO_CLK, ENABLE); // ä½¿èƒ½PORæ—¶é’Ÿ
	GPIO_InitStructure.GPIO_Pin = JR6001_BUSY_GPIO_PIN;
	GPIO_InitStructure.GPIO_Mode = JR6001_BUSY_GPIO_Mode;
	GPIO_Init(JR6001_BUSY_GPIO_PORT, &amp;GPIO_InitStructure);

#endif
	JR6001_Volumecontrol(31); // è®¾ç½®éŸ³é‡
	JR6001_ms(100);
}

// ä¸²å£å‘é€æ•°æ®
void JR6001_SendCode(u8 *str, u8 busy)
{
	u16 len, i;
	len = strlen((char *)str);
	printf("%s\n", str);

	if (busy == 1 &amp;&amp; JR6001_BUSY_IO == 0)
	{
		for (i = 0; i &lt;= len; i++) // å¾ªç¯å‘é€æ•°æ®
		{
			while (USART_GetFlagStatus(USART2, USART_FLAG_TC) == RESET)
				; // å¾ªç¯å‘é€,ç›´åˆ°å‘é€å®Œæ¯•
			USART_SendData(USART2, str[i]);
		}
	}
	else if (busy == 0)
	{
		for (i = 0; i &lt;= len; i++) // å¾ªç¯å‘é€æ•°æ®
		{
			while (USART_GetFlagStatus(USART2, USART_FLAG_TC) == RESET)
				; // å¾ªç¯å‘é€,ç›´åˆ°å‘é€å®Œæ¯•
			USART_SendData(USART2, str[i]);
		}
	}
	JR6001_ms(10);
}
// åŸºç¡€æŒ‡ä»¤å‘é€
void JR6001_Instruction(u8 *str, u8 busy)
{
	u8 JR6001_Buff[20];
	sprintf((char *)JR6001_Buff, "%s\r\n", str);
	JR6001_SendCode(JR6001_Buff, busy);
}
// æ›²ç›®é€‰æ‹©
void JR6001_SongControl(u8 num, u8 busy)
{
	u8 JR6001_Buff[20];
	if (num &lt; 10)
	{
		sprintf((char *)JR6001_Buff, "A7:0000%d\r\n", num);
		JR6001_SendCode(JR6001_Buff, busy);
	}
	else if (num &lt; 100)
	{
		sprintf((char *)JR6001_Buff, "A7:000%d\r\n", num);
		JR6001_SendCode(JR6001_Buff, busy);
	}
	else
	{
		sprintf((char *)JR6001_Buff, "A7:00%d\r\n", num);
		JR6001_SendCode(JR6001_Buff, busy);
	}
}
// éŸ³é‡é€‰æ‹©
void JR6001_Volumecontrol(u8 num)
{
	u8 JR6001_Buff[20];
	sprintf((char *)JR6001_Buff, "AF:%d\r\n", num);
	JR6001_SendCode(JR6001_Buff, 0);
}

/*
	JR6001_Init();
	JR6001_SongControl(5,0);

*/
</code></pre> 
<h4 id="JR6001.h">JR6001.h</h4> 
<blockquote> 
 <p>åŠŸèƒ½å‡½æ•°çš„å®šä¹‰</p> 
</blockquote> 
<pre><code class="language-cs">#ifndef __JR6001_H
#define __JR6001_H

#include "sys.h"

// æŸ¥å¿™ä½¿èƒ½
#define JR6001_BUSY 0 // 0.å¤±èƒ½ 1.ä½¿èƒ½

// JR6001æŸ¥å¿™å¼•è„šé…ç½® é«˜ç”µå¹³å¿™
#define JR6001_BUSY_GPIO_CLK RCC_APB2Periph_GPIOA
#define JR6001_BUSY_GPIO_PORT GPIOA
#define JR6001_BUSY_GPIO_PIN GPIO_Pin_6
#define JR6001_BUSY_GPIO_Mode GPIO_Mode_IPD

#define JR6001_BUSY_IO GPIO_ReadInputDataBit(JR6001_BUSY_GPIO_PORT, JR6001_BUSY_GPIO_PIN) // è¯»å–æŸ¥å¿™å¼•è„š

// JR6001ä¸²å£å‘½ä»¤[æ’­æ”¾ æš‚åœ ä¸Šä¸€æ›² ä¸‹ä¸€æ›² éŸ³é‡åŠ  éŸ³é‡å‡]
#define Play "A2"
#define Suspend "A3"
#define On_Song "A5"
#define Next_Song "A6"
#define Volumeadd "B0"
#define Volumesub "B1"

void JR6001_Init(void);
// ä¸²å£å‘é€æ•°æ®
void JR6001_SendCode(u8 *str, u8 busy);
// åŸºç¡€æŒ‡ä»¤å‘é€
void JR6001_Instruction(u8 *str, u8 busy);
// æ›²ç›®é€‰æ‹©
void JR6001_SongControl(u8 num, u8 busy);
// éŸ³é‡é€‰æ‹©
void JR6001_Volumecontrol(u8 num);
#endif
</code></pre> 
<h2 id="%E4%B8%89%E3%80%81%E5%8F%82%E8%80%83">ä¸‰ã€å‚è€ƒ</h2> 
<p><a class="link-info has-card" href="https://blog.csdn.net/m0_56051805/article/details/125116764?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170200319216800184185082%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=170200319216800184185082&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-125116764-null-null.142%5Ev96%5Epc_search_result_base7&amp;utm_term=stm32JR6001&amp;spm=1018.2226.3001.4187" title="ã€STM32ã€‘ JR6001è¯­éŸ³æ’­æ”¾"><span class="link-card-box"><span class="link-title">ã€STM32ã€‘ JR6001è¯­éŸ³æ’­æ”¾</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/42/02/5Zq8L5N7_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/m0_56051805/article/details/125116764?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170200319216800184185082%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=170200319216800184185082&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-125116764-null-null.142^v96^pc_search_result_base7&amp;utm_term=stm32JR6001&amp;spm=1018.2226.3001.4187</span></span></a></p> 
<hr> 
<p style="text-align:center;"><strong>å®Œæ•´ä»£ç è¯·å…³æ³¨å«æ˜Ÿå…¬ä¼—å·è¿›è¡Œè·å–å’Œå’¨è¯¢</strong></p> 
<hr> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/88db1f410f468d6da22bb9c80aba79e6/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">Javaæ•°æ®ç»“æ„ä¸ç®—æ³•-1.2é˜Ÿåˆ—</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2898bcee5d15396d28de6d22acc36247/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ã€EIä¼šè®®å¾ç¨¿ã€‘ç¬¬äº”å±Šäººå·¥æ™ºèƒ½ã€ç½‘ç»œä¸ä¿¡æ¯æŠ€æœ¯å›½é™…å­¦æœ¯ä¼šè®®ï¼ˆAINIT 2024ï¼‰</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>