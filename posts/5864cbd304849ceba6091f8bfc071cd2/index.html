<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Qt中csv文件的导入与导出 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Qt中csv文件的导入与导出" />
<meta property="og:description" content="CSV
1.简介：
全称：Comma Separated Values。
是“逗号分隔值”的英文缩写，通常是纯文本文件，一般用wordWPS或是记事本打开。
2.规则：
（1）开头不留空，以行为单位。
（2）可含或不含列名，含列名则居文件第一行。
（3）一行数据部跨行，无空行。
（4）以半角逗号作分隔符，列为空也要表达其存在。
（5）列内容如存在半角逗号（即,）则用半角引号（即&#34;&#34;）将该字段值包含起来。内容如存在半角逗号（即,）则用半角引号（即&#34;&#34;）将该字段值包含起来。
（6）列内容如存在半角引号（即&#34;）则应替换成半角双引号（&#34;&#34;）转义，并用半角引号（即&#34;&#34;）将该字段值包含起来。 （7）文件读写时引号，逗号操作规则互逆。
（8）内码格式不限，可为 ASCII、Unicode 或者其他。
（9）不支持特殊字符
3.使用：（csv文件的导入导出）
先看下一个基本demo的ui：
（1）获取控件信息导入到csv文件中：
void mainDialog::exportMsg()
{
//获取创建的csv文件名
QString fileName = QFileDialog::getSaveFileName(this, tr(&#34;Excel file&#34;), qApp-&gt;applicationDirPath (),
tr(&#34;Files (*.csv)&#34;));
if (fileName.isEmpty())
return;
//打开.csv文件
QFile file(fileName);
if(!file.open(QIODevice::WriteOnly | QIODevice::Text))
{
std::cerr &lt;&lt; &#34;Cannot open file for writing: &#34;
&lt;&lt; qPrintable(file.errorString()) &lt;&lt; std::endl;
return;
}
QTextStream out(&amp;file); //获取数据
QString sName = ui-&gt;lineEdit-&gt;text();//姓名
Int iAge = ui-&gt;spinBox-&gt;tvalue();//年龄" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/5864cbd304849ceba6091f8bfc071cd2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-24T15:38:34+08:00" />
<meta property="article:modified_time" content="2022-08-24T15:38:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Qt中csv文件的导入与导出</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>CSV</p> 
<p>1.简介：</p> 
<p>  全称：Comma Separated Values。</p> 
<p>  是“逗号分隔值”的英文缩写，通常是纯文本文件，一般用wordWPS或是记事本打开。</p> 
<p>2.规则：</p> 
<p>（1）开头不留空，以行为单位。</p> 
<p>（2）可含或不含列名，含列名则居文件第一行。</p> 
<p>（3）一行数据部跨行，无空行。</p> 
<p>（4）以半角逗号作分隔符，列为空也要表达其存在。</p> 
<p>（5）列内容如存在半角逗号（即,）则用半角引号（即""）将该字段值包含起来。内容如存在半角逗号（即,）则用半角引号（即""）将该字段值包含起来。</p> 
<p>（6）列内容如存在半角引号（即"）则应替换成半角双引号（""）转义，并用半角引号（即""）将该字段值包含起来。 </p> 
<p>（7）文件读写时引号，逗号操作规则互逆。</p> 
<p>（8）内码格式不限，可为 ASCII、Unicode 或者其他。</p> 
<p>（9）不支持特殊字符</p> 
<p>3.使用：（csv文件的导入导出）</p> 
<p>先看下一个基本demo的ui：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/85/36/NJU86zXC_o.jpg"></p> 
<p>（1）获取控件信息导入到csv文件中：</p> 
<p>     void mainDialog::exportMsg()</p> 
<p>     {<!-- --></p> 
<p>       //获取创建的csv文件名</p> 
<p>       QString fileName = QFileDialog::getSaveFileName(this, tr("Excel file"), qApp-&gt;applicationDirPath (),</p> 
<p>                                                   tr("Files (*.csv)"));</p> 
<p>       if (fileName.isEmpty())</p> 
<p>       return;</p> 
<p>       //打开.csv文件</p> 
<p>       QFile file(fileName);</p> 
<p>       if(!file.open(QIODevice::WriteOnly | QIODevice::Text))</p> 
<p>       {<!-- --></p> 
<p>           std::cerr &lt;&lt; "Cannot open file for writing: "</p> 
<p>                     &lt;&lt; qPrintable(file.errorString()) &lt;&lt; std::endl;</p> 
<p>           return;</p> 
<p>       }</p> 
<p>       QTextStream out(&amp;file);    </p> 
<p>       //获取数据</p> 
<p>       QString sName = ui-&gt;lineEdit-&gt;text();//姓名</p> 
<p>       Int iAge = ui-&gt;spinBox-&gt;tvalue();//年龄</p> 
<p>   </p> 
<p>       out &lt;&lt; tr("姓名：,") &lt;&lt; sName &lt;&lt; ",\n";</p> 
<p>       out &lt;&lt; tr("年龄：,") &lt;&lt; iAge &lt;&lt; ",\n";</p> 
<p>       out &lt;&lt; tr("1,") &lt;&lt; tr("2,")&lt;&lt; tr("3,") &lt;&lt; tr("4,") &lt;&lt;",\n";//表头          </p> 
<p>       //获取表格内容</p> 
<p>       int row = ui-&gt;tableWidget-&gt;rowCount();//表格总行数</p> 
<p>       for(int i = 0; i &lt; row; i ++)</p> 
<p>       {<!-- --></p> 
<p>           for(int col = 0; col &lt; 4; col++)</p> 
<p>           {<!-- --></p> 
<p>               QString string = ui-&gt;tableWidget-&gt;item(i, col)-&gt;text();</p> 
<p>               out &lt;&lt; string &lt;&lt; ",";// 写入文件</p> 
<p>           }</p> 
<p>           out &lt;&lt; "\n";</p> 
<p>       }</p> 
<p>       QMessageBox::information(this, tr("导出数据成功"), tr("信息已保存在%1！").arg(fileName), tr("确定"));</p> 
<p>       file.close();</p> 
<p>}</p> 
<p>这就是导出之后.csv文件中的内容：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/f8/8f/tC5kdfdi_o.jpg"></p> 
<p>（2）将csv文件中信息导入控件：</p> 
<p>    void mainDialog::importMsg()</p> 
<p>    {<!-- --></p> 
<p>        QString fileName = QFileDialog::getOpenFileName(this, tr("Excel file"), qApp-&gt;applicationDirPath (),</p> 
<p>                                                   tr("Files (*.csv)"));</p> 
<p>        QFile file(fileName);</p> 
<p>        if(!file.open(QIODevice::ReadOnly | QIODevice::Text))</p> 
<p>        {<!-- --></p> 
<p>           std::cerr &lt;&lt; "Cannot open file for reading: "</p> 
<p>                     &lt;&lt; qPrintable(file.errorString()) &lt;&lt; std::endl;</p> 
<p>           return;</p> 
<p>        }</p> 
<p>        QStringList list;</p> 
<p>        list.clear();</p> 
<p>        QTextStream in(&amp;file);</p> 
<p>        int i =0;</p> 
<p>        while(!in.atEnd())</p> 
<p>        {<!-- --></p> 
<p>            QString fileLine = in.readLine();</p> 
<p>            list = fileLine.split(",", QString::SkipEmptyParts);</p> 
<p>            //姓名</p> 
<p>            if(i == 0) ui-&gt;lineEdit-&gt;setText(list.at(1));</p> 
<p>            //年龄</p> 
<p>            if(i == 1) ui-&gt;spinBox-&gt;setValue(list.at(1));</p> 
<p>            //表头</p> 
<p>            if(i == 2) ui-&gt;tableWidget-&gt;setHorizontalHeaderLabels(QStringList() &lt;&lt; list.at(0) &lt;&lt; list.at(1)</p> 
<p>                                                      &lt;&lt; list.at(2) &lt;&lt; list.at(3);       </p> 
<p>            //表内容</p> 
<p>            if(i == 3)</p> 
<p>            {<!-- --></p> 
<p>                for(int a = 0; a &lt; 4; a++)</p> 
<p>                {<!-- --></p> 
<p>                    ui-&gt;tableWidget-&gt;setItem(0, a, new QTableWidgetItem(list.at(a)));</p> 
<p>                }</p> 
<p>            }</p> 
<p>            if(i &gt; 3)</p> 
<p>            {<!-- --></p> 
<p>                for(int b = 0; b &lt; 4; b++)</p> 
<p>                {<!-- --></p> 
<p>                    ui-&gt;tableWidget-&gt;setRowCount(i-2);//设置添加一行</p> 
<p>                    ui-&gt;tableWidget-&gt;setItem(i-3, b, new QTableWidgetItem(list.at(b)));</p> 
<p>                }</p> 
<p>            }</p> 
<p>            i++;</p> 
<p>        }</p> 
<p>        file.close();</p> 
<p>    }</p> 
<p>好了，完成啦。。。<br>  </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/89c1516463b836f24cef6f5c8c7bddf8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Ubuntu (双系统)外接显示器无显示/无反映</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2ed6eebaf5ead3c8356ded8248489b24/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C语言使用josn库解析数据</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>