<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>z3学习笔记（有空继续整理） - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="z3学习笔记（有空继续整理）" />
<meta property="og:description" content="一、基本语法 Declare-const: 声明给定类型（type/ sort）的常量
declare-fun：声明一个函数
(declare-fun f (Int Bool) Int)：声明一个接收整型和布尔型两个参数的函数，返回int
(define-fun a () Int [val])：是解释。此处表明a的值是val
(define-fun conjecture () Bool
(=&gt; (and (=&gt; p q) (=&gt; q r))
(=&gt; p r)))
(assert (not conjecture)) 此处的define-fun是起到把后面bool表达式定义一个别名的作用
Reset：重置清空所有声明和断言
Simplify：简化表达式
Define-sort：给sort类型的表达式定义一个别名
Declare-sort：声明一种未解释的类型A
(declare-sort A)
(declare-const x A) 声明A类型的常量x
SMT公式的基本构建块我就是常量和函数，而常量实际就是没有参数的函数，所以其所有东西都可以看成一个函数。
(Declare-fun a () int) 等价于 （declare-const b int）&lt;后者是前者的语法糖&gt;
典型的一阶逻辑中，函数都没有副作用，都是定义在输入值上的，所以没有参数的函数实际就是常量
纯一阶逻辑中的函数和常量符号是未解释的或者说自由的，即没有先验解释附加之上。所以&#43;号不一定代表加法，任何和其兼容的都可以
; defining my own division operator where x/0.0 == 0.0 for every x.
(define-fun mydiv ((x Real) (y Real)) Real" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/5c34440d417c5304ba37c4cb968ab26d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-16T11:50:52+08:00" />
<meta property="article:modified_time" content="2021-03-16T11:50:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">z3学习笔记（有空继续整理）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 style="margin-left:0cm;">一、基本语法</h3> 
<p style="margin-left:0cm;">Declare-const: 声明给定类型（type/ sort）的常量</p> 
<p style="margin-left:0cm;">declare-fun：声明一个函数</p> 
<p style="margin-left:0cm;">(declare-fun f (Int Bool) Int)：声明一个接收整型和布尔型两个参数的函数，返回int</p> 
<p style="margin-left:0cm;">(define-fun a () Int [val])：是解释。此处表明a的值是val</p> 
<p style="margin-left:0cm;">(define-fun conjecture () Bool</p> 
<p style="margin-left:0cm;">         (=&gt; (and (=&gt; p q) (=&gt; q r))</p> 
<p style="margin-left:0cm;">                   (=&gt; p r)))</p> 
<p style="margin-left:0cm;">(assert (not conjecture))  此处的define-fun是起到把后面bool表达式定义一个别名的作用</p> 
<p style="margin-left:0cm;">Reset：重置清空所有声明和断言</p> 
<p style="margin-left:0cm;">Simplify：简化表达式</p> 
<p style="margin-left:0cm;">Define-sort：给sort类型的表达式定义一个别名</p> 
<p style="margin-left:0cm;">Declare-sort：声明一种未解释的类型A</p> 
<p style="margin-left:0cm;">(declare-sort A)</p> 
<p style="margin-left:0cm;">(declare-const x A)  声明A类型的常量x</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">SMT公式的基本构建块我就是常量和函数，而常量实际就是没有参数的函数，<span style="color:#FF0000;">所以其所有东西都可以看成一个函数。</span></p> 
<p style="margin-left:0cm;"><span style="color:#FF0000;">(Declare-fun a () int)  </span><span style="color:#FF0000;">等价于</span> <span style="color:#FF0000;">（</span><span style="color:#FF0000;">declare-const b int</span><span style="color:#FF0000;">）</span>&lt;后者是前者的语法糖&gt;</p> 
<p style="margin-left:0cm;">典型的一阶逻辑中，函数都没有副作用，都是定义在输入值上的，所以没有参数的函数实际就是常量</p> 
<p style="margin-left:0cm;">纯一阶逻辑中的函数和常量符号是未解释的或者说自由的，即没有先验解释附加之上。所以+号不一定代表加法，任何和其兼容的都可以</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"><span style="color:#FF0000;">; defining my own division operator where x/0.0 == 0.0 for every x.</span></p> 
<p style="margin-left:0cm;">(define-fun mydiv ((x Real) (y Real)) Real</p> 
<p style="margin-left:0cm;">  (if (not (= y 0.0))</p> 
<p style="margin-left:0cm;">      (/ x y)</p> 
<p style="margin-left:0cm;">      0.0))</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"> </p> 
<h3 style="margin-left:0cm;">二、 位向量</h3> 
<p style="margin-left:0cm;">现代CPU和主流的编程语言都是基于固定大小的位向量实现的算法。位向量理论允许对无符号/有符号两类算术的语义进行精确建模。</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">位向量常量可能是二进制、十进制和十六进制。二进制格式的位向量#b010大小为3，十六进制格式位向量#x0a0大小是12。必须为十进制格式的位向量字面量指定大小，因为同一大小的十进制数用不同进制表示，位数可能不同，如下示例：</p> 
<p style="margin-left:0cm;">(display #b0100)  //4</p> 
<p style="margin-left:0cm;">(display (_ bv20 8)) //大小为8，数值为20的十进制数，表示为是#x14</p> 
<p style="margin-left:0cm;">(display (_ bv20 7)) //大小为7，数值为20的十进制数，表示为是#b0010100</p> 
<p style="margin-left:0cm;">(display #b0100)  （_bv4 4）</p> 
<p style="margin-left:0cm;">操作包括：加减乘除，模、求余、左右移（有无符号）、与或非、大小等于</p> 
<p style="margin-left:0cm;">数组：</p> 
<p style="margin-left:0cm;">(Select a i)返回数组a中处于位置i的数据；</p> 
<p style="margin-left:0cm;">(store a i v)返回位置i处值为v的数组a</p> 
<p style="margin-left:0cm;">(declare-const a1 (Array Int Int))：声明int类型的数组</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"><span style="color:#FF0000;">将所有索引映射到某个固定值的数组可以在</span><span style="color:#FF0000;">Z3</span><span style="color:#FF0000;">中使用</span><span style="color:#FF0000;">const</span><span style="color:#FF0000;">构造来指定</span>。它从数组的范围类型中获取一个值，然后创建一个数组。Z3不能仅通过检查实参类型来推断const构造函数必须返回哪种类型的数组。因此，必须使用限定标识符(如const(数组T1 T2))。下面的示例定义了一个只包含1的常量数组。</p> 
<p style="margin-left:0cm;">(declare-const all1 (Array Int Int))</p> 
<p style="margin-left:0cm;">(declare-const a Int)</p> 
<p style="margin-left:0cm;">(declare-const i Int)</p> 
<p style="margin-left:0cm;">(assert (= all1 ((as const (Array Int Int)) 1))) //all1数组中所有数的值为1</p> 
<p style="margin-left:0cm;">(assert (= a (select all1 i)))   //SAT </p> 
<p style="margin-left:0cm;">Array的解释特别像函数的解释，都是 用define-fun的方式</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"> </p> 
<h3 style="margin-left:0cm;">三、 Tatics</h3> 
<p style="margin-left:0cm;">Tatics是一系列z3内置的函数结合而成的，可以通过apply命令将多个内置的tatics结合在一起（比如simplify和solve-eqs）。前者用于简化表达式，后者采用高斯消去法来消去变量求解方程。</p> 
<p style="margin-left:0cm;"><span style="color:#FF0000;">(apply (then simplify solve-eqs)) </span>//连接器them将simplify应用于输入目标，然后solver-eqs简化simplify产生的每个子公式中的多余变量</p> 
<p style="margin-left:0cm;"><span style="color:#FF0000;">split-clause</span>：将约束分为多个子约束</p> 
<p style="margin-left:0cm;"><img alt="" height="161" src="https://images2.imgbox.com/a5/b0/MRPaGXAs_o.jpg" width="298"><img alt="" height="232" src="https://images2.imgbox.com/da/d7/hAOCB4sK_o.jpg" width="295"></p> 
<p style="margin-left:0cm;"><span style="color:#FF0000;">(then t s) </span>applies t to the input goal and s to every subgoal produced by t.</p> 
<p style="margin-left:0cm;"><span style="color:#FF0000;">(par-then t s)</span> applies t to the input goal and s to every subgoal produced by t in parallel.</p> 
<p style="margin-left:0cm;"><span style="color:#FF0000;">(or-else t s) </span>first applies t to the given goal, if it fails then returns the result of s applied to the given goal.</p> 
<p style="margin-left:0cm;"><span style="color:#FF0000;">(par-or t s)</span> applies t and s in parallel until one of them succeed. The tractic fails if t and s fails</p> 
<p style="margin-left:0cm;"><span style="color:#FF0000;">(repeat t)</span> Keep applying the given tactic until no subgoal is modified by it.</p> 
<p style="margin-left:0cm;"><span style="color:#FF0000;">(repeat t n)</span> Keep applying the given tactic until no subgoal is modified by it, or the num</p> 
<p style="margin-left:0cm;">ber of iterations is greater than n.</p> 
<p style="margin-left:0cm;">Check</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">-sat-using类似于check-sat，但其不利用z3自带的solver而是用tatics里提供的tatic</p> 
<p style="margin-left:0cm;"> </p> 
<h3 style="margin-left:0cm;">四、Sequence</h3> 
<p style="margin-left:0cm;">本节描述Z3对字符串、序列和正则表达式的处理。</p> 
<p style="margin-left:0cm;">Z3仅使用一个不完整的启发式求解器解决字符串等式(尽管存在完整的过程)，长度和序列(以及正则表达式)的完整组合无论如何都是不可决定的。</p> 
<p style="margin-left:0cm;">string是变量中内在的名字 (declare a String)</p> 
<p style="margin-left:0cm;">(assert (= (str.++ b a) (str.++ "abc" b)))//是否存在连接到“ abc”和后跟b的字符串a和b。</p> 
<p style="margin-left:0cm;">字符串操作：</p> 
<p style="margin-left:0cm;"><img alt="" height="376" src="https://images2.imgbox.com/af/cc/xKJhf9kx_o.png" width="814"></p> 
<p style="margin-left:0cm;"> </p> 
<h3 style="margin-left:0cm;">五、Optimization</h3> 
<p style="margin-left:0cm;">该功能使用户可以直接使用Z3制定目标函数。 引擎盖下有用于解决SMT公式，MaxSMT及其组合的线性优化问题的方法组合。</p> 
<p style="margin-left:0cm;">算术优化》》</p> 
<p style="margin-left:0cm;">(Maximize t)：调用check-sat同时产生值最大的解释</p> 
<p style="margin-left:0cm;">(minimize t): 调用check-sat同时产生值最小的解释</p> 
<p style="margin-left:0cm;">无界对象：z3中的最大可以是无穷（00），最小可以使负无穷（-00）</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">六、题外话</p> 
<p style="margin-left:0cm;">1、若使用z3实现复杂的功能还是使用python或者Haskell, 这些语言提供了对z3更强大的API；</p> 
<p style="margin-left:0cm;">2、虽说C/C++可能执行的比python快，但C++使用z3有很大的局限性,也比较麻烦，所有类型都要声明。</p> 
<p style="margin-left:0cm;">3、当然可以选择C++与python结合，python写约束求解的脚本，C++调用python脚本</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3e979d68c2793ba9528d56bdbdddc2ce/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">matlab 零均值白噪声,matlab产生白噪声，怎么产生均值为0，方差为1的白噪声</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/efbb8f536ed8373df11dadeec885b0d4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">tree 命令使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>