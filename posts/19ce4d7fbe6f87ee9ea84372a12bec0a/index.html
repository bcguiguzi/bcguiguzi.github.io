<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【QEMU】编译安装 qemu 8.0.4 及安装 Kylin V10 ARM64 版本全记录 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【QEMU】编译安装 qemu 8.0.4 及安装 Kylin V10 ARM64 版本全记录" />
<meta property="og:description" content="目标 手头没有 ARM64 硬件环境，只能使用 X86 设备上模拟 Aarch64（Arm64）架构环境，用于安装国产 操作系统（例如：银河麒麟 Kylin V10）。
目前跨硬件架构的模拟器神器首选就是 qemu 了，可以模拟各种硬件环境。
我的思路：首先在 Windows 上使用 Vmware 安装 Kylin V10 X86_64 版本，然后在虚拟机内安装 qemu，最后使用 qemu 模拟 ARM 硬件 安装 Kylin V10 ARM64 版本，总体操作顺序如下图所示：
Windows -&gt; VMware -&gt; 安装 Kylin V10 X86_64 -&gt; 安装 qemu -&gt; 安装 Kylin V10 ARM64
注意： 你也可以在Windows 下直接使用 qemu 来模拟 arm 硬件，但运行性能比较差。需要使用 TAP-Windows 安装 tap 类型的虚拟网卡用来实现网络通讯，具体方法可 参考这篇文章。
使用Qemu在Windows上模拟arm平台并安装国产化操作系统 安装步骤 安装 Kylin V10 X86_64 版本及之前的步骤比较直观（注意需要安装 ‘带 UKUI GUI 的服务器’），这里就不作介绍，各位看官可自行百度。以下步骤全部在安装好的 Kylin V10 X86_64 系统下进行。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/19ce4d7fbe6f87ee9ea84372a12bec0a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-21T12:44:06+08:00" />
<meta property="article:modified_time" content="2023-08-21T12:44:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【QEMU】编译安装 qemu 8.0.4 及安装 Kylin V10 ARM64 版本全记录</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>目标</h2> 
<p>手头没有 ARM64 硬件环境，只能使用 X86 设备上模拟 Aarch64（Arm64）架构环境，用于安装国产 操作系统（例如：银河麒麟 Kylin V10）。</p> 
<p>目前跨硬件架构的模拟器神器首选就是 <a href="https://www.qemu.org/" rel="nofollow">qemu</a> 了，可以模拟各种硬件环境。</p> 
<p><strong>我的思路</strong>：首先在 Windows 上使用 Vmware 安装 Kylin V10 X86_64 版本，然后在虚拟机内安装 qemu，最后使用 qemu 模拟 ARM 硬件 安装 Kylin V10 ARM64 版本，总体操作顺序如下图所示：</p> 
<p><code>Windows</code> -&gt; <code>VMware</code> -&gt; <code>安装 Kylin V10 X86_64</code> -&gt; <code>安装 qemu</code> -&gt; <code>安装 Kylin V10 ARM64</code></p> 
<p><strong>注意：</strong> 你也可以在Windows 下直接使用 qemu 来模拟 arm 硬件，但运行性能比较差。需要使用 <a href="http://swupdate.openvpn.org/community/releases/tap-windows-9.21.2.exe" rel="nofollow"><code>TAP-Windows</code></a> 安装 tap 类型的虚拟网卡用来实现网络通讯，具体方法可 参考这篇文章。</p> 
<ul><li><a href="https://blog.csdn.net/EmptyStupid/article/details/127949231">使用Qemu在Windows上模拟arm平台并安装国产化操作系统</a></li></ul> 
<h2><a id="_12"></a>安装步骤</h2> 
<p>安装 Kylin V10 X86_64 版本及之前的步骤比较直观（注意需要安装 ‘带 UKUI GUI 的服务器’），这里就不作介绍，各位看官可自行百度。以下步骤全部在安装好的 Kylin V10 X86_64 系统下进行。</p> 
<h3><a id="_QEMU_14"></a>安装 QEMU</h3> 
<p>安装 qemu 之前需要将安装开发环境，升级 GCC 到 7.4.0 以上版本。具体可参照我这边文章的介绍。<br> <a href="https://blog.csdn.net/tanjelly/article/details/132343133">【信创】银河麒麟 Kylin V10 升级 GCC 操作步骤</a></p> 
<p>废话不多说，开始安装！</p> 
<ol><li>下载安装 Ninja</li></ol> 
<pre><code>wget https://github.com/ninja-build/ninja/releases/download/v1.11.1/ninja-linux.zip
unzip ninja-linux.zip
mv ninja /usr/bin/
# 检查运行是否正常
ninja --version
</code></pre> 
<ol start="2"><li>安装相关依赖</li></ol> 
<pre><code>yum -y install pixman pixman-devel libmount libmount-devel glib2 glib2-devel libtool flex bison clang
</code></pre> 
<ol start="3"><li>下载及编译安装 qemu</li></ol> 
<pre><code>wget https://download.qemu.org/qemu-8.0.4.tar.xz
tar -xf qemu-8.0.4.tar.xz
mkdir qemu-8.0.4/build/
cd qemu-8.0.4/build/
../configure --prefix=/usr/local
make
make install
</code></pre> 
<h3><a id="_Kylin_V10_ARM64__43"></a>安装 Kylin V10 ARM64 版本</h3> 
<ol><li> <p>从官方获取安装 ISO 文件（自行百度）。</p> </li><li> <p>从下面的网站获取 BIOS 镜像：</p> </li></ol> 
<p><a href="https://releases.linaro.org/components/kernel/uefi-linaro/16.02/release/qemu64/QEMU_EFI.fd" rel="nofollow">https://releases.linaro.org/</a></p> 
<ol start="3"><li>创建虚拟网卡：</li></ol> 
<pre><code>yum -y install net-tools
ip tuntap add tap0 mode tap
ip link set tap0 up
echo 1 &gt; /proc/sys/net/ipv4/conf/tap0/proxy_arp
# 宿主机IP为 192.168.80.130
ip route add 192.168.80.150 dev tap0
ifconfig
# ens33 为宿主机网卡
arp -Ds 192.168.80.150 ens33 pub
</code></pre> 
<ol start="4"><li>创建磁盘文件：</li></ol> 
<pre><code>qemu-img create -f qcow2 kylin-v10-sp2-aarch64.qcow2 120G
</code></pre> 
<ol start="5"><li>使用官方镜像安装系统：</li></ol> 
<pre><code># Kylin-Server-V10-SP2-Release-Build09-20210524-aarch64.iso 为官方安装光盘文件
qemu-system-aarch64 -m 1024 -cpu cortex-a72 -smp 2,cores=1,threads=2,sockets=1 -M virt -bios QEMU_EFI.fd -netdev tap,ifname=tap1,id=tapnet,script=no -device virtio-net-device,netdev=tapnet -device nec-usb-xhci -device usb-kbd -device usb-mouse -device VGA -drive if=none,file=Kylin-Server-V10-SP2-Release-Build09-20210524-aarch64.iso,id=cdrom,media=cdrom -device virtio-scsi-device -device scsi-cd,drive=cdrom -drive if=none,file=kylin-v10-sp2-aarch64.qcow2,id=hd0 -device virtio-blk-device,drive=hd0
</code></pre> 
<p>执行上面的命令后请在系统的图形界面下使用 <code>vncviewer</code> 访问安装界面，根据向导完成安装。<br> <img src="https://images2.imgbox.com/3a/11/GT6ZnZBG_o.png" alt="开始安装"></p> 
<ol start="6"><li>运行新安装的系统：</li></ol> 
<pre><code>qemu-system-aarch64 -m 1024 -cpu cortex-a72 -smp 4,cores=1,threads=4,sockets=1 -M virt -bios QEMU_EFI.fd -netdev tap,ifname=tap1,id=tapnet,script=no -device virtio-net-device,netdev=tapnet -device nec-usb-xhci -device usb-kbd -device usb-mouse -device VGA -drive if=none,file=kylin-v10-sp2-aarch64.qcow2,id=hd0 -device virtio-blk-device,drive=hd0
</code></pre> 
<h2><a id="_79"></a>问题</h2> 
<p>我尝试使用同样的方法安装下面两个版本的 Kylin，但卡在了安装步骤（运行命令后不出现任何提示）无法继续，希望有经验的朋友告知如何解决，不甚感激！</p> 
<ul><li>Kylin-Host-V10-SP3-General-Release-2304-ARM64.iso</li><li>Kylin-Server-V10-SP3-General-Release-2303-ARM64.iso<br> <img src="https://images2.imgbox.com/12/c8/IqHQkdDH_o.png" alt="光盘无法启动"></li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e56c68ebb5cc941226a55e8024c31165/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Nexus（Maven管理器）下载和安装</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2ce360bcbab04ccf4ad7eab60fbdecc9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">将点云数据投影到图像上并生成带有颜色的激光雷达点云：Python实现指南</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>