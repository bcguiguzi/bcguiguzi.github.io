<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>样本熵（SampEn）计算时间序列复杂度（Python程序） - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="样本熵（SampEn）计算时间序列复杂度（Python程序）" />
<meta property="og:description" content="关于样本熵，Python有第三方包sampen可以直接引用,但是对于某些序列总会出现错误（我猜测说的是分母为0，计算逻辑的错误）
本来想顺着三方包进行检查，但是原包过于复杂，于是就结合网上的代码进行了修改。
样本熵的原理网上有很多，具体如下：
但是我有个疑惑，如果在一个时间序列中没有符合约束的距离即Ai和Bi，那么两者相除的时候就会返回错误（因为分母是不能为0的）。此时就说明了样本熵的值是无穷∞大的，也就说明该序列是很复杂的。 def SampEn(U, m, r): &#34;&#34;&#34; 用于量化时间序列的可预测性 :param U: 时间序列 :param m: 模板向量维数 :param r: 距离容忍度，一般取0.1~0.25倍的时间序列标准差，也可以理解为相似度的度量阈值 :return: 返回一个-np.log(A/B)，该值越大，序列就越复杂 &#34;&#34;&#34; def _maxdist(x_i, x_j): &#34;&#34;&#34; Chebyshev distance :param x_i: :param x_j: :return: &#34;&#34;&#34; return max([abs(ua - va) for ua, va in zip(x_i, x_j)]) def _phi(m): x = [[U[j] for j in range(i, i &#43; m - 1 &#43; 1)] for i in range(N - m &#43; 1)] C = [len([1 for j in range(len(x)) if i !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/dd5359d9a6d353506a8e39842f89b7a2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-11T21:37:52+08:00" />
<meta property="article:modified_time" content="2023-02-11T21:37:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">样本熵（SampEn）计算时间序列复杂度（Python程序）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>关于样本熵，Python有<strong>第三方包sampen</strong>可以直接引用,但是对于某些序列总会出现错误（我猜测说的是分母为0，计算逻辑的错误）</p> 
<p>本来想顺着三方包进行检查，但是原包过于复杂，于是就结合网上的代码进行了修改。</p> 
<p></p> 
<p><strong>样本熵的原理网上有很多，具体如下：</strong></p> 
<p style="text-align:center;"><img alt="ed728beef5ae4c9c9d078b59de4ee050.png" height="1002" src="https://images2.imgbox.com/8c/26/YSH7L6Ko_o.png" width="500"></p> 
<p>但是我有个疑惑，<strong>如果在一个时间序列中没有符合约束的距离即Ai和Bi，那么两者相除的时候就会返回错误（因为分母是不能为0的）。此时就说明了样本熵的值是无穷∞大的，也就说明该序列是很复杂的。</strong> </p> 
<pre><code class="language-python">def SampEn(U, m, r):
    """
    用于量化时间序列的可预测性
    :param U: 时间序列
    :param m: 模板向量维数
    :param r: 距离容忍度，一般取0.1~0.25倍的时间序列标准差，也可以理解为相似度的度量阈值
    :return: 返回一个-np.log(A/B)，该值越大，序列就越复杂
    """

    def _maxdist(x_i, x_j):
        """
         Chebyshev distance
        :param x_i:
        :param x_j:
        :return:
        """
        return max([abs(ua - va) for ua, va in zip(x_i, x_j)])

    def _phi(m):
        x = [[U[j] for j in range(i, i + m - 1 + 1)] for i in range(N - m + 1)]
        C = [len([1 for j in range(len(x)) if i != j and _maxdist(x[i], x[j]) &lt;= r]) for i in range(len(x))]
        result=sum(C)/(N-m)
        return result

    N = len(U)
    return -np.log(_phi(m + 1) / _phi(m))


if __name__ == '__main__':
    m=2
    data = [0.2, 0.6, 0.7, 1.2, 55, 66]
    print(SampEn(data, m, r=0.2 * np.std(data)))</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9eab8b6058c602ce242bc58a64785772/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Why kernl miss __blk_account_io_start kprobe</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f8b5123cd92a784c7e811faa99d01cb2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">BC110 井字棋</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>