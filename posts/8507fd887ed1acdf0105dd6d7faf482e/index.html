<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>爬虫系列实战：使用json解析天气数据 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="爬虫系列实战：使用json解析天气数据" />
<meta property="og:description" content="大家好，爬虫是一项非常抢手的技能，收集、分析和清洗数据是数据科学项目中最重要的部分，本文介绍使用json解析气象局天气数据。
在官网上获取天气数据信息，可以定义当前查询的位置，提取时间、温度、湿度、气压、风速等信息，并导入requests、matplotlib这些需要用到的库。
# 导入以下模块 import requests import matplotlib.pyplot as plt import pylab as pl 1.获取今日天气
调用api接口地址，获取天气数据接口，本文获取57494代表武汉的数据接口，进而获取json数据，并判断json请求是否成功。
def get_weather(): # 调用api接口地址 # 获取57494代表武汉的天气数据接口 url = &#34;https://weather.cma.cn/api/now/57494&#34; # 获取json数据 json_datas = requests.get(url=url).json() #判断json请求是否成功？ if json_datas.get(&#34;msg&#34;) == &#34;success&#34;: # 请求成功 json_location = json_datas.get(&#34;data&#34;).get(&#34;location&#34;) # 位置信息 print(&#39;\n&#39;, &#39;当前查询的位置&#39;.center(50, &#39;—&#39;)) print(&#34;城市代码: &#34; &#43; json_location.get(&#34;id&#34;) &#43; &#34; 城市名称: &#34; &#43; json_location.get(&#34;name&#34;) &#43;&#34; 详细地址: &#34; &#43; json_location.get(&#34;path&#34;)); # 当天天气信息 json_now_data = json_datas.get(&#34;data&#34;).get(&#34;now&#34;) # 获取最新发布时间 now_time = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/8507fd887ed1acdf0105dd6d7faf482e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-17T22:59:09+08:00" />
<meta property="article:modified_time" content="2024-01-17T22:59:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">爬虫系列实战：使用json解析天气数据</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>大家好，爬虫是一项非常抢手的技能，收集、分析和清洗数据是数据科学项目中最重要的部分，本文介绍使用json解析气象局天气数据。</p> 
<p>在官网上获取天气数据信息，可以定义当前查询的位置，提取时间、温度、湿度、气压、风速等信息，并导入requests、matplotlib这些需要用到的库。</p> 
<pre><code class="language-python"># 导入以下模块
import requests
import matplotlib.pyplot as plt
import pylab as pl</code></pre> 
<p><strong>1.获取今日天气</strong></p> 
<p>调用api接口地址，获取天气数据接口，本文获取57494代表武汉的数据接口，进而获取json数据，并判断json请求是否成功。</p> 
<pre><code class="language-python">def get_weather():
    # 调用api接口地址
    # 获取57494代表武汉的天气数据接口
    url = "https://weather.cma.cn/api/now/57494"

# 获取json数据
    json_datas = requests.get(url=url).json()
    #判断json请求是否成功？
    if json_datas.get("msg") == "success":
        # 请求成功
        json_location = json_datas.get("data").get("location")
        # 位置信息
        print('\n', '当前查询的位置'.center(50, '—'))
        print("城市代码: " + json_location.get("id") + "   城市名称: " + json_location.get("name") +"   详细地址: " + json_location.get("path"));
        # 当天天气信息
        json_now_data = json_datas.get("data").get("now")

        # 获取最新发布时间
        now_time = "最新天气发布时间：" + str(json_datas.get("data").get("lastUpdate"))
        print('\n',now_time.center(50, '—'))
        print("\n温度: " + str(json_now_data.get("temperature")) + "   气压: " + str(json_now_data.get("pressure")) +"  湿度: " + str(json_now_data.get("humidity")))
        print("\n风向: " + json_now_data.get("windDirection") + "   风力等级: " + json_now_data.get("windScale"))

    else:
        # 提示失败
        print("服务器返回的数据，失败了！")</code></pre> 
<p>2.<strong>可视化显示温度曲线</strong></p> 
<p>解析json数据，获取历史最大和最小的温度数据，进行图表绘制，可视化展示温度数据，使用绘图库输出可视化结果。</p> 
<pre><code class="language-python">def get_Max_temperature():
    url = "https://weather.cma.cn/api/climate"
    # 1传数据参数
    params = {
                "stationid": 57494
            }
    # 2.获取json数据
    json_datas= requests.get(url=url, params=params).json()
    #print(json_datas)
    # 3.解析json数据,图表绘制
    data=json_datas.get("data").get("data")
    x = range(1, 13, 1) #显示12个月
    # 4.获取最大和最小的温度数据
    y = [maxTemp.get("maxTemp") for maxTemp in data]
    
    y1 = [minTemp.get("minTemp") for minTemp in data]

    pl.rcParams["font.sans-serif"] = ["SimHei"]
    plt.figure(figsize=(70, 70), dpi=100)
    plt.plot(x, y)
    plt.plot(x, y1)
    plt.xticks(x, ["{}月".format(i) for i in x])
    plt.title("1981年-2010年月平均气温和降水")
    plt.show()


if __name__ == "__main__":
    get_weather()

    get_Max_temperature()
    print('数据获取完成！！！')</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3d83e4f24dc9b0fe352f514c51e49edf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">iOS集合如何弱引用对象</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c54e2a4df04c62af5d0a113f706a60fb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Spring boot中日志文件配置(已废)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>