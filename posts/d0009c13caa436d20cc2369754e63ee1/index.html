<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>阿里云短信接口调用 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="阿里云短信接口调用" />
<meta property="og:description" content="环境准备
安装composer并切换到阿里云源
cd到项目根目录
根据阿里云示例安装 composer require alibabacloud/smsintl
直接在api/controller/common源码里引用
use AlibabaCloud\Client\AlibabaCloud; use AlibabaCloud\Client\Exception\ClientException; use AlibabaCloud\Client\Exception\ServerException; public function smsaliyun($mobile,$code){ // 此处填写你的阿里云 key 和 server AlibabaCloud::accessKeyClient(&#39;akey&#39;, &#39;skey&#39;) -&gt;regionId(&#39;cn-hangzhou&#39;) -&gt;asDefaultClient(); try { $result = AlibabaCloud::rpc() -&gt;product(&#39;Dysmsapi&#39;) // -&gt;scheme(&#39;https&#39;) // https | http -&gt;version(&#39;2017-05-25&#39;) -&gt;action(&#39;SendSms&#39;) -&gt;method(&#39;POST&#39;) -&gt;host(&#39;dysmsapi.aliyuncs.com&#39;) -&gt;options([ &#39;query&#39; =&gt; [ &#39;RegionId&#39; =&gt; &#34;cn-hangzhou&#34;, &#39;PhoneNumbers&#39; =&gt; $req[&#39;mobile&#39;], &#39;SignName&#39; =&gt; &#34;【填写你的短信模板签名】&#34;, &#39;TemplateCode&#39; =&gt; &#34;SMS_199920034【你的短信模板】&#34;, // &#39;TemplateParam&#39; =&gt; &#34;{\&#34;code\&#34;:\&#34;123456\&#34;}&#34;, &#39;TemplateParam&#39; =&gt; &#34;{\&#34;code\&#34;:\&#34;&#34;.$code.&#34;\&#34;}&#34;, ], ]) -&gt;request(); $this-&gt;success(&#39;发送成功&#39;, $result-&gt;toArray()); } catch (ClientException $e) { $this-&gt;error(&#39;发送失败&#39;,$e-&gt;getErrorMessage() ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/d0009c13caa436d20cc2369754e63ee1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-18T11:39:50+08:00" />
<meta property="article:modified_time" content="2023-01-18T11:39:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">阿里云短信接口调用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>环境准备</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>安装composer并切换到阿里云源</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>cd到项目根目录</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>根据阿里云示例安装 composer require alibabacloud/smsintl</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>直接在api/controller/common源码里引用</p></li></ul> 
 <pre class="kdocs-php"><code class="language-php">  use AlibabaCloud\Client\AlibabaCloud;
  use AlibabaCloud\Client\Exception\ClientException;
  use AlibabaCloud\Client\Exception\ServerException;
  public function smsaliyun($mobile,$code){
         
         // 此处填写你的阿里云 key 和  server
          AlibabaCloud::accessKeyClient('akey', 'skey')
              -&gt;regionId('cn-hangzhou')
              -&gt;asDefaultClient();
          try {
              $result = AlibabaCloud::rpc()
                  -&gt;product('Dysmsapi')
                  // -&gt;scheme('https') // https | http
                  -&gt;version('2017-05-25')
                  -&gt;action('SendSms')
                  -&gt;method('POST')
                  -&gt;host('dysmsapi.aliyuncs.com')
                  -&gt;options([
                      'query' =&gt; [
                          'RegionId' =&gt; "cn-hangzhou",
                          'PhoneNumbers' =&gt; $req['mobile'],
                          'SignName' =&gt; "【填写你的短信模板签名】",
                          'TemplateCode' =&gt; "SMS_199920034【你的短信模板】",
  //                        'TemplateParam' =&gt; "{\"code\":\"123456\"}",
                          'TemplateParam' =&gt; "{\"code\":\"".$code."\"}",
                      ],
                  ])
                  -&gt;request();
               $this-&gt;success('发送成功', $result-&gt;toArray());
          } catch (ClientException $e) {
              $this-&gt;error('发送失败',$e-&gt;getErrorMessage() . PHP_EOL);
          } catch (ServerException $e) {
              $this-&gt;error('发送失败',$e-&gt;getErrorMessage() . PHP_EOL);
          }
      }
</code></pre> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5760e2dee051f1d5cb94f8a93575ef46/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">HBASE shell 命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0ec94e34007c281bbc5f494449c7d698/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java后端-servlet超详细入门</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>