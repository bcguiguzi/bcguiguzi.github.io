<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Spring中的Bean管理 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Spring中的Bean管理" />
<meta property="og:description" content="Spring中的Bean管理 Spring IOC容器 Spring框架主要是通过Spring容器实现的，Spring提供了相应的API来管理Bean，最常用的是BeanFactory和ApplicationContext
BeanFactory接口 这个接口采用Java的工厂模式，这个接口提供了创建和管理Bean的方法
方法名称描述getBean(String name)根据参数名称获取BeangetBean(String name,Class &lt;T&gt;type)根据参数名称，参数类型来获取Bean&lt;T&gt;T getBean(Class&lt;T&gt;requiredType)根据参数类型获取BeanObject getBean(String name,Object…oegs)根据参数名称获取BeanisTypeMatch(String name,Resolvable Typetype)判断是否有与参数名称、参数类型匹配的BeanClass&lt;T&gt;getType(String name)根据参数名称获取类型String[] getAliase(String name)根据实例的名称获取实例的别名数组boolean containsBean(String name)根据Bean的名称判断Spring容器是否含有指定的Bean ApplicationContext接口 该接口建立在BeanFactory接口的基础之上，丰富了BeanFactory接口的特性，添加了对国际化，资源访问，事件传播等方面的支持
这个接口可以为单例的Bean实行预初始化，并根据&lt; property &gt;元素执行setter方法，单例Bean可以直接使用，提升了程序获取Bean实例的性能
类名称描述ClassPathXmlApplicationContext从类路径加载配置文件，实例化ApplicationContext接口FileSystemXmlApplicationContext从文件系统加载配置文件，实例化ApplicationContext接口AnnotationConfigApplicationContext从注解中加载配置文件，实例化ApplicationContext接口WebApplicationContext从Web应用中使用，从相对于Web根目录的路径中加载配置文件，实例化ApplicationContex接口ConfigurableWebApplicationContext扩展了WebApplicationContext类，可以通过读取XML配置文件的方式实例化WebApplicationContext接口 Bean配置 在Spring中XML配置文件的根元素是&lt; beans &gt;,包含&lt; bean &gt;子元素，每个子元素可以定义一个Bean，通过&lt; bean &gt;元素将Bean注册到Spring容器中
&lt; bean &gt;元素中的常用属性 id 唯一标识符，Spring容器对Bean的配置和管理通过id属性完成，装配Bean时也需要根据id值获取对象name 可以为Bean指定多个名称class 只当Bean的具体实现类，其属性为对象所属类的全路径scope 设定Bean实例的作用范围 &lt; bean &gt;元素常用的子元素 &lt; constructor-arg &gt;可以为Bean的属性指定值，具有以下属性 index:用于设置构造参数的序号type:用于指定构造参数类型ref:用于指定参数值value:用于指定参数值(参数值也可以通过ref和value的子元素指定) &lt; property &gt;是调用Bean实例中的setter方法完成属性赋值，从而完成依赖注入 name:指定Bean实例中的属性名ref:用于指定参数值value:一样 ref:是上面两个元素的属性，用于指定Bean工厂中某个Bean实例的引用value:用于指定一个常量值&lt; list &gt; 用于指定Bean属性类型为List或数组&lt; set &gt; 指定属性类型为Set&lt; map &gt;同上&lt; entry &gt; 该元素是&lt; map &gt;的子元素，用于设置一个键值对。&lt; entry &gt;元素的key属性用于指定字符串类型的键，用ref和value子元素指定&lt; entry &gt;元素的值，或者value-ref又或者value指定&lt; entry &gt; 元素的值 Bean的实例化 构造方法的实例化 构造方法实例化是☞Spring容器通过Bean对应类中默认的无参构造方法来实例化Bean" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/c37b74edbcbcba1d4bf4caeb7368c51f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-26T20:39:48+08:00" />
<meta property="article:modified_time" content="2023-05-26T20:39:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Spring中的Bean管理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="SpringBean_0"></a>Spring中的Bean管理</h2> 
<h3><a id="Spring_IOC_2"></a>Spring IOC容器</h3> 
<p>Spring框架主要是通过Spring容器实现的，Spring提供了相应的API来管理Bean，最常用的是BeanFactory和ApplicationContext</p> 
<h4><a id="BeanFactory_6"></a>BeanFactory接口</h4> 
<p>这个接口采用Java的工厂模式，这个接口提供了创建和管理Bean的方法</p> 
<table><thead><tr><th>方法名称</th><th>描述</th></tr></thead><tbody><tr><td>getBean(String name)</td><td>根据参数名称获取Bean</td></tr><tr><td>getBean(String name,Class &lt;T&gt;type)</td><td>根据参数名称，参数类型来获取Bean</td></tr><tr><td>&lt;T&gt;T getBean(Class&lt;T&gt;requiredType)</td><td>根据参数类型获取Bean</td></tr><tr><td>Object getBean(String name,Object…oegs)</td><td>根据参数名称获取Bean</td></tr><tr><td>isTypeMatch(String name,Resolvable Typetype)</td><td>判断是否有与参数名称、参数类型匹配的Bean</td></tr><tr><td>Class&lt;T&gt;getType(String name)</td><td>根据参数名称获取类型</td></tr><tr><td>String[] getAliase(String name)</td><td>根据实例的名称获取实例的别名数组</td></tr><tr><td>boolean containsBean(String name)</td><td>根据Bean的名称判断Spring容器是否含有指定的Bean</td></tr></tbody></table> 
<h4><a id="ApplicationContext_21"></a>ApplicationContext接口</h4> 
<p>该接口建立在BeanFactory接口的基础之上，丰富了BeanFactory接口的特性，添加了对国际化，资源访问，事件传播等方面的支持</p> 
<p>这个接口可以为单例的Bean实行预初始化，并根据&lt; property &gt;元素执行setter方法，单例Bean可以直接使用，提升了程序获取Bean实例的性能</p> 
<table><thead><tr><th>类名称</th><th>描述</th></tr></thead><tbody><tr><td>ClassPathXmlApplicationContext</td><td>从类路径加载配置文件，实例化ApplicationContext接口</td></tr><tr><td>FileSystemXmlApplicationContext</td><td>从文件系统加载配置文件，实例化ApplicationContext接口</td></tr><tr><td>AnnotationConfigApplicationContext</td><td>从注解中加载配置文件，实例化ApplicationContext接口</td></tr><tr><td>WebApplicationContext</td><td>从Web应用中使用，从相对于Web根目录的路径中加载配置文件，实例化ApplicationContex接口</td></tr><tr><td>ConfigurableWebApplicationContext</td><td>扩展了WebApplicationContext类，可以通过读取XML配置文件的方式实例化WebApplicationContext接口</td></tr></tbody></table> 
<h3><a id="Bean_35"></a>Bean配置</h3> 
<p>在Spring中XML配置文件的根元素是&lt; beans &gt;,包含&lt; bean &gt;子元素，每个子元素可以定义一个Bean，通过&lt; bean &gt;元素将Bean注册到Spring容器中</p> 
<ul><li>&lt; bean &gt;元素中的常用属性 
  <ul><li>id 唯一标识符，Spring容器对Bean的配置和管理通过id属性完成，装配Bean时也需要根据id值获取对象</li><li>name 可以为Bean指定多个名称</li><li>class 只当Bean的具体实现类，其属性为对象所属类的全路径</li><li>scope 设定Bean实例的作用范围</li></ul> </li><li>&lt; bean &gt;元素常用的子元素 
  <ul><li>&lt; constructor-arg &gt;可以为Bean的属性指定值，具有以下属性 
    <ul><li>index:用于设置构造参数的序号</li><li>type:用于指定构造参数类型</li><li>ref:用于指定参数值</li><li>value:用于指定参数值(参数值也可以通过ref和value的子元素指定)</li></ul> </li><li>&lt; property &gt;是调用Bean实例中的setter方法完成属性赋值，从而完成依赖注入 
    <ul><li>name:指定Bean实例中的属性名</li><li>ref:用于指定参数值</li><li>value:一样</li></ul> </li><li>ref:是上面两个元素的属性，用于指定Bean工厂中某个Bean实例的引用</li><li>value:用于指定一个常量值</li><li>&lt; list &gt; 用于指定Bean属性类型为List或数组</li><li>&lt; set &gt; 指定属性类型为Set</li><li>&lt; map &gt;同上</li><li>&lt; entry &gt; 该元素是&lt; map &gt;的子元素，用于设置一个键值对。&lt; entry &gt;元素的key属性用于指定字符串类型的键，用ref和value子元素指定&lt; entry &gt;元素的值，或者value-ref又或者value指定&lt; entry &gt; 元素的值</li></ul> </li></ul> 
<h3><a id="Bean_61"></a>Bean的实例化</h3> 
<h4><a id="_63"></a>构造方法的实例化</h4> 
<p>构造方法实例化是☞Spring容器通过Bean对应类中默认的无参构造方法来实例化Bean</p> 
<p>在类中自定义无参构造方法，在applicationBean1.xml文件中配置一个id为bean1的Bean，通过class属性指定对应的实现类为Bean1，创建测试文件进行测试，测试成功便表明Spring容器成功调用Bean1类的默认构造方法完成了实例化</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>yjw</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Bean1</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token class-name">Bean1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"这是Bean1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>beans xmlns<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/beans"</span>
       xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span>
       xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span>"http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans
   http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans<span class="token operator">/</span>spring<span class="token operator">-</span>beans<span class="token punctuation">.</span>xsd"<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"bean1"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.yjw.Bean1"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>beans<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="_90"></a>静态工厂实例化</h4> 
<p>使用静态工厂实例化Bean时，还要定义一个静态工厂类，用静态工厂类中的方法创建Bean实例，此时的Bean配置文件class属性指定的不再是Bean的实现类，而是定义的静态工厂类；还要使用&lt; bean &gt; 元素的factory-method属性指定所定义的静态工厂方法</p> 
<p>bean元素配置</p> 
<p>通过factory-method属性指定静态工厂方法</p> 
<pre><code class="prism language-java"> <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"bean2"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.yjw.MyBean2Factory"</span> factory<span class="token operator">-</span>method<span class="token operator">=</span><span class="token string">"createBean"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
</code></pre> 
<p>创建MyBean2Factory类，定义静态方法用来创建Bean的实例</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBean2Factory</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Bean2</span> <span class="token function">createBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Bean2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_112"></a>实例工厂实例化</h4> 
<p>就是直接创建 Bean实例；在XML配置文件中，不使用class属性指向Bean所指向的类，而是使用factory-bean属性指向为Bean配置的实例工厂，并用factory-method属性指定要调用的实例工厂方法</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>yjw</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBean3Factory</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token class-name">MyBean3Factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"工厂实例化中："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Bean3</span> <span class="token function">createBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Bean3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-java">   <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"myBean3Factory"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.yjw.MyBean3Factory"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"bean3"</span> factory<span class="token operator">-</span>bean<span class="token operator">=</span><span class="token string">"myBean3Factory"</span> factory<span class="token operator">-</span>method<span class="token operator">=</span><span class="token string">"createBean"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
</code></pre> 
<p>createBean方法时非静态的，所以要创建工厂的实例才能调用，所以创建了两个Bean，一个是工厂，另一个是Bean3的实例</p> 
<h3><a id="Bean_137"></a>Bean的作用域</h3> 
<p>Sprinag容器创建一个Bean实例时，可以为该Bean指定作用域，也就是Bean实例的有效范围；使用scope属性来指定作用域</p> 
<ul><li>singleton：单例模式。Spring容器只能存在一个共享的Bean实例，只要请求id或name与Bean的定义相匹配，就会返回Bean的同一个实例</li><li>prototype：原型模式：每次从容器请求bean时，都会产生一个新的实例</li><li>request：每个HTTP请求都会有一个Bean实例，该作用域只能基于Web的Spring ApplicationContext中使用</li><li>session：每个HttpSession请求都会有自己的Bean实例，该作用域只能基于Web的Spring ApplicationContext中使用</li><li>global session：限定一个Bean的作用域为Web应用(HttpSession)的声明周期，只有在Web中使用Spring时该作用域才有效</li></ul> 
<h3><a id="Bean_147"></a>Bean的装配方式</h3> 
<p>也就是依赖的注入，分别有三种常见方式：基于XML装配，基于注解装配以及自动装配</p> 
<h4><a id="XML_151"></a>基于XML的装配</h4> 
<p>也就是读取xml文件中的信息完成依赖注入，而基于XML的装配方式也有两种：setter方法注入和构造方法注入，之前笔记就有，我就不写了</p> 
<h4><a id="_155"></a>基于注解装配</h4> 
<p>常用注解：</p> 
<ul><li>@Component：指定一个普通的Bean，可以作用于任何层次</li><li>@Controller：指定一个控制器组件Bean，将控制层的类标识为Spring中的Bean，功能上等同于@Component</li><li>@Service：指定一个业务逻辑组件Bean，用于将业务逻辑层的类标识为Bean，功能上也等同于第一个</li><li>@Repository：指定一个数据访问组件Bean，用于将数据访问层的类标识为Spring中的Bean功能上等同于第一个</li><li>@Scope：指定Bean实例的作用域</li><li>@Value：指定Bean实例的注入值</li><li>@Autowired：指定要自动装配的对象</li><li>@Resource：指定要注入的对象</li><li>@Qualifier：指定要自动装配的对象名称，通常域@Autowired联合使用</li><li>@PostConstruct：指定Bean实例完成初始化后调用的方法</li><li>@PreDestroy：指定Bean实例销毁前的方法</li></ul> 
<p>具体步骤：</p> 
<ol><li> <p>导入依赖</p> <pre><code class="prism language-java">        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>aop<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.2</span><span class="token number">.8</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> </li><li> <p>创建xml配置文件</p> <pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>beans xmlns<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/beans"</span>
       xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span>
       xmlns<span class="token operator">:</span>context<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/context"</span>
       xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span>"http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans
   http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans<span class="token operator">/</span>spring<span class="token operator">-</span>beans<span class="token punctuation">.</span>xsd
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context<span class="token operator">/</span>spring<span class="token operator">-</span>context<span class="token punctuation">.</span>xsd"<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>context<span class="token operator">:</span>component<span class="token operator">-</span>scan base<span class="token operator">-</span><span class="token keyword">package</span><span class="token operator">=</span><span class="token string">"com.yjw"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>beans<span class="token operator">&gt;</span>
</code></pre> </li><li> <p>定义实体类</p> <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>yjw<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Scope</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Component</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Scope</span><span class="token punctuation">(</span><span class="token string">"singleton"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> password<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token string">"id="</span><span class="token operator">+</span>id<span class="token operator">+</span><span class="token string">",name="</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">",password="</span><span class="token operator">+</span>password<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> </li><li> <p>定义DAO层</p> </li><li> <p>实现dao层</p> <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>yjw<span class="token punctuation">.</span>dao</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>yjw<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">User</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">ApplicationContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Repository</span><span class="token punctuation">;</span>

<span class="token comment">//使用注解，将数据访问层标识为Spring中的Bean</span>
<span class="token annotation punctuation">@Repository</span><span class="token punctuation">(</span><span class="token string">"userDao"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDaoImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">"applicationContext.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span>applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"执行UserDaoImpl.save()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>定义Service层</p> </li><li> <p>实现Service层</p> <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>yjw<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>yjw<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">UserDao</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span><span class="token punctuation">(</span><span class="token string">"userService"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//使用@Resource指定要注入的对象</span>
        <span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"userDao"</span><span class="token punctuation">)</span>
        <span class="token keyword">private</span> <span class="token class-name">UserDao</span> userDao<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"执行UserServiceImpl.save()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>定义Controller层</p> <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>yjw<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>yjw<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">UserService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Controller</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//注入userService</span>
    <span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"userService"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"执行UserController.save()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> </li><li> <p>定义测试类</p> <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>yjw</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>yjw<span class="token punctuation">.</span>controller<span class="token punctuation">.</span></span><span class="token class-name">UserController</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">ApplicationContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AnnotationTest</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">"applicationContext.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">UserController</span> userController <span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">UserController</span><span class="token punctuation">)</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"userController"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userController<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> </li></ol> 
<p>DAO(Data Access Object)数据访问层，负责与数据库进行交互，负责数据的增删改查操作</p> 
<p>Service业务逻辑层：负责对业务逻辑进行处理，对数据进行加工和封装</p> 
<p>Controller控制层：负责接收来自用于请求并调用相应的业务逻辑处理，将处理结果返回给用户</p> 
<h4><a id="_355"></a>自动装配</h4> 
<p>Spring中的&lt; bean &gt;元素包含一个autowire属性，可以通过设置该属性实现Bean的自动装配</p> 
<ul><li>default：有&lt; bean &gt;的上级元素的default-autowire属性值确定</li><li>byName：根据bean元素id属性自动装配</li><li>byType：根据bean元素的数据类型(Type)自动装配，如果一个Bean的数据类型兼容另一个Bean中的数据类型，则自动装配</li><li>construct：根据构造函数的数据类型进行byType模式自动装配</li><li>no：默认值，不使用自动装配，Bean依赖必须通过&lt; ref &gt;元素或ref属性定义</li></ul> 
<h3><a id="Bean_365"></a>Bean的生命周期</h3> 
<p>Bean的生命周期指的时Bean实例被创建，初始化和销毁的过程。在Bean的两种作用域中，singleton和prototype中，前者Spring容器可以管理Bean的生命周期，控制Bean的创建初始化和销毁；在prototype作用域中，Spring容器只会创建实例，不会管理其生命周期</p> 
<p>因此在Bean的生命周期中有两个节点非常重要，一个是Bean实例刚刚完成初始化，另一个时Bean实例被销毁之前，这两个时间点通常需要完成一些指定的操作；因此需要对这两个结点进行监控；可以使用注解来完成</p> 
<p>@PostConstruct：指定Bean实例完成初始化后调用的方法，用于监控Bean对象初始化的节点<br> @PreDestroy：指定Bean实例销毁前的方法，用于监控Bean对象的销毁节点</p> 
<p>监控时可以将这两个注解标注在特定的方法上</p> 
<h2><a id="_376"></a>总结</h2> 
<ul><li> <p>了解Bean的配置以及，以及bean元素的常用属性以及子属性</p> </li><li> <p>了解Bean实例化的三种方法</p> 
  <ul><li>使用构造方法进行Bean的实例化</li><li>创建工厂类，定义静态工厂方法，bean配置指向静态工厂类和静态工厂方法</li><li>创建工厂的Bean实例，在bean配置中在用相应属性指向工厂的Bean以及实例工厂方法</li></ul> </li><li> <p>了解Bean的作用域</p> </li><li> <p>了解Bean的装配方式</p> 
  <ul><li>基于XML装配：也就是setter方法注入以及构造方法注入</li><li>注解装配，了解相关注解的作用，用相关注解来注册Bean以及注入数值，并构建dao层，service层以及controller层</li><li>自动装配</li></ul> </li><li> <p>Bean的生命周期</p> <p>使用相关注解来监控Bean实例初始化以及被被销毁前的动作</p> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d53ec62c7e4172e9ef3078976e624382/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">4.hadoop集群扩容与hive异常处理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/97e3766744a5247eba8103740fe410a7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringMVC框架面试专题（初级-中级）-第五节</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>