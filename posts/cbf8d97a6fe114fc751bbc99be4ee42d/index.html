<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python批量提取Word文档表格数据 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python批量提取Word文档表格数据" />
<meta property="og:description" content="在大数据处理与信息抽取领域中，Word文档是各类机构和个人普遍采用的一种信息存储格式，其中包含了大量的结构化和半结构化数据，如各类报告、调查问卷结果、项目计划等。这些文档中的表格往往承载了关键的数据信息，如统计数据、项目进度、研究成果等。然而，手动从大量的Word文档中逐一摘取并整理这些表格不仅耗时费力，且易出错，无法满足高效、准确的数据利用需求。因此，利用编程实现批量提取Word文档中的表格成为了一种必要且高效的解决方案。Python作为一种功能强大、易学易用的编程语言，可以有效地实现这一目标，极大地提升数据采集和预处理的工作效率，同时也为后续的数据分析和应用提供强有力的支持。本文将介绍如何使用Python实现对Word文档中表格的提取。
文章目录 提取Word文档表格并保存为Excel工作表提取Word文档表格并保存为CSV文件 本文所使用的方法需要用到Spire.Doc for Python，可从官网获取。如果是将表格保存到Excel工作表，则还需要用到Spire.XLS for Python。
提取Word文档表格并保存为Excel工作表 读取Word文档中的表格并写入Excel工作簿需要同时用到这两个库。以下是操作步骤：
创建 Document 和 Workbook 对象。使用 Document 类的 LoadFromFile() 方法载入指定路径下的 Word 文档。清除 Workbook 中的所有工作表。遍历加载的 Word 文档中的所有节（Sections）。在每个节中，遍历其包含的所有表格（Tables）。对于每一个表格，创建一个新的 Excel 工作表，并根据表格索引为其命名。遍历表格中的每一行（Rows），并获取当前行对象。再次遍历该行中的所有单元格（Cells），获取单元格对象。对于每个单元格，将其包含的段落内容合并为一个字符串（cellText）。使用 Workbook 的工作表对象的 SetCellValue() 方法将合并后的单元格文本内容写入到对应的工作表中。完成所有表格数据的写入后，使用 Workbook 的 SaveToFile() 方法将 Excel 数据保存到指定路径。 代码示例：
from spire.doc import * from spire.doc.common import * from spire.xls import * from spire.xls.common import * # 创建Document对象 doc = Document() # 载入Word文档 doc.LoadFromFile(&#34;示例.docx&#34;) # 创建Workbook对象 wb = Workbook() wb.Worksheets.Clear() # 遍历文档中的节 for i in range(doc." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/cbf8d97a6fe114fc751bbc99be4ee42d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-11T15:14:35+08:00" />
<meta property="article:modified_time" content="2024-03-11T15:14:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python批量提取Word文档表格数据</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>在大数据处理与信息抽取领域中，Word文档是各类机构和个人普遍采用的一种信息存储格式，其中包含了大量的结构化和半结构化数据，如各类报告、调查问卷结果、项目计划等。这些文档中的表格往往承载了关键的数据信息，如统计数据、项目进度、研究成果等。然而，手动从大量的Word文档中逐一摘取并整理这些表格不仅耗时费力，且易出错，无法满足高效、准确的数据利用需求。因此，利用编程实现批量提取Word文档中的表格成为了一种必要且高效的解决方案。Python作为一种功能强大、易学易用的编程语言，可以有效地实现这一目标，极大地提升数据采集和预处理的工作效率，同时也为后续的数据分析和应用提供强有力的支持。本文将介绍如何<strong>使用Python实现对Word文档中表格的提取</strong>。</p> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#WordExcel_6" rel="nofollow">提取Word文档表格并保存为Excel工作表</a></li><li><a href="#WordCSV_73" rel="nofollow">提取Word文档表格并保存为CSV文件</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p>本文所使用的方法需要用到<a href="https://www.e-iceblue.cn/Downloads/Spire-Doc-Python.html" rel="nofollow">Spire.Doc for Python</a>，可从官网获取。如果是将表格保存到Excel工作表，则还需要用到<a href="https://www.e-iceblue.cn/Downloads/Spire-XLS-Python.html" rel="nofollow">Spire.XLS for Python</a>。</p> 
<h3><a id="WordExcel_6"></a>提取Word文档表格并保存为Excel工作表</h3> 
<p>读取Word文档中的表格并写入Excel工作簿需要同时用到这两个库。以下是操作步骤：</p> 
<ol><li>创建 <strong>Document</strong> 和 <strong>Workbook</strong> 对象。</li><li>使用 <strong>Document</strong> 类的 <strong>LoadFromFile()</strong> 方法载入指定路径下的 Word 文档。</li><li>清除 <strong>Workbook</strong> 中的所有工作表。</li><li>遍历加载的 Word 文档中的所有节（<strong>Sections</strong>）。</li><li>在每个节中，遍历其包含的所有表格（<strong>Tables</strong>）。</li><li>对于每一个表格，创建一个新的 Excel 工作表，并根据表格索引为其命名。</li><li>遍历表格中的每一行（<strong>Rows</strong>），并获取当前行对象。</li><li>再次遍历该行中的所有单元格（<strong>Cells</strong>），获取单元格对象。</li><li>对于每个单元格，将其包含的段落内容合并为一个字符串（cellText）。</li><li>使用 <strong>Workbook</strong> 的工作表对象的 <strong>SetCellValue()</strong> 方法将合并后的单元格文本内容写入到对应的工作表中。</li><li>完成所有表格数据的写入后，使用 <strong>Workbook</strong> 的 <strong>SaveToFile()</strong> 方法将 Excel 数据保存到指定路径。</li></ol> 
<p><strong>代码示例：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> spire<span class="token punctuation">.</span>doc <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> spire<span class="token punctuation">.</span>doc<span class="token punctuation">.</span>common <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> spire<span class="token punctuation">.</span>xls <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> spire<span class="token punctuation">.</span>xls<span class="token punctuation">.</span>common <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># 创建Document对象</span>
doc <span class="token operator">=</span> Document<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 载入Word文档</span>
doc<span class="token punctuation">.</span>LoadFromFile<span class="token punctuation">(</span><span class="token string">"示例.docx"</span><span class="token punctuation">)</span>

<span class="token comment"># 创建Workbook对象</span>
wb <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
wb<span class="token punctuation">.</span>Worksheets<span class="token punctuation">.</span>Clear<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 遍历文档中的节</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>Sections<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 获取一个节</span>
    section <span class="token operator">=</span> doc<span class="token punctuation">.</span>Sections<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token comment"># 遍历节中的表格</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>section<span class="token punctuation">.</span>Tables<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取一个表格</span>
        table <span class="token operator">=</span> section<span class="token punctuation">.</span>Tables<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span>j<span class="token punctuation">)</span>
        <span class="token comment"># 创建一个工作表</span>
        ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>Worksheets<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"表 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token comment"># 将表格数据写入工作表</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 获取一行</span>
            tableRow <span class="token operator">=</span> table<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span>row<span class="token punctuation">)</span>
            <span class="token comment"># 遍历一行中的单元格</span>
            <span class="token keyword">for</span> cell <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>tableRow<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># 获取一个单元格</span>
                tableCell <span class="token operator">=</span> tableRow<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span>cell<span class="token punctuation">)</span>
                <span class="token comment"># 获取单元格的内容</span>
                cellText <span class="token operator">=</span> <span class="token string">""</span>
                <span class="token keyword">for</span> paragraph <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>tableCell<span class="token punctuation">.</span>Paragraphs<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    paragraph <span class="token operator">=</span> tableCell<span class="token punctuation">.</span>Paragraphs<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span>
                    cellText <span class="token operator">=</span> cellText <span class="token operator">+</span> paragraph<span class="token punctuation">.</span>Text
                <span class="token comment"># 将单元格的内容写入工作表</span>
                ws<span class="token punctuation">.</span>SetCellValue<span class="token punctuation">(</span>row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> cell <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> cellText<span class="token punctuation">)</span>

wb<span class="token punctuation">.</span>SaveToFile<span class="token punctuation">(</span><span class="token string">"output/Word表格写入Excel.xlsx"</span><span class="token punctuation">,</span> FileFormat<span class="token punctuation">.</span>Version2016<span class="token punctuation">)</span>
doc<span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span>
wb<span class="token punctuation">.</span>Dispose<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>提取结果</strong></p> 
<p><img src="https://images2.imgbox.com/c9/56/WegSXW0s_o.png" alt="Python提取Word表格保存为Excel工作表"></p> 
<h3><a id="WordCSV_73"></a>提取Word文档表格并保存为CSV文件</h3> 
<p>CSV文件以文本的文件的形式储存表格数据，因此，我们可以直接使用Spire.Doc for Python提取Word文档中的表格数据并写入到CSV文件。以下是操作步骤：</p> 
<ol><li>创建 <strong>Document</strong> 对象。</li><li>使用 <strong>Document</strong> 类的 <strong>LoadFromFile()</strong> 方法载入指定路径下的 Word 文档。</li><li>遍历载入的 Word 文档中的所有节（Sections）。</li><li>在每个节内，进一步遍历其包含的所有表格（Tables）。</li><li>对于每个表格，生成对应的 CSV 文件名，并以写模式打开这个文件，设置编码为 UTF-8 并开启新行模式。</li><li>创建 <strong>csv.writer</strong> 对象用于写入 CSV 文件内容。</li><li>根据表格的列数动态生成 CSV 文件的标题行（列名），并用 writerow() 方法写入到CSV文件中。</li><li>遍历当前表格的每一行（Rows），获取当前行对象。</li><li>对于每一行中的每个单元格，只提取第一个段落的文本内容，形成一行的数据列表。</li><li>使用 csv.writer 对象的 writerow() 方法将这一行的数据列表写入到对应的 CSV 文件中。</li><li>在完成一个表格的所有数据写入后，关闭已打开的 CSV 文件。</li><li>继续处理下一个表格，直至遍历完所有表格。</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">import</span> csv
<span class="token keyword">from</span> spire<span class="token punctuation">.</span>doc <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># 创建Document对象</span>
doc <span class="token operator">=</span> Document<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 载入Word文档</span>
doc<span class="token punctuation">.</span>LoadFromFile<span class="token punctuation">(</span><span class="token string">"示例.docx"</span><span class="token punctuation">)</span>

<span class="token comment"># 遍历文档中的节</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>Sections<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 获取一个节</span>
    section <span class="token operator">=</span> doc<span class="token punctuation">.</span>Sections<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token comment"># 遍历节中的表格</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>section<span class="token punctuation">.</span>Tables<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取一个表格</span>
        table <span class="token operator">=</span> section<span class="token punctuation">.</span>Tables<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span>j<span class="token punctuation">)</span>
        
        <span class="token comment"># 创建CSV文件名并打开文件</span>
        csv_file_name <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"output/CSV/表_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">.csv"</span></span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>csv_file_name<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>
            writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>csvfile<span class="token punctuation">)</span>
       
            <span class="token comment"># 遍历表格中的每一行</span>
            <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># 获取一行</span>
                tableRow <span class="token operator">=</span> table<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span>row<span class="token punctuation">)</span>
                
                <span class="token comment"># 读取一行中的单元格内容，只取每个单元格的第一个段落</span>
                row_data <span class="token operator">=</span> <span class="token punctuation">[</span>tableRow<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>get_Item<span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">.</span>Paragraphs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Text <span class="token keyword">for</span> cell <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>tableRow<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">]</span>
                
                <span class="token comment"># 将单元格内容写入CSV文件</span>
                writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>row_data<span class="token punctuation">)</span>

doc<span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>提取结果：</strong></p> 
<p><img src="https://images2.imgbox.com/8a/49/gzNUnWBR_o.png" alt="Python提取Word表格保存为CSV文件"></p> 
<p>以上内容讲述了如何通过Python提取Word文档中的表格，并转换为Excel工作表或CSV文件。<br> Spire.Doc for Python还支持许多其他功能，请前往<a href="https://www.e-iceblue.cn/docforpython/spire-doc-for-python-program-guide-content.html" rel="nofollow">Spire.Doc for Python教程</a>查看。</p> 
<p><strong><a href="https://www.e-iceblue.com/TemLicense.html" rel="nofollow">申请免费许可</a></strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a00cf052fd44e912f96cc12a48d700b6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">手机和电脑同步的好用记事本软件有哪些</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c9177f2265826962556330009888ad82/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">HTML 学习笔记(十一)表单</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>