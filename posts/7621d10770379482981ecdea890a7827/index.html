<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>geth控制台控制 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="geth控制台控制" />
<meta property="og:description" content="目录
geth控制台控制
启动控制台：输出结果直接显示
启动控制台：控制台输出结果写入 output.log 文件，但不能连接MetaMask
退出控制台 常用命令
开始挖矿
停止挖矿
转账
问题：出现报错 password or unlock
问题：出现 invalid sender 报错，可能是你的 gensis.json 缺少了东西
问题：查看账户发现并没有成功转账出去，账户金额没有变化
外部连接 MetaMask
win10 metamask 连接 localhost 8584
win10使用 metamask 连接虚拟机 ubuntu 中的私有链
问题：--dev引发的错误：Failed to unlock developer account
问题：使用最新版本geth，当执行personal.unlockAccount()或在程序中调用personal_unlockAccount接口时，会出现：account unlock with HTTP access is forbidden异常
问题：the method net_version does not exist/is not available
查看交易记录
方法一：根据交易id查询
方法二：根据区块id查询
geth控制台控制 主机win10， 在Ubuntu中使用geth创建私有链
启动控制台：输出结果直接显示 启动私有链代码末尾，加上 console 可以在启动私有链时，启动控制台
/geth --datadir ~/桌面/geth-project/myChain --networkid 15 console 启动控制台：控制台输出结果写入 output." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/7621d10770379482981ecdea890a7827/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-08T17:10:47+08:00" />
<meta property="article:modified_time" content="2022-03-08T17:10:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">geth控制台控制</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p></p> 
<p id="main-toc-toc" style="margin-left:0px;"><a href="#main-toc" rel="nofollow">geth控制台控制</a></p> 
<p id="%E5%90%AF%E5%8A%A8%E6%8E%A7%E5%88%B6%E5%8F%B0-toc" style="margin-left:40px;"><a href="#%E5%90%AF%E5%8A%A8%E6%8E%A7%E5%88%B6%E5%8F%B0" rel="nofollow">启动控制台：输出结果直接显示</a></p> 
<p id="%E6%8E%A8%E8%8D%90%E5%86%99%E6%B3%95%EF%BC%9A%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C%E5%86%99%E5%85%A5%20output.log%20%E6%96%87%E4%BB%B6-toc" style="margin-left:40px;"><a href="#%E6%8E%A8%E8%8D%90%E5%86%99%E6%B3%95%EF%BC%9A%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C%E5%86%99%E5%85%A5%20output.log%20%E6%96%87%E4%BB%B6" rel="nofollow">启动控制台：控制台输出结果写入 output.log 文件，但不能连接MetaMask</a></p> 
<p id="%E9%80%80%E5%87%BA%E6%8E%A7%E5%88%B6%E5%8F%B0%C2%A0-toc" style="margin-left:40px;"><a href="#%E9%80%80%E5%87%BA%E6%8E%A7%E5%88%B6%E5%8F%B0%C2%A0" rel="nofollow">退出控制台 </a></p> 
<p style="margin-left:40px;"></p> 
<p id="%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4-toc" style="margin-left:0px;"><a href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4" rel="nofollow">常用命令</a></p> 
<p id="%E5%BC%80%E5%90%AF%E6%8C%96%E7%9F%BF%E6%96%B9%E6%B3%95-toc" style="margin-left:40px;"><a href="#%E5%BC%80%E5%90%AF%E6%8C%96%E7%9F%BF%E6%96%B9%E6%B3%95" rel="nofollow">开始挖矿</a></p> 
<p id="%E5%81%9C%E6%AD%A2%E6%8C%96%E7%9F%BF-toc" style="margin-left:40px;"><a href="#%E5%81%9C%E6%AD%A2%E6%8C%96%E7%9F%BF" rel="nofollow">停止挖矿</a></p> 
<p id="%E8%BD%AC%E8%B4%A6-toc" style="margin-left:40px;"><a href="#%E8%BD%AC%E8%B4%A6" rel="nofollow">转账</a></p> 
<p id="%E9%97%AE%E9%A2%98%EF%BC%9A%E5%87%BA%E7%8E%B0%E6%8A%A5%E9%94%99%20password%20or%20unlock-toc" style="margin-left:80px;"><a href="#%E9%97%AE%E9%A2%98%EF%BC%9A%E5%87%BA%E7%8E%B0%E6%8A%A5%E9%94%99%20password%20or%20unlock" rel="nofollow">问题：出现报错 password or unlock</a></p> 
<p id="%E9%97%AE%E9%A2%98%EF%BC%9A%E5%A6%82%E6%9E%9C%E5%87%BA%E7%8E%B0%20invalid%20sender%20%E6%8A%A5%E9%94%99%EF%BC%8C%E5%8F%AF%E8%83%BD%E6%98%AF%E4%BD%A0%E7%9A%84%20gensis.json%20%E7%BC%BA%E5%B0%91%E4%BA%86%E4%B8%9C%E8%A5%BF-toc" style="margin-left:80px;"><a href="#%E9%97%AE%E9%A2%98%EF%BC%9A%E5%A6%82%E6%9E%9C%E5%87%BA%E7%8E%B0%20invalid%20sender%20%E6%8A%A5%E9%94%99%EF%BC%8C%E5%8F%AF%E8%83%BD%E6%98%AF%E4%BD%A0%E7%9A%84%20gensis.json%20%E7%BC%BA%E5%B0%91%E4%BA%86%E4%B8%9C%E8%A5%BF" rel="nofollow">问题：出现 invalid sender 报错，可能是你的 gensis.json 缺少了东西</a></p> 
<p id="%E9%97%AE%E9%A2%98%EF%BC%9A%E4%BD%86%E6%98%AF%E6%AD%A4%E6%97%B6%E4%BD%A0%E6%9F%A5%E7%9C%8B%E8%B4%A6%E6%88%B7%E5%8F%AF%E4%BB%A5%E5%8F%91%E7%8E%B0%E5%B9%B6%E6%B2%A1%E6%9C%89%E6%88%90%E5%8A%9F%E8%BD%AC%E8%B4%A6%E5%87%BA%E5%8E%BB%EF%BC%8C%E8%B4%A6%E6%88%B7%E9%87%91%E9%A2%9D%E6%B2%A1%E6%9C%89%E5%8F%98%E5%8C%96-toc" style="margin-left:80px;"><a href="#%E9%97%AE%E9%A2%98%EF%BC%9A%E4%BD%86%E6%98%AF%E6%AD%A4%E6%97%B6%E4%BD%A0%E6%9F%A5%E7%9C%8B%E8%B4%A6%E6%88%B7%E5%8F%AF%E4%BB%A5%E5%8F%91%E7%8E%B0%E5%B9%B6%E6%B2%A1%E6%9C%89%E6%88%90%E5%8A%9F%E8%BD%AC%E8%B4%A6%E5%87%BA%E5%8E%BB%EF%BC%8C%E8%B4%A6%E6%88%B7%E9%87%91%E9%A2%9D%E6%B2%A1%E6%9C%89%E5%8F%98%E5%8C%96" rel="nofollow">问题：查看账户发现并没有成功转账出去，账户金额没有变化</a></p> 
<p style="margin-left:80px;"></p> 
<p id="%E5%A4%96%E9%83%A8%E8%BF%9E%E6%8E%A5-toc" style="margin-left:0px;"><a href="#%E5%A4%96%E9%83%A8%E8%BF%9E%E6%8E%A5" rel="nofollow">外部连接 MetaMask</a></p> 
<p id="%E9%97%AE%E9%A2%98%EF%BC%9A%E5%A6%82%E6%9E%9C%E5%B8%8C%E6%9C%9B%20matemask%C2%A0%E5%A4%96%E9%83%A8%E5%8F%AF%E4%BB%A5%E8%BF%9E%E6%8E%A5%E5%88%B0%20localhost%208584-toc" style="margin-left:40px;"><a href="#%E9%97%AE%E9%A2%98%EF%BC%9A%E5%A6%82%E6%9E%9C%E5%B8%8C%E6%9C%9B%20matemask%C2%A0%E5%A4%96%E9%83%A8%E5%8F%AF%E4%BB%A5%E8%BF%9E%E6%8E%A5%E5%88%B0%20localhost%208584" rel="nofollow"> win10 metamask 连接 localhost 8584</a></p> 
<p id="%E9%97%AE%E9%A2%98%EF%BC%9Awin10%E4%BD%BF%E7%94%A8%20metamask%20%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5%E8%99%9A%E6%8B%9F%E6%9C%BA%20ubuntu%20%E4%B8%AD%E7%9A%84%E7%A7%81%E6%9C%89%E9%93%BE-toc" style="margin-left:40px;"><a href="#%E9%97%AE%E9%A2%98%EF%BC%9Awin10%E4%BD%BF%E7%94%A8%20metamask%20%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5%E8%99%9A%E6%8B%9F%E6%9C%BA%20ubuntu%20%E4%B8%AD%E7%9A%84%E7%A7%81%E6%9C%89%E9%93%BE" rel="nofollow">win10使用 metamask 连接虚拟机 ubuntu 中的私有链</a></p> 
<p id="%E9%97%AE%E9%A2%98%EF%BC%9A--dev%E5%BC%95%E5%8F%91%E7%9A%84%E9%94%99%E8%AF%AF%EF%BC%9AFailed%20to%20unlock%20developer%20account-toc" style="margin-left:40px;"><a href="#%E9%97%AE%E9%A2%98%EF%BC%9A--dev%E5%BC%95%E5%8F%91%E7%9A%84%E9%94%99%E8%AF%AF%EF%BC%9AFailed%20to%20unlock%20developer%20account" rel="nofollow">问题：--dev引发的错误：Failed to unlock developer account</a></p> 
<p id="%E9%97%AE%E9%A2%98%EF%BC%9A%E6%96%B0%E7%89%88%E6%9C%ACgeth%EF%BC%8C%E5%87%BA%E4%BA%8E%E5%AE%89%E5%85%A8%E8%80%83%E8%99%91%EF%BC%8C%E9%BB%98%E8%AE%A4%E7%A6%81%E6%AD%A2%E4%BA%86HTTP%E9%80%9A%E9%81%93%E8%A7%A3%E9%94%81%E8%B4%A6%E6%88%B7-toc" style="margin-left:40px;"><a href="#%E9%97%AE%E9%A2%98%EF%BC%9A%E6%96%B0%E7%89%88%E6%9C%ACgeth%EF%BC%8C%E5%87%BA%E4%BA%8E%E5%AE%89%E5%85%A8%E8%80%83%E8%99%91%EF%BC%8C%E9%BB%98%E8%AE%A4%E7%A6%81%E6%AD%A2%E4%BA%86HTTP%E9%80%9A%E9%81%93%E8%A7%A3%E9%94%81%E8%B4%A6%E6%88%B7" rel="nofollow">问题：使用最新版本geth，当执行personal.unlockAccount()或在程序中调用personal_unlockAccount接口时，会出现：account unlock with HTTP access is forbidden异常</a></p> 
<p id="%E9%97%AE%E9%A2%98%EF%BC%9Athe%20method%20net_version%20does%20not%20exist%2Fis%20not%20available-toc" style="margin-left:40px;"><a href="#%E9%97%AE%E9%A2%98%EF%BC%9Athe%20method%20net_version%20does%20not%20exist%2Fis%20not%20available" rel="nofollow">问题：the method net_version does not exist/is not available</a></p> 
<p id="%E6%9F%A5%E7%9C%8B%E4%BA%A4%E6%98%93%E8%AE%B0%E5%BD%95-toc" style="margin-left:0px;"><a href="#%E6%9F%A5%E7%9C%8B%E4%BA%A4%E6%98%93%E8%AE%B0%E5%BD%95" rel="nofollow">查看交易记录</a></p> 
<p id="%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E6%A0%B9%E6%8D%AE%E4%BA%A4%E6%98%93id%E6%9F%A5%E8%AF%A2-toc" style="margin-left:40px;"><a href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E6%A0%B9%E6%8D%AE%E4%BA%A4%E6%98%93id%E6%9F%A5%E8%AF%A2" rel="nofollow">方法一：根据交易id查询</a></p> 
<p id="%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E6%A0%B9%E6%8D%AE%E5%8C%BA%E5%9D%97id%E6%9F%A5%E8%AF%A2-toc" style="margin-left:40px;"><a href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E6%A0%B9%E6%8D%AE%E5%8C%BA%E5%9D%97id%E6%9F%A5%E8%AF%A2" rel="nofollow">方法二：根据区块id查询</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="main-toc" style="text-align:center;">geth控制台控制</h2> 
<blockquote> 
 <p><strong>主机win10， 在Ubuntu中使用geth创建私有链</strong></p> 
</blockquote> 
<h3 id="%E5%90%AF%E5%8A%A8%E6%8E%A7%E5%88%B6%E5%8F%B0">启动控制台：输出结果直接显示</h3> 
<blockquote> 
 <p> 启动私有链代码末尾，加上 console 可以在启动私有链时，启动控制台</p> 
</blockquote> 
<pre><code>/geth --datadir ~/桌面/geth-project/myChain --networkid 15 console</code></pre> 
<h3></h3> 
<h3 id="%E6%8E%A8%E8%8D%90%E5%86%99%E6%B3%95%EF%BC%9A%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C%E5%86%99%E5%85%A5%20output.log%20%E6%96%87%E4%BB%B6">启动控制台：控制台输出结果写入 output.log 文件，但不能连接MetaMask</h3> 
<blockquote> 
 <p>当然这样写会将 Info 那些信息直接写入控制台，很多，看着很不舒服</p> 
 <p>可以将控制台输出写入output.log 文件中</p> 
</blockquote> 
<pre><code>geth --datadir ~/桌面/geth-project/myChain --networkid 15 console 2&gt;~/桌面/geth-project/myChain/output.log</code></pre> 
<blockquote> 
 <p>查看到目前为止的输出结果</p> 
</blockquote> 
<pre><code>cat ~/桌面/geth-project/myChain/output.log</code></pre> 
<blockquote> 
 <p>实时查看输出结果 </p> 
</blockquote> 
<pre><code>tail -f ~/桌面/geth-project/myChain/output.log</code></pre> 
<p></p> 
<h3 id="%E9%80%80%E5%87%BA%E6%8E%A7%E5%88%B6%E5%8F%B0%C2%A0">退出控制台 </h3> 
<blockquote> 
 <p>ctrl + d 或 控制台输入exit</p> 
</blockquote> 
<p style="text-align:center;"><img alt="" height="584" src="https://images2.imgbox.com/ea/1a/abyG8FeW_o.png" width="1200"></p> 
<blockquote> 
 <p><strong>Geth Console 是一个交互式的 JavaScript 执行环境，里面内置了一些用来操作以太坊的 JavaScript 对象，我们可以直接调用这些对象来获取区块链上的相关信息。 </strong></p> 
</blockquote> 
<p></p> 
<hr> 
<h2 id="%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4" style="text-align:center;"> 常用命令</h2> 
<blockquote> 
 <p>对象主要包括：</p> 
 <ul><li>admin：主要包含与管理节点相关的方法</li><li>eth：主要包含对区块链进行访问和交互相关的方法</li><li>personal：包含账户管理的方法</li><li>txpool：包含查看交易内存池的方法</li><li>miner：主要包含挖矿相关的一些方法</li><li>net：主要包含查看 p2p 网络状态的方法</li><li>web3：包含以上所有对象，还包含一些通用方法</li></ul> 
</blockquote> 
<blockquote> 
 <p><strong>常用命令有：</strong></p> 
 <ul><li>personal.newAccount([密码])：创建账户</li><li>personal.unlockAccount(账号id)：解锁账户</li><li>eth.accounts：列出系统中的账户</li><li>eth.getBalance(账号id)：查看账户余额，返回值的单位是 Wei</li><li>eth.blockNumber：列出当前区块高度</li><li>eth.getTransaction(交易id)：获取交易信息</li><li>eth.sendTransaction({from:账号id1, to:账号id2, value:钱,data:'十六进制信息'}): 转账</li><li>eth.estimateGas({from:账号id1, to:账号id2, value:钱,data:'十六进制信息'}):可用于转账前估计 gas</li><li>eth.getBlock(区块id 即blockNumber)：获取区块信息</li><li>eth.getBlockTransactionCount(区块id 即blockNumber)：查询该区块中的交易次数</li><li>miner.start()：开始挖矿</li><li>miner.stop()：停止挖矿</li><li>miner.setEtherbase：挖矿以太坊归哪个账户</li><li>web3.fromWei(钱)：Wei 换算成以太币</li><li>web3.toWei()：以太币换算成 Wei</li><li>txpool.status：交易池中的状态</li></ul> 
</blockquote> 
<p style="text-align:center;"><img alt="" height="36" src="https://images2.imgbox.com/b8/28/AmoG2Z51_o.png" width="819"></p> 
<p style="text-align:center;"><img alt="" height="40" src="https://images2.imgbox.com/5c/51/88YpkujS_o.png" width="456"></p> 
<blockquote> 
 <p>eth.accounts[0] 里面的以太币是挖出来的</p> 
</blockquote> 
<h3 id="%E5%BC%80%E5%90%AF%E6%8C%96%E7%9F%BF%E6%96%B9%E6%B3%95"><strong>开始挖矿</strong></h3> 
<pre><code>miner.start(1)</code></pre> 
<blockquote> 
 <p>即便返回true或null,但也已经正在挖矿了</p> 
 <p>第一次挖 Generating DAG in progress 属于正常现象，初始化比较久，耐心等</p> 
</blockquote> 
<p style="text-align:center;"><img alt="" height="356" src="https://images2.imgbox.com/1b/d8/ETC6V0k3_o.png" width="486"></p> 
<blockquote> 
 <p><span style="color:#fe2c24;"><strong> 如此就是开始挖矿了</strong></span></p> 
</blockquote> 
<p style="text-align:center;"><img alt="" height="261" src="https://images2.imgbox.com/17/a1/aOW1IpcG_o.png" width="728"></p> 
<p style="text-align:center;"></p> 
<h3 id="%E5%81%9C%E6%AD%A2%E6%8C%96%E7%9F%BF">停止挖矿</h3> 
<pre><code>miner.stop()</code></pre> 
<h3 id="%E8%BD%AC%E8%B4%A6"></h3> 
<blockquote> 
 <p><strong>解决方法：</strong>把这个转账的消息<strong>广播出去，即重新挖矿，挖一会儿停止就行</strong> </p> 
</blockquote> 
<pre><code>miner.start(1)

miner.stop()</code></pre> 
<h3> 转账</h3> 
<pre><code>eth.sendTransaction({from:eth.accounts[0], to:"0x1E17ECE93b3", value:web3.toWei(500, 'ether')})
</code></pre> 
<p style="text-align:center;"><img alt="" height="104" src="https://images2.imgbox.com/bd/ee/wcyDTJOC_o.png" width="931"></p> 
<p></p> 
<blockquote> 
 <h4 id="%E9%97%AE%E9%A2%98%EF%BC%9A%E5%87%BA%E7%8E%B0%E6%8A%A5%E9%94%99%20password%20or%20unlock"><strong>问题：</strong>出现报错 <strong>password or unlock</strong></h4> 
</blockquote> 
<blockquote> 
 <p><strong>解决方法：解锁你的账户</strong></p> 
</blockquote> 
<pre><code>personal.unlockAccount(你的账户)</code></pre> 
<pre><code>personal.unlockAccount(eth.accounts[0])</code></pre> 
<p style="text-align:center;"><img alt="" height="77" src="https://images2.imgbox.com/39/9d/0MoeuLcR_o.png" width="547"></p> 
<blockquote> 
 <p><strong>之后重新转账</strong></p> 
</blockquote> 
<p><strong> 转账单位：wei</strong></p> 
<pre><code>eth.sendTransaction({from:eth.accounts[0], to:"0x1E17ECE93b3", value:500})
</code></pre> 
<p><strong> 转账单位：ether</strong></p> 
<pre><code>eth.sendTransaction({from:eth.accounts[0], to:"0x1E17ECE93b3", value:web3.toWei(15, 'ether')})
</code></pre> 
<p style="text-align:center;"><img alt="" height="40" src="https://images2.imgbox.com/21/6e/UUfsW3mS_o.png" width="944"></p> 
<blockquote> 
 <h4 id="%E9%97%AE%E9%A2%98%EF%BC%9A%E5%A6%82%E6%9E%9C%E5%87%BA%E7%8E%B0%20invalid%20sender%20%E6%8A%A5%E9%94%99%EF%BC%8C%E5%8F%AF%E8%83%BD%E6%98%AF%E4%BD%A0%E7%9A%84%20gensis.json%20%E7%BC%BA%E5%B0%91%E4%BA%86%E4%B8%9C%E8%A5%BF"><strong>问题：</strong>出现 <strong>invalid sender</strong> 报错，可能是你的 gensis.json 缺少了东西</h4> 
</blockquote> 
<blockquote> 
 <p><strong>解决方法：</strong>去看看官方最新的版本或用以下版本，之后删掉原本的创世区块，重新初始化新的创世区块</p> 
</blockquote> 
<pre><code>{
    "config": {
    "chainId": 15,
    "homesteadBlock": 0,
    "eip150Block": 0,
    "eip155Block": 0,
    "eip158Block": 0,
    "byzantiumBlock": 0,
    "constantinopleBlock": 0,
    "petersburgBlock": 0,
    "istanbulBlock": 0
    },
    "alloc": {
    "0x1E17ECE93b3c72277E4B22a58B87934C9F654089":{"balance":"900000000000000000000"}},
    "coinbase": "0x0000000000000000000000000000000000000000",
    "difficulty": "0x200",
    "extraData": "",
    "gasLimit": "0x2fefd8",
    "nonce": "0x0000000000000042",
    "mixhash": "0x0000000000000000000000000000000000000000000000000000000000000000",
    "parentHash": "0x0000000000000000000000000000000000000000000000000000000000000000",
    "timestamp": "0x00"
}</code></pre> 
<blockquote> 
 <h4 id="%E9%97%AE%E9%A2%98%EF%BC%9A%E4%BD%86%E6%98%AF%E6%AD%A4%E6%97%B6%E4%BD%A0%E6%9F%A5%E7%9C%8B%E8%B4%A6%E6%88%B7%E5%8F%AF%E4%BB%A5%E5%8F%91%E7%8E%B0%E5%B9%B6%E6%B2%A1%E6%9C%89%E6%88%90%E5%8A%9F%E8%BD%AC%E8%B4%A6%E5%87%BA%E5%8E%BB%EF%BC%8C%E8%B4%A6%E6%88%B7%E9%87%91%E9%A2%9D%E6%B2%A1%E6%9C%89%E5%8F%98%E5%8C%96"><strong>问题：</strong>查看账户发现并没有成功转账出去，<strong>账户金额没有变化</strong></h4> 
</blockquote> 
<p style="text-align:center;"><img alt="" height="72" src="https://images2.imgbox.com/19/3b/gClGiPi1_o.png" width="710"></p> 
<blockquote> 
 <p><strong>解决方法：</strong>把这个转账的消息<strong>广播出去，即重新挖矿，挖一会儿停止就行</strong> </p> 
</blockquote> 
<pre><code>miner.start(1)

miner.stop()</code></pre> 
<p style="text-align:center;"><img alt="" height="151" src="https://images2.imgbox.com/58/bd/1mJ4QLeO_o.png" width="740"></p> 
<blockquote> 
 <p>到此转账完成</p> 
 <p>因为挖矿，accounts[0]可能钱变多一些</p> 
</blockquote> 
<p></p> 
<p></p> 
<p></p> 
<hr> 
<h2 id="%E5%A4%96%E9%83%A8%E8%BF%9E%E6%8E%A5" style="text-align:center;">外部连接 MetaMask</h2> 
<h3 id="%E9%97%AE%E9%A2%98%EF%BC%9A%E5%A6%82%E6%9E%9C%E5%B8%8C%E6%9C%9B%20matemask%C2%A0%E5%A4%96%E9%83%A8%E5%8F%AF%E4%BB%A5%E8%BF%9E%E6%8E%A5%E5%88%B0%20localhost%208584"> win10 metamask 连接 <strong>localhost 8584</strong></h3> 
<p style="text-align:center;"><img alt="" height="481" src="https://images2.imgbox.com/c6/2d/CbCl0Hla_o.png" width="290"></p> 
<blockquote> 
 <p><strong>解决方法：</strong>只需要加上 <strong>--http 或 --rpc</strong>，默认端口是8545；指定端口只需要加上<strong>--rpcport </strong>即可修改</p> 
</blockquote> 
<pre><code>geth --datadir ~/桌面/geth-project/myChain --networkid 15 --http console 2&gt;~/桌面/geth-project/myChain/output.log</code></pre> 
<h3></h3> 
<h3></h3> 
<h3 id="%E9%97%AE%E9%A2%98%EF%BC%9Awin10%E4%BD%BF%E7%94%A8%20metamask%20%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5%E8%99%9A%E6%8B%9F%E6%9C%BA%20ubuntu%20%E4%B8%AD%E7%9A%84%E7%A7%81%E6%9C%89%E9%93%BE"><strong>win10</strong>使用 metamask 连接虚拟机 ubuntu 中的私有链</h3> 
<blockquote> 
 <p><strong>解决方法：</strong></p> 
 <p><strong>1.</strong>geth 控制台时需再添加 --rpc --rpcaddr "0.0.0.0" --rpcport 8545 参数。</p> 
 <p><strong>2.</strong>再 MetaMask <strong>添加网络</strong> ip地址是你<strong>虚拟机 ubuntu 的 ip 地址</strong></p> 
</blockquote> 
<pre><code>geth --datadir ~/桌面/geth-project/myChain --networkid 15 --rpc --rpcaddr "0.0.0.0" --rpcport 8545 console 2&gt;~/桌面/geth-project/myChain/output.log</code></pre> 
<blockquote> 
 <p><span style="color:#fe2c24;"><strong># 注意 设置启动参数--rpcaddr 127.0.0.1 ，主机中浏览器metamask无法连接该链 </strong></span></p> 
</blockquote> 
<pre><code>geth --rpccorsdomain "*" 允许跨域请求的域名列表
加了这个参数反而连不上geth</code></pre> 
<p style="text-align:center;"><img alt="" height="232" src="https://images2.imgbox.com/7e/85/qqlodcsS_o.png" width="738"></p> 
<p></p> 
<blockquote> 
 <p>再 MetaMask <strong>添加网络</strong> ip地址是你<strong>虚拟机 ubuntu 的 ip 地址</strong></p> 
</blockquote> 
<p style="text-align:center;"><img alt="" height="722" src="https://images2.imgbox.com/2c/f3/8iQKRaVV_o.png" width="1200"></p> 
<blockquote> 
 <p><strong> 这时主机 MetaMask 就可以访问了</strong></p> 
</blockquote> 
<p></p> 
<h3 id="%E9%97%AE%E9%A2%98%EF%BC%9A--dev%E5%BC%95%E5%8F%91%E7%9A%84%E9%94%99%E8%AF%AF%EF%BC%9AFailed%20to%20unlock%20developer%20account">问题：--dev引发的错误：Failed to unlock developer account</h3> 
<p><strong> 错误代码</strong></p> 
<pre><code>geth --datadir . --networkid 15 --dev</code></pre> 
<blockquote> 
 <p><strong>报错：Failed to unlock developer account：could not decrypt key with given passphrase</strong></p> 
</blockquote> 
<blockquote> 
 <p><strong>解决方法：</strong><strong>--dev </strong><strong>表示启用开发者账户</strong>，而因为你指定了 <strong>networkid</strong> 那些，而 --dev 开发者模式是帮你<strong>创建一条全新的私链</strong>，而不是根据你原本的创建，不需要加上那些参数，如下</p> 
</blockquote> 
<pre><code>geth --datadir . --dev</code></pre> 
<p></p> 
<h3 id="%E9%97%AE%E9%A2%98%EF%BC%9A%E6%96%B0%E7%89%88%E6%9C%ACgeth%EF%BC%8C%E5%87%BA%E4%BA%8E%E5%AE%89%E5%85%A8%E8%80%83%E8%99%91%EF%BC%8C%E9%BB%98%E8%AE%A4%E7%A6%81%E6%AD%A2%E4%BA%86HTTP%E9%80%9A%E9%81%93%E8%A7%A3%E9%94%81%E8%B4%A6%E6%88%B7"><strong>问题：</strong>使用最新版本geth，当执行personal.unlockAccount()或在程序中调用personal_unlockAccount接口时，会出现：account unlock with HTTP access is forbidden异常</h3> 
<blockquote> 
 <p><strong>报错：GoError: Error: account unlock with HTTP access is forbidden at web3.js:6347:37(47)</strong></p> 
</blockquote> 
<blockquote> 
 <p><strong>原因：</strong>新版本geth，出于安全考虑，默认禁止了HTTP通道解锁账户 </p> 
</blockquote> 
<blockquote> 
 <p><strong>解决方法：</strong>启动命令中添加参数</p> 
</blockquote> 
<pre><code>--allow-insecure-unlock</code></pre> 
<blockquote> 
 <p><strong> 示例：</strong>geth --rpc <strong>--rpcapi eth,web3,personal --allow-insecure-unloc</strong></p> 
</blockquote> 
<pre><code>geth --datadir ~/桌面/geth-project/myChain --networkid 15 --rpc --rpcaddr "0.0.0.0" --rpcport 8545 --rpcapi eth,web3,personal --allow-insecure-unlock console 2&gt;~/桌面/geth-project/myChain/output.log</code></pre> 
<h3 id="%E9%97%AE%E9%A2%98%EF%BC%9Athe%20method%20net_version%20does%20not%20exist%2Fis%20not%20available">问题：the method net_version does not exist/is not available</h3> 
<blockquote> 
 <p><strong>解决方法：</strong>在geth启动时的rpc参数中设置rpcapi时包括 "net" 即可</p> 
</blockquote> 
<blockquote> 
 <p> <strong> 示例：</strong>geth --rpc <strong>--rpcapi</strong> eth,web3,personal<strong>,net</strong> --allow-insecure-unloc</p> 
</blockquote> 
<pre><code>geth --datadir ~/桌面/geth-project/myChain --networkid 15 --rpc --rpcaddr "0.0.0.0" --rpcport 8545 --rpcapi eth,web3,personal,net --allow-insecure-unlock console 2&gt;~/桌面/geth-project/myChain/output.log </code></pre> 
<hr> 
<h2 id="%E6%9F%A5%E7%9C%8B%E4%BA%A4%E6%98%93%E8%AE%B0%E5%BD%95" style="text-align:center;"><strong>查看交易记录</strong></h2> 
<h3 id="%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E6%A0%B9%E6%8D%AE%E4%BA%A4%E6%98%93id%E6%9F%A5%E8%AF%A2"><strong>方法一：根据交易id查询</strong></h3> 
<blockquote> 
 <p><strong> 注意这个不是你的账号的id，而是交易的id</strong></p> 
</blockquote> 
<pre><code>eth.getTransaction(transactionHash [, callback])</code></pre> 
<pre><code>eth.getTransaction("0x21003fc7a543bc89a467510b6ab978bc638dc09619d1fba0288bdb3907830e4b")</code></pre> 
<blockquote> 
 <p><strong><span style="color:#fe2c24;"># 注意这个不是你的账号的id，而是交易的id </span></strong></p> 
</blockquote> 
<p style="text-align:center;"><img alt="" height="446" src="https://images2.imgbox.com/0e/2c/1DYS54ob_o.png" width="731"></p> 
<blockquote> 
 <ul><li>hash 32 Bytes - String: 交易的哈希值</li><li>nonce - Number: 交易发送方在此交易之前产生的交易数量</li><li>blockHash 32 Bytes - String: 交易所在块的哈希值。如果交易处于pending状态，则该值为null</li><li>blockNumber - Number: 交易所在块的编号，如果交易处于pending状态，则该值为null</li><li>transactionIndex - Number: 交易在块中的索引位置，如果交易处于pending状态，则该值为null</li><li>from - String: 交易发送方的地址</li><li>to - String: 交易接收方的地址。对于创建合约的交易，该值为null</li><li>value - String: 以wei为单位的转账金额</li><li>gasPrice - String: 发送方承诺的gas价格，以wei为单位</li><li>gas - Number: 发送方提供的gas用量</li><li>input - String: 随交易发送的数据</li><li>r，s，v: 签名</li></ul> 
</blockquote> 
<p></p> 
<h3 id="%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E6%A0%B9%E6%8D%AE%E5%8C%BA%E5%9D%97id%E6%9F%A5%E8%AF%A2"><strong>方法二：根据区块id查询</strong></h3> 
<p style="text-align:center;"><img alt="" height="174" src="https://images2.imgbox.com/89/36/E2Tm88pH_o.png" width="774"></p> 
<blockquote> 
 <p><strong><span style="color:#fe2c24;"># 查询区块中交易次数 </span></strong></p> 
</blockquote> 
<pre><code>eth.getBlockTransactionCount(blockNumber)</code></pre> 
<pre><code>eth.getBlockTransactionCount(36)</code></pre> 
<p style="text-align:center;"><img alt="" height="40" src="https://images2.imgbox.com/19/d7/rjBV0Gya_o.png" width="315"></p> 
<blockquote> 
 <p><span style="color:#fe2c24;"><strong># 查询区块信息</strong></span> </p> 
</blockquote> 
<pre><code>eth.getBlock(blockNumber)</code></pre> 
<pre><code>eth.getBlock(36)</code></pre> 
<p style="text-align:center;"><img alt="" height="454" src="https://images2.imgbox.com/30/89/0ofEAWv7_o.png" width="864"></p> 
<p></p> 
<h2 style="text-align:center;"></h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c7cb91871f1e0edd894d58ab29c0dd3e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">以太坊创建私有链 go-ethereum</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a7711603fe060f93a017bbb58f38f78f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于MySQL数据库</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>