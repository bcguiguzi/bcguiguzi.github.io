<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>onvif 客户端发现 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="onvif 客户端发现" />
<meta property="og:description" content="1、解压：unzip -X gsoap_2.8.10.zip 编译
2、下载：
wget http://www.onvif.org/onvif/ver10/network/wsdl/remotediscovery.wsdl
3、复制：
cp gsoap-2.8/gsoap/typemap.dat .
4、在typemap.dat 中添加：
[cpp] view plain copy print ? #Use gSOAP 2.8.10 and up. In the typemap.dat file used by wsdl2h, add: # ONVIF recommended prefixes tds = &#34;http://www.onvif.org/ver10/device/wsdl&#34; tev = &#34;http://www.onvif.org/ver10/events/wsdl&#34; tls = &#34;http://www.onvif.org/ver10/display/wsdl&#34; tmd = &#34;http://www.onvif.org/ver10/deviceIO/wsdl&#34; timg = &#34;http://www.onvif.org/ver20/imaging/wsdl&#34; trt = &#34;http://www.onvif.org/ver10/media/wsdl&#34; tptz = &#34;http://www.onvif.org/ver20/ptz/wsdl&#34; trv = &#34;http://www.onvif.org/ver10/receiver/wsdl&#34; trc = &#34;http://www.onvif.org/ver10/recording/wsdl&#34; tse = &#34;http://www.onvif.org/ver10/search/wsdl&#34; trp = &#34;http://www.onvif.org/ver10/replay/wsdl&#34; tan = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/b511b21fa218b8d36ffc4b83350a3d06/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-01-06T22:49:41+08:00" />
<meta property="article:modified_time" content="2014-01-06T22:49:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">onvif 客户端发现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="article_content" id="article_content"> 
 <p>1、解压：unzip -X gsoap_2.8.10.zip 编译</p> 
 <p>2、下载：</p> 
 <p>wget http://www.onvif.org/onvif/ver10/network/wsdl/remotediscovery.wsdl</p> 
 <p>3、复制：</p> 
 <p>cp gsoap-2.8/gsoap/typemap.dat .<br> </p> 
 <p>4、在typemap.dat 中添加：</p> 
 <p></p> 
 <div class="dp-highlighter bg_cpp"> 
  <div class="bar"> 
   <div class="tools"> 
    <strong>[cpp]</strong> 
    <a target="_blank" title="view plain" class="ViewSource" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer"> view plain</a> 
    <a target="_blank" title="copy" class="CopyToClipboard" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer">copy</a> 
    <a target="_blank" title="print" class="PrintSource" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer">print</a> 
    <a target="_blank" title="?" class="About" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer">?</a> 
   </div> 
  </div> 
  <ol class="dp-cpp"><li class="alt"><span class="preprocessor">#Use gSOAP 2.8.10 and up. In the typemap.dat file used by wsdl2h, add: </span>  </li><li><span class="preprocessor">#   ONVIF recommended prefixes </span>   </li><li class="alt">tds = <span class="string">"http://www.onvif.org/ver10/device/wsdl"</span>  </li><li>tev = <span class="string">"http://www.onvif.org/ver10/events/wsdl"</span>  </li><li class="alt">tls = <span class="string">"http://www.onvif.org/ver10/display/wsdl"</span>  </li><li>tmd = <span class="string">"http://www.onvif.org/ver10/deviceIO/wsdl"</span>  </li><li class="alt">timg    = <span class="string">"http://www.onvif.org/ver20/imaging/wsdl"</span>  </li><li>trt = <span class="string">"http://www.onvif.org/ver10/media/wsdl"</span>  </li><li class="alt">tptz    = <span class="string">"http://www.onvif.org/ver20/ptz/wsdl"</span>  </li><li>trv = <span class="string">"http://www.onvif.org/ver10/receiver/wsdl"</span>  </li><li class="alt">trc = <span class="string">"http://www.onvif.org/ver10/recording/wsdl"</span>  </li><li>tse = <span class="string">"http://www.onvif.org/ver10/search/wsdl"</span>  </li><li class="alt">trp = <span class="string">"http://www.onvif.org/ver10/replay/wsdl"</span>  </li><li>tan = <span class="string">"http://www.onvif.org/ver20/analytics/wsdl"</span>  </li><li class="alt">tad = <span class="string">"http://www.onvif.org/ver10/analyticsdevice/wsdl"</span>  </li><li>tdn = <span class="string">"http://www.onvif.org/ver10/network/wsdl"</span>  </li><li class="alt">tt  = <span class="string">"http://www.onvif.org/ver10/schema"</span>  </li><li><span class="preprocessor">#   OASIS recommended prefixes </span>   </li><li class="alt">wsnt    = <span class="string">"http://docs.oasis-open.org/wsn/b-2"</span>  </li><li>wsntw   = <span class="string">"http://docs.oasis-open.org/wsn/bw-2"</span>  </li><li class="alt">wsrfbf  = <span class="string">"http://docs.oasis-open.org/wsrf/bf-2"</span>  </li><li>wsrfr   = <span class="string">"http://docs.oasis-open.org/wsrf/r-2"</span>  </li><li class="alt">wsrfrw  = <span class="string">"http://docs.oasis-open.org/wsrf/rw-2"</span>  </li><li>wstop   = <span class="string">"http://docs.oasis-open.org/wsn/t-1"</span>  </li><li class="alt"><span class="preprocessor">#   WS-Discovery 1.0 remapping </span>  </li><li>wsdd10__HelloType       = | wsdd__HelloType  </li><li class="alt">wsdd10__ByeType         = | wsdd__ByeType  </li><li>wsdd10__ProbeType       = | wsdd__ProbeType  </li><li class="alt">wsdd10__ProbeMatchesType    = | wsdd__ProbeMatchesType  </li><li>wsdd10__ProbeMatchType      = | wsdd__ProbeMatchType  </li><li class="alt">wsdd10__ResolveType     = | wsdd__ResolveType  </li><li>wsdd10__ResolveMatchesType  = | wsdd__ResolveMatchesType  </li><li class="alt">wsdd10__ResolveMatchType    = | wsdd__ResolveMatchType  </li><li><span class="preprocessor">#   SOAP-ENV mapping </span>  </li><li class="alt">SOAP_ENV__Envelope  = <span class="keyword">struct</span> SOAP_ENV__Envelope { <span class="keyword">struct</span> SOAP_ENV__Header *SOAP_ENV__Header; _XML SOAP_ENV__Body; }; | <span class="keyword">struct</span> SOAP_ENV__Envelope  </li><li>SOAP_ENV__Header    = | <span class="keyword">struct</span> SOAP_ENV__Header  </li><li class="alt">SOAP_ENV__Fault     = | <span class="keyword">struct</span> SOAP_ENV__Fault  </li><li>SOAP_ENV__Detail    = | <span class="keyword">struct</span> SOAP_ENV__Detail  </li><li class="alt">SOAP_ENV__Code      = | <span class="keyword">struct</span> SOAP_ENV__Code  </li><li>SOAP_ENV__Subcode   = | <span class="keyword">struct</span> SOAP_ENV__Subcode  </li><li class="alt">SOAP_ENV__Reason    = | <span class="keyword">struct</span> SOAP_ENV__Reason  </li></ol> 
 </div> 
 <pre><code class="language-cpp">#Use gSOAP 2.8.10 and up. In the typemap.dat file used by wsdl2h, add:
#	ONVIF recommended prefixes
tds	= "http://www.onvif.org/ver10/device/wsdl"
tev	= "http://www.onvif.org/ver10/events/wsdl"
tls	= "http://www.onvif.org/ver10/display/wsdl"
tmd	= "http://www.onvif.org/ver10/deviceIO/wsdl"
timg	= "http://www.onvif.org/ver20/imaging/wsdl"
trt	= "http://www.onvif.org/ver10/media/wsdl"
tptz	= "http://www.onvif.org/ver20/ptz/wsdl"
trv	= "http://www.onvif.org/ver10/receiver/wsdl"
trc	= "http://www.onvif.org/ver10/recording/wsdl"
tse	= "http://www.onvif.org/ver10/search/wsdl"
trp	= "http://www.onvif.org/ver10/replay/wsdl"
tan	= "http://www.onvif.org/ver20/analytics/wsdl"
tad	= "http://www.onvif.org/ver10/analyticsdevice/wsdl"
tdn	= "http://www.onvif.org/ver10/network/wsdl"
tt	= "http://www.onvif.org/ver10/schema"
#	OASIS recommended prefixes
wsnt	= "http://docs.oasis-open.org/wsn/b-2"
wsntw	= "http://docs.oasis-open.org/wsn/bw-2"
wsrfbf	= "http://docs.oasis-open.org/wsrf/bf-2"
wsrfr	= "http://docs.oasis-open.org/wsrf/r-2"
wsrfrw  = "http://docs.oasis-open.org/wsrf/rw-2"
wstop	= "http://docs.oasis-open.org/wsn/t-1"
#	WS-Discovery 1.0 remapping
wsdd10__HelloType		= | wsdd__HelloType
wsdd10__ByeType			= | wsdd__ByeType
wsdd10__ProbeType		= | wsdd__ProbeType
wsdd10__ProbeMatchesType	= | wsdd__ProbeMatchesType
wsdd10__ProbeMatchType		= | wsdd__ProbeMatchType
wsdd10__ResolveType		= | wsdd__ResolveType
wsdd10__ResolveMatchesType	= | wsdd__ResolveMatchesType
wsdd10__ResolveMatchType	= | wsdd__ResolveMatchType
#	SOAP-ENV mapping
SOAP_ENV__Envelope	= struct SOAP_ENV__Envelope { struct SOAP_ENV__Header *SOAP_ENV__Header; _XML SOAP_ENV__Body; }; | struct SOAP_ENV__Envelope
SOAP_ENV__Header	= | struct SOAP_ENV__Header
SOAP_ENV__Fault		= | struct SOAP_ENV__Fault
SOAP_ENV__Detail	= | struct SOAP_ENV__Detail
SOAP_ENV__Code		= | struct SOAP_ENV__Code
SOAP_ENV__Subcode	= | struct SOAP_ENV__Subcode
SOAP_ENV__Reason	= | struct SOAP_ENV__Reason</code></pre> 
 <p></p> 
 <p><br> </p> 5、把编译好的wsdl2h,soapcpp2复制到本目录 
 <br> 6、./wsdl2h -o onvif.h -c -s -t typemap.dat remotediscovery.wsdl 
 <p>7、./soapcpp2 -c onvif.h -x -I /workplace/mywork/onvif/gsoap-x86/gsoap-2.8/gsoap/import</p> 
 <p>8、复制文件：</p> 
 <p>cp gsoap-2.8/gsoap/stdsoap2.* .<br> </p> 
 <p>9、测试代码：</p> 
 <p></p> 
 <div class="dp-highlighter bg_cpp"> 
  <div class="bar"> 
   <div class="tools"> 
    <strong>[cpp]</strong> 
    <a target="_blank" title="view plain" class="ViewSource" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer"> view plain</a> 
    <a target="_blank" title="copy" class="CopyToClipboard" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer">copy</a> 
    <a target="_blank" title="print" class="PrintSource" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer">print</a> 
    <a target="_blank" title="?" class="About" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer">?</a> 
   </div> 
  </div> 
  <ol class="dp-cpp"><li class="alt"><span class="preprocessor">#include &lt;iostream&gt; </span>  </li><li><span class="preprocessor">#include "wsdd.nsmap" </span>  </li><li class="alt"><span class="preprocessor">#include "soapH.h" </span>   </li><li><span class="keyword">using</span> <span class="keyword">namespace</span> std;  </li><li class="alt"><span class="datatypes">int</span> main()  </li><li>{  </li><li class="alt">    <span class="keyword">struct</span> soap *soap;  </li><li>    <span class="keyword">struct</span> wsdd__ProbeType req;  </li><li class="alt">    <span class="keyword">struct</span> __wsdd__ProbeMatches resp;  </li><li>    <span class="keyword">struct</span> wsdd__ScopesType sScope;  </li><li class="alt">    <span class="keyword">struct</span> SOAP_ENV__Header header;  </li><li>    <span class="datatypes">int</span> count = 0;  </li><li class="alt">    <span class="datatypes">int</span> result = 0;   </li><li>  </li><li class="alt">    <span class="datatypes">char</span> guid_string[100];  </li><li>  </li><li class="alt">     soap = soap_new();   </li><li>    <span class="keyword">if</span>(soap==NULL)  </li><li class="alt">    {  </li><li>        <span class="keyword">return</span> -1;  </li><li class="alt">    }  </li><li>   </li><li class="alt">    soap_set_namespaces(soap, namespaces);   </li><li>  </li><li class="alt">    soap-&gt;recv_timeout = 5;      <span class="comment">//超过5秒钟没有数据就退出 </span>  </li><li>    soap_default_SOAP_ENV__Header(soap, &amp;header);  </li><li class="alt">   </li><li>    header.wsa__MessageID = guid_string;  </li><li class="alt">    header.wsa__To= <span class="string">"urn:schemas-xmlsoap-org:ws:2005:04:discovery"</span>;  </li><li>    header.wsa__Action= <span class="string">"http://schemas.xmlsoap.org/ws/2005/04/discovery/Probe"</span>;  </li><li class="alt">    soap-&gt;header = &amp;header;  </li><li>  </li><li class="alt">    soap_default_wsdd__ScopesType(soap, &amp;sScope);  </li><li>    sScope.__item = <span class="string">""</span>;  </li><li class="alt">    soap_default_wsdd__ProbeType(soap, &amp;req);  </li><li>    req.Scopes = &amp;sScope;  </li><li class="alt">    req.Types = <span class="string">""</span>;  </li><li>  </li><li class="alt">    result = soap_send___wsdd__Probe(soap, <span class="string">"soap.udp://239.255.255.250:3702"</span>, NULL, &amp;req);  </li><li>  </li><li class="alt">    <span class="keyword">do</span>{  </li><li>         result = soap_recv___wsdd__ProbeMatches(soap, &amp;resp);   </li><li class="alt">         <span class="keyword">if</span> (soap-&gt;error)   </li><li>         {   </li><li class="alt">             cout&lt;&lt;<span class="string">"soap error:"</span>&lt;&lt;soap-&gt;error&lt;&lt;soap_faultcode(soap)&lt;&lt;<span class="string">"---"</span>&lt;&lt;soap_faultstring(soap)&lt;&lt;endl;   </li><li>             result = soap-&gt;error;   </li><li class="alt">             <span class="keyword">break</span>;  </li><li>         }   </li><li class="alt">         <span class="keyword">else</span>  </li><li>         {  </li><li class="alt">            cout&lt;&lt;<span class="string">"========================================="</span>&lt;&lt;endl;  </li><li>   </li><li class="alt">            cout&lt;&lt;<span class="string">"Match size:"</span>&lt;&lt;resp.wsdd__ProbeMatches-&gt;__sizeProbeMatch&lt;&lt;endl;  </li><li>            cout&lt;&lt;<span class="string">"xsd-unsignedInt:"</span>&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;MetadataVersion&lt;&lt;endl;  </li><li class="alt">            cout&lt;&lt;<span class="string">"scopes item:"</span>&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;Scopes-&gt;__item&lt;&lt;endl;  </li><li>            <span class="comment">//cout&lt;&lt;"scopes matchby:"&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;Scopes-&gt;MatchBy&lt;&lt;endl; </span>  </li><li class="alt">            cout&lt;&lt;<span class="string">"QName:"</span>&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;Types&lt;&lt;endl;  </li><li>            cout&lt;&lt;<span class="string">"xsd:string:"</span>&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;wsa__EndpointReference.Address&lt;&lt;endl;  </li><li class="alt">            cout&lt;&lt;<span class="string">"xsd:QName:"</span>&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;wsa__EndpointReference.PortType&lt;&lt;endl;  </li><li>            cout&lt;&lt;<span class="string">"wsa:ServiceNameType:"</span>&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;wsa__EndpointReference.ServiceName&lt;&lt;endl;  </li><li class="alt">            cout&lt;&lt;<span class="string">"sequence of elements:"</span>&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;wsa__EndpointReference.__size&lt;&lt;endl;  </li><li>            cout&lt;&lt;<span class="string">"xsd:anyType:"</span>&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;wsa__EndpointReference.__anyAttribute&lt;&lt;endl;  </li><li class="alt">            cout&lt;&lt;<span class="string">"endpoint any:"</span>&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;wsa__EndpointReference.__any&lt;&lt;endl;  </li><li>            cout&lt;&lt;<span class="string">"wsdd:UriListType:"</span>&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;XAddrs&lt;&lt;endl;  </li><li class="alt">         }  </li><li>     }<span class="keyword">while</span>(1);  </li><li class="alt">  </li><li>    soap_destroy(soap); <span class="comment">// remove deserialized class instances (C++ only)  </span>  </li><li class="alt">    soap_end(soap);     <span class="comment">// clean up and remove deserialized data </span>  </li><li>    soap_done(soap);  </li><li class="alt">  </li><li>    <span class="keyword">return</span> result;  </li><li class="alt">}  </li></ol> 
 </div> 
 <pre><code class="language-cpp">#include &lt;iostream&gt;
#include "wsdd.nsmap"
#include "soapH.h"
using namespace std;
int main()
{
    struct soap *soap;
    struct wsdd__ProbeType req;
    struct __wsdd__ProbeMatches resp;
    struct wsdd__ScopesType sScope;
    struct SOAP_ENV__Header header;
    int count = 0;
    int result = 0; 

    char guid_string[100];

     soap = soap_new(); 
    if(soap==NULL)
    {
        return -1;
    }
 
    soap_set_namespaces(soap, namespaces); 

    soap-&gt;recv_timeout = 5;		//超过5秒钟没有数据就退出
    soap_default_SOAP_ENV__Header(soap, &amp;header);
 
    header.wsa__MessageID = guid_string;
    header.wsa__To= "urn:schemas-xmlsoap-org:ws:2005:04:discovery";
    header.wsa__Action= "http://schemas.xmlsoap.org/ws/2005/04/discovery/Probe";
    soap-&gt;header = &amp;header;

    soap_default_wsdd__ScopesType(soap, &amp;sScope);
    sScope.__item = "";
    soap_default_wsdd__ProbeType(soap, &amp;req);
    req.Scopes = &amp;sScope;
    req.Types = "";

    result = soap_send___wsdd__Probe(soap, "soap.udp://239.255.255.250:3702", NULL, &amp;req);

    do{
         result = soap_recv___wsdd__ProbeMatches(soap, &amp;resp); 
         if (soap-&gt;error) 
         { 
             cout&lt;&lt;"soap error:"&lt;&lt;soap-&gt;error&lt;&lt;soap_faultcode(soap)&lt;&lt;"---"&lt;&lt;soap_faultstring(soap)&lt;&lt;endl; 
             result = soap-&gt;error; 
             break;
         } 
         else
         {
            cout&lt;&lt;"========================================="&lt;&lt;endl;
 
            cout&lt;&lt;"Match size:"&lt;&lt;resp.wsdd__ProbeMatches-&gt;__sizeProbeMatch&lt;&lt;endl;
            cout&lt;&lt;"xsd-unsignedInt:"&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;MetadataVersion&lt;&lt;endl;
            cout&lt;&lt;"scopes item:"&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;Scopes-&gt;__item&lt;&lt;endl;
            //cout&lt;&lt;"scopes matchby:"&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;Scopes-&gt;MatchBy&lt;&lt;endl;
            cout&lt;&lt;"QName:"&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;Types&lt;&lt;endl;
            cout&lt;&lt;"xsd:string:"&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;wsa__EndpointReference.Address&lt;&lt;endl;
            cout&lt;&lt;"xsd:QName:"&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;wsa__EndpointReference.PortType&lt;&lt;endl;
            cout&lt;&lt;"wsa:ServiceNameType:"&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;wsa__EndpointReference.ServiceName&lt;&lt;endl;
            cout&lt;&lt;"sequence of elements:"&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;wsa__EndpointReference.__size&lt;&lt;endl;
            cout&lt;&lt;"xsd:anyType:"&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;wsa__EndpointReference.__anyAttribute&lt;&lt;endl;
            cout&lt;&lt;"endpoint any:"&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;wsa__EndpointReference.__any&lt;&lt;endl;
            cout&lt;&lt;"wsdd:UriListType:"&lt;&lt;resp.wsdd__ProbeMatches-&gt;ProbeMatch-&gt;XAddrs&lt;&lt;endl;
         }
     }while(1);

    soap_destroy(soap); // remove deserialized class instances (C++ only) 
    soap_end(soap);		// clean up and remove deserialized data
    soap_done(soap);

    return result;
}</code></pre> 
 <br> 编译：g++ cc.cpp soapC.c  stdsoap2.cpp soapClient.c -I/gsoap-2.8/gsoap 
 <p></p> 
 <p>10、运行：./a.out</p> 
 <p>结果：</p> 
 <p>1、因为有多个ip(多个网卡）</p> 
 <p></p> 
 <div class="dp-highlighter bg_cpp"> 
  <div class="bar"> 
   <div class="tools"> 
    <strong>[cpp]</strong> 
    <a target="_blank" title="view plain" class="ViewSource" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer"> view plain</a> 
    <a target="_blank" title="copy" class="CopyToClipboard" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer">copy</a> 
    <a target="_blank" title="print" class="PrintSource" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer">print</a> 
    <a target="_blank" title="?" class="About" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer">?</a> 
   </div> 
  </div> 
  <ol class="dp-cpp"><li class="alt">xy@xy-pc:/workplace/mywork/onvif/gsoap-x86/mytest/myonvif/test$ ./a.out   </li><li>soap error:-10x8a29778---0x8a2977c  </li></ol> 
 </div> 
 <pre><code class="language-cpp">xy@xy-pc:/workplace/mywork/onvif/gsoap-x86/mytest/myonvif/test$ ./a.out 
soap error:-10x8a29778---0x8a2977c</code></pre> 
 <br> 2、只有一个网卡，且ip所在网段正好有两个支持onvif的设备： 
 <p></p> 
 <p></p> 
 <div class="dp-highlighter bg_cpp"> 
  <div class="bar"> 
   <div class="tools"> 
    <strong>[cpp]</strong> 
    <a target="_blank" title="view plain" class="ViewSource" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer"> view plain</a> 
    <a target="_blank" title="copy" class="CopyToClipboard" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer">copy</a> 
    <a target="_blank" title="print" class="PrintSource" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer">print</a> 
    <a target="_blank" title="?" class="About" href="http://blog.csdn.net/xyyangkun/article/details/9122281#" rel="noopener noreferrer">?</a> 
   </div> 
  </div> 
  <ol class="dp-cpp"><li class="alt">xy@xy-pc:/workplace/mywork/onvif/gsoap-x86/mytest/myonvif/test$ ./a.out   </li><li>=========================================  </li><li class="alt">Match size:1  </li><li>xsd-unsignedInt:1  </li><li class="alt">scopes item:onvif:<span class="comment">//www.onvif.org/type/video_encoder onvif://www.onvif.org/type/ptz onvif://www.onvif.org/type/audio_encoder onvif://www.onvif.org/type/network_video_transmitter onvif://www.onvif.org/hardware/DM368 onvif://www.onvif.org/location/country/china onvif://www.onvif.org/name/Dahua </span>  </li><li>QName:tdn:NetworkVideoTransmitter  </li><li class="alt">xsd:string:urn:<span class="keyword">uuid</span>:5b71c61f-220b-475d-9eca-dd7941f07767  </li><li>xsd:QName:0  </li><li class="alt">wsa:ServiceNameType:0  </li><li>sequence of elements:0  </li><li class="alt">xsd:anyType:  </li><li>endpoint any:0  </li><li class="alt">wsdd:UriListType:http:<span class="comment">//192.168.9.110:9988/onvif/device_service </span>  </li><li>soap error:-10x87a99f8---0x87a99fc  </li><li class="alt">xy@xy-pc:/workplace/mywork/onvif/gsoap-x86/mytest/myonvif/test$   </li><li>xy@xy-pc:/workplace/mywork/onvif/gsoap-x86/mytest/myonvif/test$   </li><li class="alt">xy@xy-pc:/workplace/mywork/onvif/gsoap-x86/mytest/myonvif/test$ ./a.out   </li><li>=========================================  </li><li class="alt">Match size:1  </li><li>xsd-unsignedInt:1  </li><li class="alt">scopes item:onvif:<span class="comment">//www.onvif.org/type/video_encoder onvif://www.onvif.org/type/ptz onvif://www.onvif.org/type/audio_encoder onvif://www.onvif.org/type/network_video_transmitter onvif://www.onvif.org/hardware/DM368 onvif://www.onvif.org/location/country/china onvif://www.onvif.org/name/Dahua </span>  </li><li>QName:tdn:NetworkVideoTransmitter  </li><li class="alt">xsd:string:urn:<span class="keyword">uuid</span>:5b71c61f-220b-475d-9eca-dd7941f07767  </li><li>xsd:QName:0  </li><li class="alt">wsa:ServiceNameType:0  </li><li>sequence of elements:0  </li><li class="alt">xsd:anyType:  </li><li>endpoint any:0  </li><li class="alt">wsdd:UriListType:http:<span class="comment">//192.168.9.110:9988/onvif/device_service </span>  </li><li>soap error:-10x86929f8---0x86929fc  </li></ol> 
 </div> 
 <pre><code class="language-cpp">xy@xy-pc:/workplace/mywork/onvif/gsoap-x86/mytest/myonvif/test$ ./a.out 
=========================================
Match size:1
xsd-unsignedInt:1
scopes item:onvif://www.onvif.org/type/video_encoder onvif://www.onvif.org/type/ptz onvif://www.onvif.org/type/audio_encoder onvif://www.onvif.org/type/network_video_transmitter onvif://www.onvif.org/hardware/DM368 onvif://www.onvif.org/location/country/china onvif://www.onvif.org/name/Dahua
QName:tdn:NetworkVideoTransmitter
xsd:string:urn:uuid:5b71c61f-220b-475d-9eca-dd7941f07767
xsd:QName:0
wsa:ServiceNameType:0
sequence of elements:0
xsd:anyType:
endpoint any:0
wsdd:UriListType:http://192.168.9.110:9988/onvif/device_service
soap error:-10x87a99f8---0x87a99fc
xy@xy-pc:/workplace/mywork/onvif/gsoap-x86/mytest/myonvif/test$ 
xy@xy-pc:/workplace/mywork/onvif/gsoap-x86/mytest/myonvif/test$ 
xy@xy-pc:/workplace/mywork/onvif/gsoap-x86/mytest/myonvif/test$ ./a.out 
=========================================
Match size:1
xsd-unsignedInt:1
scopes item:onvif://www.onvif.org/type/video_encoder onvif://www.onvif.org/type/ptz onvif://www.onvif.org/type/audio_encoder onvif://www.onvif.org/type/network_video_transmitter onvif://www.onvif.org/hardware/DM368 onvif://www.onvif.org/location/country/china onvif://www.onvif.org/name/Dahua
QName:tdn:NetworkVideoTransmitter
xsd:string:urn:uuid:5b71c61f-220b-475d-9eca-dd7941f07767
xsd:QName:0
wsa:ServiceNameType:0
sequence of elements:0
xsd:anyType:
endpoint any:0
wsdd:UriListType:http://192.168.9.110:9988/onvif/device_service
soap error:-10x86929f8---0x86929fc
</code></pre> 
 <br> 参考： 
 <p></p> 
 <p>http://my.oschina.net/yunuo/blog/119206<br> http://blog.csdn.net/ghostyu/article/details/8182516<br> </p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/523b0968c3f9a26a8ccbdf8fcab73519/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Onvif开发之Linux下gsoap的使用及移植</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/56f15d06bd616acefd6782796524337f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">eclipse界面语言切换的三种方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>