<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CentOS 环境 ngrep 安装及使用 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CentOS 环境 ngrep 安装及使用" />
<meta property="og:description" content="文章目录 前言1. CentOS 环境安装 ngrep1.1 搜索安装包1.2 安装 ngrep 2. ngrep 使用2.1 ngrep 可选参数列表2.2 ngrep 使用示例 前言 ngrep可以看作网络版的 grep，是一款功能强大的抓包工具。它不但适配各个操作系统，也能识别大量常用网络协议，支持 BPF 过滤规则，提供灵活抓取各类数据包的能力
1. CentOS 环境安装 ngrep 1.1 搜索安装包 执行以下命令搜索 ngrep 的可用安装包，可以看到在 CentOS 系统下一个可以用的安装包是 ngrep.x86_64
sudo yum search ngrep 1.2 安装 ngrep 执行以下命令即可下载安装 ngrep，安装结束后可以使用命令 sudo ngrep -V 查看版本信息
ngrep 依赖 libpcap 库，通常使用下面的命令安装 ngrep 时都会自动下载相关依赖。如果安装出错未自动解决依赖，可尝试使用 sudo yum install libpcap 下载依赖库后重试
sudo yum install ngrep 2. ngrep 使用 2.1 ngrep 可选参数列表 ngrep 常用的参数如下表所示，更多参数可以使用命令 man ngrep 查看详细信息" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/3f6e2d8657aa77764969fa497d09191b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-20T00:35:48+08:00" />
<meta property="article:modified_time" content="2022-07-20T00:35:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CentOS 环境 ngrep 安装及使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">前言</a></li><li><a href="#1_CentOS__ngrep_4" rel="nofollow">1. CentOS 环境安装 ngrep</a></li><li><ul><li><ul><li><a href="#11__5" rel="nofollow">1.1 搜索安装包</a></li><li><a href="#12__ngrep_13" rel="nofollow">1.2 安装 ngrep</a></li></ul> 
  </li></ul> 
  </li><li><a href="#2_ngrep__20" rel="nofollow">2. ngrep 使用</a></li><li><ul><li><ul><li><a href="#21_ngrep__22" rel="nofollow">2.1 ngrep 可选参数列表</a></li><li><a href="#22_ngrep__33" rel="nofollow">2.2 ngrep 使用示例</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>前言</h2> 
<p><code>ngrep</code>可以看作<mark>网络版的 grep</mark>，是一款功能强大的抓包工具。它不但适配各个操作系统，也能识别大量常用网络协议，支持 BPF 过滤规则，提供灵活抓取各类数据包的能力</p> 
<h2><a id="1_CentOS__ngrep_4"></a>1. CentOS 环境安装 ngrep</h2> 
<h4><a id="11__5"></a>1.1 搜索安装包</h4> 
<p>执行以下命令搜索 ngrep 的可用安装包，可以看到在 CentOS 系统下一个可以用的安装包是 <code>ngrep.x86_64</code></p> 
<pre><code class="prism language-java">sudo yum search ngrep
</code></pre> 
<p><img src="https://images2.imgbox.com/97/9a/OTfuqYOh_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="12__ngrep_13"></a>1.2 安装 ngrep</h4> 
<p>执行以下命令即可下载安装 ngrep，安装结束后可以使用命令 <code>sudo ngrep -V</code> 查看版本信息</p> 
<blockquote> 
 <p><mark>ngrep 依赖 libpcap 库</mark>，通常使用下面的命令安装 ngrep 时都会自动下载相关依赖。如果安装出错未自动解决依赖，可尝试使用 <code>sudo yum install libpcap</code> 下载依赖库后重试</p> 
</blockquote> 
<pre><code class="prism language-java">sudo yum install ngrep
</code></pre> 
<h2><a id="2_ngrep__20"></a>2. ngrep 使用</h2> 
<h4><a id="21_ngrep__22"></a>2.1 ngrep 可选参数列表</h4> 
<p><code>ngrep</code> 常用的参数如下表所示，更多参数可以使用命令 <code>man ngrep</code> 查看详细信息</p> 
<table><thead><tr><th align="left">参数</th><th align="left">功能</th></tr></thead><tbody><tr><td align="left">-d</td><td align="left">指定需要抓包的网卡，Linux 系统可使用 <code>ifconfig</code> 命令查看本地网卡设备</td></tr><tr><td align="left">-q</td><td align="left">设置静默，如果没有该参数，未匹配的数据包都以“#”显示</td></tr><tr><td align="left">-t</td><td align="left">在每个匹配的包之前显示时间戳</td></tr><tr><td align="left">-i</td><td align="left">忽略大小写</td></tr><tr><td align="left">-W</td><td align="left">设置数据包内容的展示格式，可选参数为 byline(按行分割) 等</td></tr></tbody></table> 
<h4><a id="22_ngrep__33"></a>2.2 ngrep 使用示例</h4> 
<p>ngrep 的过滤抓包实际分为3个部分，首先是网卡设备的选定，其次是 BPF 过滤器应用，最后才是报文内容匹配。以下是几个使用的例子：</p> 
<ol><li> <p>监听本地 <code>eth0</code> 网卡，<font color="blue">过滤报文内容能匹配指定字符串 COMPLETE 的数据包</font>，按照包中的换行符分行打印报文</p> <pre><code class="prism language-java">sudo ngrep <span class="token string">"COMPLETE"</span> <span class="token operator">-</span>d eth0 <span class="token operator">-</span>W byline <span class="token operator">-</span>q <span class="token operator">-</span>t <span class="token operator">-</span>i 
</code></pre> <p><img src="https://images2.imgbox.com/8d/d1/KVs0ZYYm_o.png" alt="在这里插入图片描述"></p> </li><li> <p>监听本地 <code>eth0</code> 网卡，<font color="blue">过滤任一端使用了 5080 端口进行 udp 通信并且报文中内容能匹配指定模式串[a-zA-Z]的数据包</font>，按照包中的换行符分行打印报文</p> 
  <blockquote> 
   <p>注意，通信协议 udp/tcp 等需要在 port 参数前指定</p> 
  </blockquote> <pre><code class="prism language-java">sudo ngrep <span class="token string">'[a-zA-Z]'</span> <span class="token operator">-</span>t <span class="token operator">-</span>W byline <span class="token operator">-</span>d eth0 udp port <span class="token number">5080</span>
</code></pre> <p><img src="https://images2.imgbox.com/86/40/mZ7qTPmF_o.png" alt="在这里插入图片描述"></p> </li><li> <p>监听本地 <code>eth0</code> 网卡，<font color="blue">过滤通信双端中任一端使用了 5080 端口并且任一端主机地址为 127.0.0.1 的数据包</font>，按照包中的换行符分行打印报文</p> <pre><code class="prism language-java">sudo ngrep <span class="token operator">-</span>d eth0 <span class="token operator">-</span>q <span class="token operator">-</span>t <span class="token operator">-</span>W byline host <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> and port <span class="token number">5080</span>
</code></pre> <p><img src="https://images2.imgbox.com/e9/bc/CJQbdq2z_o.png" alt="在这里插入图片描述"></p> </li><li> <p>监听本地 <code>eth0</code> 网卡，<font color="blue">过滤发包端口为 5090 协议为 tcp 或者发包端口为 5061 且收包主机为 172.18.192.76 或者 127.0.0.1 的数据包，并进一步过滤报文内容匹配指定字符串 COMPLETE 的数据包</font>，最后按照包中的换行符分行打印报文</p> 
  <blockquote> 
   <p><mark>BPF 过滤规则中，src 标识来源，dst 标识目标</mark>。实际上 ngrep 和 tcpdump 在 BPF 过滤器使用语法上是完全一致的，读者如感兴趣可自行搜索相关知识</p> 
  </blockquote> <pre><code class="prism language-java">sudo ngrep <span class="token string">"COMPLETE"</span> <span class="token operator">-</span>d eth0 <span class="token operator">-</span>W byline <span class="token operator">-</span>q <span class="token operator">-</span>t \<span class="token punctuation">(</span>dst host <span class="token number">172.18</span><span class="token number">.192</span><span class="token number">.76</span> or dst host <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>\<span class="token punctuation">)</span> and \<span class="token punctuation">(</span>tcp src port <span class="token number">5090</span> or src port <span class="token number">5061</span>\<span class="token punctuation">)</span>
</code></pre> <p><img src="https://images2.imgbox.com/67/ad/jekVSvTT_o.png" alt="在这里插入图片描述"></p> </li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c59a2f4b9fb5816fe16dd9e2410d148f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">throw和throws的区别（java）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6cd3eb9ac970ccba6df6b06c97520d03/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Unity3D】sRGB伽马(gamma)空间和sRGB Frame Buffer线性空间的简单介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>