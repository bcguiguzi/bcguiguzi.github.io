<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>cisco服务器修复模式,cisco 1841 IOS恢复与升级 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="cisco服务器修复模式,cisco 1841 IOS恢复与升级" />
<meta property="og:description" content="Address or
name of remote host
?192.168.18.168(IP地址已作技术处理，下同)
Source file name? igs-i-l.110-22a.bin(IOS映像文件名)
Destination file name ?
Accessing file &#39;igs-i-l.110-22a.bin&#39; on
192.168.18.168...
Loading igs-i-l.110-22a.bin from 192.168.18.168 (via
Ethernet0): !
Device needs erasure before copying new file
Erase flash device before writing?
Copy &#39;igs-i-l.110-22a.bin&#39; from server
as &#39;igs-i-l.110-22a.bin&#39; into Flash WITH erase?
y
Erasing device... eeeeeeeeeeeeeeee ...erased
Loading igs-i-l.110-22a.bin from 192.168.18.168 (via
Ethernet0): !!!!!!!!!!!!!!!!!!!!(！表示恢复成功)
7) 还原路由器虚拟寄存器的默认值(0x2102)，恢复路由器的正常启动顺序，依次键入以下命令：
router(boot)#conf t
router(boot)(config)#config-register 0x2102
router(boot)(config)#exit
router(boot)#wr" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/3f825d5c783b7d32d39efb3fcee386e5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-09T16:50:17+08:00" />
<meta property="article:modified_time" content="2021-08-09T16:50:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">cisco服务器修复模式,cisco 1841 IOS恢复与升级</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>Address or</p> 
 <p>name of remote host</p> 
 <p>?192.168.18.168(IP地址已作技术处理，下同)</p> 
 <p>Source file name? igs-i-l.110-22a.bin(IOS映像文件名)</p> 
 <p>Destination file name ?</p> 
 <p>Accessing file 'igs-i-l.110-22a.bin' on</p> 
 <p>192.168.18.168...</p> 
 <p>Loading igs-i-l.110-22a.bin from 192.168.18.168 (via</p> 
 <p>Ethernet0): !</p> 
 <p>Device needs erasure before copying new file</p> 
 <p>Erase flash device before writing?</p> 
 <p>Copy 'igs-i-l.110-22a.bin' from server</p> 
 <p>as 'igs-i-l.110-22a.bin' into Flash WITH erase?</p> 
 <p>y</p> 
 <p>Erasing device... eeeeeeeeeeeeeeee ...erased</p> 
 <p>Loading igs-i-l.110-22a.bin from 192.168.18.168 (via</p> 
 <p>Ethernet0): !!!!!!!!!!!!!!!!!!!!(！表示恢复成功)</p> 
 <p>7) 还原路由器虚拟寄存器的默认值(0x2102)，恢复路由器的正常启动顺序，依次键入以下命令：</p> 
 <p>router(boot)#conf t</p> 
 <p>router(boot)(config)#config-register 0x2102</p> 
 <p>router(boot)(config)#exit</p> 
 <p>router(boot)#wr</p> 
 <p>router(boot)#reload</p> 
 <p>2、IOS映像升级的方法及步骤</p> 
 <p>1) 升级之前先备份，将相关文件备份至TFTP服务器，键入如下命令：</p> 
 <p>router#copy bootflash tftp(Cisco</p> 
 <p>2500系列路由器不存在bootflash，相应的是rom)</p> 
 <p>router#copy flash tftp</p> 
 <p>router#copy startup-config tftp</p> 
 <p>2) 因为Cisco 1000,1600,2500,4000系列路由器不允许在正常工作状态下重写flash</p> 
 <p>memory，所以只有进入rom(或bootflash)启动模式才能升级IOS映像，依次键入以下命令：</p> 
 <p>router#conf t</p> 
 <p>router(config)#config-register 0x2101</p> 
 <p>router(config)#exit</p> 
 <p>router#wr</p> 
 <p>router#reload</p> 
 <p>3)</p> 
 <p>路由器重启完毕后进入rom(或bootflash)启动模式，从TFTP服务器将新的IOS映像文件拷贝至路由器的flash</p> 
 <p>memory中：</p> 
 <p>router(boot)#copy tftp flash</p> 
 <p>4) 还原路由器虚拟寄存器的默认值(0x2102)，恢复路由器的正常启动顺序，依次键入以下命令：</p> 
 <p>router(boot)#conf t</p> 
 <p>router(boot)(config)#config-register 0x2102</p> 
 <p>router(boot)(config)#exit</p> 
 <p>router(boot)#wr</p> 
 <p>router(boot)#reload</p> 
 <p>二、Cisco 1700,2600,3600,7200系列</p> 
 <p>1、IOS映像恢复的方法及步骤</p> 
 <p>1) 连接PC的COM1口与路由器的console口，使用PC的超级终端软件访问该路由器；</p> 
 <p>2)</p> 
 <p>开启路由器的电源开关，并在30秒内按下键盘的Ctrl+break，中断路由器的正常启动以进入rom监视模式，屏幕上提示符如下：</p> 
 <p>rommon 1&gt;</p> 
 <p>3) 键入xmodem命令：</p> 
 <p>rommon 1&gt;xmodem</p> 
 <p>c3640-i-mz.120-10.bin(IOS映像文件名)</p> 
 <p>4)</p> 
 <p>然后，路由器一直等待从PC上接收该IOS映像文件，此时在超级终端软件中点击发送选项，选择存放在PC本地硬盘中的IOS映像文件，确定后即开始下载文件至路由器的flash</p> 
 <p>memory中，由于通讯带宽只有9600波特，整个文件下载时间约为1.5小时(依文件大小而定)，屏幕显示信息如下：</p> 
 <p>Do not start the sending program yet...</p> 
 <p>device does not contain a valid magic number</p> 
 <p>dir: cannot open device flash:</p> 
 <p>WARNING: All existing data in flash will be lost!</p> 
 <p>Invoke this application only for disaster recovery.</p> 
 <p>Do you wish to continue? y/n:y</p> 
 <p>Ready to receive file c3640-i-mz.120-10.bin ...</p> 
 <p>Erasing flash at 0x307c0000</p> 
 <p>program flash location 0x30380000</p> 
 <p>Download Complete!</p> 
 <p>program load complete, entry point: 0x80008000, size:</p> 
 <p>0x38f410</p> 
 <p>5) 接着，路由器将自动重启，屏幕显示信息如下：</p> 
 <p>Self decompressing the image :</p> 
 <p>#################################</p> 
 <p>…</p> 
 <p>Press RETURN to get started!</p> 
 <p>2、IOS映像升级的方法及步骤</p> 
 <p>1) 同理，升级之前先备份，将关键文件备份至TFTP服务器，键入下列命令： router#copy</p> 
 <p>bootflash tftp(Cisco 3600系列路由器不存在bootflash)</p> 
 <p>router#copy flash tftp</p> 
 <p>router#copy startup-config tftp</p> 
 <p>2) 因为Cisco 1700,2600,3600,7200系列路由器允许在正常工作状态下重写flash</p> 
 <p>memory，所以直接键入以下命令就可完成IOS映像的在线升级：</p> 
 <p>router#copy tftp flash</p> 
 <p>router#reload</p> 
 <p>或者，为保险起见(以路由器停止服务为代价)，在进入rom监视模式后才进行IOS映像的升级，则依次进行下列操作：</p> 
 <p>2)</p> 
 <p>在路由器重启加电后30秒内按下键盘的Ctrl+break，中断路由器的正常启动直接进入rom监视模式，屏幕上提示符如下：</p> 
 <p>rommon 1&gt;</p> 
 <p>或者，在路由器重启过程完成后进行以下操作，同样可以进入路由器的rom监视模式：</p> 
 <p>router#conf t</p> 
 <p>router(config)#config-register 0x0</p> 
 <p>router(config)#exit</p> 
 <p>router#wr</p> 
 <p>router#reload</p> 
 <p>rommon 1&gt;</p> 
 <p>3) 键入以下命令，将IOS映像的升级文件从TFTP服务器复制至路由器的flash memory中：</p> 
 <p>rommon 1&gt;b c3640-i-mz.121-2.T 192.168.18.168</p> 
 <p>program load complete, entry point: 0x80008000, size:</p> 
 <p>0x4ed478</p> 
 <p>Self decompressing the image :</p> 
 <p>##################################</p> 
 <p>Loading c3640-i-mz.121-2.T from 192.168.18.168 (via</p> 
 <p>Ethernet0/0):!!!!!!!!!!!!!!!</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/348ea2865b868c367ceeb52c8ad255c6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">九阴真经 服务器位置,《九阴真经》3月3日IOS服务器互通公告</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3eccc70b804a3aeb3e14e3d08ffc0425/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">QT常用控件（四）—— QStackedWidget控件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>