<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>阿里云centos7服务器关于80端口和443端口 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="阿里云centos7服务器关于80端口和443端口" />
<meta property="og:description" content="昨天登录阿里云平台被告知我的服务器被别人在美国等地使用git登录过，我怀疑是我的密码泄露了，所以修改密码后重启服务器，随后写的小程序发现不能用了(小程序要求https方式访问)，排查了老半天，发现443端口不通，随后自己折腾了一下午，解决了，自己记录一下。
打开端口的步骤：
查看防火墙状态
firewall-cmd --state 2.打开防火墙
重启服务则会断开tcp会话。
systemctl restart firewalld firewall-cmd --reload 建议使用后一种“重载配置文件”。重载配置文件之后不会断掉正在连接的tcp会话，而
3.查看已经打开的端口
firewall-cmd --list-ports 4.打开443或80端口
firewall-cmd --add-port=443/tcp 开放通过tcp访问443 firewall-cmd --add-port=80/tcp 开放通过tcp访问80 5.80端口转发到8080（tomcat的默认端口为8080）,443转发到8443（https配置的端口为8443）
firewall-cmd --add-forward-port=port=80:proto=tcp:toport=8080 firewall-cmd --add-forward-port=port=443:proto=tcp:toport=8443 ps：这里其实没必要转发，但是我修改tomcat中的文件将8080修改为80,8443修改为443，直接访问80或者443端口时就是不通。所以我只能通过转发。如果有知道的朋友留言告知一下，感激不尽！
6.开放阿里云平台上的配置安全组规则开放相应的端口
到这里应该就可以了。
下面是记录一下常用的防火墙命令
打开某端口
firewall-cmd --zone=public(作用域) --add-port=80/tcp(端口和访问类型) --permanent(永久生效) 查看防火墙状态
firewall-cmd --state 开启防火墙
systemctl start firewalld.service 关闭防火墙
systemctl stop firewalld.service 禁止开机启动启动防火墙
systemctl disable firewalld.service 检查是否允许伪装IP
firewall-cmd --query-masquerade 允许防火墙伪装IP
firewall-cmd --add-masquerade 禁止防火墙伪装IP
firewall-cmd --remove-masquerade 开放mysql端口
firewall-cmd --add-service=mysql 阻止http端口
firewall-cmd --remove-service=http 查看开放的服务
firewall-cmd --list-services 开放通过tcp访问3306" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/7f93e70246333cfdc518840a974070bb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-09-08T11:33:57+08:00" />
<meta property="article:modified_time" content="2018-09-08T11:33:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">阿里云centos7服务器关于80端口和443端口</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>昨天登录阿里云平台被告知我的服务器被别人在美国等地使用git登录过，我怀疑是我的密码泄露了，所以修改密码后重启服务器，随后写的小程序发现不能用了(小程序要求https方式访问)，排查了老半天，发现443端口不通，随后自己折腾了一下午，解决了，自己记录一下。</p> 
<p>打开端口的步骤：</p> 
<ol><li> <p>查看防火墙状态</p> <pre><code>firewall-cmd --state
</code></pre> </li></ol> 
<p>2.打开防火墙<br> 重启服务则会断开tcp会话。</p> 
<pre><code>systemctl restart firewalld

firewall-cmd --reload           
</code></pre> 
<p>建议使用后一种“重载配置文件”。重载配置文件之后不会断掉正在连接的tcp会话，而</p> 
<p>3.查看已经打开的端口</p> 
<pre><code>firewall-cmd --list-ports
</code></pre> 
<p>4.打开443或80端口</p> 
<pre><code>firewall-cmd --add-port=443/tcp    开放通过tcp访问443
firewall-cmd --add-port=80/tcp    开放通过tcp访问80
</code></pre> 
<p>5.80端口转发到8080（tomcat的默认端口为8080）,443转发到8443（https配置的端口为8443）</p> 
<pre><code>firewall-cmd --add-forward-port=port=80:proto=tcp:toport=8080
firewall-cmd --add-forward-port=port=443:proto=tcp:toport=8443
</code></pre> 
<p><strong>ps：这里其实没必要转发，但是我修改tomcat中的文件将8080修改为80,8443修改为443，直接访问80或者443端口时就是不通。所以我只能通过转发。如果有知道的朋友留言告知一下，感激不尽！</strong></p> 
<p>6.开放阿里云平台上的配置安全组规则开放相应的端口<br> <img src="https://images2.imgbox.com/e1/02/R4bTSPjD_o.png" alt="这里写图片描述"></p> 
<p>到这里应该就可以了。</p> 
<p><strong>下面是记录一下常用的防火墙命令</strong><br> 打开某端口</p> 
<pre><code>firewall-cmd --zone=public(作用域) --add-port=80/tcp(端口和访问类型) --permanent(永久生效)
</code></pre> 
<p>查看防火墙状态</p> 
<pre><code>firewall-cmd    --state
</code></pre> 
<p>开启防火墙</p> 
<pre><code>systemctl  start   firewalld.service
</code></pre> 
<p>关闭防火墙</p> 
<pre><code>systemctl  stop   firewalld.service
</code></pre> 
<p>禁止开机启动启动防火墙</p> 
<pre><code>systemctl   disable   firewalld.service
</code></pre> 
<p>检查是否允许伪装IP</p> 
<pre><code>firewall-cmd --query-masquerade 
</code></pre> 
<p>允许防火墙伪装IP</p> 
<pre><code>firewall-cmd --add-masquerade 
</code></pre> 
<p>禁止防火墙伪装IP</p> 
<pre><code>firewall-cmd --remove-masquerade
</code></pre> 
<p>开放mysql端口</p> 
<pre><code>firewall-cmd --add-service=mysql  
</code></pre> 
<p>阻止http端口</p> 
<pre><code>firewall-cmd --remove-service=http
</code></pre> 
<p>查看开放的服务</p> 
<pre><code>firewall-cmd --list-services   
</code></pre> 
<p>开放通过tcp访问3306</p> 
<pre><code>firewall-cmd --add-port=3306/tcp  
</code></pre> 
<p>阻止通过tcp访问3306</p> 
<pre><code>firewall-cmd --remove-port=80tcp  
</code></pre> 
<p>开放通过udp访问233</p> 
<pre><code>firewall-cmd --add-port=233/udp  
</code></pre> 
<p>查看开放的端口</p> 
<pre><code>firewall-cmd --list-ports  
</code></pre> 
<p>将80端口的流量转发至8080</p> 
<pre><code>firewall-cmd --add-forward-port=port=80:proto=tcp:toport=8080
</code></pre> 
<p>将80端口的流量转发至</p> 
<pre><code>firewall-cmd --add-forward-port=port=80:proto=tcp:toaddr=192.168.1.0.1192.168.0.1
</code></pre> 
<p>将80端口的流量转发至192.168.0.1的8080端口</p> 
<pre><code>firewall-cmd --add-forward-port=port=80:proto=tcp:toaddr=192.168.0.1:toport=8080
</code></pre> 
<p>监听端口</p> 
<pre><code>	netstat -an |grep  443
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/74099f772863b8b9acb2e051a224908d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">超好用的开发工具汇总</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cc541787c44180813ab6a8423a041471/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JQuery（学习笔记七）JQuery仿京东产品详情页面</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>