<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>创建安装程序Visual Studio Installer - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="创建安装程序Visual Studio Installer" />
<meta property="og:description" content="1、 在vs2010 选择“新建项目”----“其他项目类型”----“Visual Studio Installer“安装项目”： 命名为：Setup1 。
这是在VS2010中将有三个文件夹，
1.“应用程序文件夹”表示要安装的应用程序需要添加的文件；
2.“用户的‘程序’菜单”表示：应用程序安装完，用户的“开始菜单”中的显示的内容，一般在这个文件夹中，需要再创建一个文件用来存放：应用程序.exe和卸载程序.exe；
3.“用户桌面”表示：这个应用程序安装完，用户的桌面上的创建的.exe快捷方式。
2、 应用程序文件夹中点右键添加文件 将需要打包的文件添加进来；
添加的文件一般是已经编译过应用程序的debug或者release目录下的文件；
如果debug 下面有子文件夹则需要“添加文件夹”，例如：data
然后把对应的子文件里的内容添加到此文件夹中；
把需要创建程序快捷方式的图标也添加进来：后缀名为：ico
3、 设置安装文件的目录（路径）： 创建的项目名称（setup1）点击左键（不是右 键），在属性中设置参数如下图：
其中Author 为作者；Manufacturer为公司名称；ProductName为应用程序的名字；例如我们设置为：BeyondKKO；Manufacturer：自由公司；ProductName：串口测试。把InstallAllUsers 设置为True 。（这样在“控制面板”程序中会显示公司的名称；在安装时会默认为“任何人”，否则默认为“只有我”）
在应用程序上点击左键，如下图：第一个[ProgramFilesFolder]为系统主目录（默认C:\Program Files(x86)），第二个为公司名[Manufacturer]），第三个为应用程序名称，这样在安装时就会创建两层的文件路径。需要删除DefaultLocation中的：[Manufacturer] 。删除后只有应用程序的名称。如果想更改[ProgramFilesFolder],则可以替换为要替换的 盘符，如：D:\[Manufacturer]\[ProductName]
4、 创建应用程序图标与卸载程序： “在应用程序文件夹”中的.exe文件中，点击右键，创建快捷方式：
重命名“串口测试程序”，然后点击右键属性：选择Icon
双击进入选择我们之前添加的“MiXer.ico”
确定后，拖动此快捷方式到“用户桌面”
“用户的‘程序’菜单”中添加一个文件夹，命名为：“串口程序”
然后同样的方式创建TEXTCOM.exe一个快捷方式（“串口测试程序”），拖动到“串口程序”中；
然后给.NET应用程序创建一个卸载程序：
在“应用程序文件夹”中添加：C：Windows\System32\Msiexec.exe
右键创建快捷方式，重命名为：卸载，把此快捷方式拖动到“串口程序”；
点击项目名称（Setup1），在属性中找到：ProductCode
复制此ProductCode ，粘贴到“卸载”快捷方式的Arguments属性，前面加/x空格
5、 完成以上步骤，就可以生成解决方案了。 6、生成解决方案后，在debug文件夹中就是我们需要的安装包. 7、 安装完在开始菜单中有“串口程序”的文件夹，里面有我们创建的两个快捷方式； 桌面上也会有快捷方式。
---------------------------------------------------------------------------------------------------
Vs2013 用Install Shield 2013创建安装程序
Vs2013好像不能用旧版的installer了。所以只能用新版的，但是新版的需要注册码，不缴费的话也能做，但是在安装过程会提示试用版，并且只能生成一个exe文件，不提供msi文件了。
其实这个exe只不过是把msi打包了一下而已，在生成项目的时候会先生成msi，然后过了大概10秒的时间再生成exe，同时msi会自动删除，手快的可以尝试把msi拷贝出来。当然我觉得exe用着也是一样的。
右击vs解决方案，添加——新建项目——其他项目类型——安装部署
此时如果之前没用过的，会提示下载软件“installshield2013limitededition”。
然后操作步骤我就一一详述了，看这个博客就好了：
http://www.cnblogs.com/wuhuacong/p/4438761.html
需要注意的是，如果允许用户自定义安装目录，则在“Installation Interview”页勾选第三个选项为yes。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/cacd203678f18fffea75ba65bf2b5e69/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-12-21T11:21:40+08:00" />
<meta property="article:modified_time" content="2018-12-21T11:21:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">创建安装程序Visual Studio Installer</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0cm;"> </p> 
<h3 style="margin-left:0cm;"><strong>1、  在vs2010 选择“新建项目”----“其他项目类型”----“Visual Studio Installer“安装项目”：</strong></h3> 
<p style="margin-left:0cm;"><img alt="" class="has" height="529" src="https://images2.imgbox.com/06/6a/3F2iIuZo_o.png" width="523"></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">命名为：</span><span style="color:#000000;">Setup1 </span><span style="color:#000000;">。</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">这是在</span><span style="color:#000000;">VS2010</span><span style="color:#000000;">中将有三个文件夹，</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">     1.“</span><span style="color:#000000;">应用程序文件夹</span><span style="color:#000000;">”</span><span style="color:#000000;">表示要安装的应用程序需要添加的文件；</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">     2.“</span><span style="color:#000000;">用户的</span><span style="color:#000000;">‘</span><span style="color:#000000;">程序</span><span style="color:#000000;">’</span><span style="color:#000000;">菜单</span><span style="color:#000000;">”</span><span style="color:#000000;">表示：应用程序安装完，用户的</span><span style="color:#000000;">“</span><span style="color:#000000;">开始菜单</span><span style="color:#000000;">”</span><span style="color:#000000;">中的显示的内容，一般在这个文件夹中，需要再创建一个文件用来存放：应用程序</span><span style="color:#000000;">.exe</span><span style="color:#000000;">和卸载程序</span><span style="color:#000000;">.exe</span><span style="color:#000000;">；</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">     3.“</span><span style="color:#000000;">用户桌面</span><span style="color:#000000;">”</span><span style="color:#000000;">表示：这个应用程序安装完，用户的桌面上的创建的</span><span style="color:#000000;">.exe</span><span style="color:#000000;">快捷方式。</span></p> 
<p style="margin-left:0cm;"> </p> 
<h3 style="margin-left:0cm;"><strong>2、  应用程序文件夹中点右键添加文件</strong></h3> 
<p><strong>将需要打包的文件添加进来；</strong></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="188" src="https://images2.imgbox.com/2c/3c/nKTVtZ4X_o.png" width="558"></p> 
<p><strong>添加的文件一般是已经编译过应用程序的debug或者release目录下的文件；</strong></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="324" src="https://images2.imgbox.com/6e/07/DaOTbPlo_o.png" width="299"></p> 
<p><strong>如果debug 下面有子文件夹则需要“添加文件夹”，例如：data</strong></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="358" src="https://images2.imgbox.com/fb/40/YH9PsGO4_o.png" width="417"></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="89" src="https://images2.imgbox.com/cf/e5/vy2BPmHU_o.png" width="195"></p> 
<p><strong>然后把对应的子文件里的内容添加到此文件夹中；</strong></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="187" src="https://images2.imgbox.com/09/d5/jyI3E7Mm_o.png" width="295"></p> 
<p><strong>把需要创建程序快捷方式的图标也添加进来：后缀名为：ico</strong></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="89" src="https://images2.imgbox.com/fe/dc/OPpKEW8l_o.png" width="218"></p> 
<p style="margin-left:0cm;"> </p> 
<h3 style="margin-left:0cm;"><strong>3、  设置安装文件的目录（路径）：</strong></h3> 
<p><strong>创建的项目名称（setup1）点击左键（不是右 键），在属性中设置参数如下图：</strong></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="331" src="https://images2.imgbox.com/e3/62/01SIfG5x_o.png" width="448"></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="377" src="https://images2.imgbox.com/55/df/oVcWgSQe_o.png" width="507"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">      <span style="color:#000000;">其中Author 为作者；Manufacturer为公司名称；ProductName为应用程序的名字；例如我们设置为：BeyondKKO；Manufacturer：自由公司；ProductName：串口测试。把InstallAllUsers 设置为True 。（这样在“控制面板”程序中会显示公司的名称；在安装时会默认为“任何人”，否则默认为“只有我”）</span></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="485" src="https://images2.imgbox.com/85/d7/cpQUFnpR_o.png" width="555"></p> 
<p style="margin-left:0cm;">    <span style="color:#000000;">在应用程序上点击左键，如下图：第一个</span>[ProgramFilesFolder]<span style="color:#000000;">为系统主目录（默认C:\Program Files(x86)），第二个为公司名[Manufacturer]），第三个为应用程序名称，这样在安装时就会创建两层的文件路径。需要删除DefaultLocation中的：[Manufacturer] 。删除后只有应用程序的名称。如果想更改</span>[ProgramFilesFolder],则可以替换为要替换的 盘符，如：D:\[Manufacturer]\[ProductName]</p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="258" src="https://images2.imgbox.com/e4/21/BWcGfGpX_o.png" width="558"></p> 
<p style="margin-left:0cm;"> </p> 
<h3 style="margin-left:0cm;"><strong><strong>4</strong><strong>、</strong><strong> </strong><strong>创建应用程序图标与卸载程序：</strong></strong></h3> 
<p><strong>“在应用程序文件夹”中的.exe文件中，点击右键，创建快捷方式：</strong></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="312" src="https://images2.imgbox.com/e3/e4/Q4gyWfHH_o.png" width="523"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="95" src="https://images2.imgbox.com/21/db/v5E3hVQt_o.png" width="426"></p> 
<p><strong>重命名“串口测试程序”，然后点击右键属性：选择Icon</strong></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="296" src="https://images2.imgbox.com/8c/f9/7BzzEDR1_o.png" width="433"></p> 
<p><strong>双击进入选择我们之前添加的“MiXer.ico”</strong></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="410" src="https://images2.imgbox.com/51/49/nqgThLCa_o.png" width="558"></p> 
<p style="margin-left:0cm;"> </p> 
<p><strong>确定后，拖动此快捷方式到“用户桌面”</strong></p> 
<p><strong> “用户的‘程序’菜单”中添加一个文件夹，命名为：“串口程序”</strong></p> 
<p><strong>然后同样的方式创建TEXTCOM.exe一个快捷方式（“串口测试程序”），拖动到“串口程序”中；</strong></p> 
<p><strong>然后给.NET应用程序创建一个卸载程序：</strong></p> 
<p><strong>在“应用程序文件夹”中添加：C：Windows\System32\Msiexec.exe</strong></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="401" src="https://images2.imgbox.com/ac/9a/wcelCFVM_o.png" width="500"></p> 
<p style="margin-left:0cm;"> </p> 
<p><strong>右键创建快捷方式，重命名为：卸载，把此快捷方式拖动到“串口程序”；</strong></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="180" src="https://images2.imgbox.com/c3/44/xeEU7r6m_o.png" width="558"></p> 
<p><br><strong>点击项目名称（Setup1），在属性中找到：ProductCode</strong></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="504" src="https://images2.imgbox.com/19/02/DeDfV4fz_o.png" width="549"></p> 
<p><strong>复制此ProductCode ，粘贴到“卸载”快捷方式的Arguments属性，前面加/x空格</strong></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="280" src="https://images2.imgbox.com/bb/e6/VffU6eKJ_o.png" width="558"></p> 
<h3 style="margin-left:0cm;"><strong>5、  完成以上步骤，就可以生成解决方案了。</strong></h3> 
<h3 style="margin-left:0cm;"><strong>6、生成解决方案后，在debug文件夹中就是我们需要的安装包.</strong></h3> 
<p style="margin-left:0cm;"><img alt="" class="has" height="186" src="https://images2.imgbox.com/b9/90/AAi77fNp_o.png" width="311"></p> 
<h3 style="margin-left:0cm;"><br><strong>7、  安装完在开始菜单中有“串口程序”的文件夹，里面有我们创建的两个快捷方式；</strong></h3> 
<p style="margin-left:0cm;"><img alt="" class="has" height="300" src="https://images2.imgbox.com/2a/08/uqCqGOCa_o.png" width="345"></p> 
<p style="margin-left:0cm;"><br><span style="color:#000000;">桌面上也会有快捷方式。</span></p> 
<p style="margin-left:0cm;">---------------------------------------------------------------------------------------------------</p> 
<p>Vs2013 用Install Shield 2013创建安装程序</p> 
<p>Vs2013好像不能用旧版的installer了。所以只能用新版的，但是新版的需要注册码，不缴费的话也能做，但是在安装过程会提示试用版，并且只能生成一个exe文件，不提供msi文件了。</p> 
<p>其实这个exe只不过是把msi打包了一下而已，在生成项目的时候会先生成msi，然后过了大概10秒的时间再生成exe，同时msi会自动删除，手快的可以尝试把msi拷贝出来。当然我觉得exe用着也是一样的。</p> 
<p>右击vs解决方案，添加——新建项目——其他项目类型——安装部署</p> 
<p>此时如果之前没用过的，会提示下载软件“installshield2013limitededition”。</p> 
<p>然后操作步骤我就一一详述了，看这个博客就好了：</p> 
<p><a href="http://www.cnblogs.com/wuhuacong/p/4438761.html" rel="nofollow">http://www.cnblogs.com/wuhuacong/p/4438761.html</a></p> 
<p> </p> 
<p>需要注意的是，如果允许用户自定义安装目录，则在“Installation Interview”页勾选第三个选项为yes。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1ac1cf8bad059e707ec14e28fed1a5c6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">通过输入年份和月份输出该年该月的日历</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fc15e385386095909117afa16ff78185/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android 6.0 wifi一个LOST_PROVISIONING断开连接的问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>