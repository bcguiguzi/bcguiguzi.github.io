<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python雨课堂答案_python实现雨课堂自动预习 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python雨课堂答案_python实现雨课堂自动预习" />
<meta property="og:description" content="用selenium和python的win32api库实现了一个雨YU课堂自动预习的脚本，第一次需要登录，会自动存储cookies,
全程只需要手动输入网址，和页数其他自动完成，
如果里面有题目的话，这个脚本还做不了哈，而且使用的时候鼠标要放在浏览器窗口
，selenium没有实现鼠标滚轮滑动的库。
有也是旁边要有scroll,而YU课堂没有，
就想到了win32api,但这也是缺陷，没有涉及底层的代码，
会js的小伙伴可以试一试用js完成中间的浏览步骤，可能代码更简洁。
下面放上代码，
仅供学习交流，不是偷懒的工具哦！！！！！！！！！！
# coding:utf-8# time:2020.6.5.19:30# auther:小生# website:fromseleniumimportwebdriver
importtime
importwin32api
importwin32con
fromdatetimeimportdatetime
fromdatetimeimporttimedelta
importrandom
importos
importjson
&#34;&#34;&#34;使用时，请将鼠标放到浏览器内，暂时没有想到更好的方法，要时刻观察控制台，自动打开浏览器后会提示你输入网址，如果第一次使用，没有可供使用的cookies,那么控制台会提示登录，30秒足够了。没有设置selenium的页面等待，然后会自动打开页面,然后控制台会提示输入页数，输入即可，鼠标放到浏览器窗口，你可以吃饭，去上厕所，或者去玩，总之你开心就好。&#34;&#34;&#34;classRainclass(object):
driver_path =r&#34;D:\Python\chromedriver\chromedriver.exe&#34;time_all =0num =1def__init__(self):
self.driver = webdriver.Chrome(executable_path=Rainclass.driver_path)
self.url =input(&#34;请输入要自动完成页面的网址：&#34;)
# self.url = &#34;https://changjiang.yuketang.cn/v2/web/studentCards&#34;self.driver.get(self.url)
definitial_judge(self):
ifos.path.exists(&#34;rainclass.txt&#34;):#判断是否当前文件夹有存在存储cookies的文件print(&#34;cookies存在&#34;)
self.send_cookies()
else:
self.get_cookies()
print(&#34;cookies不存在&#34;)
defget_cookies(self):
print(&#34;将沉睡30秒，瞅啥呢，赶紧登录，老子要拿cookies&#34;)
time.sleep(30)
distcookies =self.driver.get_cookies()
jsoncookies = json.dumps(distcookies)
withopen(&#34;rainclass.txt&#34;,&#34;w&#34;)asfp:
fp.write(jsoncookies)
print(&#34;拿取cookies成功,正在进行下一步，登录&#34;)
time.sleep(1.5)
self.send_cookies()
defsend_cookies(self):
withopen(&#34;rainclass.txt&#34;,&#34;r&#34;,encoding=&#34;utf-8&#34;)asfp:
liscookies = json.loads(fp.read())
forcookieinliscookies:
cookie_dic = {
&#34;domain&#34;:&#34;changjiang.yuketang.cn&#34;,&#34;expiry&#34;: cookie.get(&#34;expiry&#34;),&#34;httpOnly&#34;: cookie.get(&#34;httpOnly&#34;),&#34;name&#34;: cookie.get(&#34;name&#34;),&#34;path&#34;:&#34;/&#34;,&#34;secure&#34;: cookie.get(&#34;secure&#34;),&#34;value&#34;: cookie." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/ee25c6bf8652902e1b9523d2a534b8f1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-21T03:53:57+08:00" />
<meta property="article:modified_time" content="2020-11-21T03:53:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python雨课堂答案_python实现雨课堂自动预习</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>用selenium和python的win32api库实现了一个雨YU课堂自动预习的脚本，第一次需要登录，会自动存储cookies,</p> 
<p>全程只需要手动输入网址，和页数其他自动完成，</p> 
<p>如果里面有题目的话，这个脚本还做不了哈，而且使用的时候鼠标要放在浏览器窗口</p> 
<p>，selenium没有实现鼠标滚轮滑动的库。</p> 
<p>有也是旁边要有scroll,而YU课堂没有，</p> 
<p>就想到了win32api,但这也是缺陷，没有涉及底层的代码，</p> 
<p>会js的小伙伴可以试一试用js完成中间的浏览步骤，可能代码更简洁。</p> 
<p>下面放上代码，</p> 
<p>仅供学习交流，不是偷懒的工具哦！！！！！！！！！！</p> 
<p># coding:utf-8# time:2020.6.5.19:30# auther:小生# website:fromseleniumimportwebdriver</p> 
<p>importtime</p> 
<p>importwin32api</p> 
<p>importwin32con</p> 
<p>fromdatetimeimportdatetime</p> 
<p>fromdatetimeimporttimedelta</p> 
<p>importrandom</p> 
<p>importos</p> 
<p>importjson</p> 
<p>"""使用时，请将鼠标放到浏览器内，暂时没有想到更好的方法，要时刻观察控制台，自动打开浏览器后会提示你输入网址，如果第一次使用，没有可供使用的cookies,那么控制台会提示登录，30秒足够了。没有设置selenium的页面等待，然后会自动打开页面,然后控制台会提示输入页数，输入即可，鼠标放到浏览器窗口，你可以吃饭，去上厕所，或者去玩，总之你开心就好。"""classRainclass(object):</p> 
<p>driver_path =r"D:\Python\chromedriver\chromedriver.exe"time_all =0num =1def__init__(self):</p> 
<p>self.driver = webdriver.Chrome(executable_path=Rainclass.driver_path)</p> 
<p>self.url =input("请输入要自动完成页面的网址：")</p> 
<p># self.url = "https://changjiang.yuketang.cn/v2/web/studentCards"self.driver.get(self.url)</p> 
<p>definitial_judge(self):</p> 
<p>ifos.path.exists("rainclass.txt"):#判断是否当前文件夹有存在存储cookies的文件print("cookies存在")</p> 
<p>self.send_cookies()</p> 
<p>else:</p> 
<p>self.get_cookies()</p> 
<p>print("cookies不存在")</p> 
<p>defget_cookies(self):</p> 
<p>print("将沉睡30秒，瞅啥呢，赶紧登录，老子要拿cookies")</p> 
<p>time.sleep(30)</p> 
<p>distcookies =self.driver.get_cookies()</p> 
<p>jsoncookies = json.dumps(distcookies)</p> 
<p>withopen("rainclass.txt","w")asfp:</p> 
<p>fp.write(jsoncookies)</p> 
<p>print("拿取cookies成功,正在进行下一步，登录")</p> 
<p>time.sleep(1.5)</p> 
<p>self.send_cookies()</p> 
<p>defsend_cookies(self):</p> 
<p>withopen("rainclass.txt","r",encoding="utf-8")asfp:</p> 
<p>liscookies = json.loads(fp.read())</p> 
<p>forcookieinliscookies:</p> 
<p>cookie_dic = {<!-- --></p> 
<p>"domain":"changjiang.yuketang.cn","expiry": cookie.get("expiry"),"httpOnly": cookie.get("httpOnly"),"name": cookie.get("name"),"path":"/","secure": cookie.get("secure"),"value": cookie.get("value")</p> 
<p>}</p> 
<p>self.driver.add_cookie(cookie_dic)#把cookies加入并刷新self.driver.refresh()</p> 
<p>time.sleep(2)#别给人服务器造成太大压力self.run()</p> 
<p>defrun(self):</p> 
<p align="center">first_page =self.driver.find_element_by_xpath('//div[@class="ppt_img_box"]')</p> 
<p>first_page.click()</p> 
<p>print("此页面将停留2秒，页面将自动打开，请将鼠标放在浏览器窗口")</p> 
<p># self.driver.set_window_size(1000,300000)# self.driver.execute_script("window.scrollBy(0,1000)","")all_page =int(input("请输入页数："))</p> 
<p>selector =self.driver.find_element_by_xpath('//div[@class="slide_layer"]')</p> 
<p>selector.click()</p> 
<p>time.sleep(3)</p> 
<p># all_seconds = all_page*5+0.5self.time0 = datetime.now()</p> 
<p>while True:</p> 
<p># if datetime.now()-self.time0</p> 
<p>win32api.mouse_event(win32con.MOUSEEVENTF_WHEEL,0,0,-1)</p> 
<p>time_li = [4,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5,5.21,5.3,5.4,5.5,5.6,5.7,7.8,5.9,6</p> 
<p>time_rand = random.choice(time_li)</p> 
<p>time.sleep(time_rand)</p> 
<p>print(str("预习秒数为：")+str(time_rand))</p> 
<p># self.time_all = self.time_all+time_randself.num+=1print("第{}页可能已经预习完成".format(self.num))</p> 
<p>else:</p> 
<p>print("*"*20+"预习可能已经完成"+"*"*20)</p> 
<p>print("*"*20+"预习可能已经完成"+"*"*20)</p> 
<p>breakif__name__ =='__main__':</p> 
<p>clas = Rainclass()</p> 
<p>clas.initial_judge()</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d8b097d980373a658615d93846b096b6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python关键字匹配_python通过BF算法实现关键词匹配的方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0c7712f8d9fd3fe386f18ab8682b0a0c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">让你看看我肝了好多天的git教程吧</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>