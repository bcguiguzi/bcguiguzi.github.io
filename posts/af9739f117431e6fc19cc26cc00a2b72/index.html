<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux GDB 调试详解 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux GDB 调试详解" />
<meta property="og:description" content="文章目录 一、GDB 调试器介绍二、GDB 准备工作GDB 在线安装生成调试信息 三、GDB 命令启动、退出、查看代码设置断点调试命令 一、GDB 调试器介绍 为什么需要 GDB 调试器？
我们需要写代码，然后使用 GCC 进行编译，接着就需要调试代码是否符合我们的预期。要知道，哪怕是开发经验再丰富的程序员，编写的程序也避免不了出错。
程序中的错误主要分为 2 类，分别为语法错误和逻辑错误：
程序中的语法错误几乎都可以由编译器诊断出来，很容易就能发现并解决；逻辑错误指的是代码思路或者设计上的缺陷，程序出现逻辑错误的症状是：代码能够编译通过，没有语法错误，但是运行结果不对。对于这类错误，只能靠我们自己去发现和纠正。 也就是说，程序中出现的语法错误可以借助编译器解决；但逻辑错误则只能靠自己解决。实际场景中解决逻辑错误最高效的方法，就是借助调试工具对程序进行调试。
所谓调试（Debug），就是让代码一步一步慢慢执行，跟踪程序的运行过程。也就是说，通过调试程序，我们可以监控程序执行的每一个细节，包括变量的值、函数的调用过程、内存中数据、线程的调度等，从而发现隐藏的错误或者低效的代码。
那什么是 GDB 调试器呢？
GDB（GNU Debugger）是 GNU 工具集中的调试器，该程序是一个交互式工具，工作在字符模式。除 GDB 外，linux下比较有名的调试器还有 xxgdb，ddd，kgdb，ups，目前 GDB 已经是 Linux 平台下最常用的一款程序调试器。
一般来说，GDB主要帮忙你完成下面四个方面的功能：
启动程序，可以按照你的自定义的要求随心所欲的运行程序。可让被调试的程序在你所指定的调置的断点处停住（断点可以是条件表达式）。当程序被停住时，可以检查此时你的程序中所发生的事。动态的改变你程序的执行环境：可以改变程序，将一个 BUG 产生的影响修正从而测试其他 BUG。 二、GDB 准备工作 GDB 在线安装 GDB 的安装有很多种方法，这里采用最简单的在线安装方法：
sudo apt-get update # 更新安装资源 sudo apt install gdb # 安装 GDB gdb --version # 查看 GDB 版本，查看 GDB 是否安装成功 生成调试信息 从上面关于 GDB 的介绍可以了解到，GDB 的主要功能就是监控程序的执行流程。这也就意味着，只有当源程序文件编译为可执行文件并执行时，GDB 才会派上用场。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/af9739f117431e6fc19cc26cc00a2b72/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-21T10:10:48+08:00" />
<meta property="article:modified_time" content="2023-03-21T10:10:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux GDB 调试详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#GDB__3" rel="nofollow">一、GDB 调试器介绍</a></li><li><a href="#GDB__30" rel="nofollow">二、GDB 准备工作</a></li><li><ul><li><a href="#GDB__32" rel="nofollow">GDB 在线安装</a></li><li><a href="#_44" rel="nofollow">生成调试信息</a></li></ul> 
   </li><li><a href="#GDB__63" rel="nofollow">三、GDB 命令</a></li><li><ul><li><a href="#_65" rel="nofollow">启动、退出、查看代码</a></li><li><a href="#_130" rel="nofollow">设置断点</a></li><li><a href="#_228" rel="nofollow">调试命令</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="GDB__3"></a>一、GDB 调试器介绍</h3> 
<p><strong>为什么需要 GDB 调试器？</strong></p> 
<p>我们需要写代码，然后使用 GCC 进行编译，接着就需要调试代码是否符合我们的预期。要知道，哪怕是开发经验再丰富的程序员，编写的程序也避免不了出错。</p> 
<p>程序中的错误主要分为 2 类，分别为<strong>语法错误和逻辑错误</strong>：</p> 
<ul><li>程序中的语法错误几乎都可以由编译器诊断出来，很容易就能发现并解决；</li><li>逻辑错误指的是代码思路或者设计上的缺陷，程序出现逻辑错误的症状是：代码能够编译通过，没有语法错误，但是运行结果不对。对于这类错误，只能靠我们自己去发现和纠正。</li></ul> 
<p>也就是说，<strong>程序中出现的语法错误可以借助编译器解决；但逻辑错误则只能靠自己解决。实际场景中解决逻辑错误最高效的方法，就是借助调试工具对程序进行调试</strong>。</p> 
<p>所谓<strong>调试（Debug）</strong>，就是让代码一步一步慢慢执行，跟踪程序的运行过程。也就是说，通过调试程序，我们可以监控程序执行的每一个细节，包括变量的值、函数的调用过程、内存中数据、线程的调度等，从而发现隐藏的错误或者低效的代码。</p> 
<p><strong>那什么是 GDB 调试器呢？</strong></p> 
<p>GDB（GNU Debugger）是 GNU 工具集中的调试器，该程序是一个交互式工具，工作在字符模式。除 GDB 外，linux下比较有名的调试器还有 xxgdb，ddd，kgdb，ups，<strong>目前 GDB 已经是 Linux 平台下最常用的一款程序调试器</strong>。</p> 
<p>一般来说，GDB主要帮忙你完成下面四个方面的功能：</p> 
<ol><li>启动程序，可以按照你的自定义的要求随心所欲的运行程序。</li><li>可让被调试的程序在你所指定的调置的断点处停住（断点可以是条件表达式）。</li><li>当程序被停住时，可以检查此时你的程序中所发生的事。</li><li>动态的改变你程序的执行环境：可以改变程序，将一个 BUG 产生的影响修正从而测试其他 BUG。</li></ol> 
<h3><a id="GDB__30"></a>二、GDB 准备工作</h3> 
<h4><a id="GDB__32"></a>GDB 在线安装</h4> 
<p>GDB 的安装有很多种方法，这里采用最简单的在线安装方法：</p> 
<pre><code class="prism language-shell"><span class="token function">sudo</span> <span class="token function">apt-get</span> update  <span class="token comment"># 更新安装资源</span>
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> gdb <span class="token comment"># 安装 GDB </span>

gdb --version        <span class="token comment"># 查看 GDB 版本，查看 GDB 是否安装成功</span>
</code></pre> 
<h4><a id="_44"></a>生成调试信息</h4> 
<p>从上面关于 GDB 的介绍可以了解到，<strong>GDB 的主要功能就是监控程序的执行流程</strong>。这也就意味着，只有当源程序文件编译为可执行文件并执行时，GDB 才会派上用场。</p> 
<ul><li>所以，在为调试而编译时，我们<strong>会关掉编译器的优化选项（<code>-O</code>）， 并打开调试选项（<code>-g</code>）</strong>。</li><li>另外，<code>-Wall</code>在尽量不影响程序行为的情况下选项打开所有 warning，也可以发现许多问题，避免一些不必要的 BUG。<br> 详细可以参看[[04_Linux GCC 编译详解|]]《<a href="https://blog.csdn.net/weixin_45004203/article/details/125926946">Linux 下 GCC 编译常用总结</a>》，这里给出一些简单示例：</li></ul> 
<pre><code class="prism language-shell">gcc -g -Wall program.c -o program

gcc -g hello.c -o hello

g++ -g hello.cpp -o hello
</code></pre> 
<p>【注意】</p> 
<ul><li><code>-g</code> 选项的作用是在可执行文件中加入源代码的信息，比如可执行文件中第几条机器指令对应源代码的第几行，但并不是把整个源文件嵌入到可执行文件中，所以在<strong>调试时必须保证 gdb 能找到源文件</strong>。</li><li>如果没有 <code>-g</code>，你将看不见程序的函数名、变量名，所代替的全是运行时的内存地址。</li></ul> 
<h3><a id="GDB__63"></a>三、GDB 命令</h3> 
<h4><a id="_65"></a>启动、退出、查看代码</h4> 
<p><strong>（1）启动与退出 GDB</strong></p> 
<ul><li>启动 gdb： 
  <ul><li>方式一：gdb program，program 是执行文件的名字。</li><li>方式二：gdb attach pid，pid 也就是运行进程的 pid。这种方式适用于已经运行的程序。</li><li>方式三：gdb program corename，program 是执行文件的名字，corename 是 core dump 的文件名。有时候已经运行的程序突然崩溃了，产生了一个core 文件，此时可以使用 gdb 调试 core 文件，以此可以帮助我们快速定位程序出现段错误的位置。</li><li>查看是否成功启动 gdb 
    <ul><li>当我们成功加载程序进入 gdb 时，会读取符号信息并打印：<code>Reading symbols from /root/flamingoserver/mychatserver...done.</code></li><li>当我们加载程序进入 gdb 失败时，会打印：<code>No symbol table info available.</code></li></ul> </li></ul> </li><li>设置运行参数 
  <ul><li>set args 参数1 参数2 …：args 为运行时所需参数。如：set args 10 20</li><li>show args： 用于查看设置好的运行参数。</li><li>set args：删除参数。</li></ul> </li><li>gdb 使用帮助：help</li><li>退出调试：quit</li></ul> 
<p><strong>（2）显示源代码</strong><br> 用 list 命令来打印程序的源代码。默认打印10行。</p> 
<ul><li><strong>查看当前文件代码</strong> 
  <ul><li>list/l ：从默认位置显示（ 显示当前行后面的源程序）。</li><li>list/l - ：从默认位置显示（显示当前行前面的源程序）。</li><li>list/l linenum： 打印第 linenm 行的上下文内容（一般是打印 linenm 行的上 5 行和下 5 行）。</li><li>list/l function： 显示函数名为 function 的函数的源程序（一般是打印函数名行的上 5 行和下 5 行）。</li></ul> </li><li><strong>查看非当前文件代码</strong> 
  <ul><li>list/l 文件名:行号</li><li>list/l 文件名:函数名</li></ul> </li><li><strong>设置显示的行数</strong>：一般是打印当前行的上5行和下5行，当然也可以定制显示的范围，使用下面命令可设置一次显示源程序的行数。 
  <ul><li>set list/listsize count：设置一次显示源代码的行数。</li><li>show list/listsize： 查看当前 listsize 的设置。</li></ul> </li></ul> 
<p><strong>示例</strong>：</p> 
<pre><code class="prism language-shell">yxm@192:~$ gcc -o  <span class="token builtin class-name">test</span> test.c -g
yxm@192:~$ <span class="token function">ls</span>
company_project  <span class="token function">install</span>  myshare  <span class="token builtin class-name">test</span>  test.c
yxm@192:~$ gdb <span class="token builtin class-name">test</span>
GNU gdb <span class="token punctuation">(</span>Ubuntu <span class="token number">8.1</span>.1-0ubuntu1<span class="token punctuation">)</span> <span class="token number">8.1</span>.1
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2018</span> Free Software Foundation, Inc.
<span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> args <span class="token number">10</span> <span class="token number">20</span> 
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> show args
Argument list to give program being debugged when it is started is <span class="token string">"10 20 "</span><span class="token builtin class-name">.</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> l <span class="token builtin class-name">test</span>
<span class="token number">26</span>
<span class="token number">27</span>          printf<span class="token punctuation">(</span><span class="token string">"THE END !!!<span class="token entity" title="\n">\n</span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">28</span>          <span class="token builtin class-name">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">29</span>      <span class="token punctuation">}</span>
<span class="token number">30</span>
<span class="token number">31</span>      int test<span class="token punctuation">(</span>int a<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token number">32</span>          int num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token number">33</span>          for<span class="token punctuation">(</span>int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a<span class="token punctuation">;</span> ++i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token number">34</span>              num <span class="token operator">+=</span> i<span class="token punctuation">;</span>
<span class="token number">35</span>          <span class="token punctuation">}</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> show list
Number of <span class="token builtin class-name">source</span> lines gdb will list by default is <span class="token number">10</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> quit
yxm@192:~$ 
</code></pre> 
<h4><a id="_130"></a>设置断点</h4> 
<p><strong>（1）设置断点</strong>：break 设置断点，可以简写为 b</p> 
<ul><li><strong>设置当前文件断点</strong> 
  <ul><li>b/break 行号，比如 b 10，在源程序第 10 行设置断点；</li><li>b/break 函数名，将在函数入口处设置断点；</li></ul> </li><li><strong>设置非当前文件断点</strong> 
  <ul><li>break filename:linenum – 在源文件 filename 的 linenum 行处设置断点；</li><li>break filename:function – 在源文件 filename 的 function 函数的入口处设置断点；</li><li>break class::function或function(type,type) – 在类 class 的 function 函数的入口处设置断点；</li><li>break namespace::class::function – 在名称空间为 namespace 的类 class 的 function 函数入口处设置断点。</li></ul> </li><li><strong>设置临时断点</strong>：临时断点在触发一次之后就会被删除 
  <ul><li>tbreak 可以添加临时断点，方法与 break 相同</li></ul> </li></ul> 
<p><strong>（2）查询所有断点</strong></p> 
<ul><li>info break，简写为info b</li><li>i break，简写为i b<br> <img src="https://images2.imgbox.com/a9/0d/E9F0V8ag_o.png" alt=""><br> 【注意】上图中 End 表示断点是否有效，即是否被禁用，y 表示断点可用，n 表示断点禁用</li></ul> 
<p><strong>（3）删除断点/无效断点</strong><br> delete [range…] 删除指定的断点，其简写命令为d/del。</p> 
<ul><li>range 表示断点编号的范围（如：3-7）。</li><li>如果不指定断点号，则表示删除所有的断点。</li><li>如果要同时删除几个，编号可以用空格分隔，如果要删除一个范围内的编号，可以用减号表示（如：2-5）<br> 【注意】range 中的元素是断点编号，不是断点所在的行号。</li></ul> 
<p>比删除更好的一种方法是 disable 停止点，对于 disable 停止点，GDB 不会删除，当你还需要时，enable 即可，就好像回收站一样。</p> 
<ul><li>disable [range…] 使指定断点无效，简写命令是 dis。如果什么都不指定，表示disable所有的停止点。</li><li>enable [range…] 使无效断点生效，简写命令是 ena。如果什么都不指定，表示enable所有的停止点。</li></ul> 
<p><strong>（4）条件断点</strong><br> 一般来说，为断点设置一个条件，我们使用 if 关键词，后面跟其断点条件。<br> 设置一个条件断点：<code>b test.c:23 if i == 5</code><br> 【注意】if 后面跟着的是条件，可能是 == ，也可能是 =，可以根据需要自行设置条件。</p> 
<p><strong>示例：</strong></p> 
<pre><code class="prism language-shell">yxm@192:~/test$ g++ bubble.cpp main.cpp  select.cpp  -o main -g
yxm@192:~/test$ <span class="token function">ls</span>
bubble.cpp  main  main.cpp  select.cpp  sort.h
yxm@192:~/test$ gdb main								<span class="token comment"># 进入 gdb 调试</span>
GNU gdb <span class="token punctuation">(</span>Ubuntu <span class="token number">8.1</span>.1-0ubuntu1<span class="token punctuation">)</span> <span class="token number">8.1</span>.1
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2018</span> Free Software Foundation, Inc.
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
Reading symbols from main<span class="token punctuation">..</span>.done.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span>  b <span class="token number">9</span>												<span class="token comment"># 本文件设置断点</span>
Breakpoint <span class="token number">1</span> at 0x400a2c: <span class="token function">file</span> main.cpp, line <span class="token number">9</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> i b												<span class="token comment"># 显示断点</span>
Num     Type           Disp Enb Address            What
<span class="token number">1</span>       breakpoint     keep y   0x0000000000400a2c <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:9
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b main											<span class="token comment"># 本文件函数设置断点</span>
Breakpoint <span class="token number">2</span> at 0x4009fa: <span class="token function">file</span> main.cpp, line <span class="token number">6</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">break</span> bubble.cpp:11								<span class="token comment"># 非本文件设置断点</span>
Breakpoint <span class="token number">3</span> at 0x400924: <span class="token function">file</span> bubble.cpp, line <span class="token number">11</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b bubble.cpp:bubbleSort							<span class="token comment"># 非本文件函数设置断点</span>
Breakpoint <span class="token number">4</span> at 0x4008c1: <span class="token function">file</span> bubble.cpp, line <span class="token number">8</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> i b
Num     Type           Disp Enb Address            What
<span class="token number">1</span>       breakpoint     keep y   0x0000000000400a2c <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:9
<span class="token number">2</span>       breakpoint     keep y   0x00000000004009fa <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:6
<span class="token number">3</span>       breakpoint     keep y   0x0000000000400924 <span class="token keyword">in</span> bubbleSort<span class="token punctuation">(</span>int*, int<span class="token punctuation">)</span> at bubble.cpp:11
<span class="token number">4</span>       breakpoint     keep y   0x00000000004008c1 <span class="token keyword">in</span> bubbleSort<span class="token punctuation">(</span>int*, int<span class="token punctuation">)</span> at bubble.cpp:8
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> d <span class="token number">4</span>												<span class="token comment"># 删除断点</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> del <span class="token number">3</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> delete <span class="token number">2</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> i b
Num     Type           Disp Enb Address            What
<span class="token number">1</span>       breakpoint     keep y   0x0000000000400a2c <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:9
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b <span class="token number">14</span>
Breakpoint <span class="token number">5</span> at 0x400a45: <span class="token function">file</span> main.cpp, line <span class="token number">14</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> dis <span class="token number">5</span>												<span class="token comment"># 设置断点无效</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> i b
Num     Type           Disp Enb Address            What
<span class="token number">1</span>       breakpoint     keep y   0x0000000000400a2c <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:9
<span class="token number">5</span>       breakpoint     keep n   0x0000000000400a45 <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:14
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span>  <span class="token builtin class-name">enable</span> <span class="token number">5</span>											<span class="token comment"># 设置断点有效</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b <span class="token number">16</span> <span class="token keyword">if</span> <span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">3</span> 										<span class="token comment"># 设置条件断点</span>
Breakpoint <span class="token number">6</span> at 0x400a63: <span class="token function">file</span> main.cpp, line <span class="token number">16</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> i b 
Num     Type           Disp Enb Address            What
<span class="token number">1</span>       breakpoint     keep y   0x0000000000400a2c <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:9
<span class="token number">5</span>       breakpoint     keep y   0x0000000000400a45 <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:14
<span class="token number">6</span>       breakpoint     keep y   0x0000000000400a63 <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:16
        stop only <span class="token keyword">if</span> <span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">3</span>
</code></pre> 
<h4><a id="_228"></a>调试命令</h4> 
<p><strong>（1）调试代码</strong></p> 
<ul><li>运行GDB程序 
  <ul><li>run 运行程序，如果有断点，停在第一个断点处，可简写为 r。<br> 【注意1】启动 GDB 时已经 run 了一次，这次再次输入 run 命令则是重启程序。<br> 【注意2】run 只是停在断点处，但是并没有执行断点处所在的行。</li><li>start 运行程序并停在第一行；</li></ul> </li><li>ctrl + c，中断已经运行的程序。</li><li>continue 继续运行程序，停在下一个断点的位置，可简写为 c。</li><li>next 向下执行一行代码，函数调用当作一条简单语句执行（即不会进入函数体），可简写为 n。</li><li>向下单步调试 
  <ul><li>step 向下单步调试，遇到函数会进入被调用函数体内，可简写为 s；<br> 【注意】<strong>gdb链式调用函数有个问题</strong>：例如，<code>a.fcn1().fcn2()</code> 
    <ul><li>如果我想进入 fcn2，必须要先 step 进入 fcn1直到 fcn1 返回前再输入 step 才能进入 fcn2；</li><li>但是如果我直接在 fcn1 最后输入 next（或finish），则调用堆栈会回到 a.fcn1().fcn2()，这时候再 step 会跳到下一行，而不是fcn2</li></ul> </li><li>finish 跳出函数体，即退出进入的函数。我们想要跳出一个函数，需要满足条件：函数体中不能有断点或者断点不可用；</li></ul> </li><li>until 跳出循环，可简写为 u。我们想要跳出一个循环，首先需要满足： 
  <ol><li>循环体中不能有断点或者断点不可用；</li><li>需要运行到循环体的最后一行（其实循环的最后一行就是循环的开始那一行）。</li></ol> </li><li>until + 行号，继续执行直到指定行数。</li><li>jump + 行号，使程序从当前要执行的代码处，直接跳转到指定位置处继续执行后续的代码，可简写为 j。</li></ul> 
<p><strong>（2）数据查看</strong>：查看运行时数据</p> 
<ul><li>print 变量名：打印变量、字符串、表达式等的值，可简写为 p。print 可以格式化显示信息。</li><li>print *指针对象：打印指针所指向的内存的内容。</li><li>ptype 变量名：打印变量类型<br> 【注意】一般情况下，打印并不存在问题。但当一个待打印的字符串比较长时，打印出来的内容不完整，内容的最后为"…"。可以通过命令：<code>set print elements 0</code> 使打印的字符串长度不受限制。</li></ul> 
<p><strong>（3）自动显示</strong><br> 可以<strong>设置一些自动显示的变量，当程序停住时，或是在你单步跟踪时，这些变量会自动显示</strong>。相关的 GDB 命令是 display。</p> 
<ul><li>display 变量名/表达式：自动打印指定变量的值。【注意】超出变量的作用域后就不会自动打印。</li><li>info display ：查看 display 设置的自动显示的信息。</li><li>删除编号为 num… 的自动显示： 
  <ul><li>delete display num…： 删除编号为 dnums 的变量/表达式的自动显示。</li><li>undisplay num…：删除编号为 dnums 的变量/表达式的自动显示。</li><li>如果要同时删除几个，编号可以用空格分隔；如果要删除一个范围，可以用减号表示（如：2-5）</li></ul> </li><li>禁用/激活自动显示 
  <ul><li>enable display nums…：激活编号为 nums 的变量/表达式的自动显示。</li><li>disable display nums…：禁用编号为 nums 的变量/表达式的自动显示。</li><li>如果要同时禁用/激活几个，编号可以用空格分隔；如果要禁用/激活一个范围，可以用减号表示，如：2-5</li></ul> </li></ul> 
<p>可以通过<strong>设置一些自动监控的变量，当变量的值发生变化时，这些变量会自动显示</strong>。</p> 
<ul><li>相关的 GDB 命令是 watch：watch 变量名：当变量的值发生变化时，这些变量会自动显示。【注意】超出变量的作用域后就不会自动打印。</li><li>info watch ：查看 watch 设置的自动显示的信息。</li></ul> 
<p><strong>（4）修改变量的值</strong><br> 你可以使用 set var 命令来设置某个变量值，让它等于我们想要的值，以便往下继续运行调试，找出程序中 bug：<code>set var width=47 // 将变量var值设置为47</code>。【注意】width 不是你 GDB 的参数，而是程序的变量名</p> 
<p><strong>示例</strong>：</p> 
<pre><code class="prism language-shell">yxm@192:~/test$ g++ bubble.cpp main.cpp  select.cpp  -o main -g
yxm@192:~/test$ <span class="token function">ls</span>
bubble.cpp  main  main.cpp  select.cpp  sort.h
yxm@192:~/test$ gdb main								<span class="token comment"># 进入 gdb 调试</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> start
Temporary breakpoint <span class="token number">7</span> at 0x4009fa: <span class="token function">file</span> main.cpp, line <span class="token number">6</span>.
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
Temporary breakpoint <span class="token number">7</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:6
<span class="token number">6</span>       int <span class="token function-name function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c													<span class="token comment"># 没有设置断点，所以直接运行到最后</span>
Continuing.
冒泡排序之后的数组: <span class="token number">12</span> <span class="token number">22</span> <span class="token number">27</span> <span class="token number">55</span> <span class="token number">67</span> 
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
选择排序之后的数组: <span class="token number">11</span> <span class="token number">25</span> <span class="token number">36</span> <span class="token number">47</span> <span class="token number">80</span> 
<span class="token punctuation">[</span>Inferior <span class="token number">1</span> <span class="token punctuation">(</span>process <span class="token number">3381</span><span class="token punctuation">)</span> exited normally<span class="token punctuation">]</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b <span class="token number">8</span>												<span class="token comment"># 设置断点</span>
Breakpoint <span class="token number">8</span> at 0x400a09: <span class="token function">file</span> main.cpp, line <span class="token number">8</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b bubble.cpp:bubbleSort
Breakpoint <span class="token number">9</span> at 0x4008c1: <span class="token function">file</span> bubble.cpp, line <span class="token number">8</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b <span class="token number">16</span>
Breakpoint <span class="token number">10</span> at 0x400a63: <span class="token function">file</span> main.cpp, line <span class="token number">16</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> i b
Num     Type           Disp Enb Address            What
<span class="token number">8</span>       breakpoint     keep y   0x0000000000400a09 <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:8
<span class="token number">9</span>       breakpoint     keep y   0x00000000004008c1 <span class="token keyword">in</span> bubbleSort<span class="token punctuation">(</span>int*, int<span class="token punctuation">)</span> at bubble.cpp:8
<span class="token number">10</span>      breakpoint     keep y   0x0000000000400a63 <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:16
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> run
Starting program: /home/yxm/test/main 
Breakpoint <span class="token number">8</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:8
<span class="token number">8</span>           int array<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">12</span>, <span class="token number">27</span>, <span class="token number">55</span>, <span class="token number">22</span>, <span class="token number">67</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c
Continuing.
Breakpoint <span class="token number">9</span>, bubbleSort <span class="token punctuation">(</span>array<span class="token operator">=</span>0x7fffffffe310, <span class="token assign-left variable">len</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span> at bubble.cpp:8
<span class="token number">8</span>           <span class="token keyword">for</span> <span class="token punctuation">(</span>int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len - <span class="token number">1</span><span class="token punctuation">;</span> i++<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> next
<span class="token number">9</span>                       <span class="token keyword">for</span> <span class="token punctuation">(</span>int j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> len - <span class="token number">1</span> - i<span class="token punctuation">;</span> j++<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c
Continuing.
Breakpoint <span class="token number">10</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:17
<span class="token number">17</span>              cout <span class="token operator">&lt;&lt;</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> i b
Num     Type           Disp Enb Address            What
<span class="token number">8</span>       breakpoint     keep y   0x0000000000400a09 <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:8
        breakpoint already hit <span class="token number">1</span> <span class="token function">time</span>				<span class="token comment"># 表示断点已经被击中过</span>
<span class="token number">9</span>       breakpoint     keep y   0x00000000004008c1 <span class="token keyword">in</span> bubbleSort<span class="token punctuation">(</span>int*, int<span class="token punctuation">)</span> at bubble.cpp:8
        breakpoint already hit <span class="token number">1</span> <span class="token function">time</span>
<span class="token number">10</span>      breakpoint     keep y   0x0000000000400a63 <span class="token keyword">in</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> at main.cpp:16
        breakpoint already hit <span class="token number">1</span> <span class="token function">time</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> print i										<span class="token comment"># 打印变量的值</span>
<span class="token variable">$1</span> <span class="token operator">=</span> <span class="token number">2</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> ptype i										<span class="token comment"># 打印变量的类型</span>
<span class="token builtin class-name">type</span> <span class="token operator">=</span> int
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> del <span class="token number">10</span>										<span class="token comment"># 删除循环体内断点</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token keyword">until</span>											<span class="token comment"># 退出循环体</span>
<span class="token number">15</span>          for<span class="token punctuation">(</span>int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i++<span class="token punctuation">)</span> 
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> s
<span class="token number">19</span>          cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c
Continuing.
冒泡排序之后的数组: <span class="token number">12</span> <span class="token number">22</span> <span class="token number">27</span> <span class="token number">55</span> <span class="token number">67</span> 
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
选择排序之后的数组: <span class="token number">11</span> <span class="token number">25</span> <span class="token number">36</span> <span class="token number">47</span> <span class="token number">80</span> 
<span class="token punctuation">[</span>Inferior <span class="token number">1</span> <span class="token punctuation">(</span>process <span class="token number">3763</span><span class="token punctuation">)</span> exited normally<span class="token punctuation">]</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/748bae45bbd57e804225fbdf507b1609/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">搭建SFTP服务安全共享文件，实现在外远程访问「内网穿透」</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c34d52fa061b05e947cc40f47edeeb07/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SINet阅读笔记</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>