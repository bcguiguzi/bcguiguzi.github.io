<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android中的五大数据存储方式之一——文件存储 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android中的五大数据存储方式之一——文件存储" />
<meta property="og:description" content="Android中的数据存储方式有5种，分别是文件存储、SharedPreferences、SQLite数据库、ContentProvider、网络存储。 每种存储方式有不同的特点，在这里简单介绍一下： 文件存储 ：以I/O流形式把数据存入手机内存或者SD卡，可以存储大数据，如音乐、图片或视频等。
SharedPreferences：它本质上是一个XML文件，以键值对形式存入手机内存中。常用于存储较简单的参数设置，如QQ登录账号密码的存储、窗口功能状态的存储等，使用起来简单方便。
SQLite数据库 ：是一个轻量级数据库，可跨平台，占用内存小，支持基本SQL语法，支持大部分的语言，是项目中经常被采用的一种数据存储方式，通常用于存储用户信息等。 ContentProvider：又称内容提供者，是Android四大组件之一，以数据库形式存入手机内存，可以共享自己的数据给其他应用使用。相对于其他对外共享数据的方式而言， ContentProvider统一了数据访问方式，使用起来更规范。 网络存储 ：把数据存储到服务器，不存储在本地，使用时直接从网络获取。
本文主要介绍文件存储。
文件存储是Android中最基本的数据存储方式，与java中的文件存储类似，都是通过I/O流的形式把数据原封不动的存储到文档中。 文件存储可存在设备内部的存储空间中，即内部存储，也可存入到外置的SD卡中，即外部存储。这两种存储方式的主要区别在于，外部存储比内部存储多了一个确认设备是否可用的步骤，其余的输入输出都与内部存储类似。
1.内部存储 内部存储创建的文件保存在/data/data//files目录下。内部存储方式存储的文件被创建的应用程序私有，其他程序若要使用需设置权限。当应用程序被卸载时，内部存储文件也被随之删除。 内部存储使用openFileOutput()和openFIleInput()方法，获得FileOutputStream对象和FileInputStream对象，两个方法的形式如下： FlieOutputStream openFileOutput(String name,int mode); FileInputStream openFileInput(String name); 上述两个方法中，openFileOutput()用于打开应用程序中对应的输出流，存储数据；openFIleInput()用于打开对应输入流，读取数据。 其中，name表示文件名，mode表示读写文件的方式，取值有如下四种： MODE_PRIVATE: 该文件只能被当前文件读写，且不能追加，每一次都会覆盖原文件，默认的操作模式。MODE_APPEND: 会检查文件是否存在，存在就追加内容，否则创建新文件，常用的一种模式。MODE_WORLD_READABLE: 用来控制其他应用是否有权限读该文件，安全性低，通常不使用。MODE_WORLD_WRITEABLE: 用来控制其他应用是否有权限写该文件，安全性低，通常不使用。
Flie类方法（包括内部和外部）介绍示例 File file = this.getFilesDir(); //获得当前程序默认文件存储目录，即/data/data/&lt;package name&gt;/files File file = this.getCacheDir(); //获得默认缓冲文件存放位置，把一些不太重要的文件在此处创建、使用， //内存不足时系统会自动删去APP的cache目录的数据 File file = this.getDir(&#34;name&#34;,MODE_APPEND); //创建一个目录在/data/data/&lt;package name&gt;/files之下 File file = this.getExternalCacheDir(); //可以得到外部的存储位置，该位置的数据跟内置的使用相同。 //若APP卸载，此数据也会自动清除 存储数据示例代码
String fileName=&#34;data.txt&#34;; //文件名称 String context=&#34;helloworld&#34;; //要保存的数据 FileOutputStream fos; try{ fos = openFileOutput(fileName,MODE_PRIVATE); //打开程序的输出流，存储数据到data." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/5ae108d988b7cb8b04f963838c398534/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-11-14T23:08:48+08:00" />
<meta property="article:modified_time" content="2016-11-14T23:08:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android中的五大数据存储方式之一——文件存储</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>Android中的数据存储方式有5种，分别是文件存储、SharedPreferences、SQLite数据库、ContentProvider、网络存储。 </p> 
<p>每种存储方式有不同的特点，在这里简单介绍一下： </p> 
<ul><li><p>文件存储 ：以I/O流形式把数据存入手机内存或者SD卡，可以存储大数据，如音乐、图片或视频等。</p></li><li><p>SharedPreferences：它本质上是一个XML文件，以键值对形式存入手机内存中。常用于存储较简单的参数设置，如QQ登录账号密码的存储、窗口功能状态的存储等，使用起来简单方便。</p></li><li><p>SQLite数据库 ：是一个轻量级数据库，可跨平台，占用内存小，支持基本SQL语法，支持大部分的语言，是项目中经常被采用的一种数据存储方式，通常用于存储用户信息等。 </p></li><li><p>ContentProvider：又称内容提供者，是Android四大组件之一，以数据库形式存入手机内存，可以共享自己的数据给其他应用使用。相对于其他对外共享数据的方式而言， ContentProvider统一了数据访问方式，使用起来更规范。 </p></li><li><p>网络存储 ：把数据存储到服务器，不存储在本地，使用时直接从网络获取。</p></li></ul> 
<p>本文主要介绍文件存储。</p> 
<p>文件存储是Android中最基本的数据存储方式，与java中的文件存储类似，都是通过I/O流的形式把数据原封不动的存储到文档中。 文件存储可存在设备内部的存储空间中，即内部存储，也可存入到外置的SD卡中，即外部存储。这两种存储方式的主要区别在于，外部存储比内部存储多了一个确认设备是否可用的步骤，其余的输入输出都与内部存储类似。</p> 
<hr> 
<h3 id="1内部存储">1.内部存储</h3> 
<p>内部存储创建的文件保存在/data/data//files目录下。内部存储方式存储的文件被创建的应用程序私有，其他程序若要使用需设置权限。当应用程序被卸载时，内部存储文件也被随之删除。 </p> 
<pre><code>内部存储使用openFileOutput()和openFIleInput()方法，获得FileOutputStream对象和FileInputStream对象，两个方法的形式如下：
</code></pre> 
<pre class="prettyprint"><code class=" hljs vbscript">FlieOutputStream openFileOutput(<span class="hljs-built_in">String</span> name,<span class="hljs-built_in">int</span> mode);
FileInputStream openFileInput(<span class="hljs-built_in">String</span> name);</code></pre> 
<pre><code>    上述两个方法中，openFileOutput()用于打开应用程序中对应的输出流，存储数据；openFIleInput()用于打开对应输入流，读取数据。
</code></pre> 
<p>其中，name表示文件名，mode表示读写文件的方式，取值有如下四种： </p> 
<ol><li>MODE_PRIVATE: 该文件只能被当前文件读写，且不能追加，每一次都会覆盖原文件，默认的操作模式。</li><li>MODE_APPEND: 会检查文件是否存在，存在就追加内容，否则创建新文件，常用的一种模式。</li><li>MODE_WORLD_READABLE: 用来控制其他应用是否有权限读该文件，安全性低，通常不使用。</li><li><p>MODE_WORLD_WRITEABLE: 用来控制其他应用是否有权限写该文件，安全性低，通常不使用。</p> <p><strong>Flie类方法（包括内部和外部）介绍示例</strong> </p></li></ol> 
<pre class="prettyprint"><code class=" hljs cs">File file = <span class="hljs-keyword">this</span>.getFilesDir();     <span class="hljs-comment">//获得当前程序默认文件存储目录，即/data/data/&lt;package name&gt;/files</span>
File file = <span class="hljs-keyword">this</span>.getCacheDir();     <span class="hljs-comment">//获得默认缓冲文件存放位置，把一些不太重要的文件在此处创建、使用，</span>
                                    <span class="hljs-comment">//内存不足时系统会自动删去APP的cache目录的数据</span>
File file = <span class="hljs-keyword">this</span>.getDir(<span class="hljs-string">"name"</span>,MODE_APPEND);   <span class="hljs-comment">//创建一个目录在/data/data/&lt;package name&gt;/files之下</span>
File file = <span class="hljs-keyword">this</span>.getExternalCacheDir();        <span class="hljs-comment">//可以得到外部的存储位置，该位置的数据跟内置的使用相同。</span>
                                               <span class="hljs-comment">//若APP卸载，此数据也会自动清除</span></code></pre> 
<p><strong>存储数据示例代码</strong></p> 
<pre class="prettyprint"><code class=" hljs javascript"><span class="hljs-built_in">String</span> fileName=<span class="hljs-string">"data.txt"</span>;       <span class="hljs-comment">//文件名称</span>
<span class="hljs-built_in">String</span> context=<span class="hljs-string">"helloworld"</span>;      <span class="hljs-comment">//要保存的数据</span>
FileOutputStream fos;
<span class="hljs-keyword">try</span>{
   fos = openFileOutput(fileName,MODE_PRIVATE);       <span class="hljs-comment">//打开程序的输出流，存储数据到data.txt，以私有模式</span>
                                <span class="hljs-comment">//若希望文件被其他应用读和写，可以传入MODE_WORLD_READABLE+MODE_WORLD_WRITEABLE</span>
   fos.write(content.getBytes));              <span class="hljs-comment">//向fos对象写入context的内容，以二进制形式保存</span>
   fos.close();                 <span class="hljs-comment">//关闭输出流</span>
   }<span class="hljs-keyword">catch</span> (FileNotFoundException e) {
     e.printStackTrace();
   }<span class="hljs-keyword">catch</span> (IOEception e) {
     e.printStackTrace();
   }</code></pre> 
<p><strong>读取文件示例代码</strong> </p> 
<pre class="prettyprint"><code class=" hljs cs">String fileName=<span class="hljs-string">"data.txt"</span>;       <span class="hljs-comment">//文件名称</span>
String context=<span class="hljs-keyword">null</span>;         <span class="hljs-comment">//用于保存读取出来的数据</span>
FileInputStream fis;       
<span class="hljs-keyword">try</span>{
   fis = openFileInput(fileName);       <span class="hljs-comment">//打开程序的输出流，存储数据到data.txt</span>
   ByteArrayOutputStream baos = <span class="hljs-keyword">new</span> ByteArrayOutputStream();    
                                       <span class="hljs-comment">//可以捕获内存缓冲区的数据，转换成字节数组。</span>
   <span class="hljs-keyword">byte</span>[] buffer = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">1024</span>];      <span class="hljs-comment">//每次读1024字节</span>
   <span class="hljs-keyword">int</span> len=<span class="hljs-number">0</span>;       <span class="hljs-comment">//初始长度定义为0</span>
   <span class="hljs-keyword">while</span>((len = fis.read(buffer))!=-<span class="hljs-number">1</span>) {    <span class="hljs-comment">//如果buffer里面还有值</span>
       baos.write(buffer,<span class="hljs-number">0</span>,len);            <span class="hljs-comment">//就从buffer里，将0~len的值全部写到baos里</span>
   }
   context = baos.toString();               <span class="hljs-comment">//将baos中的数据写出去</span>
   fis.close();                 <span class="hljs-comment">//关闭输出流</span>
   baos.close();
   }<span class="hljs-keyword">catch</span> (FileNotFoundException e) {
     e.printStackTrace();
   }<span class="hljs-keyword">catch</span> (IOEception e) {
     e.printStackTrace();
   }</code></pre> 
<hr> 
<h3 id="2外部存储">2.外部存储</h3> 
<p>外部存储是指将文件存储到一些外围设备上（通常位于mnt/sdcard目录下）。由于外围存储设备可能被移除、丢失或者处于其他状态，因此在使用外围设备之前必须使用Environment.getExternalStorageState()方法来确认外围设备是否可用，当外围设备可用并且具有读写权限时，就可以通过FileInputStream、FileOutputStream或者FileReader、FileWriter对象来读写外围设备中的文件，此时和内部存储的方式相同。 </p> 
<p><strong>向外围设备中存储数据的示例代码如下</strong> </p> 
<pre class="prettyprint"><code class=" hljs javascript"><span class="hljs-built_in">String</span> state = Environment.getExternalStorageState();      
<span class="hljs-keyword">if</span>(state.equals(Environment.MEDIA_MOUNTED)) {              <span class="hljs-comment">//确认外围设备是否可用</span>
    File SDPath = Environment.getExternalStorageDirectory();  <span class="hljs-comment">//获取SD卡根目录路径</span>
    File file = <span class="hljs-keyword">new</span> File(SDPath,<span class="hljs-string">"data.txt"</span>);
    <span class="hljs-built_in">String</span> data = <span class="hljs-string">"HelloWorld"</span>;
    FileOutputStream fos;
    <span class="hljs-keyword">try</span>{
       fos = <span class="hljs-keyword">new</span> FileOutputStream(file);
       fos.write(data.getBytes());
       fos.close();
    }<span class="hljs-keyword">catch</span> (FileNotFoundException e) {
     e.printStackTrace();
    }<span class="hljs-keyword">catch</span> (IOEception e) {
     e.printStackTrace();
    }
}</code></pre> 
<p><strong>从外围设备读取数据示例代码</strong> </p> 
<pre class="prettyprint"><code class=" hljs go">String state = Environment.getExternalStorageState();      
<span class="hljs-keyword">if</span>(state.equals(Environment.MEDIA_MOUNTED)) {              <span class="hljs-comment">//确认外围设备是否可用</span>
    File SDPath = Environment.getExternalStorageDirectory();  <span class="hljs-comment">//获取SD卡根目录路径</span>
    File file = <span class="hljs-built_in">new</span> File(SDPath,<span class="hljs-string">"data.txt"</span>);
    String data = <span class="hljs-string">"HelloWorld"</span>;
    FileInputStream fis;
    try{
       fis = <span class="hljs-built_in">new</span> FileOutputStream(file);
       ByteArrayOutputStream baos = <span class="hljs-built_in">new</span> ByteArrayOutputStream();    <span class="hljs-comment">//与内部存储相同</span>
        <span class="hljs-typename">byte</span>[] buffer = <span class="hljs-built_in">new</span> <span class="hljs-typename">byte</span><span class="hljs-number">[1024</span>];      
       <span class="hljs-typename">int</span> <span class="hljs-built_in">len</span><span class="hljs-number">=0</span>;       
       while((<span class="hljs-built_in">len</span> = fis.read(buffer))!<span class="hljs-number">=-1</span>) {    
       baos.write(buffer<span class="hljs-number">,0</span>,<span class="hljs-built_in">len</span>);            
       }
      String context = baos.toString();               
       fis.<span class="hljs-built_in">close</span>();
       baos.<span class="hljs-built_in">close</span>();
    }catch (FileNotFoundException e) {
     e.printStackTrace();
    }catch (IOEception e) {
     e.printStackTrace();
    }
}
</code></pre> 
<hr> 
<p>需要注意的是，如果程序需要访问系统的一些关键信息，必须要在清单文件声明权限才可以，否则程序会直接崩溃。操作SD卡中的数据就是系统中比较关键的信息，因此需要在清单文件的节点下配置权限信息，具体代码如下：</p> 
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">user-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.WRITE_EXTERNAL_STORAGE"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">user-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.READ_EXTERNAL_STORAGE"</span>/&gt;</span></code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/982881f5a7366313cc263980123b0dae/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Mysql GTID 模式详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bd0dfab458bfeead53c334676f2a6ebf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CMPP发送长短信，我可以实现了 CMPP2长短信实现（java版）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>