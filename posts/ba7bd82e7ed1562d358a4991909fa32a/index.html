<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mysql数据库之事务 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Mysql数据库之事务" />
<meta property="og:description" content="目录
一、事务的概念
二、事务的ACID特点
1.原子性（Atomicity）
2.一致性（Consistency）
3.隔离性（lsolation）
4.持久性（Durability)
三、并发访问表的一致性问题和事务的隔离级别
1.并发访问表的一致性问题
（1）脏读
（2）不可重复读
（3）幻读
（4）丢失更新
2.事务的隔离级别
（1）未提交读（Read Uncommitted (RU)）
（2）提交读（Read Committed (RC)）
（3）可重复读（Repeatable Read (RR))
（4）串行读（serializable）
3.数据库默认隔离级别
4.事务隔离级别的范围和查看方式
（1）范围分类
（2）查看全局事务隔离级别
（3）查看会话事务隔离级别
（4）修改全局事务隔离级别
四、事务控制语句
1.显式地开启一个事务
2. 提交事务，并使已对数据库进行的所有修改变为永久性的
3.回滚会结束用户的事务，并撤销正在进行的所有未提交的修改 4. 在事务中创建一个回滚点
5. 把事务回滚到标记点
五、修改自动提交参数
1.数据库中临时修改
2.永久修改
一、事务的概念 是一种机制、一个操作序列，包含了一组数据库操作命令，并且把所有的命令作为一个整体一起向系统提交或撤销操作请求，即这一组数据库命令要么都执行，要么都不执行。
是一个不可分割的工作逻辑单元，在数据库系统上执行并发操作时，事务是最小的控制单元。
适用于多用户同时操作的数据库系统的场景，如银行、保险公司及证券交易系统等等。
通过事务的整体性以保证数据的一致性。
二、事务的ACID特点 1.原子性（Atomicity） 指事务是一个不可再分割的工作单位，事务中的操作要么都发生，要么都不发生。
事务是一个完整的操作，事务的各元素是不可分割的；事务中的所有元素必须作为一个整体提交或回滚；如果事务中的任何元素失败，则整个事务将失败。 2.一致性（Consistency） 指在事务开始之前和事务结束以后，数据库的完整性约束没有被破坏。
在事务开始前，数据库中存储的数据处于一致状态；当事务完成后，数据也必须处于一致状态。 3.隔离性（lsolation） 指在并发环境中，当不同的事务同时操纵相同的数据时，每个事务都有各自的完整数据空间。
对数据进行修改的所有并发事务是彼此隔离的，表明事务必须是独立的，它不应以任何方式依赖于或影响其他事务；修改数据的事务可在另一个使用相同数据的事务开始之前访问这些数据，或者在另一个使用相同数据的事务结束之后访问这些数据，即并发访问数据库时，一个用户的事务不被其他事务所干扰，各并发事务之间数据库是独立的。 4.持久性（Durability) 在事务完成以后，该事务所对数据库所作的更改便持久的保存在数据库之中，并不会被回滚。指不管系统是否发生故障，事务处理的结果都是永久的。一旦事务被提交，事务的效果会被永久地保留在数据库中。
总结：在事务管理中，原子性是基础，隔离性是手段，一致性是目的，持久性是结果。
三、并发访问表的一致性问题和事务的隔离级别 1.并发访问表的一致性问题 （1）脏读 当一个事务正在访问数据，并且对数据进行了修改，而这种修改还没有提交到数据库中，这时，另外一个事务也访问这个数据，然后使用了这个数据。（即一个事务能看到另一个事务未提交的数据）
（2）不可重复读 指在一个事务内，多次读同一数据。在这个事务还没有结束时，另外一个事务也访问该同一数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改，那么第一个事务两次读到的的数据可能是不一样的。这样就发生了在一个事务内两次读到的数据是不一样的，因此称为是不可重复读。（即由于一个事务中途修改使另一个事务多次读取不能读到相同的数据内容)
（3）幻读 一个事务对一个表中的数据进行了修改，这种修改涉及到表中的全部数据行。同时，另一个事务也修改这个表中的数据，这种修改是向表中插入一行新数据。那么，操作前一个事务的用户会发现表中还有没有修改的数据行，就好像发生了幻觉一样。（即一个事务明明修改了多行数据记录，但由于另一个数据的影响，却导致发现有数据记录未被修改）
（4）丢失更新 两个事务同时读取同一条记录，A先修改记录，B也修改记录（B不知道A修改过)，B提交数据后B的修改结果覆盖了A的修改结果。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/ba7bd82e7ed1562d358a4991909fa32a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-26T10:58:22+08:00" />
<meta property="article:modified_time" content="2022-10-26T10:58:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Mysql数据库之事务</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%A6%82%E5%BF%B5-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%A6%82%E5%BF%B5" rel="nofollow">一、事务的概念</a></p> 
<p id="%E4%BA%8C%E3%80%81%E4%BA%8B%E5%8A%A1%E7%9A%84ACID%E7%89%B9%E7%82%B9-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E4%BA%8B%E5%8A%A1%E7%9A%84ACID%E7%89%B9%E7%82%B9" rel="nofollow">二、事务的ACID特点</a></p> 
<p id="1.%E5%8E%9F%E5%AD%90%E6%80%A7%EF%BC%88Atomicity%EF%BC%89-toc" style="margin-left:40px;"><a href="#1.%E5%8E%9F%E5%AD%90%E6%80%A7%EF%BC%88Atomicity%EF%BC%89" rel="nofollow">1.原子性（Atomicity）</a></p> 
<p id="2.%E4%B8%80%E8%87%B4%E6%80%A7%EF%BC%88Consistency%EF%BC%89-toc" style="margin-left:40px;"><a href="#2.%E4%B8%80%E8%87%B4%E6%80%A7%EF%BC%88Consistency%EF%BC%89" rel="nofollow">2.一致性（Consistency）</a></p> 
<p id="3.%E9%9A%94%E7%A6%BB%E6%80%A7%EF%BC%88lsolation%EF%BC%89-toc" style="margin-left:40px;"><a href="#3.%E9%9A%94%E7%A6%BB%E6%80%A7%EF%BC%88lsolation%EF%BC%89" rel="nofollow">3.隔离性（lsolation）</a></p> 
<p id="4.%E6%8C%81%E4%B9%85%E6%80%A7(Durability)-toc" style="margin-left:40px;"><a href="#4.%E6%8C%81%E4%B9%85%E6%80%A7%28Durability%29" rel="nofollow">4.持久性（Durability)</a></p> 
<p id="%E4%B8%89%E3%80%81%E5%B9%B6%E5%8F%91%E8%AE%BF%E9%97%AE%E8%A1%A8%E7%9A%84%E4%B8%80%E8%87%B4%E6%80%A7%E9%97%AE%E9%A2%98%E5%92%8C%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81%E5%B9%B6%E5%8F%91%E8%AE%BF%E9%97%AE%E8%A1%A8%E7%9A%84%E4%B8%80%E8%87%B4%E6%80%A7%E9%97%AE%E9%A2%98%E5%92%8C%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB" rel="nofollow">三、并发访问表的一致性问题和事务的隔离级别</a></p> 
<p id="1.%E5%B9%B6%E5%8F%91%E8%AE%BF%E9%97%AE%E8%A1%A8%E7%9A%84%E4%B8%80%E8%87%B4%E6%80%A7%E9%97%AE%E9%A2%98-toc" style="margin-left:40px;"><a href="#1.%E5%B9%B6%E5%8F%91%E8%AE%BF%E9%97%AE%E8%A1%A8%E7%9A%84%E4%B8%80%E8%87%B4%E6%80%A7%E9%97%AE%E9%A2%98" rel="nofollow">1.并发访问表的一致性问题</a></p> 
<p id="%EF%BC%881%EF%BC%89%E8%84%8F%E8%AF%BB-toc" style="margin-left:80px;"><a href="#%EF%BC%881%EF%BC%89%E8%84%8F%E8%AF%BB" rel="nofollow">（1）脏读</a></p> 
<p id="%EF%BC%882%EF%BC%89%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB-toc" style="margin-left:80px;"><a href="#%EF%BC%882%EF%BC%89%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB" rel="nofollow">（2）不可重复读</a></p> 
<p id="%EF%BC%883%EF%BC%89%E5%B9%BB%E8%AF%BB-toc" style="margin-left:80px;"><a href="#%EF%BC%883%EF%BC%89%E5%B9%BB%E8%AF%BB" rel="nofollow">（3）幻读</a></p> 
<p id="%EF%BC%884%EF%BC%89%E4%B8%A2%E5%A4%B1%E6%9B%B4%E6%96%B0-toc" style="margin-left:80px;"><a href="#%EF%BC%884%EF%BC%89%E4%B8%A2%E5%A4%B1%E6%9B%B4%E6%96%B0" rel="nofollow">（4）丢失更新</a></p> 
<p id="2.%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB-toc" style="margin-left:40px;"><a href="#2.%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB" rel="nofollow">2.事务的隔离级别</a></p> 
<p id="%EF%BC%881%EF%BC%89%E6%9C%AA%E6%8F%90%E4%BA%A4%E8%AF%BB%EF%BC%88Read%20Uncommitted%20(RU)%EF%BC%89-toc" style="margin-left:80px;"><a href="#%EF%BC%881%EF%BC%89%E6%9C%AA%E6%8F%90%E4%BA%A4%E8%AF%BB%EF%BC%88Read%20Uncommitted%20%28RU%29%EF%BC%89" rel="nofollow">（1）未提交读（Read Uncommitted (RU)）</a></p> 
<p id="%EF%BC%882%EF%BC%89%E6%8F%90%E4%BA%A4%E8%AF%BB%EF%BC%88Read%20Committed%20(RC)%EF%BC%89-toc" style="margin-left:80px;"><a href="#%EF%BC%882%EF%BC%89%E6%8F%90%E4%BA%A4%E8%AF%BB%EF%BC%88Read%20Committed%20%28RC%29%EF%BC%89" rel="nofollow">（2）提交读（Read Committed (RC)）</a></p> 
<p id="%EF%BC%883%EF%BC%89%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%EF%BC%88Repeatable%20Read%20(RR))-toc" style="margin-left:80px;"><a href="#%EF%BC%883%EF%BC%89%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%EF%BC%88Repeatable%20Read%20%28RR%29%29" rel="nofollow">（3）可重复读（Repeatable Read (RR))</a></p> 
<p id="%EF%BC%884%EF%BC%89%E4%B8%B2%E8%A1%8C%E8%AF%BB%EF%BC%88serializable%EF%BC%89-toc" style="margin-left:80px;"><a href="#%EF%BC%884%EF%BC%89%E4%B8%B2%E8%A1%8C%E8%AF%BB%EF%BC%88serializable%EF%BC%89" rel="nofollow">（4）串行读（serializable）</a></p> 
<p id="3.%E6%95%B0%E6%8D%AE%E5%BA%93%E9%BB%98%E8%AE%A4%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB-toc" style="margin-left:40px;"><a href="#3.%E6%95%B0%E6%8D%AE%E5%BA%93%E9%BB%98%E8%AE%A4%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB" rel="nofollow">3.数据库默认隔离级别</a></p> 
<p id="4.%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E7%9A%84%E8%8C%83%E5%9B%B4%E5%92%8C%E6%9F%A5%E7%9C%8B%E6%96%B9%E5%BC%8F-toc" style="margin-left:40px;"><a href="#4.%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E7%9A%84%E8%8C%83%E5%9B%B4%E5%92%8C%E6%9F%A5%E7%9C%8B%E6%96%B9%E5%BC%8F" rel="nofollow">4.事务隔离级别的范围和查看方式</a></p> 
<p id="%EF%BC%881%EF%BC%89%E8%8C%83%E5%9B%B4%E5%88%86%E7%B1%BB-toc" style="margin-left:80px;"><a href="#%EF%BC%881%EF%BC%89%E8%8C%83%E5%9B%B4%E5%88%86%E7%B1%BB" rel="nofollow">（1）范围分类</a></p> 
<p id="%EF%BC%882%EF%BC%89%E6%9F%A5%E7%9C%8B%E5%85%A8%E5%B1%80%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB-toc" style="margin-left:80px;"><a href="#%EF%BC%882%EF%BC%89%E6%9F%A5%E7%9C%8B%E5%85%A8%E5%B1%80%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB" rel="nofollow">（2）查看全局事务隔离级别</a></p> 
<p id="%EF%BC%883%EF%BC%89%E6%9F%A5%E7%9C%8B%E4%BC%9A%E8%AF%9D%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB-toc" style="margin-left:80px;"><a href="#%EF%BC%883%EF%BC%89%E6%9F%A5%E7%9C%8B%E4%BC%9A%E8%AF%9D%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB" rel="nofollow">（3）查看会话事务隔离级别</a></p> 
<p id="%EF%BC%884%EF%BC%89%E4%BF%AE%E6%94%B9%E5%85%A8%E5%B1%80%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB-toc" style="margin-left:80px;"><a href="#%EF%BC%884%EF%BC%89%E4%BF%AE%E6%94%B9%E5%85%A8%E5%B1%80%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB" rel="nofollow">（4）修改全局事务隔离级别</a></p> 
<p id="%E5%9B%9B%E3%80%81%E4%BA%8B%E5%8A%A1%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%E4%BA%8B%E5%8A%A1%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5" rel="nofollow">四、事务控制语句</a></p> 
<p id="1.%E6%98%BE%E5%BC%8F%E5%9C%B0%E5%BC%80%E5%90%AF%E4%B8%80%E4%B8%AA%E4%BA%8B%E5%8A%A1-toc" style="margin-left:40px;"><a href="#1.%E6%98%BE%E5%BC%8F%E5%9C%B0%E5%BC%80%E5%90%AF%E4%B8%80%E4%B8%AA%E4%BA%8B%E5%8A%A1" rel="nofollow">1.显式地开启一个事务</a></p> 
<p id="2.%C2%A0%E6%8F%90%E4%BA%A4%E4%BA%8B%E5%8A%A1%EF%BC%8C%E5%B9%B6%E4%BD%BF%E5%B7%B2%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9B%E8%A1%8C%E7%9A%84%E6%89%80%E6%9C%89%E4%BF%AE%E6%94%B9%E5%8F%98%E4%B8%BA%E6%B0%B8%E4%B9%85%E6%80%A7%E7%9A%84-toc" style="margin-left:40px;"><a href="#2.%C2%A0%E6%8F%90%E4%BA%A4%E4%BA%8B%E5%8A%A1%EF%BC%8C%E5%B9%B6%E4%BD%BF%E5%B7%B2%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9B%E8%A1%8C%E7%9A%84%E6%89%80%E6%9C%89%E4%BF%AE%E6%94%B9%E5%8F%98%E4%B8%BA%E6%B0%B8%E4%B9%85%E6%80%A7%E7%9A%84" rel="nofollow">2. 提交事务，并使已对数据库进行的所有修改变为永久性的</a></p> 
<p id="3.%E5%9B%9E%E6%BB%9A%E4%BC%9A%E7%BB%93%E6%9D%9F%E7%94%A8%E6%88%B7%E7%9A%84%E4%BA%8B%E5%8A%A1%EF%BC%8C%E5%B9%B6%E6%92%A4%E9%94%80%E6%AD%A3%E5%9C%A8%E8%BF%9B%E8%A1%8C%E7%9A%84%E6%89%80%E6%9C%89%E6%9C%AA%E6%8F%90%E4%BA%A4%E7%9A%84%E4%BF%AE%E6%94%B9%C2%A0-toc" style="margin-left:40px;"><a href="#3.%E5%9B%9E%E6%BB%9A%E4%BC%9A%E7%BB%93%E6%9D%9F%E7%94%A8%E6%88%B7%E7%9A%84%E4%BA%8B%E5%8A%A1%EF%BC%8C%E5%B9%B6%E6%92%A4%E9%94%80%E6%AD%A3%E5%9C%A8%E8%BF%9B%E8%A1%8C%E7%9A%84%E6%89%80%E6%9C%89%E6%9C%AA%E6%8F%90%E4%BA%A4%E7%9A%84%E4%BF%AE%E6%94%B9%C2%A0" rel="nofollow">3.回滚会结束用户的事务，并撤销正在进行的所有未提交的修改 </a></p> 
<p id="4.%C2%A0%E5%9C%A8%E4%BA%8B%E5%8A%A1%E4%B8%AD%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%9B%9E%E6%BB%9A%E7%82%B9-toc" style="margin-left:40px;"><a href="#4.%C2%A0%E5%9C%A8%E4%BA%8B%E5%8A%A1%E4%B8%AD%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%9B%9E%E6%BB%9A%E7%82%B9" rel="nofollow">4. 在事务中创建一个回滚点</a></p> 
<p id="5.%C2%A0%E6%8A%8A%E4%BA%8B%E5%8A%A1%E5%9B%9E%E6%BB%9A%E5%88%B0%E6%A0%87%E8%AE%B0%E7%82%B9-toc" style="margin-left:40px;"><a href="#5.%C2%A0%E6%8A%8A%E4%BA%8B%E5%8A%A1%E5%9B%9E%E6%BB%9A%E5%88%B0%E6%A0%87%E8%AE%B0%E7%82%B9" rel="nofollow">5. 把事务回滚到标记点</a></p> 
<p id="%E4%BA%94%E3%80%81%E4%BF%AE%E6%94%B9%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4%E5%8F%82%E6%95%B0-toc" style="margin-left:0px;"><a href="#%E4%BA%94%E3%80%81%E4%BF%AE%E6%94%B9%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4%E5%8F%82%E6%95%B0" rel="nofollow">五、修改自动提交参数</a></p> 
<p id="1.%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E4%B8%B4%E6%97%B6%E4%BF%AE%E6%94%B9-toc" style="margin-left:40px;"><a href="#1.%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E4%B8%B4%E6%97%B6%E4%BF%AE%E6%94%B9" rel="nofollow">1.数据库中临时修改</a></p> 
<p id="2.%E6%B0%B8%E4%B9%85%E4%BF%AE%E6%94%B9-toc" style="margin-left:40px;"><a href="#2.%E6%B0%B8%E4%B9%85%E4%BF%AE%E6%94%B9" rel="nofollow">2.永久修改</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%A6%82%E5%BF%B5">一、事务的概念</h2> 
<p>        是一种机制、一个操作序列，包含了一组数据库操作命令，并且把所有的命令作为一个整体一起向系统提交或撤销操作请求，即<strong>这一组数据库命令要么都执行，要么都不执行</strong>。</p> 
<p>        是一个不可分割的工作逻辑单元，在数据库系统上执行并发操作时，<strong>事务是最小的控制单元</strong>。</p> 
<p>        适用于多用户同时操作的数据库系统的场景，如银行、保险公司及证券交易系统等等。</p> 
<p>        通过事务的整体性以保证数据的一致性。</p> 
<h2 id="%E4%BA%8C%E3%80%81%E4%BA%8B%E5%8A%A1%E7%9A%84ACID%E7%89%B9%E7%82%B9">二、事务的ACID特点</h2> 
<h3 id="1.%E5%8E%9F%E5%AD%90%E6%80%A7%EF%BC%88Atomicity%EF%BC%89"><strong>1.原子性（Atomicity）</strong></h3> 
<p><strong>指事务是一个不可再分割的工作单位，事务中的操作要么都发生，要么都不发生。</strong></p> 
<ul><li>事务是一个完整的操作，事务的各元素是<strong>不可分割的</strong>；</li><li>事务中的所有元素必须作为一个整体提交或回滚；</li><li>如果事务中的任何元素失败，则整个事务将失败。</li></ul> 
<h3 id="2.%E4%B8%80%E8%87%B4%E6%80%A7%EF%BC%88Consistency%EF%BC%89"><strong>2.一致性（Consistency）</strong></h3> 
<p><strong>指在事务开始之前和事务结束以后，数据库的完整性约束没有被破坏。</strong></p> 
<ul><li>在事务开始前，数据库中存储的<strong>数据</strong>处于<strong>一致状态</strong>；</li><li>当事务完成后，数据也必须处于一致状态<strong>。</strong></li></ul> 
<h3 id="3.%E9%9A%94%E7%A6%BB%E6%80%A7%EF%BC%88lsolation%EF%BC%89"><strong>3.隔离性（lsolation）</strong></h3> 
<p><strong>指在并发环境中，当不同的事务同时操纵相同的数据时，每个事务都有各自的完整数据空间。</strong></p> 
<ul><li>对数据进行修改的所有<strong>并发事务是彼此隔离的</strong>，表明事务必须是独立的，它不应以任何方式依赖于或影响其他事务；</li><li>修改数据的事务可在另一个使用相同数据的事务开始之前访问这些数据，或者在另一个使用相同数据的事务结束之后访问这些数据，即并发访问数据库时，一个用户的事务不被其他事务所干扰，各并发事务之间数据库是独立的。</li></ul> 
<h3 id="4.%E6%8C%81%E4%B9%85%E6%80%A7(Durability)">4.持久性（Durability)</h3> 
<p>        在事务完成以后，该事务所对数据库所作的更改便持久的保存在数据库之中，并不会被回滚。指不管系统是否发生故障，事务处理的结果都是永久的。一旦事务被提交，事务的效果会被永久地保留在数据库中。</p> 
<blockquote> 
 <p><strong>总结：在事务管理中，原子性是基础，隔离性是手段，一致性是目的，持久性是结果。</strong></p> 
</blockquote> 
<h2 id="%E4%B8%89%E3%80%81%E5%B9%B6%E5%8F%91%E8%AE%BF%E9%97%AE%E8%A1%A8%E7%9A%84%E4%B8%80%E8%87%B4%E6%80%A7%E9%97%AE%E9%A2%98%E5%92%8C%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB">三、并发访问表的一致性问题和事务的隔离级别</h2> 
<h3 id="1.%E5%B9%B6%E5%8F%91%E8%AE%BF%E9%97%AE%E8%A1%A8%E7%9A%84%E4%B8%80%E8%87%B4%E6%80%A7%E9%97%AE%E9%A2%98">1.并发访问表的一致性问题</h3> 
<h4 id="%EF%BC%881%EF%BC%89%E8%84%8F%E8%AF%BB">（1）脏读</h4> 
<p>        当一个事务正在访问数据，并且对数据进行了修改，而这种修改还没有提交到数据库中，这时，另外一个事务也访问这个数据，然后使用了这个数据。<span style="color:#fe2c24;"><strong>（即一个事务能看到另一个事务未提交的数据）</strong></span></p> 
<h4 id="%EF%BC%882%EF%BC%89%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB">（2）不可重复读</h4> 
<p>        指在一个事务内，多次读同一数据。在这个事务还没有结束时，另外一个事务也访问该同一数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改，那么第一个事务两次读到的的数据可能是不一样的。这样就发生了在一个事务内两次读到的数据是不一样的，因此称为是不可重复读。<span style="color:#fe2c24;"><strong>（即由于一个事务中途修改使另一个事务多次读取不能读到相同的数据内容)</strong></span></p> 
<h4 id="%EF%BC%883%EF%BC%89%E5%B9%BB%E8%AF%BB">（3）幻读</h4> 
<p>        一个事务对一个表中的数据进行了修改，这种修改涉及到表中的全部数据行。同时，另一个事务也修改这个表中的数据，这种修改是向表中插入一行新数据。那么，操作前一个事务的用户会发现表中还有没有修改的数据行，就好像发生了幻觉一样。<span style="color:#fe2c24;"><strong>（即一个事务明明修改了多行数据记录，但由于另一个数据的影响，却导致发现有数据记录未被修改）</strong></span></p> 
<h4 id="%EF%BC%884%EF%BC%89%E4%B8%A2%E5%A4%B1%E6%9B%B4%E6%96%B0"><strong>（4）丢失更新</strong></h4> 
<p>        <span style="color:#fe2c24;">两个事务同时读取同一条记录，A先修改记录，B也修改记录（B不知道A修改过)，B提交数据后B的修改结果覆盖了A的修改结果。</span></p> 
<h3 id="2.%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span style="color:#0d0016;">2.事务的隔离级别</span></h3> 
<p>        事务的隔离级别决定了事务之间可见的级别。MysQL事务支持如下四种隔离，用以控制事务所做的修改，并将修改通告至其它并发的事务。</p> 
<h4 id="%EF%BC%881%EF%BC%89%E6%9C%AA%E6%8F%90%E4%BA%A4%E8%AF%BB%EF%BC%88Read%20Uncommitted%20(RU)%EF%BC%89"><strong>（1）未提交读（Read Uncommitted (RU)）</strong></h4> 
<p>        允许脏读，即允许一个事务可以看到其他事务未提交的修改。</p> 
<h4 id="%EF%BC%882%EF%BC%89%E6%8F%90%E4%BA%A4%E8%AF%BB%EF%BC%88Read%20Committed%20(RC)%EF%BC%89">（2）提交读（Read Committed (RC)）</h4> 
<p>        允许一个事务只能看到其他事务已经提交的修改，未提交的修改是不可见的。<span style="color:#fe2c24;"><strong>（防止脏读）</strong></span></p> 
<h4 id="%EF%BC%883%EF%BC%89%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%EF%BC%88Repeatable%20Read%20(RR))"><strong>（3）可重复读（Repeatable Read (RR))</strong></h4> 
<p><strong>        </strong>确保如果在一个事务中执行两次相同的SELECT语句，都能得到相同的结果，不管其他事务是否提交这些修改。<span style="color:#fe2c24;"><strong>（可以防止脏读和不可重复读）</strong></span></p> 
<h4 id="%EF%BC%884%EF%BC%89%E4%B8%B2%E8%A1%8C%E8%AF%BB%EF%BC%88serializable%EF%BC%89"><strong>（4）串行读（serializable）</strong></h4> 
<p><strong>        相当于锁表</strong></p> 
<p>        完全串行化的读，将一个事务与其他事务完全地隔离。每次读都需要获得表级共享锁，读写相互都会阻塞。<span style="color:#fe2c24;"><strong>（可以防止脏读，不可重复读取和幻读；但事务串行化会降低数据库的效率）</strong></span></p> 
<h3 id="3.%E6%95%B0%E6%8D%AE%E5%BA%93%E9%BB%98%E8%AE%A4%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><strong>3.数据库默认隔离级别</strong></h3> 
<p><strong>       <span style="color:#fe2c24;"> Mysql</span></strong><span style="color:#fe2c24;"> </span>默认的隔离级别是 <strong><span style="color:#fe2c24;">Repeatable Read (RR)</span>。</strong></p> 
<p><strong>        <span style="color:#fe2c24;">Oracle 和 SQL Server</span> </strong>的默认隔离级别是<span style="color:#fe2c24;"> <strong>Read Committed (RC)</strong></span><strong>。</strong></p> 
<h3 id="4.%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E7%9A%84%E8%8C%83%E5%9B%B4%E5%92%8C%E6%9F%A5%E7%9C%8B%E6%96%B9%E5%BC%8F"><strong>4.事务隔离级别的范围和查看方式</strong></h3> 
<h4 id="%EF%BC%881%EF%BC%89%E8%8C%83%E5%9B%B4%E5%88%86%E7%B1%BB"><strong>（1）范围分类</strong></h4> 
<ul><li>全局级:对所有的会话有效</li><li>会话级:只对当前的会话有效</li></ul> 
<h4 id="%EF%BC%882%EF%BC%89%E6%9F%A5%E7%9C%8B%E5%85%A8%E5%B1%80%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB">（2）查看全局事务隔离级别</h4> 
<blockquote> 
 <p>SHOW GLOBAL VARIABLES LIKE '%isolation%';    或    SELECT @@global.tx_isolation;</p> 
</blockquote> 
<p><img alt="" height="217" src="https://images2.imgbox.com/13/86/rl7DHn7F_o.png" width="782"></p> 
<p><img alt="" height="189" src="https://images2.imgbox.com/29/57/qqPVFS20_o.png" width="677"></p> 
<h4 id="%EF%BC%883%EF%BC%89%E6%9F%A5%E7%9C%8B%E4%BC%9A%E8%AF%9D%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB">（3）查看会话事务隔离级别</h4> 
<blockquote> 
 <p>SHOW SESSION VARIABLES LIKE '%isolation%';   或   SELECT @@session.tx_isolation;</p> 
</blockquote> 
<p><img alt="" height="211" src="https://images2.imgbox.com/de/37/Tup3sLY5_o.png" width="771"></p> 
<p><img alt="" height="190" src="https://images2.imgbox.com/68/00/lsx8ZjHC_o.png" width="791"></p> 
<h4 id="%EF%BC%884%EF%BC%89%E4%BF%AE%E6%94%B9%E5%85%A8%E5%B1%80%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><strong>（4）修改全局事务隔离级别</strong></h4> 
<blockquote> 
 <p> SET GLOBAL TRANSACTION ISOLATION LEVEL 隔离级别名;</p> 
</blockquote> 
<p><img alt="" height="263" src="https://images2.imgbox.com/a2/07/vUK0yYqt_o.png" width="890"></p> 
<p><strong>（4）修改会话事务隔离级别</strong></p> 
<blockquote> 
 <p> SET SESSION TRANSACTION ISOLATION LEVEL 隔离级别名;</p> 
</blockquote> 
<p><img alt="" height="263" src="https://images2.imgbox.com/a7/70/eEUJfVqX_o.png" width="890"></p> 
<blockquote> 
 <p><span style="color:#fe2c24;"><strong>注意：设置会话隔离级别只在当前会话有效，退出会话重新连接，会话隔离等级依然会恢复为和全局隔离级别相同。</strong></span></p> 
</blockquote> 
<p><img alt="" height="831" src="https://images2.imgbox.com/68/1a/Y2NPOGwp_o.png" width="1080"></p> 
<h2 id="%E5%9B%9B%E3%80%81%E4%BA%8B%E5%8A%A1%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5">四、事务控制语句</h2> 
<h3 id="1.%E6%98%BE%E5%BC%8F%E5%9C%B0%E5%BC%80%E5%90%AF%E4%B8%80%E4%B8%AA%E4%BA%8B%E5%8A%A1">1.显式地开启一个事务</h3> 
<blockquote> 
 <p>BEGIN;        或        START TRANSACTION;</p> 
</blockquote> 
<h3 id="2.%C2%A0%E6%8F%90%E4%BA%A4%E4%BA%8B%E5%8A%A1%EF%BC%8C%E5%B9%B6%E4%BD%BF%E5%B7%B2%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9B%E8%A1%8C%E7%9A%84%E6%89%80%E6%9C%89%E4%BF%AE%E6%94%B9%E5%8F%98%E4%B8%BA%E6%B0%B8%E4%B9%85%E6%80%A7%E7%9A%84">2. 提交事务，并使已对数据库进行的所有修改变为永久性的</h3> 
<blockquote> 
 <p>COMMIT;        或        COMMIT WORK;</p> 
</blockquote> 
<h3 id="3.%E5%9B%9E%E6%BB%9A%E4%BC%9A%E7%BB%93%E6%9D%9F%E7%94%A8%E6%88%B7%E7%9A%84%E4%BA%8B%E5%8A%A1%EF%BC%8C%E5%B9%B6%E6%92%A4%E9%94%80%E6%AD%A3%E5%9C%A8%E8%BF%9B%E8%A1%8C%E7%9A%84%E6%89%80%E6%9C%89%E6%9C%AA%E6%8F%90%E4%BA%A4%E7%9A%84%E4%BF%AE%E6%94%B9%C2%A0">3.回滚会结束用户的事务，并撤销正在进行的所有未提交的修改 </h3> 
<blockquote> 
 <p>ROLLBACK;        或        ROLLBACK WORK;</p> 
</blockquote> 
<h3 id="4.%C2%A0%E5%9C%A8%E4%BA%8B%E5%8A%A1%E4%B8%AD%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%9B%9E%E6%BB%9A%E7%82%B9">4. 在事务中创建一个回滚点</h3> 
<blockquote> 
 <p>SAVEPOINT 回滚点名称</p> 
</blockquote> 
<h3 id="5.%C2%A0%E6%8A%8A%E4%BA%8B%E5%8A%A1%E5%9B%9E%E6%BB%9A%E5%88%B0%E6%A0%87%E8%AE%B0%E7%82%B9">5. 把事务回滚到标记点</h3> 
<blockquote> 
 <p>ROLLBACK TO 回滚点名称</p> 
 <p><strong><span style="color:#fe2c24;">注意：不同于ROLLBACK，回滚到指定回滚点后，并没有提交，需要额外执行 COMMIT 才能提交到数据库中。</span></strong></p> 
</blockquote> 
<h2 id="%E4%BA%94%E3%80%81%E4%BF%AE%E6%94%B9%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4%E5%8F%82%E6%95%B0">五、修改自动提交参数</h2> 
<h3 id="1.%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E4%B8%B4%E6%97%B6%E4%BF%AE%E6%94%B9">1.数据库中临时修改</h3> 
<blockquote> 
 <p>SET autocommit=1;        代表开启</p> 
 <p>SET autocommit=0;        代表关闭</p> 
</blockquote> 
<p><img alt="" height="181" src="https://images2.imgbox.com/fa/ec/tiKrefhr_o.png" width="690"></p> 
<p><img alt="" height="266" src="https://images2.imgbox.com/04/00/j6DkpxGU_o.png" width="621"></p> 
<h3 id="2.%E6%B0%B8%E4%B9%85%E4%BF%AE%E6%94%B9">2.永久修改</h3> 
<blockquote> 
 <p>修改/etc/my.cnf 在[mysqld] 下添加</p> 
</blockquote> 
<pre><code class="language-bash">[mysqld]
autocommit=1    开启
#autocommit=0    关闭
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/35b46559ded64515db9fe41615705646/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">面试汇总（持续更新）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/47e75865dc6b61a7cb70843e082f2a6b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">2.9CSS table属性</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>