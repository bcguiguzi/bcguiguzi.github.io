<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CentOS 7 升级 Linux 内核 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CentOS 7 升级 Linux 内核" />
<meta property="og:description" content="升级 CentOS 内核参考资料 1 升级 CentOS 内核参考资料 2 通过 /proc 虚拟文件系统读取或配置内核 Linux 内核官网 CentOS 官网
1. 关于 Linux 内核 Linux 内核分两种：官方内核（通常是内核开发人员用）和各大 Linux 发行版内核（一般用户常用）。
1.1 官方内核 在使用 Docker 时，发现其对 Linux 内核版本的最低要求是 3.10（这也刚好是 CentOS 7.2 的内核版本），但是在这个版本上有部分功能无法实现。目前 Linux 内核已经发布到 4.X（可以随时在 Linux 内核官网 查看当前版本），为了使用最新版本的内核，只好在安装 CentOS 7 后对内核进行升级。
当然，内核也不能选最新的，防止有尚未发现的 BUG。而且为了减少以后停止维护带来的麻烦，最好安装长期支持版本。各个版本的支持时间在 这个页面 查看。每个版本可能有四种类型，概述如下：
Prepatch：Prepatch 或 “RC” 内核是主要的内核预发行版本，主要针对内核开发人员和 Linux 爱好者。必须从源代码进行编译，并且通常包含必须在可以放入稳定版本之前进行测试的新功能。Prepatch 内核由 Linus Torvalds 维护和发布。Mainline：Mainline 主线树由 Linus Torvalds 维护。这个版本的内核会引入所有新功能。新的 Mainline 内核每 2-3 个月发布一次。Stable：每个主线内核被发布后，即被认为是“stable”。任何对 stable 内核的 BUG 修复都会从 Mainline 主线树中回溯并由指定的 stable 内核维护人员使用。 在下一个主线内核可用之前，通常只有几个 BUG 修复内核版本 - 除非它被指定为“longterm maintenance kernel（长期维护内核）”。stable 内核更新按需发布，通常每月 2-3 次。Longterm：通常会提供几个“longterm maintenance”内核版本，用于修复旧版内核的 BUG。这些内核只会修复重大 BUG，并且不会频繁发布版本。 Longterm release 的内核：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/281562583e8063e6bf027a9aa0c8cc01/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-02-28T16:52:37+08:00" />
<meta property="article:modified_time" content="2018-02-28T16:52:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CentOS 7 升级 Linux 内核</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><a href="https://www.howtoforge.com/tutorial/how-to-upgrade-kernel-in-centos-7-server/" rel="nofollow">升级 CentOS 内核参考资料 1</a> <br> <a href="https://www.jianshu.com/p/fdf6bb6c5b9c" rel="nofollow">升级 CentOS 内核参考资料 2</a> <br> <a href="https://www.ibm.com/developerworks/cn/linux/l-proc.html" rel="nofollow">通过 /proc 虚拟文件系统读取或配置内核</a> <br> <a href="https://www.kernel.org/" rel="nofollow">Linux 内核官网</a> <br> <a href="https://www.centos.org/" rel="nofollow">CentOS 官网</a></p> 
<h2 id="1-关于-linux-内核">1. 关于 Linux 内核</h2> 
<p>Linux 内核分两种：官方内核（通常是内核开发人员用）和各大 Linux 发行版内核（一般用户常用）。</p> 
<h3 id="11-官方内核">1.1 官方内核</h3> 
<p>在使用 Docker 时，发现其对 Linux 内核版本的最低要求是 3.10（这也刚好是 CentOS 7.2 的内核版本），但是在这个版本上有部分功能无法实现。目前 Linux 内核已经发布到 4.X（可以随时在 <a href="https://www.kernel.org/" rel="nofollow">Linux 内核官网</a> 查看当前版本），为了使用最新版本的内核，只好在安装 CentOS 7 后对内核进行升级。</p> 
<p>当然，内核也不能选最新的，防止有尚未发现的 BUG。而且为了减少以后停止维护带来的麻烦，最好安装长期支持版本。各个版本的支持时间在 <a href="https://www.kernel.org/category/releases.html" rel="nofollow">这个页面</a> 查看。每个版本可能有四种类型，概述如下：</p> 
<ul><li>Prepatch：Prepatch 或 “RC” 内核是主要的内核预发行版本，主要针对内核开发人员和 Linux 爱好者。必须从源代码进行编译，并且通常包含必须在可以放入稳定版本之前进行测试的新功能。Prepatch 内核由 Linus Torvalds 维护和发布。</li><li>Mainline：Mainline 主线树由 Linus Torvalds 维护。这个版本的内核会引入所有新功能。新的 Mainline 内核每 2-3 个月发布一次。</li><li>Stable：每个主线内核被发布后，即被认为是“stable”。任何对 stable 内核的 BUG 修复都会从 Mainline 主线树中回溯并由指定的 stable 内核维护人员使用。 在下一个主线内核可用之前，通常只有几个 BUG 修复内核版本 - 除非它被指定为“longterm maintenance kernel（长期维护内核）”。stable 内核更新按需发布，通常每月 2-3 次。</li><li>Longterm：通常会提供几个“longterm maintenance”内核版本，用于修复旧版内核的 BUG。这些内核只会修复重大 BUG，并且不会频繁发布版本。</li></ul> 
<p>Longterm release 的内核：</p> 
<table><thead><tr><th>版本</th><th>维护人</th><th>发布日期</th><th>项目生命周期</th></tr></thead><tbody><tr><td>4.14</td><td>Greg Kroah-Hartman</td><td>2017-11-12</td><td>Jan, 2020</td></tr><tr><td>4.9</td><td>Greg Kroah-Hartman</td><td>2016-12-11</td><td>Jan, 2019</td></tr><tr><td>4.4</td><td>Greg Kroah-Hartman</td><td>2016-01-10</td><td>Feb, 2022</td></tr><tr><td>4.1</td><td>Sasha Levin</td><td>2015-06-21</td><td>May, 2018</td></tr><tr><td>3.16</td><td>Ben Hutchings</td><td>2014-08-03</td><td>Apr, 2020</td></tr><tr><td>3.2</td><td>Ben Hutchings</td><td>2012-01-04</td><td>May, 2018</td></tr></tbody></table> 
<h3 id="12-各大-linux-发行版内核">1.2 各大 Linux 发行版内核</h3> 
<p>一般来说，只有从 <code>kernel.org</code> 下载并编译安装的内核才是官方内核。 <br> 大多数 Linux 发行版提供自行维护的内核，可以通过 yum 或 rpm 等包管理系统升级。这些内核可能不再和 Linux 内核官方开发维护人员有关系了。<strong>通过这个由各大 Linux 发行版支持的仓库升级内核，通常来说更简单可靠，但是可选择的内核版本也更少。</strong></p> 
<p>使用 <code>uname -r</code> 区分你用的是官方内核还是 Linux 发行版内核，横线后面有任何东西都表示这不是官方内核：</p> 
<pre class="prettyprint"><code class=" hljs avrasm"><span class="hljs-preprocessor"># uname -r</span>
<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">514.26</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.el</span>7<span class="hljs-preprocessor">.x</span>86_64</code></pre> 
<h2 id="2-查看当前的内核版本">2. 查看当前的内核版本</h2> 
<h3 id="21-概述">2.1 概述</h3> 
<p>Linux 只表示内核。各大 Linux 发行版（RedHat、Ubuntu、CentOS 等）在内核基础上集成了其他的一系列软件，按照各自的版本规则发布。例如 CentOS 7.2 中，通过 <code>uname -r</code> 查看内核版本时，会看到 <code>3.10.0-514.26.2.el7.x86_64</code>，表示对应的 Linux 内核版本是 3.10。</p> 
<h3 id="22-常用的查看内核信息的命令">2.2 常用的查看内核信息的命令</h3> 
<h4 id="221-uname">2.2.1 uname</h4> 
<p>打印指定的系统信息。不带参数时，默认使用 <code>-s</code> 参数。 <br> 参数： <br> -a, –all：按照下面的顺序打印所有信息，如果 -p 和 -i 未知时排除掉。 <br> -s, –kernel-name：打印内核名字，一般就是 Linux。 <br> -n, –nodename：打印网络节点的主机名。 <br> -r, –kernel-release：打印内核发行版的版本。常用。<code>3.10.0-514.26.2.el7.x86_64</code> <br> -v, –kernel-version：打印内核的版本。<code>#1 SMP Tue Jul 4 15:04:05 UTC 2017</code> <br> -m, –machine：打印机器硬件名。 <br> -p, –processor：打印处理器名字或“unknown”。 <br> -i, –hardware-platform：打印硬件平台或“unknown”。 <br> -o, –operating-system：打印操作系统。 <br> –help：显示这个帮助并退出。 <br> –version：显示这版本信息并退出。</p> 
<p>示例：</p> 
<pre class="prettyprint"><code class=" hljs avrasm"><span class="hljs-preprocessor"># uname -r</span>
<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">514.26</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.el</span>7<span class="hljs-preprocessor">.x</span>86_64
<span class="hljs-preprocessor"># uname -a</span>
Linux VM_139_74_centos <span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">514.26</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.el</span>7<span class="hljs-preprocessor">.x</span>86_64 <span class="hljs-preprocessor">#1 SMP Tue Jul 4 15:04:05 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span>
<span class="hljs-preprocessor"># cat /etc/redhat-release </span>
CentOS Linux release <span class="hljs-number">7.2</span><span class="hljs-number">.1511</span> (Core) </code></pre> 
<h4 id="222-proc-虚拟文件系统">2.2.2 /proc 虚拟文件系统</h4> 
<p>内核空间和用户空间通过 /proc 虚拟文件系统可以通信。 <br> <code>/proc</code> 目录中包含一些目录和虚拟文件，这些虚拟文件可以向用户呈现内核信息或者从用户空间向内核发送信息。 <br> 常用文件：</p> 
<ul><li>cpuinfo：标识了处理器的类型和速度</li><li>pci：显示在 PCI 总线上找到的设备</li><li>modules：当前加载到内核中的模块</li><li>version：系统版本及内核版本</li></ul> 
<p>示例：</p> 
<pre class="prettyprint"><code class=" hljs avrasm"><span class="hljs-preprocessor"># cat /proc/version </span>
Linux version <span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">514.26</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.el</span>7<span class="hljs-preprocessor">.x</span>86_64 (builder@kbuilder<span class="hljs-preprocessor">.dev</span><span class="hljs-preprocessor">.centos</span><span class="hljs-preprocessor">.org</span>) (gcc version <span class="hljs-number">4.8</span><span class="hljs-number">.5</span> <span class="hljs-number">20150623</span> (Red Hat <span class="hljs-number">4.8</span><span class="hljs-number">.5</span>-<span class="hljs-number">11</span>) (GCC) ) <span class="hljs-preprocessor">#1 SMP Tue Jul 4 15:04:05 UTC 2017</span></code></pre> 
<h2 id="3-备份数据">3. 备份数据</h2> 
<h2 id="4-升级内核">4. 升级内核</h2> 
<p>记得首先更新仓库：</p> 
<pre class="prettyprint"><code class=" hljs sql">yum -y <span class="hljs-operator"><span class="hljs-keyword">update</span></span></code></pre> 
<p><code>-y</code> 选项可以在每次需要确认时，自动使用 yes，节省时间。</p> 
<h3 id="41-启用-elrepo-仓库">4.1 启用 ELRepo 仓库</h3> 
<p>ELRepo 仓库是基于社区的用于企业级 Linux 仓库，提供对 RedHat Enterprise (RHEL) 和 其他基于 RHEL的 Linux 发行版（CentOS、Scientific、Fedora 等）的支持。 <br> ELRepo 聚焦于和硬件相关的软件包，包括文件系统驱动、显卡驱动、网络驱动、声卡驱动和摄像头驱动等。</p> 
<p>启用 ELRepo 仓库：</p> 
<pre class="prettyprint"><code class=" hljs ruleslanguage"><span class="hljs-array"># rpm </span>--import https:<span class="hljs-comment">//www.elrepo.org/RPM-GPG-KEY-elrepo.org</span>
<span class="hljs-array"># rpm </span>-Uvh http:<span class="hljs-comment">//www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm</span></code></pre> 
<h3 id="42-查看可用的系统内核包">4.2 查看可用的系统内核包:</h3> 
<p>可以看到，只有 4.4 和 4.15 两个版本可以使用：</p> 
<pre class="prettyprint"><code class=" hljs avrasm"><span class="hljs-preprocessor"># yum --disablerepo="*" --enablerepo="elrepo-kernel" list available</span>
Loaded plugins: fastestmirror, langpacks
elrepo-kernel                                                   | <span class="hljs-number">2.9</span> kB  <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>     
elrepo-kernel/primary_db                                        | <span class="hljs-number">1.7</span> MB  <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">02</span>     
Determining fastest mirrors
* elrepo-kernel: elrepo<span class="hljs-preprocessor">.org</span>
Available Packages
kernel-lt<span class="hljs-preprocessor">.x</span>86_64                           <span class="hljs-number">4.4</span><span class="hljs-number">.118</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>            elrepo-kernel
kernel-lt-devel<span class="hljs-preprocessor">.x</span>86_64                     <span class="hljs-number">4.4</span><span class="hljs-number">.118</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>            elrepo-kernel
kernel-lt-doc<span class="hljs-preprocessor">.noarch</span>                       <span class="hljs-number">4.4</span><span class="hljs-number">.118</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>            elrepo-kernel
kernel-lt-headers<span class="hljs-preprocessor">.x</span>86_64                   <span class="hljs-number">4.4</span><span class="hljs-number">.118</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>            elrepo-kernel
kernel-lt-tools<span class="hljs-preprocessor">.x</span>86_64                     <span class="hljs-number">4.4</span><span class="hljs-number">.118</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>            elrepo-kernel
kernel-lt-tools-libs<span class="hljs-preprocessor">.x</span>86_64                <span class="hljs-number">4.4</span><span class="hljs-number">.118</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>            elrepo-kernel
kernel-lt-tools-libs-devel<span class="hljs-preprocessor">.x</span>86_64          <span class="hljs-number">4.4</span><span class="hljs-number">.118</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>            elrepo-kernel
kernel-ml<span class="hljs-preprocessor">.x</span>86_64                           <span class="hljs-number">4.15</span><span class="hljs-number">.6</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>             elrepo-kernel
kernel-ml-devel<span class="hljs-preprocessor">.x</span>86_64                     <span class="hljs-number">4.15</span><span class="hljs-number">.6</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>             elrepo-kernel
kernel-ml-doc<span class="hljs-preprocessor">.noarch</span>                       <span class="hljs-number">4.15</span><span class="hljs-number">.6</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>             elrepo-kernel
kernel-ml-headers<span class="hljs-preprocessor">.x</span>86_64                   <span class="hljs-number">4.15</span><span class="hljs-number">.6</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>             elrepo-kernel
kernel-ml-tools<span class="hljs-preprocessor">.x</span>86_64                     <span class="hljs-number">4.15</span><span class="hljs-number">.6</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>             elrepo-kernel
kernel-ml-tools-libs<span class="hljs-preprocessor">.x</span>86_64                <span class="hljs-number">4.15</span><span class="hljs-number">.6</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>             elrepo-kernel
kernel-ml-tools-libs-devel<span class="hljs-preprocessor">.x</span>86_64          <span class="hljs-number">4.15</span><span class="hljs-number">.6</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>             elrepo-kernel
perf<span class="hljs-preprocessor">.x</span>86_64                                <span class="hljs-number">4.15</span><span class="hljs-number">.6</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span>             elrepo-kernel
python-perf<span class="hljs-preprocessor">.x</span>86_64                   </code></pre> 
<h3 id="43-安装最新内核">4.3 安装最新内核:</h3> 
<pre class="prettyprint"><code class=" hljs vala"><span class="hljs-preprocessor"># yum --enablerepo=elrepo-kernel install kernel-ml</span></code></pre> 
<p><code>--enablerepo</code> 选项开启 CentOS 系统上的指定仓库。默认开启的是 <code>elrepo</code>，这里用 <code>elrepo-kernel</code> 替换。</p> 
<h2 id="5-设置-grub2">5. 设置 grub2</h2> 
<p>内核安装好后，需要设置为默认启动选项并重启后才会生效</p> 
<h3 id="51-查看系统上的所有可以内核">5.1 查看系统上的所有可以内核：</h3> 
<pre class="prettyprint"><code class=" hljs avrasm"><span class="hljs-preprocessor"># sudo awk -F\' '$1=="menuentry " {print i++ " : " $2}' /etc/grub2.cfg</span>
<span class="hljs-number">0</span> : CentOS Linux (<span class="hljs-number">4.15</span><span class="hljs-number">.6</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span><span class="hljs-preprocessor">.x</span>86_64) <span class="hljs-number">7</span> (Core)
<span class="hljs-number">1</span> : CentOS Linux (<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">514.26</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.el</span>7<span class="hljs-preprocessor">.x</span>86_64) <span class="hljs-number">7</span> (Core)
<span class="hljs-number">2</span> : CentOS Linux (<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">327.</span>el7<span class="hljs-preprocessor">.x</span>86_64) <span class="hljs-number">7</span> (Core)
<span class="hljs-number">3</span> : CentOS Linux (<span class="hljs-number">0</span>-rescue-f9d400c5e1e8c3a8209e990d887d4ac1) <span class="hljs-number">7</span> (Core)</code></pre> 
<h3 id="52-设置-grub2">5.2 设置 grub2</h3> 
<p>我的机器上存在 4 个内核（腾讯云的机器，不知道后面两个干嘛的），我们要使用 4.15 这个版本，可以通过 <code>grub2-set-default 0</code> 命令或编辑 <code>/etc/default/grub</code> 文件来设置。</p> 
<h4 id="1-通过-grub2-set-default-0-命令设置">1. 通过 <code>grub2-set-default 0</code> 命令设置：</h4> 
<p>其中 0 来自上一步的 awk 命令：</p> 
<pre class="prettyprint"><code class=" hljs cs">sudo grub2-<span class="hljs-keyword">set</span>-<span class="hljs-keyword">default</span> <span class="hljs-number">0</span></code></pre> 
<h4 id="2-编辑-etcdefaultgrub-文件">2. 编辑 <code>/etc/default/grub</code> 文件</h4> 
<p>设置 GRUB_DEFAULT=0，表示使用上一步的 awk 命令显示的编号为 0 的内核作为默认内核：</p> 
<pre class="prettyprint"><code class=" hljs markdown"><span class="hljs-header"># vi /etc/default/grub</span>

<span class="hljs-blockquote">&gt; GRUB_TIMEOUT=5</span>
<span class="hljs-blockquote">&gt; GRUB_DISTRIBUTOR="$(sed 's, release .*$,,g' /etc/system-release)"</span>
<span class="hljs-blockquote">&gt; GRUB_DEFAULT=0</span>
<span class="hljs-blockquote">&gt; GRUB_DISABLE_SUBMENU=true</span>
<span class="hljs-blockquote">&gt; GRUB_TERMINAL_OUTPUT="console"</span>
<span class="hljs-blockquote">&gt; GRUB_CMDLINE_LINUX="crashkernel=auto console=ttyS0 console=tty0 panic=5"</span>
<span class="hljs-blockquote">&gt; GRUB_DISABLE_RECOVERY="true"</span>
<span class="hljs-blockquote">&gt; GRUB_TERMINAL="serial console"</span>
<span class="hljs-blockquote">&gt; GRUB_TERMINAL_OUTPUT="serial console"</span>
<span class="hljs-blockquote">&gt; GRUB_SERIAL_COMMAND="serial --speed=9600 --unit=0 --word=8 --parity=no --stop=1"</span></code></pre> 
<h3 id="53-生成-grub-配置文件并重启">5.3 生成 grub 配置文件并重启</h3> 
<p>下一步，通过 <code>gurb2-mkconfig</code> 命令创建 grub2 的配置文件，然后重启：</p> 
<pre class="prettyprint"><code class=" hljs bash"><span class="hljs-built_in">sudo</span> grub2-mkconfig -o /boot/grub2/grub.cfg
<span class="hljs-built_in">sudo</span> reboot</code></pre> 
<h3 id="54-验证">5.4 验证</h3> 
<p>通过 <code>uname -r</code> 查看，可以发现已经生效了。</p> 
<pre class="prettyprint"><code class=" hljs avrasm"><span class="hljs-preprocessor"># uname -r</span>
<span class="hljs-number">4.15</span><span class="hljs-number">.6</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span><span class="hljs-preprocessor">.x</span>86_64</code></pre> 
<h2 id="6-删除旧内核可选">6. 删除旧内核（可选）</h2> 
<p>内核有两种删除方式：通过 <code>yum remove</code> 命令或通过 <code>yum-utils</code> 工具。</p> 
<h3 id="61-通过-yum-remove-命令">6.1 通过 <code>yum remove</code> 命令</h3> 
<p>查看系统中全部的内核：</p> 
<pre class="prettyprint"><code class=" hljs avrasm"><span class="hljs-preprocessor"># rpm -qa | grep kernel</span>
kernel-tools-libs-<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">514.26</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.el</span>7<span class="hljs-preprocessor">.x</span>86_64
kernel-ml-<span class="hljs-number">4.15</span><span class="hljs-number">.6</span>-<span class="hljs-number">1.</span>el7<span class="hljs-preprocessor">.elrepo</span><span class="hljs-preprocessor">.x</span>86_64
kernel-<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">327.</span>el7<span class="hljs-preprocessor">.x</span>86_64
kernel-tools-<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">514.26</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.el</span>7<span class="hljs-preprocessor">.x</span>86_64
kernel-headers-<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">514.26</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.el</span>7<span class="hljs-preprocessor">.x</span>86_64
kernel-<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">514.26</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.el</span>7<span class="hljs-preprocessor">.x</span>86_64</code></pre> 
<p>删除旧内核的 RPM 包</p> 
<pre class="prettyprint"><code class=" hljs avrasm">yum remove kernel-tools-libs-<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">514.26</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.el</span>7<span class="hljs-preprocessor">.x</span>86_64 kernel-<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">327.</span>el7<span class="hljs-preprocessor">.x</span>86_64 kernel-tools-<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">514.26</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.el</span>7<span class="hljs-preprocessor">.x</span>86_64 kernel-headers-<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">514.26</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.el</span>7<span class="hljs-preprocessor">.x</span>86_64 kernel-<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>-<span class="hljs-number">514.26</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.el</span>7<span class="hljs-preprocessor">.x</span>86_64</code></pre> 
<p><img src="https://images2.imgbox.com/8e/1a/huaiGeug_o.png" alt="删除旧内核" title=""></p> 
<h3 id="62-通过-yum-utils-工具">6.2 通过 <code>yum-utils</code> 工具</h3> 
<p>如果安装的内核不多于 3 个，<code>yum-utils</code> 工具不会删除任何一个。只有在安装的内核大于 3 个时，才会自动删除旧内核。</p> 
<h4 id="621-安装">6.2.1 安装</h4> 
<pre class="prettyprint"><code class=" hljs cmake">yum <span class="hljs-keyword">install</span> yum-utils</code></pre> 
<h4 id="622-删除">6.2.2 删除</h4> 
<pre class="prettyprint"><code class=" hljs lua"><span class="hljs-built_in">package</span>-cleanup <span class="hljs-comment">--oldkernels</span></code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/af5b67b10257e24e6ecd322d94f2f5e3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android项目控件统计(XML标签统计)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/46f6703a7a8d67307de543a507047c52/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">用IntelliJ IDEA看Java类图</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>