<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>将页面的列表数据导出到excel文件中 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="将页面的列表数据导出到excel文件中" />
<meta property="og:description" content="1、用的是springＭＶＣ的模式
２、在service接口层
//根据页面传过来的id在库里查询
List&lt;TbItem&gt; selectByPrimaryKeydhh(long ids);
在service接口的实现类中
@Override
public List&lt;TbItem&gt; selectByPrimaryKeydhh(long ids) {
//执行查询的sql
List&lt;TbItem&gt; selectByPrimaryKey = tbItemMapper.selectByPrimaryKeydhh(ids);
return selectByPrimaryKey;
}
3、在controller层
@Controller public class Example { //定义文件的格式 private static final ReportFileTypeEnum X = ReportFileTypeEnum.XLS; @Autowired private ItemService itemService; @RequestMapping(value=&#34;/partExportdhh&#34;,method=RequestMethod.POST) public void maiddhhn(long ids) { List&lt;Model&gt; dataCode0 = new ArrayList&lt;Model&gt;(); List&lt;TbItem&gt; list = itemService.selectByPrimaryKeydhh(ids); for (int i = 0; i &lt; list.size(); i&#43;&#43;) { Model model=new Model(); TbItem tbItem = list." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/75e97654942c49de028e4614fe9f929c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-12-12T17:21:28+08:00" />
<meta property="article:modified_time" content="2017-12-12T17:21:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">将页面的列表数据导出到excel文件中</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>1、用的是springＭＶＣ的模式</p> 
<p>２、在service接口层</p> 
<p>//根据页面传过来的id在库里查询<br> </p> 
<p>List&lt;TbItem&gt; selectByPrimaryKeydhh(long ids);</p> 
<p>     在service接口的实现类中</p> 
<p>    @Override<br>     public List&lt;TbItem&gt; selectByPrimaryKeydhh(long ids) {<!-- --></p> 
<p>//执行查询的sql<br> </p> 
<p>        List&lt;TbItem&gt; selectByPrimaryKey = tbItemMapper.selectByPrimaryKeydhh(ids);<br>         return selectByPrimaryKey;<br>     }</p> 
<p>3、在controller层</p> @Controller 
<br> public class Example { 
<br>     //定义文件的格式 
<br>     private static final ReportFileTypeEnum X = ReportFileTypeEnum.XLS; 
<br>     @Autowired 
<br>     private ItemService itemService; 
<br>                          
<br>     @RequestMapping(value="/partExportdhh",method=RequestMethod.POST) 
<br>     public  void maiddhhn(long ids) { 
<br>         List&lt;Model&gt; dataCode0 = new ArrayList&lt;Model&gt;(); 
<br>         List&lt;TbItem&gt; list = itemService.selectByPrimaryKeydhh(ids); 
<br>         for (int i = 0; i &lt; list.size(); i++) { 
<br>              
<br>             Model model=new Model(); 
<br>              TbItem tbItem = list.get(i); 
<br>              model.set("id",tbItem.getId()); 
<br>              model.set("title",tbItem.getTitle()); 
<br>              model.set("sell_point",tbItem.getSellPoint()); 
<br>              model.set("price",tbItem.getPrice()); 
<br>              model.set("num",tbItem.getNum()); 
<br>              model.set("barcode",tbItem.getBarcode()); 
<br>              model.set("image",tbItem.getImage()); 
<br>              model.set("cid",tbItem.getCid()); 
<br>              model.set("status",tbItem.getStatus()); 
<br>              model.set("created",tbItem.getCreated()); 
<br>              model.set("updated",tbItem.getUpdated()); 
<br>              
<br>             dataCode0.add(model); 
<br>         } 
<br> 
<br>         LinkedHashMap&lt;String, String&gt; headersCode = new LinkedHashMap&lt;String, String&gt;(); 
<br>         headersCode.put("id","商品ID"); 
<br>         headersCode.put("title","商品标题"); 
<br>         headersCode.put("sell_point","叶子类目"); 
<br>         headersCode.put("price","价格"); 
<br>         headersCode.put("num","库存数量"); 
<br>         headersCode.put("barcode","条形码"); 
<br>         headersCode.put("image","图片"); 
<br>         headersCode.put("cid","商品类目ID"); 
<br>         headersCode.put("status","状态"); 
<br>         headersCode.put("created","创建时间"); 
<br>         headersCode.put("updated","更新日期"); 
<br>   
<br> 
<br>         //code2列表的模板 
<br>         String code2temlateUrl = "D:\\export\\code2" + X.getStatusDesc(); 
<br>         //实际导出来的数据 
<br>         String copytemplate2Url = "D:\\export\\copy" + X.getStatusDesc(); 
<br>         //如果不存在这个文件夹就会创建这个文件夹 
<br>         if (!new File("D:\\export").exists()) { 
<br>             new File("D:\\export").mkdir(); 
<br>         } 
<br>         HashMap&lt;Integer, Integer&gt; width = new HashMap&lt;&gt;(); 
<br>         //设置这个excle会导出到少个列 
<br>         width.put(0, 3); 
<br>         width.put(1, 3); 
<br>         width.put(2, 3); 
<br>         width.put(3, 3); 
<br>         width.put(4, 3); 
<br>         width.put(5, 3); 
<br>         width.put(7, 3); 
<br>         width.put(8, 3); 
<br>         width.put(9, 3); 
<br>         width.put(10, 3); 
<br>         // 根据模板导出数据 
<br>         Utils.code2Tempalte(code2temlateUrl, dataCode0.size(), "商品列表", 12, X, width, 
<br>                 headersCode.values().toArray()); 
<br>         File file = new File(code2temlateUrl); 
<br>         if (!file.exists() || !file.isFile()) { 
<br>             System.out.println("文件不存在"); 
<br>             return; 
<br>         } 
<br>         Utils.copyTemplate(file, copytemplate2Url, X); 
<br> 
<br>         try { 
<br>             Workbook wb = Utils.getWorkbookInstance(X, new FileInputStream(copytemplate2Url)); 
<br>             int rowNo = 2; 
<br>             int rowSum = 0; 
<br>             Utils.file2FileWithData(wb, X, dataCode0, rowNo, 0, 12,headersCode.keySet().toArray()); 
<br>             rowSum = 2 + dataCode0.size(); 
<br>             FileOutputStream out = null; 
<br>             out = new FileOutputStream(copytemplate2Url); 
<br>             wb.write(out); 
<br>             System.out.println("导出成功"); 
<br>             out.close(); 
<br>         } catch (Exception e) { 
<br>             e.printStackTrace(); 
<br>         } 
<br> 
<p>    }</p> 
<p>4、对于controller中用到的几个工具类</p> 
<p>//判断excel文件的后缀格式<br> </p> 
<p>public enum ReportFileTypeEnum {<!-- --><br> <br>     XLSX(0, ".xlsx"),<br>     XLS(1, ".xls");<br> <br>     int status;<br>     String statusDesc;<br> <br>     private ReportFileTypeEnum(int status,String statusDesc){<!-- --><br>         this.status=status;<br>         this.statusDesc=statusDesc;<br>     }<br> <br>     public int getStatus(){<!-- --><br>         return status;<br>     }<br> <br>     public String getStatusDesc(){<!-- --><br>         return statusDesc;<br>     }<br> <br>     public static ReportFileTypeEnum getType(int status){<!-- --><br>         for (ReportFileTypeEnum excelFileTypeEnums : ReportFileTypeEnum.values()) {<!-- --><br>             if (excelFileTypeEnums.getStatus() == status) {<!-- --><br>                 return excelFileTypeEnums;<br>             }<br>         }<br>         return null;<br>     }<br> <br>     public static String getStatusDesc(int status){<!-- --><br>         return getType(status).getStatusDesc();<br>     }<br> }<br> </p> 
<p><br> </p> 
<p>//用来封装实体类<br> </p> 
<p>public class Model{<!-- --><br> <br>     private Map&lt;String, Object&gt; attrs = new HashMap&lt;String, Object&gt;();<br> <br>     public void set(String attr, Object value) {<!-- --><br>         attrs.put(attr, value);<br>     }<br> <br>     public Object get(String attr) {<!-- --><br>         return attrs.get(attr);<br>     }<br> <br>     public Set entrySet() {<!-- --><br>         return attrs.entrySet();<br>     }<br> </p> 
<p>4、需要引入poi的jar包的</p> 
<p>          &lt;dependency&gt;<br>             &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;<br>             &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;<br>             &lt;version&gt;3.8&lt;/version&gt;<br>         &lt;/dependency&gt;<br> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6f4d7818e524e4326593b83f62b8fe19/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在OpenCV中使用RANSAC</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/32f8361969e9270e5e2fda21e58f73a3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Golang实现文件服务器】（二）图片去重与缩略图功能</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>