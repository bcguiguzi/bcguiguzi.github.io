<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>微信小程序动态计算文本高度 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="微信小程序动态计算文本高度" />
<meta property="og:description" content="废话不多说 直接上代码 一.wxml结构页面，里边的文字替换成自己需要的即可 &lt;view class=&#34;speak_top_blue_text {{showAll?&#39;negotiation_info_text_showAll&#39;:&#39;negotiation_info_text_showPartton&#39;}} {{bigFont?&#39;bigFont10&#39;:&#39;&#39;}}&#34;&gt; &lt;view class=&#34;needToQueryHeight&#34;&gt; 留言前请先阅读以下条款： &lt;text&gt; 一、不得发表违反中华人民共和国宪法和法律、违反改革开放和四项基本原则的言论； 二、不得发表造谣、诽谤他人的言论； 三、不得发表未经证实的消息，亲身经历请注明； 四、请勿发表任何形式的广告，企业推广产品或服务； &lt;/text&gt; &lt;/view&gt; &lt;block wx:if=&#34;{{showAll}}&#34;&gt; &lt;view class=&#34;negotiation_info_downarrow&#34; bindtap=&#34;showAll&#34;&gt; &lt;image src=&#34;../../icons/uparrow.png&#34; class=&#34;downarrow {{bigFont?&#39;bigImg4&#39;:&#39;&#39;}}&#34;&gt;&lt;/image&gt; &lt;/view&gt; &lt;/block&gt; &lt;block wx:else&gt; &lt;!-- 文字超过5行显示此部分内容 --&gt; &lt;view class=&#34;negotiation_info_downarrow&#34; bindtap=&#34;showAll&#34; wx:if=&#34;{{hasAll}}&#34;&gt; &lt;image src=&#34;../../icons/downarrow.png&#34; class=&#34;downarrow {{bigFont?&#39;bigImg4&#39;:&#39;&#39;}}&#34;&gt;&lt;/image&gt; &lt;/view&gt; &lt;/block&gt; &lt;/view&gt; 二.css页面 .negotiation_info_text_showAll { height: 100%; } .negotiation_info_text_showPartton { overflow: hidden; /* 显示5行 */ /* height: calc(60rpx * 5); */ overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; } ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/a5a94487206d4d55de559f60a4cebd6b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-15T10:54:44+08:00" />
<meta property="article:modified_time" content="2023-08-15T10:54:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">微信小程序动态计算文本高度</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre><code class="language-html">废话不多说 直接上代码

一.wxml结构页面，里边的文字替换成自己需要的即可
&lt;view class="speak_top_blue_text {<!-- -->{showAll?'negotiation_info_text_showAll':'negotiation_info_text_showPartton'}} {<!-- -->{bigFont?'bigFont10':''}}"&gt;
    &lt;view class="needToQueryHeight"&gt;
        留言前请先阅读以下条款：
        &lt;text&gt;
          一、不得发表违反中华人民共和国宪法和法律、违反改革开放和四项基本原则的言论；
          二、不得发表造谣、诽谤他人的言论；
          三、不得发表未经证实的消息，亲身经历请注明；
          四、请勿发表任何形式的广告，企业推广产品或服务；
        &lt;/text&gt;
      &lt;/view&gt;
      &lt;block wx:if="{<!-- -->{showAll}}"&gt;
        &lt;view class="negotiation_info_downarrow" bindtap="showAll"&gt;
          &lt;image src="../../icons/uparrow.png" class="downarrow {<!-- -->{bigFont?'bigImg4':''}}"&gt;&lt;/image&gt;
        &lt;/view&gt;
      &lt;/block&gt;
      &lt;block wx:else&gt;
        &lt;!-- 文字超过5行显示此部分内容 --&gt;
        &lt;view class="negotiation_info_downarrow" bindtap="showAll" wx:if="{<!-- -->{hasAll}}"&gt;
          &lt;image src="../../icons/downarrow.png" class="downarrow {<!-- -->{bigFont?'bigImg4':''}}"&gt;&lt;/image&gt;
       &lt;/view&gt;
   &lt;/block&gt;
&lt;/view&gt;


二.css页面
.negotiation_info_text_showAll {
  height: 100%;
}

.negotiation_info_text_showPartton {
  overflow: hidden;
  /* 显示5行 */
  /* height: calc(60rpx * 5); */
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
}


.negotiation_info_downarrow {
  display: flex;
  margin-left: 40%;
  position: absolute;
  width: 80rpx;
  height: 50rpx;
}

.downarrow {
  width: 32.64rpx;
  height: 15.58rpx;
}


三.js文件
/**
   * 生命周期函数--监听页面加载
   */
  onLoad: function (options) {
    this.queryHeight()
  },


/**
   * 展示/隐藏 所有文字
   */
  showAll() {
    this.setData({
      showAll: !this.data.showAll
    })
  },

  // 动态获取高度
  queryHeight() {
    let query = wx.createSelectorQuery();
    // 获取富文本高度。bug：iOS无法获取
    query.select('.needToQueryHeight').boundingClientRect(rect =&gt; {
      // 元素高度 &gt;=30px * 5行 ，则显示
      let height = rect.height &gt;= 50 ? true : false
      console.log('超过5行', height, rect.height)
      this.setData({
        hasAll: height
      })
    }).exec();
  },</code></pre> 
<p style="text-align:center;"></p> 
<p style="text-align:center;"></p> 
<p style="text-align:center;"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d013758bb34aead2c2580b6d8c2fac4f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">GPON概述</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/02534ce81da15c5ffb728223eaf236ca/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">VScode的setting配置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>