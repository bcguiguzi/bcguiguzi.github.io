<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>z3 C&#43;&#43;学习笔记 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="z3 C&#43;&#43;学习笔记" />
<meta property="og:description" content="因为项目需要使用z3库来解决问题，所以自己学习了一下，结果发现网上教程比较少，而且大部分都是使用Python，而我本人是C&#43;&#43;的忠实信徒，在知道C&#43;&#43;也可以使用z3库以后我毫不犹豫地着手用C&#43;&#43;使用z3，但是我很快发现，网上基本没有关于C&#43;&#43;使用z3的教程（中文社区一点都没有），因此我记录一下我自己的学习过程希望能够帮助到其他学习的人。
教程链接 网上现有的有三个教程：
官方example.cpp文档：https://github.com/Z3Prover/z3/blob/master/examples/c%2B%2B/example.cpp
入门笔记：
http://www.cs.utah.edu/~vinu/research/formal/tools/notes/z3-notes.html
API接口：
https://z3prover.github.io/api/html/group__cppapi.html
其中主要教程是官方的example.cpp
第二个入门教程也非常不错，里面包含了环境的搭建，例子的说明（其实就是example.cpp的说明）
第三个API没有什么用觉得
不过上面的教程都没有说如何在一个普通文件中使用z3库，我在StackOverflow上找到一个回答解决了这个问题：https://stackoverflow.com/questions/17514923/need-help-in-using-z3-api-in-a-c-program。简单来讲在install之后要在文件中包含z3&#43;&#43;.h头文件，而且在编译参数上要加上-lz3
我一开始是学习使用Python使用z3的，因此也发现一些很好的教程，其中对我帮助最大的是一个用z3解决背包问题的博客，让我明白如何用z3解决极值问题：https://blog.csdn.net/weixin_41950078/article/details/111416573
性能测试 同时我测试了Python和C&#43;&#43;的性能差距，以上面学习到的01背包问题为例，在数据量为40的时候，Python的运行时间是5830.4131779670715s（我没有写错） （实测2023.10 Python版本已经挺快了），C&#43;&#43;的运行时间是57s。
希望的我的测试能够坚定大家用C&#43;&#43;使用z3库的决心（狗头
下符测试代码和运行截图：
Python 使用前安装z3的库：
pip install z3-solver 测试代码 import time from z3 import * def zero_one_knapsack(weights, values, cap): solver = Optimize() # the decision variables flags = [Int(f&#34;x_{i}&#34;) for i in range(len(weights))] for flag in flags: solver.add(Or(flag == 0, flag == 1)) weight_arr = [] i = 0 for w in weights: weight_arr." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/01ab5ca165c4999a983223bd12050b60/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-15T16:39:02+08:00" />
<meta property="article:modified_time" content="2023-10-15T16:39:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">z3 C&#43;&#43;学习笔记</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>因为项目需要使用z3库来解决问题，所以自己学习了一下，结果发现网上教程比较少，而且大部分都是使用Python，而我本人是C++的忠实信徒，在知道C++也可以使用z3库以后我毫不犹豫地着手用C++使用z3，但是我很快发现，网上基本没有关于C++使用z3的教程（中文社区一点都没有），因此我记录一下我自己的学习过程希望能够帮助到其他学习的人。</p> 
</blockquote> 
<h2><a id="_1"></a>教程链接</h2> 
<p>网上现有的有三个教程：<br> 官方<code>example.cpp</code>文档：<a href="https://github.com/Z3Prover/z3/blob/master/examples/c++/example.cpp">https://github.com/Z3Prover/z3/blob/master/examples/c%2B%2B/example.cpp</a><br> 入门笔记：<br> <a href="http://www.cs.utah.edu/~vinu/research/formal/tools/notes/z3-notes.html" rel="nofollow">http://www.cs.utah.edu/~vinu/research/formal/tools/notes/z3-notes.html</a><br> API接口：<br> <a href="https://z3prover.github.io/api/html/group__cppapi.html" rel="nofollow">https://z3prover.github.io/api/html/group__cppapi.html</a></p> 
<p>其中主要教程是官方的<code>example.cpp</code><br> 第二个入门教程也非常不错，里面包含了环境的搭建，例子的说明（其实就是<code>example.cpp</code>的说明）<br> 第三个API没有什么用觉得</p> 
<p>不过上面的教程都没有说如何在一个普通文件中使用z3库，我在StackOverflow上找到一个回答解决了这个问题：<a href="https://stackoverflow.com/questions/17514923/need-help-in-using-z3-api-in-a-c-program" rel="nofollow">https://stackoverflow.com/questions/17514923/need-help-in-using-z3-api-in-a-c-program</a>。简单来讲在<code>install</code>之后要在文件中包含<code>z3++.h</code>头文件，而且在编译参数上要加上<code>-lz3</code></p> 
<p>我一开始是学习使用Python使用z3的，因此也发现一些很好的教程，其中对我帮助最大的是一个用z3解决背包问题的博客，让我明白如何用z3解决极值问题：<a href="https://blog.csdn.net/weixin_41950078/article/details/111416573">https://blog.csdn.net/weixin_41950078/article/details/111416573</a></p> 
<h2><a id="_16"></a>性能测试</h2> 
<p>同时我测试了Python和C++的性能差距，以上面学习到的01背包问题为例，在数据量为40的时候，<s>Python的运行时间是5830.4131779670715s（我没有写错）</s> （实测2023.10 Python版本已经挺快了），C++的运行时间是57s。<br> 希望的我的测试能够坚定大家用C++使用z3库的决心（狗头<br> 下符测试代码和运行截图：</p> 
<h3><a id="Python_20"></a>Python</h3> 
<p>使用前安装z3的库：</p> 
<pre><code class="prism language-shell">pip <span class="token function">install</span> z3-solver
</code></pre> 
<h4><a id="_25"></a>测试代码</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> time

<span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">def</span> <span class="token function">zero_one_knapsack</span><span class="token punctuation">(</span>weights<span class="token punctuation">,</span> values<span class="token punctuation">,</span> cap<span class="token punctuation">)</span><span class="token punctuation">:</span>
    solver <span class="token operator">=</span> Optimize<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># the decision variables</span>
    flags <span class="token operator">=</span> <span class="token punctuation">[</span>Int<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"x_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>weights<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> flag <span class="token keyword">in</span> flags<span class="token punctuation">:</span>
        solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Or<span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    weight_arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    i <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> w <span class="token keyword">in</span> weights<span class="token punctuation">:</span>
        weight_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>w <span class="token operator">*</span> flags<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        i <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token comment"># add weight constraint</span>
    solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span>weight_arr<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> cap<span class="token punctuation">)</span>
    value_arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    i <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> v <span class="token keyword">in</span> values<span class="token punctuation">:</span>
        value_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>v <span class="token operator">*</span> flags<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        i <span class="token operator">+=</span> <span class="token number">1</span>
    solver<span class="token punctuation">.</span>maximize<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span>value_arr<span class="token punctuation">)</span><span class="token punctuation">)</span>

    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># calculate</span>
    result <span class="token operator">=</span> solver<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"use </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">}</span></span><span class="token string">s to calculate"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> result <span class="token operator">==</span> sat<span class="token punctuation">:</span>
        model <span class="token operator">=</span> solver<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"Index: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>index<span class="token punctuation">}</span></span><span class="token string">, weight: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>weights<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">, value: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>values<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
                            <span class="token keyword">for</span> index<span class="token punctuation">,</span> flag <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>flags<span class="token punctuation">)</span> <span class="token keyword">if</span> model<span class="token punctuation">[</span>flag<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"empty"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    C <span class="token operator">=</span> <span class="token number">300</span>
    W <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">68</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">71</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">68</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token punctuation">]</span>
    V <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">94</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">44</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">76</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">74</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">96</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">68</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">]</span>
    zero_one_knapsack<span class="token punctuation">(</span>W<span class="token punctuation">,</span> V<span class="token punctuation">,</span> C<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_68"></a>运行结果</h4> 
<p><img src="https://images2.imgbox.com/0a/4b/dDOGJsgj_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="C_70"></a>C++</h3> 
<h4><a id="_71"></a>运行代码</h4> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;typeinfo&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;z3++.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ctime&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> z3<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cin<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>string<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>vector<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">knapsack</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span>weights<span class="token punctuation">,</span> <span class="token keyword">const</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span>values<span class="token punctuation">,</span> <span class="token keyword">int</span> cap<span class="token punctuation">)</span> 
<span class="token punctuation">{<!-- --></span>
    context c<span class="token punctuation">;</span>
    optimize <span class="token function">opt</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span>expr<span class="token operator">&gt;</span> flags<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>weights<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> weights<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        flags<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">int_const</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token string">"x"</span> <span class="token operator">+</span> std<span class="token double-colon punctuation">::</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token operator">&amp;</span>flag <span class="token operator">:</span> flags<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        opt<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    expr tmp <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">int_const</span><span class="token punctuation">(</span><span class="token string">"tmp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tmp <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">int_val</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>weights<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> weights<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        tmp <span class="token operator">=</span> tmp <span class="token operator">+</span> weights<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> flags<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    opt<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tmp <span class="token operator">&lt;=</span> cap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    tmp <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">int_val</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>values<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> values<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        tmp <span class="token operator">=</span> tmp <span class="token operator">+</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> flags<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    opt<span class="token punctuation">.</span><span class="token function">maximize</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//cout &lt;&lt; opt &lt;&lt; endl;</span>

    clock_t begin <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">auto</span> result <span class="token operator">=</span> opt<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    clock_t end <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> sat<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        model m <span class="token operator">=</span> opt<span class="token punctuation">.</span><span class="token function">get_model</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//cout &lt;&lt; m &lt;&lt; endl;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> flags<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">auto</span> item <span class="token operator">=</span> flags<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get_numeral_int</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">":\t"</span>  <span class="token operator">&lt;&lt;</span> weights<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\t"</span> <span class="token operator">&lt;&lt;</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"no solution"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"cost time:"</span> <span class="token operator">&lt;&lt;</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>end <span class="token operator">-</span> begin<span class="token punctuation">)</span> <span class="token operator">/</span> CLOCKS_PER_SEC <span class="token operator">&lt;&lt;</span> <span class="token string">"s"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> W<span class="token punctuation">,</span>V<span class="token punctuation">;</span>
    <span class="token keyword">int</span> C<span class="token punctuation">,</span>n<span class="token punctuation">,</span>w<span class="token punctuation">,</span>v<span class="token punctuation">;</span>
    cin <span class="token operator">&gt;&gt;</span> C <span class="token operator">&gt;&gt;</span> n<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>n<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        cin <span class="token operator">&gt;&gt;</span> w <span class="token operator">&gt;&gt;</span> v<span class="token punctuation">;</span>
        W<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
        V<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">knapsack</span><span class="token punctuation">(</span>W<span class="token punctuation">,</span> V<span class="token punctuation">,</span> C<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    std<span class="token double-colon punctuation">::</span>ios<span class="token double-colon punctuation">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


</code></pre> 
<p>为了在输出结果的时候判断是否选择该物品需要从<code>model</code>中获取结果，但是我不知道如何比较结果是否为0（在程序中0表示不选），在网上找来找去都没有，最后没有办法只能自己尝试，终于在成员列表里面找到了一个好像能够把<code>expr</code>转换成<code>int</code>的函数，即上面的<code>if (m.eval(item).get_numeral_int() == 0) continue;</code>语句，卡了好久，没有教程太惨了。</p> 
<h4><a id="_155"></a>运行结果</h4> 
<p><img src="https://images2.imgbox.com/6f/38/XHSPN4oJ_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6ebe5b8ec3ea5a82244f503b98a5524f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Excel VBA&#43;Matlab解决数独问题 太牛了！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dff24126d95e39fd4719f4119d3c24c6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">qemu基础篇——VSCode 配置 GDB 调试</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>