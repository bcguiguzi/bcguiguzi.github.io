<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Sql 中的where 1=1 问题 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Sql 中的where 1=1 问题" />
<meta property="og:description" content="很多时候我们在学习Sql的时候我么总是会看到有些时候会用到一些看起来没有用的东西，比如说:select * from table where 1= 1;
但是为什么我们要用到那个where 1 = 1呢
1.首先我们先来看一下不用where 1 = 1会出现什么情况；
举个例子，如果您做查询页面，并且，可查询的选项有多个，同时，还让用户自行选择并输入查询关键词，那么，按平时的查询语句的动态构造，代码大体如下：
string MySqlStr=”select * from table where”； if(Age.Text.Lenght&gt;0) { MySqlStr=MySqlStr&#43;“Age=“&#43;“&#39;Age.Text&#39;“； }if(Address.Text.Lenght&gt;0) { MySqlStr=MySqlStr&#43;“and Address=“&#43;“&#39;Address.Text&#39;“； } 现在，也存在两种假设 ①种假设 如果两个IF都成立，那么，语句变为：
MySqlStr=”select * from table where 1=1 and Age=&#39;18&#39; and Address=&#39;云南省文山州广南县小波吗村&#39;” 可以看得出来，这是一条完整的正确的SQL查询语句，能够正确的被执行，并根据数据库是否存在记录，返回数据。
②种假设
如果上述的两个IF判断语句不成立，那么，最终的MySqlStr动态构造语句变为：
MySqlStr=”select * from table where“ 现在，我们来看一下这条语句，由于where关键词后面需要使用条件，但是这条语句根本就不存在条件，所以，该语句就是一条错误的语句，肯定不能被执行，不仅报错，同时还不会查询到任何数据。
上述的两种假设，代表了现实的应用，说明，语句的构造存在问题，不足以应付灵活多变的查询条件。
二、使用 where 1=1 的好处
假如我们将上述的语句改为： string MySqlStr=”select * from table where 1=1 ”； if(Age.Text.Lenght&gt;0) { MySqlStr=MySqlStr&#43;“and Age=“&#43;“&#39;Age." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/a40492745c1c75f1227cefa8158d19d6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-03-01T13:04:29+08:00" />
<meta property="article:modified_time" content="2014-03-01T13:04:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Sql 中的where 1=1 问题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>很多时候我们在学习Sql的时候我么总是会看到有些时候会用到一些看起来没有用的东西，比如说:select * from table where 1= 1;</p> 
<p>但是为什么我们要用到那个where 1 = 1呢</p> 
<p>1.首先我们先来看一下不用where 1 = 1会出现什么情况；</p> 
<p>举个例子，如果您做查询页面，并且，可查询的选项有多个，同时，还让用户自行选择并输入查询关键词，那么，按平时的查询语句的动态构造，代码大体如下：<br> <br> </p> 
<pre><code class="language-sql">　　string MySqlStr=”select * from table where”；

　　if(Age.Text.Lenght&gt;0)
　　{
　　　　MySqlStr=MySqlStr+“Age=“+“'Age.Text'“；
　　}

　　if(Address.Text.Lenght&gt;0)
　　{
　　　　MySqlStr=MySqlStr+“and Address=“+“'Address.Text'“；
　　}</code></pre> 
<br> 　　现在，也存在两种假设 
<br> 　　①种假设 
<br> 
<p>　　如果两个IF都成立，那么，语句变为：</p> 
<p></p> 
<pre><code class="language-sql">     MySqlStr=”select * from table where  1=1 and Age='18'  and Address='云南省文山州广南县小波吗村'”</code></pre> 
<p></p> 
<p><span style="white-space:pre"></span>可以看得出来，这是一条完整的正确的SQL查询语句，能够正确的被执行，并根据数据库是否存在记录，返回数据。<br> 　　②种假设<br> <br> 　　如果上述的两个IF判断语句不成立，那么，最终的MySqlStr动态构造语句变为：<br> </p> 
<pre><code class="language-sql">    MySqlStr=”select * from table where“</code></pre> 
<span style="white-space:pre"> 现在，我们来看一下这条语句，由于where关键词后面需要使用条件，但是这条语句根本就不存在条件，所以，该语句就是一条错误的语句，肯定不能被执行，不仅报错，同时还不会查询到任何数据。<br> 　　上述的两种假设，代表了现实的应用，说明，语句的构造存在问题，不足以应付灵活多变的查询条件。<br> <br> 　　二、使用 where  1=1  的好处<span style="white-space:pre"><br> <br> 　　假如我们将上述的语句改为：</span></span> 
<pre><code class="language-sql">    string MySqlStr=”select * from table where  1=1 ”；

　　if(Age.Text.Lenght&gt;0)
　　{
　　　　MySqlStr=MySqlStr+“and Age=“+“'Age.Text'“；
　　}

　　if(Address.Text.Lenght&gt;0)
　　{
　　　　MySqlStr=MySqlStr+“and Address=“+“'Address.Text'“；
　　}</code></pre> 
<p><span style="white-space:pre"></span>现在，也存在两种假设<br> <br> 　　①种假设<br> <br> 　　如果两个IF都成立，那么，语句变为：<br> 　　MySqlStr=”select * from table where  1=1 and Age='18'  and Address='云南省文山州广南县小波吗村'”，</p> 
<p><span style="white-space:pre"></span>很明显，该语句是一条正确的语句，能够正确执行，如果数据库有记录，肯定会被查询到。<br> <br> 　　②种假设<br> <br> 　　如果两个IF都不成立，那么，语句变为：<br> <br> 　　MySqlStr=”select * from table where 1=1”，</p> 
<p><span style="white-space:pre"></span>现在，我们来看这条语句，由于where 1=1 是为True的语句，因此，该条语句语法正确，能够被正确执行，它的作用相当于：MySqlStr=”select * from table”，即返回表中所有数据。<br> 　　言下之意就是：如果用户在多条件查询页面中，不选择任何字段、不输入任何关键词，那么，必将返回表中所有数据；如果用户在页面中，选择了部分字段并且输入了部分查询关键词，那么，就按用户设置的条件进行查询。<br> 　　说到这里，不知道您是否已明白，其实，where 1=1的应用，不是什么高级的应用，也不是所谓的智能化的构造，仅仅只是为了满足多条件查询页面中不确定的各种因素而采用的一种构造一条正确能运行的动态SQL语句的一种方法。<br> where 1=0; 这个条件始终为false，结果不会返回任何数据，只有表结构，可用于快速建表<br> "SELECT * FROM strName WHERE 1 = 0"; 该select语句主要用于读取表的结构而不考虑表中的数据，这样节省了内存，因为可以不用保存结果集。  <br> create table newtable as select * from oldtable where 1=0;  </p> 
<p>创建一个新表，而新表的结构与查询的表的结构是一样的。<br> <br> <br> <br> </p> 
<p><br> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2c7a1d4e2b00ab6c0e4a615129255ccf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MPI程序的运行命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d9b01bc1bcaa1f0ad79b4f5ff8a3cc7c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux用户空间访问物理地址</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>