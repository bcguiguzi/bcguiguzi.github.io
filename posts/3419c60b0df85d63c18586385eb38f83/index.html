<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SpringCloud | SpringCloud Finchley &#43; Spring Boot 2.0 集成Consul（1.2版本） - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SpringCloud | SpringCloud Finchley &#43; Spring Boot 2.0 集成Consul（1.2版本）" />
<meta property="og:description" content="微信公众号：吉姆餐厅ak
学习更多源码知识，欢迎关注。
概述： Spring Boot 2.0相对于之前的版本，变化还是很大的。首先对jdk的版本要求已经不能低于1.8，其次依赖的spring的版本也是最新版本5.0，并集成了功能强大的webflux等。
SpringCloud Finchley 版本的升级也带来了全新组件：Spring Cloud Function 和 Spring Cloud Gateway ,前者致力于函数式编程模块的整合，后者则是网关netflix zuul 的替换组件。
1）需要的依赖： &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt; &lt;project xmlns=&#34;http://maven.apache.org/POM/4.0.0&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xsi:schemaLocation=&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.iyb&lt;/groupId&gt; &lt;artifactId&gt;saturn&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;name&gt;sc-saturn&lt;/name&gt; &lt;description&gt;sc-saturn for Spring Boot&lt;/description&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.1.RELEASE&lt;/version&gt; &lt;/parent&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;mapper.version&gt;3.4.0&lt;/mapper.version&gt; &lt;pagehelper.version&gt;4.1.6&lt;/pagehelper.version&gt; &lt;fastjson.version&gt;1.2.13&lt;/fastjson.version&gt; &lt;jackson.version&gt;2.8.5&lt;/jackson.version&gt; &lt;druid.version&gt;1.0.27&lt;/druid.version&gt; &lt;mysql.version&gt;5.1.40&lt;/mysql.version&gt; &lt;commons-fileupload.version&gt;1.3.1&lt;/commons-fileupload.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;!--starter begin--&gt; &lt;!--spring cloud starter--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/3419c60b0df85d63c18586385eb38f83/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-07-09T14:18:22+08:00" />
<meta property="article:modified_time" content="2018-07-09T14:18:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SpringCloud | SpringCloud Finchley &#43; Spring Boot 2.0 集成Consul（1.2版本）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>微信公众号：吉姆餐厅ak<br> 学习更多源码知识，欢迎关注。<br> <img src="https://images2.imgbox.com/f6/e4/PboUFCFi_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<hr> 
<h3><a id="_6"></a>概述：</h3> 
<p>Spring Boot 2.0相对于之前的版本，变化还是很大的。首先对jdk的版本要求已经不能低于1.8，其次依赖的spring的版本也是最新版本5.0，并集成了功能强大的webflux等。<br> SpringCloud Finchley 版本的升级也带来了全新组件：Spring Cloud Function 和 Spring Cloud Gateway ,前者致力于函数式编程模块的整合，后者则是网关netflix zuul 的替换组件。</p> 
<h3><a id="1_13"></a>1）需要的依赖：</h3> 
<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.iyb&lt;/groupId&gt;
    &lt;artifactId&gt;saturn&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;

    &lt;name&gt;sc-saturn&lt;/name&gt;
    &lt;description&gt;sc-saturn for Spring Boot&lt;/description&gt;

    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;2.0.1.RELEASE&lt;/version&gt;
    &lt;/parent&gt;

    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
        &lt;java.version&gt;1.8&lt;/java.version&gt;
        &lt;mapper.version&gt;3.4.0&lt;/mapper.version&gt;
        &lt;pagehelper.version&gt;4.1.6&lt;/pagehelper.version&gt;
        &lt;fastjson.version&gt;1.2.13&lt;/fastjson.version&gt;
        &lt;jackson.version&gt;2.8.5&lt;/jackson.version&gt;
        &lt;druid.version&gt;1.0.27&lt;/druid.version&gt;
        &lt;mysql.version&gt;5.1.40&lt;/mysql.version&gt;
        &lt;commons-fileupload.version&gt;1.3.1&lt;/commons-fileupload.version&gt;
    &lt;/properties&gt;


    &lt;dependencies&gt;

        &lt;!--starter  begin--&gt;
        &lt;!--spring cloud starter--&gt;
        
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-zuul&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-ribbon&lt;/artifactId&gt;
        &lt;/dependency&gt;
           &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-sleuth&lt;/artifactId&gt;
        &lt;/dependency&gt;
        

		&lt;!--tomcat starter--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;
            &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;
            &lt;scope&gt;compile&lt;/scope&gt;
        &lt;/dependency&gt;
          &lt;!--actuator starter--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
        &lt;/dependency&gt;


        &lt;!--spring boot starter--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;!--spring starter--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;!--fastjon--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
            &lt;artifactId&gt;fastjson&lt;/artifactId&gt;
            &lt;version&gt;${fastjson.version}&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;io.github.openfeign&lt;/groupId&gt;
            &lt;artifactId&gt;feign-gson&lt;/artifactId&gt;
            &lt;version&gt;9.3.1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!--lombok--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j&lt;/artifactId&gt;
            &lt;version&gt;1.2.17&lt;/version&gt;
        &lt;/dependency&gt;


        &lt;dependency&gt;
            &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;
            &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;commons-collections&lt;/groupId&gt;
            &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
            &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;
            &lt;version&gt;3.4&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.netflix.feign&lt;/groupId&gt;
            &lt;artifactId&gt;feign-gson&lt;/artifactId&gt;
            &lt;version&gt;8.15.1&lt;/version&gt;
        &lt;/dependency&gt;

    &lt;/dependencies&gt;



 // Spring Cloud Finchley.RELEASE
    &lt;dependencyManagement&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
                &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;
                &lt;version&gt;Finchley.RELEASE&lt;/version&gt;
                &lt;type&gt;pom&lt;/type&gt;
                &lt;scope&gt;import&lt;/scope&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
    &lt;/dependencyManagement&gt;

&lt;/project&gt;

</code></pre> 
<hr> 
<h2><a id="_195"></a>需要注意的地方：</h2> 
<p>部分依赖做了改变：</p> 
<table><thead><tr><th>旧版本</th><th>Finchley 版本</th></tr></thead><tbody><tr><td>spring-cloud-starter-eureka-client</td><td>spring-cloud-starter-netflix-eureka-client</td></tr><tr><td>spring-cloud-starter-eureka-server</td><td>spring-cloud-starter-netflix-eureka-server</td></tr><tr><td>spring-cloud-starter-hystrix</td><td>spring-cloud-starter-netflix-hystrix</td></tr><tr><td>spring-cloud-starter-hystrix-dashboard</td><td>spring-cloud-starter-netflix-hystrix-dashboard</td></tr><tr><td>spring-cloud-starter-ribbon</td><td>spring-cloud-starter-netflix-ribbon</td></tr><tr><td>spring-cloud-starter-turbine</td><td>spring-cloud-starter-netflix-turbine</td></tr><tr><td>spring-cloud-starter-zuul</td><td>spring-cloud-starter-netflix-zuul</td></tr><tr><td>spring-cloud-starter-feign</td><td>spring-cloud-starter-openfeign</td></tr></tbody></table> 
<p>新版本的 SpringCloud 上面的依赖都发生了变化，依赖中都引入了 netflix，或许是为了声明吧（组件的实现底层并非spring）。</p> 
<ul><li>log4j依赖：</li></ul> 
<p>在spring cloud之前的版本中，日志只需要引入lombok即可，但是Finchley版本需要单独的引用。</p> 
<pre><code>    &lt;!--lombok--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j&lt;/artifactId&gt;
            &lt;version&gt;1.2.17&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre> 
<hr> 
<h3><a id="2consul_232"></a>2）集成consul配置文件：</h3> 
<pre><code>spring:
  application:
    name: sc-saturn
  profiles:
    active: dev

  cloud:
    config:
#      uri: http://localhost:9999
      discovery:
        enabled: false
        serviceId: sc-earth-config-server
      label: master
      profile: pre
    consul:
      host: http://localhost:8500
      port: 80
      discovery:
          prefer-ip-address: true
          #这里是重写健康检查的endPoint，默认为 /health，重写是为了节省不必要的网络传输，只需要http 200状态码即可
          health-check-path: /ok/health
          heartbeat:
            enabled: false



</code></pre> 
<hr> 
<h3><a id="3_264"></a>3）启动类：</h3> 
<pre><code>@SpringBootApplication
@EnableFeignClients
@EnableZuulServer
@ComponentScan(basePackages={"com.iyb.ak"})
@EnableDiscoveryClient
@Slf4j
public class SaturnApplication implements CommandLineRunner{

	public static void main(String[] args) {
		SpringApplication.run(SaturnApplication.class, args);
	}


	@Override
	public void run(String... args) throws Exception {
		log.info("&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; sc-saturn 启动完成&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;");
	}
}

</code></pre> 
<hr> 
<h3><a id="4_290"></a>4）示例：</h3> 
<p><img src="https://images2.imgbox.com/6f/da/x1KweLts_o.png" alt="这里写图片描述"></p> 
<hr> 
<p>注册中心：<br> <img src="https://images2.imgbox.com/eb/c1/maAKgQas_o.png" alt="这里写图片描述"><br> 可以看到 sc-saturn 已经成功注册到 consul中了。另外，上面的consul ui界面发生了变化，这是1.2版本做出的优化，相较以前的ui界面，已经好看很多了。</p> 
<hr> 
<p>友链：<a href="https://www.tamguo.com/" rel="nofollow">探果网</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e5868a8f378fb90c91c5ce4afd88da58/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">js如何获取response header信息</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1cabea7c8ebea248ae158f4821f21436/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ubuntu部署kkFileView服务实现ppt|doc转换成PDF在线预览</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>