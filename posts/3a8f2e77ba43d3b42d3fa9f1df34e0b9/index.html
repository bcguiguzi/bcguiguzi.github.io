<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PTrade获取财务数据 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PTrade获取财务数据" />
<meta property="og:description" content="PTrade提供了获取财务数据函数get_fundamentals，可以用于获取财务三大报表数据、日频估值数据、各项财务能力指标数据，数据源为恒生。
示例 先来看一个展示使用get_fundamentals函数获取财务数据的例子：
def initialize(context): g.security = [&#39;600900.SS&#39;, &#39;601877.SS&#39;] def before_trading_start(context, data): data = get_fundamentals(security=g.security, table=&#39;growth_ability&#39;, fields=[&#39;operating_revenue_grow_rate&#39;, &#39;net_profit_grow_rate&#39;], date=get_trading_day().strftime(&#39;%Y%m%d&#39;) ) log.info(data) def handle_data(context, data): passdef initialize(context): g.security = [&#39;600900.SS&#39;, &#39;601877.SS&#39;] def before_trading_start(context, data): data = get_fundamentals(security=g.security, table=&#39;growth_ability&#39;, fields=[&#39;operating_revenue_grow_rate&#39;, &#39;net_profit_grow_rate&#39;], date=get_trading_day().strftime(&#39;%Y%m%d&#39;)) log.info(data) def handle_data(context, data): pass 我们在这里尝试查询两只标的（‘600900.SS’, ‘601877.SS’）的财务数据，在表growth_ability（成长能力指标）中查询他们的operating_revenue_grow_rate（营业收入同比增长%）和net_profit_grow_rate（净利润同比增长%）两个指标。PTrade里设置回测时间为2023-05-05，输出结果为：
2023-05-05 08:30:00 - INFO - publ_date end_date operating_revenue_grow_rate \ secu_code 600900.SS 2023-04-28 2023-03-31 25.1657 601877.SS 2023-04-29 2023-03-31 47.3708 net_profit_grow_rate secu_abbr secu_code 600900.SS 18." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/3a8f2e77ba43d3b42d3fa9f1df34e0b9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-16T20:26:24+08:00" />
<meta property="article:modified_time" content="2023-10-16T20:26:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PTrade获取财务数据</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>PTrade提供了获取财务数据函数get_fundamentals，可以用于获取财务三大报表数据、日频估值数据、各项财务能力指标数据，数据源为恒生。</p> 
<h4><a id="_2"></a>示例</h4> 
<p>先来看一个展示使用get_fundamentals函数获取财务数据的例子：</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">:</span>
    g<span class="token punctuation">.</span>security <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'600900.SS'</span><span class="token punctuation">,</span> <span class="token string">'601877.SS'</span><span class="token punctuation">]</span>
    
<span class="token keyword">def</span> <span class="token function">before_trading_start</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    data <span class="token operator">=</span> get_fundamentals<span class="token punctuation">(</span>security<span class="token operator">=</span>g<span class="token punctuation">.</span>security<span class="token punctuation">,</span> 
                            table<span class="token operator">=</span><span class="token string">'growth_ability'</span><span class="token punctuation">,</span> 
                            fields<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'operating_revenue_grow_rate'</span><span class="token punctuation">,</span> <span class="token string">'net_profit_grow_rate'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                            date<span class="token operator">=</span>get_trading_day<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span>
                           <span class="token punctuation">)</span>
    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">handle_data</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    passdef initialize<span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">:</span>
    g<span class="token punctuation">.</span>security <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'600900.SS'</span><span class="token punctuation">,</span> <span class="token string">'601877.SS'</span><span class="token punctuation">]</span>
    
<span class="token keyword">def</span> <span class="token function">before_trading_start</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    data <span class="token operator">=</span> get_fundamentals<span class="token punctuation">(</span>security<span class="token operator">=</span>g<span class="token punctuation">.</span>security<span class="token punctuation">,</span> 
                            table<span class="token operator">=</span><span class="token string">'growth_ability'</span><span class="token punctuation">,</span> 
                            fields<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'operating_revenue_grow_rate'</span><span class="token punctuation">,</span> <span class="token string">'net_profit_grow_rate'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                            date<span class="token operator">=</span>get_trading_day<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">handle_data</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>
</code></pre> 
<p>我们在这里尝试查询两只标的（‘600900.SS’, ‘601877.SS’）的财务数据，在表growth_ability（成长能力指标）中查询他们的operating_revenue_grow_rate（营业收入同比增长%）和net_profit_grow_rate（净利润同比增长%）两个指标。PTrade里设置回测时间为2023-05-05，输出结果为：</p> 
<pre><code class="prism language-bash"><span class="token number">2023</span>-05-05 08:30:00 - INFO -             publ_date    end_date  operating_revenue_grow_rate  <span class="token punctuation">\</span>
secu_code                                                        
<span class="token number">600900</span>.SS  <span class="token number">2023</span>-04-28  <span class="token number">2023</span>-03-31                      <span class="token number">25.1657</span>   
<span class="token number">601877</span>.SS  <span class="token number">2023</span>-04-29  <span class="token number">2023</span>-03-31                      <span class="token number">47.3708</span>   

           net_profit_grow_rate secu_abbr  
secu_code                                  
<span class="token number">600900</span>.SS               <span class="token number">18.0351</span>      长江电力  
<span class="token number">601877</span>.SS              <span class="token number">132.9152</span>      正泰电器
</code></pre> 
<p>将输出结果稍作整理：</p> 
<table><thead><tr><th>secu_code</th><th>publ_date</th><th>end_date</th><th>operating_revenue_grow_rate</th><th>net_profit_grow_rate</th><th>secu_abbr</th></tr></thead><tbody><tr><td>600900.SS</td><td>2023-04-28</td><td>2023-03-31</td><td>25.1657</td><td>18.0351</td><td>长江电力</td></tr><tr><td>601877.SS</td><td>2023-04-29</td><td>2023-03-31</td><td>47.3708</td><td>132.9152</td><td>正泰电器</td></tr></tbody></table> 
<p>get_fundamentals返回的结果类型为DataFrame。可以看到，除了我们要查询两个指标外，还返回了publ_date（公告日期），end_date（截止日期），secu_abbr（股票简称）。</p> 
<h4><a id="PTrade_55"></a>PTrade提供的财务数据表</h4> 
<p>PTrade提供了一下财务数据表供程序查询，具体每个表所包含的指标可以参见PTrade的帮助文档。</p> 
<table><thead><tr><th>表名</th><th>包含内容</th></tr></thead><tbody><tr><td>valuation</td><td>估值数据</td></tr><tr><td>balance_statement</td><td>资产负债表</td></tr><tr><td>income_statement</td><td>利润表</td></tr><tr><td>cashflow_statement</td><td>现金流量表</td></tr><tr><td>growth_ability</td><td>成长能力指标</td></tr><tr><td>profit_ability</td><td>盈利能力指标</td></tr><tr><td>eps</td><td>每股指标</td></tr><tr><td>operating_ability</td><td>营运能力指标</td></tr><tr><td>debt_paying_ability</td><td>偿债能力指标</td></tr></tbody></table> 
<hr> 
<p><strong>博客内容只用于交流学习，不构成投资建议，盈亏自负！</strong></p> 
<p>个人博客：http://coderx.com.cn/（优先更新）<br> 项目最新代码：https://gitee.com/sl/quant_from_scratch<br> 欢迎大家转发、留言。有微信群用于学习交流，感兴趣的读者请扫码加微信！<br> 如果认为博客对您有帮助，可以扫码进行捐赠，感谢！</p> 
<table><thead><tr><th align="center">微信二维码</th><th align="center">微信捐赠二维码</th></tr></thead><tbody><tr><td align="center"></td><td align="center"></td></tr><tr><td align="center"><img src="https://images2.imgbox.com/e1/25/YHAgILRM_o.png" alt="在这里插入图片描述"></td><td align="center"><img src="https://images2.imgbox.com/d5/d5/PhmQatjJ_o.png" alt="在这里插入图片描述"></td></tr></tbody></table>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d2ee718bafa1a335ddfd109f03546468/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">西储大学轴承监测数据集及数据集分类</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ba2232de59df8cd51285bd6aa40ad1c7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">TypeScript 断言</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>