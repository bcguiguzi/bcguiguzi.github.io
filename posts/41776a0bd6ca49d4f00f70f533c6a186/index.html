<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Excel·VBA收益最大的运输路线 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Excel·VBA收益最大的运输路线" />
<meta property="og:description" content="看到一个帖子《excel吧-找出运输收益最大的路线》，根据表中的起点和终点构成的路线，在一定的本金和时间限制下，获取收益最大的运输路线
采用类似《Excel·VBA数组排列函数》，尾数循环结束后，对之前的位置进位的方式，获取遍历所有可能路线，最终得到收益最大的运输路线
以下代码中内层第1个do循环的作用是，路线一直向前延伸，直到剩余时间不足；内层第2个do循环的作用是，在一条路线延伸到底后，对最后一个起点的其他终点进行计算，判断是否为收益更大的路线；内层第3个do循环的作用是，当一条路线延伸到底后，且路线的最后一个终点是其起点的最后一个终点时，对其起点进行递增为下一个起点，且如果路线上的终点都为其起点的最后一个终点时，一直向前递增
以下代码运用了Match函数《Excel·VBA多行多列数据简单汇总》，可查找数值在数组中的位置，返回的index从1开始计数，而在以下代码中查找的都是字典键数组从0开始计数，因此代码中For i = y To UBound(dk)就是从被查找的字符的下一个位置开始循环（VBA字典键顺序为写入字典的顺序）
Sub 运输收益最大路线() &#39;res数组记录输出结果共100行3列（总收益，剩余时间，路线），b记录当前路线，mrr记录每次终点的金额，trr记录剩余时间 Dim arr, mm, tt, min_t, dict As Object, res(1 To 100, 1 To 3), r&amp;, i&amp;, j&amp;, x&amp;, y&amp;, s$, m, t arr = [a1].CurrentRegion: mm = 50000: tt = 1200 &#39;初始总本金、总耗时 min_t = WorksheetFunction.Min(Application.index(arr, , 5)) &#39;最小耗时 Set dict = CreateObject(&#34;scripting.dictionary&#34;): tm = Timer res(1, 1) = &#34;总收益&#34;: res(1, 2) = &#34;剩余时间&#34;: res(1, 3) = &#34;路线&#34;: res(2, 1) = 0 For i = 2 To UBound(arr) &#39;字典嵌套字典，记录起止点对应（单位成本，单位收益，耗时） If Not dict." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/41776a0bd6ca49d4f00f70f533c6a186/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-02-10T21:58:32+08:00" />
<meta property="article:modified_time" content="2024-02-10T21:58:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Excel·VBA收益最大的运输路线</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>看到一个帖子<a href="https://tieba.baidu.com/p/8888181846" rel="nofollow">《excel吧-找出运输收益最大的路线》</a>，根据表中的起点和终点构成的路线，在一定的本金和时间限制下，获取收益最大的运输路线<br> <img src="https://images2.imgbox.com/a1/88/xbtvuvW9_o.jpg" alt="在这里插入图片描述"></p> 
<ul><li> <p>采用类似<a href="https://blog.csdn.net/hhhhh_51/article/details/126770841">《Excel·VBA数组排列函数》</a>，尾数循环结束后，对之前的位置进位的方式，获取遍历所有可能路线，最终得到收益最大的运输路线</p> </li><li> <p>以下代码中内层<code>第1个do循环</code>的作用是，路线一直向前延伸，直到剩余时间不足；内层<code>第2个do循环</code>的作用是，在一条路线延伸到底后，对最后一个起点的其他终点进行计算，判断是否为收益更大的路线；内层<code>第3个do循环</code>的作用是，当一条路线延伸到底后，且路线的最后一个终点是其起点的最后一个终点时，对其起点进行递增为下一个起点，且如果路线上的终点都为其起点的最后一个终点时，一直向前递增</p> </li><li> <p>以下代码运用了<code>Match</code>函数<a href="https://blog.csdn.net/hhhhh_51/article/details/124158282">《Excel·VBA多行多列数据简单汇总》</a>，可查找数值在数组中的位置，返回的index从1开始计数，而在以下代码中查找的都是字典键数组从0开始计数，因此代码中<code>For i = y To UBound(dk)</code>就是从被查找的字符的下一个位置开始循环（VBA字典键顺序为写入字典的顺序）</p> </li></ul> 
<pre><code class="prism language-vbnet"><span class="token keyword">Sub</span> 运输收益最大路线<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">'res数组记录输出结果共100行3列（总收益，剩余时间，路线），b记录当前路线，mrr记录每次终点的金额，trr记录剩余时间</span>
    <span class="token keyword">Dim</span> arr<span class="token punctuation">,</span> mm<span class="token punctuation">,</span> tt<span class="token punctuation">,</span> min_t<span class="token punctuation">,</span> dict <span class="token keyword">As</span> <span class="token keyword">Object</span><span class="token punctuation">,</span> res<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token operator">&amp;</span><span class="token punctuation">,</span> i<span class="token operator">&amp;</span><span class="token punctuation">,</span> j<span class="token operator">&amp;</span><span class="token punctuation">,</span> x<span class="token operator">&amp;</span><span class="token punctuation">,</span> y<span class="token operator">&amp;</span><span class="token punctuation">,</span> s$<span class="token punctuation">,</span> m<span class="token punctuation">,</span> t
    arr <span class="token operator">=</span> [a1].CurrentRegion<span class="token punctuation">:</span> mm <span class="token operator">=</span> <span class="token number">50000</span><span class="token punctuation">:</span> tt <span class="token operator">=</span> <span class="token number">1200</span>  <span class="token comment">'初始总本金、总耗时</span>
    min_t <span class="token operator">=</span> WorksheetFunction.<span class="token function">Min</span><span class="token punctuation">(</span>Application.index<span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">'最小耗时</span>
    <span class="token keyword">Set</span> dict <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"scripting.dictionary"</span><span class="token punctuation">)</span><span class="token punctuation">:</span> tm <span class="token operator">=</span> <span class="token keyword">Timer</span>
    res<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"总收益"</span><span class="token punctuation">:</span> res<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"剩余时间"</span><span class="token punctuation">:</span> res<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"路线"</span><span class="token punctuation">:</span> res<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> <span class="token function">UBound</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>  <span class="token comment">'字典嵌套字典，记录起止点对应（单位成本，单位收益，耗时）</span>
        <span class="token keyword">If</span> <span class="token keyword">Not</span> dict.Exists<span class="token punctuation">(</span>arr<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">Then</span> <span class="token keyword">Set</span> dict<span class="token punctuation">(</span>arr<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"scripting.dictionary"</span><span class="token punctuation">)</span>
        dict<span class="token punctuation">(</span>arr<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>arr<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span>arr<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> arr<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">-</span> arr<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> arr<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">Next</span>
    <span class="token comment">'初始数据，b路线数组，mrr本金数组，trr剩余时间数组</span>
    <span class="token keyword">Dim</span> b<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mrr<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> trr<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dk<span class="token punctuation">,</span> k1<span class="token punctuation">,</span> k2<span class="token punctuation">,</span> k3<span class="token punctuation">,</span> dj<span class="token punctuation">,</span> ds<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> change <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
    dk <span class="token operator">=</span> dict.Keys<span class="token punctuation">:</span> b<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> dk<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span> mrr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> mm<span class="token punctuation">:</span> trr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> tt<span class="token punctuation">:</span> x <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">Do</span>
        <span class="token keyword">Do</span> <span class="token keyword">While</span> trr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> min_t  <span class="token comment">'线路递增</span>
            k1 <span class="token operator">=</span> b<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span> m <span class="token operator">=</span> mrr<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span> t <span class="token operator">=</span> trr<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span> dk <span class="token operator">=</span> dict<span class="token punctuation">(</span>k1<span class="token punctuation">)</span>.Keys  <span class="token comment">'初始状态，m当前本金，t当前剩余时间</span>
            <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> <span class="token function">UBound</span><span class="token punctuation">(</span>dk<span class="token punctuation">)</span>
                k2 <span class="token operator">=</span> dk<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span> dt <span class="token operator">=</span> dict<span class="token punctuation">(</span>k1<span class="token punctuation">)</span><span class="token punctuation">(</span>k2<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment">'单位耗时</span>
                <span class="token keyword">If</span> t <span class="token operator">&gt;=</span> dt <span class="token keyword">Then</span>
                    x <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span> b<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> k2
                    dj <span class="token operator">=</span> dict<span class="token punctuation">(</span>b<span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>b<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span> ds <span class="token operator">=</span> dict<span class="token punctuation">(</span>b<span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>b<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">'单价、单收益</span>
                    m <span class="token operator">=</span> m <span class="token operator">+</span> <span class="token function">Int</span><span class="token punctuation">(</span>m <span class="token operator">/</span> dj<span class="token punctuation">)</span> <span class="token operator">*</span> ds<span class="token punctuation">:</span> mrr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> m<span class="token punctuation">:</span> trr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> t <span class="token operator">-</span> dt  <span class="token comment">'本金递增、时间递减</span>
                    <span class="token keyword">Exit</span> <span class="token keyword">For</span>
                <span class="token keyword">Else</span>
                    <span class="token keyword">If</span> i <span class="token operator">=</span> <span class="token function">UBound</span><span class="token punctuation">(</span>dk<span class="token punctuation">)</span> <span class="token keyword">Then</span> <span class="token keyword">Exit</span> <span class="token keyword">Do</span>  <span class="token comment">'所有终点所需时间都超过剩余耗时，跳出</span>
                <span class="token keyword">End</span> <span class="token keyword">If</span>
            <span class="token keyword">Next</span>
        <span class="token keyword">Loop</span>
        s <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> x  <span class="token comment">'路线结果</span>
            s <span class="token operator">=</span> s <span class="token operator">&amp;</span> <span class="token string">"-"</span> <span class="token operator">&amp;</span> b<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token keyword">Next</span>
        <span class="token keyword">If</span> trr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token keyword">Then</span>
            m <span class="token operator">=</span> mrr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">-</span> mm  <span class="token comment">'总收益</span>
            <span class="token keyword">If</span> m <span class="token operator">&gt;</span> res<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>  <span class="token comment">'写入输出数组</span>
                r <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">:</span> res<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> m<span class="token punctuation">:</span> res<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> trr<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span> res<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Mid</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token keyword">ElseIf</span> m <span class="token operator">=</span> res<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>
                r <span class="token operator">=</span> r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span> res<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> m<span class="token punctuation">:</span> res<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> trr<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span> res<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Mid</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">Do</span>  <span class="token comment">'线路终点迭代</span>
            change <span class="token operator">=</span> <span class="token keyword">False</span><span class="token punctuation">:</span> k1 <span class="token operator">=</span> b<span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> k2 <span class="token operator">=</span> b<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span> t <span class="token operator">=</span> trr<span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">'原起止点、时间复位</span>
            dk <span class="token operator">=</span> dict<span class="token punctuation">(</span>k1<span class="token punctuation">)</span>.Keys<span class="token punctuation">:</span> y <span class="token operator">=</span> Application.Match<span class="token punctuation">(</span>k2<span class="token punctuation">,</span> dk<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">'查找k2出现位置，从1开始计数</span>
            <span class="token keyword">For</span> i <span class="token operator">=</span> y <span class="token keyword">To</span> <span class="token function">UBound</span><span class="token punctuation">(</span>dk<span class="token punctuation">)</span>  <span class="token comment">'从k2出现位置之后开始循环</span>
                k3 <span class="token operator">=</span> dk<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span> dt <span class="token operator">=</span> dict<span class="token punctuation">(</span>k1<span class="token punctuation">)</span><span class="token punctuation">(</span>k3<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
                <span class="token keyword">If</span> t <span class="token operator">&gt;=</span> dt <span class="token keyword">Then</span>
                    dj <span class="token operator">=</span> dict<span class="token punctuation">(</span>k1<span class="token punctuation">)</span><span class="token punctuation">(</span>k3<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span> ds <span class="token operator">=</span> dict<span class="token punctuation">(</span>k1<span class="token punctuation">)</span><span class="token punctuation">(</span>k3<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                    m <span class="token operator">=</span> mrr<span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">Int</span><span class="token punctuation">(</span>mrr<span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> dj<span class="token punctuation">)</span> <span class="token operator">*</span> ds  <span class="token comment">'原本金+新收益后的本金</span>
                    <span class="token keyword">If</span> t <span class="token operator">-</span> dt <span class="token operator">&gt;=</span> min_t <span class="token keyword">Then</span>  <span class="token comment">'能够线路递增，修改3个数组，跳出do循环</span>
                        b<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> k3<span class="token punctuation">:</span> mrr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> m<span class="token punctuation">:</span> trr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> t <span class="token operator">-</span> dt<span class="token punctuation">:</span> <span class="token keyword">Exit</span> <span class="token keyword">Do</span>
                    <span class="token keyword">Else</span>
                        <span class="token keyword">If</span> m <span class="token operator">&gt;=</span> res<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>  <span class="token comment">'仅终点变化，写入输出数组</span>
                            b<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> k3<span class="token punctuation">:</span> mrr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> m<span class="token punctuation">:</span> trr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> t <span class="token operator">-</span> dt<span class="token punctuation">:</span> s <span class="token operator">=</span> <span class="token string">""</span>
                            <span class="token keyword">For</span> j <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> x   <span class="token comment">'路线结果</span>
                                s <span class="token operator">=</span> s <span class="token operator">&amp;</span> <span class="token string">"-"</span> <span class="token operator">&amp;</span> b<span class="token punctuation">(</span>j<span class="token punctuation">)</span>
                            <span class="token keyword">Next</span>
                            <span class="token keyword">If</span> m <span class="token operator">&gt;</span> res<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>
                                r <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">:</span> res<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> m <span class="token operator">-</span> mm<span class="token punctuation">:</span> res<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> trr<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span> res<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Mid</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
                            <span class="token keyword">ElseIf</span> m <span class="token operator">=</span> res<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>
                                r <span class="token operator">=</span> r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span> res<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> m <span class="token operator">-</span> mm<span class="token punctuation">:</span> res<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> trr<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span> res<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Mid</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
                            <span class="token keyword">End</span> <span class="token keyword">If</span>
                        <span class="token keyword">End</span> <span class="token keyword">If</span>
                    <span class="token keyword">End</span> <span class="token keyword">If</span>
                <span class="token keyword">End</span> <span class="token keyword">If</span>
            <span class="token keyword">Next</span>
            change <span class="token operator">=</span> <span class="token keyword">True</span>  <span class="token comment">'同次路线最后一个终点迭代完成，下一步迭代之前的起点</span>
        <span class="token keyword">Loop</span> <span class="token keyword">Until</span> change <span class="token operator">=</span> <span class="token keyword">True</span>
        <span class="token keyword">Do</span> <span class="token keyword">While</span> change <span class="token operator">=</span> <span class="token keyword">True</span>  <span class="token comment">'最后一个起点迭代，循环进位</span>
            b<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">:</span> mrr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">:</span> trr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">:</span> x <span class="token operator">=</span> x <span class="token operator">-</span> <span class="token number">1</span>  <span class="token comment">'清除最后1个，进位</span>
            <span class="token keyword">If</span> x <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>  <span class="token comment">'第1个起点</span>
                k2 <span class="token operator">=</span> b<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span> dk <span class="token operator">=</span> dict.Keys<span class="token punctuation">:</span> change <span class="token operator">=</span> <span class="token keyword">False</span>
                <span class="token keyword">If</span> k2 <span class="token operator">&lt;&gt;</span> dk<span class="token punctuation">(</span><span class="token function">UBound</span><span class="token punctuation">(</span>dk<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>  <span class="token comment">'不是最后1个</span>
                    y <span class="token operator">=</span> Application.Match<span class="token punctuation">(</span>k2<span class="token punctuation">,</span> dk<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span> b<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> dk<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
                <span class="token keyword">Else</span>
                    b<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">""</span>
                <span class="token keyword">End</span> <span class="token keyword">If</span>
            <span class="token keyword">Else</span>
                k1 <span class="token operator">=</span> b<span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> k2 <span class="token operator">=</span> b<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span> dk <span class="token operator">=</span> dict<span class="token punctuation">(</span>k1<span class="token punctuation">)</span>.Keys<span class="token punctuation">:</span> y <span class="token operator">=</span> Application.Match<span class="token punctuation">(</span>k2<span class="token punctuation">,</span> dk<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">For</span> i <span class="token operator">=</span> y <span class="token keyword">To</span> <span class="token function">UBound</span><span class="token punctuation">(</span>dk<span class="token punctuation">)</span>  <span class="token comment">'y从1开始计数，=y即为y的下一个</span>
                    k3 <span class="token operator">=</span> dk<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span> dt <span class="token operator">=</span> dict<span class="token punctuation">(</span>k1<span class="token punctuation">)</span><span class="token punctuation">(</span>k3<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
                    <span class="token keyword">If</span> trr<span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> dt <span class="token keyword">Then</span>
                        dj <span class="token operator">=</span> dict<span class="token punctuation">(</span>k1<span class="token punctuation">)</span><span class="token punctuation">(</span>k3<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span> ds <span class="token operator">=</span> dict<span class="token punctuation">(</span>k1<span class="token punctuation">)</span><span class="token punctuation">(</span>k3<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> dt <span class="token operator">=</span> dict<span class="token punctuation">(</span>k1<span class="token punctuation">)</span><span class="token punctuation">(</span>k3<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
                        mrr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> mrr<span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">Int</span><span class="token punctuation">(</span>mrr<span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> dj<span class="token punctuation">)</span> <span class="token operator">*</span> ds<span class="token punctuation">:</span> trr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> trr<span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> dt
                        b<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> k3<span class="token punctuation">:</span> <span class="token keyword">Exit</span> <span class="token keyword">Do</span>  <span class="token comment">'跳出本次迭代</span>
                    <span class="token keyword">End</span> <span class="token keyword">If</span>
                <span class="token keyword">Next</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">Loop</span>
    <span class="token keyword">Loop</span> <span class="token keyword">Until</span> <span class="token function">Len</span><span class="token punctuation">(</span>b<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment">'所有遍历完后，完成所有进位时b(1)为空值</span>
    [g1].Resize<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> res
    <span class="token function">Debug</span>.<span class="token function">Print</span> <span class="token string">"路线选择完成，用时"</span> <span class="token operator">&amp;</span> Format<span class="token punctuation">(</span><span class="token keyword">Timer</span> <span class="token operator">-</span> tm<span class="token punctuation">,</span> <span class="token string">"0.00"</span><span class="token punctuation">)</span>  <span class="token comment">'耗时</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> 
<ul><li>运行结果：最大收益为406115，代码运行耗时<code>14.77</code>秒<br> <img src="https://images2.imgbox.com/7d/ac/UL6651zq_o.jpg" alt="在这里插入图片描述"></li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ec58680b496a8b3cc388e15254954fec/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VS2022 C&#43;&#43; MFC LINK2005 LINK1169</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c5b652b456957de1d7b2873cdc96e9f0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C#系列-C#微服务框架（12）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>