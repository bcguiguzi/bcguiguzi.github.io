<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2020 计蒜之道 线上决赛（C，D，E，F，G） - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2020 计蒜之道 线上决赛（C，D，E，F，G）" />
<meta property="og:description" content="最近很长时间都很忙，写这篇主要是挂一下代码。
A略
B略
C.攀登山峰
样例输入复制
8 3 1 2 1 4 4 5 3 3 3 7 5 1 4 3 3 8 6 样例输出复制
4 1 4 题解：
std：
/**/ #include &lt;cstdio&gt; #include &lt;cstring&gt; #include &lt;cmath&gt; #include &lt;cctype&gt; #include &lt;iostream&gt; #include &lt;algorithm&gt; #include &lt;map&gt; #include &lt;set&gt; #include &lt;vector&gt; #include &lt;string&gt; #include &lt;stack&gt; #include &lt;queue&gt; typedef long long LL; using namespace std; const int maxn = 1e5 &#43; 5; int n, m, cnt, a[maxn], b[maxn], rt[maxn]; int tr[maxn &lt;&lt; 5], ls[maxn &lt;&lt; 5], rs[maxn &lt;&lt; 5]; void build(int &amp;now, int l, int r){ tr[now = &#43;&#43;cnt] = 0; if(l == r) return ; int mid = (l &#43; r) &gt;&gt; 1; build(ls[now], l, mid); build(rs[now], mid &#43; 1, r); } void up(int now){ tr[now] = tr[ls[now]] &#43; tr[rs[now]]; } void update(int &amp;now, int &amp;old, int l, int r, int w){ tr[now = &#43;&#43;cnt] = tr[old] &#43; 1; ls[now] = ls[old], rs[now] = rs[old]; if(l == r){ // tr[now]&#43;&#43;; return ; } int mid = (l &#43; r) &gt;&gt; 1; if(mid &gt;= w) update(ls[now], ls[old], l, mid, w); else update(rs[now], rs[old], mid &#43; 1, r, w); // up(now); } int query(int now, int old, int l, int r, int num){ if(l == r) return l; int mid = (l &#43; r) &gt;&gt; 1; int res = 0; if(tr[ls[old]] - tr[ls[now]] &gt; num){ res = max(res, query(ls[now], ls[old], l, mid, num)); } if(tr[rs[old]] - tr[rs[now]] &gt; num){ res = max(res, query(rs[now], rs[old], mid &#43; 1, r, num)); } return res; } int main() { //freopen(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/2b4bb035b78d96d10e0e8bec4d906d39/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-10-24T23:00:18+08:00" />
<meta property="article:modified_time" content="2020-10-24T23:00:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2020 计蒜之道 线上决赛（C，D，E，F，G）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>最近很长时间都很忙，写这篇主要是挂一下代码。</strong></p> 
<p>A略</p> 
<p>B略</p> 
<p>C.攀登山峰</p> 
<p><img alt="" height="532" src="https://images2.imgbox.com/3c/db/Hr07INuw_o.png" width="827"></p> 
<p>样例输入复制</p> 
<pre><code class="language-html">8 3
1 2 1 4 4 5 3 3 
3 7 5
1 4 3
3 8 6</code></pre> 
<p>样例输出复制</p> 
<pre><code class="language-html">4
1
4</code></pre> 
<p> 题解：</p> 
<p><img alt="" height="324" src="https://images2.imgbox.com/0d/c3/GGimpjln_o.png" width="825"></p> 
<p>std：</p> 
<pre><code class="language-cpp">/**/
#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;cmath&gt;
#include &lt;cctype&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;map&gt;
#include &lt;set&gt;
#include &lt;vector&gt;
#include &lt;string&gt;
#include &lt;stack&gt;
#include &lt;queue&gt;

typedef long long LL;
using namespace std;

const int maxn = 1e5 + 5;

int n, m, cnt, a[maxn], b[maxn], rt[maxn];
int tr[maxn &lt;&lt; 5], ls[maxn &lt;&lt; 5], rs[maxn &lt;&lt; 5];

void build(int &amp;now, int l, int r){
    tr[now = ++cnt] = 0;
    if(l == r) return ;
    int mid = (l + r) &gt;&gt; 1;
    build(ls[now], l, mid);
    build(rs[now], mid + 1, r);
}

void up(int now){
    tr[now] = tr[ls[now]] + tr[rs[now]];
}

void update(int &amp;now, int &amp;old, int l, int r, int w){
    tr[now = ++cnt] = tr[old] + 1;
    ls[now] = ls[old], rs[now] = rs[old];
    if(l == r){
        // tr[now]++;
        return ;
    }
    int mid = (l + r) &gt;&gt; 1;
    if(mid &gt;= w) update(ls[now], ls[old], l, mid, w);
    else update(rs[now], rs[old], mid + 1, r, w);
    // up(now);
}

int query(int now, int old, int l, int r, int num){
    if(l == r) return l;
    int mid = (l + r) &gt;&gt; 1;
    int res = 0;
    if(tr[ls[old]] - tr[ls[now]] &gt; num){
        res = max(res, query(ls[now], ls[old], l, mid, num));
    }
    if(tr[rs[old]] - tr[rs[now]] &gt; num){
        res = max(res, query(rs[now], rs[old], mid + 1, r, num));
    }
    return res;
}

int main()
{
    //freopen("in.txt", "r", stdin);
    //freopen("out.txt", "w", stdout);

    scanf("%d %d", &amp;n, &amp;m);
    for (int i = 1; i &lt;= n; i++) scanf("%d", &amp;a[i]), b[i] = a[i];
    sort(b + 1, b + 1 + n);
    int cnt = unique(b + 1, b + 1 + n) - b - 1;
    build(rt[0], 1, cnt);
    b[0] = -1;
    for (int i = 1; i &lt;= n; i++) update(rt[i], rt[i - 1], 1, cnt, a[i] = lower_bound(b + 1, b + 1 + cnt, a[i]) - b);
    for (int i = 1, l, r, t; i &lt;= m; i++){
        scanf("%d %d %d", &amp;l, &amp;r, &amp;t);
        int len = (r - l + 1) / t;
        printf("%d\n", b[query(rt[l - 1], rt[r], 1, cnt, len)]);
    }

    return 0;
}
/**/</code></pre> 
<p> </p> 
<p>D. 两个多项式的卷积</p> 
<p><img alt="" height="766" src="https://images2.imgbox.com/a8/f7/QsbXKads_o.png" width="845"></p> 
<p>数据范围</p> 
<p>样例输入复制</p> 
<pre><code class="language-html">2
1 2 3
3 2 1
3
1 1 4
2 0 -1
1 1 4</code></pre> 
<p>样例输出复制</p> 
<pre><code class="language-html">33
30</code></pre> 
<p>题解：</p> 
<p><img alt="" height="706" src="https://images2.imgbox.com/18/20/XlK8PYf6_o.png" width="721"></p> 
<p> </p> 
<p>std：</p> 
<pre><code class="language-cpp">/**/
#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;cmath&gt;
#include &lt;cctype&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;map&gt;
#include &lt;set&gt;
#include &lt;vector&gt;
#include &lt;string&gt;
#include &lt;stack&gt;
#include &lt;queue&gt;

typedef long long LL;
using namespace std;

const int maxn = 4e4 + 5;
const int mod = 998244353;

int lim = 1, L, G = 3, Gi = 332748118;
int n, m, cnt, a[maxn], A[maxn], b[maxn], c[maxn], rev[maxn &lt;&lt; 1], pos[maxn], w[maxn], pre[maxn];

LL poww(LL x, LL num){
    LL res = 1;
    while(num){
        if(num &amp; 1) res = res * x % mod;
        x = x * x % mod;
        num &gt;&gt;= 1;
    }
    return res;
}

void ntt(int *a, int type){
    for (int i = 0; i &lt; lim; i++) if(i &lt; rev[i]) swap(a[i], a[rev[i]]);
    static int x, y;
    for (int mid = 1; mid &lt; lim; mid &lt;&lt;= 1){
        int len = mid &lt;&lt; 1, wn = poww(type ? G : Gi , (mod - 1) / (mid &lt;&lt; 1));
        for (int i = 0; i &lt; lim; i += len){
            for (int j = 0, w = 1; j &lt; mid; j++, w = 1LL * w * wn % mod){
                x = a[i + j], y = 1LL * w * a[i + mid + j] % mod;
                a[i + j] = (x + y) % mod, a[i + mid + j] = (x + mod - y) % mod;
            }
        }
    }
    if(!type){
        LL inv = poww(lim, mod - 2);
        for (int i = 0; i &lt; lim; i++) a[i] = (1LL * inv * a[i] % mod + mod) % mod;
    }
}

void init(){
    while(lim &lt;= n) lim &lt;&lt;= 1, L++;
    for (int i = 0; i &lt; lim; i++) rev[i] = (rev[i &gt;&gt; 1] &gt;&gt; 1) | ((i &amp; 1) &lt;&lt; (L - 1));
}

void doNTT(){
    for (int i = 0; i &lt; lim; i++) A[i] = a[i];
    ntt(A, 1);
    for (int i = 0; i &lt; lim; i++) c[i] = (1LL * A[i] * b[i] % mod + mod) % mod;
    ntt(c, 0);
    for (int i = 1; i &lt; lim; i++) c[i] = (c[i] + c[i - 1]) % mod;
}

LL cal(int x){
    if(x &lt; 0) return 0LL;
    LL sum = c[x];
    for (int i = 1; i &lt;= cnt; i++){
        int r = x - pos[i];
        // printf("===%d %d %d\n", i, r, pre[r]);
        if(r &gt;= 0) sum = (sum + 1LL * w[i] * pre[r] % mod + mod) % mod;
    }
    return sum;
}

int main()
{
    //freopen("in.txt", "r", stdin);
    //freopen("out.txt", "w", stdout);

    scanf("%d", &amp;n);
    for (int i = 0; i &lt;= n; i++) scanf("%d", &amp;a[i]), a[i] = (a[i] % mod + mod) % mod;
    for (int i = 0; i &lt;= n; i++){
        scanf("%d", &amp;b[i]);
        b[i] = (b[i] % mod + mod) % mod;
        if(i) pre[i] = (pre[i - 1] + b[i]) % mod;
        else pre[i] = b[i];
    }
    scanf("%d", &amp;m);
    n &lt;&lt;= 1;
    for (int i = n / 2 + 1; i &lt;= n; i++) pre[i] = pre[i - 1];
    init();
    ntt(b, 1);
    doNTT();
    int mx = sqrt(n * log10(1.0 * n) / log10(2.0)) + 1;
    cnt = 0;
    for (int i = 1, op, l, r; i &lt;= m; i++){
        scanf("%d %d %d", &amp;op, &amp;l, &amp;r);
        if(op == 1){
            printf("%lld\n", (cal(r) - cal(l - 1) + mod) % mod);
        }else{
            pos[++cnt] = l;
            a[l] += (w[cnt] = r);
            a[l] = (a[l] % mod + mod) % mod;
            if(cnt == mx + 1){
                doNTT();
                cnt = 0;
            }
        }
    }

    return 0;
}
/**/</code></pre> 
<p>E.矩阵</p> 
<p><img alt="" height="378" src="https://images2.imgbox.com/1d/08/8Jr0IA4o_o.png" width="822"></p> 
<p>样例输入复制</p> 
<pre><code class="language-html">2
11
10</code></pre> 
<p>样例输出复制</p> 
<pre><code class="language-html">5</code></pre> 
<p>样例输入2</p> 
<pre><code>5
11100
11100
11110
11111
10000</code></pre> 
<h4>样例输出 2</h4> 
<pre><code>73</code></pre> 
<p>题解： </p> 
<p><img alt="" height="499" src="https://images2.imgbox.com/61/0c/29notMQ9_o.png" width="1200"></p> 
<p> 我写的复杂度似乎有点问题？ 再说吧，先把过的代码贴上来</p> 
<p>std：</p> 
<pre><code class="language-cpp">/**/
#pragma GCC optimize(3,"Ofast","inline")
#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;cmath&gt;
#include &lt;cctype&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;map&gt;
#include &lt;set&gt;
#include &lt;vector&gt;
#include &lt;string&gt;
#include &lt;stack&gt;
#include &lt;queue&gt;

typedef long long LL;
using namespace std;

const int maxn = 1005;

int n, a[maxn][maxn], up[maxn][maxn], sk[maxn], sum[maxn][maxn], l[maxn];
char s[maxn][maxn];

void init(){
    for (int i = 1; i &lt;= n; i++){
        for (int j = 1; j &lt;= n; j++){
            sum[i][j] = (i % j == 0 || j % i == 0);
        }
    }
    for (int i = 1; i &lt;= n; i++){
        for (int j = 1; j &lt;= n; j++){
            sum[i][j] += sum[i - 1][j] + sum[i][j - 1] - sum[i - 1][j - 1];
        }
    }
}

int cal(int n, int m){
    return sum[n][m];
}

int main()
{
    //freopen("in.txt", "r", stdin);
    //freopen("out.txt", "w", stdout);

    scanf("%d", &amp;n);
    init();
    for (int i = 1; i &lt;= n; i++){
        scanf("%s", s[i] + 1);
        for (int j = 1; j &lt;= n; j++) a[i][j] = s[i][j] - '0';
    }
    for (int j = 1; j &lt;= n; j++){
        for (int i = 1; i &lt;= n; i++){
            if(a[i][j] == 1) up[i][j] = up[i - 1][j] + 1;
            else up[i][j] = 0;
        }
    }
    LL ans = 0;
    for (int i = 1; i &lt;= n; i++){
        int top = 0;
        for (int j = 1; j &lt;= n; j++) l[j] = 0;
        for (int j = 1; j &lt;= n; j++){
            while(top &amp;&amp; up[i][sk[top]] &gt;= up[i][j]) top--;
            sk[++top] = j;
            l[j] = j - sk[top - 1];
            if(!up[i][j]) continue;
            int sum = l[j];
            for (int k = top - 1; k &gt;= 1; k--){
                ans += cal(up[i][sk[k]], sum += l[sk[k]]);
                ans -= cal(up[i][sk[k]], sum - l[sk[k]]);
            }
            ans += cal(up[i][j], l[j]);
            // printf("%d %d %d %lld\n", i, j, l[j], ans);
        }
    }
    printf("%lld\n", ans);

    return 0;
}
/*
7
1000000
1101110
1111111
0000000
0000000
0000000
0000000

5
00100
01110
11111
01110
00100
*/</code></pre> 
<p>F. 格子</p> 
<p><img alt="" height="432" src="https://images2.imgbox.com/7c/88/nO4xudTj_o.png" width="817"></p> 
<p>样例输入复制</p> 
<pre><code class="language-html">3 2</code></pre> 
<p>样例输出复制</p> 
<pre><code class="language-html">6</code></pre> 
<p>题解：</p> 
<p> <img alt="" height="266" src="https://images2.imgbox.com/36/d4/Nn2JKx2z_o.png" width="828"></p> 
<p>std：</p> 
<pre><code class="language-cpp">/**/
#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;cmath&gt;
#include &lt;cctype&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;map&gt;
#include &lt;set&gt;
#include &lt;vector&gt;
#include &lt;string&gt;
#include &lt;stack&gt;
#include &lt;queue&gt;

typedef long long LL;
using namespace std;

const long long mod = 998244353;
const int maxn = 2e6 + 5;

int n, m;
LL a[maxn];

LL poww(LL x, LL num){
    LL res = 1;
    while(num){
        if(num &amp; 1) res = res * x % mod;
        x = x * x % mod;
        num &gt;&gt;= 1;
    }
    return res;
}

LL C(int n, int m){
    return a[n] * poww(a[m] * a[n - m] % mod, mod - 2) % mod;
}

int main()
{
    //freopen("in.txt", "r", stdin);
    //freopen("out.txt", "w", stdout);

    a[0] = 1;
    for (int i = 1; i &lt; maxn; i++) a[i] = a[i - 1] * i % mod;
    scanf("%d %d", &amp;n, &amp;m);
    printf("%lld\n", C(n + m - 1, n - 1));

    return 0;
}
/**/</code></pre> 
<p> </p> 
<p>G. 宝藏</p> 
<p><img alt="" height="853" src="https://images2.imgbox.com/18/01/oepCYDR8_o.png" width="836"></p> 
<p>样例输入复制</p> 
<pre><code class="language-html">5 3
1 2 3 4 5
1 2 3
2 4 6
1 5 9</code></pre> 
<p>样例输出复制</p> 
<pre><code class="language-html">36
1638
183600</code></pre> 
<p>题解：</p> 
<p><img alt="" height="581" src="https://images2.imgbox.com/e5/d1/Qn9biAX6_o.png" width="825"></p> 
<p>std：</p> 
<pre><code class="language-cpp">/**/
#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;cmath&gt;
#include &lt;cctype&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;map&gt;
#include &lt;set&gt;
#include &lt;vector&gt;
#include &lt;string&gt;
#include &lt;stack&gt;
#include &lt;queue&gt;

typedef long long LL;
using namespace std;

const int maxn = 1e5 + 5;
const long long mod = 998244353;

int n, m, p[maxn][32], a[maxn];
LL pw2;

LL poww(LL x, LL num){
    LL res = 1;
    while(num){
        if(num &amp; 1) res = res * x % mod;
        x = x * x % mod;
        num &gt;&gt;= 1;
    }
    return res;
}

LL cal(int a, int b, int x){
    return poww(x + 1, a) * (poww(1 + x, b) - poww((1 - x + mod) % mod, b) + mod) % mod * pw2 % mod;
}

int main()
{
    //freopen("in.txt", "r", stdin);
    //freopen("out.txt", "w", stdout);

    pw2 = poww(2, mod - 2);
    scanf("%d %d", &amp;n, &amp;m);
    for (int i = 1; i &lt;= n; i++) scanf("%d", &amp;a[i]);
    for (int i = 1; i &lt;= n; i++){
        for (int j = 0; j &lt; 30; j++){
            p[i][j] = p[i - 1][j];
            if(1 &lt;&lt; j &amp; a[i]) p[i][j]++;
        }
    }
    for (int i = 1, l, r, x; i &lt;= m; i++){
        scanf("%d %d %d", &amp;l, &amp;r, &amp;x);
        LL ans = 0;
        for (int j = 0; j &lt; 30; j++){
            int b = p[r][j] - p[l - 1][j];
            int a = r - l + 1 - b;
            ans = (ans + 1LL * (1 &lt;&lt; j) * cal(a, b, x) % mod) % mod;
        }
        printf("%lld\n", ans);
    }

    return 0;
}
/**/</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/91db9a7933a5cb7f6a70f9b6b76b4e29/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">手把手带你解读源码，让你知道androidx库究竟是如何做到兼容低版本的？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ce74bb8916d88caa971253ae3eaf8b37/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">iphone闹钟自定义歌曲_快捷指令 | iPhone 关闭闹钟自动播放网易云音乐叫醒功能...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>