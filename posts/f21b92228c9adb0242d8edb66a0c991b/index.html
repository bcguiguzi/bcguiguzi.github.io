<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>v8引擎编译过程记录(保姆级教程)2023.7.22 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="v8引擎编译过程记录(保姆级教程)2023.7.22" />
<meta property="og:description" content="在windows下使用vs2022编译v8引擎的稳定版本(2023.7.22) 一开始我是参考：https://blog.csdn.net/qq_33958297/article/details/105331502，因为百度上一搜就是它
但是那篇博客讲得很迷，跟着做没有成功。后面踩坑无数，查了一大堆资料才总结出这套稳定可用的方法，希望能帮到后人。
这篇文章我在博客园、知乎也有同步发布。
0.环境配置 1.安装了在环境变量里面的Python310和Git，点我访问相关博客
2.安装有VS2022(可能需要安装上使用C&#43;&#43;的桌面开发、通用Windows平台开发)
1.下载v8项目源代码 V8已经停止在官方网站发布博客来公布最新稳定版本
我们需要访问谷歌的分支详情页
https://chromiumdash.appspot.com/branches
我选择了一年前的104版本
记下对应的v8版本，10.4-lkgr
找到一个合适的地方创建空文件夹v8，打开cmd，设定工作目录到v8文件夹
运行命令配置代理，根据代理工具的端口修改
git config --global http.proxy http://127.0.0.1:61021 git config --global https.proxy http://127.0.0.1:61021 netsh winhttp set proxy 127.0.0.1:61021 set HTTP_PROXY=http://127.0.0.1:61021 set HTTPS_PROXY=http://127.0.0.1:61021 仅仅运行上面的命令是不够的，还需要去系统设置或代理工具里面设置系统全局代理，也就是设置-&gt;网络和Internet-&gt;代理里面的代理
保持cmd窗口和代理程序不关闭，进入下一步
2.下载开发工具 访问
https://commondatastorage.googleapis.com/chrome-infra-docs/flat/depot_tools/docs/html/depot_tools_tutorial.html#_setting_up
找到Download链接下载包
新建一个depot_tools文件夹解压压缩包，然后把文件夹路径添加到PATH环境变量里面
需要确保Python已经安装，并且Python的安装目录在环境变量里面
注意：depot_tools要在所有其它路径之前。
3.下载配置项目 我们回到设置了代理的那个cmd窗口
如果你不小心关闭了，需要重新运行上面的命令设置代理
我们先设置一个环境变量，不然谷歌的工具不会下载Windows相关的工具
set DEPOT_TOOLS_WIN_TOOLCHAIN=0
确保你的代理设置完毕，在cmd运行以下命令拉取源代码
fetch v8
拉取比较费时间，哪怕你的代理能到10MB/s也要几分钟才能拉取完
如果你注意到进度一直都没动，说明可能你的PATH环境变量有问题
确保depot_tools在所有其它路径之前，然后重启Windows系统，再设置代理和set DEPOT_TOOLS_WIN_TOOLCHAIN=0，重新运行fetch v8拉取代码
(注意：关机再开机不等于重启)
拉取代码完成后，我们可以看到它在我们的v8文件夹里面又创建了一个v8文件夹
所以说先进入v8文件夹
cd v8
接着检出我们记录的10.4-lkgr版本
git checkout 10.4-lkgr
然后再次确保你的代理设置完毕，并且确保你的cmd执行过开头的环境变量设置命令，运行以下命令完成依赖处理
gclient sync -v" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/f21b92228c9adb0242d8edb66a0c991b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-25T23:00:36+08:00" />
<meta property="article:modified_time" content="2023-07-25T23:00:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">v8引擎编译过程记录(保姆级教程)2023.7.22</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="windowsvs2022v82023722_0"></a>在windows下使用vs2022编译v8引擎的稳定版本(2023.7.22)</h2> 
<p>一开始我是参考：https://blog.csdn.net/qq_33958297/article/details/105331502，因为百度上一搜就是它</p> 
<p>但是那篇博客讲得很迷，跟着做没有成功。后面踩坑无数，查了一大堆资料才总结出这套稳定可用的方法，希望能帮到后人。</p> 
<p>这篇文章我在博客园、知乎也有同步发布。</p> 
<h3><a id="0_6"></a>0.环境配置</h3> 
<p>1.安装了在环境变量里面的Python310和Git，<a href="https://blog.csdn.net/qq_21499983/article/details/131873250">点我访问相关博客</a></p> 
<p>2.安装有VS2022(可能需要安装上<code>使用C++的桌面开发</code>、<code>通用Windows平台开发</code>)</p> 
<h3><a id="1v8_12"></a>1.下载v8项目源代码</h3> 
<p>V8已经停止在官方网站发布博客来公布最新稳定版本</p> 
<p>我们需要访问谷歌的分支详情页</p> 
<p>https://chromiumdash.appspot.com/branches</p> 
<p><img src="https://images2.imgbox.com/c6/0e/os8bjRg3_o.jpg" alt="图片"></p> 
<p>我选择了一年前的104版本</p> 
<p><img src="https://images2.imgbox.com/e4/71/fn13U2xY_o.jpg" alt="图片"></p> 
<p>记下对应的v8版本，<code>10.4-lkgr</code></p> 
<p>找到一个合适的地方创建空文件夹<code>v8</code>，打开<code>cmd</code>，设定工作目录到v8文件夹</p> 
<p><img src="https://images2.imgbox.com/07/32/qalNW5j1_o.jpg" alt="图片"></p> 
<p>运行命令配置代理，根据代理工具的端口修改</p> 
<pre><code>git config --global http.proxy http://127.0.0.1:61021
git config --global https.proxy http://127.0.0.1:61021
netsh winhttp set proxy 127.0.0.1:61021
set HTTP_PROXY=http://127.0.0.1:61021
set HTTPS_PROXY=http://127.0.0.1:61021
</code></pre> 
<p>仅仅运行上面的命令是<code>不够</code>的，还需要去系统设置或代理工具里面设置<code>系统全局代理</code>，也就是<code>设置-&gt;网络和Internet-&gt;代理</code>里面的代理</p> 
<p>保持cmd窗口和代理程序不关闭，进入下一步</p> 
<h3><a id="2_46"></a>2.下载开发工具</h3> 
<p>访问</p> 
<p>https://commondatastorage.googleapis.com/chrome-infra-docs/flat/depot_tools/docs/html/depot_tools_tutorial.html#_setting_up</p> 
<p>找到Download链接下载包</p> 
<p><img src="https://images2.imgbox.com/4c/1a/aCsvU8rO_o.jpg" alt="图片"></p> 
<p>新建一个<code>depot_tools</code>文件夹解压压缩包，然后把文件夹路径添加到PATH环境变量里面</p> 
<blockquote> 
 <p>需要确保Python已经安装，并且Python的安装目录在环境变量里面</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/ca/e3/m3h4jliR_o.jpg" alt="图片"></p> 
<p>注意：<code>depot_tools</code>要在所有其它路径之前。</p> 
<h3><a id="3_64"></a>3.下载配置项目</h3> 
<p>我们回到设置了代理的那个cmd窗口</p> 
<p>如果你不小心关闭了，需要重新运行上面的命令设置代理</p> 
<p>我们先设置一个环境变量，不然谷歌的工具不会下载Windows相关的工具</p> 
<p><code>set DEPOT_TOOLS_WIN_TOOLCHAIN=0</code></p> 
<p>确保你的代理设置完毕，在cmd运行以下命令拉取源代码</p> 
<p><code>fetch v8</code></p> 
<p>拉取比较费时间，哪怕你的代理能到10MB/s也要几分钟才能拉取完</p> 
<blockquote> 
 <p>如果你注意到进度一直都没动，说明可能你的PATH环境变量有问题<br> 确保<code>depot_tools</code>在所有其它路径之前，然后重启Windows系统，再设置代理和<code>set DEPOT_TOOLS_WIN_TOOLCHAIN=0</code>，重新运行<code>fetch v8</code>拉取代码<br> (注意：关机再开机不等于重启)</p> 
</blockquote> 
<p>拉取代码完成后，我们可以看到它在我们的v8文件夹里面又创建了一个v8文件夹</p> 
<p><img src="https://images2.imgbox.com/c6/5b/9lMT3CxW_o.jpg" alt="图片"></p> 
<p>所以说先进入v8文件夹</p> 
<p><code>cd v8</code></p> 
<p>接着检出我们记录的<code>10.4-lkgr</code>版本</p> 
<p><code>git checkout 10.4-lkgr</code></p> 
<p>然后再次确保你的代理设置完毕，并且确保你的cmd执行过开头的环境变量设置命令，运行以下命令完成依赖处理</p> 
<p><code>gclient sync -v</code></p> 
<p>这一步可能会下载一些依赖，没有看到报错就说明成功了，我们进入下一步</p> 
<blockquote> 
 <p>如果这一步报错，八成是忘记了设置环境变量<code>set DEPOT_TOOLS_WIN_TOOLCHAIN=0</code></p> 
</blockquote> 
<h3><a id="4ninja_104"></a>4.编译安装ninja</h3> 
<p>找一个合适的地方，然后git克隆ninja项目，我是直接在E盘根目录搞</p> 
<p><code>git clone https://github.com/ninja-build/ninja.git</code></p> 
<p><img src="https://images2.imgbox.com/36/15/EgW0uFUZ_o.jpg" alt="图片"></p> 
<p>然后进入ninja项目文件夹，调用git检出release</p> 
<pre><code>cd ninja
git checkout release
</code></pre> 
<p>接下来打开vs的开发人员命令提示符<code>Developer Command Prompt for VS 2022</code></p> 
<p><img src="https://images2.imgbox.com/13/44/DwSNGZv2_o.jpg" alt="图片"></p> 
<p>如下图，进入ninja项目文件夹，运行下面的命令编译ninja</p> 
<p><code>python configure.py --bootstrap</code></p> 
<p><img src="https://images2.imgbox.com/ea/67/Ltns7nMu_o.jpg" alt="图片"></p> 
<p>运行完成后就能看到<code>ninja.exe</code>在ninja项目文件夹里面</p> 
<p>直接把它移动到之前下载解压的<code>depot_tools</code>目录下</p> 
<p><img src="https://images2.imgbox.com/46/09/bHozadyX_o.jpg" alt="图片"></p> 
<h3><a id="5v8_x64_release_135"></a>5.编译v8 x64 release动态库</h3> 
<p>我们回到cmd窗口，先cd到<code>v8\v8</code>文件夹下</p> 
<p><img src="https://images2.imgbox.com/84/ff/glCj0qVZ_o.jpg" alt="图片"></p> 
<p>现在我们不需要代理，先去关闭系统全局代理，然后运行下面的命令关闭git和命令行的代理</p> 
<pre><code>git config --global --unset http.proxy
git config --global --unset https.proxy
netsh winhttp reset proxy
set HTTP_PROXY=
set HTTPS_PROXY=
</code></pre> 
<p>再次设置环境变量，防止自己不小心关闭cmd窗口忘记了设置</p> 
<p><code>set DEPOT_TOOLS_WIN_TOOLCHAIN=0</code></p> 
<p>设置编译信息，动态库编译模式</p> 
<p><code>python3 tools\dev\v8gen.py x64.release -vv -- is_component_build=true v8_static_library=false</code></p> 
<p>我们可以看到报错了</p> 
<p><img src="https://images2.imgbox.com/c2/78/DcRtEEvr_o.jpg" alt="图片"></p> 
<p>提示<code>You must install Windows 10 SDK version 10.0.20348.0 including the "Debugging Tools for Windows" feature.</code></p> 
<p>所以说我们需要安装Windows 10 SDK，打开<code>Visual Studio Installer</code></p> 
<p><img src="https://images2.imgbox.com/7a/ac/d7iTcYKN_o.jpg" alt="图片"></p> 
<p>点击<code>修改</code></p> 
<p><img src="https://images2.imgbox.com/7b/f1/j2PqAfAO_o.jpg" alt="图片"></p> 
<p>选择<code>单个组件</code>，搜索<code>Windows 10 SDK</code>，勾上<code>报错信息提示的版本</code>，点击<code>修改</code></p> 
<blockquote> 
 <p>如果你这里已经是勾上的，那么直接关闭<code>Visual Studio Installer</code>，进入下一步</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/4b/3f/lgNRziVo_o.jpg" alt="图片"></p> 
<p>完成后关闭<code>Visual Studio Installer</code>，在Windows搜索栏搜索<code>添加或者删除程序</code></p> 
<p><img src="https://images2.imgbox.com/61/9e/XF8EvFSn_o.jpg" alt="图片"></p> 
<p>搜索<code>Windows Software Development Kit</code>.找到我们的版本，点击<code>修改</code></p> 
<p><img src="https://images2.imgbox.com/87/68/CPV1pBuv_o.jpg" alt="图片"></p> 
<p>选择<code>Change</code>，然后点击<code>Next</code></p> 
<p><img src="https://images2.imgbox.com/de/2f/T5c5Olnt_o.jpg" alt="图片"></p> 
<p>勾上<code>Debugging Tools for Windows</code>，点击<code>Change</code></p> 
<p><img src="https://images2.imgbox.com/a7/90/SfEL3E9X_o.jpg" alt="图片"></p> 
<p>完成后关闭窗口，回到cmd窗口，重新生成编译配置</p> 
<p><code>python3 tools\dev\v8gen.py x64.release -vv -- is_component_build=true v8_static_library=false</code></p> 
<p>配置生成成功了</p> 
<p><img src="https://images2.imgbox.com/88/09/SDpjNEsc_o.jpg" alt="图片"></p> 
<p>使用ninja编译</p> 
<p><code>ninja -C out.gn\x64.release</code></p> 
<p>然后这个过程CPU会吃满，最好不要干其它事情。</p> 
<p>跑完要个十几分钟，耐心等待。</p> 
<p><img src="https://images2.imgbox.com/5e/9a/9d8Cf66P_o.jpg" alt="图片"></p> 
<p>跑完后我们进入<code>v8\v8\out.gn\x64.release\</code>文件夹</p> 
<p>往下翻能找到<code>d8.exe</code>，打开看看正不正常</p> 
<p><img src="https://images2.imgbox.com/51/2a/uqbR1tcP_o.jpg" alt="图片"></p> 
<p><img src="https://images2.imgbox.com/89/d5/QSJcy1B1_o.jpg" alt="图片"></p> 
<p>随便输入一串js代码看看结果</p> 
<p><code>console.log("test"+4*8),5*7;</code></p> 
<p><img src="https://images2.imgbox.com/88/46/dihJsg0O_o.jpg" alt="图片"></p> 
<p>输出<code>test32</code>，返回<code>35</code>，说明编译的很成功</p> 
<p>在别的地方创建个文件夹，先复制出运行时：</p> 
<pre><code>d8.exe
icudtl.dat
icui18n.dll
icuuc.dll
libc++.dll
snapshot_blob.bin
v8.dll
v8_libbase.dll
v8_libplatform.dll
zlib.dll
</code></pre> 
<p>这就是动态版本v8程序运行所需的dll，运行<code>d8.exe</code>发现可以正常运行(路径包含中文会导致无法双击运行)</p> 
<p><img src="https://images2.imgbox.com/b5/e8/mAaPy5TQ_o.jpg" alt="图片"></p> 
<p>注：d8.exe仅供测试，它并不是运行v8所必须的</p> 
<p>我们如果用动态方法调用v8，还需要dll文件对应的lib，所以说再创建个lib文件夹，复制出以下文件：</p> 
<pre><code>v8.dll.lib
v8_libbase.dll.lib
v8_libplatform.dll.lib
</code></pre> 
<h3><a id="5v8_x64_release_258"></a>5.编译v8 x64 release静态库</h3> 
<p>回到<code>v8\v8</code>，我们删除<code>out.gn</code>文件夹</p> 
<p>如果之前的cmd被关闭了，运行<code>set DEPOT_TOOLS_WIN_TOOLCHAIN=0</code>设置环境变量</p> 
<p>在<code>v8\v8</code>下运行以下命令生成静态编译配置</p> 
<p><code>python3 tools\dev\v8gen.py x64.release -- v8_monolithic=true v8_use_external_startup_data=false use_custom_libcxx=false is_component_build=false treat_warnings_as_errors=false v8_symbol_level=0 is_clang=false</code></p> 
<p>使用ninja编译</p> 
<p><code>ninja -C out.gn\x64.release v8_monolith</code></p> 
<p>和动态库编译一样，这个过程也耗时，耐心等待编译完成</p> 
<p>期间会出现很多<code>注意：包含文件：</code>的提示，忽略即可</p> 
<p>跑完后我们进入<code>v8\v8\out.gn\x64.release\obj</code>文件夹</p> 
<p>仔细寻找可以看到<code>v8_monolith.lib</code>，这个就是我们要的lib静态库了，大约280MB</p> 
<h3><a id="6v8_x64_debug_280"></a>6.编译v8 x64 debug相关库</h3> 
<h4><a id="_282"></a>动态版本</h4> 
<p>回到<code>v8\v8</code>，我们删除<code>out.gn</code>文件夹</p> 
<p>如果之前的cmd被关闭了，运行<code>set DEPOT_TOOLS_WIN_TOOLCHAIN=0</code>设置环境变量</p> 
<p>生成配置</p> 
<p><code>python3 tools\dev\v8gen.py x64.debug -vv -- is_component_build=true v8_static_library=false</code></p> 
<p>编译</p> 
<p><code>ninja -C out.gn\x64.debug</code></p> 
<p>在别的地方创建个文件夹，复制出以下文件作为运行时：</p> 
<pre><code>d8.exe
icudtl.dat
icui18n.dll
icuuc.dll
libc++.dll
snapshot_blob.bin
v8.dll
v8_libbase.dll
v8_libplatform.dll
zlib.dll
</code></pre> 
<p>复制出以下文件作为lib：</p> 
<pre><code>v8.dll.lib
v8_libbase.dll.lib
v8_libplatform.dll.lib
</code></pre> 
<p>运行<code>d8.exe</code>发现正常运行(路径包含中文会导致无法双击运行)</p> 
<p>注：d8.exe仅供测试，它并不是运行v8所必须的</p> 
<h4><a id="_323"></a>静态版本</h4> 
<p>回到<code>v8\v8</code>，我们删除<code>out.gn</code>、<code>out</code>文件夹</p> 
<p>如果之前的cmd被关闭了，运行<code>set DEPOT_TOOLS_WIN_TOOLCHAIN=0</code>设置环境变量</p> 
<p>生成Debug版本需要另一个方法来配置</p> 
<p>先运行</p> 
<p><code>gn args out/x64.debug</code></p> 
<p>这个时候会自动弹出一个记事本，我们不要关闭它</p> 
<p><img src="https://images2.imgbox.com/41/2a/ZClexvHl_o.jpg" alt="图片"></p> 
<p>往记事本里面输入这些</p> 
<pre><code>v8_monolithic=true 
v8_use_external_startup_data=false 
use_custom_libcxx=false 
is_component_build=false 
treat_warnings_as_errors=false 
v8_symbol_level=0 
is_clang=false 
is_debug=true
</code></pre> 
<p>输入后配置文件的内容应该和下图一样</p> 
<p><img src="https://images2.imgbox.com/52/30/OJyLHI8J_o.jpg" alt="图片"></p> 
<p>然后我们Ctrl+S保存，然后关闭记事本窗口</p> 
<p>等待一会，可以看到进度跑完了</p> 
<p><img src="https://images2.imgbox.com/cb/4d/Yzdl5o7e_o.jpg" alt="图片"></p> 
<p>用下面的命令编译</p> 
<p><code>ninja -C out/x64.debug v8_monolith</code></p> 
<p>和动态库编译一样，这个过程也耗时，耐心等待编译完成</p> 
<p>期间会出现很多<code>注意：包含文件：</code>的提示，忽略即可</p> 
<p>跑完后我们进入<code>v8\v8\out\x64.debug\obj</code>文件夹</p> 
<p>仔细寻找可以看到<code>v8_monolith.lib</code>，这个就是我们要的lib静态库了，大约450MB</p> 
<h3><a id="6v8_ia32_374"></a>6.编译v8 ia32相关库</h3> 
<blockquote> 
 <p>注：ia32又称x86，也就是32位版本</p> 
</blockquote> 
<h4><a id="release_378"></a>①release版本</h4> 
<h5><a id="_380"></a>动态</h5> 
<p>像前面一样，回到<code>v8\v8</code>，删除<code>out.gn</code>、<code>out</code>文件夹</p> 
<p>如果之前的cmd被关闭了，运行<code>set DEPOT_TOOLS_WIN_TOOLCHAIN=0</code>设置环境变量</p> 
<p>运行命令生成配置</p> 
<p><code>python3 tools\dev\v8gen.py ia32.release -vv -- is_component_build=true v8_static_library=false</code></p> 
<p>运行命令编译</p> 
<p><code>ninja -C out.gn\ia32.release</code></p> 
<p>跑完后我们进入<code>v8\v8\out.gn\ia32.release\</code>文件夹</p> 
<p>在别的地方创建个文件夹，复制出以下文件作为运行时：</p> 
<pre><code>d8.exe
icudtl.dat
icui18n.dll
icuuc.dll
libc++.dll
snapshot_blob.bin
v8.dll
v8_libbase.dll
v8_libplatform.dll
zlib.dll
</code></pre> 
<p>复制出以下文件作为lib：</p> 
<pre><code>v8.dll.lib
v8_libbase.dll.lib
v8_libplatform.dll.lib
</code></pre> 
<p>运行<code>d8.exe</code>发现正常运行(路径包含中文会导致无法双击运行)</p> 
<p>注：d8.exe仅供测试，它并不是运行v8所必须的</p> 
<h5><a id="_423"></a>静态</h5> 
<p>像前面一样，回到<code>v8\v8</code>，删除<code>out.gn</code>、<code>out</code>文件夹</p> 
<p>如果之前的cmd被关闭了，运行<code>set DEPOT_TOOLS_WIN_TOOLCHAIN=0</code>设置环境变量</p> 
<p>运行命令生成配置</p> 
<p><code>python3 tools\dev\v8gen.py ia32.release -- v8_monolithic=true v8_use_external_startup_data=false use_custom_libcxx=false is_component_build=false treat_warnings_as_errors=false v8_symbol_level=0 is_clang=false</code></p> 
<p>使用ninja编译</p> 
<p><code>ninja -C out.gn\ia32.release v8_monolith</code></p> 
<p>期间会出现很多<code>注意：包含文件：</code>的提示，忽略即可</p> 
<p>跑完后我们进入<code>v8\v8\out.gn\ia32.release\obj</code>文件夹</p> 
<p>仔细寻找可以看到<code>v8_monolith.lib</code>，这个就是我们要的lib静态库了，大约160MB</p> 
<h4><a id="debug_443"></a>②debug版本</h4> 
<h5><a id="_445"></a>动态</h5> 
<p>像前面一样，回到<code>v8\v8</code>，删除<code>out.gn</code>、<code>out</code>文件夹</p> 
<p>如果之前的cmd被关闭了，运行<code>set DEPOT_TOOLS_WIN_TOOLCHAIN=0</code>设置环境变量</p> 
<p>生成配置</p> 
<p><code>python3 tools\dev\v8gen.py ia32.debug -vv -- is_component_build=true v8_static_library=false</code></p> 
<p>编译</p> 
<p><code>ninja -C out.gn\ia32.debug</code></p> 
<p>在别的地方创建个文件夹，复制出以下文件作为运行时：</p> 
<pre><code>d8.exe
icudtl.dat
icui18n.dll
icuuc.dll
libc++.dll
snapshot_blob.bin
v8.dll
v8_libbase.dll
v8_libplatform.dll
zlib.dll
</code></pre> 
<p>复制出以下文件作为lib：</p> 
<pre><code>v8.dll.lib
v8_libbase.dll.lib
v8_libplatform.dll.lib
</code></pre> 
<p>运行<code>d8.exe</code>发现正常运行(路径包含中文会导致无法双击运行)</p> 
<p>注：d8.exe仅供测试，它并不是运行v8所必须的</p> 
<h5><a id="_486"></a>静态</h5> 
<p>像前面一样，回到<code>v8\v8</code>，删除<code>out.gn</code>、<code>out</code>文件夹</p> 
<p>如果之前的cmd被关闭了，运行<code>set DEPOT_TOOLS_WIN_TOOLCHAIN=0</code>设置环境变量</p> 
<p>生成Debug版本用前面讲<code>x64 静态Debug版本</code>时提到的另一个方法来配置</p> 
<p>先运行</p> 
<p><code>gn args out/ia32.debug</code></p> 
<p>这个时候会自动弹出一个记事本，往记事本里面输入这些</p> 
<pre><code>v8_monolithic=true 
v8_use_external_startup_data=false 
use_custom_libcxx=false 
is_component_build=false 
treat_warnings_as_errors=false 
v8_symbol_level=0 
is_clang=false 
is_debug=true
target_cpu = "x86"
</code></pre> 
<p>然后Ctrl+S保存，关闭记事本窗口</p> 
<p>等到进度跑完后，用下面的命令编译</p> 
<p><code>ninja -C out/ia32.debug v8_monolith</code></p> 
<p>期间会出现很多<code>注意：包含文件：</code>的提示，忽略即可</p> 
<p>跑完后我们进入<code>v8\v8\out\ia32.debug\obj</code>文件夹</p> 
<p>仔细寻找可以看到<code>v8_monolith.lib</code>，这个就是我们要的lib静态库了，大约240MB</p> 
<h3><a id="7_524"></a>7.结尾</h3> 
<p>本人是编程小白，这个V8项目真的一步一个坑，查了无数资料一个个尝试才成功，V8编译真麻烦</p> 
<p>我自己每一样都编译了一份，放百度网盘了：</p> 
<p>链接：https://pan.baidu.com/s/1MIkq82fH8K7TNQoRNrpCXQ?pwd=62kz</p> 
<p>提取码：62kz</p> 
<p>参考资料：</p> 
<p>https://blog.csdn.net/xray2/article/details/120595202</p> 
<p>https://blog.csdn.net/slc1112/article/details/115328904</p> 
<p>https://blog.csdn.net/u011760195/article/details/109941227</p> 
<p>https://blog.csdn.net/weixin_43939128/article/details/104678515</p> 
<p>https://blog.csdn.net/qq_33958297/article/details/105331502</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7beea22173a629cdfa872af558ff32c4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于同创logos2的国产FPGA加速器与DMA设计与实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/16a7402c781cf71c7f313e88c92fd291/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue 使用qrcodejs2插件实现二维码生成及二维码图片下载（小白篇）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>