<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ansible之管理变量和事实（三） - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ansible之管理变量和事实（三）" />
<meta property="og:description" content="文章目录 1 管理变量1.1 ansible 变量简介1.2 命名变量 2 定义变量3 playbook 中的变量3.1.常见方式：在 playbook 开头的 vars 块中3.2 在外部文件定义 playbook 变量3.3 定义变量和使用变量 3.4 主机变量和组变量3.4.1 定义主机变量和组变量3.5 使用已注册变量捕获命令输出3.6 管理变量的练习 4 管理机密4.1 介绍 ansible vault4.2 创建加密文件4.3 创建加密文件同时将密码保存4.4查看加密文件4.5 编辑现有的加密文件4.6 加密现有的文件4.7 解密4.8 更改加密文件密码4.9 运行加密的 playbook，没有密码则报错 5 管理事实5.1 描述 ansible 事实5.2 查看主机信息5.3 再将事实替换为动态的值5.4 使用 setup 模块显示所有事实信息5.5 关闭事实收集，开提升执行速度5.6 创建自定义事实5.7 使用魔法变量 6 练习6.1 创建自定义变量6.2 使用基本身份认证的 httpd6.2.1 创建基本文件6.2.2 创建剧本6.2.3 创建加密文件6.2.4 创建 files 目录6.2.5 拷贝文件到files目录6.2.6 修改workstation的发布目录6.2.7 交互式输入密码，进行语法检测6.2.8 执行6.2.9 验证是否成功6.2.10 总结 将 playbook 中的某些值使用变量代替，从而 简化 playbook 的编写 1 管理变量 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/76634c18d7cb935f6200fe3a5b9c3fd0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-04-24T11:04:58+08:00" />
<meta property="article:modified_time" content="2020-04-24T11:04:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ansible之管理变量和事实（三）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1__3" rel="nofollow">1 管理变量</a></li><li><ul><li><a href="#11_ansible__4" rel="nofollow">1.1 ansible 变量简介</a></li><li><a href="#12__9" rel="nofollow">1.2 命名变量</a></li></ul> 
  </li><li><a href="#2__15" rel="nofollow">2 定义变量</a></li><li><a href="#3_playbook__23" rel="nofollow">3 playbook 中的变量</a></li><li><ul><li><a href="#31_playbook__vars__25" rel="nofollow">3.1.常见方式：在 playbook 开头的 vars 块中</a></li><li><a href="#32__playbook__28" rel="nofollow">3.2 在外部文件定义 playbook 变量</a></li><li><a href="#33__34" rel="nofollow">3.3 定义变量和使用变量</a></li></ul> 
  </li><li><a href="#34__39" rel="nofollow">3.4 主机变量和组变量</a></li><li><a href="#341__44" rel="nofollow">3.4.1 定义主机变量和组变量</a></li><li><a href="#35__89" rel="nofollow">3.5 使用已注册变量捕获命令输出</a></li><li><ul><li><a href="#36__95" rel="nofollow">3.6 管理变量的练习</a></li></ul> 
  </li><li><a href="#4__108" rel="nofollow">4 管理机密</a></li><li><ul><li><a href="#41__ansible_vault_110" rel="nofollow">4.1 介绍 ansible vault</a></li><li><a href="#42__114" rel="nofollow">4.2 创建加密文件</a></li><li><a href="#43__119" rel="nofollow">4.3 创建加密文件同时将密码保存</a></li><li><a href="#44_123" rel="nofollow">4.4查看加密文件</a></li><li><a href="#45__126" rel="nofollow">4.5 编辑现有的加密文件</a></li><li><a href="#46__132" rel="nofollow">4.6 加密现有的文件</a></li><li><a href="#47__135" rel="nofollow">4.7 解密</a></li><li><a href="#48__140" rel="nofollow">4.8 更改加密文件密码</a></li><li><a href="#49__playbook_144" rel="nofollow">4.9 运行加密的 playbook，没有密码则报错</a></li></ul> 
  </li><li><a href="#5__163" rel="nofollow">5 管理事实</a></li><li><ul><li><a href="#51__ansible__165" rel="nofollow">5.1 描述 ansible 事实</a></li><li><a href="#52__166" rel="nofollow">5.2 查看主机信息</a></li><li><a href="#53__174" rel="nofollow">5.3 再将事实替换为动态的值</a></li><li><a href="#54__setup__183" rel="nofollow">5.4 使用 setup 模块显示所有事实信息</a></li><li><a href="#55__189" rel="nofollow">5.5 关闭事实收集，开提升执行速度</a></li><li><a href="#56__194" rel="nofollow">5.6 创建自定义事实</a></li><li><a href="#57__207" rel="nofollow">5.7 使用魔法变量</a></li></ul> 
  </li><li><a href="#6__219" rel="nofollow">6 练习</a></li><li><ul><li><a href="#61__221" rel="nofollow">6.1 创建自定义变量</a></li><li><a href="#62__httpd_244" rel="nofollow">6.2 使用基本身份认证的 httpd</a></li><li><ul><li><a href="#621__245" rel="nofollow">6.2.1 创建基本文件</a></li><li><a href="#622__247" rel="nofollow">6.2.2 创建剧本</a></li><li><a href="#623__254" rel="nofollow">6.2.3 创建加密文件</a></li><li><a href="#624__files__259" rel="nofollow">6.2.4 创建 files 目录</a></li><li><a href="#625_files_261" rel="nofollow">6.2.5 拷贝文件到files目录</a></li><li><a href="#626_workstation_264" rel="nofollow">6.2.6 修改workstation的发布目录</a></li><li><a href="#627__267" rel="nofollow">6.2.7 交互式输入密码，进行语法检测</a></li><li><a href="#628__270" rel="nofollow">6.2.8 执行</a></li><li><a href="#629__272" rel="nofollow">6.2.9 验证是否成功</a></li><li><a href="#6210__279" rel="nofollow">6.2.10 总结</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<br> 将 playbook 中的某些值使用变量代替，从而 
<br> 简化 playbook 的编写 
<p></p> 
<h2><a id="1__3"></a>1 管理变量</h2> 
<h3><a id="11_ansible__4"></a>1.1 ansible 变量简介</h3> 
<p>变量可能包含下面这些值：</p> 
<blockquote> 
 <p>要创建的用户、 要安装的软件包、 要重启的服务、 要删除的文件、 要从互联网检索的文档</p> 
</blockquote> 
<h3><a id="12__9"></a>1.2 命名变量</h3> 
<p>变量名称<code>必须以字母开头，并且只能含有字母、数字和下划线</code><br> 错误 正确<br> web server web_server<br> westos.file remote_file<br> 1st file file1</p> 
<h2><a id="2__15"></a>2 定义变量</h2> 
<p>三个范围级别</p> 
<blockquote> 
 <p>全局范围：从命令行或 ansible 配置设置的变量（最低）<br> play 范围：在 play 和相关结构中设置的变量（最高）<br> 主机范围：由清单、事实收集或注册的任务，在主机组和个别主机上设置的变量</p> 
</blockquote> 
<p><strong>’如果多个级别上定义了相同名称的变量，优先采用级别最高的变量，窄范围优先于广范围’</strong></p> 
<h2><a id="3_playbook__23"></a>3 playbook 中的变量</h2> 
<h3><a id="31_playbook__vars__25"></a>3.1.常见方式：在 playbook 开头的 vars 块中</h3> 
<p>vim vars.yml<br> <img src="https://images2.imgbox.com/64/10/Op5j0ddk_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="32__playbook__28"></a>3.2 在外部文件定义 playbook 变量</h3> 
<p>vim vars.yml<br> <img src="https://images2.imgbox.com/57/41/cZwPyPK0_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/02/42/2sXRgH8i_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/be/fb/eONE2Qqj_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bb/fa/TTd5WVYo_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="33__34"></a>3.3 定义变量和使用变量</h3> 
<p><img src="https://images2.imgbox.com/26/ad/znFgSNQg_o.png" alt="在这里插入图片描述"><br> <mark>注意：当变量用作开始一个值的第一元素时，必须使用引号，否则会报错’</mark></p> 
<h2><a id="34__39"></a>3.4 主机变量和组变量</h2> 
<p>直接应用于主机的清单变量分为两大类：<br> 1.主机变量：应用于特定主机<br> 2.组变量：应用于一个主机组或一组主机组中的所有主机<br> 主机变量优先于组变量，但是 playbook 中定义的变量比这两者更高</p> 
<h2><a id="341__44"></a>3.4.1 定义主机变量和组变量</h2> 
<p><strong>—方法一（比较旧，不建议采用）</strong>：</p> 
<pre><code class="prism language-powershell">定义 server1<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com 的 ansible_user 主机变量:
<span class="token namespace">[webservers]</span>
server1<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com ansible_user=student
webservers<span class="token punctuation">]</span>
server1<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com ansible_user=student
定义 dbservers 主机组的 user 组变量：
<span class="token namespace">[dbserver]</span>
dbserver1<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com
dbserver2<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com
<span class="token namespace">[dbservers:vars]</span>
user=student
定义嵌套组 user 变量：
<span class="token namespace">[servers1]</span>
node1<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com
node2<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com
<span class="token namespace">[servers2]</span>
node3<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com
node4<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com
<span class="token namespace">[servers:children]</span>
servers1
servers2
<span class="token namespace">[servers:vars]</span>
user=student
<span class="token string">'这种做法使的清单文件难以处理，在同一文件中混合提供主机和变量信息，语法也过时'</span>
</code></pre> 
<p>如：<br> <img src="https://images2.imgbox.com/42/73/4bvUDtd5_o.png" alt="在这里插入图片描述"><br> <strong>—方法二：使用目录填充主机和组变量</strong></p> 
<blockquote> 
 <p>定义主机和主机组变量的首选做法时与清单文件或目录相同的工作目录中，创建 group_vars 和 host_vars<br> 两个目录，这两个目录分别包含用于定义组变量和主机变量的文件 创建 group_vars/servers 的 YAML 文件，设置变量为值：<br> user: student 同样需要在 host_vars 目录中创建名称与主机匹配的文件来存放主机变量<br> <strong>所以一个项目目录中包含： ansible.cfg、group_vars、host_vars、inventory、playbook.yml</strong><br> #从命令行覆盖变量 清单变量可以被 playbook 中设置的变量覆盖 两者又可通过命令行参数覆盖<br> #使用数组作为变量</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/73/7e/g4tS8yc4_o.png" alt="在这里插入图片描述"><br> 访问：<br> <img src="https://images2.imgbox.com/1f/0a/cE4g1Ylf_o.png" alt="在这里插入图片描述"><br> 变量被定义为 python 字典，可以使用替代语法：<br> <img src="https://images2.imgbox.com/a1/92/mAocb6ir_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="35__89"></a>3.5 使用已注册变量捕获命令输出</h2> 
<p>管理员可以使用 register 语句捕获命令输出<br> <img src="https://images2.imgbox.com/bb/df/UQsBbkXr_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/cc/99/nfnUQUig_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6d/9b/XIehHh4J_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="36__95"></a>3.6 管理变量的练习</h3> 
<p>创建 playbook，来安装 apache 并开启，使可被访问，playbook 查询 web 服务器并确认它<br> 已经设置好并在运行<br> <img src="https://images2.imgbox.com/04/e6/DrIimb7A_o.png" alt="在这里插入图片描述"><br> vim playbook.yml</p> 
<p><img src="https://images2.imgbox.com/93/c0/4MZZEfAy_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ce/de/8gIr53Fn_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/12/b8/DwV1wpFW_o.png" alt="在这里插入图片描述"><br> #检测语法<br> ansible-playbook --syntax-check playbook.yml<br> #运行<br> <img src="https://images2.imgbox.com/33/7f/1BprxA4n_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="4__108"></a>4 管理机密</h2> 
<p>目标：使用 ansible vault 加密敏感变量，并运行 vault 加密变量文件的 playbook</p> 
<h3><a id="41__ansible_vault_110"></a>4.1 介绍 ansible vault</h3> 
<p>ansible 可能需要访问密码或者 api 密钥等敏感数据，以便配置主机。<br> 加密解密工具：ansible-vault 命令<br> ‘ansible vault 不实施自有的加密函数，而使用外部 python 工具集’</p> 
<h3><a id="42__114"></a>4.2 创建加密文件</h3> 
<p>方法：ansible-vault create filename<br> <img src="https://images2.imgbox.com/a6/8f/oLnriK3S_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="43__119"></a>4.3 创建加密文件同时将密码保存</h3> 
<p><img src="https://images2.imgbox.com/70/f0/yDWmVUTr_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="44_123"></a>4.4查看加密文件</h3> 
<p><img src="https://images2.imgbox.com/56/4d/3e0ou56b_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="45__126"></a>4.5 编辑现有的加密文件</h3> 
<p><strong>原理：将文件解密为一个临时文件，并编辑；保存时，复制内容并删除临时文件<br> 'edit 命令始终重写文件，因此只有在更改文件时使用，查看尽量使用 view’</strong><br> <img src="https://images2.imgbox.com/2d/64/wDfT4ZPq_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="46__132"></a>4.6 加密现有的文件</h3> 
<p><strong>方法：ansible-vault encrypt filename #filename 参数可以是多个</strong><br> <img src="https://images2.imgbox.com/0b/12/tyPVsdt7_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="47__135"></a>4.7 解密</h3> 
<p><img src="https://images2.imgbox.com/89/8f/lfLa6LXx_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4a/b9/AYeIaOn8_o.png" alt="在这里插入图片描述"></p> 
<p>'可以使用–output=filename 将加密文件保存为新的名称，使用此参数时输入文件只能是一个</p> 
<h3><a id="48__140"></a>4.8 更改加密文件密码</h3> 
<p>方法：<code>ansible-vault rekey filename</code><br> <img src="https://images2.imgbox.com/99/a0/VZ6B22zd_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="49__playbook_144"></a>4.9 运行加密的 playbook，没有密码则报错</h3> 
<pre><code>要交互式提供密码
ansible-playbook --vault-id @prompt user.yml
</code></pre> 
<p><img src="https://images2.imgbox.com/fc/3a/0olzbQnF_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/ce/22/22AhMQ5J_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>‘2.4 之前的 ansible，使用–ask-vault-pass 提供交互式密码’<br> #也可以将秘密存在文件中（注意使用文件系统权限对文件进行保护）</p> 
</blockquote> 
<pre><code>[root@workstation wsp]# ansible-playbook --vault-password-file=password user.yml
</code></pre> 
<h2><a id="5__163"></a>5 管理事实</h2> 
<p>事实包括：主机名称、内核版本、网络借口、IP 地址等</p> 
<h3><a id="51__ansible__165"></a>5.1 描述 ansible 事实</h3> 
<h3><a id="52__166"></a>5.2 查看主机信息</h3> 
<pre><code>[root@workstation wsp]# cat fact.yml
</code></pre> 
<p><img src="https://images2.imgbox.com/0f/d8/N7GPAASY_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e3/c6/KJQui0nY_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="53__174"></a>5.3 再将事实替换为动态的值</h3> 
<p><img src="https://images2.imgbox.com/ac/82/FXVnm5oE_o.png" alt="在这里插入图片描述"><br> #使用字典的方式查询值<br> <img src="https://images2.imgbox.com/42/f3/cVflm4kS_o.png" alt="在这里插入图片描述"><br> 结果：<br> <img src="https://images2.imgbox.com/a3/c6/xmfcDMQe_o.png" alt="在这里插入图片描述"></p> 
<p><strong>ansible 事实作为变量注入</strong></p> 
<h3><a id="54__setup__183"></a>5.4 使用 setup 模块显示所有事实信息</h3> 
<pre><code>[root@workstation ~]# ansible servera.lab.example.com -m setup
</code></pre> 
<h3><a id="55__189"></a>5.5 关闭事实收集，开提升执行速度</h3> 
<p><img src="https://images2.imgbox.com/61/8a/cM1n4bkH_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0a/a1/y3zoAZjc_o.png" alt="在这里插入图片描述"><br> 禁用后便不采集：<br> <img src="https://images2.imgbox.com/83/fc/Z8980zyx_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="56__194"></a>5.6 创建自定义事实</h3> 
<p>可以使用 INI 格式或者 JSON 格式：<br> <img src="https://images2.imgbox.com/42/cd/5ieXKjq6_o.png" alt="在这里插入图片描述"></p> 
<p><strong>’自定义格式不能使用 ymal 格式，使用最为接近的 json 最好’</strong></p> 
<p><strong>建立文件：必须以.fact 结尾：</strong></p> 
<p><img src="https://images2.imgbox.com/7c/9c/7s6AbgOX_o.png" alt="在这里插入图片描述"><br> 得出ansible_local的信息：<br> <img src="https://images2.imgbox.com/34/e4/vEE8patX_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5c/62/UmIJ4ezD_o.png" alt="在这里插入图片描述"><br> <strong>’自定义事实的使用方式和默认事实相同’</strong></p> 
<h3><a id="57__207"></a>5.7 使用魔法变量</h3> 
<p>常用的有四个：</p> 
<blockquote> 
 <p>hostvars #包含受管主机的变量，可以用于获取另一台受管主机的变量的值 group_names #列出当前受管主机所属的所有组<br> groups #列出清单中的所有组和主机 inventory_hostname #包含清单中配置的当前受管主机的主机名称</p> 
</blockquote> 
<p>#<code>用途之一：使用 debug 模块报告特定主机的 hostvars 的值</code></p> 
<p><img src="https://images2.imgbox.com/ce/fd/KPZuXyxy_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="6__219"></a>6 练习</h2> 
<h3><a id="61__221"></a>6.1 创建自定义变量</h3> 
<p>生成目录和文件：<br> <img src="https://images2.imgbox.com/86/c0/hZFy0Jig_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/fa/a5/ZYZep32n_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/9d/26/XaKhQdY2_o.png" alt="在这里插入图片描述"><br> 得出：</p> 
<p><img src="https://images2.imgbox.com/90/6f/hq2gvv2m_o.png" alt="在这里插入图片描述"><br> 创建 playbook：<br> vim playbook.yml<br> <img src="https://images2.imgbox.com/ec/ce/DculacT2_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/d8/2d/4BTkNchq_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/9c/b7/43AXI9Qd_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e9/dc/yJO0ZBmd_o.png" alt="在这里插入图片描述"><br> 检测得出成功：<br> <img src="https://images2.imgbox.com/39/1d/BGIGYhTI_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="62__httpd_244"></a>6.2 使用基本身份认证的 httpd</h3> 
<h4><a id="621__245"></a>6.2.1 创建基本文件</h4> 
<p><img src="https://images2.imgbox.com/46/af/Puwxh0Js_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="622__247"></a>6.2.2 创建剧本</h4> 
<p>vim playbook.yml<br> <img src="https://images2.imgbox.com/b2/de/3LEs8kjf_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/42/f8/20coiESm_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c2/73/w0XUShxk_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f3/e5/l5ivZG7y_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="623__254"></a>6.2.3 创建加密文件</h4> 
<p><img src="https://images2.imgbox.com/fe/4e/Vrx3IenX_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7f/c4/nCzfoDlr_o.png" alt="在这里插入图片描述"><br> 在文件中写入：<br> web_pass: redhat</p> 
<h4><a id="624__files__259"></a>6.2.4 创建 files 目录</h4> 
<p><img src="https://images2.imgbox.com/02/81/Tr21nzES_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="625_files_261"></a>6.2.5 拷贝文件到files目录</h4> 
<p><img src="https://images2.imgbox.com/81/ea/wUCzzXMa_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="626_workstation_264"></a>6.2.6 修改workstation的发布目录</h4> 
<p>vim /etc/httpd/conf/httpd.conf<br> <img src="https://images2.imgbox.com/0c/6f/JIUxMAEk_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="627__267"></a>6.2.7 交互式输入密码，进行语法检测</h4> 
<p><img src="https://images2.imgbox.com/54/d7/se3cuOBh_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="628__270"></a>6.2.8 执行</h4> 
<p><img src="https://images2.imgbox.com/bd/41/h5xKpKdp_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="629__272"></a>6.2.9 验证是否成功</h4> 
<p><img src="https://images2.imgbox.com/db/15/0ntgTKEh_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8e/cb/atbE5Sn4_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a6/ce/rsPXd9If_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/86/d6/gDOIe6Y0_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/63/7b/KsNLlPRi_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="6210__279"></a>6.2.10 总结</h4> 
<pre><code>1.变量能够让 playbook 复用
2.可以给清单中的主机和主机组定义变量
3.可以使用事实和外部文件定义变量，也可以在命令行中
4.register 关键字何以用于捕获命令输出
5.ansible vault
6.ansible 事实是从受管主机自动检测到的变量
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3f35e33a103afa6964dfe1f7dfd21ff7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【docker】宿主定时cron执行docker内命令不执行</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/74d28dfab79c458fddc601d97263530a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">华为机试在线训练C&#43;&#43;版(31~40)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>