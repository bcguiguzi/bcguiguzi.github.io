<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>visual studio 2019&amp; Intel Parallel Studio XE2020下FORTRAN安装及MPI并行配置计算 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="visual studio 2019&amp; Intel Parallel Studio XE2020下FORTRAN安装及MPI并行配置计算" />
<meta property="og:description" content="实现步骤 下载安装包visual studio 2019版本的下载intel parallel studioXE2020下载 安装过程visual studio 2019版本的安装intel parallel studioXE2020安装 MPI相关配置新建项目步骤配置步骤 结束 下载安装包 visual studio 2019版本的下载 （1）visual studio 2019版本的下载，下载地址如下：
https://visualstudio.microsoft.com/zh-hans/vs/
下载界面如图：
共有三个版本可供选择，community版本适合个人使用，并且免费；professional版本和enterprise版本都需要序列号，
我在这里选择了专门面向程序开发人员的professional版本并进行下载
intel parallel studioXE2020下载 （2）intel parallel studioXE2020下载，我下载的是集群版本的，为了做MPI；具体的下载途径可以百度（我的是直接从别人copy来的）。
安装过程 ！！！重要！！！
必须先安装visual studio2019，后安装intel parallel studioXE2020。
visual studio 2019版本的安装 这里因为我已经安装好了，所以只有修改选项，如果是首次安装，只需要在选项中选择C&#43;&#43;的那个即可，其余的默认点击右下角安装就好
安装好之后，输入序列号认证（如果是communnity版本就不用认证），激活之后，关掉界面。进行后续安装
intel parallel studioXE2020安装 可以参考这里百度经验上面对2918版本的安装步骤https://jingyan.baidu.com/article/37bce2be5efc901002f3a216.html
因为我需要使用MPI和VTune等功能，所以我在选择时把所有的功能全都选上了。
安装完成后可以选择一个fortran很简单的例子测试并运行一下看看是否正常，比如hello world
MPI相关配置 新建项目步骤 文件&gt;&gt;新建&gt;&gt;项目
&gt;&gt;下一步
&gt;&gt;创建
在source files右键&gt;&gt;添加&gt;&gt;新建项
&gt;&gt;添加
这样就创建好了，就可以直接在里面写代码，编译运行。但是在这之前，需要对MPI进行编译环境配置
配置步骤 文章的信息，主要来源于官网，一定要按照步骤准确配置，否则会出现许多错误。
https://software.intel.com/content/www/us/en/develop/documentation/mpi-developer-guide-windows/top/introduction.html
（1）安装mpi库，因为我已经在XE2020里面选择了此选项，所以不必重新安装；
（2）设置MPI库环境：直接双击运行批处理文件：vars.bat，我的在C:\Program Files (x86)\IntelSWTools路径下面搜索，然后找到。
（3）在电脑搜索框输入cmd，以管理员身份运行，输入hydra_service -status，以确保hydra_service正在运行
如果不是正在运行的话，可以输入hydra_service -install，
这样再输入hydra_service -status的话，显示的就是在运行了，" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/94b430a34d0510718f07ee73019e6a4b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-06-21T19:06:54+08:00" />
<meta property="article:modified_time" content="2020-06-21T19:06:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">visual studio 2019&amp; Intel Parallel Studio XE2020下FORTRAN安装及MPI并行配置计算</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>实现步骤</h4> 
 <ul><li><a href="#_2" rel="nofollow">下载安装包</a></li><li><ul><li><a href="#visual_studio_2019_3" rel="nofollow">visual studio 2019版本的下载</a></li><li><a href="#intel_parallel_studioXE2020_12" rel="nofollow">intel parallel studioXE2020下载</a></li></ul> 
  </li><li><a href="#_16" rel="nofollow">安装过程</a></li><li><ul><li><a href="#visual_studio_2019_20" rel="nofollow">visual studio 2019版本的安装</a></li><li><a href="#intel_parallel_studioXE2020_23" rel="nofollow">intel parallel studioXE2020安装</a></li></ul> 
  </li><li><a href="#MPI_31" rel="nofollow">MPI相关配置</a></li><li><ul><li><a href="#_32" rel="nofollow">新建项目步骤</a></li><li><a href="#_41" rel="nofollow">配置步骤</a></li></ul> 
  </li><li><a href="#_148" rel="nofollow">结束</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>下载安装包</h2> 
<h3><a id="visual_studio_2019_3"></a>visual studio 2019版本的下载</h3> 
<p>（1）visual studio 2019版本的下载，下载地址如下：<br> https://visualstudio.microsoft.com/zh-hans/vs/<br> 下载界面如图：<br> <img src="https://images2.imgbox.com/40/1f/zwFJ4YxB_o.png" alt="">共有三个版本可供选择，community版本适合个人使用，并且免费；professional版本和enterprise版本都需要序列号，<br> 我在这里选择了专门面向程序开发人员的professional版本并进行下载<br> <img src="https://images2.imgbox.com/3d/25/LkGnpvNP_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="intel_parallel_studioXE2020_12"></a>intel parallel studioXE2020下载</h3> 
<p>（2）intel parallel studioXE2020下载，我下载的是集群版本的，为了做MPI；具体的下载途径可以百度（我的是直接从别人copy来的）。<br> <img src="https://images2.imgbox.com/9c/de/Qz3TWCj0_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_16"></a>安装过程</h2> 
<p>！！！重要！！！<br> 必须先安装visual studio2019，后安装intel parallel studioXE2020。</p> 
<h3><a id="visual_studio_2019_20"></a>visual studio 2019版本的安装</h3> 
<p><img src="https://images2.imgbox.com/8d/48/4RFeI2Gf_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/49/85/mf5sBTrH_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/55/cd/yVDzaSAU_o.png" alt="在这里插入图片描述">这里因为我已经安装好了，所以只有修改选项，如果是首次安装，只需要在选项中选择C++的那个即可，其余的默认点击右下角安装就好<br> <img src="https://images2.imgbox.com/92/92/WWTMv8Nw_o.png" alt="在这里插入图片描述">安装好之后，输入序列号认证（如果是communnity版本就不用认证），激活之后，关掉界面。进行后续安装</p> 
<h3><a id="intel_parallel_studioXE2020_23"></a>intel parallel studioXE2020安装</h3> 
<p>可以参考这里百度经验上面对2918版本的安装步骤https://jingyan.baidu.com/article/37bce2be5efc901002f3a216.html<br> 因为我需要使用MPI和VTune等功能，所以我在选择时把所有的功能全都选上了。</p> 
<p>安装完成后可以选择一个fortran很简单的例子测试并运行一下看看是否正常，比如hello world</p> 
<h2><a id="MPI_31"></a>MPI相关配置</h2> 
<h3><a id="_32"></a>新建项目步骤</h3> 
<p>文件&gt;&gt;新建&gt;&gt;项目<br> <img src="https://images2.imgbox.com/7c/f9/L7lG52wS_o.png" alt="在这里插入图片描述">&gt;&gt;下一步<br> <img src="https://images2.imgbox.com/d2/0a/5RFWgDvI_o.png" alt="在这里插入图片描述">&gt;&gt;创建</p> 
<blockquote> 
 <blockquote> 
  <p>在source files右键&gt;&gt;添加&gt;&gt;新建项</p> 
 </blockquote> 
</blockquote> 
<p><img src="https://images2.imgbox.com/8b/0c/taHaBIT4_o.png" alt="在这里插入图片描述">&gt;&gt;添加<br> 这样就创建好了，就可以直接在里面写代码，编译运行。但是在这之前，需要对MPI进行编译环境配置</p> 
<h3><a id="_41"></a>配置步骤</h3> 
<p>文章的信息，主要来源于官网，一定要按照步骤准确配置，否则会出现许多错误。<br> https://software.intel.com/content/www/us/en/develop/documentation/mpi-developer-guide-windows/top/introduction.html<br> （1）安装mpi库，因为我已经在XE2020里面选择了此选项，所以不必重新安装；<br> （2）设置MPI库环境：直接双击运行批处理文件：vars.bat，我的在C:\Program Files (x86)\IntelSWTools路径下面搜索，然后找到。<br> （3）在电脑搜索框输入cmd，以管理员身份运行，输入hydra_service -status，以确保hydra_service正在运行<br> <img src="https://images2.imgbox.com/93/57/SL7pXxVI_o.png" alt="在这里插入图片描述"></p> 
<p>如果不是正在运行的话，可以输入hydra_service -install，<br> <img src="https://images2.imgbox.com/64/e3/Mm5lA83B_o.png" alt="在这里插入图片描述"><br> 这样再输入hydra_service -status的话，显示的就是在运行了，<br> <img src="https://images2.imgbox.com/37/62/VDmoEEYP_o.png" alt="在这里插入图片描述"><br> （4）注册用户的凭证信息，并保存在注册表中。输入mpiexec -register，然后输入自己设置的用户名，密码，确认密码，回车出现保存<br> <img src="https://images2.imgbox.com/c2/ea/46hbhMpR_o.png" alt="在这里插入图片描述"><br> 这里其实还有两种其他办法，不用输入用户名和密码，但是需要修改设置，而且会耗费时间，所以不符合并行的目的，我没有选择。</p> 
<p>（5）找到compilervars.bat双击运行。</p> 
<p>（6）找到 mpivars.bat双击运行。</p> 
<p>（7）在console上右键&gt;&gt;属性<br> <img src="https://images2.imgbox.com/c5/67/oh6Kk59C_o.png" alt="在这里插入图片描述"><br> （8）配置属性&gt; Debugging下修改：<br> Command: <span class="katex--inline">KaTeX parse error: Undefined control sequence: \intel at position 13: (I_MPI_ROOT)\̲i̲n̲t̲e̲l̲64\bin\mpiexec.…</span>(TargetPath)"<br> <img src="https://images2.imgbox.com/30/fc/3BK9G0fP_o.png" alt="在这里插入图片描述">针对我自己的文件夹，commond是：C:\Program Files (x86)\IntelSWTools\compilers_and_libraries_2020.1.216\windows\mpi\intel64\bin\mpiexec.exe<br> Command arguments是：-n 4 “$(TargetPath)” ，代表4各核计算。<br> 修改后点击应用<br> （9）在fortran&gt;general下，修改Additional Include Directories: $(I_MPI_ROOT)\intel64\include<br> <img src="https://images2.imgbox.com/0f/58/Ua4qbMl1_o.png" alt="在这里插入图片描述">针对我自己的文件夹，C:\Program Files (x86)\IntelSWTools\compilers_and_libraries_2020.1.216\windows\mpi\intel64\include<br> 修改后点击应用<br> （10）在linker&gt;general下，修改Additional Library Directories: $(I_MPI_ROOT)\intel64\lib&lt;configuration&gt;，其中，的选项可以是debug或者是release，<br> （ release : multi-threaded optimized library<br> debug : multi-threaded debug library）<br> <img src="https://images2.imgbox.com/df/8a/3PLlkmsS_o.png" alt="在这里插入图片描述"><br> 因为我的是debug模式，所以我的文件夹是，C:\Program Files (x86)\IntelSWTools\compilers_and_libraries_2020.1.216\windows\mpi\intel64\lib\debug<br> 修改后点击应用<br> （11）在linker&gt;input下，修改Additional Dependencies: impi.lib<br> <img src="https://images2.imgbox.com/34/e7/rFMK1i5h_o.png" alt="在这里插入图片描述">修改后点击应用<br> （12）点击确定<br> （13）选择一个较为简单的mpi的fortran程序粘贴进去，如<br> ! 简单的 MPI 并行程序 Fortran 实现示例! ! – by Jackdaw ! – QQ 群 Fortran Coder(2338021)! – 2018 10 24 ! ! 任意进程间相互问候!</p> 
<pre><code>program main    
use mpi 
implicit none
integer :: myid, numProcs, nameLen, ierr  
character(len=mpi_max_processor_name) :: p_name  

call mpi_init( ierr ) ! 完成 MPI程序 的初始化工作 
call mpi_comm_rank( mpi_comm_world, myid, ierr ) ! 获取当前进程标识号  
call mpi_comm_size( mpi_comm_world, numProcs, ierr ) ! 获取通信域包含的进程数  

if( numProcs .lt. 2 ) then 
    write(*,*) "System requires at least 2 processors."
    call mpi_abort( mpi_comm_world, 1, ierr )    
end if  

call mpi_get_processor_name( p_name, nameLen, ierr ) ! 获取运行当前进程的机器名 
write(*,*) "Processor ",myid," is alive on ",p_name(1:nameLen),"."
call sleep(1)    
call mpi_barrier( mpi_comm_world, ierr )    
call hello()    
call mpi_finalize( ierr ) ! 完成 MPI程序 的结束工作 
end program main
! ############################################################################## !
!   任意两个进程间交换信息，问候信息由发送进程标识和接收进程标识组成!
! ############################################################################## 
subroutine hello()   
use mpi 
implicit none 
integer :: nproc, me, type = 1
integer :: buffer(2), node 
integer :: istat( mpi_status_size ), ierr 
call mpi_comm_rank( mpi_comm_world, me, ierr ) 
call mpi_comm_size( mpi_comm_world, nproc, ierr ) 

if( me .eq. 0 ) then 
    write(*,*) "Hello test from all to all." 
end if 

do node = 0, nproc-1 
    if( node .ne. me ) then 
        buffer(1) = me 
        buffer(2) = node 
        ! 首先将问候信息发出
        call mpi_send( buffer, 2, mpi_integer, node, type, mpi_comm_world, ierr ) ! 消息发送
        ! 然后接收被问候进程对自己发送的问候信息
        call mpi_recv( buffer, 2, mpi_integer, node, type, mpi_comm_world, istat, ierr ) ! 消息接收
        if( buffer(1) .ne. node .or. buffer(2) .ne. me ) then 
            write(*,*) "Hello: ",buffer(1)," = ",node," or ",buffer(2)," = ",me                
            write(*,*) "Mismatch on hello processors; node = ",node 
        end if 
        write(*,*) "Hello from ",me," to ",node,"."
    end if 
end do 
end subroutine
</code></pre> 
<p>（14）生成&gt;&gt;生成解决方案<br> （15）调试&gt;&gt;开始执行不调试<br> <img src="https://images2.imgbox.com/8c/75/4EwRCy1q_o.png" alt="在这里插入图片描述">备注：还有一个重要的问题是版本的问题<br> 在我的运行中，我设置的版本信息如下：<br> <img src="https://images2.imgbox.com/04/06/KcSaVbvf_o.png" alt="在这里插入图片描述"><br> 右键解决方案&gt;&gt;属性&gt;&gt;配置管理器<br> <img src="https://images2.imgbox.com/1a/4a/obXswuKY_o.png" alt="在这里插入图片描述">如果之前平台是win32，可以点小箭头然后新增，就有X64了。</p> 
<h2><a id="_148"></a>结束</h2> 
<p>研究了两天，终于成功了，走了很多弯路，最大的感受是，最好还是按照官网上面官方版本的说明进行操作，不要觉得差不多版本操作就一样，还是有一些不同的。<br> 学习之路，漫漫长夜，终见黎明。<br> 转载请注明出处，谢谢。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c72b0c5147b3a9ba4cfbc18d28a5dfa3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">宝德服务器安装过程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2ee149324ed60358ee8a565cd9d88327/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">微信小程序之--账号注册</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>