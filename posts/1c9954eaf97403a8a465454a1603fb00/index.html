<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【vivado PG学习】1 PG168：7 Series FPGAs Transceivers官方配置方法学习笔记 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【vivado PG学习】1 PG168：7 Series FPGAs Transceivers官方配置方法学习笔记" />
<meta property="og:description" content="目录 1 概览1.4 不支持的功能 2 产品说明3 用IP核进行设计3.1 通用设计向导3.2 时钟3.3 复位 4 设计流程4.1 生成IP核4.2 约束IP核 5 例程5.3 例程文件结构 介绍：
The 7 series FPGAs Transceivers Wizard LogiCORE™ IP 自动创建配置7系列fpga 收发器的HDL封装。向导可以配置一个或多个支持行业主流标准的高速串行收发器。或者从零开始支持各种自定义协议。
功能：
创建配置7系列fpga 收发器的HDL封装。自动对模拟设置进行配置。预定义了提供Aurora 8B/10B, Aurora 64B/66B, CEI-6G,DisplayPort, Interlaken, Open Base StationArchitecture Initiative (OBSAI), OC192,OC48, SRIO, 10GBASE-R, Common PacketRadio Interface (CPRI), Gigabit Ethernet,10 Gb Attachment Unit Interface (XAUI),RXAUI, and XLAUI, OTU3, 10GH SmallForm-factor Pluggable Plus (SFP&#43;), OpticalTransport Network OTU3, V-by-One, SDI或者其他自定义的协议。 1 概览 关于向导：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/1c9954eaf97403a8a465454a1603fb00/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-27T14:45:45+08:00" />
<meta property="article:modified_time" content="2021-08-27T14:45:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【vivado PG学习】1 PG168：7 Series FPGAs Transceivers官方配置方法学习笔记</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#1__11" rel="nofollow">1 概览</a></li><li><ul><li><a href="#14__27" rel="nofollow">1.4 不支持的功能</a></li></ul> 
  </li><li><a href="#2__32" rel="nofollow">2 产品说明</a></li><li><a href="#3_IP_47" rel="nofollow">3 用IP核进行设计</a></li><li><ul><li><a href="#31__49" rel="nofollow">3.1 通用设计向导</a></li><li><a href="#32__65" rel="nofollow">3.2 时钟</a></li><li><a href="#33__86" rel="nofollow">3.3 复位</a></li></ul> 
  </li><li><a href="#4__93" rel="nofollow">4 设计流程</a></li><li><ul><li><a href="#41_IP_94" rel="nofollow">4.1 生成IP核</a></li><li><a href="#42_IP_355" rel="nofollow">4.2 约束IP核</a></li></ul> 
  </li><li><a href="#5__375" rel="nofollow">5 例程</a></li><li><ul><li><a href="#53__376" rel="nofollow">5.3 例程文件结构</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p>介绍：<br> The 7 series FPGAs Transceivers Wizard LogiCORE™ IP 自动创建配置7系列fpga 收发器的HDL封装。向导可以配置一个或多个支持行业主流标准的高速串行收发器。或者从零开始支持各种自定义协议。<br> 功能：</p> 
<ul><li>创建配置7系列fpga 收发器的HDL封装。</li><li>自动对模拟设置进行配置。</li><li>预定义了提供Aurora 8B/10B, Aurora 64B/66B, CEI-6G,DisplayPort, Interlaken, Open Base StationArchitecture Initiative (OBSAI), OC192,OC48, SRIO, 10GBASE-R, Common PacketRadio Interface (CPRI), Gigabit Ethernet,10 Gb Attachment Unit Interface (XAUI),RXAUI, and XLAUI, OTU3, 10GH SmallForm-factor Pluggable Plus (SFP+), OpticalTransport Network OTU3, V-by-One, SDI或者其他自定义的协议。</li></ul> 
<h2><a id="1__11"></a>1 概览</h2> 
<p>关于向导：<br> 可以创建收发器、设计实例、testbench以快速整合以及验证自定义功能的串行接口。</p> 
<p>功能概览：<br> <img src="https://images2.imgbox.com/ed/80/HdQ8raCt_o.png" alt="在这里插入图片描述"></p> 
<p>这个图有1个重要的点：</p> 
<ul><li>第二步，在选完协议后，下一步应确定收发器的位置。因为这个是跟引脚有映射关系的硬核，位置必须确定。</li></ul> 
<p>收发器的HDL封装、设计示例、testbench的结构：</p> 
<p><img src="https://images2.imgbox.com/6c/7d/b6o4Od2T_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="14__27"></a>1.4 不支持的功能</h3> 
<p>向导可以在TX和RX生成不对称数据位宽的设计（内部和外部不相等）的设计，但是不支持这样的功能或时序仿真。<br> 向导不允许用户从两列中选择收发器(如果器件中有)。向导仅为GTZ收发器生成Verilog封装。</p> 
<h2><a id="2__32"></a>2 产品说明</h2> 
<p>7系列的收发器是低功耗的，GTP线速率高达6.6Gb/s,GTX 12.5Gb/s,GTH 13.1 Gb/s。</p> 
<p>端口描述（不同协议端口数不一样）：</p> 
<table><thead><tr><th>端口</th><th>方向</th><th>时钟域</th><th>描述</th></tr></thead><tbody><tr><td>GTREFCLK_PAD_N_IN/GTREFCLK_PAD_P_IN</td><td>Input</td><td>-</td><td>fpga收发器块的差分时钟输入。某一个块中有好几个收发器</td></tr><tr><td>SYSCLK_IN</td><td>Input</td><td>-</td><td>设计示例的系统时钟。如果DRP（dynamic reconfiguration port ）接口使能了，DRP_CLK_IN与SYSCLK_IN连接</td></tr><tr><td>DRP_CLK_IN_P/DRP_CLK_IN_N</td><td>Input</td><td>-</td><td>外部输入的DRP差分时钟对，给DRP接口</td></tr><tr><td>TRACK_DATA_OUT</td><td>Output</td><td>rxusrclk</td><td>表示在RX端接收到有效数据。这是一个电平信号。</td></tr><tr><td>RXN_IN/RXP_IN</td><td>Input</td><td>RX serial clk</td><td>RXP和RXN是7系列FPGA收发器块中每个接收器的差分输入对。</td></tr><tr><td>TXN_OUT/TXP_OUT</td><td>Output</td><td>TX serial clk</td><td>TXP和TXN是7系列FPGA收发器块中每个发射器的差分输出对。</td></tr></tbody></table> 
<h2><a id="3_IP_47"></a>3 用IP核进行设计</h2> 
<h3><a id="31__49"></a>3.1 通用设计向导</h3> 
<p>串行收发器的位置：<br> 根据所选串行收发器的总数，提供打算使用的每个串行收发器的具体位置。面板中显示的区域指示了串行收发器在器件中的位置。区域的划分是基于串行收发器相对于每个设备可用bufg的中位数的物理位置。</p> 
<p>基于设计示例进行设计：<br> IP核的示例程序可以进行仿真和实现，自己的设计可以在此基础上进行，也可以作为排除自己的程序故障的参考。</p> 
<p>保留寄存器：<br> 用户程序和IP 核所有的输入和输出之间的寄存器可以简化时序以及提高系统性能。打拍很大程度的简化了时序分析以及让工具可以更好的布局布线。</p> 
<p>识别关键时序路径：<br> 示例的XDC文件说明了关键信号以及时序约束。</p> 
<p>别瞎改IP核文件：<br> 7 series FPGA transceiver core不允许用户修改，任何更改都可能造成系统时序以及协议问题。只能通过IDE的选项更改然后生成文件。</p> 
<h3><a id="32__65"></a>3.2 时钟</h3> 
<table><thead><tr><th>时钟</th><th>描述</th></tr></thead><tbody><tr><td>GTREFCLK_PAD_N_IN/GTREFCLK_PAD_P_IN</td><td>收发器块的<strong>外部</strong>差分时钟</td></tr><tr><td>DRP_CLK_IN_P/DRP_CLK_IN_N</td><td>外部差分时钟，DRP接口时钟，即ip核设计中MMCM的输入时钟</td></tr><tr><td>SYSCLK</td><td>系统时钟用于驱动FPGA逻辑。当DRP接口使能时，DRP_CLK连接到syscclk。这个时钟需要在XDC中被约束。</td></tr><tr><td>PLLLOCKDETCLK</td><td>给反馈检测的稳定参考时钟，PLL的参考时钟，PLL的输入参考时钟或从PLL产生的任何输出时钟(例如TXOUTCLK)不能用来驱动这个时钟。此时钟仅在使用PLLFBCLKLOST和</td></tr><tr><td>PLLREFCLKLOST端口的时候需要.在示例设计中，PLLLOCKDETCLK连接到DRPCLK或syscclk。PLLREFCLKLOST在TX/RX启动FSM模块中使用。</td><td></td></tr></tbody></table> 
<p>TX / RXUSRCLK和TX / RXUSRCLK2 的产生：</p> 
<ul><li> <p>TXUSRCLK 和 TXUSRCLK2用TXOUTCLK产生，收发器的输出。</p> </li><li> <p>TXOUTCLK的源可以是参考时钟或PMA时钟。</p> </li><li> <p>RXUSRCLK and RXUSRCLK2可以使用TXOUTCLK 或 RXOUTCLK产生。</p> </li><li> <p>RXOUTCLK的源可以是参考时钟或者恢复时钟。</p> </li></ul> 
<p>TX/RXOUTCLK通过一个混合模式时钟管理器(MMCM)或BUFG路由到FPGA逻辑。当TXUSRCLK和TXUSRCLK2不匹配、RXUSRCLK和RXUSRCLK2不匹配时，需要配置MMCM，在示例设计中则会根据情况自动配置MMCM。</p> 
<h3><a id="33__86"></a>3.3 复位</h3> 
<p>设计示例中的FSM复位的目的：</p> 
<ul><li>初始化FSM以满足要求。</li><li>用于解决诸如fpga配置和RX数据中断或更换(如电缆插头或拔出)等问题。</li></ul> 
<h2><a id="4__93"></a>4 设计流程</h2> 
<h3><a id="41_IP_94"></a>4.1 生成IP核</h3> 
<p>第1页：</p> 
<p><img src="https://images2.imgbox.com/d9/01/quNvCVo8_o.png" alt="在这里插入图片描述"></p> 
<p><code>Component Name</code>:<br> GT Type：收发器类型，取决于器件是否支持。<br> Shared Logic:选择收发器块PLL、差分参考时钟缓冲器、时钟和复位逻辑是包含在IP 核中还是在示例程序中。</p> 
<p>第2页：</p> 
<p><img src="https://images2.imgbox.com/45/ce/etullGfM_o.png" alt="在这里插入图片描述"></p> 
<p><code>Protocal</code>: 从下拉列表选择协议。</p> 
<p>选择收发器的位置和时钟，左下会显示所有器件支持的收发器。7系列收发器具体位置在《<strong>UG476</strong>：7 Series FPGAs GTX/GTH Transceivers》有写。</p> 
<p><code>TX</code>：</p> 
<table><thead><tr><th>选项</th><th>描述</th></tr></thead><tbody><tr><td>Line Rate</td><td>置所需的目标线速率，单位为Gb/s。可以与接收的线路速率不同。</td></tr><tr><td>Reference Clock</td><td>从下拉列表中选择可用的时钟频率</td></tr><tr><td>TX off</td><td>勾选的话关闭收发器的TX通路</td></tr></tbody></table> 
<p><code>RX</code>：</p> 
<table><thead><tr><th>选项</th><th>描述</th></tr></thead><tbody><tr><td>Line Rate</td><td>置所需的目标线速率，单位为Gb/s。</td></tr><tr><td>Reference Clock</td><td>从下拉列表中选择可用的时钟频率</td></tr><tr><td>RX off</td><td>勾选的话关闭收发器的RX通路</td></tr></tbody></table> 
<p><code>Use Common DRP</code>: 选择此选项将应用COMMON block的动态重新配置端口(DRP)信号。<br> Advanced Clocking Option ：使用此复选框可将所有可能的参考时钟端口调出到生成的封装。用于动态时钟切换。<br> *Vivado Design Suite Debug Feature：使用此复选框可以打开IP中的ILA和VIO核，用于硬件调试和控制。</p> 
<p>选择收发器及参考时钟：<br> TX/RX Clock Source：确定提供给每个选定收发器的参考时钟信号的源。两对差分时钟信号输入引脚对REFCLK0和REFCLK1分别给四个收发器提供时钟，一共有四组，标签从下到上为Q0~Q4（k7 325 900为例，分别Q0<sub>Q3对应115</sub>118组）。每个收发机都可以访问<strong>本地信号组</strong>的时钟和<strong>相邻1或2组</strong>的时钟，这取决于收发器的位置。【一般都是选择本组的时钟，不要离太远】</p> 
<p>各时钟域收发器分组对应关系</p> 
<table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>REFCLK0/1 Q0</td><td>本地参考时钟到收发器Y0-Y3</td></tr><tr><td>REFCLK0/1 Q1</td><td>本地参考时钟到收发器Y4-Y7</td></tr><tr><td>REFCLK0/1 Q2</td><td>本地参考时钟到收发器Y8-Y11</td></tr><tr><td>REFCLK0/1 Q3</td><td>本地参考时钟到收发器Y12-Y15</td></tr><tr><td>REFCLK0/1 Q4</td><td>本地参考时钟到收发器Y16-Y19</td></tr><tr><td>REFCLK0/1 Q5</td><td>本地参考时钟到收发器Y20-Y23</td></tr><tr><td>REFCLK0/1 Q6</td><td>本地参考时钟到收发器Y24-Y27</td></tr><tr><td>REFCLK0/1 Q7</td><td>本地参考时钟到收发器Y28-Y31</td></tr><tr><td>REFCLK0/1 Q8</td><td>本地参考时钟到收发器Y32-Y35</td></tr></tbody></table> 
<p><code>PLL selection</code>：</p> 
<table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>QPLL</td><td>GTX、GTH：使用Quad PLL 时，四个收发器都用这玩意就可以减少功耗，因为这个可以被四个收发器共享</td></tr><tr><td>CPLL</td><td>GTX、GTH：根据选择的收发器的线速率使用Channel PLL</td></tr><tr><td>PLL0</td><td>GTP: PLL0在Quad的四个收发器上共享</td></tr><tr><td>PLL1</td><td>GTP: PLL1在Quad的四个收发器上共享</td></tr></tbody></table> 
<p>第3页：</p> 
<p><img src="https://images2.imgbox.com/b4/77/CVYhFOlz_o.png" alt="在这里插入图片描述"></p> 
<p><code>TX/RX</code>：</p> 
<ul><li>External Data Width： 设定发射机应用接口的数据宽度</li><li>Encoding： 编码方式</li><li>Internal Data Width ： 内部数据位宽，我们关注外部就行，内部位宽给我们计算相关时钟频率提供参考。<br> 注意：RX设置应与TX设置相同</li></ul> 
<p><code>DRP/System Clock Frequency</code>: 选择此选项使应用程序可以使用CHANNEL块的动态重新配置端口信号。</p> 
<p><code>Optional Ports</code>:</p> 
<table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>TXBYPASS8B10B</td><td>2bit位宽，8B/10B编码器每个byte的失能信号，高位对应高字节失能</td></tr><tr><td>TXCHARDISPMODE</td><td>2bit位宽，control disparity of outgoing 8B/10B data. 高位影响高字节</td></tr><tr><td>TXCHARDISPVAL</td><td>同上</td></tr><tr><td>RXCHARISCOMMA</td><td>2bit位宽，指示遇到有效的8B/10B comma字符，高位指示高byte数据路径</td></tr><tr><td>RXCHARISK</td><td>2bit位宽，指示遇到有效的8B/10B 字符，高位指示高byte路径</td></tr></tbody></table> 
<p><code>Synchronization and Clocking</code> :</p> 
<table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>Enable TX Buffer</td><td>收发器中的TX缓冲区使能。这个缓冲区可以被绕过以获得低的、确定的延迟</td></tr><tr><td>TX Buffer Bypass Mode</td><td>此选项仅在TX缓冲区被绕过时有效。必须使用manual模式。</td></tr><tr><td>Enable RX Buffer</td><td>收发器中的RX缓冲区使能。这个缓冲区可以被绕过以获得低的、确定的延迟</td></tr><tr><td>RX Buffer Bypass Mode</td><td>这个选项只有在RX缓冲区被绕过时才可见。建议设置为auto模式。</td></tr></tbody></table> 
<p><code>TXUSRCLK / RXUSRCLK Source</code>:<br> TX:TXOUTCLK: TXUSRCLK由TXOUTCLK驱动<br> RX:TXOUTCLK: RXUSRCLK由TXOUTCLK驱动。如果RX缓冲区被绕过，则此选项不可用。对于RX缓冲旁路模式，使用RXOUTCLK作为RXUSRCLK的源。</p> 
<p><code>TXOUTCLK / RXOUTCLK Source</code>:<br> TX:Use TXPLLREFCLK: 如果勾选，TXOUTCLK由输入参考时钟生成；否则向导将为TXOUTCLK选择适当的源。<br> RX:Use RXPLLREFCLK: 如果勾选，RXOUTCLK由输入参考时钟生成；否则向导将为RXOUTCLK选择适当的源。</p> 
<p><code>Optional Ports</code>：</p> 
<table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>TXPCSRESET</td><td>用于发送PCS逻辑的高电平复位信号</td></tr><tr><td>TXBUFSTATUS</td><td>2位信号监视TX弹性缓冲区的状态。当TX缓冲区被绕过时，此选项不可用。</td></tr><tr><td>TXRATE</td><td>传输速率改变 端口</td></tr><tr><td>RXPCSRESET</td><td>用于接收PCS逻辑的高电平复位信号</td></tr><tr><td>RXBUFSTATUS</td><td>指示RX弹性缓冲器的状态。当RX缓冲区被绕过时，选项不可用。</td></tr><tr><td>RXBUFRESET</td><td>RX弹性缓冲逻辑的高电平复位信号。当RX缓冲区被绕过时，此选项不可用</td></tr><tr><td>RXRATE</td><td>接收速率改变 端口</td></tr><tr><td>QPLLPD</td><td>仅当选择GTX或GTH收发器时可见。QPLL的掉电端口</td></tr><tr><td>CPLLPD</td><td>仅当选择GTX或GTH收发器时可见。CPLL的掉电端口</td></tr><tr><td>PLL0PD</td><td>仅当选择GTP收发器时可见。QPLL的掉电端口</td></tr><tr><td>PLL1PD</td><td>仅当选择GTP收发器时可见。CPLL的掉电端口</td></tr><tr><td>TXSYSCLKSEL</td><td>选择驱动TX数据路径的参考时钟源。</td></tr><tr><td>RXSYSCLKSEL</td><td>选择驱动RX数据路径的参考时钟源。</td></tr><tr><td>TXPMARESET</td><td>用于发送PMA逻辑的高电平复位信号。</td></tr><tr><td>RXPMARESET</td><td>用于接收PMA逻辑的高电平复位信号。</td></tr><tr><td>TX8B10BEN</td><td>X8B10BEN设置为高，以启用8B/10B编码器。</td></tr><tr><td>RXCDRHOLD</td><td>保持CDR控制 loop frozen。</td></tr><tr><td>SIGVALIDCLK</td><td>仅当选择GTH或GTP收发器时可见。OOB电路的时钟。</td></tr><tr><td>CLKRSVD</td><td>仅当选择GTX收发器时可见。OOB电路的时钟。</td></tr><tr><td>TXPIPPMEN</td><td>使能TX相位插补器PPM控制块。</td></tr><tr><td>TXPIPPMOVRDEN</td><td>使能直接控制TXPI。</td></tr><tr><td>TXPIPPMPD</td><td>关闭TX插补器PPM控制块。</td></tr><tr><td>TXPIPPMSTEPSIZE</td><td>指定要增加或减少PI代码的数量。</td></tr></tbody></table> 
<p>第4页：</p> 
<p><img src="https://images2.imgbox.com/4e/fa/v83xXu8o_o.png" alt="在这里插入图片描述"></p> 
<p>设置comma字符和控制接收均衡和终端电压。<br> <code>Comma Detection</code> :</p> 
<table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>Use Comma Detection</td><td>启用接收comma检测。用于标识数据流中的comma字符和SONET帧字符。</td></tr><tr><td>Decode Valid Comma Only</td><td>当启用Use Comma Detection时，将检测限制为特定定义的comma字符</td></tr><tr><td>Comma Value</td><td>选择一个标准Comma模式或User Defined模式以输入自定义模式。</td></tr><tr><td>Plus Comma</td><td>表示要匹配的positive-disparity Comma字符的10位二进制模式。模式的最右位是连续到达的第一个位。</td></tr><tr><td>Minus Comma</td><td>表示要匹配的negative-disparity Comma字符的10位二进制模式。模式的最右位是连续到达的第一个位。</td></tr><tr><td>Comma Mask</td><td>10位二进制模式，表示Comma匹配模式的掩码。1表示Comma模式中匹配的对应位。0位表示不关心Comma模式中对应的位。</td></tr><tr><td>Align to：Any Byte Boundary</td><td>当检测到Comma时，使用Comma模式将数据流对齐到最近的字节边界</td></tr><tr><td>Align to：Two Byte Boundary</td><td>当检测到Comma时，使用Comma模式将数据流对齐到2字节边界</td></tr><tr><td>Align to：Four Byte Boundary</td><td>当检测到Comma时，使用Comma模式将数据流对齐到3字节边界</td></tr><tr><td>Option Ports：ENPCOMMAALIGN</td><td>高电平有效，当检测到Plus Comma模式时，使能字节边界对齐过程。</td></tr><tr><td>Option Ports：ENMCOMMAALIGN</td><td>高电平有效，当检测到Minus Comma模式时，使能字节边界对齐过程。</td></tr><tr><td>Option Ports：RXSLIDE</td><td>高电平有效，每个assertion按一位调整的字节对齐方式。优先于普通Comma对齐。</td></tr><tr><td>Option Ports：RXBYTEISALIGNED</td><td>高电平有效，指示并行数据流按字节边界对齐。</td></tr><tr><td>Option Ports：RXBYTEREALIGN</td><td>高电平有效，指示字节对齐已用最近的逗号检测更改。注意，在这种情况下可能会出现数据错误。</td></tr><tr><td>Option Ports：RXCOMMADET</td><td>高电平有效，表示Comma对齐逻辑在数据流中检测到Comma模式。</td></tr></tbody></table> 
<p><code>Differential Swing and Emphasis Mode</code>：指定发射pre-cursor pre-emphasis模式设置。选择自定义模式，使能设置的差异摆动和 pre-emphasis级别。</p> 
<p><code>RX Equalization</code>：</p> 
<table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>Equalization Mode</td><td>设置接收端的均衡模式。</td></tr><tr><td>Automatic Gain Control</td><td>设置接收机的自动增益控制。可以设置为“AUto自动”或“Manual手动”</td></tr><tr><td>Use RX Equalizer CTLE3 Adaptation Logic (DFE mode only)</td><td>仅适用于GTX收发器。如果勾选此项，则在示例设计中实例化CTLE3适配逻辑。</td></tr></tbody></table> 
<p><code>RX Termination</code>: Termination Voltage：</p> 
<ul><li>选择GND接地内部终端网络。</li><li>选择Floating隔离网络。</li><li>选择AVTT将一个内部电压参考源应用到终端网络。</li><li>选择Programmable可编程选项，从下拉菜单中选择RX终止电压。</li></ul> 
<p><code>Optional Ports</code>：</p> 
<table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>TXPOLARITY</td><td>高电平有效，转换发射机输出的极性。</td></tr><tr><td>TXINHIBIT</td><td>高电平有效，迫使发射机输出稳定。</td></tr><tr><td>RXPOLARITY</td><td>高电平有效，反转接收数据信号的极性。</td></tr><tr><td>TXQPIBIASEN</td><td>高电平有效，使QPI偏置。</td></tr><tr><td>TXQPIWEAKUP</td><td>高电平有效，QPI传输。</td></tr><tr><td>RXDFEAGCOVRDEN</td><td>高电平有效，DFE AGC over-ride</td></tr><tr><td>TXPOSTCURSOR</td><td>TXPOSTCURSOR 端口</td></tr><tr><td>TXPRECURSOR</td><td>TXPOSTCURSOR 端口</td></tr><tr><td>TXQPISENN</td><td>发送QPI端口(负极性)。</td></tr><tr><td>RXDFEMONITOROUT</td><td>接收DFE监控端口。</td></tr><tr><td>RXLPMHFOVRDEN</td><td>接收低通覆盖使能端口。</td></tr><tr><td>TXQPISENP</td><td>发送QPI端口(正极性)。</td></tr><tr><td>RXDFEMONITORSEL</td><td>接收DFE监视器选择端口。</td></tr><tr><td>RXLPMLFKLOVRDEN</td><td>接收低通覆盖使能端口。</td></tr><tr><td>TXQPISTRONGPDOWN</td><td>发送QPI掉电端口。</td></tr><tr><td>RXDFELPMRESET</td><td>重置接收DFE/LPM块。</td></tr><tr><td>TXDIFFCTRL</td><td>发送驱动摆动控制。</td></tr><tr><td>RXQPISENN</td><td>在MGTRXN引脚上注册1或0的检测输出</td></tr><tr><td>RXQPISENP</td><td>在MGTRXP引脚上注册1或0的检测输出。</td></tr><tr><td>RXQPIEN</td><td>禁用QPI协议的RX终止。</td></tr></tbody></table> 
<p>第5页：</p> 
<p><img src="https://images2.imgbox.com/eb/eb/cX3facsf_o.png" alt="在这里插入图片描述"></p> 
<p><code>Enable PCI Express</code>: 选择该选项可开启PCI Express的某些特定操作，包括开启PCI Express省电模式和PCIe通道绑定选项。当PCI Express使用收发器时，此选项应该被勾选。</p> 
<p><code>SATA COM Sequence</code>：</p> 
<ul><li>Bursts：0到7之间的整数值，表示声明COM匹配的突发序列数。该值默认为4，这是SATA规范中为COMINIT、COMRESET和COMWAKE指定的突发计数。</li><li>Idles：0到7之间的整数值，表示声明a的空闲序列的数目COM匹配。每个空闲信号都是一个长度与COMINIT/匹配的OOB信号COMRESET或COMWAKE。</li></ul> 
<p><code>Transition Time</code>：</p> 
<ul><li>To P2：：0到65,535之间的整数值。设置一个计数器，以确定PCI Express到P2电源状态的转换时间。</li><li>From P2：0到65,535之间的整数值。设置一个计数器，以确定PCI Express从P2电源状态转换的时间。</li><li>To/From non-P2：0到65,535之间的整数值。设置一个计数器，以确定PCI Express从P2以外的电源状态转换到或从电源状态转换的时间。</li></ul> 
<p><code>PCI Express Parameters：Optional Ports</code>：</p> 
<table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>LOOPBACK</td><td>3bit位宽，使能各种数据环回模式进行测试。</td></tr></tbody></table> 
<p><code>OOB Signal Detection</code>：</p> 
<ul><li>Use RX OOB Signal Detection：启用内部OOB信号检测器。OOB信号检测用于PCIe和SATA。</li></ul> 
<p>第6页：</p> 
<p><img src="https://images2.imgbox.com/14/f3/IakiF53P_o.png" alt="在这里插入图片描述"></p> 
<p><code>Channel Bonding</code>：</p> 
<table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>Use Channel Bonding</td><td>使能接收器通道使用唯一的字符序列绑定逻辑。当识别这些序列时，允许在接收缓冲区中添加或删除字符，以字节对齐多个数据收发器。</td></tr><tr><td>Sequence Length</td><td>在下拉列表中选择唯一通道绑定序列的字符数</td></tr><tr><td>Sequence Max Skew</td><td>从下拉列表中选择可通过通道绑定处理的最大字符倾斜。必须始终小于通道连接序列之间最小距离的一半</td></tr><tr><td>Use Two Channel Bonding Sequences</td><td>激活可选的第二通道绑定序列。任一序列的检测都会触发通道绑定。</td></tr></tbody></table> 
<p><code>Clock Correction</code>：</p> 
<table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>Use Clock Correction</td><td>使能接收器使用独特的字符序列进行时钟校正逻辑，当识别这些序列时，允许在接收缓冲区中添加或删除字符，以防止由于发送/接收时钟频率的微小差异而导致的缓冲区下溢/溢出。</td></tr><tr><td>Sequence Length</td><td>从下拉列表中选择唯一时钟校正序列中的字符数(子序列)。</td></tr><tr><td>PPM Offset</td><td>发送时钟和接收时钟之间的PPM偏差。</td></tr><tr><td>Periodicity of the CC Sequence</td><td>表示在数据流中插入CC序列的时间间隔。</td></tr><tr><td>Use Two Clock Correction Sequences</td><td>激活可选的秒时钟校正序列。任一序列的检测触发时钟校正。</td></tr></tbody></table> 
<p><code>Sequences Didinition</code>：</p> 
<table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>Byte (Symbol)</td><td>设置每个序列的字节</td></tr><tr><td>K Character</td><td>当选择8B/10B解码时，此选项可用。勾选后符号是一个8B/10B K字符</td></tr><tr><td>Inverted Disparity</td><td>一些8B/10B解码协议使用了故意颠倒disparity的符号。当序列中期望有这样的符号时，应该选中该选项。</td></tr><tr><td>Don’t Care</td><td>通过检查此选项，多字节序列可以具有通配符。序列中未使用的字节将自动设置此选项。</td></tr></tbody></table> 
<p>第7页：</p> 
<p><img src="https://images2.imgbox.com/94/d3/zn4tuvgz_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="42_IP_355"></a>4.2 约束IP核</h3> 
<p>IP核根据自定义的参数产生了对应的时序和位置约束。</p> 
<p><strong>时钟频率约束</strong><br> <code>create_clock</code><br> <strong>错误路径</strong><br> 系统时钟和用户时钟与其他时钟没有关联，这两时钟也没有确定的相位关系，这两个始终与需要设置位 false path。<br> <code>set_false_path</code></p> 
<p><strong>收发器布局</strong><br> 根据自己选的的位置会生成对应的约束,如:</p> 
<pre><code>##---------- Set placement for gt0_gth_wrapper_i/GTHE2_CHANNEL ------
set_property LOC GTHE2_CHANNEL_X0Y0 [get_cells xaui_wrapper_support_i/xaui_wrapper_init_i/
</code></pre> 
<p><strong>IO约束</strong><br> 包括参考时钟这些都是固定的位置，所以上面的约束就已经对参考时钟、输入输出引脚之类的IO进行约束了。</p> 
<h2><a id="5__375"></a>5 例程</h2> 
<h3><a id="53__376"></a>5.3 例程文件结构</h3> 
<p><img src="https://images2.imgbox.com/07/27/3fi7Yupk_o.png" alt="在这里插入图片描述"></p> 
<p>对应的模块结构：<br> <img src="https://images2.imgbox.com/c2/67/VtJafNeE_o.png" alt="在这里插入图片描述"></p> 
<p>这里我的<code>&lt;component name&gt;</code>是<code>gtwizard_0</code></p> 
<table><thead><tr><th>文件</th><th>说明</th></tr></thead><tbody><tr><td>_exdes.xdc</td><td>IP核自动生成的约束</td></tr><tr><td>_tb.v[hd]</td><td>Test bench文件</td></tr><tr><td>_gt_frame_check.v[hd]</td><td>要在示例设计中实例化的帧检查逻辑。</td></tr><tr><td>&lt;component_name&gt;_gt_frame_gen.v[hd]</td><td>要在示例设计中实例化的帧生成器逻辑。</td></tr><tr><td>&lt;component_name&gt;_exdes.v[hd]</td><td>顶层设计的例子。包含收发器，重置逻辑，以及帧生成器和帧检查逻辑的实例化。还包含 Vivado Design Suite调试特性模块实例化。</td></tr><tr><td>gt_rom_init_tx.dat</td><td>gt_frame_gen模块的块RAM初始化模式。模式是用户可以修改的。</td></tr><tr><td>gt_rom_init_rx.dat</td><td>gt_frame_check模块的块RAM初始化模式。模式是用户可以修改的。</td></tr><tr><td>&lt;component_name&gt;_support.v[hd]</td><td>IP核支持层的7系列FPGA收发器设计</td></tr><tr><td>&lt;component_name&gt;_gt_usrclk_source.v[hd]</td><td>收发器用户时钟模块，为收发器和用户逻辑生成时钟信号。</td></tr><tr><td>&lt;component_name&gt;_common.v[hd]</td><td>这个文件实例化GTXE2_COMMON或GTXE2_COMMON原语，在各自的多个收发器核心之间共享。</td></tr><tr><td>&lt;component_name&gt;_common_reset.v[hd]</td><td>该文件生成复位电路，用于7系列fpga收发器向导核心的核心复位。</td></tr><tr><td>&lt;component_name&gt;_tb.v[hd]</td><td>给出了testbench进行功能仿真设计的实例。</td></tr><tr><td>&lt;component_name&gt;_tb_imp.v[hd]</td><td>给出了testbench进行时序仿真设计的实例。</td></tr></tbody></table> 
<p><strong>IP核文件结构_srcs\sources_1\ip\</strong></p> 
<table><thead><tr><th>文件</th><th>说明</th></tr></thead><tbody><tr><td>&lt;component_name&gt;.v</td><td>收发器的主HDL封装。实例化单个收发器的封装用于目标设计</td></tr><tr><td>&lt;component_name&gt;.[veo</td><td>vho]</td></tr><tr><td>&lt;component_name&gt;.xci</td><td>来自Vivado工具的日志文件，描述用于生成收发器封装的选项。Vivado工具为它在当前项目目录中创建的每个Wizard封装生成XCI文件。XCI文件还可以用作Vivado工具的输入。</td></tr><tr><td>&lt;component_name&gt;_gt.v[hd]</td><td>要在主收发器封装中实例化的单个收发器封装。使用所选协议的设置实例化所选收发器。</td></tr><tr><td>&lt;component_name&gt;_octal0.v</td><td>仅限于GTZ收发器。要在主收发器封装中实例化的单个收发器封装。使用所选协议的设置实例化所选收发器。</td></tr><tr><td>&lt;component_name&gt;_octal1.v</td><td>同上</td></tr><tr><td>gtwizard_v3_4_beachfront.v</td><td>个文件应该用于将用户逻辑与GTZ收发器连接起来。</td></tr><tr><td>tx_startup_fsm.v[hd]</td><td>发射器复位模块。这个文件不是为GTZ收发器生成的。</td></tr><tr><td>rx_startup_fsm.v[hd]</td><td>接收器复位模块。这个文件不是为GTZ收发器生成的。</td></tr></tbody></table>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/048c11b807bbf0ee454820d683a7341f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ArcGIS教程：解决在mxd文件，定义投影之后，数据源还是的投影坐标系还是未发生改变的问题。</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2d73bc4e7f4e2c4bca901824b25d9037/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">笔记本连接外接显示器后耳机没有声音</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>