<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【实践】Python文件打包为exe后防止反编译 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【实践】Python文件打包为exe后防止反编译" />
<meta property="og:description" content="原文链接：
https://www.jb51.net/article/184725.htm
将脚本编译为pyd以防止反编译
如何解决呢，可以考虑将模块py文件编译为动态链接库，这样破解难度将大大增加。其中，在python里，pyd格式即动态链接库。使用cython即可编译，如果是anaconda是自带，python有的可能不带cython，安装即可：
1
pip install Cython
我们在main.py所在的文件夹新建py文件，在此处我命名为build_pyd.py，其内容如下：
1
2
3
4
5
6
7
8
9
10
11
12
13
14
# -*- coding: utf-8 -*-
&#34;&#34;&#34;
Created on Wed Aug 29 13:33:20 2018
@author: Li Zeng hai
&#34;&#34;&#34;
from distutils.core import setup
from Cython.Build import cythonize
setup(
name = &#39;any words.....&#39;,
ext_modules = cythonize([&#34;mylib.py&#34;,]
),
)
然后执行以下cmd命令：
1
python build_pyd.py build_ext --inplace
注意：编译需要相关的VC环境，因为python3.9是基于 VS15版本的，所以我这里安装的也是。不安装是无法编译的。不然会出现报错error:Unable to find vcvarsall." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/b79c84949efab2d1c2d3dc7236f31617/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-16T15:53:38+08:00" />
<meta property="article:modified_time" content="2021-12-16T15:53:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【实践】Python文件打包为exe后防止反编译</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>原文链接：</p> 
<blockquote> 
 <p><a href="https://www.jb51.net/article/184725.htm" rel="nofollow" title="https://www.jb51.net/article/184725.htm">https://www.jb51.net/article/184725.htm</a></p> 
</blockquote> 
<p><strong>将脚本编译为pyd以防止反编译</strong></p> 
<p>如何解决呢，可以考虑将模块py文件编译为动态链接库，这样破解难度将大大增加。其中，在python里，pyd格式即动态链接库。使用cython即可编译，如果是anaconda是自带，python有的可能不带cython，安装即可：</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>pip install Cython</code></p> </td></tr></tbody></table> 
<p>我们在main.py所在的文件夹新建py文件，在此处我命名为build_pyd.py，其内容如下：</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> <p>14</p> </td><td> <p><code># -*- coding: utf-8 -*-</code></p> <p><code>"""</code></p> <p><code>Created on Wed Aug 29 13:33:20 2018</code></p> <p><code>@author: Li Zeng hai</code></p> <p><code>"""</code></p> <p><code> </code> </p> <p><code>from</code> <code>distutils.core </code><code>import</code> <code>setup</code></p> <p><code>from</code> <code>Cython.Build </code><code>import</code> <code>cythonize</code></p> <p><code> </code> </p> <p><code>setup(</code></p> <p><code> </code><code>name </code><code>=</code> <code>'any words.....'</code><code>,</code></p> <p><code> </code><code>ext_modules </code><code>=</code> <code>cythonize([</code><code>"mylib.py"</code><code>,]</code></p> <p><code> </code><code>),</code></p> <p><code>)</code></p> </td></tr></tbody></table> 
<p>然后执行以下cmd命令：</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>python build_pyd.py build_ext </code><code>-</code><code>-</code><code>inplace</code></p> </td></tr></tbody></table> 
<p>注意：编译需要相关的VC环境，因为python3.9是基于 VS15版本的，所以我这里安装的也是。不安装是无法编译的。不然会出现报错error:Unable to find vcvarsall.bat </p> 
<p><img alt="" height="59" src="https://images2.imgbox.com/49/8a/k9GrRCer_o.png" width="581"></p> 
<p> 文章链接：</p> 
<blockquote> 
 <p><a href="https://blog.csdn.net/TaiBai_435_/article/details/121990608" title="https://blog.csdn.net/TaiBai_435_/article/details/121990608">https://blog.csdn.net/TaiBai_435_/article/details/121990608</a></p> 
 <p></p> 
</blockquote> 
<p>运行过程及生成结果如下图，其中红框的pyd文件即编译好了。因为我是64位的系统和python，所以会生成amd64后缀，我们把这个删掉重命名为mylib.pyd即可。</p> 
<p>注：当同时存在mylib.pyd和mylib.py时，引入优先级是pyd&gt;py，所以不用移除py文件，默认引入时就是pyd。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/97/25/dhFoDMda_o.png"></p> 
<p>此时，我们删除build、disk文件夹</p> 
<p>使用如下命令，将其打包为单一exe（去掉-F则不是单一exe）</p> 
<pre><code>pyinstaller -F mylib.py</code></pre> 
<p> 就能直接引用pyd文件打包发布exe文件，但是在我这里出现文件缺失的错误：</p> 
<blockquote> 
 <p>ValueError: Module file F:\python项目<strong><code>\mylib</code></strong>.py is missing</p> 
</blockquote> 
<p>这里需要注意的是程序的__main__入口只能有一个，如果源py文件中有定义main入口，需要注释掉并调整代码缩进，否则通过main.py调用pyd文件遇到if name == ‘main':之后的代码都不会运行。<strong>并且需要将源py文件头部import部分全部复制到main.py文件头部</strong></p> 
<pre><code>import win32gui
import win32api
import win32con

import mylib
if __name__ == '__main__':
 mylib()</code></pre> 
<p>再次用命令打包</p> 
<pre><code>pyinstaller -F main.py</code></pre> 
<p> 完美解决！</p> 
<p></p> 
<p><br> 可以验证一下：</p> 
<p>再次反编译main.exe后，原来的路径E:\t\dist\main.exe_extracted\out00-PYZ.pyz_extracted之下，已经找不到mylib.pyc了。</p> 
<p>因为他已经不是可以直接反编译出来的文件了。</p> 
<p>那么他在哪呢，他是作为pyd存在于上层目录中了。如下图：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c7/83/fyQubrGd_o.png"></p> 
<p>pyd的反编译难度是相当高的，至此，就大功告成了！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/21a5e906e7401fd8c7c6e4475f772b01/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">07vue-router的keep-alive及其他问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c1f32bd39e81786a14d4c96f367307f6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">21年的最后一月了，C#会成为2021年的编程语言吗？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>