<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python&#43;selenium自动化元素定位防踩坑 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python&#43;selenium自动化元素定位防踩坑" />
<meta property="og:description" content="在自动化UI测试过程中常常会在元素定位阶段就踩坑，碰到困扰已久的问题。 以下是个人整理元素定位报错原因和解决方法。
踩坑一：StaleElementReferenceException
selenium.common.exceptions.StaleElementReferenceException: Message: stale element reference: element is not attached to the page document
异常原因： 意思是，引用的元素已过期。原因是页面刷新了，此时当然找不到之前页面的元素，就算是后退回来的页面也是不一样的。
在编写脚本时一直报这个错，使用显示等待都不行，在一顿百度操作后才知道是元素被刷新了
我们发现，仅仅是刷新了一下页面，两次的element id是不同的，这就说明这是两个不同的元素，如果用之前的element，自然会报错
原因很明显，你用别人的身份证id去找现在的人，哪怕这两个人长的很像，他也会告诉你，对不起，你找错人啦。
解决方法：
有时我们无法避免，不确定什么时候元素就会被刷新。页面刷新后重新获取元素的思路不变，这时可以使用python的异常处理语句：try…except…，异常出现时重新执行，关键代码如下
如下图：我在实际工作当中编写脚本时使用异常try捕获异常后，页面刷新后重新获取元素，可以成功找到元素了
踩坑二：ElementClickInterceptedException（元素点击交互异常）
具体报错：selenium.common.exceptions.ElementClickInterceptedException: Message: element click intercepted is not clickable at point (1421, 283). Other element would receive the click:
E (Session info: chrome=104.0.5112.102)
意思是，元素定位相互覆盖，元素已经找到，但是无法点击
解决方法：
方法一：使用强制等待，但是每次都有类似的元素无法点击使用强制等待的话会延长脚本执行时间
time.sleep() 前言：之前便遇到过很多次该问题的报错，就没有管它，但是随着越来越多的元素报该错，每次使用强制等待会大大延长脚本的执行时间，于是便网上找各种方法解决该问题，最终发现是自己使用显示等待的方法错了
如下是显示等待的用法和区别
方法二：显性等待
element_to_be_clickable--元素是否可点击
vibility of element_ located--元素是否可见
presence_of_element_located--元素是否存在
如上：三种等待方法，最开始我一直使用的是presence_of_element_located，判断元素是否存在，最终还是报错，提示元素元素点击拦截异常
element_to_be_clickable--等待元素出现可以点击，便可以元素定位成功
需要先导包：
from selenium.webdriver.support import expected_conditions as EC from selenium." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/c3571fc2b54f6bcde481fd974ecef143/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-12T14:06:34+08:00" />
<meta property="article:modified_time" content="2023-04-12T14:06:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python&#43;selenium自动化元素定位防踩坑</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p>在自动化UI测试过程中常常会在元素定位阶段就踩坑，碰到困扰已久的问题。 以下是个人整理元素定位报错原因和解决方法。</p> 
</blockquote> 
<p><strong>踩坑一：StaleElementReferenceException</strong></p> 
<p>selenium.common.exceptions.StaleElementReferenceException: Message: stale element reference: element is not attached to the page document</p> 
<p><strong>异常原因：</strong> 意思是，引用的元素已过期。原因是页面刷新了，此时当然找不到之前页面的元素，就算是后退回来的页面也是不一样的。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/aa/b6/4FucX80H_o.png"></p> 
<p>在编写脚本时一直报这个错，使用显示等待都不行，在一顿百度操作后才知道是元素被刷新了</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/6c/94/kWjcbbYl_o.png"></p> 
<p>我们发现，仅仅是刷新了一下页面，两次的element id是不同的，这就说明这是两个不同的元素，如果用之前的element，自然会报错</p> 
<p>原因很明显，你用别人的身份证id去找现在的人，哪怕这两个人长的很像，他也会告诉你，对不起，你找错人啦。</p> 
<p><strong>解决方法：</strong></p> 
<p>有时我们无法避免，不确定什么时候元素就会被刷新。页面刷新后重新获取元素的思路不变，这时可以使用python的异常处理语句：try…except…，异常出现时重新执行，关键代码如下</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/4e/e4/n7npQCSr_o.png"></p> 
<p>如下图：我在实际工作当中编写脚本时使用异常try捕获异常后，页面刷新后重新获取元素，可以成功找到元素了</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/2d/bb/Wm1x9Pvo_o.png"></p> 
<p><strong>踩坑二：ElementClickInterceptedException（元素点击交互异常）</strong></p> 
<p>具体报错：selenium.common.exceptions.ElementClickInterceptedException: Message: element click intercepted is not clickable at point (1421, 283). Other element would receive the click:</p> 
<p>E (Session info: chrome=104.0.5112.102)</p> 
<p>意思是，元素定位相互覆盖，元素已经找到，但是无法点击</p> 
<p><strong>解决方法：</strong></p> 
<p>方法一：使用强制等待，但是每次都有类似的元素无法点击使用强制等待的话会延长脚本执行时间</p> 
<p>time.sleep()    </p> 
<p>前言：之前便遇到过很多次该问题的报错，就没有管它，但是随着越来越多的元素报该错，每次使用强制等待会大大延长脚本的执行时间，于是便网上找各种方法解决该问题，最终发现是自己使用显示等待的方法错了</p> 
<p>如下是显示等待的用法和区别</p> 
<p>方法二：显性等待</p> 
<p>element_to_be_clickable--元素是否可点击</p> 
<p>vibility <em>of</em> element_ located--元素是否可见</p> 
<p>presence_of_element_located--元素是否存在</p> 
<p>如上：三种等待方法，最开始我一直使用的是presence_of_element_located，判断元素是否存在，最终还是报错，提示元素元素点击拦截异常</p> 
<p>element_to_be_clickable--等待元素出现可以点击，便可以元素定位成功</p> 
<p>需要先导包：</p> 
<pre><code>from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.support.ui import WebDriverWait
复制代码</code></pre> 
<pre><code>element = WebDriverWait(self.browser, 5).until(
    EC.element_to_be_clickable((By.XPATH, "//input[@placeholder='请输入会员手机号']")))
element.clcik()
复制代码</code></pre> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/6f/f2/A3BNFKyq_o.png"></p> 
<p>方法三：使用JS点击</p> 
<p>然而有时即使已经显式等待了，却仍然会报错： ElementClickInterceptedException，这多少有点奇怪，为什么 webdriver 有时就是无法点击，我不知道，也许这和他首先执行的一些验证检查有关，反正就在这一刻，它不给你点</p> 
<p>代码如下：</p> 
<pre><code>element = self.browser.find_element(By.XPATH, "(//span[@class='el-checkbox__inner'])[4]")
self.browser.execute_script("arguments[0].click();", element)
复制代码</code></pre> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/36/23/HbXP4Lir_o.png"></p> 
<p>这是通过 JavaScript 完成的点击，js可以避开一些校验</p> 
<p><strong>👆以上便是在编写selenium自动化时元素定位时踩的坑，以此分享防止踩坑</strong></p> 
<p><strong>最后：</strong> 下方这份完整的软件测试视频学习教程已经整理上传完成，朋友们如果需要可以自行免费领取<strong><code>【保证100%免费】</code></strong></p> 
<p class="img-center"><img alt="在这里插入图片描述" src="https://images2.imgbox.com/ed/f7/gZ3ZKbWr_o.png"></p> 
<p> 这些资料，对于【软件测试】的朋友来说应该是最全面最完整的备战仓库，这个仓库也陪伴上万个测试工程师们走过最艰难的路程，希望也能帮助到你！</p> 
<h2><strong>软件测试面试文档</strong></h2> 
<p>我们学习必然是为了找到高薪的工作，下面这些面试题是来自阿里、腾讯、字节等一线互联网大厂最新的面试资料，并且有字节大佬给出了权威的解答，刷完这一套面试资料相信大家都能找到满意的工作。</p> 
<p><img alt="" src="https://images2.imgbox.com/83/80/AiMQfoVG_o.png"></p> 
<h3><a name="t2"></a><strong>面试文档获取方式：</strong></h3> 
<p class="img-center"><img alt="" height="114" src="https://images2.imgbox.com/d1/d4/NX6zqNk1_o.png" width="410"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dd3fa4e518a948617621bca627f9780f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C语言之 数据结构入门——顺序表的构造</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2c30990e77072b2518b36a42d7b5363c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CentOS7安装及配置nginx</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>