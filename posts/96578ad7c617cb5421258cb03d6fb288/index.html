<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>活动文档服务器,ACTIVEDOC 示例：实现活动文档服务器 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="活动文档服务器,ACTIVEDOC 示例：实现活动文档服务器" />
<meta property="og:description" content="ACTIVEDOC 示例：实现活动文档服务器
08/18/2008
本文内容
更新：2007 年 11 月
ACTIVEDOC 示例说明如何实现活动文档服务器。此示例演示以下操作：
如何实现 IOleDocument 和 IOleDocumentView 接口。
如何通过容器执行菜单合并。
如何实现对象中的工具栏。
如何重写 IPersistStreamInit 方法 Load 和 Save 来执行自定义保存和加载。
如何使用 CDialogImpl 来实现“关于”对话框。
如何创建“多格式文本编辑控件”的子类。
安全说明：
提供该示例代码是为了阐释一个概念，并不代表着最安全的编码实践，因此不应在应用程序或网站中使用该示例代码。对于超出本示例代码的预期用途以外的使用所造成的偶然或继发性损失，Microsoft 不承担任何责任。
获取示例和安装示例的说明：
在 Visual Studio 的“帮助”菜单上，单击“示例”。
有关更多信息，请参见定位示例文件。
示例的最新版本和完整列表可以从 Visual Studio 2008 Samples page(Visual Studio 2008 示例页面)联机获取。
还可以在计算机的硬盘上查找示例。默认情况下，示例和自述文件将复制到 \Program Files\Visual Studio 9.0\Samples\ 下的文件夹中。对于 Visual Studio 速成版，所有示例都位于联机位置。
生成并运行示例
生成示例
打开解决方案 ActiveDoc.sln。
在“生成”菜单中，单击“生成解决方案”。
使用 Internet Explorer 运行示例
在 Internet Explorer 中打开 ActiveDoc.htm 或 ActiveDoc." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/96578ad7c617cb5421258cb03d6fb288/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-30T23:36:17+08:00" />
<meta property="article:modified_time" content="2021-07-30T23:36:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">活动文档服务器,ACTIVEDOC 示例：实现活动文档服务器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>ACTIVEDOC 示例：实现活动文档服务器</p> 
 <p>08/18/2008</p> 
 <p>本文内容</p> 
 <p>更新：2007 年 11 月</p> 
 <p>ACTIVEDOC 示例说明如何实现活动文档服务器。此示例演示以下操作：</p> 
 <p>如何实现 IOleDocument 和 IOleDocumentView 接口。</p> 
 <p>如何通过容器执行菜单合并。</p> 
 <p>如何实现对象中的工具栏。</p> 
 <p>如何重写 IPersistStreamInit 方法 Load 和 Save 来执行自定义保存和加载。</p> 
 <p>如何使用 CDialogImpl 来实现“关于”对话框。</p> 
 <p>如何创建“多格式文本编辑控件”的子类。</p> 
 <p align="center"><img src="https://images2.imgbox.com/32/d8/CFMGc73d_o.gif" alt="429547676db8f5d28135308d17dffcc2.gif">安全说明：</p> 
 <p>提供该示例代码是为了阐释一个概念，并不代表着最安全的编码实践，因此不应在应用程序或网站中使用该示例代码。对于超出本示例代码的预期用途以外的使用所造成的偶然或继发性损失，Microsoft 不承担任何责任。</p> 
 <p>获取示例和安装示例的说明：</p> 
 <p>在 Visual Studio 的“帮助”菜单上，单击“示例”。</p> 
 <p>有关更多信息，请参见定位示例文件。</p> 
 <p>示例的最新版本和完整列表可以从 Visual Studio 2008 Samples page(Visual Studio 2008 示例页面)联机获取。</p> 
 <p>还可以在计算机的硬盘上查找示例。默认情况下，示例和自述文件将复制到 \Program Files\Visual Studio 9.0\Samples\ 下的文件夹中。对于 Visual Studio 速成版，所有示例都位于联机位置。</p> 
 <p>生成并运行示例</p> 
 <p>生成示例</p> 
 <p>打开解决方案 ActiveDoc.sln。</p> 
 <p>在“生成”菜单中，单击“生成解决方案”。</p> 
 <p>使用 Internet Explorer 运行示例</p> 
 <p>在 Internet Explorer 中打开 ActiveDoc.htm 或 ActiveDoc.AAA 生成的文件(若要打开 ActiveDoc.AAA，请在看到打开此文件的提示后单击“打开”按钮)。</p> 
 <p>使用已合并到 Internet Explorer 菜单栏的“Format”(格式)菜单，或直接单击工具栏颜色来更改键入文本的颜色。</p> 
 <p>使用 Microsoft Office 活页夹运行示例</p> 
 <p>运行 Microsoft Office 活页夹，并从“节”菜单中单击“添加”。</p> 
 <p>选择标记为“ActiveDoc 类”的图标，再单击“确定”。</p> 
 <p>应看到嵌入在 Office 活页夹中的对象。注意，菜单已合并，并且显示 ActiveDoc 的工具栏。可以输入文本并使用菜单和工具栏按钮来更改所键入文本的颜色。</p> 
 <p>示例文件</p> 
 <p>此示例包含以下主要文件：</p> 
 <p>ActiveCtl.h</p> 
 <p>ActiveCtl.cpp — 实现 CActiveDoc，它代表整个 ActiveDoc 对象。</p> 
 <p>OleDocument.h — 包含 IOleDocument 和 IOleDocumentView 接口的实现。</p> 
 <p>Toolbar.h — 包含 CToolbar，它有助于实现工具栏。</p> 
 <p>关键字</p> 
 <p>此示例使用以下关键字：</p> 
 <p>ActiveXDocActivate；ALT_MSG_MAP；ATLASSERT；ATLTRACE；BEGIN_COM_MAP；BEGIN_MSG_MAP；BEGIN_OBJECT_MAP；BEGIN_PROPERTY_MAP；BEGIN_TOOLBAR_MAP；CAboutDlg::DoModal；CanInPlaceActivate；CComCoClass；CComControl；CComModule::GetClassObject；CComModule::GetLockCount；CComModule::Init；CComModule::RegisterServer；CComModule::Term；CComModule::UnregisterServer；CComObjectRoot；CComObjectRootEx::InternalQueryInterface；CComPtr；CHARFORMAT；CMenu；COM_INTERFACE_ENTRY；COM_INTERFACE_ENTRY_IMPL；COMMAND_ID_HANDLER；COMMAND_RANGE_HANDLER；CreateMenu；CreateRTFWindow；CreateToolbar；CreateWindowEx；CToolbar；CWindow::DestroyWindow；CWindow::ModifyStyle；CWindow::SetFocus；CWindow::SetParent；CWindow::SetWindowPos；DECLARE_REGISTRY_RESOURCEID；DestroyMenu；DestroyToolbar；DisableThreadLibraryCalls；DllMain；DoesVerbUIActivate；EDITSTREAM::dwCookie；EDITSTREAM::dwError；EDITSTREAM::pfnCallback；Ellipse；END_COM_MAP；END_MSG_MAP；END_OBJECT_MAP；END_PROPERTY_MAP；END_TOOLBAR_MAP；EndDialog；ExtTextOut；FreeLibrary；GetMenuItemCount；GetMenuItemID；GetMenuState；GetMenuString；GetResourceInstance；GetStockObject；GetSubMenu；GetTextMetrics；GetWindow；GetWindowContext；GetWindowRect；HDC；hdcDraw；IDataObjectImpl；IDispatchImpl；InitCommonControls；InlineIsEqualGUID；InPlaceDeactivate；InPlaceMenuCreate；InPlaceMenuDestroy；InsertMenu；InterfaceSupportsErrorInfo；InternalQueryInterface；IOleControlImpl；IOleDocument::GetDocMiscStatus；IOleDocumentImpl；IOleDocumentView::ApplyViewState；IOleDocumentView::SetInPlaceSite；IOleDocumentViewImpl；IOleInPlaceActiveObjectImpl；IOleInPlaceFrame*   pFrame；IOleInPlaceFrame::InsertMenus；IOleInPlaceFrame::Release；IOleInPlaceFrame::SetMenu；IOleInPlaceObjectWindowlessImpl；IOLEInPlaceSite::GetWindowContext；IOleObjectImpl；IPersistStorageImpl；IPersistStreamInitImpl；IProvideClassInfo2Impl；IQuickActivateImpl；ISupportErrorImpl；IViewObjectExImpl；LoadLibrary；LoadMenu；LoadString；MAKEINTRESOURCE；MergeMenus；MESSAGE_HANDLER；NOTIFY_CODE_HANDLER；OBJECT_ENTRY；OleCreateMenuDescriptor；OLEINPLACEFRAMEINFO；OnInPlaceActivate；OnUIActivate；prcBounds；RECT rcPos, rcClip；RemoveMenu；SelectObject；SendMessage；SetActiveObject；SetBkMode；SetBorderSpace；SetControlFocus；SetFocus；SetInPlaceSite；SetMenu；SetObjectRects；SetTextColor；ShowObject；ShowWindow；UIActivate；UIDeactivate；UnmergeMenus；ZeroMemory</p> 
 <p>请参见</p> 
 <p>其他资源</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0c5778a1525dab672802e9351e05101e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">共享打印机显示服务器错误代码,使用共享打印机 出现错误代码0x00000709的解决办法...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/34c822dab6c47e5ac61c736c709706bc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">unix服务器上传文件,Unix  lrzsz命令 上传本地文件到服务器 / 发送文件到客户端...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>