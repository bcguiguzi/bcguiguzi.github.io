<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【虚拟机ubuntu设置ssh】ssh连不上问题解决方法 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【虚拟机ubuntu设置ssh】ssh连不上问题解决方法" />
<meta property="og:description" content="转载自博客园:https:www.cnblogs.com/chenxiaomeng/，仅供自用学习记录。 首先，确保server端的ssh服务是开的（service shhd start）
然后在client端输入： ssh 【usrname】@【serverip】 （远程登录）
scp 【filename】 【usrname】@【serverip】：/URL (远程传输)
常出现的问题：
1.端口失效 ssh 192.168.*. ssh: connect to host 192.168.*. port 22: No route to host
这由于server端没有开机或是网络不通（这个原因很多，最简单的是网线没有插。还有就是可能会是网卡down了等）如果是网卡down了ifup相应的网卡再试试
2.linux的ssh服务没有开启 首先确保要登录的主机安装了openssh-client
（ubuntu有默认安装，如果没有则输入安装命令）
sudo apt-get install openssh-client
如果要使本机开放SSH服务就需要安装 openssh-server
sudo apt-get install openssh-server
server安装过程中可能会出现问题如下：
Reading package lists… Done Building dependency tree Reading state information… Done Package openssh-server is not available, but is referred to by another package. This may mean that the package is missing, has been obsoleted, or is only available from another source E: Package openssh-server has no installation candidate 重新运行以下的代码" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/54e057458b9836cb1f05cab1f5b3ffa1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-22T12:21:43+08:00" />
<meta property="article:modified_time" content="2021-06-22T12:21:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【虚拟机ubuntu设置ssh】ssh连不上问题解决方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="httpswwwcnblogscomchenxiaomeng_2"></a>转载自博客园:https:www.cnblogs.com/chenxiaomeng/，仅供自用学习记录。</h2> 
<p>首先，确保server端的ssh服务是开的（service shhd start）</p> 
<p>然后在client端输入： ssh 【usrname】@【serverip】 （远程登录）</p> 
<p>scp 【filename】 【usrname】@【serverip】：/URL (远程传输)</p> 
<p>常出现的问题：</p> 
<h2><a id="1_11"></a>1.端口失效</h2> 
<h2><a id="ssh_192168_13"></a>ssh 192.168.*<strong>.</strong></h2> 
<p>ssh: connect to host 192.168.*<strong>.</strong> port 22: No route to host</p> 
<p>这由于server端没有开机或是网络不通（这个原因很多，最简单的是网线没有插。还有就是可能会是网卡down了等）如果是网卡down了ifup相应的网卡再试试</p> 
<h2><a id="2linuxssh_19"></a>2.linux的ssh服务没有开启</h2> 
<p>首先确保要登录的主机安装了openssh-client</p> 
<p>（ubuntu有默认安装，如果没有则输入安装命令）</p> 
<p>sudo apt-get install openssh-client<br> 如果要使本机开放SSH服务就需要安装 openssh-server</p> 
<p>sudo apt-get install openssh-server<br> server安装过程中可能会出现问题如下：</p> 
<pre><code>Reading package lists… Done 
Building dependency tree 
Reading state information… Done 
Package openssh-server is not available, but is referred to by another package. 
This may mean that the package is missing, has been obsoleted, or 
is only available from another source 
E: Package openssh-server has no installation candidate
</code></pre> 
<p>重新运行以下的代码</p> 
<pre><code>sudo apt-get update 
sudo apt-get upgrade 
sudo apt-get install openssh-server 
</code></pre> 
<p>然后确认sshserver是否启动了：</p> 
<p>ps -e |grep ssh<br> 如果看到sshd那说明ssh-server已经启动了。<br> 如果没有则可以这样启动：</p> 
<pre><code>sudo /etc/init.d/ssh start
</code></pre> 
<p>ssh-server配置文件位于/ etc/ssh/sshd_config，在这里可以定义SSH的服务端口，默认端口是22，你可以自己定义成其他端口号，如222。<br> 然后重启SSH服务：<br> sudo /etc/init.d/ssh stop<br> sudo /etc/init.d/ssh start<br> 然后使用以下方式登陆SSH：<br> ssh zhou@192.168.*<strong>.</strong> zhou为192.168.***.**机器上的用户，需要输入密码。<br> 断开连接：exit</p> 
<h2><a id="3sshserver_79"></a>3.ssh到server上的时候密码是对的但是报如下信息：</h2> 
<h2><a id="ssh_192168_83"></a>ssh 192.168.*<strong>.</strong></h2> 
<p>root@192.168.*<strong>.</strong>'s password:</p> 
<p>Permission denied, please try again.</p> 
<h4><a id="rootsshrootssh_93"></a>这个是由于如果不输入用户名的时候默认的是root用户，但是安全期间ssh服务默认没有开root用户的ssh权限</h4> 
<p>解决方法：</p> 
<p>要修改root的ssh权限，即修改 /etc/ssh/sshd_config文件中</p> 
<p>PermitRootLogin no 改为 PermitRootLogin yes</p> 
<pre><code>vim /etc/ssh/sshd_config
</code></pre> 
<p>找到</p> 
<pre><code>Authentication:
LoginGraceTime 120
PermitRootLogin prohibit-password
StrictModes yes
</code></pre> 
<p>改成</p> 
<pre><code>Authentication:
LoginGraceTime 120
PermitRootLogin yes
StrictModes yes
</code></pre> 
<h2><a id="_125"></a></h2> 
<p>然后重启服务</p> 
<pre><code>/etc/init.d/ssh restart 
</code></pre> 
<h2><a id="4_134"></a>4.登录是出现如下提示：</h2> 
<p>ssh root@192.168.*<strong>.</strong></p> 
<p>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</p> 
<p>@ WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED! @</p> 
<p>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</p> 
<p>IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!</p> 
<p>Someone could be eavesdropping on you right now (man-in-the-middle attack)!</p> 
<p>It is also possible that the RSA host key has just been changed.</p> 
<p>The fingerprint for the RSA key sent by the remote host is</p> 
<p>76:fb:b3:70:14:48:19:d6:29:f9:ba:42:46:be:fb:77.</p> 
<p>Please contact your system administrator.</p> 
<p>Add correct host key in /home/fante/.ssh/known_hosts to get rid of this</p> 
<p>message.</p> 
<p>Offending key in /home/fante/.ssh/known_hosts:68</p> 
<p>RSA host key for 192.168.*<strong>.</strong> has changed and you have requested strict checking.</p> 
<p>Host key verification failed.</p> 
<p>server端密码或是其他发生改变的时候。</p> 
<p>解决方法一般就需要删除~/.ssh/known_hosts的东西，然后再登录即可。</p> 
<h2><a id="5ssh_root1921682348_178"></a>5.ssh root@192.168.23.48</h2> 
<p>Connecting to 192.168.23.48:22…<br> Could not connect to ‘192.168.23.48’ (port 22): Connection failed.</p> 
<p>Type `help’ to learn how to use Xshell prompt.</p> 
<p>第一种情况：</p> 
<p>因为防火墙的原因导致的</p> 
<p>第1查看 service iptables status</p> 
<p>说明当前没有开启 如果有开启的话则关闭当前的防火墙 /etc/init.d/iptables stop</p> 
<p>之后要重启可以 service iptables start</p> 
<p>第2查看<br> sudo ufw status</p> 
<p>发现目前的系统只是支持8080端口的访问，可以将ssh的端口访问加入 ufw allow 22</p> 
<p>加入22端口之后可以正常访问</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c397d4edf3e476ce11edd942c2e0f14f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux find: missing argument to `-exec‘</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1c9017422af0731ce63be70d6e7617ae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">lab7同步互斥实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>