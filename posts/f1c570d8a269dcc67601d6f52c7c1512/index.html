<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vue3 快速上手从0到1，两小时学会【附源码】 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Vue3 快速上手从0到1，两小时学会【附源码】" />
<meta property="og:description" content="小伙伴们好，欢迎关注，一起学习，无限进步
以下内容为vue3的学习笔记
项目需要使用到的依赖
npm install axios
npm install nanoid
vue-router
npm install pinia
npm install mitt
源码：Gitee
运行
npm install npm run dev 需要运行那一小节，把目录 src 删除，对应的重命名为 src 即可
文章目录 1. Vue3简介1.1. 【性能的提升】1.2.【 源码的升级】1.3. 【拥抱TypeScript】1.4. 【新的特性】 2. 创建Vue3工程2.1. 【基于 vue-cli 创建】2.2. 【基于 vite 创建】(推荐)2.3. 【一个简单的效果】 3. Vue3核心语法3.1. 【OptionsAPI 与 CompositionAPI】Options API 的弊端Composition API 的优势 3.2. 【拉开序幕的 setup】setup 概述setup 的返回值setup 与 Options API 的关系setup 语法糖 3.3. 【ref 创建：基本类型的响应式数据】3.4. 【reactive 创建：对象类型的响应式数据】3.5. 【ref 创建：对象类型的响应式数据】3." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/f1c570d8a269dcc67601d6f52c7c1512/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-10T22:22:10+08:00" />
<meta property="article:modified_time" content="2024-03-10T22:22:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Vue3 快速上手从0到1，两小时学会【附源码】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>小伙伴们好，欢迎关注，一起学习，无限进步<br> 以下内容为vue3的学习笔记</p> 
</blockquote> 
<p>项目需要使用到的依赖</p> 
<blockquote> 
 <p>npm install axios<br> npm install nanoid<br> vue-router<br> npm install pinia<br> npm install mitt</p> 
</blockquote> 
<p>源码：<a href="https://gitee.com/xiaoshiStudy/vue" rel="nofollow">Gitee</a><br> 运行</p> 
<pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span>
<span class="token function">npm</span> run dev
</code></pre> 
<p>需要运行那一小节，把目录 <code>src</code> 删除，对应的重命名为 <code>src</code> 即可</p> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1_Vue3_19" rel="nofollow">1. Vue3简介</a></li><li><ul><li><a href="#11__25" rel="nofollow">1.1. 【性能的提升】</a></li><li><a href="#12__30" rel="nofollow">1.2.【 源码的升级】</a></li><li><a href="#13_TypeScript_34" rel="nofollow">1.3. 【拥抱TypeScript】</a></li><li><a href="#14__37" rel="nofollow">1.4. 【新的特性】</a></li></ul> 
  </li><li><a href="#2_Vue3_54" rel="nofollow">2. 创建Vue3工程</a></li><li><ul><li><a href="#21__vuecli__55" rel="nofollow">2.1. 【基于 vue-cli 创建】</a></li><li><a href="#22__vite__82" rel="nofollow">2.2. 【基于 vite 创建】(推荐)</a></li><li><a href="#23__156" rel="nofollow">2.3. 【一个简单的效果】</a></li></ul> 
  </li><li><a href="#3_Vue3_193" rel="nofollow">3. Vue3核心语法</a></li><li><ul><li><a href="#31__OptionsAPI__CompositionAPI_194" rel="nofollow">3.1. 【OptionsAPI 与 CompositionAPI】</a></li><li><ul><li><a href="#Options_API__198" rel="nofollow">Options API 的弊端</a></li><li><a href="#Composition_API__200" rel="nofollow">Composition API 的优势</a></li></ul> 
   </li><li><a href="#32__setup_205" rel="nofollow">3.2. 【拉开序幕的 setup】</a></li><li><ul><li><a href="#setup__206" rel="nofollow">setup 概述</a></li><li><a href="#setup__252" rel="nofollow">setup 的返回值</a></li><li><a href="#setup__Options_API__261" rel="nofollow">setup 与 Options API 的关系</a></li><li><a href="#setup__266" rel="nofollow">setup 语法糖</a></li></ul> 
   </li><li><a href="#33_ref__321" rel="nofollow">3.3. 【ref 创建：基本类型的响应式数据】</a></li><li><a href="#34_reactive__366" rel="nofollow">3.4. 【reactive 创建：对象类型的响应式数据】</a></li><li><a href="#35_ref__418" rel="nofollow">3.5. 【ref 创建：对象类型的响应式数据】</a></li><li><a href="#36_ref__reactive_480" rel="nofollow">3.6. 【ref 对比 reactive】</a></li><li><a href="#37_toRefs__toRef_496" rel="nofollow">3.7. 【toRefs 与 toRef】</a></li><li><a href="#38_computed_537" rel="nofollow">3.8. 【computed】</a></li><li><a href="#39watch_598" rel="nofollow">3.9.【watch】</a></li><li><ul><li><a href="#_ref_608" rel="nofollow">情况一 (ref)</a></li><li><a href="#_ref_636" rel="nofollow">情况二 (ref)</a></li><li><a href="#_reactive_683" rel="nofollow">情况三 (reactive)</a></li><li><a href="#__737" rel="nofollow">情况四 （对象类型）</a></li><li><a href="#_799" rel="nofollow">情况五</a></li></ul> 
   </li><li><a href="#310_watchEffect_852" rel="nofollow">3.10. 【watchEffect】</a></li><li><a href="#311__ref__918" rel="nofollow">3.11. 【标签的 ref 属性】</a></li><li><a href="#312_props_992" rel="nofollow">3.12. 【props】</a></li><li><a href="#313__1053" rel="nofollow">3.13. 【生命周期】</a></li><li><a href="#314_hook_1251" rel="nofollow">3.14. 【自定义hook】</a></li></ul> 
  </li><li><a href="#4__1399" rel="nofollow">4. 路由</a></li><li><ul><li><a href="#41__1400" rel="nofollow">4.1. 【对路由的理解】</a></li><li><a href="#42__1402" rel="nofollow">4.2. 【基本切换效果】</a></li><li><a href="#43__1479" rel="nofollow">4.3. 【两个注意点】</a></li><li><a href="#44_1483" rel="nofollow">4.4.【路由器工作模式】</a></li><li><a href="#45_to_1506" rel="nofollow">4.5. 【to的两种写法】</a></li><li><a href="#46__1514" rel="nofollow">4.6. 【命名路由】</a></li><li><a href="#47__1544" rel="nofollow">4.7. 【嵌套路由】</a></li><li><a href="#48__1601" rel="nofollow">4.8. 【路由传参】</a></li><li><ul><li><a href="#query_1602" rel="nofollow">query参数</a></li><li><a href="#params_1636" rel="nofollow">params参数</a></li></ul> 
   </li><li><a href="#49_props_1669" rel="nofollow">4.9. 【路由的props配置】</a></li><li><a href="#410__replace_1689" rel="nofollow">4.10. 【 replace属性】</a></li><li><a href="#411__1699" rel="nofollow">4.11. 【编程式导航】</a></li><li><a href="#412__1712" rel="nofollow">4.12. 【重定向】</a></li></ul> 
  </li><li><a href="#5_pinia_1722" rel="nofollow">5. pinia</a></li><li><ul><li><a href="#51_1724" rel="nofollow">5.1【准备一个效果】</a></li><li><a href="#52_pinia__1727" rel="nofollow">5.2【搭建 pinia 环境】</a></li><li><a href="#53_1747" rel="nofollow">5.3【存储+读取数据】</a></li><li><a href="#54_1825" rel="nofollow">5.4.【修改数据】(三种方式)</a></li><li><a href="#55storeToRefs_1873" rel="nofollow">5.5.【storeToRefs】</a></li><li><a href="#56getters_1895" rel="nofollow">5.6.【getters】</a></li><li><a href="#57subscribe_1931" rel="nofollow">5.7.【$subscribe】</a></li><li><a href="#58_store_1939" rel="nofollow">5.8. 【store组合式写法】</a></li></ul> 
  </li><li><a href="#6__1964" rel="nofollow">6. 组件通信</a></li><li><ul><li><a href="#61_props_1976" rel="nofollow">6.1. 【props】</a></li><li><a href="#62__2023" rel="nofollow">6.2. 【自定义事件】</a></li><li><a href="#63_mitt_2045" rel="nofollow">6.3. 【mitt】</a></li><li><a href="#64vmodel_2108" rel="nofollow">6.4.【v-model】</a></li><li><a href="#65attrs__2186" rel="nofollow">6.5.【$attrs 】</a></li><li><a href="#66_refsparent_2246" rel="nofollow">6.6. 【<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             r 
            
           
             e 
            
           
             f 
            
           
             s 
            
           
             、 
            
           
          
            refs、 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord mathnormal">s</span><span class="mord cjk_fallback">、</span></span></span></span></span>parent】</a></li><li><a href="#67_provideinject_2259" rel="nofollow">6.7. 【provide、inject】</a></li><li><a href="#68_pinia_2318" rel="nofollow">6.8. 【pinia】</a></li><li><a href="#69_slot_2320" rel="nofollow">6.9. 【slot】</a></li><li><ul><li><a href="#1__2321" rel="nofollow">1. 默认插槽</a></li><li><a href="#2__2339" rel="nofollow">2. 具名插槽</a></li><li><a href="#3__2361" rel="nofollow">3. 作用域插槽</a></li></ul> 
  </li></ul> 
  </li><li><a href="#7__API_2393" rel="nofollow">7. 其它 API</a></li><li><ul><li><a href="#71shallowRef__shallowReactive__2394" rel="nofollow">7.1.【shallowRef 与 shallowReactive 】</a></li><li><ul><li><a href="#shallowRef_2395" rel="nofollow">`shallowRef`</a></li><li><a href="#shallowReactive_2404" rel="nofollow">`shallowReactive`</a></li><li><a href="#_2413" rel="nofollow">总结</a></li></ul> 
   </li><li><a href="#72readonly__shallowReadonly_2416" rel="nofollow">7.2.【readonly 与 shallowReadonly】</a></li><li><ul><li><a href="#readonly_2417" rel="nofollow">`**readonly**`</a></li><li><a href="#shallowReadonly_2432" rel="nofollow">`**shallowReadonly**`</a></li></ul> 
   </li><li><a href="#73toRaw__markRaw_2444" rel="nofollow">7.3.【toRaw 与 markRaw】</a></li><li><ul><li><a href="#toRaw_2445" rel="nofollow">`toRaw`</a></li><li><a href="#markRaw_2477" rel="nofollow">`markRaw`</a></li></ul> 
   </li><li><a href="#74customRef_2494" rel="nofollow">7.4.【customRef】</a></li></ul> 
  </li><li><a href="#8_Vue3_2521" rel="nofollow">8. Vue3新组件</a></li><li><ul><li><a href="#81_Teleport_2522" rel="nofollow">8.1. 【Teleport】</a></li><li><a href="#82_Suspense_2534" rel="nofollow">8.2. 【Suspense】</a></li><li><a href="#83API_2559" rel="nofollow">8.3.【全局API转移到应用对象】</a></li><li><a href="#84_2567" rel="nofollow">8.4.【其他】</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1_Vue3_19"></a>1. Vue3简介</h2> 
<ul><li>2020年9月18日，<code>Vue.js</code>发布版<code>3.0</code>版本，代号：<code>One Piece</code>（n</li><li>经历了：<a href="https://github.com/vuejs/core/commits/main">4800+次提交</a>、<a href="https://github.com/vuejs/rfcs/tree/master/active-rfcs">40+个RFC</a>、<a href="https://github.com/vuejs/vue-next/pulls?q=is%3Apr+is%3Amerged+-author%3Aapp%2Fdependabot-preview+">600+次PR</a>、<a href="https://github.com/vuejs/core/graphs/contributors">300+贡献者</a></li><li>官方发版地址：<a href="https://github.com/vuejs/core/releases/tag/v3.0.0">Release v3.0.0 One Piece · vuejs/core</a></li><li>截止2023年10月，最新的公开版本为：<code>3.3.4</code> <img src="https://images2.imgbox.com/6a/eb/91ClaoFx_o.png" alt="1695089947298-161c1b47-eb86-42fb-b1f8-d6a4fcab8ee2.png"></li></ul> 
<h3><a id="11__25"></a>1.1. 【性能的提升】</h3> 
<ul><li>打包大小减少<code>41%</code>。</li><li>初次渲染快<code>55%</code>, 更新渲染快<code>133%</code>。</li><li>内存减少<code>54%</code>。</li></ul> 
<h3><a id="12__30"></a>1.2.【 源码的升级】</h3> 
<ul><li>使用<code>Proxy</code>代替<code>defineProperty</code>实现响应式。</li><li>重写虚拟<code>DOM</code>的实现和<code>Tree-Shaking</code>。</li></ul> 
<h3><a id="13_TypeScript_34"></a>1.3. 【拥抱TypeScript】</h3> 
<ul><li><code>Vue3</code>可以更好的支持<code>TypeScript</code>。</li></ul> 
<h3><a id="14__37"></a>1.4. 【新的特性】</h3> 
<ol><li><code>Composition API</code>（组合<code>API</code>）：</li></ol> 
<ul><li><code>setup</code></li><li><code>ref</code>与<code>reactive</code></li><li><code>computed</code>与<code>watch</code><br> …</li></ul> 
<ol start="2"><li>新的内置组件：</li></ol> 
<ul><li><code>Fragment</code></li><li><code>Teleport</code></li><li><code>Suspense</code><br> …</li></ul> 
<ol start="3"><li>其他改变：</li></ol> 
<ul><li>新的生命周期钩子</li><li><code>data</code> 选项应始终被声明为一个函数</li><li>移除<code>keyCode</code>支持作为<code>v-on</code> 的修饰符<br> …</li></ul> 
<h2><a id="2_Vue3_54"></a>2. 创建Vue3工程</h2> 
<h3><a id="21__vuecli__55"></a>2.1. 【基于 vue-cli 创建】</h3> 
<p>点击查看<a href="https://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create" rel="nofollow">官方文档</a></p> 
<blockquote> 
 <p>vue-cli 是基于 webpack 创建的<br> 备注：目前<code>vue-cli</code>已处于维护模式，官方推荐基于 <code>Vite</code> 创建项目。</p> 
</blockquote> 
<pre><code class="prism language-powershell"><span class="token comment">## 查看@vue/cli版本，确保@vue/cli版本在4.5.0以上</span>
vue <span class="token operator">--</span>version

<span class="token comment">## 安装或者升级你的@vue/cli </span>
npm install <span class="token operator">-</span>g @vue/<span class="token function">cli</span>

<span class="token comment">## 执行创建命令</span>
vue create vue_test

<span class="token comment">##  随后选择3.x</span>
<span class="token comment">##  Choose a version of Vue.js that you want to start the project with (Use arrow keys)</span>
<span class="token comment">##  &gt; 3.x</span>
<span class="token comment">##    2.x</span>

<span class="token comment">## 启动</span>
cd vue_test
npm run serve
</code></pre> 
<hr> 
<h3><a id="22__vite__82"></a>2.2. 【基于 vite 创建】(推荐)</h3> 
<p><code>vite</code> 是新一代前端构建工具，官网地址：<a href="https://vitejs.cn/" rel="nofollow">https://vitejs.cn</a>，<code>vite</code>的优势如下：</p> 
<ul><li>轻量快速的热重载（<code>HMR</code>），能实现极速的服务启动。</li><li>对 <code>TypeScript</code>、<code>JSX</code>、<code>CSS</code> 等支持开箱即用。</li><li>真正的按需编译，不再等待整个应用编译完成。</li><li><code>webpack</code>构建 与 <code>vite</code>构建对比图如下：<br> <img src="https://images2.imgbox.com/7f/a5/EPxDaUK9_o.png" alt="1683167182037-71c78210-8217-4e7d-9a83-e463035efbbe.png"><img src="https://images2.imgbox.com/d6/3b/zMj3aee0_o.png" alt="1683167204081-582dc237-72bc-499e-9589-2cdfd452e62f.png">- 具体操作如下（点击查看<a href="https://cn.vuejs.org/guide/quick-start.html#creating-a-vue-application" rel="nofollow">官方文档</a>）</li></ul> 
<pre><code class="prism language-powershell"><span class="token comment">## 1.创建命令</span>
npm create vue@latest

<span class="token comment">## 2.具体配置</span>
<span class="token comment">## 配置项目名称</span>
√ Project name: vue3_test
<span class="token comment">## 是否添加TypeScript支持</span>
√ Add TypeScript?  Yes
<span class="token comment">## 是否添加JSX支持</span>
√ Add JSX Support?  No
<span class="token comment">## 是否添加路由环境</span>
√ Add Vue Router <span class="token keyword">for</span> Single Page Application development?  No
<span class="token comment">## 是否添加pinia环境</span>
√ Add Pinia <span class="token keyword">for</span> state management?  No
<span class="token comment">## 是否添加单元测试</span>
√ Add Vitest <span class="token keyword">for</span> Unit Testing?  No
<span class="token comment">## 是否添加端到端测试方案</span>
√ Add an <span class="token keyword">End</span><span class="token operator">-</span>to-<span class="token keyword">End</span> Testing Solution? » No
<span class="token comment">## 是否添加ESLint语法检查</span>
√ Add ESLint <span class="token keyword">for</span> code quality?  Yes
<span class="token comment">## 是否添加Prettiert代码格式化</span>
√ Add Prettier <span class="token keyword">for</span> code formatting?  No
</code></pre> 
<p>启动：1、安装依赖：npm install 2、启动 npm run dev<br> 使用 VSCode 打开会发现 src 下文件 main.ts 中导入 App.vue 爆红，需要在 env.d.ts 中添加以下内容，或者安装 Volar 插件</p> 
<pre><code class="prism language-tsx">/// &lt;reference types="vite/client" /&gt;


declare module "*.vue" {
  import { DefineComponent } from "vue"
  const component: DefineComponent&lt;{}, {}, any&gt;
  export default component
}
</code></pre> 
<p>自己动手编写一个App组件</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="app"&gt;
    &lt;h1&gt;你好啊！&lt;/h1&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts"&gt;
  export default {
    name:'App' //组件名
  }
&lt;/script&gt;

&lt;style&gt;
  .app {
    background-color: #ddd;
    box-shadow: 0 0 10px;
    border-radius: 10px;
    padding: 20px;
  }
&lt;/style&gt;
</code></pre> 
<p>安装官方推荐的<code>vscode</code>插件：<br> <img src="https://images2.imgbox.com/7c/3a/kWjBXpgQ_o.png" alt="volar.png"><img src="https://images2.imgbox.com/22/44/sG7jMJ2q_o.png" alt="image-20231218085906380.png"><br> 总结：</p> 
<ul><li><code>Vite</code> 项目中，<code>index.html</code> 是项目的入口文件，在项目最外层。</li><li>加载<code>index.html</code>后，<code>Vite</code> 解析 <code>&lt;script type="module" src="xxx"&gt;</code> 指向的<code>JavaScript</code>。</li><li><code>Vue3</code>**中是通过 **<code>createApp</code> 函数创建一个应用实例。</li></ul> 
<h3><a id="23__156"></a>2.3. 【一个简单的效果】</h3> 
<p><code>Vue3</code>向下兼容<code>Vue2</code>语法，且<code>Vue3</code>中的模板中可以没有根标签</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h2&gt;姓名：{<!-- -->{name}}&lt;/h2&gt;
    &lt;h2&gt;年龄：{<!-- -->{age}}&lt;/h2&gt;
    &lt;button @click="changeName"&gt;修改名字&lt;/button&gt;
    &lt;button @click="changeAge"&gt;年龄+1&lt;/button&gt;
    &lt;button @click="showTel"&gt;点我查看联系方式&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts"&gt;
  export default {
    name:'App',
    data() {
      return {
        name:'张三',
        age:18,
        tel:'13888888888'
      }
    },
    methods:{
      changeName(){
        this.name = 'zhang-san'
      },
      changeAge(){
        this.age += 1
      },
      showTel(){
        alert(this.tel)
      }
    },
  }
&lt;/script&gt;
</code></pre> 
<h2><a id="3_Vue3_193"></a>3. Vue3核心语法</h2> 
<h3><a id="31__OptionsAPI__CompositionAPI_194"></a>3.1. 【OptionsAPI 与 CompositionAPI】</h3> 
<ul><li><code>Vue2</code>的<code>API</code>设计是<code>Options</code>（配置）风格的。</li><li><code>Vue3</code>的<code>API</code>设计是<code>Composition</code>（组合）风格的。</li></ul> 
<h4><a id="Options_API__198"></a>Options API 的弊端</h4> 
<p><code>Options</code>类型的 <code>API</code>，数据、方法、计算属性等，是分散在：<code>data</code>、<code>methods</code>、<code>computed</code>中的，若想新增或者修改一个需求，就需要分别修改：<code>data</code>、<code>methods</code>、<code>computed</code>，不便于维护和复用。<img src="https://images2.imgbox.com/5d/9f/DYZ2dx7b_o.gif" alt="1696662197101-55d2b251-f6e5-47f4-b3f1-d8531bbf9279.gif"><img src="https://images2.imgbox.com/d9/54/cCbGyNcf_o.gif" alt="1696662200734-1bad8249-d7a2-423e-a3c3-ab4c110628be.gif"></p> 
<h4><a id="Composition_API__200"></a>Composition API 的优势</h4> 
<p><img src="https://images2.imgbox.com/93/89/S9FaFhU2_o.gif" alt="1696662249851-db6403a1-acb5-481a-88e0-e1e34d2ef53a.gif"><img src="https://images2.imgbox.com/24/24/JHONLhf3_o.gif" alt="1696662256560-7239b9f9-a770-43c1-9386-6cc12ef1e9c0.gif"><br> 可以用函数的方式，更加优雅的组织代码，让相关功能的代码更加有序的组织在一起。</p> 
<blockquote> 
 <p>说明：以上四张动图原创作者：大帅老猿</p> 
</blockquote> 
<h3><a id="32__setup_205"></a>3.2. 【拉开序幕的 setup】</h3> 
<h4><a id="setup__206"></a>setup 概述</h4> 
<p><code>setup</code>是<code>Vue3</code>中一个新的配置项，值是一个函数，它是 <code>Composition API</code> <strong>“表演的舞台</strong><em><strong>”</strong></em>，组件中所用到的：数据、方法、计算属性、监视…等等，均配置在<code>setup</code>中。<br> 特点如下：</p> 
<ul><li><code>setup</code>函数返回的对象中的内容，可直接在模板中使用。</li><li><code>setup</code>中访问<code>this</code>是<code>undefined</code>。</li><li><code>setup</code>函数会在<code>beforeCreate</code>之前调用，它是“领先”所有钩子执行的。</li></ul> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h2&gt;姓名：{<!-- -->{name}}&lt;/h2&gt;
    &lt;h2&gt;年龄：{<!-- -->{age}}&lt;/h2&gt;
    &lt;button @click="changeName"&gt;修改名字&lt;/button&gt;
    &lt;button @click="changeAge"&gt;年龄+1&lt;/button&gt;
    &lt;button @click="showTel"&gt;点我查看联系方式&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts"&gt;
  export default {
    name:'Person',
    setup(){
      // 数据，原来写在data中（注意：此时的name、age、tel数据都不是响应式数据）
      let name = '张三'
      let age = 18
      let tel = '13888888888'

      // 方法，原来写在methods中
      function changeName(){
        name = 'zhang-san' //注意：此时这么修改name页面是不变化的
        console.log(name)
      }
      function changeAge(){
        age += 1 //注意：此时这么修改age页面是不变化的
        console.log(age)
      }
      function showTel(){
        alert(tel)
      }

      // 返回一个对象，对象中的内容，模板中可以直接使用
      return {name,age,tel,changeName,changeAge,showTel}
    }
  }
&lt;/script&gt;
</code></pre> 
<h4><a id="setup__252"></a>setup 的返回值</h4> 
<ul><li>若返回一个<strong>对象</strong>：则对象中的：属性、方法等，在模板中均可以直接使用**（重点关注）。**</li><li>若返回一个<strong>函数</strong>：则可以自定义渲染内容，代码如下：</li></ul> 
<pre><code class="prism language-jsx">setup(){
  return ()=&gt; '你好啊！'
}
</code></pre> 
<h4><a id="setup__Options_API__261"></a>setup 与 Options API 的关系</h4> 
<ul><li><code>Vue2</code> 的配置（<code>data</code>、<code>methos</code>…）中<strong>可以访问到</strong> <code>setup</code>中的属性、方法。</li><li>但在<code>setup</code>中<strong>不能访问到</strong><code>Vue2</code>的配置（<code>data</code>、<code>methos</code>…）。</li><li>如果与<code>Vue2</code>冲突，则<code>setup</code>优先。</li></ul> 
<h4><a id="setup__266"></a>setup 语法糖</h4> 
<p><code>setup</code>函数有一个语法糖，这个语法糖，可以让我们把<code>setup</code>独立出去，代码如下：</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h2&gt;姓名：{<!-- -->{name}}&lt;/h2&gt;
    &lt;h2&gt;年龄：{<!-- -->{age}}&lt;/h2&gt;
    &lt;button @click="changName"&gt;修改名字&lt;/button&gt;
    &lt;button @click="changAge"&gt;年龄+1&lt;/button&gt;
    &lt;button @click="showTel"&gt;点我查看联系方式&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts"&gt;
  export default {
    name:'Person',
  }
&lt;/script&gt;

&lt;!-- 下面的写法是setup语法糖 --&gt;
&lt;script setup lang="ts"&gt;
  console.log(this) //undefined
  
  // 数据（注意：此时的name、age、tel都不是响应式数据）
  let name = '张三'
  let age = 18
  let tel = '13888888888'

  // 方法
  function changName(){
    name = '李四'//注意：此时这么修改name页面是不变化的
  }
  function changAge(){
    console.log(age)
    age += 1 //注意：此时这么修改age页面是不变化的
  }
  function showTel(){
    alert(tel)
  }
&lt;/script&gt;
</code></pre> 
<p>扩展：上述代码，还需要编写一个不写<code>setup</code>的<code>script</code>标签，去指定组件名字，比较麻烦，我们可以借助<code>vite</code>中的插件简化</p> 
<ol><li>第一步：<code>npm i vite-plugin-vue-setup-extend -D</code></li><li>第二步：<code>vite.config.ts</code></li></ol> 
<pre><code class="prism language-jsx">import { defineConfig } from 'vite'
import VueSetupExtend from 'vite-plugin-vue-setup-extend'

export default defineConfig({
  plugins: [ VueSetupExtend() ]
})
</code></pre> 
<ol start="3"><li>第三步：<code>&lt;script setup lang="ts" name="Person"&gt;</code></li></ol> 
<h3><a id="33_ref__321"></a>3.3. 【ref 创建：基本类型的响应式数据】</h3> 
<ul><li>**作用：**定义响应式变量。</li><li><strong>语法：</strong><code>let xxx = ref(初始值)</code>。</li><li>**返回值：**一个<code>RefImpl</code>的实例对象，简称<code>ref对象</code>或<code>ref</code>，<code>ref</code>对象的<code>value</code><strong>属性是响应式的</strong>。</li><li><strong>注意点：</strong> 
  <ul><li><code>JS</code>中操作数据需要：<code>xxx.value</code>，但模板中不需要<code>.value</code>，直接使用即可。</li><li>对于<code>let name = ref('张三')</code>来说，<code>name</code>不是响应式的，<code>name.value</code>是响应式的。</li></ul> </li></ul> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h2&gt;姓名：{<!-- -->{name}}&lt;/h2&gt;
    &lt;h2&gt;年龄：{<!-- -->{age}}&lt;/h2&gt;
    &lt;button @click="changeName"&gt;修改名字&lt;/button&gt;
    &lt;button @click="changeAge"&gt;年龄+1&lt;/button&gt;
    &lt;button @click="showTel"&gt;点我查看联系方式&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts" name="Person"&gt;
  import {ref} from 'vue'
  // name和age是一个RefImpl的实例对象，简称ref对象，它们的value属性是响应式的。
  let name = ref('张三')
  let age = ref(18)
  // tel就是一个普通的字符串，不是响应式的
  let tel = '13888888888'

  function changeName(){
    // JS中操作ref对象时候需要.value
    name.value = '李四'
    console.log(name.value)

    // 注意：name不是响应式的，name.value是响应式的，所以如下代码并不会引起页面的更新。
    // name = ref('zhang-san')
  }
  function changeAge(){
    // JS中操作ref对象时候需要.value
    age.value += 1 
    console.log(age.value)
  }
  function showTel(){
    alert(tel)
  }
&lt;/script&gt;
</code></pre> 
<h3><a id="34_reactive__366"></a>3.4. 【reactive 创建：对象类型的响应式数据】</h3> 
<ul><li><strong>作用：<strong>定义一个</strong>响应式对象</strong>（基本类型不要用它，要用<code>ref</code>，否则报错）</li><li><strong>语法：</strong><code>let 响应式对象= reactive(源对象)</code>。</li><li>**返回值：**一个<code>Proxy</code>的实例对象，简称：响应式对象。</li><li><strong>注意点：</strong><code>reactive</code>定义的响应式数据是“深层次”的。</li></ul> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h2&gt;汽车信息：一台{<!-- -->{ car.brand }}汽车，价值{<!-- -->{ car.price }}万&lt;/h2&gt;
    &lt;h2&gt;游戏列表：&lt;/h2&gt;
    &lt;ul&gt;
      &lt;li v-for="g in games" :key="g.id"&gt;{<!-- -->{ g.name }}&lt;/li&gt;
    &lt;/ul&gt;
    &lt;h2&gt;测试：{<!-- -->{obj.a.b.c.d}}&lt;/h2&gt;
    &lt;button @click="changeCarPrice"&gt;修改汽车价格&lt;/button&gt;
    &lt;button @click="changeFirstGame"&gt;修改第一游戏&lt;/button&gt;
    &lt;button @click="test"&gt;测试&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts" setup name="Person"&gt;
import { reactive } from 'vue'

// 数据
let car = reactive({ brand: '奔驰', price: 100 })
let games = reactive([
  { id: 'ahsgdyfa01', name: '英雄联盟' },
  { id: 'ahsgdyfa02', name: '王者荣耀' },
  { id: 'ahsgdyfa03', name: '原神' }
])
let obj = reactive({
  a:{
    b:{
      c:{
        d:666
      }
    }
  }
})

function changeCarPrice() {
  car.price += 10
}
function changeFirstGame() {
  games[0].name = '流星蝴蝶剑'
}
function test(){
  obj.a.b.c.d = 999
}
&lt;/script&gt;
</code></pre> 
<h3><a id="35_ref__418"></a>3.5. 【ref 创建：对象类型的响应式数据】</h3> 
<ul><li>其实<code>ref</code>接收的数据可以是：<strong>基本类型</strong>、<strong>对象类型</strong>。</li><li>若<code>ref</code>接收的是对象类型，内部其实也是调用了<code>reactive</code>函数。</li></ul> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h2&gt;汽车信息：一辆{<!-- -->{ car.brand }}车，价格{<!-- -->{ car.price }}万&lt;/h2&gt;
    &lt;button @click="changePrice"&gt;修改价格&lt;/button&gt;
    &lt;ul&gt;
      &lt;li v-for="item in games" :key="item.id"&gt;{<!-- -->{ item.name }}&lt;/li&gt;
    &lt;/ul&gt;
    &lt;button @click="changeFirstName"&gt;修改游戏第一个名字&lt;/button&gt;
    &lt;h2&gt;测试嵌套对象：{<!-- -->{ obj.a.b.c.d }}&lt;/h2&gt;
    &lt;button @click="changeObj"&gt;修改嵌套对象的值&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts" setup name="Person"&gt;
import { reactive,ref } from "vue";
  let car =reactive({brand:"宝马",price:100})
  let games = reactive([
    {id:"01",name:"游戏1"},
    {id:"02",name:"游戏2"},
    {id:"03",name:"游戏3"}
  ])
  let obj = reactive({
    a:{
      b:{
        c:{
          d : 666
        }
      }
    }
  })
  function changePrice(){
    car.price +=10
  }
  function changeFirstName(){
    games[0].name = "王者荣耀"
    console.log('object :&gt;&gt; ', games[0].name);
  }
  function changeObj(){
    obj.a.b.c.d = 999
  }
&lt;/script&gt;

&lt;style scoped&gt;
.person {
  background-color: skyblue;
  box-shadow: 0 0 10px;
  border-radius: 10px;
  padding: 20px;
}
button {
  margin: 0 5px;
}
li{
  font-size: 20px;
}
&lt;/style&gt;
</code></pre> 
<h3><a id="36_ref__reactive_480"></a>3.6. 【ref 对比 reactive】</h3> 
<p>宏观角度看：</p> 
<blockquote> 
 <ol><li><code>ref</code>用来定义：<strong>基本类型数据</strong>、<strong>对象类型数据</strong>；</li><li><code>reactive</code>用来定义：<strong>对象类型数据</strong>。</li></ol> 
</blockquote> 
<ul><li>区别：</li></ul> 
<blockquote> 
 <ol><li><code>ref</code>创建的变量必须使用<code>.value</code>（可以使用<code>volar</code>插件自动添加<code>.value</code>）。 <img src="https://images2.imgbox.com/70/f6/1D4KlMtH_o.png" alt="自动补充value.png"></li><li><code>reactive</code>重新分配一个新对象，会<strong>失去</strong>响应式（可以使用<code>Object.assign</code>去整体替换）。</li></ol> 
</blockquote> 
<pre><code>   `Object.assign(oldObj,newObj)`
</code></pre> 
<ul><li>使用原则：</li></ul> 
<blockquote> 
 <ol><li>若需要一个基本类型的响应式数据，必须使用<code>ref</code>。</li><li>若需要一个响应式对象，层级不深，<code>ref</code>、<code>reactive</code>都可以。</li><li>若需要一个响应式对象，且层级较深，推荐使用<code>reactive</code>。</li></ol> 
</blockquote> 
<h3><a id="37_toRefs__toRef_496"></a>3.7. 【toRefs 与 toRef】</h3> 
<ul><li>作用：将一个响应式对象中的每一个属性，转换为<code>ref</code>对象。</li><li>备注：<code>toRefs</code>与<code>toRef</code>功能一致，但<code>toRefs</code>可以批量转换。</li><li>语法如下：</li></ul> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h2&gt;姓名：{<!-- -->{person.name}}&lt;/h2&gt;
    &lt;h2&gt;年龄：{<!-- -->{person.age}}&lt;/h2&gt;
    &lt;h2&gt;性别：{<!-- -->{person.gender}}&lt;/h2&gt;
    &lt;button @click="changeName"&gt;修改名字&lt;/button&gt;
    &lt;button @click="changeAge"&gt;修改年龄&lt;/button&gt;
    &lt;button @click="changeGender"&gt;修改性别&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts" setup name="Person"&gt;
  import {ref,reactive,toRefs,toRef} from 'vue'

  // 数据
  let person = reactive({name:'张三', age:18, gender:'男'})
	
  // 通过toRefs将person对象中的n个属性批量取出，且依然保持响应式的能力
  let {name,gender} =  toRefs(person)
	
  // 通过toRef将person对象中的gender属性取出，且依然保持响应式的能力
  let age = toRef(person,'age')

  // 方法
  function changeName(){
    name.value += '~'
  }
  function changeAge(){
    age.value += 1
  }
  function changeGender(){
    gender.value = '女'
  }
&lt;/script&gt;
</code></pre> 
<h3><a id="38_computed_537"></a>3.8. 【computed】</h3> 
<p>作用：根据已有数据计算出新数据（和<code>Vue2</code>中的<code>computed</code>作用一致）。<br> <img src="https://images2.imgbox.com/7b/b3/NrKzKaTb_o.gif" alt="computed.gif"></p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    姓：&lt;input type="text" v-model="firstName"&gt;&lt;br/&gt;
    名：&lt;input type="text" v-model="lastName"&gt;&lt;br/&gt;
    全名：&lt;span&gt;{<!-- -->{ fullName }}&lt;/span&gt;&lt;br/&gt;
    &lt;button @click="changeFullName"&gt;点击按钮修改名字为lisi&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts" setup name="Person"&gt;
import { ref,computed} from "vue"

  let firstName = ref("zhang");
  let lastName = ref("san"); 
  
  // 计算属性——只读取，不修改
  // let fullName = computed(()=&gt;{
  //   return firstName.value + " - " + lastName.value;
  // })

  // 计算属性——既读取又修改
  let fullName = computed({
    // 读取
    get(){
      return firstName.value.slice(0,1).toUpperCase() + firstName.value.slice(1) +" - " + lastName.value;
    },
    // 修改
    set(val){
      // firstName.value = val.split('-')[0]
      // lastName.value = val.split('-')[1]
      // 修改fullName的值
      console.log('val :&gt;&gt; ', val);
      const [str1,str2] = val.split("-");
      firstName.value = str1.slice(0,1).toUpperCase() + str1.slice(1);
      lastName.value = str2;
    }
  });

  function changeFullName(){
    fullName.value = "li - si"
  }

&lt;/script&gt;

&lt;style scoped&gt;
.person {
  background-color: skyblue;
  box-shadow: 0 0 10px;
  border-radius: 10px;
  padding: 20px;
}

button {
  margin: 0 5px;
}
&lt;/style&gt;
</code></pre> 
<h3><a id="39watch_598"></a>3.9.【watch】</h3> 
<ul><li>作用：监视数据的变化（和<code>Vue2</code>中的<code>watch</code>作用一致）</li><li>特点：<code>Vue3</code>中的<code>watch</code>只能监视以下<strong>四种数据</strong>：</li></ul> 
<blockquote> 
 <ol><li><code>ref</code>定义的数据。</li><li><code>reactive</code>定义的数据。</li><li>函数返回一个值（<code>getter</code>函数）。</li><li>一个包含上述内容的数组。</li></ol> 
</blockquote> 
<p>我们在<code>Vue3</code>中使用<code>watch</code>的时候，通常会遇到以下几种情况：</p> 
<h4><a id="_ref_608"></a>情况一 (ref)</h4> 
<p>监视<code>ref</code>定义的【基本类型】数据：直接写数据名即可，监视的是其<code>value</code>值的改变。</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h1&gt;情况一：监视【ref】定义的【基本类型】数据&lt;/h1&gt;
    &lt;h2&gt;当前求和为：{<!-- -->{sum}}&lt;/h2&gt;
    &lt;button @click="changeSum"&gt;点我sum+1&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts" setup name="Person"&gt;
  import {ref,watch} from 'vue'
  // 数据
  let sum = ref(0)
  // 方法
  function changeSum(){
    sum.value += 1
  }
  // 监视，情况一：监视【ref】定义的【基本类型】数据
  const stopWatch = watch(sum,(newValue,oldValue)=&gt;{
    console.log('sum变化了',newValue,oldValue)
    if(newValue &gt;= 10){
      stopWatch()
    }
  })
&lt;/script&gt;
</code></pre> 
<h4><a id="_ref_636"></a>情况二 (ref)</h4> 
<p>监视<code>ref</code>定义的【对象类型】数据：直接写数据名，监视的是对象的【地址值】，若想监视对象内部的数据，要手动开启深度监视。</p> 
<blockquote> 
 <p>注意：</p> 
 <ul><li>若修改的是<code>ref</code>定义的对象中的属性，<code>newValue</code> 和 <code>oldValue</code> 都是新值，因为它们是同一个对象。</li><li>若修改整个<code>ref</code>定义的对象，<code>newValue</code> 是新值， <code>oldValue</code> 是旧值，因为不是同一个对象了。</li></ul> 
</blockquote> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h1&gt;情况二：监视【ref】定义的【对象类型】数据&lt;/h1&gt;
    &lt;h2&gt;姓名：{<!-- -->{ person.name }}&lt;/h2&gt;
    &lt;h2&gt;年龄：{<!-- -->{ person.age }}&lt;/h2&gt;
    &lt;button @click="changeName"&gt;修改名字&lt;/button&gt;
    &lt;button @click="changeAge"&gt;修改年龄&lt;/button&gt;
    &lt;button @click="changePerson"&gt;修改整个人&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts" setup name="Person"&gt;
  import {ref,watch} from 'vue'
  // 数据
  let person = ref({
    name:'张三',
    age:18
  })
  // 方法
  function changeName(){
    person.value.name += '~'
  }
  function changeAge(){
    person.value.age += 1
  }
  function changePerson(){
    person.value = {name:'李四',age:90}
  }
  /* 
    监视，情况一：监视【ref】定义的【对象类型】数据，监视的是对象的地址值，若想监视对象内部属性的变化，需要手动开启深度监视
    watch的第一个参数是：被监视的数据
    watch的第二个参数是：监视的回调
    watch的第三个参数是：配置对象（deep、immediate等等.....） 
  */
  watch(person,(newValue,oldValue)=&gt;{
    console.log('person变化了',newValue,oldValue)
  },{deep:true})
  
&lt;/script&gt;
</code></pre> 
<h4><a id="_reactive_683"></a>情况三 (reactive)</h4> 
<p>监视<code>reactive</code>定义的【对象类型】数据，且默认开启了深度监视。</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h1&gt;情况三：监视【reactive】定义的【对象类型】数据&lt;/h1&gt;
    &lt;h2&gt;姓名：{<!-- -->{ person.name }}&lt;/h2&gt;
    &lt;h2&gt;年龄：{<!-- -->{ person.age }}&lt;/h2&gt;
    &lt;button @click="changeName"&gt;修改名字&lt;/button&gt;
    &lt;button @click="changeAge"&gt;修改年龄&lt;/button&gt;
    &lt;button @click="changePerson"&gt;修改整个人&lt;/button&gt;
    &lt;hr&gt;
    &lt;h2&gt;测试：{<!-- -->{obj.a.b.c}}&lt;/h2&gt;
    &lt;button @click="test"&gt;修改obj.a.b.c&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts" setup name="Person"&gt;
  import {reactive,watch} from 'vue'
  // 数据
  let person = reactive({
    name:'张三',
    age:18
  })
  let obj = reactive({
    a:{
      b:{
        c:666
      }
    }
  })
  // 方法
  function changeName(){
    person.name += '~'
  }
  function changeAge(){
    person.age += 1
  }
  function changePerson(){
    Object.assign(person,{name:'李四',age:80})
  }
  function test(){
    obj.a.b.c = 888
  }

  // 监视，情况三：监视【reactive】定义的【对象类型】数据，且默认是开启深度监视的
  watch(person,(newValue,oldValue)=&gt;{
    console.log('person变化了',newValue,oldValue)
  })
  watch(obj,(newValue,oldValue)=&gt;{
    console.log('Obj变化了',newValue,oldValue)
  })
&lt;/script&gt;
</code></pre> 
<h4><a id="__737"></a>情况四 （对象类型）</h4> 
<p>监视<code>ref</code>或<code>reactive</code>定义的【对象类型】数据中的<strong>某个属性</strong>，注意点如下：</p> 
<ol><li>若该属性值<strong>不是</strong>【对象类型】，需要写成函数形式。</li><li>若该属性值是<strong>依然</strong>是【对象类型】，可直接编，也可写成函数，建议写成函数。</li></ol> 
<p>结论：监视的要是对象里的属性，那么最好写函数式，注意点：若是对象监视的是地址值，需要关注对象内部，需要手动开启深度监视。</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h1&gt;情况四：监视【ref】或【reactive】定义的【对象类型】数据中的某个属性&lt;/h1&gt;
    &lt;h2&gt;姓名：{<!-- -->{ person.name }}&lt;/h2&gt;
    &lt;h2&gt;年龄：{<!-- -->{ person.age }}&lt;/h2&gt;
    &lt;h2&gt;汽车：{<!-- -->{ person.car.c1 }}、{<!-- -->{ person.car.c2 }}&lt;/h2&gt;
    &lt;button @click="changeName"&gt;修改名字&lt;/button&gt;
    &lt;button @click="changeAge"&gt;修改年龄&lt;/button&gt;
    &lt;button @click="changeC1"&gt;修改第一台车&lt;/button&gt;
    &lt;button @click="changeC2"&gt;修改第二台车&lt;/button&gt;
    &lt;button @click="changeCar"&gt;修改整个车&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts" setup name="Person"&gt;
  import {reactive,watch} from 'vue'

  // 数据
  let person = reactive({
    name:'张三',
    age:18,
    car:{
      c1:'奔驰',
      c2:'宝马'
    }
  })
  // 方法
  function changeName(){
    person.name += '~'
  }
  function changeAge(){
    person.age += 1
  }
  function changeC1(){
    person.car.c1 = '奥迪'
  }
  function changeC2(){
    person.car.c2 = '大众'
  }
  function changeCar(){
    person.car = {c1:'雅迪',c2:'爱玛'}
  }

  // 监视，情况四：监视响应式对象中的某个属性，且该属性是基本类型的，要写成函数式
  /* watch(()=&gt; person.name,(newValue,oldValue)=&gt;{
    console.log('person.name变化了',newValue,oldValue)
  }) */

  // 监视，情况四：监视响应式对象中的某个属性，且该属性是对象类型的，可以直接写，也能写函数，更推荐写函数
  watch(()=&gt;person.car,(newValue,oldValue)=&gt;{
    console.log('person.car变化了',newValue,oldValue)
  },{deep:true})
&lt;/script&gt;
</code></pre> 
<h4><a id="_799"></a>情况五</h4> 
<p>监视上述的多个数据</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h1&gt;情况五：监视上述的多个数据&lt;/h1&gt;
    &lt;h2&gt;姓名：{<!-- -->{ person.name }}&lt;/h2&gt;
    &lt;h2&gt;年龄：{<!-- -->{ person.age }}&lt;/h2&gt;
    &lt;h2&gt;汽车：{<!-- -->{ person.car.c1 }}、{<!-- -->{ person.car.c2 }}&lt;/h2&gt;
    &lt;button @click="changeName"&gt;修改名字&lt;/button&gt;
    &lt;button @click="changeAge"&gt;修改年龄&lt;/button&gt;
    &lt;button @click="changeC1"&gt;修改第一台车&lt;/button&gt;
    &lt;button @click="changeC2"&gt;修改第二台车&lt;/button&gt;
    &lt;button @click="changeCar"&gt;修改整个车&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts" setup name="Person"&gt;
  import {reactive,watch} from 'vue'

  // 数据
  let person = reactive({
    name:'张三',
    age:18,
    car:{
      c1:'奔驰',
      c2:'宝马'
    }
  })
  // 方法
  function changeName(){
    person.name += '~'
  }
  function changeAge(){
    person.age += 1
  }
  function changeC1(){
    person.car.c1 = '奥迪'
  }
  function changeC2(){
    person.car.c2 = '大众'
  }
  function changeCar(){
    person.car = {c1:'雅迪',c2:'爱玛'}
  }

  // 监视，情况五：监视上述的多个数据
  watch([()=&gt;person.name,person.car],(newValue,oldValue)=&gt;{
    console.log('person.car变化了',newValue,oldValue)
  },{deep:true})

&lt;/script&gt;
</code></pre> 
<h3><a id="310_watchEffect_852"></a>3.10. 【watchEffect】</h3> 
<ul><li>官网：立即运行一个函数，同时响应式地追踪其依赖，并在依赖更改时重新执行该函数。</li><li><code>watch</code>对比<code>watchEffect</code></li></ul> 
<blockquote> 
 <ol><li>都能监听响应式数据的变化，不同的是监听数据变化的方式不同</li><li><code>watch</code>：要明确指出监视的数据</li><li><code>watchEffect</code>：不用明确指出监视的数据（函数中用到哪些属性，那就监视哪些属性）。</li></ol> 
</blockquote> 
<ul><li>示例代码：</li></ul> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h2&gt;需求：水温达到50℃，或水位达到20cm，发送通知&lt;/h2&gt;
    &lt;h2&gt;水温：{<!-- -->{ temp }}℃&lt;/h2&gt;
    &lt;h2&gt;水位：{<!-- -->{ height }}cm&lt;/h2&gt;
    &lt;button @click="changeTemp"&gt;点击水温加10&lt;/button&gt;
    &lt;button @click="changeHeight"&gt;点击水位加10&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts" setup name="Person"&gt;
  import {ref,watch,watchEffect} from "vue"
  let temp = ref(10)
  let height = ref(0)

  function changeTemp(){
    temp.value += 10
  }
  function changeHeight(){
    height.value += 10
  }

  // watch([temp,height],(newValue,oldValue)=&gt;{  // 一个值就是改变之后的值
  //   // 从newValue中获取最新的temp值、height值
  //   let [newTemp,newHeight] = newValue;
  //   console.log('newTemp,newHeight :&gt;&gt; ', newTemp,newHeight);
  //   if(newTemp&gt;=50 || newHeight &gt;= 20){
  //     console.log("发送通知")
  //   }
  // })

  // 监视 watchEffect实现
  const stopWtach = watchEffect(()=&gt;{
    if(temp.value&gt;=50 || height.value&gt;=20){
      console.log("发送通知")
    }
    // 水温达到100，或水位达到50，取消监视
    if(temp.value === 100 || height.value === 50){
      console.log('清理了')
      stopWtach()
    }
  })
&lt;/script&gt;

&lt;style scoped&gt;
.person {
  background-color: skyblue;
  box-shadow: 0 0 10px;
  border-radius: 10px;
  padding: 20px;
}
button {
  margin: 0 5px;
}
&lt;/style&gt;
</code></pre> 
<h3><a id="311__ref__918"></a>3.11. 【标签的 ref 属性】</h3> 
<p>作用：用于注册模板引用。</p> 
<blockquote> 
 <ul><li>用在普通<code>DOM</code>标签上，获取的是<code>DOM</code>节点。</li><li>用在组件标签上，获取的是组件实例对象。</li></ul> 
</blockquote> 
<p>用在普通<code>DOM</code>标签上：</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h1 ref="title1"&gt;尚硅谷&lt;/h1&gt;
    &lt;h2 ref="title2"&gt;前端&lt;/h2&gt;
    &lt;h3 ref="title3"&gt;Vue&lt;/h3&gt;
    &lt;input type="text" ref="inpt"&gt; &lt;br&gt;&lt;br&gt;
    &lt;button @click="showLog"&gt;点我打印内容&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts" setup name="Person"&gt;
  import {ref} from 'vue'
	
  let title1 = ref()
  let title2 = ref()
  let title3 = ref()

  function showLog(){
    // 通过id获取元素
    const t1 = document.getElementById('title1')
    // 打印内容
    console.log((t1 as HTMLElement).innerText)
    console.log((&lt;HTMLElement&gt;t1).innerText)
    console.log(t1?.innerText)
    
		/************************************/
		
    // 通过ref获取元素
    console.log(title1.value)
    console.log(title2.value)
    console.log(title3.value)
  }
&lt;/script&gt;
</code></pre> 
<p>用在组件标签上：</p> 
<pre><code class="prism language-vue">&lt;!-- 父组件App.vue --&gt;
&lt;template&gt;
  &lt;Person ref="ren"/&gt;
  &lt;button @click="test"&gt;测试&lt;/button&gt;
&lt;/template&gt;

&lt;script lang="ts" setup name="App"&gt;
  import Person from './components/Person.vue'
  import {ref} from 'vue'

  let ren = ref()

  function test(){
    console.log(ren.value.name)
    console.log(ren.value.age)
  }
&lt;/script&gt;


&lt;!-- 子组件Person.vue中要使用defineExpose暴露内容 --&gt;
&lt;script lang="ts" setup name="Person"&gt;
  import {ref,defineExpose} from 'vue'
	// 数据
  let name = ref('张三')
  let age = ref(18)
  /****************************/
  /****************************/
  // 使用defineExpose将组件中的数据交给外部
  defineExpose({name,age})
&lt;/script&gt;
</code></pre> 
<h3><a id="312_props_992"></a>3.12. 【props】</h3> 
<pre><code class="prism language-java"><span class="token comment">// 定义一个接口，限制每个Person对象的格式</span>
export <span class="token keyword">interface</span> <span class="token class-name">PersonInter</span> <span class="token punctuation">{<!-- --></span>
    id<span class="token operator">:</span>string<span class="token punctuation">,</span>
    name<span class="token operator">:</span>string<span class="token punctuation">,</span>
    age<span class="token operator">:</span>number
<span class="token punctuation">}</span>

<span class="token comment">// 定义一个自定义类型Persons</span>
export type <span class="token class-name">Persons</span> <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PersonInter</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<blockquote> 
 <p><code>App.vue</code>中代码：</p> 
</blockquote> 
<pre><code class="prism language-vue">&lt;template&gt;
	&lt;Person :list="persons"/&gt;
&lt;/template&gt;
  
&lt;script lang="ts" setup name="App"&gt;
  import Person from './components/Person.vue'
  import {reactive} from 'vue'
    import {type Persons} from './types'
  
    let persons = reactive&lt;Persons&gt;([
     {id:'e98219e12',name:'张三',age:18},
      {id:'e98219e13',name:'李四',age:19},
       {id:'e98219e14',name:'王五',age:20}
     ])
   &lt;/script&gt;
</code></pre> 
<blockquote> 
 <p><code>Person.vue</code>中代码：</p> 
</blockquote> 
<pre><code class="prism language-vue">&lt;template&gt;
&lt;div class="person"&gt;
 &lt;ul&gt;
     &lt;li v-for="item in list" :key="item.id"&gt;
        {<!-- -->{item.name}}--{<!-- -->{item.age}}
      &lt;/li&gt;
    &lt;/ul&gt;
   &lt;/div&gt;
   &lt;/template&gt;
  
&lt;script lang="ts" setup name="Person"&gt;
import {defineProps} from 'vue'
import {type PersonInter} from '@/types'
  
  // 第一种写法：仅接收
// const props = defineProps(['list'])
  
  // 第二种写法：接收+限制类型
// defineProps&lt;{list:Persons}&gt;()
  
  // 第三种写法：接收+限制类型+指定默认值+限制必要性
let props = withDefaults(defineProps&lt;{list?:Persons}&gt;(),{
     list:()=&gt;[{id:'asdasg01',name:'小猪佩奇',age:18}]
  })
   console.log(props)
  &lt;/script&gt;
</code></pre> 
<h3><a id="313__1053"></a>3.13. 【生命周期】</h3> 
<ul><li>概念：<code>Vue</code>组件实例在创建时要经历一系列的初始化步骤，在此过程中<code>Vue</code>会在合适的时机，调用特定的函数，从而让开发者有机会在特定阶段运行自己的代码，这些特定的函数统称为：生命周期钩子</li><li>规律：</li></ul> 
<blockquote> 
 <p>生命周期整体分为四个阶段，分别是：<strong>创建、挂载、更新、销毁</strong>，每个阶段都有两个钩子，一前一后。</p> 
</blockquote> 
<ul><li><code>Vue2</code>的生命周期</li></ul> 
<blockquote> 
 <p>创建阶段：<code>beforeCreate</code>、<code>created</code><br> 挂载阶段：<code>beforeMount</code>、<code>mounted</code><br> 更新阶段：<code>beforeUpdate</code>、<code>updated</code><br> 销毁阶段：<code>beforeDestroy</code>、<code>destroyed</code></p> 
</blockquote> 
<p>Vue2 项目创建</p> 
<pre><code class="prism language-bash"><span class="token comment"># 安装Vue</span>
<span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-g</span> vue
<span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-g</span>  @vue/cli
vue create vue2_hello_world
</code></pre> 
<p>components 组件 Person.vue 代码</p> 
<pre><code class="prism language-vue">&lt;template&gt;
    &lt;div class="person"&gt;
        &lt;h2&gt;sum求和：{<!-- -->{ sum }}&lt;/h2&gt;
        &lt;button @click="add"&gt;点击sum+1&lt;/button&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;

export default {
  /* eslint-disable */
  name: 'Person',
  data(){
    return{
        sum:1
    }
  },
  methods:{
    add(){
        this.sum +=1
    }
  },
  // vue2 钩子的生命周期
  // 创建前
  beforeCreate(){
    console.log("创建前")
  },
  // 创建完毕
  created(){
    console.log("创建完毕")
  },
  // 挂载前
  beforeMount(){
    console.log("挂载前");
  },
  // 挂载完毕
  mounted(){
    console.log("挂载完毕");
  },
  // 更新前
  beforeUpdate(){
    console.log("更新前");
  },
  // 更新完毕
  updated(){
    console.log("更新完毕");
  },
  // 销毁前
  beforeDestroy(){
    console.log("销毁前");
  },
  // 销毁完毕
  destroyed(){
    console.log("销毁完毕");
  }

}
&lt;/script&gt;
&lt;style scoped&gt;
    .person {
        background-color: skyblue;
        box-shadow: 0 0 10px;
        border-radius: 10px;
        padding: 20px;
    }
&lt;/style&gt;
</code></pre> 
<p>App.vue 中代码</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div&gt;
    &lt;button  @click="hidd"&gt;销毁&lt;/button&gt;
    &lt;Person v-if="isShow"/&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import Person from "./components/Person.vue"
export default {
  /* eslint-disable */
  name: 'App',
  components:{Person},
  data(){
    return {
      isShow:true
    }
  },
  methods:{
    // 销毁生命周期
    hidd(){
      this.isShow = false
    }
  }
}
&lt;/script&gt;
&lt;style&gt;
</code></pre> 
<ul><li><code>Vue3</code>的生命周期</li></ul> 
<blockquote> 
 <p>创建阶段：<code>setup</code><br> 挂载阶段：<code>onBeforeMount</code>、<code>onMounted</code><br> 更新阶段：<code>onBeforeUpdate</code>、<code>onUpdated</code><br> 卸载阶段：<code>onBeforeUnmount</code>、<code>onUnmounted</code></p> 
</blockquote> 
<ul><li>常用的钩子：<code>onMounted</code>(挂载完毕)、<code>onUpdated</code>(更新完毕)、<code>onBeforeUnmount</code>(卸载之前)</li><li>示例代码：</li></ul> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
    &lt;h2&gt;sum求和：{<!-- -->{ sum }}&lt;/h2&gt;
    &lt;button @click="add"&gt;点击sum+1&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script lang="ts" setup name="Person"&gt;
  import {ref,onBeforeMount,onMounted,onBeforeUpdate,onUpdated,onBeforeUnmount,onUnmounted} from "vue"
  let sum = ref(0)
  function add(){
    sum.value+=1
  }
  // vue3生命周期
  // 创建阶段
  console.log("setup创建阶段");
  // 挂载前
  onBeforeMount(()=&gt;{
    console.log("挂载前");
  })
  // 挂载完毕
  onMounted(()=&gt;{
    console.log("挂载完毕");
  })
  // 更新前
  onBeforeUpdate(()=&gt;{
    console.log("更新前");
  })
  // 更新完毕
  onUpdated(()=&gt;{
    console.log("更新完毕");
  })
  // 卸载前
  onBeforeUnmount(()=&gt;{
    console.log("卸载前");
  })
  // 卸载完毕
  onUnmounted(()=&gt;{
    console.log("卸载完毕");
  })
&lt;/script&gt;

&lt;style scoped&gt;
.person {
  background-color: skyblue;
  box-shadow: 0 0 10px;
  border-radius: 10px;
  padding: 20px;
}
button {
  margin: 0 5px;
}
&lt;/style&gt;
</code></pre> 
<p>App.vue 示例代码</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div&gt;
    &lt;button @click="hidd"&gt;卸载&lt;/button&gt;
    &lt;Person v-if="isShow"/&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script lang="ts" setup name="APP"&gt;
  import Person from './components/Person.vue'
  import {ref} from "vue"
  let isShow = ref(true)
  function hidd(){
    isShow.value = false
  }
&lt;/script&gt;
</code></pre> 
<h3><a id="314_hook_1251"></a>3.14. 【自定义hook】</h3> 
<ul><li>什么是<code>hook</code>？—— 本质是一个函数，把<code>setup</code>函数中使用的<code>Composition API</code>进行了封装，类似于<code>vue2.x</code>中的<code>mixin</code>。</li><li>自定义<code>hook</code>的优势：复用代码, 让<code>setup</code>中的逻辑更清楚易懂。</li></ul> 
<p>示例内容：</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="person"&gt;
      &lt;h2&gt;sum和为：{<!-- -->{ sum }}&lt;/h2&gt;
      &lt;button @click="add"&gt;点击sum+1&lt;/button&gt;
      &lt;hr&gt;
      &lt;img v-for="(dog,index) in dogList" :src="dog" :key="index"&gt;&lt;br/&gt;
      &lt;button @click="getDogList"&gt;再来一只&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts" setup name="Person"&gt;
  import {ref,reactive} from "vue"
  import axios from "axios"
  
  let sum = ref(0)

  let dogList = reactive&lt;string[]&gt;([
    "https://images.dog.ceo/breeds/pembroke/n02113023_10636.jpg"
  ])

  function add(){
    sum.value += 1
  }

  async function getDogList(){
    try {
      // 发送请求
      let {data} = await axios.get('https://dog.ceo/api/breed/pembroke/images/random');
      // 添加数据
      dogList.push(data.message)
    } catch (error) {
      console.log("异常：",error);
    }
  }
&lt;/script&gt;

&lt;style scoped&gt;
.person {
  background-color: skyblue;
  box-shadow: 0 0 10px;
  border-radius: 10px;
  padding: 20px;
}
button {
  margin: 0 5px;
}
img {
  height:100px;
  margin-right: 10px;
}
&lt;/style&gt;
</code></pre> 
<p>封装后示例代码：</p> 
<ul><li><code>useSum.ts</code>中内容如下：</li></ul> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>ref<span class="token punctuation">,</span>onMounted<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    sum<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> <span class="token function-variable function">decrement</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    sum<span class="token punctuation">.</span>value <span class="token operator">-=</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
  <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">//向外部暴露数据</span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>sum<span class="token punctuation">,</span>increment<span class="token punctuation">,</span>decrement<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li><code>useDog.ts</code>中内容如下：</li></ul> 
<p>先安装 axios 命令：npm install axios</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>reactive<span class="token punctuation">,</span>onMounted<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> axios<span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span>AxiosError<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'axios'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> dogList <span class="token operator">=</span> reactive<span class="token operator">&lt;</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token comment">// 方法</span>
  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 发请求</span>
      <span class="token keyword">let</span> <span class="token punctuation">{<!-- --></span>data<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'https://dog.ceo/api/breed/pembroke/images/random'</span><span class="token punctuation">)</span>
      <span class="token comment">// 维护数据</span>
      dogList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 处理错误</span>
      <span class="token keyword">const</span> err <span class="token operator">=</span> <span class="token operator">&lt;</span>AxiosError<span class="token operator">&gt;</span>error
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 挂载钩子</span>
  <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">getDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
	
  <span class="token comment">//向外部暴露数据</span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>dogList<span class="token punctuation">,</span>getDog<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>组件中具体使用：</li></ul> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;h2&gt;当前求和为：{<!-- -->{sum}}&lt;/h2&gt;
  &lt;button @click="increment"&gt;点我+1&lt;/button&gt;
  &lt;button @click="decrement"&gt;点我-1&lt;/button&gt;
  &lt;hr&gt;
  &lt;img v-for="(u,index) in dogList.urlList" :key="index" :src="(u as string)"&gt; 
  &lt;span v-show="dogList.isLoading"&gt;加载中......&lt;/span&gt;&lt;br&gt;
  &lt;button @click="getDog"&gt;再来一只狗&lt;/button&gt;
&lt;/template&gt;

&lt;script lang="ts"&gt;
  import {defineComponent} from 'vue'

  export default defineComponent({
    name:'App',
  })
&lt;/script&gt;

&lt;script setup lang="ts"&gt;
  import useSum from './hooks/useSum'
  import useDog from './hooks/useDog'
	
  let {sum,increment,decrement} = useSum()
  let {dogList,getDog} = useDog()
&lt;/script&gt;
</code></pre> 
<hr> 
<h2><a id="4__1399"></a>4. 路由</h2> 
<h3><a id="41__1400"></a>4.1. 【对路由的理解】</h3> 
<p><img src="https://images2.imgbox.com/a9/e9/hcohdzRO_o.png" alt="image-20231018144351536.png"></p> 
<h3><a id="42__1402"></a>4.2. 【基本切换效果】</h3> 
<p>首先安装vue-router：npm install vue-router<br> components 组件中的内容直接从源码拿过来就行</p> 
<ul><li><code>Vue3</code>中要使用<code>vue-router</code>的最新版本，目前是<code>4</code>版本。</li><li>路由配置文件代码如下：</li></ul> 
<pre><code class="prism language-javascript"><span class="token comment">// 创建一个路由器，并暴露出去</span>
<span class="token comment">// 引入 createRouter</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> createRouter<span class="token punctuation">,</span> createWebHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue-router"</span>
<span class="token comment">// 引入需要路由的组件</span>
<span class="token keyword">import</span> Home <span class="token keyword">from</span> <span class="token string">"@/components/Home.vue"</span>
<span class="token keyword">import</span> News <span class="token keyword">from</span> <span class="token string">"@/components/News.vue"</span>
<span class="token keyword">import</span> About <span class="token keyword">from</span> <span class="token string">"@/components/About.vue"</span>

<span class="token comment">// 创建路由器</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token function">createWebHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">// 路由的工作模式</span>
    <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 路由规则</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">"/home"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">component</span><span class="token operator">:</span> Home
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">"/news"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">component</span><span class="token operator">:</span> News
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">"/about"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">component</span><span class="token operator">:</span> About
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 暴露路由</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre> 
<ul><li><code>main.ts</code>代码如下：</li></ul> 
<pre><code class="prism language-javascript"><span class="token comment">// 引入createApp用于创建应用</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>createApp<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token comment">// 引入App根组件</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>
<span class="token comment">// 引入路由</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span>

<span class="token comment">// 创建一个应用</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token comment">// 使用路由</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span>
<span class="token comment">// 挂在整个应用</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li><code>App.vue</code>代码如下</li></ul> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;!-- 标题区 --&gt;
  &lt;div class="app"&gt;
    &lt;h2 class="title"&gt;路由测试&lt;/h2&gt;
  &lt;/div&gt;
  &lt;!-- 导航区 --&gt;
  &lt;div class="navigate"&gt;
    &lt;RouterLink to="/home" active-class="active"&gt;首页&lt;/RouterLink&gt;
    &lt;RouterLink to="/news" active-class="active"&gt;新闻&lt;/RouterLink&gt;
    &lt;RouterLink to="/about" active-class="active"&gt;关于&lt;/RouterLink&gt;
  &lt;/div&gt;
  &lt;!-- 展示区 --&gt;
  &lt;div class="main-content"&gt;
    &lt;RouterView&gt;&lt;/RouterView&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script lang="ts" setup name="APP"&gt;
  import {RouterView,RouterLink} from 'vue-router'
&lt;/script&gt;
</code></pre> 
<h3><a id="43__1479"></a>4.3. 【两个注意点】</h3> 
<blockquote> 
 <ol><li>路由组件通常存放在<code>pages</code> 或 <code>views</code>文件夹，一般组件通常存放在<code>components</code>文件夹。</li><li>通过点击导航，视觉效果上“消失” 了的路由组件，默认是被<strong>卸载</strong>掉的，需要的时候再去<strong>挂载</strong>。</li></ol> 
</blockquote> 
<h3><a id="44_1483"></a>4.4.【路由器工作模式】</h3> 
<ol><li><code>history</code>模式</li></ol> 
<blockquote> 
 <p>优点：<code>URL</code>更加美观，不带有<code>#</code>，更接近传统的网站<code>URL</code>。<br> 缺点：后期项目上线，需要服务端配合处理路径问题，否则刷新会有<code>404</code>错误。</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  	<span class="token literal-property property">history</span><span class="token operator">:</span><span class="token function">createWebHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//history模式</span>
  	<span class="token comment">/******/</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="2"><li><code>hash</code>模式</li></ol> 
<blockquote> 
 <p>优点：兼容性更好，因为不需要服务器端处理路径。<br> 缺点：<code>URL</code>带有<code>#</code>不太美观，且在<code>SEO</code>优化方面相对较差。</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  	<span class="token literal-property property">history</span><span class="token operator">:</span><span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//hash模式</span>
  	<span class="token comment">/******/</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="45_to_1506"></a>4.5. 【to的两种写法】</h3> 
<pre><code class="prism language-vue">&lt;!-- 第一种：to的字符串写法 --&gt;
&lt;router-link active-class="active" to="/home"&gt;主页&lt;/router-link&gt;

&lt;!-- 第二种：to的对象写法 --&gt;
&lt;router-link active-class="active" :to="{path:'/home'}"&gt;Home&lt;/router-link&gt;
</code></pre> 
<h3><a id="46__1514"></a>4.6. 【命名路由】</h3> 
<p>作用：可以简化路由跳转及传参（后面就讲）。<br> 给路由规则命名：</p> 
<pre><code class="prism language-javascript"><span class="token literal-property property">routes</span><span class="token operator">:</span><span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'zhuye'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">'/home'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span>Home
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'xinwen'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">'/news'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span>News<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'guanyu'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">'/about'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span>About
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> 
<p>跳转路由：</p> 
<pre><code class="prism language-vue">&lt;!--简化前：需要写完整的路径（to的字符串写法） --&gt;
&lt;router-link to="/news/detail"&gt;跳转&lt;/router-link&gt;

&lt;!--简化后：直接通过名字跳转（to的对象写法配合name属性） --&gt;
&lt;router-link :to="{name:'guanyu'}"&gt;跳转&lt;/router-link&gt;
</code></pre> 
<h3><a id="47__1544"></a>4.7. 【嵌套路由】</h3> 
<ol><li>编写<code>News</code>的子路由：<code>Detail.vue</code></li><li>配置路由规则，使用<code>children</code>配置项：</li></ol> 
<pre><code class="prism language-typescript"><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  history<span class="token operator">:</span><span class="token function">createWebHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	routes<span class="token operator">:</span><span class="token punctuation">[</span>
		<span class="token punctuation">{<!-- --></span>
			name<span class="token operator">:</span><span class="token string">'zhuye'</span><span class="token punctuation">,</span>
			path<span class="token operator">:</span><span class="token string">'/home'</span><span class="token punctuation">,</span>
			component<span class="token operator">:</span>Home
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{<!-- --></span>
			name<span class="token operator">:</span><span class="token string">'xinwen'</span><span class="token punctuation">,</span>
			path<span class="token operator">:</span><span class="token string">'/news'</span><span class="token punctuation">,</span>
			component<span class="token operator">:</span>News<span class="token punctuation">,</span>
			children<span class="token operator">:</span><span class="token punctuation">[</span>
				<span class="token punctuation">{<!-- --></span>
					name<span class="token operator">:</span><span class="token string">'xiang'</span><span class="token punctuation">,</span>
					path<span class="token operator">:</span><span class="token string">'detail'</span><span class="token punctuation">,</span>
					component<span class="token operator">:</span>Detail
				<span class="token punctuation">}</span>
			<span class="token punctuation">]</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{<!-- --></span>
			name<span class="token operator">:</span><span class="token string">'guanyu'</span><span class="token punctuation">,</span>
			path<span class="token operator">:</span><span class="token string">'/about'</span><span class="token punctuation">,</span>
			component<span class="token operator">:</span>About
		<span class="token punctuation">}</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre> 
<ol start="3"><li>跳转路由（记得要加完整路径）：</li></ol> 
<pre><code class="prism language-vue">&lt;router-link to="/news/detail"&gt;xxxx&lt;/router-link&gt;
&lt;!-- 或 --&gt;
&lt;router-link :to="{path:'/news/detail'}"&gt;xxxx&lt;/router-link&gt;
</code></pre> 
<ol start="4"><li>记得去<code>Home</code>组件中预留一个<code>&lt;router-view&gt;</code></li></ol> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="news"&gt;
    &lt;nav class="news-list"&gt;
      &lt;RouterLink v-for="news in newsList" :key="news.id" :to="{path:'/news/detail'}"&gt;
        {<!-- -->{news.name}}
      &lt;/RouterLink&gt;
    &lt;/nav&gt;
    &lt;div class="news-detail"&gt;
      &lt;RouterView/&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre> 
<h3><a id="48__1601"></a>4.8. 【路由传参】</h3> 
<h4><a id="query_1602"></a>query参数</h4> 
<ol><li>传递参数</li></ol> 
<pre><code class="prism language-vue">&lt;!-- 跳转并携带query参数（to的字符串写法） --&gt;
&lt;router-link to="/news/newsDetail?a=1&amp;b=2&amp;content=欢迎你"&gt;
	跳转
&lt;/router-link&gt;
&lt;!-- query动态参数 --&gt;
&lt;RouterLink :to = "`/news/newsDetail?id=${news.id}&amp;title=${news.title}&amp;content=${news.content}`"&gt;{<!-- -->{ news.title }}&lt;/RouterLink&gt;
				
&lt;!-- 跳转并携带query参数（to的对象写法） --&gt;
&lt;RouterLink 
  :to="{
    //name:'xiang', //用name也可以跳转
    path:'/news/detail',
    query:{
      id:news.id,
      title:news.title,
      content:news.content
    }
  }"
&gt;
  {<!-- -->{news.title}}
&lt;/RouterLink&gt;
</code></pre> 
<ol start="2"><li>接收参数：</li></ol> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>useRoute<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 打印query参数</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>query<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="params_1636"></a>params参数</h4> 
<ol><li>传递参数</li></ol> 
<pre><code class="prism language-vue">&lt;!-- 跳转并携带params参数（to的字符串写法） --&gt;
&lt;RouterLink :to="`/news/newsDetail/001/新闻001/内容001`"&gt;{<!-- -->{news.title}}&lt;/RouterLink&gt;
&lt;RouterLink :to = "`/news/newsDetail/${news.id}/${news.title}/${news.content}`"&gt;{<!-- -->{ news.title }}&lt;/RouterLink&gt;

  &lt;!-- 跳转并携带params参数（to的对象写法） --&gt;
&lt;RouterLink 
  :to="{
    name:'xiang', //用name跳转
    params:{
      id:news.id,
      title:news.title,
      content:news.title
    }
  }"
&gt;
  {<!-- -->{news.title}}
&lt;/RouterLink&gt;
</code></pre> 
<ol start="2"><li>接收参数：</li></ol> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>useRoute<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 打印params参数</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>params<span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>备注1：传递<code>params</code>参数时，若使用<code>to</code>的对象写法，必须使用<code>name</code>配置项，不能用<code>path</code>。<br> 备注2：传递<code>params</code>参数时，需要提前在规则中占位。</p> 
</blockquote> 
<h3><a id="49_props_1669"></a>4.9. 【路由的props配置】</h3> 
<p>作用：让路由组件更方便的收到参数（可以将路由参数作为<code>props</code>传给组件）</p> 
<pre><code class="prism language-javascript"><span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'xiang'</span><span class="token punctuation">,</span>
	<span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">'detail/:id/:title/:content'</span><span class="token punctuation">,</span>
	<span class="token literal-property property">component</span><span class="token operator">:</span>Detail<span class="token punctuation">,</span>

  <span class="token comment">// props的对象写法，作用：把对象中的每一组key-value作为props传给Detail组件</span>
  <span class="token comment">// props:{a:1,b:2,c:3}, </span>

  <span class="token comment">// props的布尔值写法，作用：把收到了每一组params参数，作为props传给Detail组件</span>
  <span class="token comment">// props:true</span>
  
  <span class="token comment">// props的函数写法，作用：把返回的对象中每一组key-value作为props传给Detail组件</span>
  <span class="token function">props</span><span class="token punctuation">(</span><span class="token parameter">route</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> route<span class="token punctuation">.</span>query
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="410__replace_1689"></a>4.10. 【 replace属性】</h3> 
<ol><li>作用：控制路由跳转时操作浏览器历史记录的模式。</li><li>浏览器的历史记录有两种写入方式：分别为<code>push</code>和<code>replace</code>：</li></ol> 
<ul><li><code>push</code>是追加历史记录（默认值）。</li><li><code>replace</code>是替换当前记录。</li></ul> 
<ol start="3"><li>开启<code>replace</code>模式：</li></ol> 
<pre><code class="prism language-vue">&lt;RouterLink replace .......&gt;News&lt;/RouterLink&gt;
</code></pre> 
<h3><a id="411__1699"></a>4.11. 【编程式导航】</h3> 
<p>路由组件的两个重要的属性：<code>$route</code>和<code>$router</code>变成了两个<code>hooks</code></p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>useRoute<span class="token punctuation">,</span>useRouter<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>

<span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>query<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>parmas<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span>push<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span>replace<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="412__1712"></a>4.12. 【重定向】</h3> 
<ol><li>作用：将特定的路径，重新定向到已有路由。</li><li>具体编码： router/index.ts 文件下</li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">'/'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">redirect</span><span class="token operator">:</span><span class="token string">'/about'</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="5_pinia_1722"></a>5. pinia</h2> 
<p>官网：<a href="https://pinia.vuejs.org/" rel="nofollow">https://pinia.vuejs.org/</a></p> 
<h3><a id="51_1724"></a>5.1【准备一个效果】</h3> 
<p>可以直接拿案例使用，新手建议手动实现一遍<br> <img src="https://images2.imgbox.com/e8/15/DsLZA2lW_o.gif" alt="pinia_example.gif"></p> 
<h3><a id="52_pinia__1727"></a>5.2【搭建 pinia 环境】</h3> 
<p>第一步：<code>npm install pinia</code><br> 第二步：操作<code>src/main.ts</code></p> 
<pre><code class="prism language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>

<span class="token comment">/* 引入createPinia，用于创建pinia */</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> createPinia <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>

<span class="token comment">/* 创建pinia */</span>
<span class="token keyword">const</span> pinia <span class="token operator">=</span> <span class="token function">createPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>

<span class="token comment">/* 使用插件 */</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>pinia<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
</code></pre> 
<p>此时开发者工具中已经有了<code>pinia</code>选项<br> <img src="https://images2.imgbox.com/ae/df/F7K6bf3F_o.png" alt=""></p> 
<h3><a id="53_1747"></a>5.3【存储+读取数据】</h3> 
<ol><li><code>Store</code>是一个保存：<strong>状态</strong>、<strong>业务逻辑</strong> 的实体，每个组件都可以<strong>读取</strong>、<strong>写入</strong>它。</li><li>它有三个概念：<code>state</code>、<code>getter</code>、<code>action</code>，相当于组件中的： <code>data</code>、 <code>computed</code> 和 <code>methods</code>。</li><li>具体编码：<code>src/store/count.ts</code></li></ol> 
<pre><code class="prism language-typescript"><span class="token comment">// 引入defineStore用于创建store</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>defineStore<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>

<span class="token comment">// 定义并暴露一个store</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> useCountStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 动作</span>
  actions<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 状态</span>
  <span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      sum<span class="token operator">:</span><span class="token number">6</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 计算</span>
  getters<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="4"><li>具体编码：<code>src/store/talk.ts</code></li></ol> 
<pre><code class="prism language-javascript"><span class="token comment">// 引入defineStore用于创建store</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>defineStore<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>

<span class="token comment">// 定义并暴露一个store</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> useTalkStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">'talk'</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 动作</span>
  <span class="token literal-property property">actions</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 状态</span>
  <span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">talkList</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">'yuysada01'</span><span class="token punctuation">,</span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token string">'你今天有点怪，哪里怪？怪好看的！'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
     		<span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">'yuysada02'</span><span class="token punctuation">,</span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token string">'草莓、蓝莓、蔓越莓，你想我了没？'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">'yuysada03'</span><span class="token punctuation">,</span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token string">'心里给你留了一块地，我的死心塌地'</span><span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 计算</span>
  <span class="token literal-property property">getters</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="5"><li>组件中使用<code>state</code>中的数据</li></ol> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;h2&gt;当前求和为：{<!-- -->{ sumStore.sum }}&lt;/h2&gt;
&lt;/template&gt;

&lt;script setup lang="ts" name="Count"&gt;
  // 引入对应的useXxxxxStore	
  import {useSumStore} from '@/store/sum'
  
  // 调用useXxxxxStore得到对应的store
  const sumStore = useSumStore()
&lt;/script&gt;
</code></pre> 
<pre><code class="prism language-vue">&lt;template&gt;
	&lt;ul&gt;
    &lt;li v-for="talk in talkStore.talkList" :key="talk.id"&gt;
      {<!-- -->{ talk.content }}
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/template&gt;

&lt;script setup lang="ts" name="Count"&gt;
  import axios from 'axios'
  import {useTalkStore} from '@/store/talk'

  const talkStore = useTalkStore()
&lt;/script&gt;
</code></pre> 
<h3><a id="54_1825"></a>5.4.【修改数据】(三种方式)</h3> 
<ol><li>第一种修改方式，直接修改</li></ol> 
<pre><code class="prism language-typescript">countStore<span class="token punctuation">.</span>sum <span class="token operator">=</span> <span class="token number">666</span>
</code></pre> 
<ol start="2"><li>第二种修改方式：批量修改</li></ol> 
<pre><code class="prism language-typescript">countStore<span class="token punctuation">.</span><span class="token function">$patch</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  sum<span class="token operator">:</span><span class="token number">999</span><span class="token punctuation">,</span>
  school<span class="token operator">:</span><span class="token string">'atguigu'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="3"><li>第三种修改方式：借助<code>action</code>修改（<code>action</code>中可以编写一些业务逻辑）</li></ol> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> useCountStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">/*************/</span>
  <span class="token literal-property property">actions</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//加</span>
    <span class="token function">increment</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span>number</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sum <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//操作countStore中的sum</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sum <span class="token operator">+=</span> value
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//减</span>
    <span class="token function">decrement</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span>number</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sum <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sum <span class="token operator">-=</span> value
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/*************/</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="4"><li>组件中调用<code>action</code>即可</li></ol> 
<pre><code class="prism language-javascript"><span class="token comment">// 使用countStore</span>
<span class="token keyword">const</span> countStore <span class="token operator">=</span> <span class="token function">useCountStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 调用对应action</span>
countStore<span class="token punctuation">.</span><span class="token function">incrementOdd</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="55storeToRefs_1873"></a>5.5.【storeToRefs】</h3> 
<ul><li>借助<code>storeToRefs</code>将<code>store</code>中的数据转为<code>ref</code>对象，方便在模板中使用。</li><li>注意：<code>pinia</code>提供的<code>storeToRefs</code>只会将数据做转换，而<code>Vue</code>的<code>toRefs</code>会转换<code>store</code>中数据。</li></ul> 
<pre><code class="prism language-vue">&lt;template&gt;
	&lt;div class="count"&gt;
		&lt;h2&gt;当前求和为：{<!-- -->{sum}}&lt;/h2&gt;
	&lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts" name="Count"&gt;
  import { useCountStore } from '@/store/count'
  /* 引入storeToRefs */
  import { storeToRefs } from 'pinia'

	/* 得到countStore */
  const countStore = useCountStore()
  /* 使用storeToRefs转换countStore，随后解构 */
  const {sum} = storeToRefs(countStore)
&lt;/script&gt;
</code></pre> 
<h3><a id="56getters_1895"></a>5.6.【getters】</h3> 
<ol><li>概念：当<code>state</code>中的数据，需要经过处理后再使用时，可以使用<code>getters</code>配置。</li><li>追加<code>getters</code>配置。</li></ol> 
<pre><code class="prism language-javascript"><span class="token comment">// 引入defineStore用于创建store</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>defineStore<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>

<span class="token comment">// 定义并暴露一个store</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> useCountStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 动作</span>
  <span class="token literal-property property">actions</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">/************/</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 状态</span>
  <span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">sum</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">school</span><span class="token operator">:</span><span class="token string">'atguigu'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 计算</span>
  <span class="token literal-property property">getters</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">bigSum</span><span class="token operator">:</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token operator">:</span><span class="token parameter">number</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>sum <span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token function">upperSchool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>string<span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span> school<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="3"><li>组件中读取数据：</li></ol> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>increment<span class="token punctuation">,</span>decrement<span class="token punctuation">}</span> <span class="token operator">=</span> countStore
<span class="token keyword">let</span> <span class="token punctuation">{<!-- --></span>sum<span class="token punctuation">,</span>school<span class="token punctuation">,</span>bigSum<span class="token punctuation">,</span>upperSchool<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>countStore<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="57subscribe_1931"></a>5.7.【$subscribe】</h3> 
<p>通过 store 的 <code>$subscribe()</code> 方法侦听 <code>state</code> 及其变化</p> 
<pre><code class="prism language-typescript">talkStore<span class="token punctuation">.</span><span class="token function">$subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mutate<span class="token punctuation">,</span>state<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'LoveTalk'</span><span class="token punctuation">,</span>mutate<span class="token punctuation">,</span>state<span class="token punctuation">)</span>
  localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'talk'</span><span class="token punctuation">,</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>talkList<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="58_store_1939"></a>5.8. 【store组合式写法】</h3> 
<pre><code class="prism language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>defineStore<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>nanoid<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'nanoid'</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>reactive<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> useTalkStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">'talk'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// talkList就是state</span>
  <span class="token keyword">const</span> talkList <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span>
    <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'talkList'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">)</span>

  <span class="token comment">// getATalk函数相当于action</span>
  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getATalk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 发请求，下面这行的写法是：连续解构赋值+重命名</span>
    <span class="token keyword">let</span> <span class="token punctuation">{<!-- --></span>data<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>content<span class="token operator">:</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'https://api.uomg.com/api/rand.qinghua?format=json'</span><span class="token punctuation">)</span>
    <span class="token comment">// 把请求回来的字符串，包装成一个对象</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>id<span class="token operator">:</span><span class="token function">nanoid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>title<span class="token punctuation">}</span>
    <span class="token comment">// 放到数组中</span>
    talkList<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>talkList<span class="token punctuation">,</span>getATalk<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="6__1964"></a>6. 组件通信</h2> 
<p>导入示例：安装依赖 npm install mitt<br> 运行：npm run dev<br> <code>**Vue3**</code><strong>组件通信和</strong><code>**Vue2**</code><strong>的区别：</strong></p> 
<ul><li>移出事件总线，使用<code>mitt</code>代替。</li><li><code>vuex</code>换成了<code>pinia</code>。</li><li>把<code>.sync</code>优化到了<code>v-model</code>里面了。</li><li>把<code>$listeners</code>所有的东西，合并到<code>$attrs</code>中了。</li><li><code>$children</code>被砍掉了。</li></ul> 
<p><strong>常见搭配形式：</strong></p> 
<h3><a id="61_props_1976"></a>6.1. 【props】</h3> 
<p>概述：<code>props</code>是使用频率最高的一种通信方式，常用与 ：<strong>父 ↔ 子</strong>。</p> 
<ul><li>若 <strong>父传子</strong>：属性值是<strong>非函数</strong>。</li><li>若 <strong>子传父</strong>：属性值是<strong>函数</strong>。</li></ul> 
<p>父组件：</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="father"&gt;
    &lt;h3&gt;父组件，&lt;/h3&gt;
		&lt;h4&gt;我的车：{<!-- -->{ car }}&lt;/h4&gt;
		&lt;h4&gt;儿子给的玩具：{<!-- -->{ toy }}&lt;/h4&gt;
		&lt;Child :car="car" :getToy="getToy"/&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts" name="Father"&gt;
	import Child from './Child.vue'
	import { ref } from "vue";
	// 数据
	const car = ref('奔驰')
	const toy = ref()
	// 方法
	function getToy(value:string){
		toy.value = value
	}
&lt;/script&gt;
</code></pre> 
<p>子组件</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="child"&gt;
    &lt;h3&gt;子组件&lt;/h3&gt;
		&lt;h4&gt;我的玩具：{<!-- -->{ toy }}&lt;/h4&gt;
		&lt;h4&gt;父给我的车：{<!-- -->{ car }}&lt;/h4&gt;
		&lt;button @click="getToy(toy)"&gt;玩具给父亲&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts" name="Child"&gt;
	import { ref } from "vue";
	const toy = ref('奥特曼')
	
	defineProps(['car','getToy'])
&lt;/script&gt;
</code></pre> 
<h3><a id="62__2023"></a>6.2. 【自定义事件】</h3> 
<ol><li>概述：自定义事件常用于：<strong>子 =&gt; 父。</strong></li><li>注意区分好：原生事件、自定义事件。</li></ol> 
<ul><li>原生事件： 
  <ul><li>事件名是特定的（<code>click</code>、<code>mosueenter</code>等等）</li><li>事件对象<code>$event</code>: 是包含事件相关信息的对象（<code>pageX</code>、<code>pageY</code>、<code>target</code>、<code>keyCode</code>）</li></ul> </li><li>自定义事件： 
  <ul><li>事件名是任意名称</li><li><strong>事件对象</strong><code>**$event**</code><strong>: 是调用</strong><code>**emit**</code><strong>时所提供的数据，可以是任意类型！！！</strong></li></ul> </li></ul> 
<ol start="3"><li>示例：</li></ol> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--在父组件中，给子组件绑定自定义事件：--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Child</span> <span class="token attr-name">@send-toy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>toy = $event<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>

<span class="token comment">&lt;!--注意区分原生事件与自定义事件中的$event--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>toy = $event<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>测试<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<pre><code class="prism language-javascript"><span class="token comment">//子组件中，触发事件：</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'send-toy'</span><span class="token punctuation">,</span> 具体数据<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="63_mitt_2045"></a>6.3. 【mitt】</h3> 
<p>概述：与消息订阅与发布（<code>pubsub</code>）功能类似，可以实现任意组件间通信。<br> 安装<code>mitt</code></p> 
<pre><code class="prism language-shell"><span class="token function">npm</span> i mitt
</code></pre> 
<p>新建文件：<code>src\utils\emitter.ts</code></p> 
<pre><code class="prism language-javascript"><span class="token comment">// 引入mitt </span>
<span class="token keyword">import</span> mitt <span class="token keyword">from</span> <span class="token string">"mitt"</span><span class="token punctuation">;</span>

<span class="token comment">// 创建emitter</span>
<span class="token keyword">const</span> emitter <span class="token operator">=</span> <span class="token function">mitt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">/*
  // 绑定事件
  emitter.on('abc',(value)=&gt;{
    console.log('abc事件被触发',value)
  })
  emitter.on('xyz',(value)=&gt;{
    console.log('xyz事件被触发',value)
  })

  setInterval(() =&gt; {
    // 触发事件
    emitter.emit('abc',666)
    emitter.emit('xyz',777)
  }, 1000);

  setTimeout(() =&gt; {
    // 清理事件
    emitter.all.clear()
  }, 3000); 
*/</span>

<span class="token comment">// 创建并暴露mitt</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> emitter
</code></pre> 
<p>接收数据的组件中：绑定事件、同时在销毁前解绑事件：</p> 
<pre><code class="prism language-typescript"><span class="token keyword">import</span> emitter <span class="token keyword">from</span> <span class="token string">"@/utils/emitter"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> onUnmounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>

<span class="token comment">// 绑定事件</span>
emitter<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'send-toy'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'send-toy事件被触发'</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 解绑事件</span>
  emitter<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token string">'send-toy'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>【第三步】：提供数据的组件，在合适的时候触发事件</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> emitter <span class="token keyword">from</span> <span class="token string">"@/utils/emitter"</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">sendToy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 触发事件</span>
  emitter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'send-toy'</span><span class="token punctuation">,</span>toy<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>注意这个重要的内置关系，总线依赖着这个内置关系</strong></p> 
<h3><a id="64vmodel_2108"></a>6.4.【v-model】</h3> 
<ol><li>概述：实现 <strong>父↔子</strong> 之间相互通信。</li><li>前序知识 —— <code>v-model</code>的本质</li></ol> 
<pre><code class="prism language-vue">&lt;!-- 使用v-model指令 --&gt;
&lt;input type="text" v-model="userName"&gt;

&lt;!-- v-model的本质是下面这行代码 --&gt;
&lt;input 
  type="text" 
  :value="userName" 
  @input="userName =(&lt;HTMLInputElement&gt;$event.target).value"
&gt;
</code></pre> 
<ol start="3"><li>组件标签上的<code>v-model</code>的本质：<code>:moldeValue</code> ＋ <code>update:modelValue</code>事件。</li></ol> 
<pre><code class="prism language-vue">&lt;!-- 组件标签上使用v-model指令 --&gt;
&lt;AtguiguInput v-model="userName"/&gt;

&lt;!-- 组件标签上v-model的本质 --&gt;
&lt;AtguiguInput :modelValue="userName" @update:model-value="userName = $event"/&gt;
</code></pre> 
<p><code>AtguiguInput</code>组件中：</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="box"&gt;
    &lt;!--将接收的value值赋给input元素的value属性，目的是：为了呈现数据 --&gt;
		&lt;!--给input元素绑定原生input事件，触发input事件时，进而触发update:model-value事件--&gt;
    &lt;input 
       type="text" 
       :value="modelValue" 
       @input="emit('update:model-value',$event.target.value)"
    &gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts" name="AtguiguInput"&gt;
  // 接收props
  defineProps(['modelValue'])
  // 声明事件
  const emit = defineEmits(['update:model-value'])
&lt;/script&gt;
</code></pre> 
<ol start="4"><li>也可以更换<code>value</code>，例如改成<code>abc</code></li></ol> 
<pre><code class="prism language-vue">&lt;!-- 也可以更换value，例如改成abc--&gt;
&lt;AtguiguInput v-model:abc="userName"/&gt;

&lt;!-- 上面代码的本质如下 --&gt;
&lt;AtguiguInput :abc="userName" @update:abc="userName = $event"/&gt;
</code></pre> 
<p><code>AtguiguInput</code>组件中：</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="box"&gt;
    &lt;input 
       type="text" 
       :value="abc" 
       @input="emit('update:abc',$event.target.value)"
    &gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts" name="AtguiguInput"&gt;
  // 接收props
  defineProps(['abc'])
  // 声明事件
  const emit = defineEmits(['update:abc'])
&lt;/script&gt;
</code></pre> 
<ol start="5"><li>如果<code>value</code>可以更换，那么就可以在组件标签上多次使用<code>v-model</code></li></ol> 
<pre><code class="prism language-vue">&lt;AtguiguInput v-model:abc="userName" v-model:xyz="password"/&gt;
</code></pre> 
<h3><a id="65attrs__2186"></a>6.5.【$attrs 】</h3> 
<ol><li>概述：<code>$attrs</code>用于实现<strong>当前组件的父组件</strong>，向<strong>当前组件的子组件</strong>通信（<strong>祖→孙</strong>）。</li><li>具体说明：<code>$attrs</code>是一个对象，包含所有父组件传入的标签属性。</li></ol> 
<blockquote> 
 <p>注意：<code>$attrs</code>会自动排除<code>props</code>中声明的属性(可以认为声明过的 <code>props</code> 被子组件自己“消费”了)</p> 
</blockquote> 
<p>父组件：</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="father"&gt;
    &lt;h3&gt;父组件&lt;/h3&gt;
		&lt;Child :a="a" :b="b" :c="c" :d="d" v-bind="{x:100,y:200}" :updateA="updateA"/&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts" name="Father"&gt;
	import Child from './Child.vue'
	import { ref } from "vue";
	let a = ref(1)
	let b = ref(2)
	let c = ref(3)
	let d = ref(4)

	function updateA(value){
		a.value = value
	}
&lt;/script&gt;
</code></pre> 
<p>子组件：</p> 
<pre><code class="prism language-vue">&lt;template&gt;
	&lt;div class="child"&gt;
		&lt;h3&gt;子组件&lt;/h3&gt;
		&lt;GrandChild v-bind="$attrs"/&gt;
	&lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts" name="Child"&gt;
	import GrandChild from './GrandChild.vue'
&lt;/script&gt;
</code></pre> 
<p>孙组件：</p> 
<pre><code class="prism language-vue">&lt;template&gt;
	&lt;div class="grand-child"&gt;
		&lt;h3&gt;孙组件&lt;/h3&gt;
		&lt;h4&gt;a：{<!-- -->{ a }}&lt;/h4&gt;
		&lt;h4&gt;b：{<!-- -->{ b }}&lt;/h4&gt;
		&lt;h4&gt;c：{<!-- -->{ c }}&lt;/h4&gt;
		&lt;h4&gt;d：{<!-- -->{ d }}&lt;/h4&gt;
		&lt;h4&gt;x：{<!-- -->{ x }}&lt;/h4&gt;
		&lt;h4&gt;y：{<!-- -->{ y }}&lt;/h4&gt;
		&lt;button @click="updateA(666)"&gt;点我更新A&lt;/button&gt;
	&lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts" name="GrandChild"&gt;
	defineProps(['a','b','c','d','x','y','updateA'])
&lt;/script&gt;
</code></pre> 
<h3><a id="66_refsparent_2246"></a>6.6. 【<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         r 
        
       
         e 
        
       
         f 
        
       
         s 
        
       
         、 
        
       
      
        refs、 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord mathnormal">s</span><span class="mord cjk_fallback">、</span></span></span></span></span>parent】</h3> 
<ol><li>概述：</li></ol> 
<ul><li><code>$refs</code>用于 ：<strong>父→子。</strong></li><li><code>$parent</code>用于：<strong>子→父。</strong></li></ul> 
<ol start="2"><li>原理如下：<br> | 属性 | 说明 |<br> | — | — |<br> | <code>$refs</code> | 值为对象，包含所有被<code>ref</code><br> 属性标识的<code>DOM</code><br> 元素或组件实例。 |<br> | <code>$parent</code> | 值为对象，当前组件的父组件实例对象。 |</li></ol> 
<h3><a id="67_provideinject_2259"></a>6.7. 【provide、inject】</h3> 
<ol><li>概述：实现<strong>祖孙组件</strong>直接通信</li><li>具体使用：</li></ol> 
<ul><li>在祖先组件中通过<code>provide</code>配置向后代组件提供数据</li><li>在后代组件中通过<code>inject</code>配置来声明接收数据</li></ul> 
<ol start="3"><li>具体编码：<br> 【第一步】父组件中，使用<code>provide</code>提供数据</li></ol> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="father"&gt;
    &lt;h3&gt;父组件&lt;/h3&gt;
    &lt;h4&gt;资产：{<!-- -->{ money }}&lt;/h4&gt;
    &lt;h4&gt;汽车：{<!-- -->{ car }}&lt;/h4&gt;
    &lt;button @click="money += 1"&gt;资产+1&lt;/button&gt;
    &lt;button @click="car.price += 1"&gt;汽车价格+1&lt;/button&gt;
    &lt;Child/&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts" name="Father"&gt;
  import Child from './Child.vue'
  import { ref,reactive,provide } from "vue";
  // 数据
  let money = ref(100)
  let car = reactive({
    brand:'奔驰',
    price:100
  })
  // 用于更新money的方法
  function updateMoney(value:number){
    money.value += value
  }
  // 传money具体值，不是响应式对象
  // provide('moneyContext',{money:money.value,updateMoney})
  // 提供数据 简写形式
  provide('moneyContext',{money,updateMoney})
  provide('car',car)
&lt;/script&gt;
</code></pre> 
<blockquote> 
 <p>注意：子组件中不用编写任何东西，是不受到任何打扰的<br> 【第二步】孙组件中使用<code>inject</code>配置项接受数据。</p> 
</blockquote> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="grand-child"&gt;
    &lt;h3&gt;我是孙组件&lt;/h3&gt;
    &lt;h4&gt;资产：{<!-- -->{ money }}&lt;/h4&gt;
    &lt;h4&gt;汽车：{<!-- -->{ car }}&lt;/h4&gt;
    &lt;button @click="updateMoney(6)"&gt;点我&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts" name="GrandChild"&gt;
  import { inject } from 'vue';
  // 注入数据
 let {money,updateMoney} = inject('moneyContext',{money:0,updateMoney:(x:number)=&gt;{}})
  let car = inject('car')
</code></pre> 
<h3><a id="68_pinia_2318"></a>6.8. 【pinia】</h3> 
<p>参考之前<code>pinia</code>部分的讲解</p> 
<h3><a id="69_slot_2320"></a>6.9. 【slot】</h3> 
<h4><a id="1__2321"></a>1. 默认插槽</h4> 
<p><img src="https://images2.imgbox.com/b0/96/n0lyFKXv_o.png" alt=""></p> 
<pre><code class="prism language-vue">父组件中：
        &lt;Category title="今日热门游戏"&gt;
          &lt;ul&gt;
            &lt;li v-for="g in games" :key="g.id"&gt;{<!-- -->{ g.name }}&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/Category&gt;
子组件中：
        &lt;template&gt;
          &lt;div class="item"&gt;
            &lt;h3&gt;{<!-- -->{ title }}&lt;/h3&gt;
            &lt;!-- 默认插槽 --&gt;
            &lt;slot&gt;&lt;/slot&gt;
          &lt;/div&gt;
        &lt;/template&gt;
</code></pre> 
<h4><a id="2__2339"></a>2. 具名插槽</h4> 
<pre><code class="prism language-vue">父组件中：
        &lt;Category title="今日热门游戏"&gt;
          &lt;template v-slot:s1&gt;
            &lt;ul&gt;
              &lt;li v-for="g in games" :key="g.id"&gt;{<!-- -->{ g.name }}&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/template&gt;
          &lt;template #s2&gt;
            &lt;a href=""&gt;更多&lt;/a&gt;
          &lt;/template&gt;
        &lt;/Category&gt;
子组件中：
        &lt;template&gt;
          &lt;div class="item"&gt;
            &lt;h3&gt;{<!-- -->{ title }}&lt;/h3&gt;
            &lt;slot name="s1"&gt;&lt;/slot&gt;
            &lt;slot name="s2"&gt;&lt;/slot&gt;
          &lt;/div&gt;
        &lt;/template&gt;
</code></pre> 
<h4><a id="3__2361"></a>3. 作用域插槽</h4> 
<ol><li>理解：数据在组件的自身，但根据数据生成的结构需要组件的使用者来决定。（新闻数据在<code>News</code>组件中，但使用数据所遍历出来的结构由<code>App</code>组件决定）</li><li>具体编码：</li></ol> 
<pre><code class="prism language-vue">父组件中：
      &lt;Game v-slot="params"&gt;
      &lt;!-- &lt;Game v-slot:default="params"&gt; --&gt;
      &lt;!-- &lt;Game #default="params"&gt; --&gt;
        &lt;ul&gt;
          &lt;li v-for="g in params.games" :key="g.id"&gt;{<!-- -->{ g.name }}&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/Game&gt;

子组件中：
      &lt;template&gt;
        &lt;div class="category"&gt;
          &lt;h2&gt;今日游戏榜单&lt;/h2&gt;
          &lt;slot :games="games" a="哈哈"&gt;&lt;/slot&gt;
        &lt;/div&gt;
      &lt;/template&gt;

      &lt;script setup lang="ts" name="Category"&gt;
        import {reactive} from 'vue'
        let games = reactive([
          {id:'asgdytsa01',name:'英雄联盟'},
          {id:'asgdytsa02',name:'王者荣耀'},
          {id:'asgdytsa03',name:'红色警戒'},
          {id:'asgdytsa04',name:'斗罗大陆'}
        ])
      &lt;/script&gt;
</code></pre> 
<h2><a id="7__API_2393"></a>7. 其它 API</h2> 
<h3><a id="71shallowRef__shallowReactive__2394"></a>7.1.【shallowRef 与 shallowReactive 】</h3> 
<h4><a id="shallowRef_2395"></a><code>shallowRef</code></h4> 
<ol><li>作用：创建一个响应式数据，但只对顶层属性进行响应式处理。</li><li>用法：</li></ol> 
<pre><code class="prism language-javascript"><span class="token keyword">let</span> myVar <span class="token operator">=</span> <span class="token function">shallowRef</span><span class="token punctuation">(</span>initialValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="3"><li>特点：只跟踪引用值的变化，不关心值内部的属性变化。</li></ol> 
<h4><a id="shallowReactive_2404"></a><code>shallowReactive</code></h4> 
<ol><li>作用：创建一个浅层响应式对象，只会使对象的最顶层属性变成响应式的，对象内部的嵌套属性则不会变成响应式的</li><li>用法：</li></ol> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> myObj <span class="token operator">=</span> <span class="token function">shallowReactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="3"><li>特点：对象的顶层属性是响应式的，但嵌套对象的属性不是。</li></ol> 
<h4><a id="_2413"></a>总结</h4> 
<blockquote> 
 <p>通过使用 <code>[shallowRef()](https://cn.vuejs.org/api/reactivity-advanced.html#shallowref)</code> 和 <code>[shallowReactive()](https://cn.vuejs.org/api/reactivity-advanced.html#shallowreactive)</code> 来绕开深度响应。浅层式 <code>API</code> 创建的状态只在其顶层是响应式的，对所有深层的对象不会做任何处理，避免了对每一个内部属性做响应式所带来的性能成本，这使得属性的访问变得更快，可提升性能。</p> 
</blockquote> 
<h3><a id="72readonly__shallowReadonly_2416"></a>7.2.【readonly 与 shallowReadonly】</h3> 
<h4><a id="readonly_2417"></a><code>**readonly**</code></h4> 
<ol><li>作用：用于创建一个对象的深只读副本。</li><li>用法：</li></ol> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> original <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> readOnlyCopy <span class="token operator">=</span> <span class="token function">readonly</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="3"><li>特点：</li></ol> 
<ul><li>对象的所有嵌套属性都将变为只读。</li><li>任何尝试修改这个对象的操作都会被阻止（在开发模式下，还会在控制台中发出警告）。</li></ul> 
<ol start="4"><li>应用场景：</li></ol> 
<ul><li>创建不可变的状态快照。</li><li>保护全局状态或配置不被修改。</li></ul> 
<h4><a id="shallowReadonly_2432"></a><code>**shallowReadonly**</code></h4> 
<ol><li>作用：与 <code>readonly</code> 类似，但只作用于对象的顶层属性。</li><li>用法：</li></ol> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> original <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> shallowReadOnlyCopy <span class="token operator">=</span> <span class="token function">shallowReadonly</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="3"><li>特点：</li></ol> 
<ul><li>只将对象的顶层属性设置为只读，对象内部的嵌套属性仍然是可变的。</li><li>适用于只需保护对象顶层属性的场景。</li></ul> 
<h3><a id="73toRaw__markRaw_2444"></a>7.3.【toRaw 与 markRaw】</h3> 
<h4><a id="toRaw_2445"></a><code>toRaw</code></h4> 
<ol><li>作用：用于获取一个响应式对象的原始对象， <code>toRaw</code> 返回的对象不再是响应式的，不会触发视图更新。</li></ol> 
<blockquote> 
 <p>官网描述：这是一个可以用于临时读取而不引起代理访问/跟踪开销，或是写入而不触发更改的特殊方法。不建议保存对原始对象的持久引用，请谨慎使用。</p> 
</blockquote> 
<blockquote> 
 <p>何时使用？ —— 在需要将响应式对象传递给非 <code>Vue</code> 的库或外部系统时，使用 <code>toRaw</code> 可以确保它们收到的是普通对象</p> 
</blockquote> 
<ol start="2"><li>具体编码：</li></ol> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> reactive<span class="token punctuation">,</span>toRaw<span class="token punctuation">,</span>markRaw<span class="token punctuation">,</span>isReactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>

<span class="token comment">/* toRaw */</span>
<span class="token comment">// 响应式对象</span>
<span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'tony'</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 原始对象</span>
<span class="token keyword">let</span> rawPerson <span class="token operator">=</span> <span class="token function">toRaw</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span>


<span class="token comment">/* markRaw */</span>
<span class="token keyword">let</span> citysd <span class="token operator">=</span> <span class="token function">markRaw</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">'asdda01'</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'北京'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">'asdda02'</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'上海'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">'asdda03'</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'天津'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">'asdda04'</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'重庆'</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 根据原始对象citys去创建响应式对象citys2 —— 创建失败，因为citys被markRaw标记了</span>
<span class="token keyword">let</span> citys2 <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span>citys<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isReactive</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isReactive</span><span class="token punctuation">(</span>rawPerson<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isReactive</span><span class="token punctuation">(</span>citys<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isReactive</span><span class="token punctuation">(</span>citys2<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="markRaw_2477"></a><code>markRaw</code></h4> 
<ol><li>作用：标记一个对象，使其<strong>永远不会</strong>变成响应式的。</li></ol> 
<blockquote> 
 <p>例如使用<code>mockjs</code>时，为了防止误把<code>mockjs</code>变为响应式对象，可以使用 <code>markRaw</code> 去标记<code>mockjs</code></p> 
</blockquote> 
<ol start="2"><li>编码：</li></ol> 
<pre><code class="prism language-javascript"><span class="token comment">/* markRaw */</span>
<span class="token keyword">let</span> citys <span class="token operator">=</span> <span class="token function">markRaw</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">'asdda01'</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'北京'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">'asdda02'</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'上海'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">'asdda03'</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'天津'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">'asdda04'</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'重庆'</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 根据原始对象citys去创建响应式对象citys2 —— 创建失败，因为citys被markRaw标记了</span>
<span class="token keyword">let</span> citys2 <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span>citys<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="74customRef_2494"></a>7.4.【customRef】</h3> 
<p>作用：创建一个自定义的<code>ref</code>，并对其依赖项跟踪和更新触发进行逻辑控制。<br> 实现防抖效果（<code>useSumRef.ts</code>）：</p> 
<pre><code class="prism language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>customRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span>initValue<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>delay<span class="token operator">:</span><span class="token builtin">number</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> msg <span class="token operator">=</span> <span class="token function">customRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span>track<span class="token punctuation">,</span>trigger<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> timer<span class="token operator">:</span><span class="token builtin">number</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">track</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 告诉Vue数据msg很重要，要对msg持续关注，一旦变化就更新</span>
        <span class="token keyword">return</span> initValue
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
        timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          initValue <span class="token operator">=</span> value
          <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//通知Vue数据msg变化了</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span> 
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>msg<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>组件中使用</p> 
<h2><a id="8_Vue3_2521"></a>8. Vue3新组件</h2> 
<h3><a id="81_Teleport_2522"></a>8.1. 【Teleport】</h3> 
<ul><li>什么是Teleport？—— Teleport 是一种能够将我们的<strong>组件html结构</strong>移动到指定位置的技术。</li></ul> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>teleport</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>body<span class="token punctuation">'</span></span> <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isShow<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>我是一个弹窗<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>我是弹窗中的一些内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isShow = false<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>关闭弹窗<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>teleport</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3><a id="82_Suspense_2534"></a>8.2. 【Suspense】</h3> 
<ul><li>等待异步组件时渲染一些额外内容，让应用有更好的用户体验</li><li>使用步骤： 
  <ul><li>异步引入组件</li><li>使用<code>Suspense</code>包裹组件，并配置好<code>default</code> 与 <code>fallback</code></li></ul> </li></ul> 
<pre><code class="prism language-tsx">import { defineAsyncComponent,Suspense } from "vue";
const Child = defineAsyncComponent(()=&gt;import('./Child.vue'))
</code></pre> 
<pre><code class="prism language-vue">&lt;template&gt;
    &lt;div class="app"&gt;
        &lt;h3&gt;我是App组件&lt;/h3&gt;
        &lt;Suspense&gt;
          &lt;template v-slot:default&gt;
            &lt;Child/&gt;
          &lt;/template&gt;
          &lt;template v-slot:fallback&gt;
            &lt;h3&gt;加载中.......&lt;/h3&gt;
          &lt;/template&gt;
        &lt;/Suspense&gt;
    &lt;/div&gt;
&lt;/template&gt;
</code></pre> 
<h3><a id="83API_2559"></a>8.3.【全局API转移到应用对象】</h3> 
<ul><li><code>app.component</code></li><li><code>app.config</code></li><li><code>app.directive</code></li><li><code>app.mount</code></li><li><code>app.unmount</code></li><li><code>app.use</code></li></ul> 
<h3><a id="84_2567"></a>8.4.【其他】</h3> 
<ul><li>过渡类名 <code>v-enter</code> 修改为 <code>v-enter-from</code>、过渡类名 <code>v-leave</code> 修改为 <code>v-leave-from</code>。</li><li><code>keyCode</code> 作为 <code>v-on</code> 修饰符的支持。</li><li><code>v-model</code> 指令在组件上的使用已经被重新设计，替换掉了 <code>v-bind.sync。</code></li><li><code>v-if</code> 和 <code>v-for</code> 在同一个元素身上使用时的优先级发生了变化。</li><li>移除了<code>$on</code>、<code>$off</code> 和 <code>$once</code> 实例方法。</li><li>移除了过滤器 <code>filter</code>。</li><li>移除了<code>$children</code> 实例 <code>propert</code>。<br> …</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a7533d3e57c6937f2842f057d2ee5f64/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">难❗️计算机考研408难度又破新高！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/12f35b7245c2589b0c66d323bcdb6369/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于javaweb&#43;mysql的ssm医院在线预约挂号系统(java&#43;ssm&#43;jsp&#43;bootstrap&#43;layui&#43;echarts&#43;mysql)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>