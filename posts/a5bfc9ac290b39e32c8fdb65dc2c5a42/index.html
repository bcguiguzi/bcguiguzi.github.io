<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java生成PDF表单及pdf转图片 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java生成PDF表单及pdf转图片" />
<meta property="og:description" content="1.下载PDF表单编辑工具Adobe Acrobat DC；需要对申请表的word文件或者图片，通过Adobe Acrobat DC或者wps生成pdf文件。
2.打开Acrobat DC，点击工具-&gt;点击准备表单-&gt;选择pdf文件生成表单。
3.对pdf表单进行编辑，双击选中需要编辑的区域，在文本域属性中添加该区域的字段名称及属性
（有些区域不能选中编辑，这个需要你复制其中的一个可编辑区域，把复制的手动移到需要编辑的区域就可以了）
然后保存成pdf表单。
4.导入pdf依赖包，我这里是用的mven
&lt;!--pdf设计器--&gt; &lt;dependency&gt; &lt;groupId&gt;com.itextpdf&lt;/groupId&gt; &lt;artifactId&gt;itextpdf&lt;/artifactId&gt; &lt;version&gt;5.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.itextpdf.tool&lt;/groupId&gt; &lt;artifactId&gt;xmlworker&lt;/artifactId&gt; &lt;version&gt;5.5.6&lt;/version&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/com.itextpdf/itext-asian --&gt; &lt;dependency&gt; &lt;groupId&gt;com.itextpdf&lt;/groupId&gt; &lt;artifactId&gt;itext-asian&lt;/artifactId&gt; &lt;version&gt;5.2.0&lt;/version&gt; &lt;/dependency&gt; &lt;!--pdf转png--&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt; &lt;artifactId&gt;pdfbox&lt;/artifactId&gt; &lt;version&gt;2.0.26&lt;/version&gt; &lt;/dependency&gt; 5.上传生产环境代码块 json结构化数据生成pdf表单。
//加载pdf表单 PdfReader reader = new PdfReader(&#34;pdf表单绝对路径&#34;); ByteArrayOutputStream bos = new ByteArrayOutputStream(); PdfStamper ps = new PdfStamper(reader, bos); AcroFields s = ps.getAcroFields(); /** * 使用中文字体 使用 AcroFields填充值的不需要在程序中设置字体，在模板文件中设置字体为中文字体 Adobe 宋体 std L */ BaseFont bfChinese = BaseFont." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/a5bfc9ac290b39e32c8fdb65dc2c5a42/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-07T17:11:38+08:00" />
<meta property="article:modified_time" content="2023-03-07T17:11:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java生成PDF表单及pdf转图片</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>1.下载PDF表单编辑工具Adobe Acrobat DC；需要对申请表的word文件或者图片，通过Adobe Acrobat DC或者wps生成pdf文件。</p> 
<p>2.打开Acrobat DC，点击工具-&gt;点击准备表单-&gt;选择pdf文件生成表单。</p> 
<p> </p> 
<p><img alt="" height="856" src="https://images2.imgbox.com/6f/e6/zVW2jfer_o.png" width="1126"></p> 
<p><img alt="" height="861" src="https://images2.imgbox.com/ba/6c/OeDfdOMd_o.png" width="1200"></p> 
<p>3.对pdf表单进行编辑，双击选中需要编辑的区域，在文本域属性中添加该区域的字段名称及属性</p> 
<p><span style="color:#ff9900;"><strong>（有些区域不能选中编辑，这个需要你复制其中的一个可编辑区域，把复制的手动移到需要编辑的区域就可以了）</strong></span></p> 
<p><img alt="" height="824" src="https://images2.imgbox.com/58/55/9xu2SnzA_o.png" width="1200"></p> 
<p></p> 
<p><img alt="" height="816" src="https://images2.imgbox.com/b4/39/jVQBYQ0A_o.png" width="1200"> </p> 
<p> </p> 
<p></p> 
<p><img alt="" height="893" src="https://images2.imgbox.com/5a/12/sexVIJgb_o.png" width="1200"> 然后保存成pdf表单。</p> 
<p>4.导入pdf依赖包，我这里是用的mven</p> 
<pre><code class="language-XML"> &lt;!--pdf设计器--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
            &lt;artifactId&gt;itextpdf&lt;/artifactId&gt;
            &lt;version&gt;5.3.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.itextpdf.tool&lt;/groupId&gt;
            &lt;artifactId&gt;xmlworker&lt;/artifactId&gt;
            &lt;version&gt;5.5.6&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!-- https://mvnrepository.com/artifact/com.itextpdf/itext-asian --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
            &lt;artifactId&gt;itext-asian&lt;/artifactId&gt;
            &lt;version&gt;5.2.0&lt;/version&gt;
        &lt;/dependency&gt;
&lt;!--pdf转png--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt;
            &lt;artifactId&gt;pdfbox&lt;/artifactId&gt;
            &lt;version&gt;2.0.26&lt;/version&gt;
        &lt;/dependency&gt;</code></pre> 
<p> 5.上传生产环境代码块  json结构化数据生成pdf表单。</p> 
<pre><code class="language-java">//加载pdf表单
PdfReader reader = new PdfReader("pdf表单绝对路径");
ByteArrayOutputStream bos = new ByteArrayOutputStream();
PdfStamper ps = new PdfStamper(reader, bos);
AcroFields s = ps.getAcroFields();
/**
 * 使用中文字体 使用 AcroFields填充值的不需要在程序中设置字体，在模板文件中设置字体为中文字体 Adobe 宋体 std L
*/
BaseFont bfChinese = BaseFont.createFont("STSongStd-Light", "UniGB-UCS2-H", false);
/**
* 设置编码格式
*/
s.addSubstitutionFont(bfChinese);
//text表单 数据填充
s.setField("表单字段名称", "赋值");
//如果为false那么生成的PDF文件还能编辑，一定要设为true
ps.setFormFlattening(true);
ps.close();
//存放地址
FileOutputStream fos = new FileOutputStream("存放的pdf路径");
//生成pdf
fos.write(bos.toByteArray());
reader.close();
bos.close();
fos.flush();
fos.close();</code></pre> 
<p> 6.对生成的pdf表单进行图片格式转换，pdf文件过大也不容易展示。结合上面的代码进行微调加入了一个pdfToImage()方法，把pdf文件流转换成png图片流。</p> 
<p> </p> 
<pre><code class="language-java">//加载pdf表单
PdfReader reader = new PdfReader("pdf表单绝对路径");
ByteArrayOutputStream bos = new ByteArrayOutputStream();
PdfStamper ps = new PdfStamper(reader, bos);
AcroFields s = ps.getAcroFields();
/**
 * 使用中文字体 使用 AcroFields填充值的不需要在程序中设置字体，在模板文件中设置字体为中文字体 Adobe 宋体 std L
*/
BaseFont bfChinese = BaseFont.createFont("STSongStd-Light", "UniGB-UCS2-H", false);
/**
* 设置编码格式
*/
s.addSubstitutionFont(bfChinese);
//text表单 数据填充
s.setField("表单字段名称", "赋值");
//如果为false那么生成的PDF文件还能编辑，一定要设为true
ps.setFormFlattening(true);
ps.close();
//存放地址
FileOutputStream fos = new FileOutputStream("存放的png路径");
//生成pdf 转图片
fos.write(pdfToImage(bos.toByteArray()));
reader.close();
bos.close();
fos.flush();
fos.close();</code></pre> 
<p>7.pdfToImage()方法代码块，把pdf文件流转换成png图片流</p> 
<pre><code class="language-java">    /**
     * pdf文件转换成jpg图片流
     * @param pdfBytes 要转换的pdf文件的流
     */
    public static byte[] pdfToImage(byte[] pdfBytes) {
        try {
            PDDocument doc = PDDocument.load(pdfBytes);
            int pageCount = doc.getNumberOfPages();
            log.info("PDF转图片流，总页数:{}", pageCount);
            PDFRenderer pdfRenderer = new PDFRenderer(doc);
            // 不知道图片的宽和高，所以先定义个null
            BufferedImage pdfImage = null;
            // pdf有多少页
            int y = 0;
            List &lt;BufferedImage&gt; list = new ArrayList &lt;&gt;(pageCount);
            // 所有页高度综合
            int totalHeight = 0;
            if(pageCount &gt; 0){
                for (int i = 0; i &lt; pageCount; i++) {
                    // 每页pdf内容
                    BufferedImage bim = pdfRenderer.renderImageWithDPI(i, DEFAULT_DPI, ImageType.RGB);
                    totalHeight += bim.getHeight();
                    list.add(bim);
                }
            }
            for (BufferedImage bim : list) {
                // 如果是第一页需要初始化 BufferedImage
                if (Objects.isNull(pdfImage)) {
                    // 创建一个总高、总宽 的图片缓冲区
                    pdfImage = new BufferedImage(bim.getWidth(), totalHeight, BufferedImage.TYPE_INT_RGB);
                }
                // 将每页pdf画到总的pdfImage上,x坐标=0，y坐标=之前所有页的高度和，属于向下偏移
                pdfImage.getGraphics().drawImage(bim, 0, y, null);
                y += bim.getHeight();
            }
            doc.close();
            if(pdfImage != null){
                ByteArrayOutputStream baos = new ByteArrayOutputStream();
                ImageIO.write(pdfImage, "jpg", baos);
                baos.flush();
                byte[] imageInByte = baos.toByteArray();
                log.info("PDF转图片流成功");
                return imageInByte;
            }
            return null;
        } catch (Exception e) {
            log.error("PDF转图片流失败：{}",e.getMessage());
            return null;
        }
    }</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/271e106d07a304eb2cde6678048e9da3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Pytorch学习记录（6）池化层的使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4cfe72afb0ab0d7fddb7da200edd020a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Oracle表空间扩展</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>