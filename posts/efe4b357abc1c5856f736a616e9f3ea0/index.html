<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python第一记，长江雨课堂抓包刷课实战 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python第一记，长江雨课堂抓包刷课实战" />
<meta property="og:description" content="前言 发现大学群里好多代刷网课的，确实觉得好多大学网课好费时间，而且没啥用，刚好用来实战 一下学的Python，就当练手了。省下来的时间不是又能多敲几行代码😃​ 一边省时间，还能学技能，这还不学起来
一、长江雨课堂 1.分析视频请求 F12抓包
播放过程中只有hearbest一个请求，可以确定这个应该就是我们要找的
请求是POST格式，data数据是一个json，通过多个heatbest可以看出是多个观看记录
截取一个分析如下：
c: 1561016 cards_id: 2027472 cc: &#34;&#34; classroomid: 9763037 cp:424.6 d: 485.4 et: &#34;playing&#34; fp: 304.5 i: 5 lob: &#34;ykt&#34; n:&#34;ali-cdn.xuetangx.com&#34; p:&#34;web&#34; pg:&#34;2027472_16s0j&#34; skuid: &#34;&#34; slide: 44 sp:2 sq: 54 t:&#34;ykt_cards&#34; tp: 304.5 ts: &#34;1667910647346&#34; u: 35359786 uip: &#34;&#34; v: 2027472 v_url: &#34;rain://xtvideo/id/1901324024&#34; 没发现什么加密的字段，​那就一个一个处理
复制第一个1561016，在请求里搜索
也只有一个请求里搜索到扫一眼可以知道这是课程的列表数据
地址
https://changjiang.yuketang.cn/v2/api/web/courses/list?identity=2
请求里也莫有加密，后面有用到的我们提取保存一下
c的意思应该是class（班级）
get_classroom_id = &#34;https://changjiang.yuketang.cn/v2/api/web/courses/list?identity=2&#34; classroom_id_response = requests.get(url=get_classroom_id, headers=headers) for ins in json." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/efe4b357abc1c5856f736a616e9f3ea0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-08T23:11:10+08:00" />
<meta property="article:modified_time" content="2022-11-08T23:11:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python第一记，长江雨课堂抓包刷课实战</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>前言</h2> 
<pre><code>    发现大学群里好多代刷网课的，确实觉得好多大学网课好费时间，而且没啥用，刚好用来实战
    一下学的Python，就当练手了。省下来的时间不是又能多敲几行代码😃​
</code></pre> 
<p>一边省时间，还能学技能，这还不学起来<br> <img src="https://images2.imgbox.com/7e/5b/BE7vtEnl_o.gif" alt="请添加图片描述"></p> 
<h2><a id="_7"></a>一、长江雨课堂</h2> 
<h3><a id="1_8"></a>1.分析视频请求</h3> 
<p>F12抓包<br> <img src="https://images2.imgbox.com/19/d0/HbMkEdIu_o.png" alt="抓包"></p> 
<p>播放过程中只有hearbest一个请求，可以确定这个应该就是我们要找的</p> 
<p>请求是POST格式，data数据是一个json，通过多个heatbest可以看出是多个观看记录</p> 
<p>截取一个分析如下：</p> 
<pre><code class="prism language-python">c<span class="token punctuation">:</span> <span class="token number">1561016</span>
cards_id<span class="token punctuation">:</span> <span class="token number">2027472</span>
cc<span class="token punctuation">:</span> <span class="token string">""</span>
classroomid<span class="token punctuation">:</span> <span class="token number">9763037</span>
cp<span class="token punctuation">:</span><span class="token number">424.6</span>
d<span class="token punctuation">:</span> <span class="token number">485.4</span>
et<span class="token punctuation">:</span> <span class="token string">"playing"</span>
fp<span class="token punctuation">:</span> <span class="token number">304.5</span>
i<span class="token punctuation">:</span> <span class="token number">5</span>
lob<span class="token punctuation">:</span> <span class="token string">"ykt"</span>
n<span class="token punctuation">:</span><span class="token string">"ali-cdn.xuetangx.com"</span>
p<span class="token punctuation">:</span><span class="token string">"web"</span>
pg<span class="token punctuation">:</span><span class="token string">"2027472_16s0j"</span>
skuid<span class="token punctuation">:</span> <span class="token string">""</span>
slide<span class="token punctuation">:</span> <span class="token number">44</span>
sp<span class="token punctuation">:</span><span class="token number">2</span>
sq<span class="token punctuation">:</span> <span class="token number">54</span>
t<span class="token punctuation">:</span><span class="token string">"ykt_cards"</span>
tp<span class="token punctuation">:</span> <span class="token number">304.5</span>
ts<span class="token punctuation">:</span> <span class="token string">"1667910647346"</span>
u<span class="token punctuation">:</span> <span class="token number">35359786</span>
uip<span class="token punctuation">:</span> <span class="token string">""</span>
v<span class="token punctuation">:</span> <span class="token number">2027472</span>
v_url<span class="token punctuation">:</span> <span class="token string">"rain://xtvideo/id/1901324024"</span>
</code></pre> 
<p>没发现什么加密的字段，​那就一个一个处理<br> 复制第一个1561016，在请求里搜索</p> 
<p><img src="https://images2.imgbox.com/d7/81/BCLqx0hn_o.png" alt="在这里插入图片描述"><br> 也只有一个请求里搜索到扫一眼可以知道这是课程的列表数据<br> 地址<br> https://changjiang.yuketang.cn/v2/api/web/courses/list?identity=2<br> 请求里也莫有加密，后面有用到的我们提取保存一下<br> c的意思应该是class（班级）</p> 
<pre><code class="prism language-python">get_classroom_id <span class="token operator">=</span> <span class="token string">"https://changjiang.yuketang.cn/v2/api/web/courses/list?identity=2"</span>
classroom_id_response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>get_classroom_id<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
	<span class="token keyword">for</span> ins <span class="token keyword">in</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>classroom_id_response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"list"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
	     your_courses<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
	         <span class="token string">"course_name"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"course"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	         <span class="token string">"classroom_id"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"classroom_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	         <span class="token string">"course_sign"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"university_course_series_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	         <span class="token string">"course_id"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"course"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span>
	     <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>card_id同上搜索也只有一个请求<br> 地址： https://changjiang.yuketang.cn/v2/api/web/logs/learn/9763037?actype=-1&amp;page=0&amp;offset=20&amp;sort=-1<br> 9763037搜索就可以发现是classroom_id，已经保存过了<br> <img src="https://images2.imgbox.com/46/c8/U3g5dX7u_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7a/f3/kGR47bL1_o.png" alt="在这里插入图片描述"></p> 
<p>就是一个课程列表数据<br> 和上面一样有用的数据保存一下</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">get_videos_ids</span><span class="token punctuation">(</span>course_name<span class="token punctuation">,</span>classroom_id<span class="token punctuation">,</span>course_sign<span class="token punctuation">)</span><span class="token punctuation">:</span>
    get_homework_ids <span class="token operator">=</span> <span class="token string">"https://changjiang.yuketang.cn/v2/api/web/logs/learn/"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>classroom_id<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"?actype=-1&amp;page=0&amp;offset=20&amp;sort=-1"</span>
    homework_ids_response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>get_homework_ids<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    homework_json <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>homework_ids_response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    homework_dic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> homework_json<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"activities"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">14</span><span class="token punctuation">:</span>
                <span class="token comment"># 课堂</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">elif</span> i<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">9</span><span class="token punctuation">:</span>
                <span class="token comment"># 公告</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">elif</span> i<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
                <span class="token comment"># 课件</span>
                homework_dic<span class="token punctuation">[</span>i<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'courseware_id'</span> <span class="token punctuation">:</span> i<span class="token punctuation">[</span><span class="token string">'courseware_id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                            <span class="token string">'id'</span> <span class="token punctuation">:</span> i<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span>
                                            <span class="token punctuation">}</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>course_name<span class="token operator">+</span><span class="token string">"共有"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>homework_dic<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"个作业喔！"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> homework_dic
</code></pre> 
<table><thead><tr><th>KEY</th><th>Value</th><th>说明</th></tr></thead><tbody><tr><td>cp</td><td>424.6</td><td>观看时长(破解点)</td></tr><tr><td>d:</td><td>485.4</td><td>视频长度</td></tr><tr><td>et</td><td>“playing”</td><td>操作</td></tr><tr><td>fp</td><td>304.5</td><td>常量</td></tr><tr><td>i</td><td>5</td><td>常量</td></tr><tr><td>lob</td><td>“ykt”</td><td>常量</td></tr><tr><td>n</td><td>“ali-cdn.xuetangx.com”</td><td>常量</td></tr><tr><td>p</td><td>“web”</td><td>(观看方式)常量</td></tr><tr><td>pg</td><td>“2027472_16s0j”</td><td>算个小加密可能</td></tr><tr><td>skuid</td><td>“”</td><td>常量</td></tr><tr><td>slide</td><td>44</td><td>视频所在ppt页数</td></tr><tr><td>sp</td><td>2</td><td>常量</td></tr><tr><td>sq</td><td>54</td><td>常量</td></tr><tr><td>t</td><td>“ykt_cards”</td><td>常量</td></tr><tr><td>tp</td><td>304.5</td><td>常量</td></tr><tr><td>ts</td><td>“1667910647346”</td><td>13位时间戳</td></tr><tr><td>u</td><td>35359786</td><td>user_id</td></tr><tr><td>uip</td><td>“”</td><td>常量</td></tr><tr><td>v</td><td>2027472</td><td>cards_id</td></tr><tr><td>v_url</td><td>“rain://xtvideo/id/1901324024”</td><td>地址</td></tr></tbody></table> 
<p>差不多都是请求里搜索然后找位置保存，没有什么变化，只有pg后面的一小串要在js里面找，但是是个随机产生的数，可以写死。<br> 可以下一个xhr断点<br> <img src="https://images2.imgbox.com/c9/02/hVac113F_o.png" alt="在这里插入图片描述"><br> 段下来之后一个一个看调用堆栈<br> 到resetTimer函数的时候，可以看到参数的构建位置<br> 也可以在这里下断点看一下都是怎么构建的<br> 因为我要找pg， 看到</p> 
<pre><code class="prism language-javascript"><span class="token literal-property property">pg</span><span class="token operator">:</span> e<span class="token punctuation">.</span>options<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">"_"</span> <span class="token operator">+</span> u
</code></pre> 
<p>所以就向上找u<br> <img src="https://images2.imgbox.com/b0/50/r37m4O4u_o.png" alt="在这里插入图片描述"><br> 15760行有定义</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> t<span class="token punctuation">,</span> i<span class="token punctuation">,</span> r<span class="token punctuation">,</span> o<span class="token punctuation">,</span> n<span class="token punctuation">,</span> d<span class="token punctuation">,</span> u <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token number">1048576</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="2_133"></a>2.代码实现</h3> 
<p>ok所用参数都找到获取方式了接下来就是写代码的时间</p> 
<pre><code class="prism language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># version 4</span>
<span class="token comment"># developed by zk chen</span>
<span class="token keyword">import</span> time
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> re
<span class="token keyword">import</span> json
<span class="token keyword">import</span> execjs

<span class="token keyword">class</span> <span class="token class-name">jsFun</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
    <span class="token keyword">def</span> <span class="token function">math</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        fun <span class="token operator">=</span> <span class="token triple-quoted-string string">'''
        function a(){
            let u = Math.floor(1048576 * (1 + Math.random())).toString(36);
            return u;};
        '''</span>
        ctx <span class="token operator">=</span> execjs<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>fun<span class="token punctuation">)</span>
        <span class="token keyword">return</span> ctx<span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span>
<span class="token comment"># 以下的cookie复制下面图片中的内容！！！！而且脚本需在登录雨课堂状态下使用</span>
Cookie <span class="token operator">=</span> <span class="token string">"这里复制粘贴Cookie"</span>
<span class="token comment"># 以下字段不用改，下面的代码也不用改动</span>
user_id <span class="token operator">=</span> <span class="token string">""</span>
f <span class="token operator">=</span> jsFun<span class="token punctuation">(</span><span class="token punctuation">)</span>
headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36 Edg/106.0.1370.42'</span><span class="token punctuation">,</span>
    <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
    <span class="token string">'Cookie'</span><span class="token punctuation">:</span> Cookie
    <span class="token string">'authority'</span><span class="token punctuation">:</span><span class="token string">'changjiang.yuketang.cn'</span><span class="token punctuation">,</span>
    <span class="token string">'method'</span><span class="token punctuation">:</span><span class="token string">'GET'</span><span class="token punctuation">,</span>
    <span class="token string">'path'</span><span class="token punctuation">:</span><span class="token string">'/v2/api/web/courses/list?identity=2'</span><span class="token punctuation">,</span>
    <span class="token string">'referer'</span><span class="token punctuation">:</span><span class="token string">'https://changjiang.yuketang.cn/v2/web/personal/info'</span><span class="token punctuation">,</span>
    <span class="token string">'sec-fetch-dest'</span><span class="token punctuation">:</span><span class="token string">'empty'</span><span class="token punctuation">,</span>
    <span class="token string">'sec-fetch-mode'</span><span class="token punctuation">:</span><span class="token string">'cors'</span><span class="token punctuation">,</span>
    <span class="token string">'sec-fetch-site'</span><span class="token punctuation">:</span><span class="token string">'same-origin'</span><span class="token punctuation">,</span>
    <span class="token comment"># 'university-id':'2727',</span>
    <span class="token string">'x-csrftoken'</span><span class="token punctuation">:</span><span class="token string">'LE6xYWZ4rWN3UFHHDFkiykMBvffI4sCf'</span><span class="token punctuation">,</span>
    <span class="token string">'dnt'</span> <span class="token punctuation">:</span> <span class="token string">'1'</span>
<span class="token punctuation">}</span>

leaf_type <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"video"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string">"homework"</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token string">"exam"</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token string">"recommend"</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token string">"discussion"</span><span class="token punctuation">:</span> <span class="token number">4</span>
<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">get_video_id_list</span><span class="token punctuation">(</span>cards_id<span class="token punctuation">,</span>classroomid<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'https://changjiang.yuketang.cn/v2/api/web/cards/detlist/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>cards_id<span class="token punctuation">}</span></span><span class="token string">?classroom_id=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>classroomid<span class="token punctuation">}</span></span><span class="token string">'</span></span>
    js <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    List <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    num <span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> ins <span class="token keyword">in</span> js<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Slides'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> ins<span class="token punctuation">[</span><span class="token string">'Shapes'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">'playurl'</span> <span class="token keyword">in</span> i<span class="token punctuation">:</span>
                <span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token string">'file_type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                    List<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token string">'URL'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        num <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> List <span class="token punctuation">,</span> num

<span class="token keyword">def</span> <span class="token function">one_video_watcher</span><span class="token punctuation">(</span>video_name<span class="token punctuation">,</span>cid<span class="token punctuation">,</span>user_id<span class="token punctuation">,</span>classroomid<span class="token punctuation">,</span>cards_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
    classroomid <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>classroomid<span class="token punctuation">)</span>
    id_list<span class="token punctuation">,</span>num <span class="token operator">=</span> get_video_id_list<span class="token punctuation">(</span>cards_id<span class="token punctuation">,</span>classroomid<span class="token punctuation">)</span>
    <span class="token keyword">for</span> url_id<span class="token punctuation">,</span>n <span class="token keyword">in</span> id_list<span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string">"https://changjiang.yuketang.cn/video-log/heartbeat/"</span>
        get_url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"https://changjiang.yuketang.cn/video-log/get_video_watch_progress/?user_id=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>user_id<span class="token punctuation">}</span></span><span class="token string">&amp;cid=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>cid<span class="token punctuation">}</span></span><span class="token string">&amp;video_type=ykt_cards&amp;classroom_id=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>classroomid<span class="token punctuation">}</span></span><span class="token string">&amp;cards_id=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>cards_id<span class="token punctuation">}</span></span><span class="token string">&amp;v_url=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>url_id<span class="token punctuation">}</span></span><span class="token string">&amp;slide=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>n<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        headers<span class="token punctuation">[</span><span class="token string">'xtbz'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'ykt'</span>
        progress <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>get_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
        if_completed <span class="token operator">=</span> <span class="token string">'0'</span>
        <span class="token comment"># while 1:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            js <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>progress<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span><span class="token operator">+</span>re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'[0-9]+'</span><span class="token punctuation">,</span>url_id<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            videolength <span class="token operator">=</span> js<span class="token punctuation">[</span><span class="token string">'video_length'</span><span class="token punctuation">]</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"视频"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> video_name <span class="token operator">+</span> <span class="token string">"学习失败！"</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>

                <span class="token comment"># time.sleep(10)</span>
                <span class="token comment"># continue</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            if_completed <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'"completed":(.+?),'</span><span class="token punctuation">,</span> progress<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        <span class="token keyword">if</span> if_completed <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>video_name<span class="token operator">+</span><span class="token string">"已经学习完毕，跳过"</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>video_name<span class="token operator">+</span><span class="token string">"，尚未学习，现在开始自动学习"</span><span class="token punctuation">)</span>
        video_frame <span class="token operator">=</span> <span class="token number">0</span>
        val <span class="token operator">=</span> <span class="token number">0</span>
        learning_rate <span class="token operator">=</span> <span class="token number">20</span>
        t <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        timestap <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>t <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">while</span> val <span class="token operator">!=</span> <span class="token string">"1.0"</span> <span class="token keyword">and</span> val <span class="token operator">!=</span> <span class="token string">'1'</span><span class="token punctuation">:</span>
            heart_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                heart_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"i"</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
                        <span class="token string">"et"</span><span class="token punctuation">:</span> <span class="token string">"loadeddata"</span><span class="token punctuation">,</span>
                        <span class="token string">"p"</span><span class="token punctuation">:</span> <span class="token string">"web"</span><span class="token punctuation">,</span>
                        <span class="token string">"n"</span><span class="token punctuation">:</span> <span class="token string">"ali-cdn.xuetangx.com"</span><span class="token punctuation">,</span>
                        <span class="token string">"lob"</span><span class="token punctuation">:</span> <span class="token string">"ykt"</span><span class="token punctuation">,</span>
                        <span class="token string">"cp"</span><span class="token punctuation">:</span> video_frame<span class="token punctuation">,</span>
                        <span class="token string">"fp"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token string">"tp"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token string">"sp"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                        <span class="token string">"ts"</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>timestap<span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token string">"u"</span><span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span>user_id<span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token string">"uip"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
                        <span class="token string">"c"</span><span class="token punctuation">:</span> cid<span class="token punctuation">,</span>
                        <span class="token string">"v"</span><span class="token punctuation">:</span> cards_id<span class="token punctuation">,</span>
                        <span class="token string">"skuid"</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
                        <span class="token string">"classroomid"</span><span class="token punctuation">:</span> classroomid<span class="token punctuation">,</span>
                        <span class="token string">"cc"</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
                        <span class="token string">"d"</span><span class="token punctuation">:</span> videolength<span class="token punctuation">,</span>
                        <span class="token string">"pg"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>cards_id<span class="token punctuation">}</span></span><span class="token string">_"</span></span><span class="token operator">+</span>f<span class="token punctuation">.</span>math<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token string">"sq"</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                        <span class="token string">"t"</span><span class="token punctuation">:</span> <span class="token string">"ykt_cards"</span><span class="token punctuation">,</span>
                        <span class="token string">"cards_id"</span><span class="token punctuation">:</span> cards_id<span class="token punctuation">,</span>
                        <span class="token string">"slide"</span><span class="token punctuation">:</span> n<span class="token punctuation">,</span>
                        <span class="token string">"v_url"</span><span class="token punctuation">:</span> url_id
                    <span class="token punctuation">}</span>
                <span class="token punctuation">)</span>
                video_frame <span class="token operator">+=</span> learning_rate
                max_time <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3600</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>
                timestap <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>max_time<span class="token punctuation">,</span> timestap<span class="token operator">+</span><span class="token number">1000</span><span class="token operator">*</span><span class="token number">15</span><span class="token punctuation">)</span>
            data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"heart_data"</span><span class="token punctuation">:</span> heart_data<span class="token punctuation">}</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>json<span class="token operator">=</span>data<span class="token punctuation">)</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                error_msg <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span>
                <span class="token keyword">if</span> max_time<span class="token operator">&lt;</span> timestap<span class="token operator">+</span><span class="token number">1000</span><span class="token operator">*</span><span class="token number">15</span><span class="token punctuation">:</span>
                    video_frame <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>

                delay_time <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'Expected available in(.+?)second.'</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"由于网络阻塞，万恶的雨课堂，要阻塞"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>delay_time<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"秒"</span><span class="token punctuation">)</span>
                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>delay_time<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span>
                video_frame <span class="token operator">=</span> <span class="token number">0</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"恢复工作啦～～"</span><span class="token punctuation">)</span>
                r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>submit_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">pass</span>
            progress <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>get_url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
            tmp_rate <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'"rate":(.+?)[,}]'</span><span class="token punctuation">,</span>progress<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
            <span class="token keyword">if</span> tmp_rate <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token number">0</span>
            val <span class="token operator">=</span> tmp_rate<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"学习进度为："</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"%/100%"</span> <span class="token operator">+</span> <span class="token string">" last_point: "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>video_frame<span class="token punctuation">)</span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.7</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"视频"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">" "</span><span class="token operator">+</span>video_name<span class="token operator">+</span><span class="token string">"学习完成！"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">1</span>

<span class="token keyword">def</span> <span class="token function">get_videos_ids</span><span class="token punctuation">(</span>course_name<span class="token punctuation">,</span>classroom_id<span class="token punctuation">,</span>course_sign<span class="token punctuation">)</span><span class="token punctuation">:</span>
    get_homework_ids <span class="token operator">=</span> <span class="token string">"https://changjiang.yuketang.cn/v2/api/web/logs/learn/"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>classroom_id<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"?actype=-1&amp;page=0&amp;offset=20&amp;sort=-1"</span>
    homework_ids_response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>get_homework_ids<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    homework_json <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>homework_ids_response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    homework_dic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> homework_json<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"activities"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">14</span><span class="token punctuation">:</span>
                <span class="token comment"># 课堂</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">elif</span> i<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">9</span><span class="token punctuation">:</span>
                <span class="token comment"># 公告</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">elif</span> i<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
                <span class="token comment"># 课件</span>
                homework_dic<span class="token punctuation">[</span>i<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'courseware_id'</span> <span class="token punctuation">:</span> i<span class="token punctuation">[</span><span class="token string">'courseware_id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                            <span class="token string">'id'</span> <span class="token punctuation">:</span> i<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span>
                                            <span class="token punctuation">}</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>course_name<span class="token operator">+</span><span class="token string">"共有"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>homework_dic<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"个作业喔！"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> homework_dic
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"fail while getting homework_ids!!! please re-run this program!"</span><span class="token punctuation">)</span>
        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"fail while getting homework_ids!!! please re-run this program!"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    your_courses <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token comment"># 首先要获取用户的个人ID，即user_id,该值在查询用户的视频进度时需要使用</span>
    user_id_url <span class="token operator">=</span> <span class="token string">"https://changjiang.yuketang.cn/v/course_meta/user_info"</span>

    id_response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>user_id_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    id_response<span class="token punctuation">.</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        user_id <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'"user_id": ([0-9]+),'</span><span class="token punctuation">,</span> id_response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"也许是网路问题，获取不了user_id,请试着重新运行"</span><span class="token punctuation">)</span>
        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"也许是网路问题，获取不了user_id,请试着重新运行!!! please re-run this program!"</span><span class="token punctuation">)</span>

    <span class="token comment"># 然后要获取教室id</span>
    get_classroom_id <span class="token operator">=</span> <span class="token string">"https://changjiang.yuketang.cn/v2/api/web/courses/list?identity=2"</span>
    submit_url <span class="token operator">=</span> <span class="token string">"https://gruestc.yuketang.cn/mooc-api/v1/lms/exercise/problem_apply/?term=latest&amp;uv_id=3194"</span>
    headers<span class="token punctuation">[</span><span class="token string">"referer"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'https://changjiang.yuketang.cn/v2/web/index?date=1666686775760&amp;newWeb=1'</span>
    classroom_id_response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>get_classroom_id<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> ins <span class="token keyword">in</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>classroom_id_response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"list"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            your_courses<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token string">"course_name"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"course"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"classroom_id"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"classroom_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"course_sign"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"university_course_series_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"course_id"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"course"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"fail while getting classroom_id!!! please re-run this program!"</span><span class="token punctuation">)</span>
        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"fail while getting classroom_id!!! please re-run this program!"</span><span class="token punctuation">)</span>

    <span class="token comment"># 显示用户提示</span>
    <span class="token keyword">for</span> index<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>your_courses<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"编号："</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">" 课名："</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">[</span><span class="token string">"course_name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    number <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"你想刷哪门课呢？请输入编号。输入0表示全部课程都刷一遍\n"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token comment">#0 表示全部刷一遍</span>
        <span class="token keyword">for</span> ins <span class="token keyword">in</span> your_courses<span class="token punctuation">:</span>
            homework_dic <span class="token operator">=</span> get_videos_ids<span class="token punctuation">(</span>ins<span class="token punctuation">[</span><span class="token string">"course_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ins<span class="token punctuation">[</span><span class="token string">"classroom_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ins<span class="token punctuation">[</span><span class="token string">"course_sign"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> one_video <span class="token keyword">in</span> homework_dic<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                one_video_watcher<span class="token punctuation">(</span>one_video<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ins<span class="token punctuation">[</span><span class="token string">"course_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>user_id<span class="token punctuation">,</span>ins<span class="token punctuation">[</span><span class="token string">"classroom_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>cards_id<span class="token operator">=</span>homework_dic<span class="token punctuation">[</span>one_video<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment">#指定序号的课程刷一遍</span>
        number <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span>
        homework_dic <span class="token operator">=</span> get_videos_ids<span class="token punctuation">(</span>your_courses<span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"course_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>your_courses<span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"classroom_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>your_courses<span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"course_sign"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> one_video <span class="token keyword">in</span> homework_dic<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            one_video_watcher<span class="token punctuation">(</span>one_video<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> your_courses<span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"course_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> your_courses<span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"classroom_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>cards_id <span class="token operator">=</span> one_video<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'courseware_id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre> 
<p>cookie替换一下<br> <img src="https://images2.imgbox.com/fd/b6/qKDelUws_o.png" alt="请添加图片描述"></p> 
<h3><a id="_369"></a>总结</h3> 
<pre><code>大体就是播放视频，抓包，找参数，在请求里搜素，加密了就下断点看实现。
！！！主要是思路，还有一些雨课堂，学习通，mooc，什么的都差不多的。
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2977e694b10cdfa5319327660a11a080/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ARCGIS中相同投影不重合显示问题的解决（易康导出地图投影设置问题的解决）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1cc5bc294f69150a1ca2732ab6ae87d7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java里面的CompletableFuture的异常和事务问题和AtomicBoolean解决办法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>