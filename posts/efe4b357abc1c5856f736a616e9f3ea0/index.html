<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>pythonç¬¬ä¸€è®°ï¼Œé•¿æ±Ÿé›¨è¯¾å ‚æŠ“åŒ…åˆ·è¯¾å®æˆ˜ - ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="pythonç¬¬ä¸€è®°ï¼Œé•¿æ±Ÿé›¨è¯¾å ‚æŠ“åŒ…åˆ·è¯¾å®æˆ˜" />
<meta property="og:description" content="å‰è¨€ å‘ç°å¤§å­¦ç¾¤é‡Œå¥½å¤šä»£åˆ·ç½‘è¯¾çš„ï¼Œç¡®å®è§‰å¾—å¥½å¤šå¤§å­¦ç½‘è¯¾å¥½è´¹æ—¶é—´ï¼Œè€Œä¸”æ²¡å•¥ç”¨ï¼Œåˆšå¥½ç”¨æ¥å®æˆ˜ ä¸€ä¸‹å­¦çš„Pythonï¼Œå°±å½“ç»ƒæ‰‹äº†ã€‚çœä¸‹æ¥çš„æ—¶é—´ä¸æ˜¯åˆèƒ½å¤šæ•²å‡ è¡Œä»£ç ğŸ˜ƒâ€‹ ä¸€è¾¹çœæ—¶é—´ï¼Œè¿˜èƒ½å­¦æŠ€èƒ½ï¼Œè¿™è¿˜ä¸å­¦èµ·æ¥
ä¸€ã€é•¿æ±Ÿé›¨è¯¾å ‚ 1.åˆ†æè§†é¢‘è¯·æ±‚ F12æŠ“åŒ…
æ’­æ”¾è¿‡ç¨‹ä¸­åªæœ‰hearbestä¸€ä¸ªè¯·æ±‚ï¼Œå¯ä»¥ç¡®å®šè¿™ä¸ªåº”è¯¥å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„
è¯·æ±‚æ˜¯POSTæ ¼å¼ï¼Œdataæ•°æ®æ˜¯ä¸€ä¸ªjsonï¼Œé€šè¿‡å¤šä¸ªheatbestå¯ä»¥çœ‹å‡ºæ˜¯å¤šä¸ªè§‚çœ‹è®°å½•
æˆªå–ä¸€ä¸ªåˆ†æå¦‚ä¸‹ï¼š
c: 1561016 cards_id: 2027472 cc: &#34;&#34; classroomid: 9763037 cp:424.6 d: 485.4 et: &#34;playing&#34; fp: 304.5 i: 5 lob: &#34;ykt&#34; n:&#34;ali-cdn.xuetangx.com&#34; p:&#34;web&#34; pg:&#34;2027472_16s0j&#34; skuid: &#34;&#34; slide: 44 sp:2 sq: 54 t:&#34;ykt_cards&#34; tp: 304.5 ts: &#34;1667910647346&#34; u: 35359786 uip: &#34;&#34; v: 2027472 v_url: &#34;rain://xtvideo/id/1901324024&#34; æ²¡å‘ç°ä»€ä¹ˆåŠ å¯†çš„å­—æ®µï¼Œâ€‹é‚£å°±ä¸€ä¸ªä¸€ä¸ªå¤„ç†
å¤åˆ¶ç¬¬ä¸€ä¸ª1561016ï¼Œåœ¨è¯·æ±‚é‡Œæœç´¢
ä¹Ÿåªæœ‰ä¸€ä¸ªè¯·æ±‚é‡Œæœç´¢åˆ°æ‰«ä¸€çœ¼å¯ä»¥çŸ¥é“è¿™æ˜¯è¯¾ç¨‹çš„åˆ—è¡¨æ•°æ®
åœ°å€
https://changjiang.yuketang.cn/v2/api/web/courses/list?identity=2
è¯·æ±‚é‡Œä¹Ÿè«æœ‰åŠ å¯†ï¼Œåé¢æœ‰ç”¨åˆ°çš„æˆ‘ä»¬æå–ä¿å­˜ä¸€ä¸‹
cçš„æ„æ€åº”è¯¥æ˜¯classï¼ˆç­çº§ï¼‰
get_classroom_id = &#34;https://changjiang.yuketang.cn/v2/api/web/courses/list?identity=2&#34; classroom_id_response = requests.get(url=get_classroom_id, headers=headers) for ins in json." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/efe4b357abc1c5856f736a616e9f3ea0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-08T23:11:10+08:00" />
<meta property="article:modified_time" content="2022-11-08T23:11:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">pythonç¬¬ä¸€è®°ï¼Œé•¿æ±Ÿé›¨è¯¾å ‚æŠ“åŒ…åˆ·è¯¾å®æˆ˜</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>å‰è¨€</h2> 
<pre><code>    å‘ç°å¤§å­¦ç¾¤é‡Œå¥½å¤šä»£åˆ·ç½‘è¯¾çš„ï¼Œç¡®å®è§‰å¾—å¥½å¤šå¤§å­¦ç½‘è¯¾å¥½è´¹æ—¶é—´ï¼Œè€Œä¸”æ²¡å•¥ç”¨ï¼Œåˆšå¥½ç”¨æ¥å®æˆ˜
    ä¸€ä¸‹å­¦çš„Pythonï¼Œå°±å½“ç»ƒæ‰‹äº†ã€‚çœä¸‹æ¥çš„æ—¶é—´ä¸æ˜¯åˆèƒ½å¤šæ•²å‡ è¡Œä»£ç ğŸ˜ƒâ€‹
</code></pre> 
<p>ä¸€è¾¹çœæ—¶é—´ï¼Œè¿˜èƒ½å­¦æŠ€èƒ½ï¼Œè¿™è¿˜ä¸å­¦èµ·æ¥<br> <img src="https://images2.imgbox.com/7e/5b/BE7vtEnl_o.gif" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p> 
<h2><a id="_7"></a>ä¸€ã€é•¿æ±Ÿé›¨è¯¾å ‚</h2> 
<h3><a id="1_8"></a>1.åˆ†æè§†é¢‘è¯·æ±‚</h3> 
<p>F12æŠ“åŒ…<br> <img src="https://images2.imgbox.com/19/d0/HbMkEdIu_o.png" alt="æŠ“åŒ…"></p> 
<p>æ’­æ”¾è¿‡ç¨‹ä¸­åªæœ‰hearbestä¸€ä¸ªè¯·æ±‚ï¼Œå¯ä»¥ç¡®å®šè¿™ä¸ªåº”è¯¥å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„</p> 
<p>è¯·æ±‚æ˜¯POSTæ ¼å¼ï¼Œdataæ•°æ®æ˜¯ä¸€ä¸ªjsonï¼Œé€šè¿‡å¤šä¸ªheatbestå¯ä»¥çœ‹å‡ºæ˜¯å¤šä¸ªè§‚çœ‹è®°å½•</p> 
<p>æˆªå–ä¸€ä¸ªåˆ†æå¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-python">c<span class="token punctuation">:</span> <span class="token number">1561016</span>
cards_id<span class="token punctuation">:</span> <span class="token number">2027472</span>
cc<span class="token punctuation">:</span> <span class="token string">""</span>
classroomid<span class="token punctuation">:</span> <span class="token number">9763037</span>
cp<span class="token punctuation">:</span><span class="token number">424.6</span>
d<span class="token punctuation">:</span> <span class="token number">485.4</span>
et<span class="token punctuation">:</span> <span class="token string">"playing"</span>
fp<span class="token punctuation">:</span> <span class="token number">304.5</span>
i<span class="token punctuation">:</span> <span class="token number">5</span>
lob<span class="token punctuation">:</span> <span class="token string">"ykt"</span>
n<span class="token punctuation">:</span><span class="token string">"ali-cdn.xuetangx.com"</span>
p<span class="token punctuation">:</span><span class="token string">"web"</span>
pg<span class="token punctuation">:</span><span class="token string">"2027472_16s0j"</span>
skuid<span class="token punctuation">:</span> <span class="token string">""</span>
slide<span class="token punctuation">:</span> <span class="token number">44</span>
sp<span class="token punctuation">:</span><span class="token number">2</span>
sq<span class="token punctuation">:</span> <span class="token number">54</span>
t<span class="token punctuation">:</span><span class="token string">"ykt_cards"</span>
tp<span class="token punctuation">:</span> <span class="token number">304.5</span>
ts<span class="token punctuation">:</span> <span class="token string">"1667910647346"</span>
u<span class="token punctuation">:</span> <span class="token number">35359786</span>
uip<span class="token punctuation">:</span> <span class="token string">""</span>
v<span class="token punctuation">:</span> <span class="token number">2027472</span>
v_url<span class="token punctuation">:</span> <span class="token string">"rain://xtvideo/id/1901324024"</span>
</code></pre> 
<p>æ²¡å‘ç°ä»€ä¹ˆåŠ å¯†çš„å­—æ®µï¼Œâ€‹é‚£å°±ä¸€ä¸ªä¸€ä¸ªå¤„ç†<br> å¤åˆ¶ç¬¬ä¸€ä¸ª1561016ï¼Œåœ¨è¯·æ±‚é‡Œæœç´¢</p> 
<p><img src="https://images2.imgbox.com/d7/81/BCLqx0hn_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> ä¹Ÿåªæœ‰ä¸€ä¸ªè¯·æ±‚é‡Œæœç´¢åˆ°æ‰«ä¸€çœ¼å¯ä»¥çŸ¥é“è¿™æ˜¯è¯¾ç¨‹çš„åˆ—è¡¨æ•°æ®<br> åœ°å€<br> https://changjiang.yuketang.cn/v2/api/web/courses/list?identity=2<br> è¯·æ±‚é‡Œä¹Ÿè«æœ‰åŠ å¯†ï¼Œåé¢æœ‰ç”¨åˆ°çš„æˆ‘ä»¬æå–ä¿å­˜ä¸€ä¸‹<br> cçš„æ„æ€åº”è¯¥æ˜¯classï¼ˆç­çº§ï¼‰</p> 
<pre><code class="prism language-python">get_classroom_id <span class="token operator">=</span> <span class="token string">"https://changjiang.yuketang.cn/v2/api/web/courses/list?identity=2"</span>
classroom_id_response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>get_classroom_id<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
	<span class="token keyword">for</span> ins <span class="token keyword">in</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>classroom_id_response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"list"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
	     your_courses<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
	         <span class="token string">"course_name"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"course"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	         <span class="token string">"classroom_id"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"classroom_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	         <span class="token string">"course_sign"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"university_course_series_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	         <span class="token string">"course_id"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"course"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span>
	     <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>card_idåŒä¸Šæœç´¢ä¹Ÿåªæœ‰ä¸€ä¸ªè¯·æ±‚<br> åœ°å€ï¼š https://changjiang.yuketang.cn/v2/api/web/logs/learn/9763037?actype=-1&amp;page=0&amp;offset=20&amp;sort=-1<br> 9763037æœç´¢å°±å¯ä»¥å‘ç°æ˜¯classroom_idï¼Œå·²ç»ä¿å­˜è¿‡äº†<br> <img src="https://images2.imgbox.com/46/c8/U3g5dX7u_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <img src="https://images2.imgbox.com/7a/f3/kGR47bL1_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>å°±æ˜¯ä¸€ä¸ªè¯¾ç¨‹åˆ—è¡¨æ•°æ®<br> å’Œä¸Šé¢ä¸€æ ·æœ‰ç”¨çš„æ•°æ®ä¿å­˜ä¸€ä¸‹</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">get_videos_ids</span><span class="token punctuation">(</span>course_name<span class="token punctuation">,</span>classroom_id<span class="token punctuation">,</span>course_sign<span class="token punctuation">)</span><span class="token punctuation">:</span>
    get_homework_ids <span class="token operator">=</span> <span class="token string">"https://changjiang.yuketang.cn/v2/api/web/logs/learn/"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>classroom_id<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"?actype=-1&amp;page=0&amp;offset=20&amp;sort=-1"</span>
    homework_ids_response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>get_homework_ids<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    homework_json <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>homework_ids_response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    homework_dic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> homework_json<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"activities"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">14</span><span class="token punctuation">:</span>
                <span class="token comment"># è¯¾å ‚</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">elif</span> i<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">9</span><span class="token punctuation">:</span>
                <span class="token comment"># å…¬å‘Š</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">elif</span> i<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
                <span class="token comment"># è¯¾ä»¶</span>
                homework_dic<span class="token punctuation">[</span>i<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'courseware_id'</span> <span class="token punctuation">:</span> i<span class="token punctuation">[</span><span class="token string">'courseware_id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                            <span class="token string">'id'</span> <span class="token punctuation">:</span> i<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span>
                                            <span class="token punctuation">}</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>course_name<span class="token operator">+</span><span class="token string">"å…±æœ‰"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>homework_dic<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"ä¸ªä½œä¸šå–”ï¼"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> homework_dic
</code></pre> 
<table><thead><tr><th>KEY</th><th>Value</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>cp</td><td>424.6</td><td>è§‚çœ‹æ—¶é•¿(ç ´è§£ç‚¹)</td></tr><tr><td>d:</td><td>485.4</td><td>è§†é¢‘é•¿åº¦</td></tr><tr><td>et</td><td>â€œplayingâ€</td><td>æ“ä½œ</td></tr><tr><td>fp</td><td>304.5</td><td>å¸¸é‡</td></tr><tr><td>i</td><td>5</td><td>å¸¸é‡</td></tr><tr><td>lob</td><td>â€œyktâ€</td><td>å¸¸é‡</td></tr><tr><td>n</td><td>â€œali-cdn.xuetangx.comâ€</td><td>å¸¸é‡</td></tr><tr><td>p</td><td>â€œwebâ€</td><td>(è§‚çœ‹æ–¹å¼)å¸¸é‡</td></tr><tr><td>pg</td><td>â€œ2027472_16s0jâ€</td><td>ç®—ä¸ªå°åŠ å¯†å¯èƒ½</td></tr><tr><td>skuid</td><td>â€œâ€</td><td>å¸¸é‡</td></tr><tr><td>slide</td><td>44</td><td>è§†é¢‘æ‰€åœ¨ppté¡µæ•°</td></tr><tr><td>sp</td><td>2</td><td>å¸¸é‡</td></tr><tr><td>sq</td><td>54</td><td>å¸¸é‡</td></tr><tr><td>t</td><td>â€œykt_cardsâ€</td><td>å¸¸é‡</td></tr><tr><td>tp</td><td>304.5</td><td>å¸¸é‡</td></tr><tr><td>ts</td><td>â€œ1667910647346â€</td><td>13ä½æ—¶é—´æˆ³</td></tr><tr><td>u</td><td>35359786</td><td>user_id</td></tr><tr><td>uip</td><td>â€œâ€</td><td>å¸¸é‡</td></tr><tr><td>v</td><td>2027472</td><td>cards_id</td></tr><tr><td>v_url</td><td>â€œrain://xtvideo/id/1901324024â€</td><td>åœ°å€</td></tr></tbody></table> 
<p>å·®ä¸å¤šéƒ½æ˜¯è¯·æ±‚é‡Œæœç´¢ç„¶åæ‰¾ä½ç½®ä¿å­˜ï¼Œæ²¡æœ‰ä»€ä¹ˆå˜åŒ–ï¼Œåªæœ‰pgåé¢çš„ä¸€å°ä¸²è¦åœ¨jsé‡Œé¢æ‰¾ï¼Œä½†æ˜¯æ˜¯ä¸ªéšæœºäº§ç”Ÿçš„æ•°ï¼Œå¯ä»¥å†™æ­»ã€‚<br> å¯ä»¥ä¸‹ä¸€ä¸ªxhræ–­ç‚¹<br> <img src="https://images2.imgbox.com/c9/02/hVac113F_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> æ®µä¸‹æ¥ä¹‹åä¸€ä¸ªä¸€ä¸ªçœ‹è°ƒç”¨å †æ ˆ<br> åˆ°resetTimerå‡½æ•°çš„æ—¶å€™ï¼Œå¯ä»¥çœ‹åˆ°å‚æ•°çš„æ„å»ºä½ç½®<br> ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œä¸‹æ–­ç‚¹çœ‹ä¸€ä¸‹éƒ½æ˜¯æ€ä¹ˆæ„å»ºçš„<br> å› ä¸ºæˆ‘è¦æ‰¾pgï¼Œ çœ‹åˆ°</p> 
<pre><code class="prism language-javascript"><span class="token literal-property property">pg</span><span class="token operator">:</span> e<span class="token punctuation">.</span>options<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">"_"</span> <span class="token operator">+</span> u
</code></pre> 
<p>æ‰€ä»¥å°±å‘ä¸Šæ‰¾u<br> <img src="https://images2.imgbox.com/b0/50/r37m4O4u_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> 15760è¡Œæœ‰å®šä¹‰</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> t<span class="token punctuation">,</span> i<span class="token punctuation">,</span> r<span class="token punctuation">,</span> o<span class="token punctuation">,</span> n<span class="token punctuation">,</span> d<span class="token punctuation">,</span> u <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token number">1048576</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="2_133"></a>2.ä»£ç å®ç°</h3> 
<p>okæ‰€ç”¨å‚æ•°éƒ½æ‰¾åˆ°è·å–æ–¹å¼äº†æ¥ä¸‹æ¥å°±æ˜¯å†™ä»£ç çš„æ—¶é—´</p> 
<pre><code class="prism language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># version 4</span>
<span class="token comment"># developed by zk chen</span>
<span class="token keyword">import</span> time
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> re
<span class="token keyword">import</span> json
<span class="token keyword">import</span> execjs

<span class="token keyword">class</span> <span class="token class-name">jsFun</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
    <span class="token keyword">def</span> <span class="token function">math</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        fun <span class="token operator">=</span> <span class="token triple-quoted-string string">'''
        function a(){
            let u = Math.floor(1048576 * (1 + Math.random())).toString(36);
            return u;};
        '''</span>
        ctx <span class="token operator">=</span> execjs<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>fun<span class="token punctuation">)</span>
        <span class="token keyword">return</span> ctx<span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span>
<span class="token comment"># ä»¥ä¸‹çš„cookieå¤åˆ¶ä¸‹é¢å›¾ç‰‡ä¸­çš„å†…å®¹ï¼ï¼ï¼ï¼è€Œä¸”è„šæœ¬éœ€åœ¨ç™»å½•é›¨è¯¾å ‚çŠ¶æ€ä¸‹ä½¿ç”¨</span>
Cookie <span class="token operator">=</span> <span class="token string">"è¿™é‡Œå¤åˆ¶ç²˜è´´Cookie"</span>
<span class="token comment"># ä»¥ä¸‹å­—æ®µä¸ç”¨æ”¹ï¼Œä¸‹é¢çš„ä»£ç ä¹Ÿä¸ç”¨æ”¹åŠ¨</span>
user_id <span class="token operator">=</span> <span class="token string">""</span>
f <span class="token operator">=</span> jsFun<span class="token punctuation">(</span><span class="token punctuation">)</span>
headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36 Edg/106.0.1370.42'</span><span class="token punctuation">,</span>
    <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
    <span class="token string">'Cookie'</span><span class="token punctuation">:</span> Cookie
    <span class="token string">'authority'</span><span class="token punctuation">:</span><span class="token string">'changjiang.yuketang.cn'</span><span class="token punctuation">,</span>
    <span class="token string">'method'</span><span class="token punctuation">:</span><span class="token string">'GET'</span><span class="token punctuation">,</span>
    <span class="token string">'path'</span><span class="token punctuation">:</span><span class="token string">'/v2/api/web/courses/list?identity=2'</span><span class="token punctuation">,</span>
    <span class="token string">'referer'</span><span class="token punctuation">:</span><span class="token string">'https://changjiang.yuketang.cn/v2/web/personal/info'</span><span class="token punctuation">,</span>
    <span class="token string">'sec-fetch-dest'</span><span class="token punctuation">:</span><span class="token string">'empty'</span><span class="token punctuation">,</span>
    <span class="token string">'sec-fetch-mode'</span><span class="token punctuation">:</span><span class="token string">'cors'</span><span class="token punctuation">,</span>
    <span class="token string">'sec-fetch-site'</span><span class="token punctuation">:</span><span class="token string">'same-origin'</span><span class="token punctuation">,</span>
    <span class="token comment"># 'university-id':'2727',</span>
    <span class="token string">'x-csrftoken'</span><span class="token punctuation">:</span><span class="token string">'LE6xYWZ4rWN3UFHHDFkiykMBvffI4sCf'</span><span class="token punctuation">,</span>
    <span class="token string">'dnt'</span> <span class="token punctuation">:</span> <span class="token string">'1'</span>
<span class="token punctuation">}</span>

leaf_type <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"video"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string">"homework"</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token string">"exam"</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token string">"recommend"</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token string">"discussion"</span><span class="token punctuation">:</span> <span class="token number">4</span>
<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">get_video_id_list</span><span class="token punctuation">(</span>cards_id<span class="token punctuation">,</span>classroomid<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'https://changjiang.yuketang.cn/v2/api/web/cards/detlist/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>cards_id<span class="token punctuation">}</span></span><span class="token string">?classroom_id=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>classroomid<span class="token punctuation">}</span></span><span class="token string">'</span></span>
    js <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    List <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    num <span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">for</span> ins <span class="token keyword">in</span> js<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Slides'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> ins<span class="token punctuation">[</span><span class="token string">'Shapes'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">'playurl'</span> <span class="token keyword">in</span> i<span class="token punctuation">:</span>
                <span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token string">'file_type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                    List<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token string">'URL'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        num <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> List <span class="token punctuation">,</span> num

<span class="token keyword">def</span> <span class="token function">one_video_watcher</span><span class="token punctuation">(</span>video_name<span class="token punctuation">,</span>cid<span class="token punctuation">,</span>user_id<span class="token punctuation">,</span>classroomid<span class="token punctuation">,</span>cards_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
    classroomid <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>classroomid<span class="token punctuation">)</span>
    id_list<span class="token punctuation">,</span>num <span class="token operator">=</span> get_video_id_list<span class="token punctuation">(</span>cards_id<span class="token punctuation">,</span>classroomid<span class="token punctuation">)</span>
    <span class="token keyword">for</span> url_id<span class="token punctuation">,</span>n <span class="token keyword">in</span> id_list<span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string">"https://changjiang.yuketang.cn/video-log/heartbeat/"</span>
        get_url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"https://changjiang.yuketang.cn/video-log/get_video_watch_progress/?user_id=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>user_id<span class="token punctuation">}</span></span><span class="token string">&amp;cid=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>cid<span class="token punctuation">}</span></span><span class="token string">&amp;video_type=ykt_cards&amp;classroom_id=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>classroomid<span class="token punctuation">}</span></span><span class="token string">&amp;cards_id=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>cards_id<span class="token punctuation">}</span></span><span class="token string">&amp;v_url=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>url_id<span class="token punctuation">}</span></span><span class="token string">&amp;slide=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>n<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        headers<span class="token punctuation">[</span><span class="token string">'xtbz'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'ykt'</span>
        progress <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>get_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
        if_completed <span class="token operator">=</span> <span class="token string">'0'</span>
        <span class="token comment"># while 1:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            js <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>progress<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span><span class="token operator">+</span>re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'[0-9]+'</span><span class="token punctuation">,</span>url_id<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            videolength <span class="token operator">=</span> js<span class="token punctuation">[</span><span class="token string">'video_length'</span><span class="token punctuation">]</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è§†é¢‘"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> video_name <span class="token operator">+</span> <span class="token string">"å­¦ä¹ å¤±è´¥ï¼"</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>

                <span class="token comment"># time.sleep(10)</span>
                <span class="token comment"># continue</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            if_completed <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'"completed":(.+?),'</span><span class="token punctuation">,</span> progress<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        <span class="token keyword">if</span> if_completed <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>video_name<span class="token operator">+</span><span class="token string">"å·²ç»å­¦ä¹ å®Œæ¯•ï¼Œè·³è¿‡"</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>video_name<span class="token operator">+</span><span class="token string">"ï¼Œå°šæœªå­¦ä¹ ï¼Œç°åœ¨å¼€å§‹è‡ªåŠ¨å­¦ä¹ "</span><span class="token punctuation">)</span>
        video_frame <span class="token operator">=</span> <span class="token number">0</span>
        val <span class="token operator">=</span> <span class="token number">0</span>
        learning_rate <span class="token operator">=</span> <span class="token number">20</span>
        t <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        timestap <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>t <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">while</span> val <span class="token operator">!=</span> <span class="token string">"1.0"</span> <span class="token keyword">and</span> val <span class="token operator">!=</span> <span class="token string">'1'</span><span class="token punctuation">:</span>
            heart_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                heart_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"i"</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
                        <span class="token string">"et"</span><span class="token punctuation">:</span> <span class="token string">"loadeddata"</span><span class="token punctuation">,</span>
                        <span class="token string">"p"</span><span class="token punctuation">:</span> <span class="token string">"web"</span><span class="token punctuation">,</span>
                        <span class="token string">"n"</span><span class="token punctuation">:</span> <span class="token string">"ali-cdn.xuetangx.com"</span><span class="token punctuation">,</span>
                        <span class="token string">"lob"</span><span class="token punctuation">:</span> <span class="token string">"ykt"</span><span class="token punctuation">,</span>
                        <span class="token string">"cp"</span><span class="token punctuation">:</span> video_frame<span class="token punctuation">,</span>
                        <span class="token string">"fp"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token string">"tp"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token string">"sp"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                        <span class="token string">"ts"</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>timestap<span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token string">"u"</span><span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span>user_id<span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token string">"uip"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
                        <span class="token string">"c"</span><span class="token punctuation">:</span> cid<span class="token punctuation">,</span>
                        <span class="token string">"v"</span><span class="token punctuation">:</span> cards_id<span class="token punctuation">,</span>
                        <span class="token string">"skuid"</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
                        <span class="token string">"classroomid"</span><span class="token punctuation">:</span> classroomid<span class="token punctuation">,</span>
                        <span class="token string">"cc"</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
                        <span class="token string">"d"</span><span class="token punctuation">:</span> videolength<span class="token punctuation">,</span>
                        <span class="token string">"pg"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>cards_id<span class="token punctuation">}</span></span><span class="token string">_"</span></span><span class="token operator">+</span>f<span class="token punctuation">.</span>math<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token string">"sq"</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                        <span class="token string">"t"</span><span class="token punctuation">:</span> <span class="token string">"ykt_cards"</span><span class="token punctuation">,</span>
                        <span class="token string">"cards_id"</span><span class="token punctuation">:</span> cards_id<span class="token punctuation">,</span>
                        <span class="token string">"slide"</span><span class="token punctuation">:</span> n<span class="token punctuation">,</span>
                        <span class="token string">"v_url"</span><span class="token punctuation">:</span> url_id
                    <span class="token punctuation">}</span>
                <span class="token punctuation">)</span>
                video_frame <span class="token operator">+=</span> learning_rate
                max_time <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3600</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>
                timestap <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>max_time<span class="token punctuation">,</span> timestap<span class="token operator">+</span><span class="token number">1000</span><span class="token operator">*</span><span class="token number">15</span><span class="token punctuation">)</span>
            data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"heart_data"</span><span class="token punctuation">:</span> heart_data<span class="token punctuation">}</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>json<span class="token operator">=</span>data<span class="token punctuation">)</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                error_msg <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span>
                <span class="token keyword">if</span> max_time<span class="token operator">&lt;</span> timestap<span class="token operator">+</span><span class="token number">1000</span><span class="token operator">*</span><span class="token number">15</span><span class="token punctuation">:</span>
                    video_frame <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>

                delay_time <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'Expected available in(.+?)second.'</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç”±äºç½‘ç»œé˜»å¡ï¼Œä¸‡æ¶çš„é›¨è¯¾å ‚ï¼Œè¦é˜»å¡"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>delay_time<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"ç§’"</span><span class="token punctuation">)</span>
                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>delay_time<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span>
                video_frame <span class="token operator">=</span> <span class="token number">0</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ¢å¤å·¥ä½œå•¦ï½ï½"</span><span class="token punctuation">)</span>
                r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>submit_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">pass</span>
            progress <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>get_url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
            tmp_rate <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'"rate":(.+?)[,}]'</span><span class="token punctuation">,</span>progress<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
            <span class="token keyword">if</span> tmp_rate <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token number">0</span>
            val <span class="token operator">=</span> tmp_rate<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å­¦ä¹ è¿›åº¦ä¸ºï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"%/100%"</span> <span class="token operator">+</span> <span class="token string">" last_point: "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>video_frame<span class="token punctuation">)</span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.7</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è§†é¢‘"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">" "</span><span class="token operator">+</span>video_name<span class="token operator">+</span><span class="token string">"å­¦ä¹ å®Œæˆï¼"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">1</span>

<span class="token keyword">def</span> <span class="token function">get_videos_ids</span><span class="token punctuation">(</span>course_name<span class="token punctuation">,</span>classroom_id<span class="token punctuation">,</span>course_sign<span class="token punctuation">)</span><span class="token punctuation">:</span>
    get_homework_ids <span class="token operator">=</span> <span class="token string">"https://changjiang.yuketang.cn/v2/api/web/logs/learn/"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>classroom_id<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"?actype=-1&amp;page=0&amp;offset=20&amp;sort=-1"</span>
    homework_ids_response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>get_homework_ids<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    homework_json <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>homework_ids_response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    homework_dic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> homework_json<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"activities"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">14</span><span class="token punctuation">:</span>
                <span class="token comment"># è¯¾å ‚</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">elif</span> i<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">9</span><span class="token punctuation">:</span>
                <span class="token comment"># å…¬å‘Š</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">elif</span> i<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
                <span class="token comment"># è¯¾ä»¶</span>
                homework_dic<span class="token punctuation">[</span>i<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'courseware_id'</span> <span class="token punctuation">:</span> i<span class="token punctuation">[</span><span class="token string">'courseware_id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                            <span class="token string">'id'</span> <span class="token punctuation">:</span> i<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span>
                                            <span class="token punctuation">}</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>course_name<span class="token operator">+</span><span class="token string">"å…±æœ‰"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>homework_dic<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"ä¸ªä½œä¸šå–”ï¼"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> homework_dic
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"fail while getting homework_ids!!! please re-run this program!"</span><span class="token punctuation">)</span>
        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"fail while getting homework_ids!!! please re-run this program!"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    your_courses <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token comment"># é¦–å…ˆè¦è·å–ç”¨æˆ·çš„ä¸ªäººIDï¼Œå³user_id,è¯¥å€¼åœ¨æŸ¥è¯¢ç”¨æˆ·çš„è§†é¢‘è¿›åº¦æ—¶éœ€è¦ä½¿ç”¨</span>
    user_id_url <span class="token operator">=</span> <span class="token string">"https://changjiang.yuketang.cn/v/course_meta/user_info"</span>

    id_response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>user_id_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    id_response<span class="token punctuation">.</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        user_id <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'"user_id": ([0-9]+),'</span><span class="token punctuation">,</span> id_response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ä¹Ÿè®¸æ˜¯ç½‘è·¯é—®é¢˜ï¼Œè·å–ä¸äº†user_id,è¯·è¯•ç€é‡æ–°è¿è¡Œ"</span><span class="token punctuation">)</span>
        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"ä¹Ÿè®¸æ˜¯ç½‘è·¯é—®é¢˜ï¼Œè·å–ä¸äº†user_id,è¯·è¯•ç€é‡æ–°è¿è¡Œ!!! please re-run this program!"</span><span class="token punctuation">)</span>

    <span class="token comment"># ç„¶åè¦è·å–æ•™å®¤id</span>
    get_classroom_id <span class="token operator">=</span> <span class="token string">"https://changjiang.yuketang.cn/v2/api/web/courses/list?identity=2"</span>
    submit_url <span class="token operator">=</span> <span class="token string">"https://gruestc.yuketang.cn/mooc-api/v1/lms/exercise/problem_apply/?term=latest&amp;uv_id=3194"</span>
    headers<span class="token punctuation">[</span><span class="token string">"referer"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'https://changjiang.yuketang.cn/v2/web/index?date=1666686775760&amp;newWeb=1'</span>
    classroom_id_response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>get_classroom_id<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> ins <span class="token keyword">in</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>classroom_id_response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"list"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            your_courses<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token string">"course_name"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"course"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"classroom_id"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"classroom_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"course_sign"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"university_course_series_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"course_id"</span><span class="token punctuation">:</span> ins<span class="token punctuation">[</span><span class="token string">"course"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"fail while getting classroom_id!!! please re-run this program!"</span><span class="token punctuation">)</span>
        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"fail while getting classroom_id!!! please re-run this program!"</span><span class="token punctuation">)</span>

    <span class="token comment"># æ˜¾ç¤ºç”¨æˆ·æç¤º</span>
    <span class="token keyword">for</span> index<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>your_courses<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¼–å·ï¼š"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">" è¯¾åï¼š"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">[</span><span class="token string">"course_name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    number <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"ä½ æƒ³åˆ·å“ªé—¨è¯¾å‘¢ï¼Ÿè¯·è¾“å…¥ç¼–å·ã€‚è¾“å…¥0è¡¨ç¤ºå…¨éƒ¨è¯¾ç¨‹éƒ½åˆ·ä¸€é\n"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token comment">#0 è¡¨ç¤ºå…¨éƒ¨åˆ·ä¸€é</span>
        <span class="token keyword">for</span> ins <span class="token keyword">in</span> your_courses<span class="token punctuation">:</span>
            homework_dic <span class="token operator">=</span> get_videos_ids<span class="token punctuation">(</span>ins<span class="token punctuation">[</span><span class="token string">"course_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ins<span class="token punctuation">[</span><span class="token string">"classroom_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ins<span class="token punctuation">[</span><span class="token string">"course_sign"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> one_video <span class="token keyword">in</span> homework_dic<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                one_video_watcher<span class="token punctuation">(</span>one_video<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ins<span class="token punctuation">[</span><span class="token string">"course_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>user_id<span class="token punctuation">,</span>ins<span class="token punctuation">[</span><span class="token string">"classroom_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>cards_id<span class="token operator">=</span>homework_dic<span class="token punctuation">[</span>one_video<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment">#æŒ‡å®šåºå·çš„è¯¾ç¨‹åˆ·ä¸€é</span>
        number <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span>
        homework_dic <span class="token operator">=</span> get_videos_ids<span class="token punctuation">(</span>your_courses<span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"course_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>your_courses<span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"classroom_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>your_courses<span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"course_sign"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> one_video <span class="token keyword">in</span> homework_dic<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            one_video_watcher<span class="token punctuation">(</span>one_video<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> your_courses<span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"course_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> your_courses<span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"classroom_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>cards_id <span class="token operator">=</span> one_video<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'courseware_id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre> 
<p>cookieæ›¿æ¢ä¸€ä¸‹<br> <img src="https://images2.imgbox.com/fd/b6/qKDelUws_o.png" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p> 
<h3><a id="_369"></a>æ€»ç»“</h3> 
<pre><code>å¤§ä½“å°±æ˜¯æ’­æ”¾è§†é¢‘ï¼ŒæŠ“åŒ…ï¼Œæ‰¾å‚æ•°ï¼Œåœ¨è¯·æ±‚é‡Œæœç´ ï¼ŒåŠ å¯†äº†å°±ä¸‹æ–­ç‚¹çœ‹å®ç°ã€‚
ï¼ï¼ï¼ä¸»è¦æ˜¯æ€è·¯ï¼Œè¿˜æœ‰ä¸€äº›é›¨è¯¾å ‚ï¼Œå­¦ä¹ é€šï¼Œmoocï¼Œä»€ä¹ˆçš„éƒ½å·®ä¸å¤šçš„ã€‚
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2977e694b10cdfa5319327660a11a080/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">ARCGISä¸­ç›¸åŒæŠ•å½±ä¸é‡åˆæ˜¾ç¤ºé—®é¢˜çš„è§£å†³ï¼ˆæ˜“åº·å¯¼å‡ºåœ°å›¾æŠ•å½±è®¾ç½®é—®é¢˜çš„è§£å†³ï¼‰</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1cc5bc294f69150a1ca2732ab6ae87d7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">javaé‡Œé¢çš„CompletableFutureçš„å¼‚å¸¸å’Œäº‹åŠ¡é—®é¢˜å’ŒAtomicBooleanè§£å†³åŠæ³•</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹é¬¼è°·å­çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>