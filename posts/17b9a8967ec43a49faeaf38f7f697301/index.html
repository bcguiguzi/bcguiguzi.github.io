<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>利用python进行数据分析学习笔记1(pandas入门) - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="利用python进行数据分析学习笔记1(pandas入门)" />
<meta property="og:description" content="pandas引入
import pandas as pd Series和DataFrame用的比较多
from pandas import Series,DataFrame pandas的数据结构介绍
Series
类似一维数组的对象，由一组数据和索引组成。
传入一个列表作为Series的参数创建Seires。
obj = pd.Series([4,7,-5,3]) #创建Series 通过Series的values和index属性获取数据和索引。
obj.values obj.index 创建Series时可以创建索引。
obj2 = pd.Series([1,2,3,4],index=[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;]) 通过索引获取Series中的值。
通过索引修改Series中的值
除了使用索引，还可以使用布尔型数据作为参数选择数据
也可以像numpy中的array一样进行数学运算。
通过字典来创建Series，键作为索引。
sdata = {&#39;a&#39;:1,&#39;b&#39;:2,&#39;c&#39;:3,&#39;d&#39;:4} obj3 = pd.Series(sdata) 传入字典作参数外，还能传入排好序的索引，改变Series的顺序
states = [&#39;d&#39;,&#39;c&#39;,&#39;b&#39;,&#39;a&#39;] obj4 = pd.Series(sdata,index=states) 如果传入的索引中含有字典中没有的键，会显示NaN。
pd的isnull和notnull函数可以检测Series中有无缺失值。
pd.isnull(obj4) pd.notnull(obj4) Series实例也有这种方法。
Series运算时根据索引标签自动对齐数据。
sdata2 = {&#39;a&#39;:5,&#39;b&#39;:6,&#39;c&#39;:7,&#39;d&#39;:8} obj5 = pd.Series(sdata2) #新建一个索引名和obj4相同的数组 obj4 &#43; obj5 #将两个数组相加 Series对象和索引都有name属性
obj4.name = &#39;population&#39; #将Series对象的name属性设置为population obj4.index.name = &#39;state&#39; #将Series对象的索引的name属性设置为state Series的索引通过赋值可以原地修改" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/17b9a8967ec43a49faeaf38f7f697301/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-06-24T15:04:44+08:00" />
<meta property="article:modified_time" content="2018-06-24T15:04:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">利用python进行数据分析学习笔记1(pandas入门)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>pandas引入</p> 
<pre><code class="language-html">import pandas as pd</code></pre> 
<p>Series和DataFrame用的比较多</p> 
<pre><code class="language-html">from pandas import Series,DataFrame</code></pre> 
<p><strong><span style="font-size:18px;">pandas的数据结构介绍</span></strong></p> 
<p><strong>Series</strong></p> 
<p>类似一维数组的对象，由一组数据和索引组成。</p> 
<p>传入一个列表作为Series的参数创建Seires。<br></p> 
<pre><code class="language-html">obj = pd.Series([4,7,-5,3])        #创建Series</code></pre> 
<p><img src="https://images2.imgbox.com/ab/d1/tRLd0e8q_o.png" alt=""><br></p> 
<p>通过Series的values和index属性获取数据和索引。</p> 
<pre><code class="language-html">obj.values
obj.index</code></pre> 
<p><img src="https://images2.imgbox.com/c3/21/jkHNLVRF_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/eb/6c/6QpzorvK_o.png" alt=""><br></p> 
<p>创建Series时可以创建索引。</p> 
<pre><code class="language-html">obj2 = pd.Series([1,2,3,4],index=['a','b','c','d'])</code></pre> 
<p><img src="https://images2.imgbox.com/16/57/QE5Mc2iA_o.png" alt=""></p> 
<p> 通过索引获取Series中的值。</p> 
<p><img src="https://images2.imgbox.com/a6/24/jKFXeVXH_o.png" alt=""><br></p> 
<p>通过索引修改Series中的值</p> 
<p><img src="https://images2.imgbox.com/2e/ee/e73b2cfj_o.png" alt=""><br></p> 
<p>除了使用索引，还可以使用布尔型数据作为参数选择数据</p> 
<p><img src="https://images2.imgbox.com/82/6e/qX484MyT_o.png" alt=""><br></p> 
<p>也可以像numpy中的array一样进行数学运算。</p> 
<p><img src="https://images2.imgbox.com/9d/67/rH0Gxnli_o.png" alt=""><img src="https://images2.imgbox.com/91/b5/ECJEyjlK_o.png" alt=""><br></p> 
<p>通过字典来创建Series，键作为索引。</p> 
<pre><code class="language-html">sdata = {'a':1,'b':2,'c':3,'d':4}
obj3 = pd.Series(sdata)</code></pre> 
<p><img src="https://images2.imgbox.com/12/a2/aHPGFG6H_o.png" alt=""></p> 
<p>传入字典作参数外，还能传入排好序的索引，改变Series的顺序</p> 
<pre><code class="language-html">states = ['d','c','b','a']
obj4 = pd.Series(sdata,index=states)</code></pre> 
<p><img src="https://images2.imgbox.com/18/a1/92qZjXmV_o.png" alt=""></p> 
<p>如果传入的索引中含有字典中没有的键，会显示NaN。</p> 
<p>pd的isnull和notnull函数可以检测Series中有无缺失值。</p> 
<pre><code class="language-html">pd.isnull(obj4)
pd.notnull(obj4)</code></pre> 
<p><img src="https://images2.imgbox.com/45/b0/dp03TftI_o.png" alt=""></p> 
<p>Series实例也有这种方法。</p> 
<p><img src="https://images2.imgbox.com/9b/2e/dFyiugRq_o.png" alt=""><br></p> 
<p>Series运算时根据索引标签自动对齐数据。</p> 
<pre><code class="language-html">sdata2 = {'a':5,'b':6,'c':7,'d':8}    
obj5 = pd.Series(sdata2)    #新建一个索引名和obj4相同的数组
obj4 + obj5    #将两个数组相加</code></pre> 
<p><img src="https://images2.imgbox.com/3a/23/2sREfcdW_o.png" alt=""></p> 
<p>Series对象和索引都有name属性</p> 
<pre><code class="language-html">obj4.name = 'population'    #将Series对象的name属性设置为population
obj4.index.name = 'state'    #将Series对象的索引的name属性设置为state</code></pre> 
<img src="https://images2.imgbox.com/d3/be/YCnpLqWj_o.png" alt=""> 
<br> 
<p>Series的索引通过赋值可以原地修改</p> 
<pre><code class="language-html">obj4.index = ['q','w','e','r']</code></pre> 
<p><img src="https://images2.imgbox.com/27/bf/rnz5WW8o_o.png" alt=""></p> 
<p><br></p> 
<p><strong>DataFrame</strong></p> 
<p>表格型数据结构，含有一组有序的列。</p> 
<p>建DataFrame最常用的方法是传入等长列表或数组组成的字典。</p> 
<pre><code class="language-html">data = {'state': ['Ohio', 'Ohio', 'Ohio', 'Nevada', 'Nevada', 'Nevada'],
        'year': [2000, 2001, 2002, 2001, 2002, 2003],
        'pop': [1.5, 1.7, 3.6, 2.4, 2.9, 3.2]}
frame = pd.DataFrame(data)</code></pre> 
<p><img src="https://images2.imgbox.com/ff/2b/JciSnkcq_o.png" alt=""></p> 
<p>如果DataFrame特别大，通过head方法可以选取前五行。</p> 
<pre><code class="language-html">frame.head()</code></pre> 
<p><img src="https://images2.imgbox.com/ea/58/n6nK4qyf_o.png" alt=""></p> 
<p>创建DataFrame，在数据参数后面加上columns参数，可以根据指定列进行排序。</p> 
<pre><code class="language-html">pd.DataFrame(data,columns=['year','state','pop'])</code></pre> 
<p><img src="https://images2.imgbox.com/20/5c/TpCQRtiZ_o.png" alt=""></p> 
<p>如果传入了不存在的列，会返回缺失值。</p> 
<pre><code class="language-html">pd.DataFrame(data,columns=['year','state','pop','test'])</code></pre> 
<p><img src="https://images2.imgbox.com/d5/cf/iavnZvj0_o.png" alt=""></p> 
<p>和上面的Series一样，传入index参数可以对行索引进行修改。</p> 
<p>通过列名可以获取DataFrame的指定列。</p> 
<pre><code class="language-html">frame['state']
frame.state</code></pre> 
<p><img src="https://images2.imgbox.com/38/87/jcoHpWfT_o.png" alt=""><img src="https://images2.imgbox.com/5b/da/KESKXudS_o.png" alt=""></p> 
<p>使用DataFrame的loc方法，传入行索引，可以获取指定的行数据。</p> 
<pre><code class="language-html">frame2 = pd.DataFrame(data, columns=['year', 'state', 'pop', 'debt'],
                      index=['one', 'two', 'three', 'four',
                             'five', 'six'])</code></pre> 
<pre><code class="language-html">frame2.loc['three']</code></pre> 
<p><img src="https://images2.imgbox.com/87/59/HC5bvFOh_o.png" alt=""><img src="https://images2.imgbox.com/2b/61/bXE2ZsEM_o.png" alt=""></p> 
<p>通过索引选中DataFrame中的指定列，然后赋值，可以修改指定列整列的值</p> 
<pre><code class="language-html">frame2['debt'] = 10</code></pre> 
<img src="https://images2.imgbox.com/2c/8b/D7Go7EM6_o.png" alt=""> 
<br> 
<p>也可以使用loc方法选中指定行修改值。</p> 
<p><img src="https://images2.imgbox.com/84/74/pkQZcOy0_o.png" alt=""><br></p> 
<p>如果右边是个数组或列表等序列，长度要和左边相等，如果是Series，会根据索引自动匹配填充，缺失的会用NaN填充。</p> 
<pre><code class="language-html">val = pd.Series([-1.2, -1.5, -1.7], index=['two', 'four', 'five'])
frame2['debt'] = val        #对debt列进行修改</code></pre> 
<img src="https://images2.imgbox.com/bb/12/rnBf5VGH_o.png" alt=""> 
<br> 
<p>如果左边选择的列不存在，会自动创建一个新列</p> 
<p>del用于删除列</p> 
<pre><code class="language-html">del frame2['debt']</code></pre> 
<p><img src="https://images2.imgbox.com/f6/42/Tbm1BqOa_o.png" alt=""></p> 
<p>通过嵌套字典创建DataFrame</p> 
<pre><code class="language-html">pop = {'Nevada': {2001: 2.4, 2002: 2.9},
       'Ohio': {2000: 1.5, 2001: 1.7, 2002: 3.6}}
frame3 = pd.DataFrame(pop)</code></pre> 
<p>外层的键作为列索引，内层的键作为行索引。</p> 
<p><img src="https://images2.imgbox.com/a6/f1/K0xJt5FU_o.png" alt=""><br></p> 
<p>DataFrame也有类似NumPy的转置方法</p> 
<p><img src="https://images2.imgbox.com/d7/b6/tGzqSpwZ_o.png" alt=""><br></p> 
<p>可以输入给DataFrame构造器的数据</p> 
<p><img src="https://images2.imgbox.com/24/43/iJcNjqVe_o.png" alt=""><br></p> 
<p>可以设置DataFrame的index和columns的name属性。</p> 
<pre><code class="language-html">frame3.index.name = 'year'</code></pre> 
<pre><code class="language-html">frame3.columns.name = 'state'</code></pre> 
<p>DataFrame的values属性会返回所有数据</p> 
<p><img src="https://images2.imgbox.com/4a/30/zfXHR5UZ_o.png" alt=""><br></p> 
<p><strong>索引对象</strong></p> 
<p>创建一个Series并将其索引设置为指定值。</p> 
<p></p> 
<pre><code class="language-html">obj = pd.Series(range(3),index=['a','b','c'])
index = obj.index    #将Series的索引对象赋值给一个变量</code></pre> 
<p><img src="https://images2.imgbox.com/dd/a1/83CcWx9p_o.png" alt=""></p> 
<p>index对象是不可变的，不能对其进行修改，如index[1] = 't'会报错</p> 
<p>pandas的index可以包含重复的标签</p> 
<p><img src="https://images2.imgbox.com/59/ea/pDSiaXvs_o.png" alt=""><br></p> 
<p>index的方法和属性</p> 
<p><img src="https://images2.imgbox.com/24/7a/w96RAQ5v_o.png" alt=""><br></p> 
<p><br></p> 
<p><strong><span style="font-size:18px;">基本功能</span></strong></p> 
<p><strong>重新索引</strong></p> 
<pre><code class="language-html">obj = pd.Series([4.5, 7.2, -5.3, 3.6], index=['d', 'b', 'a', 'c'])    #创建一个Series
obj2 = obj.reindex(['a', 'b', 'c', 'd', 'e'])    #使用Series的reindex方法创建一个新Series</code></pre> 
<p><img src="https://images2.imgbox.com/be/f1/G4La6M9b_o.png" alt=""><img src="https://images2.imgbox.com/81/af/XjJLnBJx_o.png" alt=""></p> 
<p>reindex方法传入method='ffill'参数可以实现前向值填充</p> 
<pre><code class="language-html">obj3 = pd.Series(['blue', 'purple', 'yellow'], index=[0, 2, 4])
obj3.reindex(range(6), method='ffill')</code></pre> 
<p><img src="https://images2.imgbox.com/36/ef/OfegRL94_o.png" alt=""><img src="https://images2.imgbox.com/06/4c/lJDZAy6W_o.png" alt=""></p> 
<p>从3行扩充到6行，多出来的行进行前向填充。</p> 
<p>默认情况下reindex修改的是行索引，明确传入columns参数时会对列索引进行修改。</p> 
<pre><code class="language-html">frame = pd.DataFrame(np.arange(9).reshape((3, 3)),
                     index=['a', 'c', 'd'],
                     columns=['Ohio', 'Texas', 'California'])    #创建一个三行三列的DataFrame
states = ['Texas', 'Utah', 'California']
frame.reindex(columns=states)    #修改列索引，</code></pre> 
<p><img src="https://images2.imgbox.com/21/4b/40zkfu0W_o.png" alt=""><img src="https://images2.imgbox.com/d8/4c/4tXE4shA_o.png" alt=""></p> 
<p>reindex函数的参数</p> 
<p><img src="https://images2.imgbox.com/09/f9/L9oyMDTZ_o.png" alt=""><br></p> 
<p><br></p> 
<p><strong>丢弃指定轴上的项</strong></p> 
<pre><code class="language-html">obj = pd.Series(np.arange(5.), index=['a', 'b', 'c', 'd', 'e'])
new_obj = obj.drop('c')
obj.drop(['d','c'])</code></pre> 
<p>创建一个新Series，通过drop方法可以删除指定索引的数据，drop方法进行的是原地修改。</p> 
<p><img src="https://images2.imgbox.com/21/6b/M3pzPhJG_o.png" alt=""><img src="https://images2.imgbox.com/c2/71/7zrE6E2f_o.png" alt=""><img src="https://images2.imgbox.com/e0/07/8PxB9Eld_o.png" alt=""><br></p> 
<p>DataFrame使用drop会默认删除指定行，如果要删除列需要传入参数axis='columns'或axis=1</p> 
<pre><code class="language-html">data = pd.DataFrame(np.arange(16).reshape((4, 4)),
                    index=['Ohio', 'Colorado', 'Utah', 'New York'],
                    columns=['one', 'two', 'three', 'four'])
data.drop(['Colorado','Ohio'])    #删除指定索引的行
data.drop('two',axis='columns')    #删除指定索引的列</code></pre> 
<p><img src="https://images2.imgbox.com/40/0c/vU629FBB_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/0c/45/1J6GADaB_o.png" alt=""><br></p> 
<p>类似drop这种会修改Series或DataFrame大小或形状的函数，通过传入参数inplace=True可以实现就地修改，要谨慎使用，它会销毁被删除的数据。</p> 
<pre><code class="language-html">obj.drop('c',inplace=True)
</code></pre> 
<p><img src="https://images2.imgbox.com/c8/e1/atgkRgEv_o.png" alt=""></p> 
<p><br></p> 
<p><strong>索引、选取和过滤</strong></p> 
<pre><code class="language-html">obj = pd.Series(np.arange(4.), index=['a', 'b', 'c', 'd'])
obj['b']    #通过标签索引选择数据    
obj[1]    #通过顺序标签索引选择数据
obj[2:4]    #通过顺序标签切片选择数据
obj[obj &lt; 2]    #通过布尔型数组选择数据</code></pre> 
<p><img src="https://images2.imgbox.com/ef/df/bU6kVA9B_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/49/63/JPJjQVVv_o.png" alt=""></p> 
<p>也可以用标签切片来选择数据，不同的是标签切片左右区间都是闭合的。</p> 
<pre><code class="language-html">obj['a':'c']    #数据a、b、c都会被选中</code></pre> 
<p><img src="https://images2.imgbox.com/88/f9/cDTJFPjK_o.png" alt=""></p> 
<p>还能通过切片设置Series指定位置的值</p> 
<pre><code class="language-html">obj['a':'c'] = 10</code></pre> 
<p><img src="https://images2.imgbox.com/a5/71/uIfA9Rz4_o.png" alt=""></p> 
<p>用一个或多个标签可以获取DataFrame中一个或多个列的数据。</p> 
<pre><code class="language-html">data = pd.DataFrame(np.arange(16).reshape((4, 4)),
                    index=['Ohio', 'Colorado', 'Utah', 'New York'],
                    columns=['one', 'two', 'three', 'four'])
data['two']    #获取一个列
data[['three','one']]    #获取两个列</code></pre> 
<p><img src="https://images2.imgbox.com/d5/88/4HYT5NGJ_o.png" alt=""><br></p> 
<p><img src="https://images2.imgbox.com/e5/d0/fdZUiWKf_o.png" alt=""><img src="https://images2.imgbox.com/54/4d/HGQ9q7mF_o.png" alt=""></p> 
<p>通过顺序数字切片或布尔型数组选取数据</p> 
<pre><code class="language-html">data[:2]    #选取前两行数据
data[data['three'] &gt; 5]    #选取列three大于5的数据</code></pre> 
<p><img src="https://images2.imgbox.com/5d/7f/cKgDfJgM_o.png" alt=""><br></p> 
<p>还有一种通过布尔型DataFrame进行索引。</p> 
<p>将DataFrame中小于5的数值改为0。</p> 
<p><img src="https://images2.imgbox.com/42/f3/CVCH67kW_o.png" alt=""><br></p> 
<p><br></p> 
<p><strong>用loc和iloc进行选取</strong></p> 
<p>loc轴标签，iloc整数索引。</p> 
<p>通过loc方法选择指定行标签的行，再通过列标签选择指定列</p> 
<pre><code class="language-html">data.loc['Colorado', ['two', 'three']]    #选择Colorado行的two和three列</code></pre> 
<p><img src="https://images2.imgbox.com/99/f1/OpmMvj12_o.png" alt=""><br></p> 
<p><img src="https://images2.imgbox.com/eb/38/jBMcvkik_o.png" alt=""></p> 
<p>用iloc方法通过顺序数字标签选择指定行列。</p> 
<pre><code class="language-html">data.iloc[2,[3,0,1]]    #选择行2的3、0、1列数据</code></pre> 
<p><img src="https://images2.imgbox.com/f8/15/f8oxn92J_o.png" alt=""></p> 
<p>loc和iloc方法也可以进行切片操作。</p> 
<p>选择第一行到Utah行，列two的数据。</p> 
<pre><code class="language-html">data.loc[:'Utah','two']</code></pre> 
<p><img src="https://images2.imgbox.com/e2/a9/ruFpUt08_o.png" alt=""></p> 
<pre><code class="language-html">data.iloc[:,:3][data.three &gt; 5]</code></pre> 
<p>选择所有行前三列的数据，筛选出列three大于5的数据</p> 
<p><img src="https://images2.imgbox.com/8f/41/2drH82Oe_o.png" alt=""><br></p> 
<p><img src="https://images2.imgbox.com/6f/7d/TpPyb9ql_o.png" alt=""><br></p> 
<p><br></p> 
<p><strong>整数索引</strong></p> 
<p>如果Series中的索引是整数，那么选取数据时使用的是标签索引</p> 
<pre><code class="language-html">ser = pd.Series(np.arange(3.))</code></pre> 
<p>创建了一个Series，索引是默认的，此时如果想取最后一个数据，使用ser[-1]会报错，因为使用的是标签索引，不存在-1的标签。</p> 
<p><img src="https://images2.imgbox.com/10/f2/YvXdCUjv_o.png" alt=""><br></p> 
<p>若创建Series时使用非整数索引，则选择数据时使用的是顺序数据索引。</p> 
<pre><code class="language-html">ser2 = pd.Series(np.arange(3.), index=['a', 'b', 'c'])</code></pre> 
<p><img src="https://images2.imgbox.com/36/89/vGzYbaOR_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/fe/15/bsVS9HsC_o.png" alt=""><br></p> 
<p><br></p> 
<p><strong>算术运算和数据对齐</strong></p> 
<p>创建两个含有重叠行列索引的Series</p> 
<pre><code class="language-html">s1 = pd.Series([7.3, -2.5, 3.4, 1.5], index=['a', 'c', 'd', 'e'])
s2 = pd.Series([-2.1, 3.6, -1.5, 4, 3.1],index=['a', 'c', 'e', 'f', 'g'])</code></pre> 
<p>两个相加，只有行列索引相同的部分会相加，其他显示为NaN。</p> 
<p><img src="https://images2.imgbox.com/35/dc/ZYIcRoTQ_o.png" alt=""><img src="https://images2.imgbox.com/c4/c2/7H6S9XP3_o.png" alt=""><img src="https://images2.imgbox.com/45/e0/Q59xLIrD_o.png" alt=""><br></p> 
<p>DataFrame类似。</p> 
<p><br></p> 
<p><strong>在算术方法中填充值</strong></p> 
<pre><code class="language-html">df1 = pd.DataFrame(np.arange(12.).reshape((3, 4)),
                   columns=list('abcd'))
df2 = pd.DataFrame(np.arange(20.).reshape((4, 5)),
                   columns=list('abcde'))
df2.loc[1,'b'] = np.nan</code></pre> 
<p>创建两个DataFrame，并将df2的行1，列b的值设为NaN。</p> 
<p><img src="https://images2.imgbox.com/4a/a6/6q5e1j5s_o.png" alt=""><img src="https://images2.imgbox.com/ee/30/I3zQRYOz_o.png" alt=""><br></p> 
<p>两个DataFrame相加，行列索引不一致的位置会显示为NaN。</p> 
<p><img src="https://images2.imgbox.com/a9/7f/p5mqgHIo_o.png" alt=""><br></p> 
<p>df1可以通过add方法和df2相加，传入fill_value=0参数，行列索引不一致的位置也会显示。</p> 
<p><img src="https://images2.imgbox.com/5e/2d/FCEHEKnC_o.png" alt=""><br></p> 
<p><img src="https://images2.imgbox.com/1f/d3/agJyou7Y_o.png" alt=""><br></p> 
<p>r开头的表示翻转函数，如df1.div(df2)表示用df1中的值除df2的值，df1.rdiv(df2)则表示用df2中的值除df1的值。</p> 
<p>fill_value参数是指定填充值，上面的算术方法都可以使用。</p> 
<p><br></p> 
<p><strong>DataFrame和Series之间的运算</strong></p> 
<pre><code class="language-html">arr = np.arange(12.).reshape((3, 4))
arr1 = arr[0]
arr - arr1</code></pre> 
<p><img src="https://images2.imgbox.com/5f/17/MdAqaZ83_o.png" alt=""><br></p> 
<p>创建一个三行四列的二维数组和一个一行四列的一维数组并相减</p> 
<p><img src="https://images2.imgbox.com/97/aa/4OZj0dA5_o.png" alt=""><br></p> 
<p>得到的结果是二维数组的每行减相同的一维数组，这称为广播。</p> 
<p>DataFrame和Series相减的结果和上面的差不多。</p> 
<p>创建一个DataFrame和Series</p> 
<pre><code class="language-html">frame = pd.DataFrame(np.arange(12.).reshape((4, 3)),
                     columns=list('bde'),
                     index=['Utah', 'Ohio', 'Texas', 'Oregon'])
series = frame.iloc[0]</code></pre> 
<p><img src="https://images2.imgbox.com/c1/3e/WwedwSxD_o.png" alt=""></p> 
<p>将二者相减，默认是DataFrame的每行减去一个相同的Series。</p> 
<p><img src="https://images2.imgbox.com/26/d9/SjOAGD99_o.png" alt=""><br></p> 
<p>如果Series中存在和DataFrame中不一致的列名，不一致的列会全部显示为NaN。</p> 
<pre><code class="language-html">series2 = pd.Series(range(3), index=['b', 'e', 'f'])</code></pre> 
<p><img src="https://images2.imgbox.com/98/30/5GJA23mV_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/42/6e/gnLBmFDI_o.png" alt=""><br></p> 
<p>若希望在列上进行广播，则使用算数方法并加入axis参数。</p> 
<pre><code class="language-html">series3 = frame['d']
frame.sub(series3,axis='index')</code></pre> 
<p><img src="https://images2.imgbox.com/ed/55/nt0Kydar_o.png" alt=""></p> 
<p>这里DataFrame的每列都减去一个相同的Series。</p> 
<p><br></p> 
<p><strong>函数应用和映射</strong></p> 
<p>NumPy的通用函数(元素级)可以用于操作pandas对象</p> 
<pre><code class="language-html">frame = pd.DataFrame(np.random.randn(4, 3), columns=list('bde'),
                     index=['Utah', 'Ohio', 'Texas', 'Oregon'])
np.abs(frame)</code></pre> 
<p>创建一个DataFrame，通过abs函数可以对DataFrame中的每个数据进行绝对值处理。</p> 
<p><img src="https://images2.imgbox.com/65/0d/rNw40qe7_o.png" alt=""><br></p> 
<p>另一种方法是建立一个函数，通过DataFrame的apply方法应用到DataFrame中。</p> 
<pre><code class="language-html">f = lambda x:x.max() - x.min()    #求极差
frame.apply(f)</code></pre> 
<p><img src="https://images2.imgbox.com/84/fb/3qTyH4TM_o.png" alt=""></p> 
<p>默认是对每列执行，若传入axis='columns'参数则对每行执行。</p> 
<p><img src="https://images2.imgbox.com/0d/2f/DhbVkLJW_o.png" alt=""><br></p> 
<p>传入的函数除了返回一个值，也可以返回多个值组成的Series。</p> 
<pre><code class="language-html">def f(x):
    return pd.Series([x.min(),x.max()],index=['min','max'])
frame.apply(f)</code></pre> 
<p><img src="https://images2.imgbox.com/9f/2c/we9Ae5SQ_o.png" alt=""></p> 
<p>元素级的函数也可以用，作用于DataFrame中的每个元素，不过调用的是applymap函数。</p> 
<pre><code class="language-html">format = lambda x: '%.2f' %x
frame.applymap(format)</code></pre> 
<img src="https://images2.imgbox.com/1f/54/MWrflb55_o.png" alt=""> 
<br> 
<p>Series中应用于元素级函数的是map方法</p> 
<p><img src="https://images2.imgbox.com/1c/78/bAhzXxnO_o.png" alt=""><br></p> 
<p><br></p> 
<p><strong>排序和排名</strong></p> 
<p>Series有一个sort_index函数是用来排序的。</p> 
<pre><code class="language-html">obj = pd.Series(range(4), index=['d', 'a', 'b', 'c'])
obj.sort_index()</code></pre> 
<p><img src="https://images2.imgbox.com/51/74/XcECKJeX_o.png" alt=""><img src="https://images2.imgbox.com/80/78/AmVkCYvW_o.png" alt=""></p> 
<p>DataFrame中也有这个方法，默认对行索引排序，传入axis参数可以对列排序。</p> 
<pre><code class="language-html">frame = pd.DataFrame(np.arange(8).reshape((2, 4)),
                     index=['three', 'one'],
                     columns=['d', 'a', 'b', 'c'])
frame.sort_index()    #默认对行索引进行排序
frame.sort_index(axis='columns')    #传入axis参数后对列索引进行排序</code></pre> 
<p><img src="https://images2.imgbox.com/fb/5b/t62TK5Eg_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/b2/a2/JJDzNzhv_o.png" alt=""><br></p> 
<p>默认是升序排序，传入ascending=False参数可以实现降序排序。</p> 
<pre><code class="language-html">frame.sort_index(axis='columns',ascending=False)</code></pre> 
<p><img src="https://images2.imgbox.com/34/5e/XfTNpL0c_o.png" alt=""></p> 
<p>按数据对Series进行排序，使用sort_values方法</p> 
<pre><code class="language-html">obj = pd.Series([4,7,-3,2])
obj.sort_values()</code></pre> 
<p><img src="https://images2.imgbox.com/e8/ef/T9iuMPyK_o.png" alt=""></p> 
<p>默认升序排序</p> 
<p>对DataFrame的数据进行排序，需要传入by参数，说明按哪一列的数据进行排序。</p> 
<p><img src="https://images2.imgbox.com/fb/66/P565gXSf_o.png" alt=""><br></p> 
<p>按行one的数据进行降序排序。</p> 
<p>排序时，缺失值默认放到末尾。</p> 
<pre><code class="language-html">obj = pd.Series([4, np.nan, 7, np.nan, -3, 2])
obj.sort_values()</code></pre> 
<p><img src="https://images2.imgbox.com/fa/3d/tEP7lc1g_o.png" alt=""></p> 
<p>DataFrame若要根据多个索引进行排序，传入列表即可。</p> 
<p><img src="https://images2.imgbox.com/3e/94/clMXNLo1_o.png" alt=""><br></p> 
<p>Series和DataFrame的rank方法，为各组分配一个平均排名。</p> 
<pre><code class="language-html">obj = pd.Series([7, -5, 7, 4, 2, 0, 4])
obj.rank()</code></pre> 
<p><img src="https://images2.imgbox.com/58/02/S2EaM0Dr_o.png" alt=""><img src="https://images2.imgbox.com/4d/9a/AKcaQ7DC_o.png" alt=""></p> 
<p>返回的结果是数据在Series中的升序排名。</p> 
<p>创建一个Series，其中有两个元素7，按升序排序这两个元素排在6、7位，平均值是6.5。</p> 
<p>传入参数method='first'，如果有相同值，则按值出现的顺序排序。</p> 
<p><img src="https://images2.imgbox.com/d2/9e/0isOJmaN_o.png" alt=""><br></p> 
<p>若传入method='max'参数，则有相同数据时会选择最大的顺序。</p> 
<p>有两个7，排序为6、7，结果两个都会显示为7。</p> 
<p><img src="https://images2.imgbox.com/e9/20/ZQ50yV1d_o.png" alt=""><br></p> 
<p>传入参数ascending=False可以降序排序。</p> 
<p>如果是DataFrame，默认情况下是对列进行排序，传入参数axis='columns'则对行进行排序。</p> 
<p>method方法可以设置的值：</p> 
<p>average，默认的取相同数据的平均值排名</p> 
<p>min，取最小排名</p> 
<p>max，取最大排名</p> 
<p>first，相同元素按出现顺序排序</p> 
<p>dense，类似min，但排名总是在组间增加1，而不是族中相同的元素数。</p> 
<p><img src="https://images2.imgbox.com/75/aa/4UWhZhQw_o.png" alt=""><img src="https://images2.imgbox.com/ec/a7/G2GsMofT_o.png" alt=""><br></p> 
<p><br></p> 
<p><strong>带有重复标签的轴索引</strong></p> 
<pre><code class="language-html">obj = pd.Series(range(5), index=['a', 'a', 'b', 'b', 'c'])
obj.index.is_unique</code></pre> 
<p>创建带重复索引的Series，通过is_unique属性可以判断index是否唯一。</p> 
<p><img src="https://images2.imgbox.com/ea/7e/TkyGW56J_o.png" alt=""><br></p> 
<p>使用重复索引获取数据，返回多个结果。</p> 
<p><img src="https://images2.imgbox.com/0d/3c/yv5NGTvX_o.png" alt=""><br></p> 
<p>DataFrame中也有类似情况，创建一个含重复行索引</p> 
<pre><code class="language-html">df = pd.DataFrame(np.random.randn(4, 3), index=['a', 'a', 'b', 'b'])
df.loc['b']</code></pre> 
<p><img src="https://images2.imgbox.com/ee/d7/FBlAioGP_o.png" alt=""><br></p> 
<p><img src="https://images2.imgbox.com/8b/0d/win9win0_o.png" alt=""></p> 
<p><br></p> 
<p><strong><span style="font-size:18px;">汇总和计算描述统计</span></strong></p> 
<pre><code class="language-html">df = pd.DataFrame([[1.4, np.nan], [7.1, -4.5],
                  [np.nan, np.nan], [0.75, -1.3]],
                  index=['a', 'b', 'c', 'd'],
                  columns=['one', 'two'])
df.sum()</code></pre> 
<p>创建一个DataFrame，使用sum()函数统计每列的总和，返回一个Series</p> 
<p><img src="https://images2.imgbox.com/cd/00/kR31Bh6n_o.png" alt=""><img src="https://images2.imgbox.com/81/61/KxIQkTpx_o.png" alt=""><br></p> 
<p>传入axis='columns'则会对行进行求和。</p> 
<p><img src="https://images2.imgbox.com/d8/59/j4uHSifz_o.png" alt=""><br></p> 
<p>NA值会被自动排除，通过skipna选项可以进行设置。</p> 
<p><img src="https://images2.imgbox.com/0b/b8/d8xLd2TZ_o.png" alt=""><br></p> 
<p>常用参数</p> 
<p>axis，轴选择</p> 
<p>skipna，排除缺失值，默认是True</p> 
<p>level，如果轴是层次化索引的，根据level分组。</p> 
<p>有些方法返回的是间接统计，如idxmax()方法寻找列中最大值的行。</p> 
<p><img src="https://images2.imgbox.com/af/34/D0DHsCiG_o.png" alt=""><br></p> 
<p>列one中b行的数值最大，列two中d行的数值最大。</p> 
<p>另一种方法是累积性的，如cumsum()是累积求和函数</p> 
<p><img src="https://images2.imgbox.com/3c/70/56Ou9fYN_o.png" alt=""><br></p> 
<p>对列one、two进行累积求和。</p> 
<p>describe()函数一次性产生多个汇总统计</p> 
<p><img src="https://images2.imgbox.com/82/d8/aV1ANqFv_o.png" alt=""><br></p> 
<p>非数值型数据也能使用describe()</p> 
<pre><code class="language-html">obj = pd.Series(['a', 'a', 'b', 'c'] * 4)
obj.describe()</code></pre> 
<p><img src="https://images2.imgbox.com/f2/2e/87AWaksb_o.png" alt=""></p> 
<p>描述统计常用方法</p> 
<p>count，计算非NA值的数量。</p> 
<p>describe，对列进行汇总统计。</p> 
<p>min、max，计算最小最大值。</p> 
<p>argmin、argmax，计算能获取到最小值和最大值的索引位置(整数)</p> 
<p>idxmin、idxmax，计算能获取到最小值和最大值的索引标签。</p> 
<p>quantile，计算样本的分位数(0到1)</p> 
<p>sum，求和</p> 
<p>mean，平均数</p> 
<p>median，计算中位数</p> 
<p>mad，根据平均值计算平均绝对离差</p> 
<p>var，计算样本方差</p> 
<p>std，计算样本标准差</p> 
<p>skew，计算样本值的偏度(三阶矩)</p> 
<p>kurt，计算样本值的风度(四阶矩)</p> 
<p>cumsum，累计和</p> 
<p>cummin、cummax，样本值的累计最大值和累计最小值</p> 
<p>cumprod，累计积</p> 
<p>diff，计算一阶差分</p> 
<p>pct_change，计算百分数变化</p> 
<p><br></p> 
<p><strong>相关系数和协方差</strong></p> 
<pre><code class="language-html">df = pd.DataFrame({'A':np.random.randint(1, 100, 10),
		   'B':np.random.randint(1, 100, 10),
		   'C':np.random.randint(1, 100, 10)})
df.corr()</code></pre> 
<p>创建一个DataFrame，每列的数据都是从1~100中随机取10个组成的，然后对每两列间进行相关系数计算。</p> 
<p><img src="https://images2.imgbox.com/9f/66/ZurWZNS4_o.png" alt=""><br></p> 
<p>若要对指定列进行相关性计算。</p> 
<p><img src="https://images2.imgbox.com/90/ed/zJmuRHOW_o.png" alt=""><br></p> 
<p>cov方法是计算协方差</p> 
<p><img src="https://images2.imgbox.com/f6/51/wT2TsDJF_o.png" alt=""><br></p> 
<p>corrwith计算指定列的相关性。</p> 
<p><img src="https://images2.imgbox.com/c8/0e/bHiAkgvj_o.png" alt=""><br></p> 
<p>三列每列对A进行相关性计算。</p> 
<p><br></p> 
<p><strong>唯一值、值计数及成员资格</strong></p> 
<p>创建一个包含重复值的Series，通过unique函数可以除去重复值，返回唯一值的数组。</p> 
<p></p> 
<pre><code class="language-html">obj = pd.Series(['c', 'a', 'd', 'a', 'a', 'b', 'b', 'c', 'c'])
uniques = obj.unique()</code></pre> 
<p><img src="https://images2.imgbox.com/14/8f/Encj5GJ7_o.png" alt=""><br></p> 
<p>再使用sort()方法可以对结果进行排序。</p> 
<p><img src="https://images2.imgbox.com/20/4f/KQBoCS7R_o.png" alt=""><br></p> 
<p>value_counts用于统计各值出现的频率，结果是降序排序的，可以关闭排序功能。</p> 
<p><img src="https://images2.imgbox.com/98/e4/w37Z9sd7_o.png" alt=""><img src="https://images2.imgbox.com/4d/46/exXwlVWL_o.png" alt=""><br></p> 
<p>Series和DataFrame的isin方法可以判断Series和DataFrame中是否存在指定元素，返回一个布尔型数组。</p> 
<p><img src="https://images2.imgbox.com/54/f7/qZhkS9lV_o.png" alt=""><br></p> 
<p>将布尔型数组作为索引参数可以筛选数据。</p> 
<p><img src="https://images2.imgbox.com/10/9a/rNzvSV6s_o.png" alt=""><br></p> 
<p>还有一个Index.get_indexer方法，提供一个索引数组。</p> 
<pre><code class="language-html">to_match = pd.Series(['c', 'a', 'b', 'b', 'c', 'a'])
unique_vals = pd.Series(['c', 'b', 'a'])
pd.Index(unique_vals).get_indexer(to_match)</code></pre> 
<p><img src="https://images2.imgbox.com/54/21/OtmcGTf8_o.png" alt=""></p> 
<p>第一个元素c在索引数组的位置0上，第二个元素a在索引数组的位置2上。</p> 
<p><img src="https://images2.imgbox.com/53/87/8N8cJBvw_o.png" alt=""><br></p> 
<pre><code class="language-html">data = pd.DataFrame({'Qu1': [1, 3, 4, 3, 4],
                     'Qu2': [2, 3, 1, 2, 3],
                     'Qu3': [1, 5, 2, 4, 4]})
result = data.apply(pd.value_counts).fillna(0)</code></pre> 
<p>创建一个DataFrame，通过apply(pd.value_counts)，将数据中的唯一值作为行标签，数据区域显示的是行标签对应的数值在列中出现的次数。</p> 
<p><img src="https://images2.imgbox.com/ea/a0/dnarV8J3_o.png" alt=""><img src="https://images2.imgbox.com/39/29/i3aLLhxg_o.png" alt=""><br></p> 
<p>如result的第一行行标签是1，在Qu1列中数值1出现了1次，第二行的行标签是2，在Qu1列中数值2出现了0次，所以显示为0。</p> 
<p><br></p> 
<p>此学习笔记主要内容出自https://www.jianshu.com/p/161364dd0acf</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6ee6bf904f8be7acb04c487569314cb8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">王佩丰数据透视表（六到十一讲）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2262d48ce615667a164427a8fe968fd3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux 使用Anaconda安装opencv</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>