<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>802.11抓包软件对比之Microsoft Network Monitor - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="802.11抓包软件对比之Microsoft Network Monitor" />
<meta property="og:description" content="从事WiFi嵌入式软件开发的同学，802.11协议层抓包分析是一个需要熟练掌握的一个技能，需要通过分析WiFi底层802.11协议层的数据包来定位问题。同时从学习802.11协议的角度而言，最有效的学习方法就是通过抓包来学习，从抓到的数据包中，可以验证之前理论学习部分的知识，通过对数据包的理解，不仅可以加深对802.11协议的理解，还能提高自己在实际使用中问题分析、解决能力。
由于要抓到802.11协议层的数据包需要无线网络进入混杂模式，在不同的操作系统下需要不同的软硬件配合才能实现，本文分3部分依次介绍：
Windows下Microsoft Network MonitorWindows下OmnipeekUbuntu下Wireshark
在不同操作系统下实现802.11数据包捕获分析。 Microsoft Network Monitor 嵌入式开发工程师开发环境通用使用Windows，由于Windows下很多专业的抓包工具都需要特定的无线网卡和驱动支持才可实现混杂模式802.11数据捕获。在某些场景下，这些专业的抓包工具不一定会随身携带。所以先介绍一个Windows下Microsoft官方提供的轻量型的抓包工具Microsoft Network Monitor。
Microsoft Network Monitor是Microsoft官方提供的一款免费网络协议数据分析工具，不仅可以抓包，而且可以基于抓包结果做一些简单的数据分析。Microsoft Network Monitor当前最新版本为3.4，同时支持32位和64位系统，可在Microsoft官方免费下载，下载地址为：https://www.microsoft.com/en-us/download/details.aspx?id=4865。我使用的系统是Win10_64位系统，电脑自带的网卡驱动不支持混杂模式，测试发现外接了360USBWiFi可实现混杂模式。
软件安装过程较简单，没有需要特别注意的地方。需要注意的是，安装完成后需要重新启动一下电脑，否则软件可能无法正确显示当前网络列表。
以管理员身份运行Microsoft Network Monitor 3.4，在“Select Networks”中会正确显示当前全部网卡，可以通过Friendly Name和Description找到我们要抓包的网卡。
一、普通模式 Microsoft Network Monitor 默认是“Local Mode”，该模式下软件只能捕获当前选中的网卡收发的数据，是无法捕获到没有经过该网卡的数据的。
选中网卡后，点击“New Capture”，在弹出的页面中选中“Start”即可开始抓包。
可点击“Pause”暂停当前抓包；点击“Stop”停止当前抓包，“Stop”之后再次“Start”将清除当前已捕获到的数据。
在“Frame Summary”框内可发现软件支持捕获到WiFi管理帧、TCP、UDP等数据包，同时软件还可显示“Process Name”、“Source”、“Destination”等网络信息。
分析以上数据，我们可以发现，当前抓到的数据都是当前网卡收发的数据，即使802.11管理帧，也是当前网卡发给路由器的。
二、混杂模式 我们在WiFi开发过程中定位问题通常需要通过无线网卡，捕获路由器与其他WiFi设备之间通讯的数据，普通模式下软件并没有捕获到。Microsoft Network Monitor支持无线网卡进入“Monitor Mode”，该模式即为混杂模式，此时可捕获路由器与其他WiFi设备之间的通讯数据包。
点击“Capture Settings”进入设置页面，可以看到当前选中的无线网卡- 双击需要设置“Monitor Mode”的无线网卡，点击“Scanning Options”
在“WiFi Scanning Options”页面中，选中“Switch to Monitor Mode”，然后继续选择信道扫描模式，软件支持2种信道切换模式，固定信道和信道扫描的模式。在信道扫描模式下，每一个信道逗留一会，按照时间片顺序，一个个信道开始抓包，这里需要根据实际需要设置。
设置完成后，点击“Apply”，并且需要保持该页面为开启状态不能关闭，否则无线网卡自动退出“Monitor Mode”。返回主界面，再次点击“Start”开始“Monitor Mode”下捕获
从“Frame Summary”可以看到捕获到了各种802.11管理帧，同时捕获到了很多“Source”和“Destination”不一样的数据包。选择需要具体分析的数据包，可在“Frame Details”和“Hex Details”中查看详细数据包数据点击“File”下面选择“Save As”，可将当前捕获数据保存为“.cap”，可供“wireshark”、“Omnipeek”等工具分析。 三、总结 从实际使用中发现，Microsoft Network Monitor功能无法与“wireshark”、“Omnipeek”等专业抓包软件相媲美，但是能满足日常基本的802.11数据包捕获、802.11协议学习。上手快，受限也较少，更多功能也需要在使用在不断发掘。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/f3d4c377e577bef58d4a0608eab46a09/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-25T18:58:50+08:00" />
<meta property="article:modified_time" content="2020-11-25T18:58:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">802.11抓包软件对比之Microsoft Network Monitor</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>从事WiFi嵌入式软件开发的同学，802.11协议层抓包分析是一个需要熟练掌握的一个技能，需要通过分析WiFi底层802.11协议层的数据包来定位问题。同时从学习802.11协议的角度而言，最有效的学习方法就是通过抓包来学习，从抓到的数据包中，可以验证之前理论学习部分的知识，通过对数据包的理解，不仅可以加深对802.11协议的理解，还能提高自己在实际使用中问题分析、解决能力。</p> 
<p>由于要抓到802.11协议层的数据包需要无线网络进入混杂模式，在不同的操作系统下需要不同的软硬件配合才能实现，本文分3部分依次介绍：</p> 
<ol><li>Windows下Microsoft Network Monitor</li><li>Windows下Omnipeek</li><li>Ubuntu下Wireshark<br> 在不同操作系统下实现802.11数据包捕获分析。</li></ol> 
<h3><a id="Microsoft_Network_Monitor_9"></a>Microsoft Network Monitor</h3> 
<p>嵌入式开发工程师开发环境通用使用Windows，由于Windows下很多专业的抓包工具都需要特定的无线网卡和驱动支持才可实现混杂模式802.11数据捕获。在某些场景下，这些专业的抓包工具不一定会随身携带。所以先介绍一个Windows下Microsoft官方提供的轻量型的抓包工具Microsoft Network Monitor。<img src="https://images2.imgbox.com/1f/c5/9Ww3fnul_o.png" alt="在这里插入图片描述"><br> Microsoft Network Monitor是Microsoft官方提供的一款免费网络协议数据分析工具，不仅可以抓包，而且可以基于抓包结果做一些简单的数据分析。Microsoft Network Monitor当前最新版本为3.4，同时支持32位和64位系统，可在Microsoft官方免费下载，下载地址为：<a href="https://www.microsoft.com/en-us/download/details.aspx?id=4865" rel="nofollow">https://www.microsoft.com/en-us/download/details.aspx?id=4865</a>。我使用的系统是Win10_64位系统，电脑自带的网卡驱动不支持混杂模式，测试发现外接了360USBWiFi可实现混杂模式。<br> <img src="https://images2.imgbox.com/c9/f9/GohwCUVG_o.png" alt="在这里插入图片描述"><br> 软件安装过程较简单，没有需要特别注意的地方。需要注意的是，安装完成后需要重新启动一下电脑，否则软件可能无法正确显示当前网络列表。</p> 
<p>以管理员身份运行Microsoft Network Monitor 3.4，在“Select Networks”中会正确显示当前全部网卡，可以通过Friendly Name和Description找到我们要抓包的网卡。<br> <img src="https://images2.imgbox.com/b0/7c/Fjj10IrN_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_17"></a>一、普通模式</h4> 
<p>Microsoft Network Monitor 默认是“Local Mode”，该模式下软件只能捕获当前选中的网卡收发的数据，是无法捕获到没有经过该网卡的数据的。</p> 
<ul><li>选中网卡后，点击“New Capture”，在弹出的页面中选中“Start”即可开始抓包。<br> <img src="https://images2.imgbox.com/e4/83/hIvOkiaA_o.png" alt="在这里插入图片描述"></li><li>可点击“Pause”暂停当前抓包；点击“Stop”停止当前抓包，“Stop”之后再次“Start”将清除当前已捕获到的数据。<br> <img src="https://images2.imgbox.com/a1/a8/HnDusxrK_o.png" alt="在这里插入图片描述"></li><li>在“Frame Summary”框内可发现软件支持捕获到WiFi管理帧、TCP、UDP等数据包，同时软件还可显示“Process Name”、“Source”、“Destination”等网络信息。<br> <img src="https://images2.imgbox.com/6e/c4/PEDMrYZj_o.png" alt="在这里插入图片描述"></li><li>分析以上数据，我们可以发现，当前抓到的数据都是当前网卡收发的数据，即使802.11管理帧，也是当前网卡发给路由器的。<br> <img src="https://images2.imgbox.com/6d/25/Xo1hUnSX_o.png" alt="在这里插入图片描述"></li></ul> 
<h4><a id="_28"></a>二、混杂模式</h4> 
<p>我们在WiFi开发过程中定位问题通常需要通过无线网卡，捕获路由器与其他WiFi设备之间通讯的数据，普通模式下软件并没有捕获到。Microsoft Network Monitor支持无线网卡进入“Monitor Mode”，该模式即为混杂模式，此时可捕获路由器与其他WiFi设备之间的通讯数据包。</p> 
<ul><li>点击“Capture Settings”进入设置页面，可以看到当前选中的无线网卡<img src="https://images2.imgbox.com/8f/4a/v6zIRukb_o.png" alt="在这里插入图片描述">- 双击需要设置“Monitor Mode”的无线网卡，点击“Scanning Options”<br> <img src="https://images2.imgbox.com/cf/40/1huWamCQ_o.png" alt="在这里插入图片描述"></li><li>在“WiFi Scanning Options”页面中，选中“Switch to Monitor Mode”，然后继续选择信道扫描模式，软件支持2种信道切换模式，固定信道和信道扫描的模式。在信道扫描模式下，每一个信道逗留一会，按照时间片顺序，一个个信道开始抓包，这里需要根据实际需要设置。<br> <img src="https://images2.imgbox.com/55/61/gzQXhVI0_o.png" alt="在这里插入图片描述"></li><li>设置完成后，点击“Apply”，并且需要保持该页面为开启状态不能关闭，否则无线网卡自动退出“Monitor Mode”。<img src="https://images2.imgbox.com/ba/61/kayuTR3q_o.png" alt="在这里插入图片描述"></li><li>返回主界面，再次点击“Start”开始“Monitor Mode”下捕获<br> <img src="https://images2.imgbox.com/ce/d0/VEJLdm0v_o.png" alt="在这里插入图片描述"></li><li>从“Frame Summary”可以看到捕获到了各种802.11管理帧，同时捕获到了很多“Source”和“Destination”不一样的数据包。<img src="https://images2.imgbox.com/9d/34/zsB2XaIV_o.png" alt="在这里插入图片描述"></li><li>选择需要具体分析的数据包，可在“Frame Details”和“Hex Details”中查看详细数据包数据<img src="https://images2.imgbox.com/dc/d7/jVr2gvSZ_o.png" alt="在这里插入图片描述"></li><li>点击“File”下面选择“Save As”，可将当前捕获数据保存为“.cap”，可供“wireshark”、“Omnipeek”等工具分析。</li></ul> 
<h4><a id="_40"></a>三、总结</h4> 
<p>从实际使用中发现，Microsoft Network Monitor功能无法与“wireshark”、“Omnipeek”等专业抓包软件相媲美，但是能满足日常基本的802.11数据包捕获、802.11协议学习。上手快，受限也较少，更多功能也需要在使用在不断发掘。</p> 
<div> 
 <div></div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4a6472230a9bb616b8ef1f02d7b3e497/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">tomcat10 带来的报错：jakarta.servlet.ServletException: 类com.kang.servlet.HelloServlet不是Servlet</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4ec5cd526158c111c405f7531d02c3bc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vscode 使用phpstudy 和 PHP XDebug 无法运行及调试</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>