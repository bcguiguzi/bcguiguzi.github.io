<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MS SQL Server怎样在CMD命令行模式下工作：执行select，insert等等 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MS SQL Server怎样在CMD命令行模式下工作：执行select，insert等等" />
<meta property="og:description" content="使用：OSQL.EXE和SQLCMD.EXE工具：他们都在 SQL server2008在C:\Program Files\Microsoft SQL Server\100\Tools\Binn，有的可能在C:\Program Files\Microsoft SQL Server\90\Tools\Binn，你自己找找。
然后看看PATH路径中有没有path=C:\Program Files\Microsoft SQL Server\100\Tools\Binn默认你安装了MS server就会有。
如果是sql2000的话.那么就用osql连接,如以下例子,osql -S Localhost -U sa -P 123 注意大小写 &#34;select count(*) from sysobjects&#34; 如果在sql2005及以上版本下，把上面脚本的OSQL改为sqlcmd是可以运行的。 我使用2008使用OSQL会出现，用SQLCMD代替的提示:
-----使用工具OSQL:
C:\Users\Administrator&gt;osql -? //查看osql用法
C:\Users\Administrator&gt;osql -S ZLQ-PC -U sa -P 123 ?
Microsoft (R) SQL Server Command Line Tool
Version 10.0.1600.22 NT INTEL X86
Copyright (c) Microsoft Corporation. All rights reserved.
Note: osql does not support all features of SQL Server 2008." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/aae1e59a1d9267cc3ccaa9d287dd6e17/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-09-21T10:13:36+08:00" />
<meta property="article:modified_time" content="2012-09-21T10:13:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MS SQL Server怎样在CMD命令行模式下工作：执行select，insert等等</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre id="best-answer-content" class="reply-text mb10">使用：OSQL.EXE和SQLCMD.EXE工具：他们都在
SQL server2008在C:\Program Files\Microsoft SQL Server\100\Tools\Binn，有的可能在<pre id="best-answer-content" class="reply-text mb10">C:\Program Files\Microsoft SQL Server\90\Tools\Binn，你自己找找。</pre><br>然后看看PATH路径中有没有path=<pre id="best-answer-content" class="reply-text mb10">C:\Program Files\Microsoft SQL Server\100\Tools\Binn</pre>默认你安装了MS server就会有。<br>如果是sql2000的话.那么就用osql连接,如以下例子,<span style="color:#FF0000">osql -S Localhost -U sa   -P 123 注意大小写</span>      "select count(*) from sysobjects" 如果在sql2005及以上版本下，把上面脚本的OSQL改为sqlcmd是可以运行的。</pre> 
<p>我使用2008使用OSQL会出现，用SQLCMD代替的提示:</p> 
<h2><span style="color:#FF0000">-----使用工具OSQL:</span><br> </h2> 
<p><span style="color:#FF0000">C:\Users\Administrator&gt;osql -? //查看osql用法</span><br> C:\Users\Administrator&gt;osql -S ZLQ-PC -U sa -P 123 ?<br> Microsoft (R) SQL Server Command Line Tool<br> Version 10.0.1600.22 NT INTEL X86<br> Copyright (c) Microsoft Corporation.  All rights reserved.<br> <br> Note: osql does not support all features of SQL Server 2008.<br> Use sqlcmd instead. See SQL Server Books Online for details.usage: osql              [-U login id]          [-P password]<br>   [-S server]            [-H hostname]          [-E trusted connection]<br>   [-d use database name] [-l login timeout]     [-t query timeout]<br>   [-h headers]           [-s colseparator]      [-w columnwidth]<br>   [-a packetsize]        [-e echo input]        [-I Enable Quoted Identifiers]<br>   [-L list servers]      [-c cmdend]            [-D ODBC DSN name]<br>   [-q "cmdline query"]   [-Q "cmdline query" and exit]<br>   [-n remove numbering]  [-m errorlevel]<br>   [-r msgs to stderr]    [-V severitylevel]<br>   [-i inputfile]         [-o outputfile]<br>   [-p print statistics]  [-b On error batch abort]<br>   [-X[1] disable commands [and exit with warning]]<br>   [-O use Old ISQL behavior disables the following]<br>       &lt;EOF&gt; batch processing<br>       Auto console width scaling<br>       Wide messages<br>       default errorlevel is -1 vs 1<br>   [-? show syntax summary]<br> <br> </p> 
<p><span style="color:#FF0000">解释</span>：</p> 
<p>参数-?   <br>     <br>   显示   osql   开关的语法摘要。   <br>     <br>   -L   <br>     <br>   列出在本地配置的服务器和在网络上广播的服务器的名称。   <br>     <br>   -U   login_id   <br>     <br>   用户登录   ID。登录   ID   区分大小写。   <br>     <br>   -P   password   <br>     <br>   是用户指定的密码。如果未使用   -P   选项，osql   将提示输入密码。如果在命令提示符的末尾使用   -P   选项而不带密码，osql   使用默认密码   (NULL)。密码区分大小写。  <br>     <br>   OSQLPASSWORD   环境变量使您得以为当前会话设置默认密码。因此，不需要通过硬编码来在批处理文件中设置密码。   <br>     <br>   如果没有为   -P   选项指定密码，osql   首先检查   OSQLPASSWORD   变量。如果未设置值，osql   使用默认密码   (NULL)。以下示例在命令提示符处设置   OSQLPASSWORD   变量，然后访问   osql   实用工具：  <br>     <br>   C:\&gt;SET   OSQLPASSWORD=abracadabra   <br>   C:\&gt;osql     <br>     <br>   -E   <br>     <br>   使用信任连接而不请求密码。   <br>     <br>   -S   server_name[\instance_name]   <br>     <br>   指定要连接的   Microsoft&amp;reg;   SQL   Server&amp;#8482;   2000   实例。在该服务器上指定   server_name   以连接到   SQL   Server   的默认实例。在该服务器上指定   server_name\instance_name   以连接到一个已命名的   SQL   Server   2000   的实例。如果未指定服务器，osql   将连接到本地计算机上的   SQL   Server   默认实例。从网络上的远程计算机执行   osql   时，此选项是必需的。   <br>     <br>   -H   wksta_name   <br>     <br>   是工作站名称。工作站名称存储在   sysprocesses.hostname   中并由   sp_who   显示。如果未指定此选项，则采用当前计算机名称。  <br>     <br>   -d   db_name   <br>     <br>   启动   osql   时发出一个   USE   db_name   语句。   <br>     <br>   -l   time_out   <br>     <br>   指定   osql   登录超时之前的秒数。登录到   osql   的默认超时为   8   秒。   <br>     <br>   -t   time_out   <br>     <br>   指定命令超时之前的秒数。如果未指定   time_out   值，则命令不会超时。   <br>     <br>   -h   headers   <br>     <br>   指定要在列标题之间打印的行数。默认为每一查询结果集打印一次标题。用   –1   指定不打印标题。如果使用   -1，则在参数和设置之间一定不能有空格（可以是   -h-1，不能是   -h   –1）。  <br>     <br>   -s   col_separator   <br>     <br>   指定列分隔符字符，其默认为空格。若要使用对操作系统有特殊含义的字符（例如   |   ;   &amp;   &lt;   &gt;），请将该字符用双引号   (")   引起来。  <br>     <br>   -w   column_width   <br>     <br>   允许用户设置屏幕输出的宽度。默认为   80   个字符。当输出行达到其最大屏幕宽度时，会拆分为多个行。   <br>     <br>   -a   packet_size   <br>     <br>   使您得以请求不同大小的数据包。packet_size   的有效值在   512   到   65535   之间。osql   的默认值为服务器的默认值。数据包大小的增加可以提高较大脚本执行的性能，在这种执行中   GO   命令之间   SQL   语句的数量很重要。Microsoft   的测试表明   8192   是大容量复制操作典型的最快设置。可以请求更大的数据包大小，但如果请求不能得到批准，则   osql   默认为服务器的默认值。  <br>     <br>   -e   <br>     <br>   回显输入。   <br>     <br>   -I   <br>     <br>   设置   QUOTED_IDENTIFIER   连接选项为开启。   <br>     <br>   -D   data_source_name   <br>     <br>   连接到用   Microsoft   SQL   Server   的   ODBC   驱动程序定义的   ODBC   数据源。osql   连接使用该数据源中指定的选项。  <br>     <br>     <br>     <br>   说明     该选项不适用于其它驱动程序定义的数据源。   <br>     <br>     <br>   -c   cmd_end   <br>     <br>   指定命令终止符。默认情况下，通过单独在一行中输入   GO   来终止命令并将其发送到   SQL   Server   2000。在重置命令终止符时，不要使用对操作系统有特殊含义的   Transact-SQL   保留字或字符，无论其前面是否有反斜杠。  <br>     <br>   -q   "query"   <br>     <br>   启动   osql   时执行查询，但是在查询完成时不退出   osql。（注意查询语句不应包含   GO）。如果从批处理文件中发出查询，请使用   %variables   或环境   %variables%。例如：  <br>     <br>   SET   table   =   sysobjects   <br>   osql   /q   "Select   *   from   %table%"   <br>     <br>   将查询用双引号引起来，将查询中嵌入的任何内容用单引号引起来。   <br>     <br>   -Q   "query"   <br>     <br>   执行查询并立即退出   osql。将查询用双引号引起来，将查询中嵌入的任何内容用单引号引起来。   <br>     <br>   -n   <br>     <br>   从输入行中删除编号和提示符号   (&gt;)。   <br>     <br>   -m   error_level   <br>     <br>   自定义错误信息的显示。显示指定的或更高严重级别错误的消息数、状态和错误级别。不显示严重级别低于指定级别的错误的任何信息。用   -1   指定与消息一起返回所有标题，即使是信息类的消息。如果用   –1，则在参数和设置之间不能有空格（可以是   -m-1，不能是   -m   -1）。  <br>     <br>   -r   {0   |   1}   <br>     <br>   将消息输出重定向到屏幕   (stderr)。如果未指定参数，或指定参数为   0，则仅重定向严重级别为   17   或更高的错误信息。如果指定参数为   1，则将重定向所有消息输出（包括   "print"）。  <br>     <br>   -i   input_file   <br>     <br>   标识包含一批   SQL   语句或存储过程的文件。小于   (&lt;)   比较运算符可以用来代替   –i。   <br>     <br>   -o   output_file   <br>     <br>   标识从   osql   接收输出的文件。大于   (&gt;)   比较运算符可以用来代替   –o。   <br>     <br>   如果   input_file   不是   Unicode   并且没有指定   -u，则   output_file   将存储为   OEM   格式。如果   input_file   是   Unicode   或者指定了   -u，则   output_file   将存储为   Unicode   格式。  <br>     <br>   -p   <br>     <br>   打印性能统计。   <br>     <br>   -b   <br>     <br>   指定发生错误时   osql   退出并返回一个   DOS   ERRORLEVEL   值。当   SQL   Server   错误信息的严重级别为   10   或更高时，返回给   DOS   ERRORLEVEL   变量的值为   1；否则返回   0。Microsoft   MS-DOS&amp;reg;   批处理文件可以测试   DOS   ERRORLEVEL   的值并适当处理错误。  <br>     <br>   -u   <br>     <br>   指定   output_file   存储为   Unicode   格式，而不管   input_file   为何种格式。   <br>     <br>   -R   <br>     <br>   指定在将货币、日期和时间数据转换为字符数据时   SQL   Server   ODBC   驱动程序使用客户端设置。   <br>     <br>   -O   <br>     <br>   为与   isql   的早期版本行为匹配，指定停用某些   osql   功能。下列功能停用：     <br>     <br>   EOF   批处理   <br>     <br>     <br>   控制台宽度自动调整   <br>     <br>     <br>   宽信息     <br>   同时还将   DOS   ERRORLEVEL   的默认值设置为   –1。   <br>     <br>   注释   <br>   osql   实用工具从操作系统直接启动，并且使用本文中列出的区分大小写的选项。启动后，osql   接受   SQL   语句并将它们交互地发送到   SQL   Server。结果被格式化并显示在屏幕上   (stdout)。可使用   QUIT   或   EXIT   退出   osql。  <br>     <br>   如果启动   osql   时未指定用户名，SQL   Server   2000   将检查环境变量并使用它们，例如   osqluser=(user)   或   osqlserver=(server)。如果未设置环境变量，则使用工作站用户名。如果未指定服务器，则使用工作站名称。  <br>     <br>   如果   -U   或   -P   选项都没有使用，则   SQL   Server   2000   将尝试使用   Windows   身份验证模式进行连接。身份验证基于运行   osql   的   Microsoft   Windows   NT&amp;reg;   用户帐户。交互性使用   osql  <br>   若要交互性使用   osql，请在命令提示符处键入   osql   命令（以及任何选项）。   <br>     <br>   可以通过键入类似下行的命令，在包含由   osql   执行的查询的文件（例如   Stores.qry）中进行读取：   <br>     <br>   osql   /U   alma   /P   /i   stores.qry   <br>     <br>   该文件必须包含命令终止符。     <br>     <br>   可以通过键入类似下行的命令，在包含查询的文件（例如   Titles.qry）中进行读取并将结果导向另一文件：   <br>     <br>   osql   /U   alma   /P   /i   titles.qry   /o   titles.res   <br>     <br>   交互性使用   osql   时，为把操作系统文件读入到命令缓冲区，可使用：r   file_name。不要在文件中包含命令终止符；在完成编辑后交互输入终止符。  <br> <span style="color:#FF0000">举例：</span></p> 
<span style="color:#33CC00">C:\Users\Administrator&gt;osql -S ZLQ-PC -U sa -P 123  -q "select count(*) as  count<br>  from sysobjects"<br>    count<br>  -----------<br>         1999<br> <br> </span> 
<p><span style="color:#33CC00">(1 row affected)</span></p> 
<p><span style="color:#3333FF">//如果想继续执行SQL查询，输入关键字go</span><br> </p> 
<p><span style="color:#FF0000">C:\Users\Administrator&gt;osql -S ZLQ-PC -U sa -P 123 -d test1  -q "select *  from<br> student"<br>  sno         sname                sage                    ssex<br>  ----------- -------------------- ----------------------- ----<br>            1 张三                   1980-01-23 00:00:00.000 男<br>            2 李四                   1982-12-12 00:00:00.000 女<br>            3 张飒                   1981-09-09 00:00:00.000 男<br>            4 莉莉                   1983-03-23 00:00:00.000 女<br>            5 王弼                   1982-06-21 00:00:00.000 男<br>            6 王丽                   1984-10-10 00:00:00.000 女<br>            7 刘香                   1980-12-22 00:00:00.000 女</span></p> 
<p><span style="color:#FF0000"><span style="color:#FF0000">(7 rows affected)</span><br> </span></p> 
<p><span style="color:#FF0000">1&gt; select * from teacher<br> 2&gt; go <span style="color:#33FF33">// go 是立即执行该缓存语句</span><br>  tno         tname<br>  ----------- --------------------<br>            1 张老师<br>            2 王老师<br>            3 李老师<br>            4 赵老师<br>            5 刘老师<br>            6 向老师<br>            7 李文静<br>            8 叶平<br> <br> (8 rows affected)<br> 1&gt;</span></p> 
<p><br> </p> 
<p><br> </p> 
<h2><strong><span style="color:#33CC00">-----使用工具SQLCMD:</span></strong><br> </h2> 
<p><span style="color:#FF0000"></span><span style="color:#3333FF">使用sqlcmd：</span></p> 
<p>C:\Users\Administrator&gt;sqlcmd  -?<br> Microsoft (R) SQL Server Command Line Tool<br> Version 10.0.1600.22 NT INTEL X86<br> Copyright (c) Microsoft Corporation.  All rights reserved.<br> <br> usage: Sqlcmd            [-U login id]          [-P password]<br>   [-S server]            [-H hostname]          [-E trusted connection]<br>   [-d use database name] [-l login timeout]     [-t query timeout]<br>   [-h headers]           [-s colseparator]      [-w screen width]<br>   [-a packetsize]        [-e echo input]        [-I Enable Quoted Identifiers]<br>   [-c cmdend]            [-L[c] list servers[clean output]]<br>   [-q "cmdline query"]   [-Q "cmdline query" and exit]<br>   [-m errorlevel]        [-V severitylevel]     [-W remove trailing spaces]</p> 
<p>  [-u unicode output]    [-r[0|1] msgs to stderr]<br>   [-i inputfile]         [-o outputfile]        [-z new password]<br>   [-f &lt;codepage&gt; | i:&lt;codepage&gt;[,o:&lt;codepage&gt;]] [-Z new password and exit]<br>   [-k[1|2] remove[replace] control characters]<br>   [-y variable length type display width]<br>   [-Y fixed length type display width]<br>   [-p[1] print statistics[colon format]]<br>   [-R use client regional setting]<br>   [-b On error batch abort]<br>   [-v var = "value"...]  [-A dedicated admin connection]<br>   [-X[1] disable commands, startup script, enviroment variables [and exit]]<br>   [-x disable variable substitution]<br>   [-? show syntax summary]<br> </p> 
<p><span style="color:#FF0000">举例：</span></p> 
<p><span style="color:#FF0000">C:\Users\Administrator&gt;sqlcmd -S zlq-pc -U sa -P 123 -d test1<br> 1&gt; select * from teacher<br> 2&gt; go<br> tno         tname<br> ----------- --------------------<br>           1 张老师<br>           2 王老师<br>           3 李老师<br>           4 赵老师<br>           5 刘老师<br>           6 向老师<br>           7 李文静<br>           8 叶平<br> <br> (8 rows affected)<br> 1&gt;</span></p> 
<p><br> </p> 
<p>C:\Users\Administrator&gt;sqlcmd -S zlq-pc -U sa -P 123<br> 1&gt; use test1<br> 2&gt; select top 10 * from sc<br> 3&gt; go<br> Changed database context to 'test1'.<br> sno         cno         score<br> ----------- ----------- -----------<br>           1           1          80<br>           1           2          86<br>           1           3          83<br>           1           4          89<br>           2           1          50<br>           2           2          36<br>           2           4          59<br>           3           1          50<br>           3           2          96<br>           3           4          69<br> <br> (10 rows affected)<br> 1&gt;<br> </p> 
<p><span style="color:#FF0000"><br> </span></p> 
<h3><span style="color:#FF0000">sqlcmd详细介绍在：<br> </span></h3> 
<p>http://blog.163.com/llsh2010@126/blog/static/1691895692011615113838734/<br> <span style="color:#33CC00"></span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f85b7985527da00456baf3425ca67464/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Bundle携带对象来传输对象</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e55adb41153de6670bf6071ffa0b3b41/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">IOS开发人员必看的精品资料100</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>