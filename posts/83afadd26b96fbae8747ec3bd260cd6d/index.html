<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于phpmailer的企业邮箱发送邮件 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于phpmailer的企业邮箱发送邮件" />
<meta property="og:description" content="function sendMail($to,$title,$content,$type=0){ //引入PHPMailer的核心文件 使用require_once包含避免出现PHPMailer类重复定义的警告 require_once(&#34;phpmailer/class.phpmailer.php&#34;); require_once(&#34;phpmailer/class.smtp.php&#34;); //实例化PHPMailer核心类 $mail = new PHPMailer(); //是否启用smtp的debug进行调试 开发环境建议开启 生产环境注释掉即可 默认关闭debug调试模式 $mail-&gt;SMTPDebug = 1; //使用smtp鉴权方式发送邮件 $mail-&gt;isSMTP(); //smtp需要鉴权 这个必须是true $mail-&gt;SMTPAuth=true; //链接qq域名邮箱的服务器地址 // $mail-&gt;Host = &#39;smtp.qq.com&#39;; //链接163企业邮箱的服务器地址 $mail-&gt;Host = &#39;smtp.qiye.163.com&#39;; //设置使用ssl加密方式登录鉴权 企业邮箱必须关闭,个人邮箱才需要 // $mail-&gt;SMTPSecure = &#39;ssl&#39;; //设置ssl连接smtp服务器的远程服务器端口号，以前的默认是25，但是现在新的好像已经不可用了 可选465或587 // $mail-&gt;Port = 465; //企业邮箱服务器端口号 $mail-&gt;Port = 25; //设置smtp的helo消息头 这个可有可无 内容任意 // $mail-&gt;Helo = &#39;Hello smtp.qq.com Server&#39;; //设置发件人的主机域 可有可无 默认为localhost 内容任意，建议使用你的域名 $mail-&gt;Hostname = &#39;www.XXXXXX.com&#39;; //设置发送的邮件的编码 可选GB2312 我喜欢utf-8 据说utf8在某些客户端收信下会乱码 $mail-&gt;CharSet = &#39;UTF-8&#39;; //设置发件人姓名（昵称） 任意内容，显示在收件人邮件的发件人邮箱地址前的发件人姓名 $mail-&gt;FromName = &#39;XXXXX&#39;; //企业邮箱账号 $mail-&gt;Username = &#39;XXXXXXX&#39;; //smtp登录的账号 这里填入字符串格式的qq号即可 // $mail-&gt;Username =&#39;XXXXXX@qq." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/83afadd26b96fbae8747ec3bd260cd6d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-10-07T11:01:59+08:00" />
<meta property="article:modified_time" content="2017-10-07T11:01:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于phpmailer的企业邮箱发送邮件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre style="background-color:rgb(43,43,43); color:rgb(169,183,198); font-size:13.5pt"><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)"><strong>function </strong></span><span style="font-family:Consolas; color:rgb(255,198,109); background-color:rgb(35,37,37)">sendMail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">(</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$to</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">,</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$title</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">,</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$content</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">,</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$type</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">=</span><span style="font-family:Consolas; color:rgb(104,151,187); background-color:rgb(35,37,37)">0</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">){
</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">引入</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">PHPMailer</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">的核心文件 使用</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">require_once</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">包含避免出现</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">PHPMailer</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">类重复定义的警告
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)"><strong>require_once</strong></span><span style="font-family:Consolas; background-color:rgb(35,37,37)">(</span><span style="font-family:Consolas; color:rgb(106,135,89); background-color:rgb(35,37,37)">"phpmailer/class.phpmailer.php"</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">)</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)"><strong>require_once</strong></span><span style="font-family:Consolas; background-color:rgb(35,37,37)">(</span><span style="font-family:Consolas; color:rgb(106,135,89); background-color:rgb(35,37,37)">"phpmailer/class.smtp.php"</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">)</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">实例化</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">PHPMailer</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">核心类
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">= </span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)"><strong>new </strong></span><span style="font-family:Consolas; background-color:rgb(35,37,37)">PHPMailer()</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">是否启用</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">smtp</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">的</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">debug</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">进行调试 开发环境建议开启 生产环境注释掉即可 默认关闭</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">debug</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">调试模式
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">SMTPDebug </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">= </span><span style="font-family:Consolas; color:rgb(104,151,187); background-color:rgb(35,37,37)">1</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">使用</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">smtp</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">鉴权方式发送邮件
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(255,198,109); background-color:rgb(35,37,37)">isSMTP</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">()</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//smtp</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">需要鉴权 这个必须是</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">true
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">SMTPAuth</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">=</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)"><strong>true</strong></span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">链接</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">qq</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">域名邮箱的服务器地址
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    //    $mail-&gt;Host = 'smtp.qq.com';
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    //</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">链接</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">163</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">企业邮箱的服务器地址
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">Host </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">= </span><span style="font-family:Consolas; color:rgb(106,135,89); background-color:rgb(35,37,37)">'smtp.qiye.163.com'</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">设置使用</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">ssl</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">加密方式登录鉴权   企业邮箱必须关闭</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">,</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">个人邮箱才需要
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    //    $mail-&gt;SMTPSecure = 'ssl';
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    //</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">设置</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">ssl</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">连接</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">smtp</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">服务器的远程服务器端口号，以前的默认是</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">25</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">，但是现在新的好像已经不可用了 可选</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">465</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">或</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">587
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    //    $mail-&gt;Port = 465;
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    //</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">企业邮箱服务器端口号
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">Port </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">= </span><span style="font-family:Consolas; color:rgb(104,151,187); background-color:rgb(35,37,37)">25</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">设置</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">smtp</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">的</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">helo</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">消息头 这个可有可无 内容任意
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">// $mail-&gt;Helo = 'Hello smtp.qq.com Server';
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    //</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">设置发件人的主机域 可有可无 默认为</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">localhost </span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">内容任意，建议使用你的域名
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">Hostname </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">= </span><span style="font-family:Consolas; color:rgb(106,135,89); background-color:rgb(35,37,37)">'www.XXXXXX.com'</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">设置发送的邮件的编码 可选</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">GB2312 </span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">我喜欢</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">utf-8 </span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">据说</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">utf8</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">在某些客户端收信下会乱码
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">CharSet </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">= </span><span style="font-family:Consolas; color:rgb(106,135,89); background-color:rgb(35,37,37)">'UTF-8'</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">设置发件人姓名（昵称） 任意内容，显示在收件人邮件的发件人邮箱地址前的发件人姓名
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">FromName </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">= </span><span style="font-family:Consolas; color:rgb(106,135,89); background-color:rgb(35,37,37)">'XXXXX'</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">企业邮箱账号
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">Username </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">= </span><span style="font-family:Consolas; color:rgb(106,135,89); background-color:rgb(35,37,37)">'XXXXXXX'</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//smtp</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">登录的账号 这里填入字符串格式的</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">qq</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">号即可
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//    $mail-&gt;Username ='XXXXXX@qq.com';
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    //smtp</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">登录的密码 使用生成的授权码（就刚才叫你保存的最新的授权码）
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//    $mail-&gt;Password = '此处为个人邮箱授权码';
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    //</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">企业邮箱</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">,</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">直接使用密码</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">,</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">并且关闭</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">ssl</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">加密方式
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">Password </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">= </span><span style="font-family:Consolas; color:rgb(106,135,89); background-color:rgb(35,37,37)">'XXXXXXXX'</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;//改密码为企业邮箱登录密码
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">设置发件人邮箱地址 这里填入上述提到的</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">“</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">发件人邮箱</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">”
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//    $mail-&gt;From = 'XXXXXX@qq.com';
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">From </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">= </span><span style="font-family:Consolas; color:rgb(106,135,89); background-color:rgb(35,37,37)">'XXXXXXXXX' </span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">邮件正文是否为</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">html</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">编码 注意此处是一个方法 不再是属性</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)"> true</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">或</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">false
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(255,198,109); background-color:rgb(35,37,37)">isHTML</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">(</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)"><strong>true</strong></span><span style="font-family:Consolas; background-color:rgb(35,37,37)">)</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">设置收件人邮箱地址 该方法有两个参数 第一个参数为收件人邮箱地址 第二参数为给该地址设置的昵称 不同的邮箱系统会自动进行处理变动 这里第二个参数的意义不大
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(255,198,109); background-color:rgb(35,37,37)">addAddress</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">(</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$to</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">)</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">添加多个收件人 则多次调用方法即可
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">// $mail-&gt;addAddress('xxx@163.com','lsgo</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">在线通知</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">');
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">
</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    //</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">添加该邮件的主题
</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">Subject </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">= </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$title</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;
</span><span style="background-color:rgb(35,37,37)"></span><pre style="background-color:rgb(43,43,43); color:rgb(169,183,198); font-size:13.5pt"><span style="color:rgb(128,128,128); background-color:rgb(35,37,37)"><span style="font-family:Consolas">    //</span><span style="font-family:宋体">为邮件添加图片<span style="white-space:pre">	</span>其中第一个参数为图片路径,第二个参数为图片名称(可随意名称),第三个参数为图片文件名</span></span></pre><span style="font-family:Consolas; background-color:rgb(35,37,37)">   </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(255,198,109); background-color:rgb(35,37,37)">AddEmbeddedImage</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">(</span><span style="font-family:Consolas; color:rgb(106,135,89); background-color:rgb(35,37,37)">'../phpexcel/bg.jpg'</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">, </span><span style="font-family:Consolas; color:rgb(106,135,89); background-color:rgb(35,37,37)">'bgimg'</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">, </span><span style="font-family:Consolas; color:rgb(106,135,89); background-color:rgb(35,37,37)">'bg.jpg'</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">)</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;</span><span style="font-family:Consolas; background-color:rgb(35,37,37)"></span><span style="font-family:Consolas; background-color:rgb(35,37,37)"></span><span style="font-family:Consolas; background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">添加邮件正文 上方将</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">isHTML</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">设置成了</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">true</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">，则可以是完整的</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">html</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">字符串 如：使用</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">file_get_contents</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">函数读取本地的</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">html</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">文件</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">Body </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">= </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$content</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)"></span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">为该邮件添加附件 该方法也有两个参数 第一个参数为附件存放的目录（相对目录、或绝对目录均可） 第二参数为在邮件附件中该附件的名称</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">// $mail-&gt;addAttachment('./d.jpg','mm.jpg');</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    //</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">同样该方法可以多次调用 上传多个附件</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">// $mail-&gt;addAttachment('./Jlib-1.1.0.js','Jlib.js');</span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)"></span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$status </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">= </span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$mail</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">-&gt;</span><span style="font-family:Consolas; color:rgb(255,198,109); background-color:rgb(35,37,37)">send</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">()</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)"></span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(128,128,128); background-color:rgb(35,37,37)">//</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">简单的判断与提示信息</span><span style="font-family:宋体; color:rgb(128,128,128); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)"><strong>if</strong></span><span style="font-family:Consolas; background-color:rgb(35,37,37)">(</span><span style="font-family:Consolas; color:rgb(152,118,170); background-color:rgb(35,37,37)">$status</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">) {<!-- --></span><span style="font-family:Consolas; background-color:rgb(35,37,37)">        </span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)"><strong>return true</strong></span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">}</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)"><strong>else</strong></span><span style="font-family:Consolas; background-color:rgb(35,37,37)">{<!-- --></span><span style="font-family:Consolas; background-color:rgb(35,37,37)">        </span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)"><strong>return false</strong></span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">;</span><span style="font-family:Consolas; color:rgb(204,120,50); background-color:rgb(35,37,37)">    </span><span style="font-family:Consolas; background-color:rgb(35,37,37)">}</span><span style="font-family:Consolas; background-color:rgb(35,37,37)">}</span></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6ee04920dfec038e828a6121804e1a73/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">InstallShield 2015 Limited Edition 打包程序详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2717f9be41c677ff8c19c46c7bc841e3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">单词翻转</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>