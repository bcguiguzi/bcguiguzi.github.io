<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Qt Socket传输图片(一) - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Qt Socket传输图片(一)" />
<meta property="og:description" content="上次简单实现了python发送和接收图片的Demo,本次通Qt的接收图片，并显示在QLabel上。
在开始之前，先了解下常见图片的几种格式。
①BMP(.bmp)
位图图像是Microsoft为Windows开发的格式。bmp文件没有压缩或信息丢失，这使得图像具有质量很高，当然图像文件也就比较大。
②JPEG(.jpg .jepg)
是一种有损格式，意味着图像被压缩成较小的文件。虽然压缩图像会造成图像有所损失，但是是在可接受范围内的。这种图片格式在互联网上比较常见。
③GIF(.gif)
GIF广泛用于Web图形，因为它们仅限于256中颜色，可以允许透明度，还可以设置动画。GIF文件通常很小，即使被压缩也不会降低质量。
④PNG(.png)
PNG最初旨在替换gif格式文件，是一种便携式无损图像格式。与gif所支持的256种颜色不同，png文件可以处理多达1600万种颜色。(表示不懂。。。)png文件也比较小，同样压缩也不会降低图像质量。
接下来了解下Qt对图像处理的支持：
可以使用QLabel轻松地在屏幕上显示QPixmap。 QLabel有一个pixmap属性。
程序平台：ubuntu 14.04、Qt5.5.1、python2.7
void Widget::slot_readClientData()	{	QByteArray buffer;	buffer = mp_clsTcpClientConnnect-&gt;readAll();	if(buffer.size() &lt; 15)	{	qDebug() &lt;&lt; &#34;Receive Data str:&#34; &lt;&lt; buffer.size() &lt;&lt; buffer;	}	if(buffer.size() == 24518)	{	QPixmap pix;	bool ret = pix.loadFromData(buffer,&#34;png&#34;);	//show	if(ret)	ui-&gt;lb_picture-&gt;setPixmap(pix.scaled(250,200)); // 500 * 375	// QFile file(&#34;in.png&#34;);	// if (!file.open(QIODevice::WriteOnly))	// {	// qDebug() &lt;&lt; &#34;failed!&#34;;	// return;	// }	// file." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/6aafc8b22699bf8bc4a4670de163381b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-08-03T14:09:07+08:00" />
<meta property="article:modified_time" content="2019-08-03T14:09:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Qt Socket传输图片(一)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-indent:28px;">上次简单实现了python发送和接收图片的Demo,本次通Qt的接收图片，并显示在QLabel上。</p> 
<p style="text-indent:28px;"> </p> 
<p style="text-indent:28px;">在开始之前，先了解下常见图片的几种格式。</p> 
<p style="text-indent:28px;">①BMP(.bmp)</p> 
<p style="margin-left:28px;text-indent:28px;">位图图像是Microsoft为Windows开发的格式。bmp文件没有压缩或信息丢失，这使得图像具有质量很高，当然图像文件也就比较大。</p> 
<p style="margin-left:28px;text-indent:28px;"> </p> 
<p style="text-indent:28px;">②JPEG(.jpg .jepg)</p> 
<p style="margin-left:28px;text-indent:28px;">是一种有损格式，意味着图像被压缩成较小的文件。虽然压缩图像会造成图像有所损失，但是是在可接受范围内的。这种图片格式在互联网上比较常见。</p> 
<p style="margin-left:28px;text-indent:28px;"> </p> 
<p style="text-indent:28px;">③GIF(.gif)</p> 
<p style="margin-left:28px;text-indent:28px;">GIF广泛用于Web图形，因为它们仅限于256中颜色，可以允许透明度，还可以设置动画。GIF文件通常很小，即使被压缩也不会降低质量。</p> 
<p style="margin-left:28px;text-indent:28px;"> </p> 
<p style="text-indent:28px;">④PNG(.png)</p> 
<p style="margin-left:28px;text-indent:28px;">PNG最初旨在替换gif格式文件，是一种便携式无损图像格式。与gif所支持的256种颜色不同，png文件可以处理多达1600万种颜色。(表示不懂。。。)png文件也比较小，同样压缩也不会降低图像质量。</p> 
<p style="margin-left:28px;text-indent:28px;"> </p> 
<p style="text-indent:28px;">接下来了解下Qt对图像处理的支持：</p> 
<p style="text-indent:28px;">可以使用QLabel轻松地在屏幕上显示QPixmap。 QLabel有一个pixmap属性。</p> 
<p style="text-indent:28px;"> </p> 
<p style="text-indent:28px;">程序平台：ubuntu 14.04、Qt5.5.1、python2.7</p> 
<p style="text-indent:28px;"> </p> 
<pre class="has"><code class="language-html"> </code></pre> 
<pre class="has"><code>void Widget::slot_readClientData()	
{	
    QByteArray buffer;	
    buffer = mp_clsTcpClientConnnect-&gt;readAll();	
	
    if(buffer.size() &lt; 15)	
    {	
        qDebug() &lt;&lt; "Receive Data str:" &lt;&lt; buffer.size()  &lt;&lt; buffer;	
    }	
	
	
    if(buffer.size() == 24518)	
    {	
        QPixmap pix;	
        bool ret = pix.loadFromData(buffer,"png");	
	
        //show	
        if(ret)	
        ui-&gt;lb_picture-&gt;setPixmap(pix.scaled(250,200));  // 500 * 375	
	
//        QFile file("in.png");	
//        if (!file.open(QIODevice::WriteOnly))	
//        {	
//            qDebug() &lt;&lt; "failed!";	
//            return;	
	
//        }	
//        file.write((const char*)buffer,24518);	
//        file.close();	
	
        qDebug() &lt;&lt; "Receive Data str:" &lt;&lt; buffer.size();	
    }	
}</code></pre> 
<p style="text-indent:28px;"> </p> 
<p style="text-indent:28px;">程序主体部分不多，使用之前的python脚本发送图像，使用Qt作为服务器接收。先接收图像字节大小，之后如果接收到图像字节，则使用QPixmap 直接加载为png格式图像，如果加载成功则直接在QLabel上显示。下面被屏蔽的是直接将字节存储为对应图片格式的文件，也是可以存储为图片的，毕竟一切接文件。</p> 
<p style="text-indent:28px;"> </p> 
<p style="text-indent:28px;">程序运行结果图片：</p> 
<p style="text-align:center;"><img alt="640?wx_fmt=png" class="rich_pages" src="https://images2.imgbox.com/95/2e/IQum7AR0_o.png"></p> 
<p style="text-indent:28px;"> </p> 
<p style="text-indent:28px;">程序上也不是很复杂，只是开始接触的时候很蒙圈。在网上搜索的读的也不是很懂，所以自己写了一遍又整理了下。之后会分享一个Qt发送和接收图片的例子。</p> 
<p style="text-indent:28px;"> </p> 
<p style="text-indent:28px;">*****************************************更新***********************************</p> 
<p style="text-indent:28px;">Qt发送和接收图片的例子：</p> 
<p style="text-indent:28px;"><a href="https://blog.csdn.net/ACK_ACK/article/details/98565090">Qt socket 线程中收发图片</a></p> 
<p style="text-indent:28px;">*****************************************更新***********************************</p> 
<p style="text-indent:28px;"> </p> 
<p style="text-indent:28px;"><u><strong><em><u>本文主要供学习使用，如果转载请注明作者与出处，谢谢。</u></em></strong></u></p> 
<p style="text-indent:28px;"><span style="color:#7c79e5;"><u><strong><em><u>关注公众号，后台留言可获取 Socket 线程中收发图片工程源码</u></em></strong></u></span></p> 
<p style="text-indent:28px;"> </p> 
<p style="text-align:center;"><img alt="640?wx_fmt=png" class="rich_pages" height="210" src="https://images2.imgbox.com/a1/9b/kcvNpM9B_o.png" width="212"></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/67a4012a152f1bbfb58804f60c11821e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ASP.NET 身份验证</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/41ae8f8e50d639b5b41ac03430eb78e7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">玩转Jetson nano系列（1）：Jetson nano编译安装ncnn</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>