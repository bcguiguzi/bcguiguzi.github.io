<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Java报表工具FineReport导出EXCEL的四种方式 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Java报表工具FineReport导出EXCEL的四种方式" />
<meta property="og:description" content="在实际的应用中会经常需要将数据导出成excel，导出的方式除原样导出还有分页导出、分页分sheet导出和大数据量导出。对于excel2003版，限制了每个sheet的最大行数和列数，大数据量导出时会默认时分多个sheet，而excel2007不会出现这样的问题。这些导出方式在JAVA程序中分别有不同的接口来实现：
1、 原样导出
原样导出就是不预览直接导出excel
其程序接口代码如下：
outputStream = new FileOutputStream(new File(&#34;E:\\ExcelExport.xls&#34;)); ExcelExporter excel = new ExcelExporter(); //导出2007版 outputStream = new FileOutputStream(new File(&#34;E:\\ExcelExport.xlsx&#34;)); excel Excel2007Exporter excel = new Excel2007Exporter(); excel.export(outputStream, rworkbook); 效果图：
2、 分页导出
分页导出，如果报表模版是分页的，会按照分页的结果形式导出，重复的标题等也会重复。
其程序接口代码如下：
outputStream = new FileOutputStream(new File(&#34;E:\\PageExcelExport.xls&#34;)); PageExcelExporter page = new PageExcelExporter(ReportUtils.getPaperSettingListFromWorkBook(rworkbook)); //导出2007版 outputStream = new FileOutputStream(new File(&#34;E:\\PageExcelExport.xlsx&#34;)); excel PageExcel2007Exporter page = new PageExcel2007Exporter(ReportUtils.getPaperSettingListFromWorkBook(rworkbook)); page.export(outputStream, rworkbook); 效果图：
3、 分页分sheet导出
分页分Sheet导出时报表结果的每一页为一个Sheet保存在Excel文件中
其代码如下：
outputStream = new FileOutputStream(new File(&#34;E:\\PageSheetExcelExport.xls&#34;)); PageToSheetExcelExporter sheet = new PageToSheetExcelExporter(ReportUtils." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/bcd23791e1cdc0096cfc66f7323870e1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-03-15T13:24:34+08:00" />
<meta property="article:modified_time" content="2016-03-15T13:24:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Java报表工具FineReport导出EXCEL的四种方式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="color:#383838;"></span></p> 
<p><span style="color:#383838;">在实际的应用中会经常需要将数据导出成</span><span style="color:#383838;">excel</span><span style="color:#383838;">，导出的方式除原样导出还有</span>分页导出、分页分sheet导出和大数据量导出。对于<span style="color:#383838;">excel2003</span><span style="color:#383838;">版，限制了每个</span><span style="color:#383838;">sheet</span><span style="color:#383838;">的最大行数和列数，大数据量导出时会默认时分多个</span><span style="color:#383838;">sheet</span><span style="color:#383838;">，而</span><span style="color:#383838;">excel2007</span><span style="color:#383838;">不会出现这样的问题。</span>这些导出方式在JAVA程序中分别有不同的接口来实现：</p> 
<p><strong>1、  原样导出</strong></p> 
<p>原样导出就是不预览直接导出excel</p> 
<p>其程序接口代码如下：</p> 
<p></p> 
<pre><code class="language-java"> outputStream = new FileOutputStream(new File("E:\\ExcelExport.xls"));  
 ExcelExporter excel = new ExcelExporter();  
 //导出2007版 outputStream = new FileOutputStream(new File("E:\\ExcelExport.xlsx"));  excel Excel2007Exporter excel = new Excel2007Exporter();
 excel.export(outputStream, rworkbook);</code></pre> 
<p></p> 
<p>效果图：</p> 
<p><img src="https://images2.imgbox.com/e4/c7/7cpM3E0n_o.png" alt=""><br></p> 
<p></p> 
<p><strong>2、  分页导出</strong></p> 
<p><span style="color:#383838;">分页导出，如果报表模版是分页的，会按照分页的结果形式导出，重复的标题等也会重复。</span></p> 
<p>其程序接口代码如下：</p> 
<pre><code class="language-java"> outputStream = new FileOutputStream(new File("E:\\PageExcelExport.xls"));
 PageExcelExporter page = new PageExcelExporter(ReportUtils.getPaperSettingListFromWorkBook(rworkbook));
//导出2007版 outputStream = new FileOutputStream(new File("E:\\PageExcelExport.xlsx")); excel  PageExcel2007Exporter page = new PageExcel2007Exporter(ReportUtils.getPaperSettingListFromWorkBook(rworkbook));
 page.export(outputStream, rworkbook);</code></pre> 
<br> 
<p>效果图：</p> 
<img src="https://images2.imgbox.com/31/24/TaIKODps_o.png" alt=""> 
<br> 
<p></p> 
<p><strong>3、  分页分sheet导出</strong></p> 
<p><span style="color:#383838;">分页分</span><span style="color:#383838;">Sheet</span><span style="color:#383838;">导出时报表结果的每一页为一个</span><span style="color:#383838;">Sheet</span><span style="color:#383838;">保存在</span><span style="color:#383838;">Excel</span><span style="color:#383838;">文件中</span></p> 
<p><span style="color:#383838;">其代码如下：</span></p> 
<p></p> 
<pre><code class="language-java"> outputStream = new FileOutputStream(new File("E:\\PageSheetExcelExport.xls"));
 PageToSheetExcelExporter sheet = new PageToSheetExcelExporter(ReportUtils.getPaperSettingListFromWorkBook(rworkbook));
 //导出2007版outputStream = new FileOutputStream(new File("E:\\PageSheetExcelExport.xlsx")); excel PageToSheetExcel2007Exporter sheet = new PageToSheetExcel2007Exporter(ReportUtils.getPaperSettingListFromWorkBook(rworkbook));
 sheet.export(outputStream, rworkbook);</code></pre> 
<br> 
<p></p> 
<p>效果图：</p> 
<img src="https://images2.imgbox.com/45/8d/xE3PPZeL_o.png" alt=""> 
<br> 
<p></p> 
<p><strong><span style="color:#383838;">4、  </span><span style="color:#383838;">大数据量导出</span></strong></p> 
<p><span style="color:#383838;">这是比较常见的，例如以</span><span style="color:#383838;">50000</span><span style="color:#383838;">行为一个</span><span style="color:#383838;">excel</span><span style="color:#383838;">文件</span></p> 
<p><span style="color:#383838;">其代码如下：</span></p> 
<p></p> 
<pre><code class="language-java"> outputStream = new FileOutputStream(new File("E:\\LargeExcelExport.zip"));
 LargeDataPageExcelExporter large = new LargeDataPageExcelExporter(ReportUtils.getPaperSettingListFromWorkBook(rworkbook), true);
 //导出2007版outputStream = new FileOutputStream(new File("E:\\LargeExcelExport.xlsx")); excel LargeDataPageExcel2007Exporter large = new LargeDataPageExcel2007Exporter(ReportUtils.getPaperSettingListFromWorkBook(rworkbook), true);
 large.export(outputStream, rworkbook);</code></pre> 
<p></p> 
<p>对于大数据量导出报表时，可能会出现如下两种情况：</p> 
<p>一，导出成功，数据会显示在多个Sheet中；</p> 
<p>二，二，导出失败，导出的Excel内容无效。出现如上情况的原因主要有两点：</p> 
<p><strong>4.1 没有启用行式引擎的大数据量报表导出</strong></p> 
<p>在没有启用行式引擎的情况下，也会出现两种情况：服务器可以承受的情况下导出成功，服务器无法承受的情况下导出失败，下面我们分别看下其结果：</p> 
<p><strong>4.1.1 服务器承受范围内</strong></p> 
<p>可以承受的范围是：数据量大，超过了EXCEL的最大行数但不是非常非常大，比如10万条，且数据不复杂，在内存足够且网络没有断的情况下可以正常导出。导出时，超出Excel最大行或列的数据会在下一个Sheet中显示。但是Excel的行数和列数是有限制的，如Excel2003其行数最大限制为65536行，列数最大限制为256列。</p> 
<p><strong>4.1.2 服务器无法承受</strong></p> 
<p>无法承受的范围是主要是数据量大，且非常大，比如几十万几百万甚至更多，可能因为内存等的限制而出现导出失败。而导出的结果时，打开导出失败的Excel，其内容是无效的。</p> 
<p>对于这两种导出结果，其主要原因在于数据量与数据复杂程度（列数）究竟有多大，在没有用行引擎的情况下就会有一个临界点，低于临界点的时候可以导出成功即导出的内容有多个sheet，否则导出失败，内容无效。所以，对于大数据量报表，通常使用行式引擎来展现，这种情况下，导出Excel始终成功。在启用行式引擎的大数据量报表导出Excel时，是将其分成多个.xls文件，且是以一个压缩包文件的格式传输到客户端的。</p> 
<p><strong>4.2 启用行式引擎的大数据量报表导出</strong></p> 
<p>对于大数据量报表，通常使用行式引擎来展现，这种情况下，导出Excel始终成功。因为启用行式引擎的大数据量报表导出Excel时，是将其分成多个.xls文件，且是以一个压缩包文件的格式传输到客户端的。</p> 
<p>比如，大数据量报表有100w行数据，设置行式引擎，每页显示30行。导出的结果会是41个Excel，前40个Excel每个24990行，最后一个Excel为400行，41个Excel压缩为zip包传到客户端下载。</p> 
<br>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/81a1897fa5e11a27855b577ff9e7f1c6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">js日期格式化和日期计算</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e3b2064e828536a5e7f993241e6e66b8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">支付宝支付</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>