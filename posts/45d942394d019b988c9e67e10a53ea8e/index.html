<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>牛客——计算系数（组合数学） - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="牛客——计算系数（组合数学）" />
<meta property="og:description" content=" 给定一个多项式(ax&#43;by)^k，请求出多项式展开后x^ny^m项的系数。 输入描述:
共一行，包含5个整数，分别为a，b，k，n，m，每两个整数之间用一个空格隔开。 输出描述:
输出共1行，包含一个整数，表示所求的系数，这个系数可能很大，输出对10007取模后的结果。 示例1
输入 1 1 3 1 2 输出 3 备注:
对于30%的数据，有0≤k≤10； 对于50%的数据，有a=1，b=1； 对于100%的数据，有0≤k≤1,000，0≤n,m≤k，且n&#43;m=k，0≤a，b≤1,000,000。 这里求的是系数，这里a一定和x对应，b一定和y对应，就相当于在k个（ax&#43;by）中选n个x,剩下的就是m个y了，
所以这里的公式就是 而后边的这里可以用逆元来求
=k(k-1)(k-2)......(k-n&#43;1)/1*2*3......*n
对于正整数和，如果有，那么把这个同余方程中的最小正整数解叫做模的逆元。
逆元一般用扩展欧几里得算法来求得，如果为素数，那么还可以根据费马小定理得到逆元为。
推导过程如下
所以这里求组合数的时候可以把所有的除法都变成乘法
求组合数： n&lt;=1000 递推公式 n&lt;=100000 逆元 n&lt;=10^18 Lucas定理 #include&lt;iostream&gt; using namespace std; long long mod=10007; long long Mood(long long a,long long b){ long long sum=1; a%=mod; while(b){ if(b&amp;1) sum=sum*a%mod; a=a*a%mod; b=b&gt;&gt;1; } return sum; } int a,b,k,n,m; long long ans=0; int main(){ cin&gt;&gt;a&gt;&gt;b&gt;&gt;k&gt;&gt;n&gt;&gt;m; ans=Mood(a,n)*Mood(b,m)%mod; for(int i=1,j=k;i&lt;=n;i&#43;&#43;,j--){//逆元 ans=ans*j%mod; ans=ans*Mood(i,mod-2)%mod; } cout&lt;&lt;ans&lt;&lt;endl; return 0; } " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/45d942394d019b988c9e67e10a53ea8e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-30T18:02:35+08:00" />
<meta property="article:modified_time" content="2019-07-30T18:02:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">牛客——计算系数（组合数学）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>给定一个多项式(ax+by)^k，请求出多项式展开后x^ny^m项的系数。 </h4> 
<p><strong>输入描述:</strong></p> 
<pre>共一行，包含5个整数，分别为a，b，k，n，m，每两个整数之间用一个空格隔开。
</pre> 
<p><strong>输出描述:</strong></p> 
<pre>输出共1行，包含一个整数，表示所求的系数，这个系数可能很大，<strong>输出对</strong><strong>10007</strong><strong>取模后的结果</strong>。</pre> 
<p>示例1</p> 
<h3>输入</h3> 
<pre>1 1 3 1 2</pre> 
<h3>输出</h3> 
<pre>3
</pre> 
<p><strong>备注:</strong></p> 
<pre>对于30%的数据，有0≤k≤10；
对于50%的数据，有a=1，b=1；
对于100%的数据，有0≤k≤1,000，0≤n,m≤k，且n+m=k，0≤a，b≤1,000,000。
</pre> 
<p><strong>这里求的是系数，这里a一定和x对应，b一定和y对应，就相当于在k个（ax+by）中选n个x,剩下的就是m个y了，</strong></p> 
<p><strong>所以这里的公式就是 <img alt="" class="has" height="41" src="https://images2.imgbox.com/45/b9/DLOfFjlf_o.png" width="96"></strong></p> 
<p><strong>而后边的<img alt="" class="has" height="30" src="https://images2.imgbox.com/b1/9d/0sa5vQ4A_o.png" width="20">这里可以用逆元来求</strong></p> 
<p><strong><img alt="" class="has" height="39" src="https://images2.imgbox.com/ec/5b/7NTzY7h7_o.png" width="26">=k(k-1)(k-2)......(k-n+1)/1*2*3......*n</strong></p> 
<p> </p> 
<p><strong>对于正整数<img alt="" class="has" src="https://images2.imgbox.com/81/ce/Vp3MwUFy_o.jpg">和<img alt="" class="has" src="https://images2.imgbox.com/24/2f/r9IJAXst_o.jpg">，如果有<img alt="" class="has" src="https://images2.imgbox.com/dd/a2/9OA36kJY_o.jpg">，那么把这个同余方程中<img alt="" class="has" src="https://images2.imgbox.com/6c/ca/4LPWhC52_o.jpg">的最小正整数解叫做<img alt="" class="has" src="https://images2.imgbox.com/48/55/8RgIsS4Z_o.jpg">模<img alt="" class="has" src="https://images2.imgbox.com/d1/2f/d2pgtKul_o.jpg">的逆元。</strong></p> 
<p><strong>逆元一般用扩展欧几里得算法来求得，如果<img alt="" class="has" src="https://images2.imgbox.com/5a/c4/CqiriHe7_o.jpg">为素数，那么还可以根据费马小定理得到逆元为<img alt="" class="has" src="https://images2.imgbox.com/20/fa/Snks8azf_o.jpg">。</strong></p> 
<p><strong>推导过程如下</strong></p> 
<p><strong>                            <img alt="" class="has" src="https://images2.imgbox.com/ab/be/SYlmcksK_o.jpg"></strong></p> 
<p><strong>所以这里求组合数的时候可以把所有的除法都变成乘法</strong></p> 
<h4>求组合数：</h4> 
<h4>n&lt;=1000  递推公式  <img alt="" class="has" height="36" src="https://images2.imgbox.com/bf/0a/dbmHghS7_o.png" width="169"></h4> 
<h4>n&lt;=100000    逆元</h4> 
<h4>n&lt;=10^18    Lucas定理</h4> 
<pre class="has"><code class="language-cpp">#include&lt;iostream&gt;
using namespace std;
long long mod=10007;
long long Mood(long long a,long long b){
	long long sum=1;
	a%=mod;
	while(b){
		if(b&amp;1)
		    sum=sum*a%mod;
		a=a*a%mod;
		b=b&gt;&gt;1;
	}
	return sum;
}
int a,b,k,n,m;
long long ans=0;
int main(){
	cin&gt;&gt;a&gt;&gt;b&gt;&gt;k&gt;&gt;n&gt;&gt;m;
	ans=Mood(a,n)*Mood(b,m)%mod;
	for(int i=1,j=k;i&lt;=n;i++,j--){//逆元 
		ans=ans*j%mod;
		ans=ans*Mood(i,mod-2)%mod;
	}
	cout&lt;&lt;ans&lt;&lt;endl;
	return 0;
}</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6034f5b5b1900f8b92e386ebb2e36159/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Centos7下搭建Nginx Keepalived Cluster</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b8d7ef1cc2f85e786e19cf5b57745309/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Unity 小知识</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>