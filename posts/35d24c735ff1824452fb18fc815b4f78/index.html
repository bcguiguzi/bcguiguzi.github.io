<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>从零开始：调用MapReduce进行单词的词频统计 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="从零开始：调用MapReduce进行单词的词频统计" />
<meta property="og:description" content="相信大家在复习英语相关考试时，都会很关注也很想知道试题中出现频率较高的单词是哪些从而提高复习的命中率对吧？今天我就告诉大家一个方法，使用MapReduce对指定文本进行单词的词频统计。那接下来我就带领大家从零开始一步步搭建环境，到最后的结果呈现，Let&#39;s go!
前置环境：
虚拟机Ubuntu系统
首先第一步要做的是Hadoop的生态安装： 1.在Oracle VM VirtualBox安转Ubuntu linux系统
2. 安装SSH、配置SSH无密码登陆
2.1因为ubuntu默认已经安装SSH client,所以只需安装SSH server: 命令：Sudo apt-get install openssh-server
2.2安装SSH服务后使用ssh localhost命令登陆本机
2.3 为了方便不用每次登陆SSH都需要密码，所以就将其配置成无密登陆。首先退出刚才的 ssh，就回到了我们原先的终端窗口，然后利用 ssh-keygen 生成密钥，并将密钥加入到授权中
之后再次使用localhost命令登陆则无需输入密码
3. 安装Java环境
首先在ubuntu的hadoop用户下创建一个Downloads的文件夹用于存放JDK的压缩包
JDK文件使用FileZilla传输到虚拟机Ubuntu里刚创建的Downloads文件夹下
然后接着创建在/usr/lib目录下创建一个jvm的文件夹，将刚才Downloads目录里的JDK压缩包解压到jvm目录下
JDK文件解压后使用cd /usr/lib/jvm进入jvm的目录，再ls命令查看一下解压后的情况
接着使用vim编辑器将以下内容添加到hadoop用户的环境变量配置文件中
保存.bashrc文件并退出vim编辑器。然后，继续执行source ~/.bashrc命令让配置生效，之后使用java -version命令查看是否成功安装
4. 安装Hadoop 2
首先通过FileZilla把Hadoop文件传输到Ubuntu里hadoop用户下的“Downloads”文件夹目录下
接着将Hadoop解压到/usr/local/里，并查看确认是否解压成功
解压后将文件夹名改为 hadoop 并修改文件权限
最后输入以下命令检查Hadoop是否可用，可用则会显示hadoop的版本信息
5. Hadoop伪分布式配置
Hadoop 可以在单节点上以伪分布式的方式运行，Hadoop 进程以分离的 Java 进程来运行，节点既作为 NameNode 也作为 DataNode，同时，读取的是 HDFS 中的文件。
Hadoop 的配置文件位于 /usr/local/hadoop/etc/hadoop/ 中，伪分布式需要修改2个配置文件 core-site.xml 和 hdfs-site.xml 。Hadoop的配置文件是 xml 格式，每个配置以声明 property 的 name 和 value 的方式来实现。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/35d24c735ff1824452fb18fc815b4f78/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-30T23:43:53+08:00" />
<meta property="article:modified_time" content="2021-12-30T23:43:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">从零开始：调用MapReduce进行单词的词频统计</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>相信大家在复习英语相关考试时，都会很关注也很想知道试题中出现频率较高的单词是哪些从而提高复习的命中率对吧？今天我就告诉大家一个方法，使用MapReduce对指定文本进行单词的词频统计。那接下来我就带领大家从零开始一步步搭建环境，到最后的结果呈现，Let's go!</p> 
<p>前置环境：</p> 
<p>虚拟机Ubuntu系统</p> 
<h2>首先第一步要做的是Hadoop的生态安装：</h2> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#FF0000;">1.</span></strong><strong><span style="color:#FF0000;">在</span></strong><strong><span style="color:#FF0000;">Oracle VM VirtualBox</span></strong><strong><span style="color:#FF0000;">安转</span></strong><strong><span style="color:#FF0000;">Ubuntu linux</span></strong><strong><span style="color:#FF0000;">系统</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="1200" src="https://images2.imgbox.com/54/e6/vqfrBmqG_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#FF0000;">2.</span></strong> <strong><span style="color:#FF0000;">安装</span></strong><strong><span style="color:#FF0000;">SSH</span></strong><strong><span style="color:#FF0000;">、配置</span></strong><strong><span style="color:#FF0000;">SSH</span></strong><strong><span style="color:#FF0000;">无密码登陆</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><strong>2.1</strong><strong>因为ubuntu默认已经安装SSH client,所以只需安装SSH server: 命令：Sudo apt-get install openssh-server</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="118" src="https://images2.imgbox.com/65/64/WtXTEDqv_o.png" width="760"></p> 
<p style="margin-left:0;text-align:justify;"><strong>2.2</strong><strong>安装SSH服务后使用ssh localhost命令登陆本机</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="543" src="https://images2.imgbox.com/95/31/Zcer8It7_o.png" width="1017"></p> 
<p style="margin-left:0;text-align:justify;"><strong>2.3 </strong><strong>为了方便不用每次登陆</strong><strong>SSH</strong><strong>都需要密码，所以就将其配置成无密登陆。首先退出刚才的</strong><strong> ssh</strong><strong>，就回到了我们原先的终端窗口，然后利用</strong><strong> ssh-keygen </strong><strong>生成密钥，并将密钥加入到授权中</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="710" src="https://images2.imgbox.com/77/32/kIqLRSRs_o.png" width="787"></p> 
<p style="margin-left:0;text-align:justify;"><strong>之后再次使用</strong><strong>localhost</strong><strong>命令登陆则无需输入密码</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="108" src="https://images2.imgbox.com/12/d2/qOf4gyXb_o.png" width="804"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#FF0000;">3. </span></strong><strong><span style="color:#FF0000;">安装</span></strong><strong><span style="color:#FF0000;">Java</span></strong><strong><span style="color:#FF0000;">环境</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><strong>首先在</strong><strong>ubuntu</strong><strong>的</strong><strong>hadoop</strong><strong>用户下创建一个</strong><strong>Downloads</strong><strong>的文件夹用于存放</strong><strong>JDK</strong><strong>的压缩包</strong></p> 
<p style="margin-left:0;text-align:justify;"><strong>JDK</strong><strong>文件使用</strong><strong>FileZilla</strong><strong>传输到虚拟机</strong><strong>Ubuntu</strong><strong>里刚创建的</strong><strong>Downloads</strong><strong>文件夹下</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="319" src="https://images2.imgbox.com/49/0e/lMX6c4U6_o.png" width="881"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="641" src="https://images2.imgbox.com/3a/44/zsg2lyZI_o.png" width="1173"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="51" src="https://images2.imgbox.com/49/49/kqQUgtfN_o.png" width="443"></p> 
<p style="margin-left:0;text-align:justify;"><strong>然后接着创建在</strong><strong>/usr/lib</strong><strong>目录下创建一个</strong><strong>jvm</strong><strong>的文件夹，将刚才</strong><strong>Downloads</strong><strong>目录里的</strong><strong>JDK</strong><strong>压缩包解压到</strong><strong>jvm</strong><strong>目录下</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="517" src="https://images2.imgbox.com/20/de/HdsmNdlL_o.png" width="901"></p> 
<p style="margin-left:0;text-align:justify;"><strong>JDK</strong><strong>文件解压后使用</strong><strong>cd  /usr/lib/jvm</strong><strong>进入</strong><strong>jvm</strong><strong>的目录，再</strong><strong>ls</strong><strong>命令查看一下解压后的情况</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="72" src="https://images2.imgbox.com/d1/e7/jGqThyP9_o.png" width="590"></p> 
<p style="margin-left:0;text-align:justify;"><strong>接着使用</strong><strong>vim</strong><strong>编辑器将以下内容添加到</strong><strong>hadoop</strong><strong>用户的环境变量配置文件中</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="199" src="https://images2.imgbox.com/c7/9e/HJVXyQ5U_o.png" width="905"></p> 
<p style="margin-left:0;text-align:justify;"><strong>保存</strong><strong>.bashrc</strong><strong>文件并退出</strong><strong>vim</strong><strong>编辑器。然后，继续执行</strong><strong>source ~/.bashrc</strong><strong>命令让配置生效，之后使用</strong><strong>java  -version</strong><strong>命令查看是否成功安装</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="105" src="https://images2.imgbox.com/50/5f/HPDk1crQ_o.png" width="799"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#FF0000;">4. </span></strong><strong><span style="color:#FF0000;">安装</span></strong><strong><span style="color:#FF0000;">Hadoop 2</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><strong>   </strong><strong>首先通过</strong><strong>FileZilla</strong><strong>把</strong><strong>Hadoop</strong><strong>文件传输到</strong><strong>Ubuntu</strong><strong>里</strong><strong>hadoop</strong><strong>用户下的“</strong><strong>Downloads</strong><strong>”文件夹目录下</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="338" src="https://images2.imgbox.com/b8/8b/0AOkSFNR_o.png" width="592"></p> 
<p style="margin-left:0;text-align:justify;"><strong>接着将</strong><strong>Hadoop</strong><strong>解压到</strong><strong>/usr/local/</strong><strong>里，并查看确认是否解压成功</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="140" src="https://images2.imgbox.com/e2/e3/wYSXAA4E_o.png" width="907"></p> 
<p style="margin-left:0;text-align:justify;"><strong>解压后将文件夹名改为</strong><strong> hadoop </strong><strong>并修改文件权限</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="95" src="https://images2.imgbox.com/9d/fa/EWNdCWNR_o.png" width="809"></p> 
<p style="margin-left:0;text-align:justify;"><strong>最后输入以下命令检查</strong><strong>Hadoop</strong><strong>是否可用，可用则会显示</strong><strong>hadoop</strong><strong>的版本信息</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="225" src="https://images2.imgbox.com/f5/13/FfY8jtPn_o.png" width="899"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#FF0000;">5. Hadoop</span></strong><strong><span style="color:#FF0000;">伪分布式配置</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><strong>Hadoop </strong><strong>可以在单节点上以伪分布式的方式运行，</strong><strong>Hadoop </strong><strong>进程以分离的</strong><strong> Java </strong><strong>进程来运行，节点既作为</strong><strong> NameNode </strong><strong>也作为</strong><strong> DataNode</strong><strong>，同时，读取的是</strong><strong> HDFS </strong><strong>中的文件。</strong></p> 
<p style="margin-left:0;text-align:justify;"><strong>Hadoop </strong><strong>的配置文件位于</strong><strong> /usr/local/hadoop/etc/hadoop/ </strong><strong>中，伪分布式需要修改</strong><strong>2</strong><strong>个配置文件</strong><strong> </strong><strong>core-site.xml</strong><strong> </strong><strong>和</strong><strong> </strong><strong>hdfs-site.xml</strong><strong> </strong><strong>。</strong><strong>Hadoop</strong><strong>的配置文件是</strong><strong> xml </strong><strong>格式，每个配置以声明</strong><strong> property </strong><strong>的</strong><strong> name </strong><strong>和</strong><strong> value </strong><strong>的方式来实现。</strong></p> 
<p style="margin-left:0;text-align:justify;"><strong>通过</strong><strong> gedit </strong><strong>编辑修改配置文件</strong><strong> </strong><strong>core-site.xml</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="659" src="https://images2.imgbox.com/fd/15/XpcXGnm3_o.png" width="802"></p> 
<p style="margin-left:0;text-align:justify;"><strong>同样通过</strong><strong> gedit </strong><strong>编辑修改配置文件</strong><strong> hdfs-site.xml</strong><strong>后保存退出</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="622" src="https://images2.imgbox.com/6b/20/g3B8bLJo_o.png" width="798"></p> 
<p style="margin-left:0;text-align:justify;"><strong>配置完成后，执行</strong><strong> NameNode </strong><strong>的格式化</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="160" src="https://images2.imgbox.com/92/94/cTFpHMcj_o.png" width="810"></p> 
<p style="margin-left:0;text-align:justify;"><strong>完成后开启</strong><strong> </strong><strong>NameNode </strong><strong>和</strong><strong> DataNode </strong><strong>守护进程，此刻会出现</strong><strong>SSH</strong><strong>提示，输入</strong><strong>yes</strong><strong>即可</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="228" src="https://images2.imgbox.com/96/96/knkcPzSa_o.png" width="1143"></p> 
<p style="margin-left:0;text-align:justify;"><strong>启动完成后通过命令</strong><strong>jps</strong><strong>来判断是否成功开启，若成功启动则会列出如下进程</strong><strong>: </strong><strong>“</strong><strong>NameNode</strong><strong>”</strong><strong>、</strong><strong>”</strong><strong>DataNode</strong><strong>”</strong><strong> </strong><strong>和</strong><strong> </strong><strong>“</strong><strong>SecondaryNameNode</strong><strong>”</strong><strong>，以下显示表明已经成功开启！！！<span style="color:#0070c0;">（如果没有显示</span></strong><strong><span style="color:#0070c0;">“</span></strong><strong><span style="color:#0070c0;">SecondaryNameNode</span></strong><strong><span style="color:#0070c0;">”</span></strong><strong><span style="color:#0070c0;">这一项则需要运行</span></strong><strong><span style="color:#0070c0;"> sbin/stop-dfs.sh </span></strong><strong><span style="color:#0070c0;">命令关闭进程，然后运行</span></strong><strong><span style="color:#0070c0;">sbin/start-dfs.sh</span></strong><strong><span style="color:#0070c0;">命令重启尝试）</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="123" src="https://images2.imgbox.com/bc/64/QsTun3Vw_o.png" width="563"></p> 
<p style="margin-left:0;text-align:justify;"><strong>成功启动后打开浏览器在地址栏输入</strong><span style="color:#000000;"><a href="http://localhost:50070/" rel="nofollow" title="http://localhost:50070">http://localhost:50070</a></span><strong>进入</strong><strong>Web</strong><strong>界面可浏览相关信息以及在线查看</strong><strong>HDFS</strong><strong>里的文件。</strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="528" src="https://images2.imgbox.com/b3/06/RrUmLUiZ_o.png" width="934"></p> 
<h2 style="margin-left:0px;text-align:justify;">第二步完成JAVA API与HDFS的交互：</h2> 
<p></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#FF0000;">1. </span></strong><strong><span style="color:#FF0000;">在</span></strong><strong><span style="color:#FF0000;">Ubuntu</span></strong><strong><span style="color:#FF0000;">中安装</span></strong><strong><span style="color:#FF0000;">Eclipse</span></strong></p> 
<p style="margin-left:0;text-align:justify;">在左侧应用栏打开软件中心并搜索eclipse进行下载应用</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="606" src="https://images2.imgbox.com/cf/c7/vnTv23lH_o.png" width="975"></p> 
<p style="margin-left:0;text-align:justify;">下载完成打开运行安装</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="509" src="https://images2.imgbox.com/78/d0/C9AMXjMK_o.png" width="971"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#FF0000;">2. </span></strong><strong><span style="color:#FF0000;">在</span></strong><strong><span style="color:#FF0000;">Eclipse</span></strong><strong><span style="color:#FF0000;">创建项目</span></strong></p> 
<p style="margin-left:0;text-align:justify;">打开安装好的eclipse软件</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="768" src="https://images2.imgbox.com/be/5a/9L3A5iYI_o.png" width="1022"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">选择“Project-New Java Project”，开始创建一个Java工程</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="879" src="https://images2.imgbox.com/60/c2/0AoGo5ze_o.png" width="700"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#FF0000;">3. </span></strong><strong><span style="color:#FF0000;">为项目添加需要用到的</span></strong><strong><span style="color:#FF0000;">JAR</span></strong><strong><span style="color:#FF0000;">包</span></strong></p> 
<p style="margin-left:0;text-align:justify;">点击next进入下一步，右侧点击Add External JARs..按钮进行选择添加如下所需的JAR包，使其编写一个能够与HDFS交互的Java应用程序</p> 
<p style="margin-left:0;text-align:justify;">/usr/local/hadoop/share/hadoop/common”目录下hadoop-common-2.10.0.jar和haoop-nfs-2.10.0.jar；</p> 
<p style="margin-left:0;text-align:justify;">/usr/local/hadoop/share/hadoop/common/lib”目录下的所有JAR包；</p> 
<p style="margin-left:0;text-align:justify;">/usr/local/hadoop/share/hadoop/hdfs”目录下的haoop-hdfs-2.10.0.jar和haoop-hdfs-nfs-2.10.0.jar；</p> 
<p style="margin-left:0;text-align:justify;">“/usr/local/hadoop/share/hadoop/hdfs/lib”目录下的所有JAR包</p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#FF0000;">全部选择完成后先检查核对一遍名称和目录是否有遗漏或者选错，无误后再点击</span><span style="color:#FF0000;">Finish</span><span style="color:#FF0000;">完成</span></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="850" src="https://images2.imgbox.com/d4/f3/BshodG8h_o.png" width="1038"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#FF0000;">4. </span></strong><strong><span style="color:#FF0000;">编写</span></strong><strong><span style="color:#FF0000;">Java</span></strong><strong><span style="color:#FF0000;">应用程序代码</span></strong></p> 
<p style="margin-left:0;text-align:justify;">找到刚才创建好的工程名称“HDFSExample”，然后在该工程名称上点击鼠标右键，在弹出的菜单中选择“New-Class”菜单</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="778" src="https://images2.imgbox.com/d3/31/4HtblWu0_o.png" width="1015"></p> 
<p style="margin-left:0;text-align:justify;">在name中输入新建的JAVA类文件的名称，如此次使用名称为“HDFSFileIfExist”,其他采用默认设置，完成后点击Finish</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="758" src="https://images2.imgbox.com/fa/7b/LV6WyCg8_o.png" width="707"></p> 
<p style="margin-left:0;text-align:justify;">在新创建的名为 DFSFileIfExist.java 的源代码文件中输入一下代码，其中有一行代码为String fileNmae =“test”是测试HDFS中的“/user/hadoop/”目录下是否存在test文件。</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="768" src="https://images2.imgbox.com/9b/34/LR4KyqdX_o.png" width="1018"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#FF0000;">5. </span></strong><strong><span style="color:#FF0000;">编译运行程序</span></strong></p> 
<p style="margin-left:0;text-align:justify;">在编译代码运行之前先确保hadoop已成功开启</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="242" src="https://images2.imgbox.com/37/d6/jnwXZwQQ_o.png" width="723"></p> 
<p style="margin-left:0;text-align:justify;">接着开始编译运行代码</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="783" src="https://images2.imgbox.com/54/da/kORYaFKP_o.png" width="1028"></p> 
<p style="margin-left:0;text-align:justify;">运行结束后结果显示“文件不存在”是由于目前HDFS的“/user/hadoop”目录下还没有test文件</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="211" src="https://images2.imgbox.com/6a/2c/YHGZRqVa_o.png" width="750"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#FF0000;">6. </span></strong><strong><span style="color:#FF0000;">应用程序的部署</span></strong></p> 
<p style="margin-left:0;text-align:justify;">将Java应用程序生成JAR包，部署到Hadoop平台上运行。首先，在Hadoop安装目录下新建一个名称为myapp的目录，用来存放我们自己编写的Hadoop应用程序</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="118" src="https://images2.imgbox.com/d3/53/2PP4rCQE_o.png" width="722"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">然后在左侧Package Explorer栏中，右键名为“HDFSExample”的工程，弹出的菜单点击选择“Export”</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="755" src="https://images2.imgbox.com/74/a5/1887Ey7W_o.png" width="785"></p> 
<p></p> 
<p style="margin-left:0;text-align:justify;">弹出窗口中依次选择Java-Runnable JAR file</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="538" src="https://images2.imgbox.com/89/ce/wgYxlXjO_o.png" width="699"></p> 
<p style="margin-left:0;text-align:justify;">选择刚配置的类HDFSFileIfExist-HDFSExample，然后选择设置JAR包输出保存的目录</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="465" src="https://images2.imgbox.com/1e/0f/KWWrThSW_o.png" width="562"></p> 
<p></p> 
<p style="margin-left:0;text-align:justify;">在Ubuntu终端窗口中查看一下生成的HDFSExample.jar文件</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="130" src="https://images2.imgbox.com/ad/41/DOPjNVPa_o.png" width="646"></p> 
<p style="margin-left:0;text-align:justify;">使用hadoop jar命令运行程序,成功则提示刚JAVA运行的结果“文件不存在”，同时也印证了部署成功</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="133" src="https://images2.imgbox.com/a0/d5/iumuQeGc_o.png" width="722"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#FF0000;">7. </span></strong><strong><span style="color:#FF0000;">写入文件</span></strong><strong><span style="color:#FF0000;">test</span></strong></p> 
<p style="margin-left:0;text-align:justify;">创建一个名为“HDFSFileWriteIn”的源代码文件并编写输入以下代码创建test文件,<span style="color:#FF0000;">定义的类名要与源文件名保持一致！</span></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="761" src="https://images2.imgbox.com/e2/85/7IjkNwrX_o.png" width="844"></p> 
<p></p> 
<p style="margin-left:0;text-align:justify;">再次在终端窗口下使用hadoop jar命令运行名为HDFSFileIfExist那个程序，此时test文件已显示存在</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="153" src="https://images2.imgbox.com/04/87/QX33GksI_o.png" width="726"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#FF0000;">8.</span></strong><strong><span style="color:#FF0000;">读取文件</span></strong></p> 
<p style="margin-left:0;text-align:justify;">创建一个名为“HDFSFileRead”的源代码文件，并编写输入以下代码实现读取test文件中内容</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="732" src="https://images2.imgbox.com/20/86/wVWEOHgf_o.png" width="803"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">最后将该代码文件打包成JAR包在Ubuntu命令窗口下运行并读取test文件中的内容，结果显示“Hello World”成功读取</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="143" src="https://images2.imgbox.com/79/da/iGnmypqf_o.png" width="700"></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="43" src="https://images2.imgbox.com/5f/74/X4W5JDmE_o.png" width="469"></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="151" src="https://images2.imgbox.com/e5/09/uRxiPHND_o.png" width="688"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h2 style="margin-left:0px;text-align:justify;">第三步就是文章此次的重头戏也是最终的目的</h2> 
<h2 style="margin-left:0px;text-align:justify;">调用MapReduce对文件中各个单词出现的次数进行统计：</h2> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#000000;">数据来源及数据上传</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#000000;">1. </span><span style="color:#000000;">首先在任意一个英文</span><span style="color:#000000;">pdf</span><span style="color:#000000;">电子书上下载一本电子书，并摘取其中几章作为本次作业的素材文件，素材文本符合要求达一万单词量以上，最终素材文本格式转为</span><span style="color:#000000;">txt</span><span style="color:#000000;">文本格式待用，文件命名为</span><span style="color:#000000;">why.txt</span><span style="color:#000000;">。</span></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="1013" src="https://images2.imgbox.com/36/1d/OUnupLNm_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#000000;">2. </span><span style="color:#000000;">将本地主机准备好的英文素材</span><span style="color:#000000;">why.txt</span><span style="color:#000000;">文本通过</span><span style="color:#000000;">Firezilla</span><span style="color:#000000;">文件传输软件传输到虚拟机</span><span style="color:#000000;">Ubuntu</span><span style="color:#000000;">的</span><span style="color:#000000;">hadoop</span><span style="color:#000000;">文件夹中</span></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="970" src="https://images2.imgbox.com/2c/dc/gnVCwI8g_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#000000;">3. </span><span style="color:#000000;">在</span><span style="color:#000000;">Ubuntu</span><span style="color:#000000;">系统终端窗口下查看</span><span style="color:#000000;">/home/hadoop</span><span style="color:#000000;">文件夹是否存在</span><span style="color:#000000;">why.txt</span></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="143" src="https://images2.imgbox.com/5a/db/kmYNoh2E_o.png" width="726"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#000000;">四、数据上传结果查看</span></strong></p> 
<p style="margin-left:0;text-align:justify;">1. 开启hadoop，将why.txt文本上传到HDFS中的input文件夹中</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="417" src="https://images2.imgbox.com/13/8e/UZcTwsd2_o.png" width="876"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#000000;">五、数据处理过程的描述</span></strong></p> 
<p style="margin-left:0;text-align:justify;">1. 打开eclipse</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="367" src="https://images2.imgbox.com/75/06/XCeBbmsI_o.png" width="1192"></p> 
<p style="margin-left:0;text-align:justify;">2. 创建MapReduce项目</p> 
<p style="margin-left:0;text-align:justify;">在创建MapReduce Project项目时，填写 Project name 为 WordCount 即可，点击 Finish 就创建好了项目</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="488" src="https://images2.imgbox.com/18/2b/5dThMWVq_o.png" width="1068"></p> 
<p style="margin-left:0;text-align:justify;">此时在左侧的 Project Explorer 就能看到刚才建立的项目了。</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="844" src="https://images2.imgbox.com/d9/59/lu3RmBgN_o.png" width="674"></p> 
<p style="margin-left:0;text-align:justify;">接着右键点击刚创建的 WordCount 项目，选择 New -&gt; Class, 需要填写两个地方：在 Package 处填写 org.apache.hadoop.examples；在 Name 处填写 WordCount</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="811" src="https://images2.imgbox.com/97/af/Tc3l9Tbp_o.png" width="868"></p> 
<p style="margin-left:0;text-align:justify;">清空WordCount.java里的所有代码，把以下完整的词频统计的程序代码输入到当中去：</p> 
<div> 
 <p style="margin-left:0;text-align:justify;">package org.apache.hadoop.example;</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">import java.io.IOException;</p> 
 <p style="margin-left:0;text-align:justify;">import java.util.Iterator;</p> 
 <p style="margin-left:0;text-align:justify;">import java.util.StringTokenizer;</p> 
 <p style="margin-left:0;text-align:justify;">import org.apache.hadoop.conf.Configuration;</p> 
 <p style="margin-left:0;text-align:justify;">import org.apache.hadoop.fs.Path;</p> 
 <p style="margin-left:0;text-align:justify;">import org.apache.hadoop.io.IntWritable;</p> 
 <p style="margin-left:0;text-align:justify;">import org.apache.hadoop.io.Text;</p> 
 <p style="margin-left:0;text-align:justify;">import org.apache.hadoop.mapreduce.Job;</p> 
 <p style="margin-left:0;text-align:justify;">import org.apache.hadoop.mapreduce.Mapper;</p> 
 <p style="margin-left:0;text-align:justify;">import org.apache.hadoop.mapreduce.Reducer;</p> 
 <p style="margin-left:0;text-align:justify;">import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</p> 
 <p style="margin-left:0;text-align:justify;">import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</p> 
 <p style="margin-left:0;text-align:justify;">import org.apache.hadoop.util.GenericOptionsParser;</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">public class WordCount {<!-- --></p> 
 <p style="margin-left:0;text-align:justify;">    public WordCount() {<!-- --></p> 
 <p style="margin-left:0;text-align:justify;">    }</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">    public static void main(String[] args) throws Exception {<!-- --></p> 
 <p style="margin-left:0;text-align:justify;">        Configuration conf = new Configuration();</p> 
 <p style="margin-left:0;text-align:justify;">        String[] otherArgs = (new GenericOptionsParser(conf, args)).getRemainingArgs();</p> 
 <p style="margin-left:0;text-align:justify;">        if(otherArgs.length &lt; 2) {<!-- --></p> 
 <p style="margin-left:0;text-align:justify;">            System.err.println("Usage: wordcount &lt;in&gt; [&lt;in&gt;...] &lt;out&gt;");</p> 
 <p style="margin-left:0;text-align:justify;">            System.exit(2);</p> 
 <p style="margin-left:0;text-align:justify;">        }</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">        Job job = Job.getInstance(conf, "word count");</p> 
 <p style="margin-left:0;text-align:justify;">        job.setJarByClass(WordCount.class);</p> 
 <p style="margin-left:0;text-align:justify;">        job.setMapperClass(WordCount.TokenizerMapper.class);</p> 
 <p style="margin-left:0;text-align:justify;">        job.setCombinerClass(WordCount.IntSumReducer.class);</p> 
 <p style="margin-left:0;text-align:justify;">        job.setReducerClass(WordCount.IntSumReducer.class);</p> 
 <p style="margin-left:0;text-align:justify;">        job.setOutputKeyClass(Text.class);</p> 
 <p style="margin-left:0;text-align:justify;">        job.setOutputValueClass(IntWritable.class);</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">        for(int i = 0; i &lt; otherArgs.length - 1; ++i) {<!-- --></p> 
 <p style="margin-left:0;text-align:justify;">            FileInputFormat.addInputPath(job, new Path(otherArgs[i]));</p> 
 <p style="margin-left:0;text-align:justify;">        }</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">        FileOutputFormat.setOutputPath(job, new Path(otherArgs[otherArgs.length - 1]));</p> 
 <p style="margin-left:0;text-align:justify;">        System.exit(job.waitForCompletion(true)?0:1);</p> 
 <p style="margin-left:0;text-align:justify;">    }</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">    public static class IntSumReducer extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {<!-- --></p> 
 <p style="margin-left:0;text-align:justify;">        private IntWritable result = new IntWritable();</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">        public IntSumReducer() {<!-- --></p> 
 <p style="margin-left:0;text-align:justify;">        }</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">        public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Reducer&lt;Text, IntWritable, Text, IntWritable&gt;.Context context) throws IOException, InterruptedException {<!-- --></p> 
 <p style="margin-left:0;text-align:justify;">            int sum = 0;</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">            IntWritable val;</p> 
 <p style="margin-left:0;text-align:justify;">            for(Iterator i$ = values.iterator(); i$.hasNext(); sum += val.get()) {<!-- --></p> 
 <p style="margin-left:0;text-align:justify;">                val = (IntWritable)i$.next();</p> 
 <p style="margin-left:0;text-align:justify;">            }</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">            this.result.set(sum);</p> 
 <p style="margin-left:0;text-align:justify;">            context.write(key, this.result);</p> 
 <p style="margin-left:0;text-align:justify;">        }</p> 
 <p style="margin-left:0;text-align:justify;">    }</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">    public static class TokenizerMapper extends Mapper&lt;Object, Text, Text, IntWritable&gt; {<!-- --></p> 
 <p style="margin-left:0;text-align:justify;">        private static final IntWritable one = new IntWritable(1);</p> 
 <p style="margin-left:0;text-align:justify;">        private Text word = new Text();</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">        public TokenizerMapper() {<!-- --></p> 
 <p style="margin-left:0;text-align:justify;">        }</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">        public void map(Object key, Text value, Mapper&lt;Object, Text, Text, IntWritable&gt;.Context context) throws IOException, InterruptedException {<!-- --></p> 
 <p style="margin-left:0;text-align:justify;">            StringTokenizer itr = new StringTokenizer(value.toString());</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">            while(itr.hasMoreTokens()) {<!-- --></p> 
 <p style="margin-left:0;text-align:justify;">                this.word.set(itr.nextToken());</p> 
 <p style="margin-left:0;text-align:justify;">                context.write(this.word, one);</p> 
 <p style="margin-left:0;text-align:justify;">            }</p> 
 <p style="margin-left:0;text-align:justify;"></p> 
 <p style="margin-left:0;text-align:justify;">        }</p> 
 <p style="margin-left:0;text-align:justify;">    }</p> 
 <p style="margin-left:0;text-align:justify;">}</p> 
</div> 
<p style="margin-left:0;text-align:left;"></p> 
<p style="margin-left:0;text-align:left;">输入完成后按“Run As”运行，选择“Java Application”</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="377" src="https://images2.imgbox.com/7b/19/6cCWKF8N_o.png" width="657"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">在弹出的窗口中点击ok</p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="556" src="https://images2.imgbox.com/ca/4d/StbwYxeY_o.png" width="799"></p> 
<p style="margin-left:0;text-align:left;">程序运行结束后，在底部的Console面版中查看运行结果：</p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="259" src="https://images2.imgbox.com/ce/f7/0kAksc7l_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:justify;">接下来把java程序打包成JAR包部署到Hadoop上运行，程序存放位置在“/usr/local/Hadoop/myapp”目录下，myapp自行创建：</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">cd /usr/local/Hadoop</p> 
<p style="margin-left:0;text-align:justify;">mkdir myapp</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="78" src="https://images2.imgbox.com/1c/1f/q49coH6b_o.png" width="794"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">右键左侧“package Explorer”面板，在工程名称“WorldCount”中右键选择“Export”，接着在弹出的窗口下依次选择Java-&gt;Runnable JAR file</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="664" src="https://images2.imgbox.com/32/16/bYf1Q1mD_o.png" width="866"></p> 
<p style="margin-left:0;text-align:justify;">“Launch configuration”这个选项是用于设置生成的JAR包启动运行时的主类，在这里下拉列表选择刚配置的类“WordCount-WordCount”。在“Export destination”这个选项中需要设置的是JAR包输出的目录，此次则输入本次作业中的目录“/usr/local/Hadoop/myapp/WordCount.jar”。在“Library handing”中下拉选择“Extract required libraries into generated JAR”。最后点击finish完成。</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="719" src="https://images2.imgbox.com/77/5f/hSWoZ59h_o.png" width="869"></p> 
<p style="margin-left:0;text-align:justify;">在弹出来的警告窗口中，点击OK忽略。</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="332" src="https://images2.imgbox.com/4c/91/WKcxMM3t_o.png" width="866"></p> 
<p style="margin-left:0;text-align:justify;">等待进度条加载完成再次啊点击弹出来的警告窗口OK忽略，至此就已经把WordCount工程打包生成WordCount.jar。</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="246" src="https://images2.imgbox.com/99/92/BXrpPxYT_o.png" width="883"></p> 
<p style="margin-left:0;text-align:justify;">在myapp目录下可以看到WordCount.jar的包已经生成。</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="58" src="https://images2.imgbox.com/56/bf/va8hUCGV_o.png" width="702"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#000000;">六、处理结果的下载及命令行展示</span></strong></p> 
<p style="margin-left:0;text-align:justify;">使用hadoop jar命令运行</p> 
<p style="margin-left:0;text-align:justify;">cd /usr/local/Hadoop</p> 
<p style="margin-left:0;text-align:justify;">./bin/Hadoop jar ./myapp/WordCount.jar <span style="color:#FF0000;">/user/Hadoop/input /user/Hadoop/output1</span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#000000;">input</span><span style="color:#000000;">和output目录地址要根据自己设定的进行命令配置,这里的output因为在占用着不方便作为输出文件夹，所以再另创一个output1进行结果输出。</span></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="851" src="https://images2.imgbox.com/73/1e/djf0q67L_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:justify;">运行命令./bin/hdfs dfs -cat user/Hadoop/output1/part-r-0000进行查看输出结果。</p> 
<p style="margin-left:0;text-align:justify;">部分结果展示：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="739" src="https://images2.imgbox.com/82/b2/2ew9059K_o.png" width="903"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">将output文件夹下载至本地：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="60" src="https://images2.imgbox.com/cd/39/4Kw2qdrf_o.png" width="917"></p> 
<p style="margin-left:0;text-align:justify;">查看part-r-00000文件:</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="895" src="https://images2.imgbox.com/66/c0/WUOr6G4Y_o.png" width="1048"></p> 
<p style="margin-left:0;text-align:justify;">此次使用MapReduce对指定文本进行单词的词频统计就到此结束啦！你学会了吗，赶紧去试试吧！</p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e5b773b3933a63f95c9bcacb04533a88/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">selenium driver关闭</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e1595db51907e991409d5f3c02631859/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">TFTP与FTP的区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>