<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>nginx反向代理出现WebSocket connection failed 如何解决 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="nginx反向代理出现WebSocket connection failed 如何解决" />
<meta property="og:description" content="WebSocket WebSocket 是一种用于在 Web 应用程序中进行实时双向通信的技术。WebSocket 协议允许客户端和服务器在一个 TCP 连接上进行交换数据。这使得在 Web 上实现实时通信变得更容易。
使用 WebSocket，客户端和服务器之间可以双向通信，因此服务器可以主动向客户端发送更新，而不需要等待客户端请求。这与传统的 HTTP 请求-响应模型非常不同，因为在 HTTP 中，客户端必须发送请求以获取更新。
WebSocket 是 HTML5 的一部分，并由 W3C 规范管理。现代 Web 浏览器通常支持 WebSocket 技术，包括 Chrome，Firefox，Safari 和 Edge。常见的使用 WebSocket 的应用程序包括聊天应用程序，实时协作工具以及在线游戏。
&#39;WebSocket connection failed&#39; 通常表示 Nginx 服务器的 WebSocket 配置有问题。
正确配置 Nginx 服务器以支持 WebSocket 可以解决此问题。
第一步：检查 Nginx 的版本是否支持 WebSocket。如果你的版本是 1.3 或更高版本，则支持 WebSocket。第二步：编辑你的Nginx配置文件。你应该在nginx.conf文件的server块中找到以下一行配置。 location / { # ... } 第三步：添加以下配置行以启用 WebSocket 支持：
proxy_pass 向代理服务器发送 WebSocket 流量（upstream 为目标网址）proxy_http_version 将请求协议版本设置为1.1Upgrade 头的值设置为 $http_upgrade，该值为所有带有 &#39;Upgrade&#39; 标题的请求头Connection 头的值设置为 &#39;upgrade&#39;,以指示连接已经成功升级 location / { proxy_pass http: //your_upstream; proxy_http_version 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/5fec05937131dc025cbcb1188ecf6ff3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-24T13:18:48+08:00" />
<meta property="article:modified_time" content="2024-01-24T13:18:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">nginx反向代理出现WebSocket connection failed 如何解决</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 id="websocket"><strong>WebSocket</strong></h3> 
<p><img alt="" height="800" src="https://images2.imgbox.com/ac/86/yM40TmCc_o.png" width="867"></p> 
<p><a href="https://apifox.com/apiskills/what-is-websocket/" rel="nofollow" title="WebSocket">WebSocket</a> 是一种用于在 Web 应用程序中进行实时双向通信的技术。WebSocket 协议允许客户端和服务器在一个 TCP 连接上进行交换数据。这使得在 Web 上实现实时通信变得更容易。</p> 
<p>使用 WebSocket，客户端和服务器之间可以双向通信，因此服务器可以主动向客户端发送更新，而不需要等待客户端请求。这与传统的 HTTP 请求-响应模型非常不同，因为在 HTTP 中，客户端必须发送请求以获取更新。</p> 
<p>WebSocket 是 HTML5 的一部分，并由 W3C 规范管理。现代 Web 浏览器通常支持 WebSocket 技术，包括 Chrome，Firefox，Safari 和 Edge。常见的使用 WebSocket 的应用程序包括聊天应用程序，实时协作工具以及在线游戏。</p> 
<p><img alt="" height="291" src="https://images2.imgbox.com/d3/f1/YB4VPTgo_o.png" width="1200"></p> 
<p> </p> 
<p><strong>'WebSocket connection failed' 通常表示 Nginx 服务器的 WebSocket 配置有问题</strong>。</p> 
<p>正确配置 Nginx 服务器以支持 WebSocket 可以解决此问题。</p> 
<ul><li>第一步：检查 Nginx 的版本是否支持 WebSocket。如果你的版本是 1.3 或更高版本，则支持 WebSocket。</li><li>第二步：编辑你的Nginx配置文件。你应该在nginx.conf文件的server块中找到以下一行配置。</li></ul> 
<pre><code>location / {
    # ...
}
</code></pre> 
<p>第三步：添加以下配置行以启用 WebSocket 支持：</p> 
<ul><li>proxy_pass 向代理服务器发送 WebSocket 流量（upstream 为目标网址）</li><li>proxy_http_version 将请求协议版本设置为1.1</li><li>Upgrade 头的值设置为 $http_upgrade，该值为所有带有 'Upgrade' 标题的请求头</li><li>Connection 头的值设置为 'upgrade',以指示连接已经成功升级</li></ul> 
<pre><code>location / {
    proxy_pass http: //your_upstream;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_read_timeout 86400;
}
</code></pre> 
<ul><li>第四步：保存并退出配置文件，并重新启动Nginx服务，以便使更改生效。</li><li>第五步：确认你已正确配置 Nginx WebSocket 设置。可以使用以下命令检查 Nginx 是否已配置为支持 WebSocket。</li></ul> 
<pre><code>$ nginx -t
</code></pre> 
<ul><li>第六步：如果命令显示 “OK”，则 WebSocket 已正确配置。如果命令显示错误，请检查并修复你的配置文件。</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/97fbc6809c414facc270559f6c7e0879/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python学习从0到1 day8 Python循环语句</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e90946a29811115f8bd54d3b3bb1865e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">获取当前时间格式化</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>