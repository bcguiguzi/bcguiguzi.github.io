<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>文件管理简介 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="文件管理简介" />
<meta property="og:description" content="文件管理 文件介绍 FHS Filesystem Hierarchy Standard 文件系统目录标准 文件特点 一切皆文件文件名严格区分大小写 Linux文件类型 普通文件(文本文件,二进制文件,压缩文件,视频,图片…)
d
目录文件（蓝色） b
块设备文件（存储设备硬盘，U盘 /dev/sda, /dev/sda1） c
字符设备文件（打印机，终端 /dev/tty1, /dev/zero） l
链接文件（淡蓝色） s
套接字文件 p
管道文件 目录结构 特点
linux
以单根的方式组织文件 /倒立的树状结构 Windows
以多根的方式组织文件 C：\ D：\ E：\ 常见目录
/
根目录，linux最顶级的目录 /bin
存放的是系统的命令,用户命令 /sbin
存放的是管理命令 /boot
存放的是系统的启动文件及内核 /dev
设备文件目录 /etc
配置文件目录 /root
超级管理员的家目录 /home
普通用户的家目录 /lib
系统库文件主目录 /media
挂载点目录，移动设备 /mnt
挂载点目录 /opt
可选目录，第三方程序的安装目录 /proc
虚拟的文件系统，反映出来的是内核，进程信息或实时状态 /sys
跟硬件设备相关的属性映射文件 /run
与程序运行相关的信息,如进程号,套接字文件等 /tmp" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/25749acc51ef160062baaebde0a5106a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-12T23:45:01+08:00" />
<meta property="article:modified_time" content="2022-09-12T23:45:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">文件管理简介</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>文件管理</h2> 
<h3><a id="_2"></a>文件介绍</h3> 
<h4><a id="FHS_4"></a>FHS</h4> 
<ul><li>Filesystem Hierarchy Standard 文件系统目录标准</li></ul> 
<h4><a id="_8"></a>文件特点</h4> 
<ul><li>一切皆文件</li><li>文件名严格区分大小写</li></ul> 
<h4><a id="Linux_13"></a>Linux文件类型</h4> 
<ul><li> 
  <ul><li><li> <p>普通文件(文本文件,二进制文件,压缩文件,视频,图片…)</p> </li></ul> </li><li> <p>d</p> 
  <ul><li>目录文件（蓝色）</li></ul> </li><li> <p>b</p> 
  <ul><li>块设备文件（存储设备硬盘，U盘 /dev/sda, /dev/sda1）</li></ul> </li><li> <p>c</p> 
  <ul><li>字符设备文件（打印机，终端 /dev/tty1, /dev/zero）</li></ul> </li><li> <p>l</p> 
  <ul><li>链接文件（淡蓝色）</li></ul> </li><li> <p>s</p> 
  <ul><li>套接字文件</li></ul> </li><li> <p>p</p> 
  <ul><li>管道文件</li></ul> </li></ul> 
<h4><a id="_43"></a>目录结构</h4> 
<ul><li> <p>特点</p> 
  <ul><li> <p>linux</p> 
    <ul><li>以单根的方式组织文件 /</li><li>倒立的树状结构</li></ul> </li><li> <p>Windows</p> 
    <ul><li>以多根的方式组织文件 C：\ D：\ E：\</li></ul> </li></ul> </li><li> <p>常见目录</p> 
  <ul><li> <p>/</p> 
    <ul><li>根目录，linux最顶级的目录</li></ul> </li><li> <p>/bin</p> 
    <ul><li>存放的是系统的命令,用户命令</li></ul> </li><li> <p>/sbin</p> 
    <ul><li>存放的是管理命令</li></ul> </li><li> <p>/boot</p> 
    <ul><li>存放的是系统的启动文件及内核</li></ul> </li><li> <p>/dev</p> 
    <ul><li>设备文件目录</li></ul> </li><li> <p>/etc</p> 
    <ul><li>配置文件目录</li></ul> </li><li> <p>/root</p> 
    <ul><li>超级管理员的家目录</li></ul> </li><li> <p>/home</p> 
    <ul><li>普通用户的家目录</li></ul> </li><li> <p>/lib</p> 
    <ul><li>系统库文件主目录</li></ul> </li><li> <p>/media</p> 
    <ul><li>挂载点目录，移动设备</li></ul> </li><li> <p>/mnt</p> 
    <ul><li>挂载点目录</li></ul> </li><li> <p>/opt</p> 
    <ul><li>可选目录，第三方程序的安装目录</li></ul> </li><li> <p>/proc</p> 
    <ul><li>虚拟的文件系统，反映出来的是内核，进程信息或实时状态</li></ul> </li><li> <p>/sys</p> 
    <ul><li>跟硬件设备相关的属性映射文件</li></ul> </li><li> <p>/run</p> 
    <ul><li>与程序运行相关的信息,如进程号,套接字文件等</li></ul> </li><li> <p>/tmp</p> 
    <ul><li>临时文件目录, /var/tmp</li></ul> </li><li> <p>/var</p> 
    <ul><li>变化的数据文件目录；/var/log 日志文件</li></ul> </li><li> <p>/usr</p> 
    <ul><li>用户程序目录,包含二进制文件、库文件、文档和源码安装的程序等</li></ul> </li><li> <p>/usr/local</p> 
    <ul><li>软件安装的目录，相当于C：\Program</li></ul> </li></ul> </li><li> <p>路径切换：cd</p> 
  <ul><li>绝对路径：从根(/)开始的</li><li>相对路径：从当前路径开始的</li><li>cd / ：切换到根目录</li><li>cd - ：切换到上一次去过的目录</li><li>cd … ：切换到上一级目录，等同于cd …/</li><li>cd ：切换到当前用户的家目录等同于cd ~</li></ul> </li></ul> 
<h3><a id="_143"></a>文件基本操作</h3> 
<h4><a id="ls_145"></a>查询文件信息：ls</h4> 
<ul><li> <p>用法：ls [选项]… [文件]…</p> </li><li> <p>选项</p> 
  <ul><li> <p>-a 列出所有文件，包含隐藏文件（以"."开头）</p> </li><li> <p>-l 列出文件的详细信息，ls -l 等同于 ll</p> <p>详细信息内容：-rw-------. 1 root root 1241 2月 22 16：22 anaconda-ks.cfg<br> -： 文件类型<br> rw-------：文件权限<br> root：文件的所有者<br> root：文件的所属组<br> 1241：文件大小<br> 2月 22 16：22：时间<br> anaconda-ks.cfg：文件名</p> </li><li> <p>-lh 人性化显示，文件大小单位的换算。等同于 ll -h</p> </li><li> <p>-R 递归显示文件</p> </li><li> <p>-S 按文件大小排序</p> </li><li> <p>-s 查看大小</p> </li><li> <p>-t 按修改时间排序</p> </li><li> <p>-i 查看inode索引号</p> </li><li> <p>-d 查看目录文件</p> </li></ul> </li></ul> 
<h4><a id="_170"></a>查看文件内容</h4> 
<ul><li> <p>cat 文件名：查看文件全部内容，比较适合小文件</p> 
  <ul><li> <p>-n</p> 
    <ul><li>增加行号</li></ul> </li><li> <p>-A</p> 
    <ul><li>显示隐藏转义字符</li><li>\n显示$，\t显示<sup>|，\r显示</sup>M(回车)</li></ul> </li></ul> </li><li> <p>tac 文件名：倒序显示文件全部内容</p> </li><li> <p>head [-N] 文件名：查看文件的前N行，默认为前10行</p> </li><li> <p>tail</p> 
  <ul><li>tail [-N] 文件名：查看文件的后N行，默认为后10行</li><li>tailf 文件名：实时显示；tailf == tail -f（文件删除后中断显示）</li><li>tailf -F 文件名：实时显示（文件删除再创建后继续显示）</li></ul> </li><li> <p>grep [选项] 关键字 文件名：过滤查看文件</p> 
  <ul><li>-n 显示行号</li><li>-v 显示不匹配的行</li></ul> </li><li> <p>less 文件名：按页显示。空格翻页、enter翻行、方向键滚动、/查找</p> </li><li> <p>more -5 文件名#每页显示5行</p> <p>more +5 文件名#从第5行起显示more +/xx 文件#从第一个xx的前2行开始显示</p> </li></ul> 
<h4><a id="touch_200"></a>创建文件：touch</h4> 
<ul><li> <p>用法：touch [选项]… 文件…</p> </li><li> <p>示例</p> 
  <ul><li>touch file1.txt#无则创建，有则更新文件时间</li><li>touch /home/{zhuzhu,gougou} 相同路径部分可使用集合简化</li><li>touch file{1…20} 集合，批量创建</li></ul> </li></ul> 
<h4><a id="mkdir_209"></a>创建目录：mkdir</h4> 
<ul><li> <p>用法：mkdir [选项]… 目录…</p> </li><li> <p>选项</p> 
  <ul><li>-v：显示创建过程</li><li>-p：递归创建（父目录不存在则逐级创建，已存在不报错）</li></ul> </li><li> <p>示例</p> 
  <ul><li>mkdir /home/dir2 /home/dir3#在/home下创建目录dir2、dir3</li><li>mkdir /home/{dir4,dir5}#在/home下创建目录dir4、dir5</li><li>mkdir /home/dir{1…100}#在/home下创建目录dir1到dir100</li></ul> </li></ul> 
<h4><a id="cp_223"></a>复制：cp</h4> 
<ul><li> <p>用法：cp [选项]… 源… 目的（路径下加名字则重命名，无路径默认当前目录）</p> </li><li> <p>选项</p> 
  <ul><li> <p>-r</p> 
    <ul><li>递归复制文件和目录</li></ul> </li><li> <p>-v</p> 
    <ul><li>显示复制过程</li></ul> </li><li> <p>-f</p> 
    <ul><li>强制复制</li></ul> </li><li> <p>-i</p> 
    <ul><li>覆盖</li></ul> </li><li> <p>-p</p> 
    <ul><li>保留源文件或目录的所有属性</li></ul> </li><li> <p>-d</p> 
    <ul><li>当复制符号连接时，把目标文件或目录也建立为符号连接</li></ul> </li><li> <p>-a</p> 
    <ul><li>等价于“pdr”选项</li></ul> </li></ul> </li><li> <p>示例</p> 
  <ul><li>cp a.txt /home/b.txt#将当前目录下a.txt复制到/home下重命名为b.txt</li><li>cp -r a/b/c/a.1{,-123} #将路径/a/b/c下的a.1复制重命名a.1-123</li><li>cp -i /root/a.txt /a.txt#用/root/a.txt内容覆盖/a.txt内容</li></ul> </li></ul> 
<h4><a id="mv_262"></a>移动：mv</h4> 
<ul><li> <p>用法</p> 
  <ul><li>mv [选项]… 源… 目的</li><li>路径下加名字则重命名，无路径默认当前目录</li></ul> </li><li> <p>选项</p> 
  <ul><li>-v 详细过程</li></ul> </li><li> <p>示例</p> 
  <ul><li>mv file2 /home/file3#将当前目录下file2移动到/home下重命名为file3</li><li>mv file4 file5#将当前目录下file4重命名为file5</li><li>mv /home/{a,b}#将/home下a重命名为b</li></ul> </li></ul> 
<h4><a id="rm_279"></a>删除：rm</h4> 
<ul><li> <p>用法：rm [选项]… 文件…</p> </li><li> <p>选项</p> 
  <ul><li>-r 递归</li><li>-f force强制</li><li>-v 详细过程</li></ul> </li><li> <p>示例：rm -rfv /home/* #删除/home下所有文件（不包含隐藏文件）</p> </li></ul> 
<h3><a id="vivim_290"></a>vi/vim编辑器</h3> 
<p>vim 文件 默认先查看，不存在会自动创建（只能编辑文件，遇到目录要强制退出）</p> 
<h4><a id="_294"></a>命令模式</h4> 
<p>打开文件后进入的默认模式</p> 
<ul><li> <p>跳转</p> <p>^ 光标定位到第一个非空字符<br> $ 光标定位到行尾<br> Home/0 光标定位到行首<br> End/$ 光标定位到行尾<br> ​gg 光标定位到首行<br> Ngg 光标定位到第N行<br> G 光标定位到最后一行</p> </li><li> <p>复制-y</p> <p>​ yy 复制光标所在的行<br> Nyy 从光标所在的行开始，共复制N行<br> yG 复制从光标所在的行及下面所有的行<br> ygg 复制从第一行到光标所在的行<br> Nygg 复制从第N行到光标所在的行<br> ​ yHome 行内复制光标前(不包含光标)所有的内容<br> yEnd 行内复制光标后(包含光标)所有的内容<br> y^ 复制行首到光标<br> y$ 复制光标到行尾<br> yw 复制光标所在单词</p> </li><li> <p>删除（剪切）：d</p> 
  <ul><li>用法同复制</li></ul> </li><li> <p>粘贴：p</p> 
  <ul><li> <p>整行复制（剪切）</p> 
    <ul><li>粘贴到光标所在行的下方</li></ul> </li><li> <p>行内复制</p> 
    <ul><li>粘贴到光标的后方</li></ul> </li></ul> </li><li> <p>字符操作</p> 
  <ul><li>x 删除光标所在的字符</li><li>Nx 删除光标所在的字符及后面一共N个字符</li><li>r 替换光标所在字符</li><li>R 连续替换（替换模式，按Esc退出替换）</li></ul> </li><li> <p>其他操作</p> 
  <ul><li>u 撤销-undo</li><li>ctrl+r 反撤销-redo</li><li>ZZ 保存退出</li></ul> </li></ul> 
<h4><a id="_349"></a>插入模式</h4> 
<ul><li> <p>进入（编辑内容）</p> <p>i：当前位置插入<br> I：当前行首插入<br> a：当前位置下一个字符插入<br> A：当前行尾插入<br> o：当前位置下一行插入<br> O：当前位置上一行插入</p> </li><li> <p>Esc：退出插入模式（到命令模式）</p> </li></ul> 
<h4><a id="_362"></a>尾行模式</h4> 
<ul><li> <p>:进入，Esc/Enter退出（到命令模式）</p> </li><li> <p>:N 光标跳转到第N行，最后一行可用$表示</p> </li><li> <p>复制：y</p> 
  <ul><li>:y 复制光标所在行</li><li>:Ny 复制第N行</li><li>:N,My 复制从第N行到第M行</li></ul> </li><li> <p>删除（剪切）：d</p> 
  <ul><li>用法同复制</li></ul> </li><li> <p>关键词替换：s</p> <p>连接符号： #/或###或@@@​ 😒/old/new/ 将光标所在行的第一个"old"替换成"new" ​ 😒/old/new/g 将光标所在行的所有的"old"替换成"new",g-global全局​ :Ns/old/new/g 将第N行的所有的"old"替换成"new"​ :N,Ms/old/new/g 将从第N行到第M行的所有的"old"替换成"new"​ :%s/old/new/g 将整个文件中所有的"old"替换成"new" :5,10 s /./#&amp;/ 5-10前加入#字符 （.整行 &amp;引用查找的内容）</p> </li><li> <p>退出</p> 
  <ul><li>:q! 强制退出 ，!强制</li><li>:wq 保存退出</li><li>:x 保存退出</li></ul> </li><li> <p>读写文件</p> <p>:w 保存 write写入当前文件<br> :w /tmp/aaa.txt 将全文另存为/tmp/aaa.txt<br> :1,3 w /tmp/2.txt 将1到3行另存为/tmp/2.txt<br> :r /etc/hosts 读入文件/etc/hosts内容到当前行后<br> :5 r /etc/hosts 读入文件/etc/hosts内容到第5行后</p> </li><li> <p>搜索</p> 
  <ul><li>/关键字 n下一个 N上一个</li><li>^old：以old开头；old$：以old结尾</li></ul> </li><li> <p>设置</p> <p>临时设置：<br> ​ :set nu 显示行号<br> ​ :set nonu 不显示行号<br> ​ :set ts=4 设置tab的宽度为4<br> ​ :nohl 关闭高亮显示<br> ​ :set paste 粘贴模式<br> :set ic 不区分大小写<br> :set noic 区分大小写<br> 永久设置：<br> 修改vim环境配置文件（在环境配置文件中加入规则）vim /etc/vimrc 编辑加入set nu (影响所有系统用户)</p> </li></ul> 
<h4><a id="_411"></a>可视模式</h4> 
<ul><li>ctrl+v可视块、V可视行</li><li>块替换： 选择块，r 输入替换的字符</li><li>块删除： 选择块，d</li><li>块复制： 选择块，y</li></ul> 
<h3><a id="_418"></a>用户和组</h3> 
<h4><a id="_420"></a>基础介绍</h4> 
<ul><li> <p>用户和组的作用</p> 
  <ul><li>系统登录</li><li>文件归属 - 每个文件都属于一个特定的用户和组</li><li>进程权限 - 每个进程都由一个特定的用户来运行</li></ul> </li><li> <p>用户和组的关系</p> 
  <ul><li>每个用户有且仅有一个基本组, 一个组可以作为多个用户的基本组</li><li>每个用户都可以有任意多个附加组</li></ul> </li><li> <p>配置文件</p> 
  <ul><li> <p>默认配置文件</p> 
    <ul><li> <p>/etc/login.defs<br> 指定系统默认参数：<br> UID/GID_MIN 1000<br> UID/GID_MAX 60000<br> SYS_UID/GID_MIN 201<br> SYS_UID/GID_MAX 999<br> CREATE_HOME yes</p> </li><li> <p>/etc/default/useradd<br> 指定系统默认参数：<br> HOME=/home<br> SHELL=/bin/bash<br> CREATE_MAIL_SPOOL=yes</p> </li></ul> </li><li> <p>记录用户和组信息的文件</p> 
    <ul><li>/etc/passwd # 记录用户的信息,每行记录一个用户信息,</li><li>/etc/shadow # 存放用户的密码信息</li><li>/etc/group # 记录组信息</li><li>/etc/gshadow # 记录组密码信息</li></ul> </li><li> <p>子主题 3</p> </li></ul> </li></ul> 
<h4><a id="_462"></a>用户的管理</h4> 
<ul><li> <p>查看用户</p> 
  <ul><li> <p>查看用户基本信息: /etc/passwd 文件</p> <p>使用":"分隔为7列<br> 用户名:密码占位符:uid:gid:账户的描述信息:家目录:登录shell<br> 密码占位符：指定是否需要密码登录。x表示需要密码登录（可登录用户），为空表示不需要<br> 登录shell：分配的命令解释器</p> </li><li> <p>查看用户及其组的信息: id 命令</p> 
    <ul><li> <p>用法： id [选项] 用户名</p> </li><li> <p>选项</p> 
      <ul><li>-u 仅打印用户的uid</li><li>-g 仅打印用户的基本组的gid</li><li>-G 打印用户所有组的gid</li><li>-n 和-u,-g,-G结合使用,使用名称代替id</li></ul> </li></ul> </li></ul> </li><li> <p>添加用户</p> <p>讨论：默认情况下，创建一个用户做了哪些事情呢？<br> 1.创建同名组/etc/group<br> 2.添加同名组密码信息/etc/gshadow<br> 3.创建用户/etc/passwd<br> 4.添加用户密码信息/etc/shadow<br> 5.创建家目录/home<br> 6.创建邮箱/var/spool/mail<br> 用户只能单个创建</p> 
  <ul><li> <p>用法： useradd [选项] 用户名</p> </li><li> <p>选项</p> 
    <ul><li> <p>-c 指定用户的描述信息</p> </li><li> <p>-d 指定用户的家目录,不要事先创建(默认家目录为/home/用户名)</p> </li><li> <p>-g 指定用户的基本组，接组名或gid</p> 
      <ul><li>默认情况下,系统会创建一个和用户名相同的组名作为用户的基本组，gid值与uid值一致</li><li>指定的组名或uid需已存在</li></ul> </li><li> <p>-u 指定用户的uid</p> 
      <ul><li>默认按上一个用户的id往下顺延</li></ul> </li><li> <p>-s 指定用户的登录shell</p> <p>查看系统支持的shell：cat /etc/shells<br> 支持登录的shell：sh结尾<br> 不支持登录的shell：/sbin/nologin<br> 不可登录的系统用户：运行进程</p> </li><li> <p>-M 不创建家目录</p> </li><li> <p>-G 指定用户的附加组</p> </li><li> <p>-r 创建系统帐户:uid为1-999</p> </li></ul> </li></ul> </li><li> <p>删除用户</p> 
  <ul><li>用法： userdel [选项] 用户名</li><li>选项：-r 清除用户数据（家目录，邮箱）</li></ul> </li><li> <p>修改用户</p> 
  <ul><li> <p>修改用户基本信息</p> 
    <ul><li> <p>用法： usermod [选项] 用户名</p> </li><li> <p>选项</p> 
      <ul><li>-l 修改用户名：usermod -l new old</li><li>-u -g -d -s -c ：用法与useradd一致</li><li>-aG 增加附属组</li></ul> </li></ul> </li><li> <p>修改用户密码</p> <p>root可修改所有人的密码，普通用户只能修改自己的密码</p> 
    <ul><li> <p>交互式</p> 
      <ul><li>passwd#设置自己的密码</li><li>passwd 用户名#设置指定用户的密码（只有root用户可执行）</li></ul> </li><li> <p>非交互式</p> 
      <ul><li>echo “123” |passwd --stdin wutao</li><li>–stdin 从标准输入读取令牌</li></ul> </li></ul> </li></ul> </li><li> <p>切换用户</p> 
  <ul><li>用法： su - 用户名</li><li>退出：exit</li><li>root切换到其他用户不用密码，其他情况都要输入密码</li></ul> </li><li> <p>锁定用户</p> 
  <ul><li>usermod -L tom</li><li>passwd -l jerry</li><li>在shadow文件中对应用户的密码前加上!</li></ul> </li></ul> 
<h4><a id="_561"></a>组的管理</h4> 
<ul><li> <p>创建组</p> 
  <ul><li>用法：groupadd [选项] 组名</li><li>选项：-g 指定gid（该id未被使用）</li></ul> </li><li> <p>查看组</p> 
  <ul><li> <p>组信息：cat /etc/group</p> <p>组名:密码占位符:gid:组员</p> </li><li> <p>组密码信息：cat /etc/shadow</p> </li><li> <p>查看用户所属组：groups 用户名</p> </li></ul> </li><li> <p>修改组</p> 
  <ul><li> <p>用法：groupmod [选项] 组名</p> </li><li> <p>选项</p> 
    <ul><li>-g ID 修改组ID</li><li>-n NEW_NAME 修改组名</li></ul> </li></ul> </li><li> <p>修改组成员</p> 
  <ul><li> <p>用法：gpasswd [选项] 组名</p> </li><li> <p>选项</p> 
    <ul><li>-a USER 向组中添加成员</li><li>-d USER 从组中删除成员</li><li>-M USER1,USER2,… 设定组成员,会覆盖原来的组成员</li></ul> </li></ul> </li><li> <p>删除组</p> 
  <ul><li> <p>groupdel 组名</p> <p>这个组不能是某一个用户的主组,否则删除会失败</p> </li></ul> </li></ul> 
<h3><a id="_600"></a>文件权限管理</h3> 
<h4><a id="_602"></a>文件的归属</h4> 
<p>每个文件都属于一个特定的用户和一个特定的组<br> 仅root用户可修改文件的归属</p> 
<ul><li> <p>ls -l查看详细信息：-rw-r–r–. 1 user group</p> </li><li> <p>属主权限 属组权限 其他人权限 属主 属组</p> </li><li> <p>修改文件归属-chown</p> 
  <ul><li>chown [选项]… [属主][:[属组]] 文件…</li><li>chown [选项]… [属主][.[属组]] 文件…</li><li>-R 作用于目录，递归修改目录下的子文件</li></ul> </li><li> <p>默认归属</p> 
  <ul><li>属主：创建者用户</li><li>属组：创建者用户的基本组</li></ul> </li></ul> 
<h4><a id="_620"></a>基本权限</h4> 
<ul><li> <p>基本权限对象-ugo</p> <p>UGO描述的是用户对文件的身份,匹配顺序:<br> 1.先看用户是否文件的属主:如果是,则应用属主的权限<br> 2.看用户是否文件属组的成员:如果是,则应用属组的权限<br> 3.如果以上2个都不是,是应用其他人的权限</p> 
  <ul><li>u -user，属主</li><li>g -group，属组</li><li>o -other，其他人</li></ul> </li><li> <p>基本权限类型-rwx</p> <p>基本权限只针对普通用户，root不受影响<br> bash不受x权限影响</p> 
  <ul><li>r：read，读，4</li><li>w：write，写，2</li><li>x：execute，执行，1</li><li>-：无权限，0</li></ul> </li><li> <p>rwx对应的操作</p> 
  <ul><li> <p>普通文件</p> 
    <ul><li>前提：能够进入文件所在的目录</li><li>r -查看文件的内容，cat/more/less/tail/vim…</li><li>w -修改文件内容，vim/vi/&gt;/&gt;&gt;…</li><li>x -执行文件，命令/脚本文件（系统默认无x权限）</li></ul> </li><li> <p>目录文件</p> 
    <ul><li>r -查看目录的内容</li><li>w -修改目录的内容，mkdir/mv/cp/rm</li><li>x -进入目录(基础权限，所有操作的前提)，cd</li></ul> </li></ul> </li></ul> 
<h4><a id="chmod_659"></a>更改文件权限-chmod</h4> 
<ul><li> <p>chmod [ugoa][±=][rwx] 文件…</p> <p>chmod u-x /test<br> chmod g+w /test<br> chmod o=rx /test<br> chmod a=rwx /share<br> chmod u+w,g-x /share</p> 
  <ul><li>a:all，可以省略</li><li>+：在原来的基础上增加</li><li>-：在原来的基础上减少</li><li>=：覆盖原来的权限</li></ul> </li><li> <p>chmod 644 文件…</p> <p>数字形式表示权限：r=4，w=2，x=1，-=0<br> rwxrwxrwx -&gt; 777。3个为1组，每组用1位数字表示<br> — -&gt; 0<br> –x -&gt; 1<br> -w- -&gt; 2<br> -wx -&gt; 3<br> r-- -&gt; 4<br> r-x -&gt; 5<br> rw- -&gt; 6<br> rwx -&gt; 7</p> 
  <ul><li>直接用4位数字表示权限：高级权限+u+g+o，不可用±=</li><li>对应数字位省略表示无权限，如777，77，7，0</li></ul> </li><li> <p>授权的原则</p> 
  <ul><li>1.满足使用的需求</li><li>2.影响范围尽量小</li></ul> </li></ul> 
<h4><a id="umask_697"></a>权限掩码-umask</h4> 
<ul><li> <p>默认掩码：0022</p> </li><li> <p>umask：查询当前掩码；umask+掩码 ：设置掩码</p> </li><li> <p>创建文件默认最大权限：目录777，普通文件666</p> </li><li> <p>文件初始权限</p> 
  <ul><li>创建文件的权限=最大权限去掉umask掩掉的权限</li><li>普通文件本身没有x权限，故不能直接用数字相减</li><li>默认掩码0022时，普通文件权限644，目录权限755</li><li>家目录权限默认700</li></ul> </li></ul> 
<h4><a id="_709"></a>其他权限</h4> 
<ul><li> <p>acl权限</p> 
  <ul><li> <p>作用</p> 
    <ul><li>精细化的权限控制：FACL-file access control list</li></ul> </li><li> <p>查询</p> 
    <ul><li> <p>getfacl</p> 
      <ul><li>[root@zqs ~]# getfacl /root/file_a<br> getfacl: Removing leading ‘/’ from absolute path names</li></ul> </li></ul> </li></ul> </li></ul> 
<h2><a id="file_rootfile_a____723"></a>file: root/file_a #文件名</h2> 
<h2><a id="owner_hr____________724"></a>owner: hr #文件的属主</h2> 
<h2><a id="group_hr____________725"></a>group: hr #文件的属组</h2> 
<p>user::rw- #默认用户(属主)的权限,跟ls -l看到的权限一致<br> user:tom:rw- #为用户tom授权的acl权限<br> group::— #默认的组(属组)权限<br> group:IT:r-- #为IT组授权的acl权限<br> mask::rw- #掩码，真正的权限是与mask相与的结果，属主权限不受影响<br> other::— #其他人的权限</p> 
<pre><code>- 设置

	- setfacl

		- -m：添加facl权限

			- setfacl -m u:tom:rw /file #给tom用户设置acl权限
			- setfacl -m g:IT:r-- /file #给IT组设置acl权限
			- setfacl -m m::r-- /file #设置mask，撤销wx权限。用作大范围撤销某项权限

		- -x：移除facl权限

			- setfacl -x u:tom /file #移除对tom用户的授权
			- setfacl -x g:IT /file #移除对IT组的授权

		- -b：清空acl权限

			- setfacl -b /file #移除文件所有的acl权限

		- -d：设置默认acl权限

			- 作用在目录上，在目录下新建文件时采用设置的默认权限
			- setfacl -d -m u:bob:r-x /dir #给目录/dir设置默认acl权限

		- -k：移除默认acl权限

			- setfacl -k /dir #清除目录/dir的默认acl权限

		- -R：递归设置
</code></pre> 
<ul><li> <p>高级权限</p> 
  <ul><li> <p>suid - 4</p> <p>实验:SUID 实验目的:让tom用户可以看到jerry家目录下的文件内容 过程: # cp /usr/bin/cat /tmp # chown jerry /tmp/cat # chmod u+s /tmp/cat#给文件加suid权限 # su - tom $ /tmp/cat /home/jerry/jerry.txt#使用加了suid的cat可以看到jerry家目录下的文件了</p> 
    <ul><li> <p>作用于可执行文件，用户在执行此文件时，以该文件属主的身份执行<br> (非可执行权限不生效)</p> </li><li> <p>权限对象为u：u+s</p> 
      <ul><li>chomd u+s /usr/bin/cat</li><li>chmod 4755 /usr/bin/cat</li></ul> </li></ul> </li><li> <p>sgid - 2</p> <p>实验:SGID 实验目的:要求所有用户在/IT目录下创建的文件属组都为IT 过程: # groupadd IT # mkdir /IT # chown .IT /IT # chmod g+s /IT#给目录加上sgid权限 # echo test &gt; /IT/test # ll /IT/test -rw-r–r-- 1 root IT 5 11月 28 14:22 /IT/test#可以看到root用户创建的文件属组也为IT</p> 
    <ul><li> <p>1.作用与可执行文件，用户执行此文件时，以该文件属组的身份执行</p> </li><li> <p>2.作用于目录，在目录下创建文件会继承目录的属组<br> (设置前已有的文件不受影响)</p> </li><li> <p>权限对象为g：g+s</p> 
      <ul><li>chmod g+s /test</li><li>chmod 2755 /test</li></ul> </li></ul> </li><li> <p>sticky - 1</p> <p>实验:STICKY 实验目标:普通用户在/share目录中只能删除自己的文件 过程: [root@desk ~]# mkdir /share [root@desk ~]# chmod 1777 /share#给目录加上sticky权限,或用 o+t 添加 [root@desk ~]# ll -d /share/ drwxrwxrwt 2 root root 21 11月 28 14:42 /share [root@desk ~]# su - tom[tom@desk ~]$ touch /share/tom.txt [tom@desk ~]$ su - jerry [jerry@desk ~]$ ll /share/ -rw-rw-rw- 1 tom tom 6 11月 28 14:45 tom.txt [jerry@desk ~]$ rm -rf /share/tom.txt rm: 无法删除"/share/tom.txt": 不允许的操作#虽然目录权限为777,但不能删除别人的文件</p> 
    <ul><li> <p>一般作用于共享目录，在此目录中，用户只能删除自己的文件</p> </li><li> <p>权限对象为o：o+t</p> 
      <ul><li>chmod o+t /share</li><li>chmod 1755 /share</li></ul> </li></ul> </li></ul> </li><li> <p>隐藏权限</p> 
  <ul><li> <p>针对所有人，包括root</p> </li><li> <p>lsattr 文件名</p> 
    <ul><li>查看文件隐藏权限</li></ul> </li><li> <p>chattr [±=][ia] 文件名</p> 
    <ul><li> <p>修改文件隐藏权限</p> </li><li> <p>i：只读，不可删除修改</p> 
      <ul><li>chattr +i /file</li><li>chattr -i /file</li></ul> </li><li> <p>a：只能追加，不能删除修改</p> 
      <ul><li>chattr +a /fie</li><li>chattr -a /file</li><li>作用于目录：可以创建复制，不可移动删除</li></ul> </li><li> <p>清空隐藏权限</p> 
      <ul><li>chattr = /file</li></ul> </li></ul> </li></ul> </li></ul> 
<h4><a id="_820"></a>普通账户提权</h4> 
<ul><li> <p>方法一</p> 
  <ul><li> <p>将用户加入轮子组wheel(权限过大，相当于root)</p> </li><li> <p>加入方式</p> 
    <ul><li> <p>新增用户时加入</p> 
      <ul><li>useradd -G wheel user</li></ul> </li><li> <p>将用户加到组</p> 
      <ul><li>usermod -aG wheel user</li></ul> </li><li> <p>从组添加用户</p> 
      <ul><li>gpasswd -a user wheel</li></ul> </li></ul> </li></ul> </li><li> <p>方法二</p> 
  <ul><li> <p>visudo添加授权(通过visudo命令编辑/etc/sudoers文件)</p> </li><li> <p>授权格式</p> 
    <ul><li> <p>user MACHINE=(user) COMMANDS</p> </li><li> <p>user</p> 
      <ul><li>所授权的帐户</li></ul> </li><li> <p>MACHINE</p> 
      <ul><li>在哪台主机上</li></ul> </li><li> <p>(user)</p> 
      <ul><li>以谁的身份,可以省略，ALL表示所有</li></ul> </li><li> <p>COMMANDS</p> 
      <ul><li>执行的命令列表,多个命令使用,隔开,必须要用绝对路径</li><li>允许权限列表可以用自定义的命令组，禁止的权限不能用</li></ul> </li></ul> </li><li> <p>示例</p> 
    <ul><li> <p>tom ALL=(ALL) /usr/sbin/useradd,/usr/sbin/usermod</p> </li><li> <p>%wheel ALL=(ALL) ALL</p> 
      <ul><li>wheel组的所有成员可以执行所有的命令</li></ul> </li><li> <p>jim ALL=(ALL) ALL,! /usr/sbin/userdel</p> 
      <ul><li>jim除userdel外,其他所有命令都可以执行</li></ul> </li><li> <p>tom ALL=(ALL) ACCOUNT,!/usr/bin/passwd root</p> 
      <ul><li>tom可以执行ACCOUNT命令组中所有命令，禁止修改root密码</li></ul> </li></ul> </li><li> <p>定义命令组</p> 
    <ul><li>Cmnd_Alias NAME = /usr/sbin/useradd,/usr/sbin/userdel</li></ul> </li></ul> </li><li> <p>方法三</p> 
  <ul><li>编辑单独的授权文件</li><li>echo “tom ALL=(ALL) /usr/sbin/useradd” &gt; /etc/sudoers.d/tom</li></ul> </li><li> <p>注意</p> 
  <ul><li> <p>执行管理命令时默认需要验证用户密码，故需提前设置密码</p> 
    <ul><li>echo “123” |passwd --stdin tom</li></ul> </li><li> <p>若想取消密码验证，授权时添加NOPASSWD</p> 
    <ul><li>jim ALL=(ALL) NOPASSWD: ALL</li></ul> </li><li> <p>执行管理命令前需加上sudo</p> 
    <ul><li>sudo useradd lili command</li></ul> </li></ul> </li></ul> 
<h3><a id="Rsync_900"></a>Rsync</h3> 
<h4><a id="rsync_902"></a>rsync</h4> 
<ul><li> <p>介绍</p> 
  <ul><li> <p>可以用于实现数据增量同步</p> 
    <ul><li>如备份NAS或其它存储服务器上的文件</li><li>如从发布服务器推数据到其它服务器</li></ul> </li><li> <p>基于sshd服务器，可以结合ssh公钥认证</p> </li><li> <p>也可以用于本地服务器复制，同cp</p> </li></ul> </li><li> <p>安装</p> 
  <ul><li>yum -y install rsync</li></ul> </li><li> <p>语法</p> 
  <ul><li> <p>rsync [OPTION]… SRC… DEST</p> 
    <ul><li>拷贝本地文件</li><li>rsync a b</li></ul> </li><li> <p>rsync [OPTION]… SRC… [USER@]HOST:DEST</p> 
    <ul><li>从本地拷贝到远程</li><li>rsync -avz a/ 1.1.1.13:/opt/a</li></ul> </li><li> <p>rsync [OPTION]… [USER@]HOST:SRC DEST</p> 
    <ul><li>从远程拷贝到本地</li><li>rsync -avz 1.1.1.13:/opt/a/ a/</li></ul> </li></ul> </li><li> <p>选项</p> 
  <ul><li> <p>-v</p> 
    <ul><li>详细模式输出</li></ul> </li><li> <p>-z</p> 
    <ul><li>对备份的文件在传输时进行压缩处理</li></ul> </li><li> <p>-a</p> 
    <ul><li> <p>等同于-rlptgoD</p> </li><li> <p>-r</p> 
      <ul><li>对子目录以递归模式处理</li></ul> </li><li> <p>-l</p> 
      <ul><li>保持软链接</li></ul> </li><li> <p>-p</p> 
      <ul><li>保持文件权限</li></ul> </li><li> <p>-t</p> 
      <ul><li>保持文件修改时间</li></ul> </li><li> <p>-g</p> 
      <ul><li>保持文件属组</li></ul> </li><li> <p>-o</p> 
      <ul><li>保持属主(仅限root)</li></ul> </li><li> <p>-D</p> 
      <ul><li>保持设备文件信息</li></ul> </li></ul> </li><li> <p>-H</p> 
    <ul><li>保持硬链接</li></ul> </li><li> <p>-A</p> 
    <ul><li>保持acl权限</li></ul> </li><li> <p>-X</p> 
    <ul><li>保持attr扩展属性</li></ul> </li><li> <p>–delete</p> 
    <ul><li>删除DST中SRC没有的文件</li><li>rsync -avz --deleting a/ 1.1.1.13:/opt/a</li></ul> </li><li> <p>–exclude=pattern</p> 
    <ul><li>指定排除不需要传输的文件</li><li>rsync -azv --delete --exclude=b.txt a/ 1.1.1.13:/opt/a</li></ul> </li></ul> </li><li> <p>注意</p> 
  <ul><li> <p>源</p> 
    <ul><li> <p>目录以"/"结尾</p> 
      <ul><li>仅传输目录下的内容</li><li>同步时扫描目录下的文件个体是否变化</li></ul> </li><li> <p>目录不以"/"结尾</p> 
      <ul><li>传输目录及目录下的内容</li><li>同步时以目录为整体扫描文件是否变化</li></ul> </li></ul> </li><li> <p>目标</p> 
    <ul><li>目标目录的父目录需已存在</li></ul> </li><li> <p>同步过程</p> 
    <ul><li>首次同步为全量备份，源目录是否以“/”结尾均可</li><li>后续增量同步时，源目录必须以“/”结尾，否则仍以全量(对于源目录而言)形式同步</li></ul> </li></ul> </li></ul> 
<h4><a id="inotify_1021"></a>inotify</h4> 
<ul><li> <p>介绍</p> 
  <ul><li>一种强大的、细粒度的、异步的文件系统事件监控机制</li><li>在内核中通过Inotify监控文件系统中添 加、删除，修改、移动等各种细微事件</li><li>利用这个内核接口，第三方软件(如inotify-tools)就可以监控文件系统下文件的各种变化情况</li><li>与rsync结合使用可解决同步数据的实时性我呢提</li></ul> </li><li> <p>安装</p> 
  <ul><li>yum -y install inotify-tools</li></ul> </li><li> <p>inotifywait指令</p> 
  <ul><li> <p>用于等待文件或文件集上的一个特定事件，它可以监控任何文件和目录</p> </li><li> <p>选项</p> 
    <ul><li> <p>-m</p> 
      <ul><li>始终保持事件监听状态</li></ul> </li><li> <p>-r</p> 
      <ul><li>递归查询目录</li></ul> </li><li> <p>-q</p> 
      <ul><li>不打印监控事件(最开始的提示信息)</li></ul> </li><li> <p>-e</p> 
      <ul><li> <p>指定要监控的事件</p> 
        <ul><li>inotifywait -mrq -e modify,attrib,move,create,delete /root/a</li></ul> </li><li> <p>写操作事件</p> 
        <ul><li> <p>modify</p> 
          <ul><li>文件或目录发生写操作</li></ul> </li><li> <p>delete</p> 
          <ul><li>文件或目录被删除</li></ul> </li><li> <p>create</p> 
          <ul><li>文件或目录被创建</li></ul> </li><li> <p>attrib</p> 
          <ul><li>文件或目录属性发生变化</li></ul> </li></ul> </li></ul> </li></ul> </li><li> <p>输出格式</p> 
    <ul><li> <p>–format</p> 
      <ul><li> <p>指定输出格式</p> </li><li> <p>常用</p> 
        <ul><li> <p>%T</p> 
          <ul><li>使用由-timefmt定义的时间格式</li></ul> </li><li> <p>%e</p> 
          <ul><li>表示发生的事件</li></ul> </li><li> <p>%w</p> 
          <ul><li>表示发生事件的目录</li></ul> </li><li> <p>%f</p> 
          <ul><li>表示发生事件的文件</li></ul> </li></ul> </li></ul> </li><li> <p>-timefmt</p> 
      <ul><li> <p>指定时间格式，用于-format选项中的%T格式</p> </li><li> <p>格式与date一致</p> 
        <ul><li>[%y/%m/%d %H:%M:%S]</li><li>[%F %T]</li></ul> </li></ul> </li></ul> </li><li> <p>同步保存为日志</p> 
    <ul><li>inotifywait -mrq -e modify,attrib,move,create,delete --format ‘%T %e %w%f’ --timefmt ‘[%F %T]’ /root/a |tee -a /var/log/root_a_write.log</li></ul> </li></ul> </li></ul> 
<h4><a id="rsyncinotify_1110"></a>rsync+inotify实时同步</h4> 
<ul><li> <p>传递公钥</p> 
  <ul><li>ssh-keygen</li><li>ssh-copy-id 1.1.1.13</li></ul> </li><li> <p>编写同步脚本</p> 
  <ul><li> <p>vim rsync.sh</p> </li><li> <p>#!/bin/bash<br> src_dir=/root/a/<br> dst_ip=1.1.1.13<br> dst_dir=/opt/a/<br> log_dir=/var/log/root_a_w.log<br> inotifywait -mrq -e modify,attrib,move,create,delete --format ‘%T %e %w%f’ --timefmt ‘[%F %T]’ $src_dir |<br> while read line;do<br> echo $line &gt;&gt; $log_dir<br> rsync -avz --delete $src_dir <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             d 
            
           
             s 
            
            
            
              t 
             
            
              i 
             
            
           
             p 
            
           
             : 
            
           
          
            dst_ip: 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">:</span></span></span></span></span>dst_dir<br> done</p> </li><li> <p>nohup sh raync.sh &amp;</p> 
    <ul><li>脚本放置后台运行，否则占用终端</li><li>将进程脱离终端，否则终端关闭进程就停止</li></ul> </li></ul> </li><li> <p>同步测试</p> </li></ul> 
<h3><a id="_1137"></a>文件管理命令</h3> 
<h4><a id="_1139"></a>文件信息</h4> 
<ul><li> <p>stat</p> 
  <ul><li> <p>用法</p> 
    <ul><li>stat [选项]… 文件…</li><li>查看文件时间</li></ul> </li><li> <p>时间类型</p> 
    <ul><li> <p>Access</p> 
      <ul><li>访问时间（atime）：文件当天第一次访问的时间</li></ul> </li><li> <p>Modify</p> 
      <ul><li>修改时间（mtime）：最后一次修改文件内容的时间</li></ul> </li><li> <p>Change</p> 
      <ul><li>更改时间（ctime）：最后一次修改文件元数据的时间（大小、权限、属主、属组…）</li></ul> </li></ul> </li><li> <p>注意</p> 
    <ul><li>vim修改后3个时间都变化，ll显示的是modify time</li></ul> </li></ul> </li><li> <p>df</p> 
  <ul><li> <p>用法</p> 
    <ul><li>df [选项]… [文件]…</li><li>显示文件所在的文件系统相关信息</li></ul> </li><li> <p>选项</p> 
    <ul><li>-T：显示文件系统类型</li><li>h：人性化显示(带单位)</li></ul> </li><li> <p>示例</p> 
    <ul><li>查看根分区磁盘使用情况：df -Th /</li></ul> </li></ul> </li><li> <p>du</p> 
  <ul><li> <p>du -sh /tmp</p> 
    <ul><li>查看/tmp目录中文件总大小</li></ul> </li></ul> </li><li> <p>file</p> 
  <ul><li> <p>file 文件</p> 
    <ul><li>查看文件的数据类型（文本，图片，压缩包…）</li></ul> </li></ul> </li></ul> 
<h4><a id="_1194"></a>过滤内容</h4> 
<ul><li> <p>grep</p> 
  <ul><li> <p>用法</p> 
    <ul><li> <p>grep [选项]… 关键词 [文件]…</p> 
      <ul><li>过滤文件中包含查找内容的行</li></ul> </li></ul> </li><li> <p>选项</p> 
    <ul><li>-v：反选，过滤不包含该内容的行</li><li>-i：不区分大小写</li><li>-n：带行号显示</li><li>-c：统计过滤结果行数</li><li>-q：不显示过滤内容</li><li>-w：匹配整词</li></ul> </li><li> <p>关键词</p> 
    <ul><li>root：包含root的行</li><li>^root：以root开头的行</li><li>root$：以root结尾的行</li><li>^$：空行（空格属于特殊字符）</li></ul> </li><li> <p>示例</p> 
    <ul><li>统计/tmp目录下普通文件的数量：ll /tmp |grep -c “^-”</li></ul> </li></ul> </li><li> <p>awk</p> 
  <ul><li> <p>用法</p> 
    <ul><li>awk [选项] ‘{动作}’ file…</li><li>打印指定列内容，默认分隔符为空格或制表符</li></ul> </li><li> <p>选项</p> 
    <ul><li>-F：指定列分隔符</li></ul> </li><li> <p>列号</p> 
    <ul><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              N 
             
            
              第 
             
            
              N 
             
            
              列， 
             
            
           
             N 第N列， 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mord cjk_fallback">第</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mord cjk_fallback">列，</span></span></span></span></span>NF 最后一列，$(NF-1) 倒数第二列</li></ul> </li><li> <p>示例</p> 
    <ul><li>awak -F: NR==2’{print $6}'#打印第2行第6列的字段</li><li>grep “^root:” /etc/passwd |awk -F: ‘{print $1,$3,$4}’ #打印root用户的用户名、uid、gid</li></ul> </li></ul> </li><li> <p>tr</p> 
  <ul><li> <p>用法</p> 
    <ul><li>tr [选项]… SET1 [SET2]</li><li>处理字符，删除、缩减、替换</li></ul> </li><li> <p>选项</p> 
    <ul><li> <p>-d：删除指定字符(可多个)</p> 
      <ul><li>df -Th |grep “/$” |awk ‘{print $6}’ |tr -d %</li></ul> </li><li> <p>-s：将连续出现的字符缩减为一个</p> 
      <ul><li>echo goggoooole |tr -s og</li><li>删除空行：tr -s “\n” &lt; /etc/rc.local</li></ul> </li></ul> </li><li> <p>替换</p> 
    <ul><li> <p>tr set1 set2</p> 
      <ul><li>echo $PATH |tr ‘:’ ’ ’ |xargs -n1 echo</li></ul> </li><li> <p>cat /etc/passwd |tr a-z A-Z</p> </li></ul> </li></ul> </li></ul> 
<h4><a id="_1270"></a>内容处理</h4> 
<ul><li> <p>wc</p> 
  <ul><li> <p>用法</p> 
    <ul><li> <p>wc [选项]… [文件]…</p> 
      <ul><li>统计行数、字符数、字数</li></ul> </li></ul> </li><li> <p>选项</p> 
    <ul><li>-l：行数</li><li>-c：字符数</li><li>-w：字数</li></ul> </li><li> <p>示例</p> 
    <ul><li>统计系统中可登录用户数：grep sh$ /etc/passwd |wc -l</li></ul> </li></ul> </li><li> <p>sort</p> 
  <ul><li> <p>用法</p> 
    <ul><li>sort [选项]… [文件]…</li><li><a href="https://baike.baidu.com/item/ASCII/309296?fromtitle=ascii%E7%A0%81&amp;fromid=99077&amp;fr=aladdin" rel="nofollow">对文件内容进行排序，默认按单个字符ASCII码升序（从小到大）</a></li></ul> </li><li> <p>选项</p> 
    <ul><li>-n：按数值排序</li><li>-r：逆序（从大到小）</li><li>-t：定义列的分隔符（默认空格或制表符）</li><li>-k：指定排序的列号</li></ul> </li><li> <p>示例</p> 
    <ul><li>按uid值从大到小打印/etc/passwd：sort -nr -t : -k 3 /etc/passwd</li></ul> </li></ul> </li><li> <p>uniq</p> 
  <ul><li> <p>用法</p> 
    <ul><li> <p>uniq [选项]… [输入[输出]]</p> 
      <ul><li>对连续的重复行去重，去重前需先排序</li></ul> </li></ul> </li><li> <p>选项</p> 
    <ul><li>-c：统计重复次数</li></ul> </li><li> <p>示例</p> 
    <ul><li>awk -F: ‘{print $NF}’ /etc/passwd |sort |uniq -c |sort -nr</li></ul> </li></ul> </li><li> <p>tee</p> 
  <ul><li> <p>用法</p> 
    <ul><li> <p>tee []… [file]…</p> 
      <ul><li>双通道输出</li></ul> </li></ul> </li><li> <p>选项</p> 
    <ul><li>-a：将输入内容追加到文件中</li></ul> </li><li> <p>输入来源</p> 
    <ul><li>标准输入，通过交互式键盘输入的内容</li><li>通过管道流下来的内容</li><li>通过输入重定向，将文件内容作为输入源</li></ul> </li><li> <p>示例</p> 
    <ul><li> <p>echo hello |tee /dev/tty1</p> </li><li> <p>echo hello |tee /tmp/a.txt</p> 
      <ul><li>将标准输入输出到终端的同时也保存到文件中，默认覆盖模式</li></ul> </li></ul> </li></ul> </li></ul> 
<h4><a id="_1349"></a>打包压缩</h4> 
<ul><li> <p>zip</p> 
  <ul><li> <p>压缩zip</p> 
    <ul><li> <p>用法</p> 
      <ul><li>zip [选项]… 压缩包名 需要压缩的文件列表</li><li>压缩包名带路径指定目录，不带当前目录，后缀".zip"</li></ul> </li><li> <p>选项</p> 
      <ul><li>-r：压缩列表中有目录</li></ul> </li></ul> </li><li> <p>解压unzip</p> 
    <ul><li> <p>用法</p> 
      <ul><li>unzip zip压缩包 [选项]</li></ul> </li><li> <p>选项</p> 
      <ul><li>-d：解压到指定目录。默认解压到当前目录</li></ul> </li></ul> </li></ul> </li><li> <p>tar</p> 
  <ul><li> <p>用法</p> 
    <ul><li>tar [选项]… [文件]…</li><li>打包：仅归档,文件的大小不会变化</li><li>压缩: 压缩后文件的大小会变化</li></ul> </li><li> <p>选项</p> 
    <ul><li>-c：创建文档</li><li>-f：后接包名，必接选项</li><li>-x：解包/压</li><li>-v：显示过程</li><li>-t：查询包中有哪些文件</li><li>-r：往打好的包中追加文件,不适用于压缩包</li><li>-z：通过gzip压缩     xxx.tar.gz</li><li>-j：通过bzip2压缩 xxx.tar.bz2</li><li>-J：通过xz压缩 xxx.tar.xz</li><li>-a：程序通过规范的后缀名自动选择压缩程序进行压缩</li><li>-C：指定解压路径，不指定则默认当前路径</li></ul> </li><li> <p>示例</p> 
    <ul><li> <p>打包</p> 
      <ul><li>tar cf /tmp/bao.tar</li></ul> </li><li> <p>查看包内容</p> 
      <ul><li>tar tf /tmp/bao.tar</li></ul> </li><li> <p>包追加内容</p> 
      <ul><li>tar rf /tmp/bao.tar /file</li></ul> </li><li> <p>压缩</p> 
      <ul><li>tar acf /tmp/yasuo.tar.gz ./</li></ul> </li><li> <p>解压/包</p> 
      <ul><li>tar xf yasuo.tar.gz</li></ul> </li><li> <p>与xargs联用</p> 
      <ul><li>find / -name *.conf |xargs tar caf /backup/conf/config.tar.gz</li><li>不能使用-i {} ，否则会覆盖</li></ul> </li></ul> </li></ul> </li></ul> 
<h4><a id="_1423"></a>计划任务</h4> 
<ul><li> <p>计划任务</p> 
  <ul><li>计划任务: 在开机的情况下, 按照计划完成的任务.</li><li>一次性: 只执行一次</li><li>周期性: 有规律的执行</li><li>计划任务中的输出不会输出到终端, 而是通过邮件通知</li></ul> </li><li> <p>一次性<br> 计划任务</p> 
  <ul><li> <p>at</p> 
    <ul><li> <p>atd服务</p> 
      <ul><li>yum -y install at #安装at</li><li>systemctl start atd #启动服务</li><li>systemctl status atd #查看服务状态</li></ul> </li><li> <p>用法</p> 
      <ul><li>at 时间 -&gt; 输入动作 -&gt; ctrl+d结束</li></ul> </li><li> <p>时间格式</p> 
      <ul><li>HH:MM #最近的一次时间点</li><li>HH:MM YY-MM-DD。日期还可写成：MMDDYY、MM/DD/YY、DD.MM.YY</li><li>now + 2minutes。支持minutes,hours,days,weeks</li></ul> </li><li> <p>查看</p> 
      <ul><li>atq #等价于at -l</li><li>at -l #查看一次性计划任务</li><li>at -c 工作号 #查看计划任务详情</li></ul> </li><li> <p>删除任务</p> 
      <ul><li>at -r/-d 工作号</li><li>atrm 工作号</li><li>删除任务文件rm -rfv /var/spool/at/a***</li></ul> </li></ul> </li><li> <p>batch</p> 
    <ul><li>batch -&gt;输入动作-&gt;ctrl+d结束</li><li>不指定具体时间, 在系统负载较低(平均负载低于0.8)的时候执行<br> 查看平均负载：uptime/w/top/htop</li></ul> </li><li> <p>访问控制</p> 
    <ul><li> <p>仅对普通用户有效</p> </li><li> <p>系统文件</p> 
      <ul><li> <p>/etc/at.allow</p> 
        <ul><li>touch /etc/at.allow</li><li>echo user &gt;&gt; /etc/at.allow</li></ul> </li><li> <p>/etc/at.deny</p> 
        <ul><li>echo user &gt;&gt; /etc/at.deny</li></ul> </li></ul> </li><li> <p>控制模式</p> 
      <ul><li>只有deny文件(默认)：黑名单</li><li>只有allow文件：白名单</li><li>两者都存在：仅白名单生效</li><li>两者都不存在：都不能使用</li></ul> </li></ul> </li></ul> </li><li> <p>周期性<br> 计划任务</p> 
  <ul><li> <p>crontab</p> 
    <ul><li> <p>服务</p> 
      <ul><li> <p>服务名称</p> 
        <ul><li>crond</li></ul> </li><li> <p>配置文件</p> 
        <ul><li>/etc/sysconfig/crond</li></ul> </li></ul> </li><li> <p>用法</p> 
      <ul><li>crontab [选项]</li><li>服务：crond</li></ul> </li><li> <p>选项</p> 
      <ul><li>-e：编辑用户的计划任务</li><li>-l：列出用户的计划任务</li><li>-u：指定用户，默认root</li><li>-r：清空用户的计划任务(禁用)</li></ul> </li><li> <p>创建任务</p> 
      <ul><li> <p>crontab -e -u zhang</p> </li><li> <p>任务格式</p> 
        <ul><li> <p>分 时 日 月 周 命令</p> </li><li> <p>特殊时间格式</p> 
          <ul><li>@reboot #每次启动执行一次</li><li>@yearly：“0 0 1 1 *” #每年年头执行一次</li><li>@annually：“0 0 1 1 *” #同上</li><li>@monthly：“0 0 1 * *” #每月月头执行一次</li><li>@weekly：“0 0 * * 0” #每周开头执行一次</li><li>@daily：“0 0 * * *” #每天开头执行一次</li><li>@hourly：“0 * * * *” #每小时整点执行一次</li></ul> </li><li> <p>命令</p> 
          <ul><li>最好使用绝对路径：/usr/bin/touch</li><li>命令中的%表示将%后面所有的内容作为标准输入交给命令处理</li><li> 
            <ul><li> 
              <ul><li> 
                <ul><li> 
                  <ul><li></ul> </li></ul> </li></ul> </li></ul> </li></ul> </li></ul> </li></ul> </li></ul> </li></ul> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f7062e5eff1720da66ca40f7dd498935/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">系统管理简介</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/62bb994035cf1d21c608932bf10edc66/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">微服务架构</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>