<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android 通过ADB方式获取&amp;设置音量 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android 通过ADB方式获取&amp;设置音量" />
<meta property="og:description" content="在Android 开发中,会涉及到各种音量调整环节,可以通过Demo的方式实时修改体现也可以通ADB的方式来实现.简单记录一下.
一 获取设备音频全部信息 通过dumpsys 指令获取audio信息,即可获得设备全部信息.
dumpsys audio 二 Android的音量类型(举例:Android 8.1) /* These values must be kept in sync with system/audio.h */ /* * If these are modified, please also update Settings.System.VOLUME_SETTINGS * and attrs.xml and AudioManager.java. */ /** Used to identify the default audio stream volume */ public static final int STREAM_DEFAULT = -1; /** Used to identify the volume of audio streams for phone calls */ public static final int STREAM_VOICE_CALL = 0; /** Used to identify the volume of audio streams for system sounds */ public static final int STREAM_SYSTEM = 1; /** Used to identify the volume of audio streams for the phone ring and message alerts */ public static final int STREAM_RING = 2; /** Used to identify the volume of audio streams for music playback */ public static final int STREAM_MUSIC = 3; /** Used to identify the volume of audio streams for alarms */ public static final int STREAM_ALARM = 4; /** Used to identify the volume of audio streams for notifications */ public static final int STREAM_NOTIFICATION = 5; /** Used to identify the volume of audio streams for phone calls when connected on bluetooth */ public static final int STREAM_BLUETOOTH_SCO = 6; /** Used to identify the volume of audio streams for enforced system sounds in certain * countries (e." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/6d6339653fa2664dd27aa1e1172b5fb9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-09T16:55:39+08:00" />
<meta property="article:modified_time" content="2024-01-09T16:55:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android 通过ADB方式获取&amp;设置音量</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在Android 开发中,会涉及到各种音量调整环节,可以通过Demo的方式实时修改体现也可以通ADB的方式来实现.简单记录一下.</p> 
<h5>一 获取设备音频全部信息</h5> 
<p>通过dumpsys 指令获取audio信息,即可获得设备全部信息.</p> 
<pre><code class="language-java">dumpsys audio</code></pre> 
<h5>二 Android的音量类型(举例:Android 8.1)</h5> 
<pre><code class="language-java">    /* These values must be kept in sync with system/audio.h */
    /*
     * If these are modified, please also update Settings.System.VOLUME_SETTINGS
     * and attrs.xml and AudioManager.java.
     */
    /** Used to identify the default audio stream volume */
    public static final int STREAM_DEFAULT = -1;
    /** Used to identify the volume of audio streams for phone calls */
    public static final int STREAM_VOICE_CALL = 0;
    /** Used to identify the volume of audio streams for system sounds */
    public static final int STREAM_SYSTEM = 1;
    /** Used to identify the volume of audio streams for the phone ring and message alerts */
    public static final int STREAM_RING = 2;
    /** Used to identify the volume of audio streams for music playback */
    public static final int STREAM_MUSIC = 3;
    /** Used to identify the volume of audio streams for alarms */
    public static final int STREAM_ALARM = 4;
    /** Used to identify the volume of audio streams for notifications */
    public static final int STREAM_NOTIFICATION = 5;
    /** Used to identify the volume of audio streams for phone calls when connected on bluetooth */
    public static final int STREAM_BLUETOOTH_SCO = 6;
    /** Used to identify the volume of audio streams for enforced system sounds in certain
     * countries (e.g camera in Japan) */
    public static final int STREAM_SYSTEM_ENFORCED = 7;
    /** Used to identify the volume of audio streams for DTMF tones */
    public static final int STREAM_DTMF = 8;
    /** Used to identify the volume of audio streams exclusively transmitted through the
     *  speaker (TTS) of the device */
    public static final int STREAM_TTS = 9;
    /** Used to identify the volume of audio streams for accessibility prompts */
    public static final int STREAM_ACCESSIBILITY = 10;</code></pre> 
<p> Android 12 有新增</p> 
<pre><code class="language-java">/** @hide Used to identify the volume of audio streams for virtual assistant */
    public static final int STREAM_ASSISTANT = 11;</code></pre> 
<p> 常用的有以下五种:</p> 
<blockquote> 
 <ul><li>获取设备的电话音量 - STREAM_VOICE_CALL </li><li>获取设备的系统音量 - STREAM_SYSTEM</li><li>获取设备的铃音音量 - STREAM_RING</li><li>获取设备的音乐音量 - STREAM_MUSIC</li><li>获取设备的闹钟音量- STREAM_ALARM</li></ul> 
</blockquote> 
<h5 id="%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E8%AE%BE%E5%A4%87%E5%90%84%E7%B1%BB%E9%9F%B3%E9%87%8F%E5%A4%A7%E5%B0%8F">举例:设置多媒体音量大小</h5> 
<pre><code class="language-java">adb shell media volume --show --stream 3 --get
 
输出:
    [v] will control stream=3 (STREAM_MUSIC)
    [v] will get volume
    [v] Connecting to AudioService
    [v] volume is 0 in range [0..15]

# 注：即当前STREAM_MUSIC是0，最小0，最大15</code></pre> 
<h5>举例:设置多媒体音量大小</h5> 
<pre><code class="language-java">adb shell media volume --show --stream 3 --set 10
 
输出：
    [v] will control stream=3 (STREAM_MUSIC)
    [v] will set volume to index=10
    [v] Connecting to AudioService
 
# 注：设置系统音量为0（stream=1）后，设备会进入静音模式，之后再修改其他模式音量会失败</code></pre> 
<h5>Android 11 以上获取/设置方式</h5> 
<p>较高版本获取/设置有所变更, 官方文档如下:</p> 
<blockquote> 
 <p>In <a href="https://so.csdn.net/so/search?q=Android&amp;spm=1001.2101.3001.7020" title="Android">Android</a> 11 and Android 12, <code>media</code> utility no longer exists. That's why you got the error since your shell could not find the utility in locations mentioned in its PATH. That utility's commands have been moved to a service name <code>MediaSessionService</code>. To access those commands invoke this service using <code>cmd</code> command.</p> 
</blockquote> 
<p>具体的操作案例演示如下: </p> 
<pre><code class="hljs">// 必须先建立连接
adb shell cmd media_session
 
C:\adb&gt;adb shell cmd media_session  volume  --stream 3 --get
[V] will control stream=3 (STREAM_MUSIC)
[V] will get volume
[V] Connecting to AudioService
[V] volume is 5 in range [0..15]
 
C:\adb&gt;adb shell cmd media_session  volume --show --stream 3 --set 11
[V] will control stream=3 (STREAM_MUSIC)
[V] will set volume to index=11
[V] Connecting to AudioService</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ee51943ea3cc76193ab63ef46632ae19/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">BAT批处理：定时关机</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f1dcd22d97953e2558334cc5e2148e3b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Logcat 参数及功能介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>