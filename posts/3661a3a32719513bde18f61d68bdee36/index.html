<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Impala vs. Presto简要对比梳理 - 编程鬼谷子的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Impala vs. Presto简要对比梳理" />
<meta property="og:description" content="文章目录 旧日报（Impala）核心语法时间范围时间转换JSON解析 新日报（Presto）核心语法时间范围时间转换JSON解析 其他参考 腾讯灯塔产品相关介绍文档： 腾讯灯塔产品文档DataTalk：开放的通用BI可视化平台腾讯灯塔DataTalk——如同乐高，这是一个开放/自由的数据可视化世界 SQL模式下的第一个tab【查询结果】右边的帮助提示信息如下：
① 请确保在SQL查询语句末尾带上limit条件，否则页面默认显示前5000条结果；
② Impala SQL语法指南 (查询托管在灯塔集群的数据需使用)
③ OneSQL 语法指南 (跨源查询模式需使用)
腾讯灯塔 DataTalk 没有固定的语法，是按查询的数据源SQL语法。
旧日报（Impala） 旧的 DataTalk 页面是引用的灯塔融合引擎（DataInsight的数据源），对应 Impala SQL 语法。
Data TypesImpala SQL Language ReferenceImpala Built-In Functions 核心语法 主要用到 IF、CASE、IN、BETWEEN、CAST、AVG、COUNT 等关键字。
SQL Operators：
Arithmetic OperatorsBETWEEN OperatorComparison Operators：=, !=, &lt;&gt;；&lt;, &lt;=, &gt;, &gt;=。EXISTS OperatorILIKE OperatorIN OperatorIREGEXP OperatorIS DISTINCT FROM OperatorIS NULL OperatorIS TRUE OperatorLIKE OperatorLogical Operators：AND、OR、NOTREGEXP OperatorRLIKE Operator Impala Conditional Functions：
CASECASE2COALESCEDECODEIFIFNULLISFALSEISNOTFALSEISNOTTRUEISNULLISTRUENONNULLVALUE：等效于 IS NOT NULL。NULLIFNULLIFZERONULLVALUE：等效于 IS NULL。NVLNVL2ZEROIFNULL 时间范围 recent_7_days 是DataTalk中拖入的时间范围交互组件定义的变量。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcguiguzi.github.io/posts/3661a3a32719513bde18f61d68bdee36/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-04T11:26:33+08:00" />
<meta property="article:modified_time" content="2023-01-04T11:26:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程鬼谷子的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程鬼谷子的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Impala vs. Presto简要对比梳理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#Impala_16" rel="nofollow">旧日报（Impala）</a></li><li><ul><li><a href="#_24" rel="nofollow">核心语法</a></li><li><a href="#_66" rel="nofollow">时间范围</a></li><li><a href="#_80" rel="nofollow">时间转换</a></li><li><a href="#JSON_90" rel="nofollow">JSON解析</a></li></ul> 
   </li><li><a href="#Presto_112" rel="nofollow">新日报（Presto）</a></li><li><ul><li><a href="#_121" rel="nofollow">核心语法</a></li><li><a href="#_180" rel="nofollow">时间范围</a></li><li><a href="#_184" rel="nofollow">时间转换</a></li><li><a href="#JSON_215" rel="nofollow">JSON解析</a></li></ul> 
   </li><li><a href="#_240" rel="nofollow">其他参考</a></li></ul> 
 </li></ul> 
</div> 
<br> 腾讯灯塔产品相关介绍文档： 
<p></p> 
<ul><li><a href="https://wiki.beacon.tencent.com/" rel="nofollow">腾讯灯塔产品文档</a></li><li><a href="https://zhuanlan.zhihu.com/p/595714652" rel="nofollow">DataTalk：开放的通用BI可视化平台</a></li><li><a href="https://www.growthhk.cn/quan/80418.html" rel="nofollow">腾讯灯塔DataTalk——如同乐高，这是一个开放/自由的数据可视化世界</a></li></ul> 
<p>SQL模式下的第一个tab【查询结果】右边的帮助提示信息如下：</p> 
<p>① 请确保在SQL查询语句末尾带上limit条件，否则页面默认显示前5000条结果；<br> ② <a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_langref_unsupported.html#langref_hiveql_delta" rel="nofollow">Impala SQL语法指南</a> (查询托管在灯塔集群的数据需使用)<br> ③ OneSQL 语法指南 (跨源查询模式需使用)</p> 
<p>腾讯灯塔 DataTalk 没有固定的语法，是按查询的数据源SQL语法。</p> 
<h3><a id="Impala_16"></a>旧日报（Impala）</h3> 
<p>旧的 DataTalk 页面是引用的灯塔融合引擎（DataInsight的数据源），对应 <code>Impala SQL</code> 语法。</p> 
<ul><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_datatypes.html#datatypes" rel="nofollow">Data Types</a></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_langref.html" rel="nofollow">Impala SQL Language Reference</a></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_functions.html" rel="nofollow">Impala Built-In Functions</a></li></ul> 
<h4><a id="_24"></a>核心语法</h4> 
<p>主要用到 IF、CASE、IN、BETWEEN、CAST、AVG、COUNT 等关键字。</p> 
<p><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html" rel="nofollow">SQL Operators</a>：</p> 
<ul><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#arithmetic_operators" rel="nofollow">Arithmetic Operators</a></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#between" rel="nofollow">BETWEEN Operator</a></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#comparison_operators" rel="nofollow">Comparison Operators</a>：<code>=</code>, <code>!=</code>, <code>&lt;&gt;</code>；<code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>。</li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#exists" rel="nofollow">EXISTS Operator</a></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#ilike" rel="nofollow">ILIKE Operator</a></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#in" rel="nofollow">IN Operator</a></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#iregexp" rel="nofollow">IREGEXP Operator</a></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#is_distinct_from" rel="nofollow">IS DISTINCT FROM Operator</a></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#is_null" rel="nofollow">IS NULL Operator</a></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#is_true" rel="nofollow">IS TRUE Operator</a></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#like" rel="nofollow">LIKE Operator</a></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#logical_operators" rel="nofollow">Logical Operators</a>：<code>AND</code>、<code>OR</code>、<code>NOT</code></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#regexp" rel="nofollow">REGEXP Operator</a></li><li><a href="https://docs.cloudera.com/documentation/enterprise/6/6.3/topics/impala_operators.html#rlike" rel="nofollow">RLIKE Operator</a></li></ul> 
<p><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html" rel="nofollow">Impala Conditional Functions</a>：</p> 
<ul><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__case" rel="nofollow">CASE</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__case2" rel="nofollow">CASE2</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__coalesce" rel="nofollow">COALESCE</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__decode" rel="nofollow">DECODE</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__if" rel="nofollow">IF</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__ifnull" rel="nofollow">IFNULL</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__isfalse" rel="nofollow">ISFALSE</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__isnotfalse" rel="nofollow">ISNOTFALSE</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__isnottrue" rel="nofollow">ISNOTTRUE</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__isnull" rel="nofollow">ISNULL</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__istrue" rel="nofollow">ISTRUE</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__nonnullvalue" rel="nofollow">NONNULLVALUE</a>：等效于 <code>IS NOT NULL</code>。</li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__nullif" rel="nofollow">NULLIF</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__nullifzero" rel="nofollow">NULLIFZERO</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__nullvalue" rel="nofollow">NULLVALUE</a>：等效于 <code>IS NULL</code>。</li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__nvl" rel="nofollow">NVL</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__nvl2" rel="nofollow">NVL2</a></li><li><a href="https://impala.apache.org/docs/build/html/topics/impala_conditional_functions.html#conditional_functions__zeroifnull" rel="nofollow">ZEROIFNULL</a></li></ul> 
<h4><a id="_66"></a>时间范围</h4> 
<p><code>recent_7_days</code> 是DataTalk中拖入的<strong>时间范围</strong>交互组件定义的变量。</p> 
<p>在辅助画布中，可以看到拖入了两个时间范围交互组件：</p> 
<p>点击进入【最近7天】组件的设置（⚙️），可以修改变量字段类型、变量KEY、变量名以及组件配置（默认取值）。</p> 
<ol><li><strong>变量字段类型</strong>：<code>YYYYMMDDHH整形</code>，注意SQL中要将时间戳变量的类型转换对齐，才能使用 BETWEEN 进行日期比较。</li><li><strong>变量KEY</strong>、<strong>变量显示名</strong> 可以自定义。可在SQL中引用变量KEY，start、end分别表示起、止整点时间。</li><li>组件配置（默认组织）：最近7天。</li></ol> 
<p>点击顶部工具栏中的【变量池】，在【系统变量】中可以看到时间范围组件变量KEY——<code>recent_7_days</code>。</p> 
<h4><a id="_80"></a>时间转换</h4> 
<p><a href="https://impala.apache.org/docs/build/html/topics/impala_datetime_functions.html" rel="nofollow">Impala Date and Time Functions</a></p> 
<ul><li><a href="https://www.cnblogs.com/harrychinese/p/impala_time_functions.html" rel="nofollow">impala系列: 时间函数</a></li><li><a href="https://bigdatansql.com/2021/12/03/from_timestamp-in-apache-impala/" rel="nofollow">FROM_TIMESTAMP IN APACHE IMPALA</a></li><li><a href="https://stackoverflow.com/questions/51013629/extract-the-date-from-a-timestamp-value-variable-in-impala" rel="nofollow">extract the date from a timestamp value variable in Impala</a></li></ul> 
<p><a href="https://impala.apache.org/docs/build/html/topics/impala_datetime_functions.html" rel="nofollow">Impala Date and Time Functions</a> 中支持字符串强转时间戳类型：<code>cast('2016-01-31' as timestamp)</code>。</p> 
<h4><a id="JSON_90"></a>JSON解析</h4> 
<p><a href="https://impala.apache.org/docs/build/html/topics/impala_misc_functions.html" rel="nofollow">Impala Miscellaneous Functions</a></p> 
<ul><li><code>GET_JSON_OBJECT</code>(STRING json_str, STRING selector)</li></ul> 
<blockquote> 
 <p><strong>Purpose:</strong> Extracts JSON object from the <code>json_str</code> based on the selector JSON path and returns the string of the extracted JSON object.<br> The function returns <code>NULL</code> if the input json_str is invalid or if nothing is selected based on the selector JSON path.</p> 
</blockquote> 
<p><strong>相关参考</strong>：</p> 
<ul><li><a href="https://yychildren.github.io/2017/10/17/parse-json-in-impala/" rel="nofollow">impala 解析json</a></li><li><a href="https://blog.csdn.net/vkingnew/article/details/109792607">Impala JSON函数</a></li><li><a href="https://www.monsteryu.top/databases/impala/impala_json/" rel="nofollow">Impala解析JSON字符串</a></li><li><a href="https://community.cloudera.com/t5/Support-Questions/Nested-JSON-to-columns-using-Impala-SQL-function/m-p/288190" rel="nofollow">Nested JSON to columns using Impala SQL function</a></li><li><a href="https://stackoverflow.com/questions/68234463/get-json-object-parsing-a-json-string-in-impala-unable-to-parse-the-key-st" rel="nofollow">get_json_object() - parsing a json string in Impala - Unable to parse the key starting with a number</a></li></ul> 
<p>例如解析 value 中的 cmd 和 retcode 字段：</p> 
<ul><li>GET_JSON_OBJECT(value, ‘$.cmd’)</li><li>GET_JSON_OBJECT(value, ‘$.retcode’)</li></ul> 
<h3><a id="Presto_112"></a>新日报（Presto）</h3> 
<p>新的 DataTalk 页面引用的是扩展TDW数据源，则使用的是 <code>Presto SQL</code>。</p> 
<ul><li><a href="https://prestodb.io/docs/current/language/types.html" rel="nofollow">Data Types</a></li><li><a href="https://prestodb.io/docs/current/" rel="nofollow">Presto Documentation</a></li><li>DataTalk - <a href="http://docs.beacon.pages.woa.com/doc/presto_sql_Introduction.html" rel="nofollow">跨源查询语法介绍</a></li><li><a href="https://blog.csdn.net/sinat_17697111/article/details/89101124">presto函数大全中文版</a></li></ul> 
<h4><a id="_121"></a>核心语法</h4> 
<p>需查询 Presto SQL 与 Impala SQL 中的 IF、CASE、IN、BETWEEN、CAST、AVG、COUNT 等关键字对应语法。</p> 
<blockquote> 
 <p>cast、json解析，有点类似 <a href="https://cloud.tencent.com/document/product/614/12503" rel="nofollow">CLS日志查询语法</a>，可参考监控告警方案 - CLS告警策略存档中的相关实践。</p> 
</blockquote> 
<p><strong>常用语法</strong>：</p> 
<p><a href="https://prestodb.io/docs/current/functions/comparison.html#" rel="nofollow">Comparison Functions and Operators</a>:</p> 
<ul><li><a href="https://prestodb.io/docs/current/functions/comparison.html#comparison-operators" rel="nofollow">Comparison Operators</a>：<code>&lt;</code>、<code>&gt;</code>、<code>&lt;=</code>、<code>&gt;=</code>、<code>=</code>、<code>&lt;&gt;</code>、<code>!=</code>（non-standard）。</li><li><a href="https://prestodb.io/docs/current/functions/comparison.html#range-operator-between" rel="nofollow">Range Operator: BETWEEN</a></li><li><a href="https://prestodb.io/docs/current/functions/comparison.html#is-null-and-is-not-null" rel="nofollow">IS NULL and IS NOT NULL</a></li><li><a href="https://prestodb.io/docs/current/functions/comparison.html#is-distinct-from-and-is-not-distinct-from" rel="nofollow">IS DISTINCT FROM and IS NOT DISTINCT FROM</a></li><li><a href="https://prestodb.io/docs/current/functions/comparison.html#greatest-and-least" rel="nofollow">GREATEST and LEAST</a></li><li><a href="https://prestodb.io/docs/current/functions/comparison.html#quantified-comparison-predicates-all-any-and-some" rel="nofollow">Quantified Comparison Predicates: ALL, ANY and SOME</a></li><li><a href="https://prestodb.io/docs/current/functions/comparison.html#like" rel="nofollow">LIKE</a></li></ul> 
<p><a href="https://prestodb.io/docs/current/functions/conditional.html" rel="nofollow">Conditional Expressions</a>：</p> 
<ul><li><a href="https://prestodb.io/docs/current/functions/conditional.html#case" rel="nofollow">CASE</a></li><li><a href="https://prestodb.io/docs/current/functions/conditional.html#if" rel="nofollow">IF</a></li><li><a href="https://prestodb.io/docs/current/functions/conditional.html#coalesce" rel="nofollow">COALESCE</a></li><li><a href="https://prestodb.io/docs/current/functions/conditional.html#nullif" rel="nofollow">NULLIF</a>：等效于 <code>val1 = val2 ? null : val1</code>。</li><li><a href="https://prestodb.io/docs/current/functions/conditional.html#try" rel="nofollow">TRY</a></li></ul> 
<p><a href="https://prestodb.io/docs/current/functions/conversion.html#functions-conversion--page-root" rel="nofollow">Conversion Functions</a></p> 
<ul><li>cast、try_cast</li></ul> 
<p><a href="https://prestodb.io/docs/current/functions/aggregate.html" rel="nofollow">Aggregate Functions</a>:</p> 
<ul><li>count、count_if</li><li>max、min、avg</li></ul> 
<p><a href="https://prestodb.io/docs/current/sql/select.html#union-intersect-except-clause" rel="nofollow">SELECT</a></p> 
<ul><li><a href="https://prestodb.io/docs/current/sql/select.html#union-intersect-except-clause" rel="nofollow">UNION | INTERSECT | EXCEPT Clause</a></li><li><a href="https://prestodb.io/docs/current/sql/select.html#joins" rel="nofollow">Joins</a></li></ul> 
<p><strong>条件语句</strong>：</p> 
<p><code>if(condition, true_value, false_value)</code> 基于 CASE WHEN 的等效实现：</p> 
<pre><code>CASE
    WHEN condition THEN true_value
    [ ELSE false_value ]
END
</code></pre> 
<p><strong>其他参考</strong>：</p> 
<p><a href="https://www.cnblogs.com/yongtaiyu/archive/2013/01/16/2863118.html" rel="nofollow">关于SQL命令中不等号（!=,&lt;&gt;）</a></p> 
<blockquote> 
 <p>t-sql操作符中，不等号(!=,&lt;&gt;)查询出来的结果集<strong>不包含</strong>有当前字段为 <em>null</em> 的数据。</p> 
</blockquote> 
<p><a href="https://blog.csdn.net/luwulu1056/article/details/126549783">Presto的IN条件语句的实现逻辑是限定范围查询</a></p> 
<h4><a id="_180"></a>时间范围</h4> 
<p>参考旧日报，在辅助画布中，拖入了时间范围交互组件，并定义变量KEY。</p> 
<h4><a id="_184"></a>时间转换</h4> 
<blockquote> 
 <p>毫秒级时间戳换算成秒级：<code>FLOOR(CAST(f_report_time AS BIGINT) / 1000)</code>，floor取整秒，忽略毫秒。</p> 
</blockquote> 
<p>presto vs hive 时间转换：@<a href="https://blog.csdn.net/cdyjy_litao/article/details/80252327">csdn</a> @<a href="https://zhuanlan.zhihu.com/p/164645100" rel="nofollow">zhihu</a></p> 
<p><a href="https://prestodb.io/docs/current/functions/datetime.html" rel="nofollow">Date and Time Functions and Operators</a></p> 
<ul><li><a href="https://www.jianshu.com/p/786bfe77b8cb" rel="nofollow">presto时间相关的函数</a></li><li><a href="https://ahana.io/answers/how-do-i-convert-timestamp-to-date-with-presto/" rel="nofollow">Convert Timestamp To Date With Presto - Ahana</a></li><li><a href="https://stackoverflow.com/questions/39880540/presto-sql-converting-a-date-string-to-date-format" rel="nofollow">Presto SQL - Converting a date string to date format</a></li></ul> 
<blockquote> 
 <p><strong>相关函数</strong>：<code>format_datetime</code></p> 
</blockquote> 
<p>目前，医典正式环境性能上报（formal-yidianperformance）对 <code>f_report_time</code> 字段在 th 和 CLS 开启了筛选、索引， <code>f_log_time</code> 字段未开启。<br> 如果在 th 上对 <code>f_log_time</code> 字段开启了筛选，在CLS日志主题索引配置开启了索引，则可以直接引用 <code>f_log_time</code> 字段。</p> 
<ol><li>毫秒级时间戳 <code>f_report_time</code> 转换为秒级，注意 /1000 将得到浮点数，可以调用 <code>FLOOR</code> 函数取整或 CAST AS BIGINT 强转取整（四舍五入）。</li></ol> 
<pre><code class="prism language-SQL">FLOOR(CAST(f_report_time AS BIGINT) / 1000) AS tss,
CAST(CAST(f_report_time AS BIGINT) / 1000 AS BIGINT) AS tss,
</code></pre> 
<ol start="2"><li>如果 <code>f_log_time</code> 字段有缺失，可以基于 <code>f_report_time</code> 转换为秒级时间戳，再依次调用 from_unixtime - format_datetime 按指定日期格式输出字符串。</li></ol> 
<pre><code class="prism language-SQL">-- 1666805107976 -&gt; 2022-10-26 17:25:07
format_datetime(from_unixtime(CAST(f_report_time AS BIGINT)/1000),'yyyy-MM-dd HH:mm:ss')
</code></pre> 
<h4><a id="JSON_215"></a>JSON解析</h4> 
<ul><li><a href="https://blog.csdn.net/lzxlfly/article/details/108552894">hive与presto解析json中的字段值</a></li><li><a href="https://blog.csdn.net/qq_34105362/article/details/80454697">【Hive】解析json（get_json_object）</a></li></ul> 
<p><a href="https://prestodb.io/docs/current/functions/json.html" rel="nofollow">8.12. JSON Functions and Operators</a>:</p> 
<ul><li><code>is_json_scalar</code></li><li><code>json_array_contains</code></li><li><code>json_array_get</code></li><li><code>json_array_length</code></li><li><code>json_extract</code>(json, json_path) → <em>json</em></li><li><code>json_extract_scalar</code>(json, json_path) → <em>varchar</em></li></ul> 
<p>例如解析 value 中的 cmd 和 retcode 字段：</p> 
<ul><li><code>json_extract_scalar(json_extract(f_extra, '$.value'), '$.cmd')</code></li><li><code>json_extract_scalar(f_extra, '$.value.retcode')</code></li></ul> 
<p>对空对象的正确判断是 is null 或 is not null，兼顾空对象（null）和空字符串的完整判断为：</p> 
<pre><code class="prism language-SQL">json_extract_scalar(f_extra, '$.value.error') is null or length(json_extract_scalar(f_extra, '$.value.error'))  &lt; 1) as count_success_ssrenter
</code></pre> 
<h3><a id="_240"></a>其他参考</h3> 
<p><a href="https://cloud.tencent.com/developer/article/1029648" rel="nofollow">揭秘腾讯大数据之平台综述篇</a><br> <a href="https://blog.csdn.net/Johnny_Lee/article/details/26673829">TDW开源：腾讯的分布式数据仓库</a><br> <a href="https://zhuanlan.zhihu.com/p/543490163" rel="nofollow">从TDW到ClickHouse的最佳实践</a></p> 
<p><a href="https://blog.csdn.net/u013407595/article/details/36508323">TDW与PostgreSQL数据互访问功能</a><br> <a href="https://www.111com.net/database/196/94838.htm" rel="nofollow">PostgreSQL在腾讯数据仓库TDW的使用教程</a><br> <a href="https://juejin.cn/post/6977616751357853726" rel="nofollow">「解耦」方能「专注」——腾讯天穹SuperSQL跨引擎计算揭秘</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d13f2b38e2ed5671f1ccb32c9a191590/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux服务器上配置Anaconda</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/389c925a1d6530f5c9726373de9b1621/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Excel求解运输问题——以福斯特公司问题为例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程鬼谷子的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>